/**
* plotly.js (gl3d - minified) v1.39.1
* Copyright 2012-2018, Plotly, Inc.
* All rights reserved.
* Licensed under the MIT license
*/
(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.Plotly=e()}})(function(){var e,t,r;return function(){function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){var l=typeof require=="function"&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var f=r[o]={exports:{}};t[o][0].call(f.exports,function(e){var r=t[o][1][e];return i(r?r:e)},f,f.exports,e,t,r,n)}return r[o].exports}var a=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}return e}()({1:[function(e,t,r){"use strict";var n=e("../src/lib");var i={"X,X div":"font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;","X input,X button":"font-family:'Open Sans', verdana, arial, sans-serif;","X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;z-index:1001;background:rgba(255,255,255,0.7);","X .modebar--hover":"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;","X:hover .modebar--hover":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;margin-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-group:first-child":"margin-left:0px;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar-btn path":"fill:rgba(0,31,95,0.3);","X .modebar-btn.active path,X .modebar-btn:hover path":"fill:rgba(0,22,72,0.5);","X .modebar-btn.modebar-btn--logo":"padding:3px 1px;","X .modebar-btn.modebar-btn--logo path":"fill:#447adb !important;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;","X [data-title]:after":"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:white;","X .select-outline-2":"stroke:black;stroke-dasharray:2px 2px;",Y:"font-family:'Open Sans';position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;","Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var a in i){var o=a.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");n.addStyleRule(o,i[a])}},{"../src/lib":483}],2:[function(e,t,r){"use strict";t.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:1e3,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:1e3,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"}}},{}],3:[function(e,t,r){"use strict";t.exports=e("../src/traces/cone")},{"../src/traces/cone":595}],4:[function(e,t,r){"use strict";t.exports=e("../src/core")},{"../src/core":466}],5:[function(e,t,r){"use strict";var n=e("./core");n.register([e("./scatter3d"),e("./surface"),e("./mesh3d"),e("./cone"),e("./streamtube")]);t.exports=n},{"./cone":3,"./core":4,"./mesh3d":6,"./scatter3d":7,"./streamtube":8,"./surface":9}],6:[function(e,t,r){"use strict";t.exports=e("../src/traces/mesh3d")},{"../src/traces/mesh3d":600}],7:[function(e,t,r){"use strict";t.exports=e("../src/traces/scatter3d")},{"../src/traces/scatter3d":634}],8:[function(e,t,r){"use strict";t.exports=e("../src/traces/streamtube")},{"../src/traces/streamtube":639}],9:[function(e,t,r){"use strict";t.exports=e("../src/traces/surface")},{"../src/traces/surface":644}],10:[function(e,t,r){"use strict";t.exports=u;var n=e("right-now");var i=e("3d-view");var a=e("mouse-change");var o=e("mouse-wheel");var s=e("mouse-event-offset");var l=e("has-passive-events");function u(e,t){e=e||document.body;t=t||{};var r=[.01,Infinity];if("distanceLimits"in t){r[0]=t.distanceLimits[0];r[1]=t.distanceLimits[1]}if("zoomMin"in t){r[0]=t.zoomMin}if("zoomMax"in t){r[1]=t.zoomMax}var u=i({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:r});var f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var c=0;var h=e.clientWidth;var v=e.clientHeight;var d={view:u,element:e,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:u.modes,tick:function(){var t=n();var r=this.delay;u.idle(t-r);u.flush(t-(100+r*2));var i=t-2*r;u.recalcMatrix(i);var a=true;var o=u.computedMatrix;for(var s=0;s<16;++s){a=a&&f[s]===o[s];f[s]=o[s]}var l=e.clientWidth===h&&e.clientHeight===v;h=e.clientWidth;v=e.clientHeight;if(a){return!l}c=Math.exp(u.computedRadius[0]);return true},lookAt:function(e,t,r){u.lookAt(u.lastT(),e,t,r)},rotate:function(e,t,r){u.rotate(u.lastT(),e,t,r)},pan:function(e,t,r){u.pan(u.lastT(),e,t,r)},translate:function(e,t,r){u.translate(u.lastT(),e,t,r)}};Object.defineProperties(d,{matrix:{get:function(){return u.computedMatrix},set:function(e){u.setMatrix(u.lastT(),e);return u.computedMatrix},enumerable:true},mode:{get:function(){return u.getMode()},set:function(e){u.setMode(e);return u.getMode()},enumerable:true},center:{get:function(){return u.computedCenter},set:function(e){u.lookAt(u.lastT(),e);return u.computedCenter},enumerable:true},eye:{get:function(){return u.computedEye},set:function(e){u.lookAt(u.lastT(),null,e);return u.computedEye},enumerable:true},up:{get:function(){return u.computedUp},set:function(e){u.lookAt(u.lastT(),null,null,e);return u.computedUp},enumerable:true},distance:{get:function(){return c},set:function(e){u.setDistance(u.lastT(),e);return e},enumerable:true},distanceLimits:{get:function(){return u.getDistanceLimits(r)},set:function(e){u.setDistanceLimits(e);return e},enumerable:true}});e.addEventListener("contextmenu",function(e){e.preventDefault();return false});var p=0,g=0,m={shift:false,control:false,alt:false,meta:false};a(e,y);e.addEventListener("touchstart",function(t){var r=s(t.changedTouches[0],e);y(0,r[0],r[1],m);y(1,r[0],r[1],m);t.preventDefault()},l?{passive:false}:false);e.addEventListener("touchmove",function(t){var r=s(t.changedTouches[0],e);y(1,r[0],r[1],m);t.preventDefault()},l?{passive:false}:false);e.addEventListener("touchend",function(t){var r=s(t.changedTouches[0],e);y(0,p,g,m);t.preventDefault()},l?{passive:false}:false);function y(t,r,i,a){var o=1/e.clientHeight;var s=o*(r-p);var l=o*(i-g);var f=d.flipX?1:-1;var h=d.flipY?1:-1;var v=Math.PI*d.rotateSpeed;var y=n();if(t&1){if(a.shift){u.rotate(y,0,0,-s*v)}else{u.rotate(y,f*v*s,-h*v*l,0)}}else if(t&2){u.pan(y,-d.translateSpeed*s*c,d.translateSpeed*l*c,0)}else if(t&4){var b=d.zoomSpeed*l/window.innerHeight*(y-u.lastT())*50;u.pan(y,0,0,c*(Math.exp(b)-1))}p=r;g=i;m=a}o(e,function(e,t,r){var i=d.flipX?1:-1;var a=d.flipY?1:-1;var o=n();if(Math.abs(e)>Math.abs(t)){u.rotate(o,0,0,-e*i*Math.PI*d.rotateSpeed/window.innerWidth)}else{var s=d.zoomSpeed*a*t/window.innerHeight*(o-u.lastT())/100;u.pan(o,0,0,c*(Math.exp(s)-1))}},true);return d}},{"3d-view":11,"has-passive-events":237,"mouse-change":255,"mouse-event-offset":256,"mouse-wheel":258,"right-now":300}],11:[function(e,t,r){"use strict";t.exports=u;var n=e("turntable-camera-controller");var i=e("orbit-camera-controller");var a=e("matrix-camera-controller");function o(e,t){this._controllerNames=Object.keys(e);this._controllerList=this._controllerNames.map(function(t){return e[t]});this._mode=t;this._active=e[t];if(!this._active){this._mode="turntable";this._active=e.turntable}this.modes=this._controllerNames;this.computedMatrix=this._active.computedMatrix;this.computedEye=this._active.computedEye;this.computedUp=this._active.computedUp;this.computedCenter=this._active.computedCenter;this.computedRadius=this._active.computedRadius}var s=o.prototype;var l=[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]];l.forEach(function(e){var t=e[0];var r=[];for(var n=0;n<e[1];++n){r.push("a"+n)}var i="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+e[0]+"("+r.join()+")}";s[t]=Function.apply(null,r.concat(i))});s.recalcMatrix=function(e){this._active.recalcMatrix(e)};s.getDistance=function(e){return this._active.getDistance(e)};s.getDistanceLimits=function(e){return this._active.getDistanceLimits(e)};s.lastT=function(){return this._active.lastT()};s.setMode=function(e){if(e===this._mode){return}var t=this._controllerNames.indexOf(e);if(t<0){return}var r=this._active;var n=this._controllerList[t];var i=Math.max(r.lastT(),n.lastT());r.recalcMatrix(i);n.setMatrix(i,r.computedMatrix);this._active=n;this._mode=e;this.computedMatrix=this._active.computedMatrix;this.computedEye=this._active.computedEye;this.computedUp=this._active.computedUp;this.computedCenter=this._active.computedCenter;this.computedRadius=this._active.computedRadius};s.getMode=function(){return this._mode};function u(e){e=e||{};var t=e.eye||[0,0,1];var r=e.center||[0,0,0];var s=e.up||[0,1,0];var l=e.distanceLimits||[0,Infinity];var u=e.mode||"turntable";var f=n();var c=i();var h=a();f.setDistanceLimits(l[0],l[1]);f.lookAt(0,t,r,s);c.setDistanceLimits(l[0],l[1]);c.lookAt(0,t,r,s);h.setDistanceLimits(l[0],l[1]);h.lookAt(0,t,r,s);return new o({turntable:f,orbit:c,matrix:h},u)}},{"matrix-camera-controller":253,"orbit-camera-controller":274,"turntable-camera-controller":330}],12:[function(e,t,r){"use strict";var n=typeof WeakMap==="undefined"?e("weak-map"):WeakMap;var i=e("gl-buffer");var a=e("gl-vao");var o=new n;function s(e){var t=o.get(e);var r=t&&(t._triangleBuffer.handle||t._triangleBuffer.buffer);if(!r||!e.isBuffer(r)){var n=i(e,new Float32Array([-1,-1,-1,4,4,-1]));t=a(e,[{buffer:n,type:e.FLOAT,size:2}]);t._triangleBuffer=n;o.set(e,t)}t.bind();e.drawArrays(e.TRIANGLES,0,3);t.unbind()}t.exports=s},{"gl-buffer":104,"gl-vao":166,"weak-map":338}],13:[function(e,t,r){var n=e("pad-left");t.exports=i;function i(e,t,r){t=typeof t==="number"?t:1;r=r||": ";var i=e.split(/\r?\n/);var a=String(i.length+t-1).length;return i.map(function(e,i){var o=i+t;var s=String(o).length;var l=n(o,a-s);return l+r+e}).join("\n")}},{"pad-left":275}],14:[function(e,t,r){"use strict";t.exports=a;var n=e("robust-orientation");function i(e,t){var r=new Array(t+1);for(var i=0;i<e.length;++i){r[i]=e[i]}for(var i=0;i<=e.length;++i){for(var a=e.length;a<=t;++a){var o=new Array(t);for(var s=0;s<t;++s){o[s]=Math.pow(a+1-i,s)}r[a]=o}var l=n.apply(void 0,r);if(l){return true}}return false}function a(e){var t=e.length;if(t===0){return[]}if(t===1){return[0]}var r=e[0].length;var n=[e[0]];var a=[0];for(var o=1;o<t;++o){n.push(e[o]);if(!i(n,r)){n.pop();continue}a.push(o);if(a.length===r+1){return a}}return a}},{"robust-orientation":306}],15:[function(e,t,r){"use strict";t.exports=a;var n=e("delaunay-triangulate");var i=e("circumradius");function a(e,t){return n(t).filter(function(r){var n=new Array(r.length);for(var a=0;a<r.length;++a){n[a]=t[r[a]]}return i(n)*e<1})}},{circumradius:57,"delaunay-triangulate":83}],16:[function(e,t,r){t.exports=a;var n=e("alpha-complex");var i=e("simplicial-complex-boundary");function a(e,t){return i(n(e,t))}},{"alpha-complex":15,"simplicial-complex-boundary":313}],17:[function(e,t,r){t.exports=function e(t){return atob(t)}},{}],18:[function(e,t,r){"use strict";t.exports=a;var n=e("robust-linear-solve");function i(e){var t=0;for(var r=0;r<e.length;++r){t+=e[r]}return t}function a(e,t){var r=t.length;var a=new Array(r+1);for(var o=0;o<r;++o){var s=new Array(r+1);for(var l=0;l<=r;++l){s[l]=e[l][o]}a[o]=s}a[r]=new Array(r+1);for(var o=0;o<=r;++o){a[r][o]=1}var u=new Array(r+1);for(var o=0;o<r;++o){u[o]=t[o]}u[r]=1;var f=n(a,u);var c=i(f[r+1]);if(c===0){c=1}var h=new Array(r+1);for(var o=0;o<=r;++o){h[o]=i(f[o])/c}return h}},{"robust-linear-solve":305}],19:[function(e,t,r){"use strict";r.byteLength=f;r.toByteArray=c;r.fromByteArray=d;var n=[];var i=[];var a=typeof Uint8Array!=="undefined"?Uint8Array:Array;var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var s=0,l=o.length;s<l;++s){n[s]=o[s];i[o.charCodeAt(s)]=s}i["-".charCodeAt(0)]=62;i["_".charCodeAt(0)]=63;function u(e){var t=e.length;if(t%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}return e[t-2]==="="?2:e[t-1]==="="?1:0}function f(e){return e.length*3/4-u(e)}function c(e){var t,r,n,o,s;var l=e.length;o=u(e);s=new a(l*3/4-o);r=o>0?l-4:l;var f=0;for(t=0;t<r;t+=4){n=i[e.charCodeAt(t)]<<18|i[e.charCodeAt(t+1)]<<12|i[e.charCodeAt(t+2)]<<6|i[e.charCodeAt(t+3)];s[f++]=n>>16&255;s[f++]=n>>8&255;s[f++]=n&255}if(o===2){n=i[e.charCodeAt(t)]<<2|i[e.charCodeAt(t+1)]>>4;s[f++]=n&255}else if(o===1){n=i[e.charCodeAt(t)]<<10|i[e.charCodeAt(t+1)]<<4|i[e.charCodeAt(t+2)]>>2;s[f++]=n>>8&255;s[f++]=n&255}return s}function h(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[e&63]}function v(e,t,r){var n;var i=[];for(var a=t;a<r;a+=3){n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(e[a+2]&255);i.push(h(n))}return i.join("")}function d(e){var t;var r=e.length;var i=r%3;var a="";var o=[];var s=16383;for(var l=0,u=r-i;l<u;l+=s){o.push(v(e,l,l+s>u?u:l+s))}if(i===1){t=e[r-1];a+=n[t>>2];a+=n[t<<4&63];a+="=="}else if(i===2){t=(e[r-2]<<8)+e[r-1];a+=n[t>>10];a+=n[t>>4&63];a+=n[t<<2&63];a+="="}o.push(a);return o.join("")}},{}],20:[function(e,t,r){"use strict";var n=e("./lib/rationalize");t.exports=i;function i(e,t){return n(e[0].mul(t[1]).add(t[0].mul(e[1])),e[1].mul(t[1]))}},{"./lib/rationalize":30}],21:[function(e,t,r){"use strict";t.exports=n;function n(e,t){return e[0].mul(t[1]).cmp(t[0].mul(e[1]))}},{}],22:[function(e,t,r){"use strict";var n=e("./lib/rationalize");t.exports=i;function i(e,t){return n(e[0].mul(t[1]),e[1].mul(t[0]))}},{"./lib/rationalize":30}],23:[function(e,t,r){"use strict";var n=e("./is-rat");var i=e("./lib/is-bn");var a=e("./lib/num-to-bn");var o=e("./lib/str-to-bn");var s=e("./lib/rationalize");var l=e("./div");t.exports=u;function u(e,t){if(n(e)){if(t){return l(e,u(t))}return[e[0].clone(),e[1].clone()]}var r=0;var f,c;if(i(e)){f=e.clone()}else if(typeof e==="string"){f=o(e)}else if(e===0){return[a(0),a(1)]}else if(e===Math.floor(e)){f=a(e)}else{while(e!==Math.floor(e)){e=e*Math.pow(2,256);r-=256}f=a(e)}if(n(t)){f.mul(t[1]);c=t[0].clone()}else if(i(t)){c=t.clone()}else if(typeof t==="string"){c=o(t)}else if(!t){c=a(1)}else if(t===Math.floor(t)){c=a(t)}else{while(t!==Math.floor(t)){t=t*Math.pow(2,256);r+=256}c=a(t)}if(r>0){f=f.ushln(r)}else if(r<0){c=c.ushln(-r)}return s(f,c)}},{"./div":22,"./is-rat":24,"./lib/is-bn":28,"./lib/num-to-bn":29,"./lib/rationalize":30,"./lib/str-to-bn":31}],24:[function(e,t,r){"use strict";var n=e("./lib/is-bn");t.exports=i;function i(e){return Array.isArray(e)&&e.length===2&&n(e[0])&&n(e[1])}},{"./lib/is-bn":28}],25:[function(e,t,r){"use strict";var n=e("bn.js");t.exports=i;function i(e){return e.cmp(new n(0))}},{"bn.js":38}],26:[function(e,t,r){"use strict";var n=e("./bn-sign");t.exports=i;function i(e){var t=e.length;var r=e.words;var i=0;if(t===1){i=r[0]}else if(t===2){i=r[0]+r[1]*67108864}else{for(var a=0;a<t;a++){var o=r[a];i+=o*Math.pow(67108864,a)}}return n(e)*i}},{"./bn-sign":25}],27:[function(e,t,r){"use strict";var n=e("double-bits");var i=e("bit-twiddle").countTrailingZeros;t.exports=a;function a(e){var t=i(n.lo(e));if(t<32){return t}var r=i(n.hi(e));if(r>20){return 52}return r+32}},{"bit-twiddle":37,"double-bits":84}],28:[function(e,t,r){"use strict";var n=e("bn.js");t.exports=i;function i(e){return e&&typeof e==="object"&&Boolean(e.words)}},{"bn.js":38}],29:[function(e,t,r){"use strict";var n=e("bn.js");var i=e("double-bits");t.exports=a;function a(e){var t=i.exponent(e);if(t<52){return new n(e)}else{return new n(e*Math.pow(2,52-t)).ushln(t-52)}}},{"bn.js":38,"double-bits":84}],30:[function(e,t,r){"use strict";var n=e("./num-to-bn");var i=e("./bn-sign");t.exports=a;function a(e,t){var r=i(e);var a=i(t);if(r===0){return[n(0),n(1)]}if(a===0){return[n(0),n(0)]}if(a<0){e=e.neg();t=t.neg()}var o=e.gcd(t);if(o.cmpn(1)){return[e.div(o),t.div(o)]}return[e,t]}},{"./bn-sign":25,"./num-to-bn":29}],31:[function(e,t,r){"use strict";var n=e("bn.js");t.exports=i;function i(e){return new n(e)}},{"bn.js":38}],32:[function(e,t,r){"use strict";var n=e("./lib/rationalize");t.exports=i;function i(e,t){return n(e[0].mul(t[0]),e[1].mul(t[1]))}},{"./lib/rationalize":30}],33:[function(e,t,r){"use strict";var n=e("./lib/bn-sign");t.exports=i;function i(e){return n(e[0])*n(e[1])}},{"./lib/bn-sign":25}],34:[function(e,t,r){"use strict";var n=e("./lib/rationalize");t.exports=i;function i(e,t){return n(e[0].mul(t[1]).sub(e[1].mul(t[0])),e[1].mul(t[1]))}},{"./lib/rationalize":30}],35:[function(e,t,r){"use strict";var n=e("./lib/bn-to-num");var i=e("./lib/ctz");t.exports=a;function a(e){var t=e[0];var r=e[1];if(t.cmpn(0)===0){return 0}var a=t.abs().divmod(r.abs());var o=a.div;var s=n(o);var l=a.mod;var u=t.negative!==r.negative?-1:1;if(l.cmpn(0)===0){return u*s}if(s){var f=i(s)+4;var c=n(l.ushln(f).divRound(r));return u*(s+c*Math.pow(2,-f))}else{var h=r.bitLength()-l.bitLength()+53;var c=n(l.ushln(h).divRound(r));if(h<1023){return u*c*Math.pow(2,-h)}c*=Math.pow(2,-1023);return u*c*Math.pow(2,1023-h)}}},{"./lib/bn-to-num":26,"./lib/ctz":27}],36:[function(e,t,r){"use strict";function n(e,t,r,n,i,a){var o=["function ",e,"(a,l,h,",n.join(","),"){",a?"":"var i=",r?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",i?".get(m)":"[m]"];if(a){if(t.indexOf("c")<0){o.push(";if(x===y){return m}else if(x<=y){")}else{o.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){")}}else{o.push(";if(",t,"){i=m;")}if(r){o.push("l=m+1}else{h=m-1}")}else{o.push("h=m-1}else{l=m+1}")}o.push("}");if(a){o.push("return -1};")}else{o.push("return i};")}return o.join("")}function i(e,t,r,i){var a=new Function([n("A","x"+e+"y",t,["y"],false,i),n("B","x"+e+"y",t,["y"],true,i),n("P","c(x,y)"+e+"0",t,["y","c"],false,i),n("Q","c(x,y)"+e+"0",t,["y","c"],true,i),"function dispatchBsearch",r,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",r].join(""));return a()}t.exports={ge:i(">=",false,"GE"),gt:i(">",false,"GT"),lt:i("<",true,"LT"),le:i("<=",true,"LE"),eq:i("-",true,"EQ",true)}},{}],37:[function(e,t,r){"use strict";"use restrict";var n=32;r.INT_BITS=n;r.INT_MAX=2147483647;r.INT_MIN=-1<<n-1;r.sign=function(e){return(e>0)-(e<0)};r.abs=function(e){var t=e>>n-1;return(e^t)-t};r.min=function(e,t){return t^(e^t)&-(e<t)};r.max=function(e,t){return e^(e^t)&-(e<t)};r.isPow2=function(e){return!(e&e-1)&&!!e};r.log2=function(e){var t,r;t=(e>65535)<<4;e>>>=t;r=(e>255)<<3;e>>>=r;t|=r;r=(e>15)<<2;e>>>=r;t|=r;r=(e>3)<<1;e>>>=r;t|=r;return t|e>>1};r.log10=function(e){return e>=1e9?9:e>=1e8?8:e>=1e7?7:e>=1e6?6:e>=1e5?5:e>=1e4?4:e>=1e3?3:e>=100?2:e>=10?1:0};r.popCount=function(e){e=e-(e>>>1&1431655765);e=(e&858993459)+(e>>>2&858993459);return(e+(e>>>4)&252645135)*16843009>>>24};function i(e){var t=32;e&=-e;if(e)t--;if(e&65535)t-=16;if(e&16711935)t-=8;if(e&252645135)t-=4;if(e&858993459)t-=2;if(e&1431655765)t-=1;return t}r.countTrailingZeros=i;r.nextPow2=function(e){e+=e===0;--e;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;return e+1};r.prevPow2=function(e){e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;return e-(e>>>1)};r.parity=function(e){e^=e>>>16;e^=e>>>8;e^=e>>>4;e&=15;return 27030>>>e&1};var a=new Array(256);(function(e){for(var t=0;t<256;++t){var r=t,n=t,i=7;for(r>>>=1;r;r>>>=1){n<<=1;n|=r&1;--i}e[t]=n<<i&255}})(a);r.reverse=function(e){return a[e&255]<<24|a[e>>>8&255]<<16|a[e>>>16&255]<<8|a[e>>>24&255]};r.interleave2=function(e,t){e&=65535;e=(e|e<<8)&16711935;e=(e|e<<4)&252645135;e=(e|e<<2)&858993459;e=(e|e<<1)&1431655765;t&=65535;t=(t|t<<8)&16711935;t=(t|t<<4)&252645135;t=(t|t<<2)&858993459;t=(t|t<<1)&1431655765;return e|t<<1};r.deinterleave2=function(e,t){e=e>>>t&1431655765;e=(e|e>>>1)&858993459;e=(e|e>>>2)&252645135;e=(e|e>>>4)&16711935;e=(e|e>>>16)&65535;return e<<16>>16};r.interleave3=function(e,t,r){e&=1023;e=(e|e<<16)&4278190335;e=(e|e<<8)&251719695;e=(e|e<<4)&3272356035;e=(e|e<<2)&1227133513;t&=1023;t=(t|t<<16)&4278190335;t=(t|t<<8)&251719695;t=(t|t<<4)&3272356035;t=(t|t<<2)&1227133513;e|=t<<1;r&=1023;r=(r|r<<16)&4278190335;r=(r|r<<8)&251719695;r=(r|r<<4)&3272356035;r=(r|r<<2)&1227133513;return e|r<<2};r.deinterleave3=function(e,t){e=e>>>t&1227133513;e=(e|e>>>2)&3272356035;e=(e|e>>>4)&251719695;e=(e|e>>>8)&4278190335;e=(e|e>>>16)&1023;return e<<22>>22};r.nextCombination=function(e){var t=e|e-1;return t+1|(~t&-~t)-1>>>i(e)+1}},{}],38:[function(e,t,r){(function(t,r){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype;e.prototype=new r;e.prototype.constructor=e}function a(e,t,r){if(a.isBN(e)){return e}this.negative=0;this.words=null;this.length=0;this.red=null;if(e!==null){if(t==="le"||t==="be"){r=t;t=10}this._init(e||0,t||10,r||"be")}}if(typeof t==="object"){t.exports=a}else{r.BN=a}a.BN=a;a.wordSize=26;var o;try{o=e("buffer").Buffer}catch(e){}a.isBN=function e(t){if(t instanceof a){return true}return t!==null&&typeof t==="object"&&t.constructor.wordSize===a.wordSize&&Array.isArray(t.words)};a.max=function e(t,r){if(t.cmp(r)>0)return t;return r};a.min=function e(t,r){if(t.cmp(r)<0)return t;return r};a.prototype._init=function e(t,r,i){if(typeof t==="number"){return this._initNumber(t,r,i)}if(typeof t==="object"){return this._initArray(t,r,i)}if(r==="hex"){r=16}n(r===(r|0)&&r>=2&&r<=36);t=t.toString().replace(/\s+/g,"");var a=0;if(t[0]==="-"){a++}if(r===16){this._parseHex(t,a)}else{this._parseBase(t,r,a)}if(t[0]==="-"){this.negative=1}this.strip();if(i!=="le")return;this._initArray(this.toArray(),r,i)};a.prototype._initNumber=function e(t,r,i){if(t<0){this.negative=1;t=-t}if(t<67108864){this.words=[t&67108863];this.length=1}else if(t<4503599627370496){this.words=[t&67108863,t/67108864&67108863];this.length=2}else{n(t<9007199254740992);this.words=[t&67108863,t/67108864&67108863,1];this.length=3}if(i!=="le")return;this._initArray(this.toArray(),r,i)};a.prototype._initArray=function e(t,r,i){n(typeof t.length==="number");if(t.length<=0){this.words=[0];this.length=1;return this}this.length=Math.ceil(t.length/3);this.words=new Array(this.length);for(var a=0;a<this.length;a++){this.words[a]=0}var o,s;var l=0;if(i==="be"){for(a=t.length-1,o=0;a>=0;a-=3){s=t[a]|t[a-1]<<8|t[a-2]<<16;this.words[o]|=s<<l&67108863;this.words[o+1]=s>>>26-l&67108863;l+=24;if(l>=26){l-=26;o++}}}else if(i==="le"){for(a=0,o=0;a<t.length;a+=3){s=t[a]|t[a+1]<<8|t[a+2]<<16;this.words[o]|=s<<l&67108863;this.words[o+1]=s>>>26-l&67108863;l+=24;if(l>=26){l-=26;o++}}}return this.strip()};function s(e,t,r){var n=0;var i=Math.min(e.length,r);for(var a=t;a<i;a++){var o=e.charCodeAt(a)-48;n<<=4;if(o>=49&&o<=54){n|=o-49+10}else if(o>=17&&o<=22){n|=o-17+10}else{n|=o&15}}return n}a.prototype._parseHex=function e(t,r){this.length=Math.ceil((t.length-r)/6);this.words=new Array(this.length);for(var n=0;n<this.length;n++){this.words[n]=0}var i,a;var o=0;for(n=t.length-6,i=0;n>=r;n-=6){a=s(t,n,n+6);this.words[i]|=a<<o&67108863;this.words[i+1]|=a>>>26-o&4194303;o+=24;if(o>=26){o-=26;i++}}if(n+6!==r){a=s(t,r,n+6);this.words[i]|=a<<o&67108863;this.words[i+1]|=a>>>26-o&4194303}this.strip()};function l(e,t,r,n){var i=0;var a=Math.min(e.length,r);for(var o=t;o<a;o++){var s=e.charCodeAt(o)-48;i*=n;if(s>=49){i+=s-49+10}else if(s>=17){i+=s-17+10}else{i+=s}}return i}a.prototype._parseBase=function e(t,r,n){this.words=[0];this.length=1;for(var i=0,a=1;a<=67108863;a*=r){i++}i--;a=a/r|0;var o=t.length-n;var s=o%i;var u=Math.min(o,o-s)+n;var f=0;for(var c=n;c<u;c+=i){f=l(t,c,c+i,r);this.imuln(a);if(this.words[0]+f<67108864){this.words[0]+=f}else{this._iaddn(f)}}if(s!==0){var h=1;f=l(t,c,t.length,r);for(c=0;c<s;c++){h*=r}this.imuln(h);if(this.words[0]+f<67108864){this.words[0]+=f}else{this._iaddn(f)}}};a.prototype.copy=function e(t){t.words=new Array(this.length);for(var r=0;r<this.length;r++){t.words[r]=this.words[r]}t.length=this.length;t.negative=this.negative;t.red=this.red};a.prototype.clone=function e(){var t=new a(null);this.copy(t);return t};a.prototype._expand=function e(t){while(this.length<t){this.words[this.length++]=0}return this};a.prototype.strip=function e(){while(this.length>1&&this.words[this.length-1]===0){this.length--}return this._normSign()};a.prototype._normSign=function e(){if(this.length===1&&this.words[0]===0){this.negative=0}return this};a.prototype.inspect=function e(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"];var f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5];var c=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function e(t,r){t=t||10;r=r|0||1;var i;if(t===16||t==="hex"){i="";var a=0;var o=0;for(var s=0;s<this.length;s++){var l=this.words[s];var h=((l<<a|o)&16777215).toString(16);o=l>>>24-a&16777215;if(o!==0||s!==this.length-1){i=u[6-h.length]+h+i}else{i=h+i}a+=2;if(a>=26){a-=26;s--}}if(o!==0){i=o.toString(16)+i}while(i.length%r!==0){i="0"+i}if(this.negative!==0){i="-"+i}return i}if(t===(t|0)&&t>=2&&t<=36){var v=f[t];var d=c[t];i="";var p=this.clone();p.negative=0;while(!p.isZero()){var g=p.modn(d).toString(t);p=p.idivn(d);if(!p.isZero()){i=u[v-g.length]+g+i}else{i=g+i}}if(this.isZero()){i="0"+i}while(i.length%r!==0){i="0"+i}if(this.negative!==0){i="-"+i}return i}n(false,"Base should be between 2 and 36")};a.prototype.toNumber=function e(){var t=this.words[0];if(this.length===2){t+=this.words[1]*67108864}else if(this.length===3&&this.words[2]===1){t+=4503599627370496+this.words[1]*67108864}else if(this.length>2){n(false,"Number can only safely store up to 53 bits")}return this.negative!==0?-t:t};a.prototype.toJSON=function e(){return this.toString(16)};a.prototype.toBuffer=function e(t,r){n(typeof o!=="undefined");return this.toArrayLike(o,t,r)};a.prototype.toArray=function e(t,r){return this.toArrayLike(Array,t,r)};a.prototype.toArrayLike=function e(t,r,i){var a=this.byteLength();var o=i||Math.max(1,a);n(a<=o,"byte array longer than desired length");n(o>0,"Requested array length <= 0");this.strip();var s=r==="le";var l=new t(o);var u,f;var c=this.clone();if(!s){for(f=0;f<o-a;f++){l[f]=0}for(f=0;!c.isZero();f++){u=c.andln(255);c.iushrn(8);l[o-f-1]=u}}else{for(f=0;!c.isZero();f++){u=c.andln(255);c.iushrn(8);l[f]=u}for(;f<o;f++){l[f]=0}}return l};if(Math.clz32){a.prototype._countBits=function e(t){return 32-Math.clz32(t)}}else{a.prototype._countBits=function e(t){var r=t;var n=0;if(r>=4096){n+=13;r>>>=13}if(r>=64){n+=7;r>>>=7}if(r>=8){n+=4;r>>>=4}if(r>=2){n+=2;r>>>=2}return n+r}}a.prototype._zeroBits=function e(t){if(t===0)return 26;var r=t;var n=0;if((r&8191)===0){n+=13;r>>>=13}if((r&127)===0){n+=7;r>>>=7}if((r&15)===0){n+=4;r>>>=4}if((r&3)===0){n+=2;r>>>=2}if((r&1)===0){n++}return n};a.prototype.bitLength=function e(){var t=this.words[this.length-1];var r=this._countBits(t);return(this.length-1)*26+r};function h(e){var t=new Array(e.bitLength());for(var r=0;r<t.length;r++){var n=r/26|0;var i=r%26;t[r]=(e.words[n]&1<<i)>>>i}return t}a.prototype.zeroBits=function e(){if(this.isZero())return 0;var t=0;for(var r=0;r<this.length;r++){var n=this._zeroBits(this.words[r]);t+=n;if(n!==26)break}return t};a.prototype.byteLength=function e(){return Math.ceil(this.bitLength()/8)};a.prototype.toTwos=function e(t){if(this.negative!==0){return this.abs().inotn(t).iaddn(1)}return this.clone()};a.prototype.fromTwos=function e(t){if(this.testn(t-1)){return this.notn(t).iaddn(1).ineg()}return this.clone()};a.prototype.isNeg=function e(){return this.negative!==0};a.prototype.neg=function e(){return this.clone().ineg()};a.prototype.ineg=function e(){if(!this.isZero()){this.negative^=1}return this};a.prototype.iuor=function e(t){while(this.length<t.length){this.words[this.length++]=0}for(var r=0;r<t.length;r++){this.words[r]=this.words[r]|t.words[r]}return this.strip()};a.prototype.ior=function e(t){n((this.negative|t.negative)===0);return this.iuor(t)};a.prototype.or=function e(t){if(this.length>t.length)return this.clone().ior(t);return t.clone().ior(this)};a.prototype.uor=function e(t){if(this.length>t.length)return this.clone().iuor(t);return t.clone().iuor(this)};a.prototype.iuand=function e(t){var r;if(this.length>t.length){r=t}else{r=this}for(var n=0;n<r.length;n++){this.words[n]=this.words[n]&t.words[n]}this.length=r.length;return this.strip()};a.prototype.iand=function e(t){n((this.negative|t.negative)===0);return this.iuand(t)};a.prototype.and=function e(t){if(this.length>t.length)return this.clone().iand(t);return t.clone().iand(this)};a.prototype.uand=function e(t){if(this.length>t.length)return this.clone().iuand(t);return t.clone().iuand(this)};a.prototype.iuxor=function e(t){var r;var n;if(this.length>t.length){r=this;n=t}else{r=t;n=this}for(var i=0;i<n.length;i++){this.words[i]=r.words[i]^n.words[i]}if(this!==r){for(;i<r.length;i++){this.words[i]=r.words[i]}}this.length=r.length;return this.strip()};a.prototype.ixor=function e(t){n((this.negative|t.negative)===0);return this.iuxor(t)};a.prototype.xor=function e(t){if(this.length>t.length)return this.clone().ixor(t);return t.clone().ixor(this)};a.prototype.uxor=function e(t){if(this.length>t.length)return this.clone().iuxor(t);return t.clone().iuxor(this)};a.prototype.inotn=function e(t){n(typeof t==="number"&&t>=0);var r=Math.ceil(t/26)|0;var i=t%26;this._expand(r);if(i>0){r--}for(var a=0;a<r;a++){this.words[a]=~this.words[a]&67108863}if(i>0){this.words[a]=~this.words[a]&67108863>>26-i}return this.strip()};a.prototype.notn=function e(t){return this.clone().inotn(t)};a.prototype.setn=function e(t,r){n(typeof t==="number"&&t>=0);var i=t/26|0;var a=t%26;this._expand(i+1);if(r){this.words[i]=this.words[i]|1<<a}else{this.words[i]=this.words[i]&~(1<<a)}return this.strip()};a.prototype.iadd=function e(t){var r;if(this.negative!==0&&t.negative===0){this.negative=0;r=this.isub(t);this.negative^=1;return this._normSign()}else if(this.negative===0&&t.negative!==0){t.negative=0;r=this.isub(t);t.negative=1;return r._normSign()}var n,i;if(this.length>t.length){n=this;i=t}else{n=t;i=this}var a=0;for(var o=0;o<i.length;o++){r=(n.words[o]|0)+(i.words[o]|0)+a;this.words[o]=r&67108863;a=r>>>26}for(;a!==0&&o<n.length;o++){r=(n.words[o]|0)+a;this.words[o]=r&67108863;a=r>>>26}this.length=n.length;if(a!==0){this.words[this.length]=a;this.length++}else if(n!==this){for(;o<n.length;o++){this.words[o]=n.words[o]}}return this};a.prototype.add=function e(t){var r;if(t.negative!==0&&this.negative===0){t.negative=0;r=this.sub(t);t.negative^=1;return r}else if(t.negative===0&&this.negative!==0){this.negative=0;r=t.sub(this);this.negative=1;return r}if(this.length>t.length)return this.clone().iadd(t);return t.clone().iadd(this)};a.prototype.isub=function e(t){if(t.negative!==0){t.negative=0;var r=this.iadd(t);t.negative=1;return r._normSign()}else if(this.negative!==0){this.negative=0;this.iadd(t);this.negative=1;return this._normSign()}var n=this.cmp(t);if(n===0){this.negative=0;this.length=1;this.words[0]=0;return this}var i,a;if(n>0){i=this;a=t}else{i=t;a=this}var o=0;for(var s=0;s<a.length;s++){r=(i.words[s]|0)-(a.words[s]|0)+o;o=r>>26;this.words[s]=r&67108863}for(;o!==0&&s<i.length;s++){r=(i.words[s]|0)+o;o=r>>26;this.words[s]=r&67108863}if(o===0&&s<i.length&&i!==this){for(;s<i.length;s++){this.words[s]=i.words[s]}}this.length=Math.max(this.length,s);if(i!==this){this.negative=1}return this.strip()};a.prototype.sub=function e(t){return this.clone().isub(t)};function v(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n;n=n-1|0;var i=e.words[0]|0;var a=t.words[0]|0;var o=i*a;var s=o&67108863;var l=o/67108864|0;r.words[0]=s;for(var u=1;u<n;u++){var f=l>>>26;var c=l&67108863;var h=Math.min(u,t.length-1);for(var v=Math.max(0,u-e.length+1);v<=h;v++){var d=u-v|0;i=e.words[d]|0;a=t.words[v]|0;o=i*a+c;f+=o/67108864|0;c=o&67108863}r.words[u]=c|0;l=f|0}if(l!==0){r.words[u]=l|0}else{r.length--}return r.strip()}var d=function e(t,r,n){var i=t.words;var a=r.words;var o=n.words;var s=0;var l;var u;var f;var c=i[0]|0;var h=c&8191;var v=c>>>13;var d=i[1]|0;var p=d&8191;var g=d>>>13;var m=i[2]|0;var y=m&8191;var b=m>>>13;var x=i[3]|0;var _=x&8191;var w=x>>>13;var M=i[4]|0;var A=M&8191;var T=M>>>13;var k=i[5]|0;var E=k&8191;var S=k>>>13;var L=i[6]|0;var C=L&8191;var I=L>>>13;var P=i[7]|0;var O=P&8191;var R=P>>>13;var N=i[8]|0;var z=N&8191;var D=N>>>13;var F=i[9]|0;var j=F&8191;var B=F>>>13;var U=a[0]|0;var V=U&8191;var H=U>>>13;var q=a[1]|0;var G=q&8191;var W=q>>>13;var X=a[2]|0;var Y=X&8191;var Z=X>>>13;var Q=a[3]|0;var K=Q&8191;var J=Q>>>13;var $=a[4]|0;var ee=$&8191;var te=$>>>13;var re=a[5]|0;var ne=re&8191;var ie=re>>>13;var ae=a[6]|0;var oe=ae&8191;var se=ae>>>13;var le=a[7]|0;var ue=le&8191;var fe=le>>>13;var ce=a[8]|0;var he=ce&8191;var ve=ce>>>13;var de=a[9]|0;var pe=de&8191;var ge=de>>>13;n.negative=t.negative^r.negative;n.length=19;l=Math.imul(h,V);u=Math.imul(h,H);u=u+Math.imul(v,V)|0;f=Math.imul(v,H);var me=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(me>>>26)|0;me&=67108863;l=Math.imul(p,V);u=Math.imul(p,H);u=u+Math.imul(g,V)|0;f=Math.imul(g,H);l=l+Math.imul(h,G)|0;u=u+Math.imul(h,W)|0;u=u+Math.imul(v,G)|0;f=f+Math.imul(v,W)|0;var ye=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(ye>>>26)|0;ye&=67108863;l=Math.imul(y,V);u=Math.imul(y,H);u=u+Math.imul(b,V)|0;f=Math.imul(b,H);l=l+Math.imul(p,G)|0;u=u+Math.imul(p,W)|0;u=u+Math.imul(g,G)|0;f=f+Math.imul(g,W)|0;l=l+Math.imul(h,Y)|0;u=u+Math.imul(h,Z)|0;u=u+Math.imul(v,Y)|0;f=f+Math.imul(v,Z)|0;var be=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(be>>>26)|0;be&=67108863;l=Math.imul(_,V);u=Math.imul(_,H);u=u+Math.imul(w,V)|0;f=Math.imul(w,H);l=l+Math.imul(y,G)|0;u=u+Math.imul(y,W)|0;u=u+Math.imul(b,G)|0;f=f+Math.imul(b,W)|0;l=l+Math.imul(p,Y)|0;u=u+Math.imul(p,Z)|0;u=u+Math.imul(g,Y)|0;f=f+Math.imul(g,Z)|0;l=l+Math.imul(h,K)|0;u=u+Math.imul(h,J)|0;u=u+Math.imul(v,K)|0;f=f+Math.imul(v,J)|0;var xe=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(xe>>>26)|0;xe&=67108863;l=Math.imul(A,V);u=Math.imul(A,H);u=u+Math.imul(T,V)|0;f=Math.imul(T,H);l=l+Math.imul(_,G)|0;u=u+Math.imul(_,W)|0;u=u+Math.imul(w,G)|0;f=f+Math.imul(w,W)|0;l=l+Math.imul(y,Y)|0;u=u+Math.imul(y,Z)|0;u=u+Math.imul(b,Y)|0;f=f+Math.imul(b,Z)|0;l=l+Math.imul(p,K)|0;u=u+Math.imul(p,J)|0;u=u+Math.imul(g,K)|0;f=f+Math.imul(g,J)|0;l=l+Math.imul(h,ee)|0;u=u+Math.imul(h,te)|0;u=u+Math.imul(v,ee)|0;f=f+Math.imul(v,te)|0;var _e=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(_e>>>26)|0;_e&=67108863;l=Math.imul(E,V);u=Math.imul(E,H);u=u+Math.imul(S,V)|0;f=Math.imul(S,H);l=l+Math.imul(A,G)|0;u=u+Math.imul(A,W)|0;u=u+Math.imul(T,G)|0;f=f+Math.imul(T,W)|0;l=l+Math.imul(_,Y)|0;u=u+Math.imul(_,Z)|0;u=u+Math.imul(w,Y)|0;f=f+Math.imul(w,Z)|0;l=l+Math.imul(y,K)|0;u=u+Math.imul(y,J)|0;u=u+Math.imul(b,K)|0;f=f+Math.imul(b,J)|0;l=l+Math.imul(p,ee)|0;u=u+Math.imul(p,te)|0;u=u+Math.imul(g,ee)|0;f=f+Math.imul(g,te)|0;l=l+Math.imul(h,ne)|0;u=u+Math.imul(h,ie)|0;u=u+Math.imul(v,ne)|0;f=f+Math.imul(v,ie)|0;var we=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(we>>>26)|0;we&=67108863;l=Math.imul(C,V);u=Math.imul(C,H);u=u+Math.imul(I,V)|0;f=Math.imul(I,H);l=l+Math.imul(E,G)|0;u=u+Math.imul(E,W)|0;u=u+Math.imul(S,G)|0;f=f+Math.imul(S,W)|0;l=l+Math.imul(A,Y)|0;u=u+Math.imul(A,Z)|0;u=u+Math.imul(T,Y)|0;f=f+Math.imul(T,Z)|0;l=l+Math.imul(_,K)|0;u=u+Math.imul(_,J)|0;u=u+Math.imul(w,K)|0;f=f+Math.imul(w,J)|0;l=l+Math.imul(y,ee)|0;u=u+Math.imul(y,te)|0;u=u+Math.imul(b,ee)|0;f=f+Math.imul(b,te)|0;l=l+Math.imul(p,ne)|0;u=u+Math.imul(p,ie)|0;u=u+Math.imul(g,ne)|0;f=f+Math.imul(g,ie)|0;l=l+Math.imul(h,oe)|0;u=u+Math.imul(h,se)|0;u=u+Math.imul(v,oe)|0;f=f+Math.imul(v,se)|0;var Me=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(Me>>>26)|0;Me&=67108863;l=Math.imul(O,V);u=Math.imul(O,H);u=u+Math.imul(R,V)|0;f=Math.imul(R,H);l=l+Math.imul(C,G)|0;u=u+Math.imul(C,W)|0;u=u+Math.imul(I,G)|0;f=f+Math.imul(I,W)|0;l=l+Math.imul(E,Y)|0;u=u+Math.imul(E,Z)|0;u=u+Math.imul(S,Y)|0;f=f+Math.imul(S,Z)|0;l=l+Math.imul(A,K)|0;u=u+Math.imul(A,J)|0;u=u+Math.imul(T,K)|0;f=f+Math.imul(T,J)|0;l=l+Math.imul(_,ee)|0;u=u+Math.imul(_,te)|0;u=u+Math.imul(w,ee)|0;f=f+Math.imul(w,te)|0;l=l+Math.imul(y,ne)|0;u=u+Math.imul(y,ie)|0;u=u+Math.imul(b,ne)|0;f=f+Math.imul(b,ie)|0;l=l+Math.imul(p,oe)|0;u=u+Math.imul(p,se)|0;u=u+Math.imul(g,oe)|0;f=f+Math.imul(g,se)|0;l=l+Math.imul(h,ue)|0;u=u+Math.imul(h,fe)|0;u=u+Math.imul(v,ue)|0;f=f+Math.imul(v,fe)|0;var Ae=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(Ae>>>26)|0;Ae&=67108863;l=Math.imul(z,V);u=Math.imul(z,H);u=u+Math.imul(D,V)|0;f=Math.imul(D,H);l=l+Math.imul(O,G)|0;u=u+Math.imul(O,W)|0;u=u+Math.imul(R,G)|0;f=f+Math.imul(R,W)|0;l=l+Math.imul(C,Y)|0;u=u+Math.imul(C,Z)|0;u=u+Math.imul(I,Y)|0;f=f+Math.imul(I,Z)|0;l=l+Math.imul(E,K)|0;u=u+Math.imul(E,J)|0;u=u+Math.imul(S,K)|0;f=f+Math.imul(S,J)|0;l=l+Math.imul(A,ee)|0;u=u+Math.imul(A,te)|0;u=u+Math.imul(T,ee)|0;f=f+Math.imul(T,te)|0;l=l+Math.imul(_,ne)|0;u=u+Math.imul(_,ie)|0;u=u+Math.imul(w,ne)|0;f=f+Math.imul(w,ie)|0;l=l+Math.imul(y,oe)|0;u=u+Math.imul(y,se)|0;u=u+Math.imul(b,oe)|0;f=f+Math.imul(b,se)|0;l=l+Math.imul(p,ue)|0;u=u+Math.imul(p,fe)|0;u=u+Math.imul(g,ue)|0;f=f+Math.imul(g,fe)|0;l=l+Math.imul(h,he)|0;u=u+Math.imul(h,ve)|0;u=u+Math.imul(v,he)|0;f=f+Math.imul(v,ve)|0;var Te=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(Te>>>26)|0;Te&=67108863;l=Math.imul(j,V);u=Math.imul(j,H);u=u+Math.imul(B,V)|0;f=Math.imul(B,H);l=l+Math.imul(z,G)|0;u=u+Math.imul(z,W)|0;u=u+Math.imul(D,G)|0;f=f+Math.imul(D,W)|0;l=l+Math.imul(O,Y)|0;u=u+Math.imul(O,Z)|0;u=u+Math.imul(R,Y)|0;f=f+Math.imul(R,Z)|0;l=l+Math.imul(C,K)|0;u=u+Math.imul(C,J)|0;u=u+Math.imul(I,K)|0;f=f+Math.imul(I,J)|0;l=l+Math.imul(E,ee)|0;u=u+Math.imul(E,te)|0;u=u+Math.imul(S,ee)|0;f=f+Math.imul(S,te)|0;l=l+Math.imul(A,ne)|0;u=u+Math.imul(A,ie)|0;u=u+Math.imul(T,ne)|0;f=f+Math.imul(T,ie)|0;l=l+Math.imul(_,oe)|0;u=u+Math.imul(_,se)|0;u=u+Math.imul(w,oe)|0;f=f+Math.imul(w,se)|0;l=l+Math.imul(y,ue)|0;u=u+Math.imul(y,fe)|0;u=u+Math.imul(b,ue)|0;f=f+Math.imul(b,fe)|0;l=l+Math.imul(p,he)|0;u=u+Math.imul(p,ve)|0;u=u+Math.imul(g,he)|0;f=f+Math.imul(g,ve)|0;l=l+Math.imul(h,pe)|0;u=u+Math.imul(h,ge)|0;u=u+Math.imul(v,pe)|0;f=f+Math.imul(v,ge)|0;var ke=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(ke>>>26)|0;ke&=67108863;l=Math.imul(j,G);u=Math.imul(j,W);u=u+Math.imul(B,G)|0;f=Math.imul(B,W);l=l+Math.imul(z,Y)|0;u=u+Math.imul(z,Z)|0;u=u+Math.imul(D,Y)|0;f=f+Math.imul(D,Z)|0;l=l+Math.imul(O,K)|0;u=u+Math.imul(O,J)|0;u=u+Math.imul(R,K)|0;f=f+Math.imul(R,J)|0;l=l+Math.imul(C,ee)|0;u=u+Math.imul(C,te)|0;u=u+Math.imul(I,ee)|0;f=f+Math.imul(I,te)|0;l=l+Math.imul(E,ne)|0;u=u+Math.imul(E,ie)|0;u=u+Math.imul(S,ne)|0;f=f+Math.imul(S,ie)|0;l=l+Math.imul(A,oe)|0;u=u+Math.imul(A,se)|0;u=u+Math.imul(T,oe)|0;f=f+Math.imul(T,se)|0;l=l+Math.imul(_,ue)|0;u=u+Math.imul(_,fe)|0;u=u+Math.imul(w,ue)|0;f=f+Math.imul(w,fe)|0;l=l+Math.imul(y,he)|0;u=u+Math.imul(y,ve)|0;u=u+Math.imul(b,he)|0;f=f+Math.imul(b,ve)|0;l=l+Math.imul(p,pe)|0;u=u+Math.imul(p,ge)|0;u=u+Math.imul(g,pe)|0;f=f+Math.imul(g,ge)|0;var Ee=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(Ee>>>26)|0;Ee&=67108863;l=Math.imul(j,Y);u=Math.imul(j,Z);u=u+Math.imul(B,Y)|0;f=Math.imul(B,Z);l=l+Math.imul(z,K)|0;u=u+Math.imul(z,J)|0;u=u+Math.imul(D,K)|0;f=f+Math.imul(D,J)|0;l=l+Math.imul(O,ee)|0;u=u+Math.imul(O,te)|0;u=u+Math.imul(R,ee)|0;f=f+Math.imul(R,te)|0;l=l+Math.imul(C,ne)|0;u=u+Math.imul(C,ie)|0;u=u+Math.imul(I,ne)|0;f=f+Math.imul(I,ie)|0;l=l+Math.imul(E,oe)|0;u=u+Math.imul(E,se)|0;u=u+Math.imul(S,oe)|0;f=f+Math.imul(S,se)|0;l=l+Math.imul(A,ue)|0;u=u+Math.imul(A,fe)|0;u=u+Math.imul(T,ue)|0;f=f+Math.imul(T,fe)|0;l=l+Math.imul(_,he)|0;u=u+Math.imul(_,ve)|0;u=u+Math.imul(w,he)|0;f=f+Math.imul(w,ve)|0;l=l+Math.imul(y,pe)|0;u=u+Math.imul(y,ge)|0;u=u+Math.imul(b,pe)|0;f=f+Math.imul(b,ge)|0;var Se=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(Se>>>26)|0;Se&=67108863;l=Math.imul(j,K);u=Math.imul(j,J);u=u+Math.imul(B,K)|0;f=Math.imul(B,J);l=l+Math.imul(z,ee)|0;u=u+Math.imul(z,te)|0;u=u+Math.imul(D,ee)|0;f=f+Math.imul(D,te)|0;l=l+Math.imul(O,ne)|0;u=u+Math.imul(O,ie)|0;u=u+Math.imul(R,ne)|0;f=f+Math.imul(R,ie)|0;l=l+Math.imul(C,oe)|0;u=u+Math.imul(C,se)|0;u=u+Math.imul(I,oe)|0;f=f+Math.imul(I,se)|0;l=l+Math.imul(E,ue)|0;u=u+Math.imul(E,fe)|0;u=u+Math.imul(S,ue)|0;f=f+Math.imul(S,fe)|0;l=l+Math.imul(A,he)|0;u=u+Math.imul(A,ve)|0;u=u+Math.imul(T,he)|0;f=f+Math.imul(T,ve)|0;l=l+Math.imul(_,pe)|0;u=u+Math.imul(_,ge)|0;u=u+Math.imul(w,pe)|0;f=f+Math.imul(w,ge)|0;var Le=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(Le>>>26)|0;Le&=67108863;l=Math.imul(j,ee);u=Math.imul(j,te);u=u+Math.imul(B,ee)|0;f=Math.imul(B,te);l=l+Math.imul(z,ne)|0;u=u+Math.imul(z,ie)|0;u=u+Math.imul(D,ne)|0;f=f+Math.imul(D,ie)|0;l=l+Math.imul(O,oe)|0;u=u+Math.imul(O,se)|0;u=u+Math.imul(R,oe)|0;f=f+Math.imul(R,se)|0;l=l+Math.imul(C,ue)|0;u=u+Math.imul(C,fe)|0;u=u+Math.imul(I,ue)|0;f=f+Math.imul(I,fe)|0;l=l+Math.imul(E,he)|0;u=u+Math.imul(E,ve)|0;u=u+Math.imul(S,he)|0;f=f+Math.imul(S,ve)|0;l=l+Math.imul(A,pe)|0;u=u+Math.imul(A,ge)|0;u=u+Math.imul(T,pe)|0;f=f+Math.imul(T,ge)|0;var Ce=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(Ce>>>26)|0;Ce&=67108863;l=Math.imul(j,ne);u=Math.imul(j,ie);u=u+Math.imul(B,ne)|0;f=Math.imul(B,ie);l=l+Math.imul(z,oe)|0;u=u+Math.imul(z,se)|0;u=u+Math.imul(D,oe)|0;f=f+Math.imul(D,se)|0;l=l+Math.imul(O,ue)|0;u=u+Math.imul(O,fe)|0;u=u+Math.imul(R,ue)|0;f=f+Math.imul(R,fe)|0;l=l+Math.imul(C,he)|0;u=u+Math.imul(C,ve)|0;u=u+Math.imul(I,he)|0;f=f+Math.imul(I,ve)|0;l=l+Math.imul(E,pe)|0;u=u+Math.imul(E,ge)|0;u=u+Math.imul(S,pe)|0;f=f+Math.imul(S,ge)|0;var Ie=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(Ie>>>26)|0;Ie&=67108863;l=Math.imul(j,oe);u=Math.imul(j,se);u=u+Math.imul(B,oe)|0;f=Math.imul(B,se);l=l+Math.imul(z,ue)|0;u=u+Math.imul(z,fe)|0;u=u+Math.imul(D,ue)|0;f=f+Math.imul(D,fe)|0;l=l+Math.imul(O,he)|0;u=u+Math.imul(O,ve)|0;u=u+Math.imul(R,he)|0;f=f+Math.imul(R,ve)|0;l=l+Math.imul(C,pe)|0;u=u+Math.imul(C,ge)|0;u=u+Math.imul(I,pe)|0;f=f+Math.imul(I,ge)|0;var Pe=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(Pe>>>26)|0;Pe&=67108863;l=Math.imul(j,ue);u=Math.imul(j,fe);u=u+Math.imul(B,ue)|0;f=Math.imul(B,fe);l=l+Math.imul(z,he)|0;u=u+Math.imul(z,ve)|0;u=u+Math.imul(D,he)|0;f=f+Math.imul(D,ve)|0;l=l+Math.imul(O,pe)|0;u=u+Math.imul(O,ge)|0;u=u+Math.imul(R,pe)|0;f=f+Math.imul(R,ge)|0;var Oe=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(Oe>>>26)|0;Oe&=67108863;l=Math.imul(j,he);u=Math.imul(j,ve);u=u+Math.imul(B,he)|0;f=Math.imul(B,ve);l=l+Math.imul(z,pe)|0;u=u+Math.imul(z,ge)|0;u=u+Math.imul(D,pe)|0;f=f+Math.imul(D,ge)|0;var Re=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(Re>>>26)|0;Re&=67108863;l=Math.imul(j,pe);u=Math.imul(j,ge);u=u+Math.imul(B,pe)|0;f=Math.imul(B,ge);var Ne=(s+l|0)+((u&8191)<<13)|0;s=(f+(u>>>13)|0)+(Ne>>>26)|0;Ne&=67108863;o[0]=me;o[1]=ye;o[2]=be;o[3]=xe;o[4]=_e;o[5]=we;o[6]=Me;o[7]=Ae;o[8]=Te;o[9]=ke;o[10]=Ee;o[11]=Se;o[12]=Le;o[13]=Ce;o[14]=Ie;o[15]=Pe;o[16]=Oe;o[17]=Re;o[18]=Ne;if(s!==0){o[19]=s;n.length++}return n};if(!Math.imul){d=v}function p(e,t,r){r.negative=t.negative^e.negative;r.length=e.length+t.length;var n=0;var i=0;for(var a=0;a<r.length-1;a++){var o=i;i=0;var s=n&67108863;var l=Math.min(a,t.length-1);for(var u=Math.max(0,a-e.length+1);u<=l;u++){var f=a-u;var c=e.words[f]|0;var h=t.words[u]|0;var v=c*h;var d=v&67108863;o=o+(v/67108864|0)|0;d=d+s|0;s=d&67108863;o=o+(d>>>26)|0;i+=o>>>26;o&=67108863}r.words[a]=s;n=o;o=i}if(n!==0){r.words[a]=n}else{r.length--}return r.strip()}function g(e,t,r){var n=new m;return n.mulp(e,t,r)}a.prototype.mulTo=function e(t,r){var n;var i=this.length+t.length;if(this.length===10&&t.length===10){n=d(this,t,r)}else if(i<63){n=v(this,t,r)}else if(i<1024){n=p(this,t,r)}else{n=g(this,t,r)}return n};function m(e,t){this.x=e;this.y=t}m.prototype.makeRBT=function e(t){var r=new Array(t);var n=a.prototype._countBits(t)-1;for(var i=0;i<t;i++){r[i]=this.revBin(i,n,t)}return r};m.prototype.revBin=function e(t,r,n){if(t===0||t===n-1)return t;var i=0;for(var a=0;a<r;a++){i|=(t&1)<<r-a-1;t>>=1}return i};m.prototype.permute=function e(t,r,n,i,a,o){for(var s=0;s<o;s++){i[s]=r[t[s]];a[s]=n[t[s]]}};m.prototype.transform=function e(t,r,n,i,a,o){this.permute(o,t,r,n,i,a);for(var s=1;s<a;s<<=1){var l=s<<1;var u=Math.cos(2*Math.PI/l);var f=Math.sin(2*Math.PI/l);for(var c=0;c<a;c+=l){var h=u;var v=f;for(var d=0;d<s;d++){var p=n[c+d];var g=i[c+d];var m=n[c+d+s];var y=i[c+d+s];var b=h*m-v*y;y=h*y+v*m;m=b;n[c+d]=p+m;i[c+d]=g+y;n[c+d+s]=p-m;i[c+d+s]=g-y;if(d!==l){b=u*h-f*v;v=u*v+f*h;h=b}}}}};m.prototype.guessLen13b=function e(t,r){var n=Math.max(r,t)|1;var i=n&1;var a=0;for(n=n/2|0;n;n=n>>>1){a++}return 1<<a+1+i};m.prototype.conjugate=function e(t,r,n){if(n<=1)return;for(var i=0;i<n/2;i++){var a=t[i];t[i]=t[n-i-1];t[n-i-1]=a;a=r[i];r[i]=-r[n-i-1];r[n-i-1]=-a}};m.prototype.normalize13b=function e(t,r){var n=0;for(var i=0;i<r/2;i++){var a=Math.round(t[2*i+1]/r)*8192+Math.round(t[2*i]/r)+n;t[i]=a&67108863;if(a<67108864){n=0}else{n=a/67108864|0}}return t};m.prototype.convert13b=function e(t,r,i,a){var o=0;for(var s=0;s<r;s++){o=o+(t[s]|0);i[2*s]=o&8191;o=o>>>13;i[2*s+1]=o&8191;o=o>>>13}for(s=2*r;s<a;++s){i[s]=0}n(o===0);n((o&~8191)===0)};m.prototype.stub=function e(t){var r=new Array(t);for(var n=0;n<t;n++){r[n]=0}return r};m.prototype.mulp=function e(t,r,n){var i=2*this.guessLen13b(t.length,r.length);var a=this.makeRBT(i);var o=this.stub(i);var s=new Array(i);var l=new Array(i);var u=new Array(i);var f=new Array(i);var c=new Array(i);var h=new Array(i);var v=n.words;v.length=i;this.convert13b(t.words,t.length,s,i);this.convert13b(r.words,r.length,f,i);this.transform(s,o,l,u,i,a);this.transform(f,o,c,h,i,a);for(var d=0;d<i;d++){var p=l[d]*c[d]-u[d]*h[d];u[d]=l[d]*h[d]+u[d]*c[d];l[d]=p}this.conjugate(l,u,i);this.transform(l,u,v,o,i,a);this.conjugate(v,o,i);this.normalize13b(v,i);n.negative=t.negative^r.negative;n.length=t.length+r.length;return n.strip()};a.prototype.mul=function e(t){var r=new a(null);r.words=new Array(this.length+t.length);return this.mulTo(t,r)};a.prototype.mulf=function e(t){var r=new a(null);r.words=new Array(this.length+t.length);return g(this,t,r)};a.prototype.imul=function e(t){return this.clone().mulTo(t,this)};a.prototype.imuln=function e(t){n(typeof t==="number");n(t<67108864);var r=0;for(var i=0;i<this.length;i++){var a=(this.words[i]|0)*t;var o=(a&67108863)+(r&67108863);r>>=26;r+=a/67108864|0;r+=o>>>26;this.words[i]=o&67108863}if(r!==0){this.words[i]=r;this.length++}return this};a.prototype.muln=function e(t){return this.clone().imuln(t)};a.prototype.sqr=function e(){return this.mul(this)};a.prototype.isqr=function e(){return this.imul(this.clone())};a.prototype.pow=function e(t){var r=h(t);if(r.length===0)return new a(1);var n=this;for(var i=0;i<r.length;i++,n=n.sqr()){if(r[i]!==0)break}if(++i<r.length){for(var o=n.sqr();i<r.length;i++,o=o.sqr()){if(r[i]===0)continue;n=n.mul(o)}}return n};a.prototype.iushln=function e(t){n(typeof t==="number"&&t>=0);var r=t%26;var i=(t-r)/26;var a=67108863>>>26-r<<26-r;var o;if(r!==0){var s=0;for(o=0;o<this.length;o++){var l=this.words[o]&a;var u=(this.words[o]|0)-l<<r;this.words[o]=u|s;s=l>>>26-r}if(s){this.words[o]=s;this.length++}}if(i!==0){for(o=this.length-1;o>=0;o--){this.words[o+i]=this.words[o]}for(o=0;o<i;o++){this.words[o]=0}this.length+=i}return this.strip()};a.prototype.ishln=function e(t){n(this.negative===0);return this.iushln(t)};a.prototype.iushrn=function e(t,r,i){n(typeof t==="number"&&t>=0);var a;if(r){a=(r-r%26)/26}else{a=0}var o=t%26;var s=Math.min((t-o)/26,this.length);var l=67108863^67108863>>>o<<o;var u=i;a-=s;a=Math.max(0,a);if(u){for(var f=0;f<s;f++){u.words[f]=this.words[f]}u.length=s}if(s===0){}else if(this.length>s){this.length-=s;for(f=0;f<this.length;f++){this.words[f]=this.words[f+s]}}else{this.words[0]=0;this.length=1}var c=0;for(f=this.length-1;f>=0&&(c!==0||f>=a);f--){var h=this.words[f]|0;this.words[f]=c<<26-o|h>>>o;c=h&l}if(u&&c!==0){u.words[u.length++]=c}if(this.length===0){this.words[0]=0;this.length=1}return this.strip()};a.prototype.ishrn=function e(t,r,i){n(this.negative===0);return this.iushrn(t,r,i)};a.prototype.shln=function e(t){return this.clone().ishln(t)};a.prototype.ushln=function e(t){return this.clone().iushln(t)};a.prototype.shrn=function e(t){return this.clone().ishrn(t)};a.prototype.ushrn=function e(t){return this.clone().iushrn(t)};a.prototype.testn=function e(t){n(typeof t==="number"&&t>=0);var r=t%26;var i=(t-r)/26;var a=1<<r;if(this.length<=i)return false;var o=this.words[i];return!!(o&a)};a.prototype.imaskn=function e(t){n(typeof t==="number"&&t>=0);var r=t%26;var i=(t-r)/26;n(this.negative===0,"imaskn works only with positive numbers");if(this.length<=i){return this}if(r!==0){i++}this.length=Math.min(i,this.length);if(r!==0){var a=67108863^67108863>>>r<<r;this.words[this.length-1]&=a}return this.strip()};a.prototype.maskn=function e(t){return this.clone().imaskn(t)};a.prototype.iaddn=function e(t){n(typeof t==="number");n(t<67108864);if(t<0)return this.isubn(-t);if(this.negative!==0){if(this.length===1&&(this.words[0]|0)<t){this.words[0]=t-(this.words[0]|0);this.negative=0;return this}this.negative=0;this.isubn(t);this.negative=1;return this}return this._iaddn(t)};a.prototype._iaddn=function e(t){this.words[0]+=t;for(var r=0;r<this.length&&this.words[r]>=67108864;r++){this.words[r]-=67108864;if(r===this.length-1){this.words[r+1]=1}else{this.words[r+1]++}}this.length=Math.max(this.length,r+1);return this};a.prototype.isubn=function e(t){n(typeof t==="number");n(t<67108864);if(t<0)return this.iaddn(-t);if(this.negative!==0){this.negative=0;this.iaddn(t);this.negative=1;return this}this.words[0]-=t;if(this.length===1&&this.words[0]<0){this.words[0]=-this.words[0];this.negative=1}else{for(var r=0;r<this.length&&this.words[r]<0;r++){this.words[r]+=67108864;this.words[r+1]-=1}}return this.strip()};a.prototype.addn=function e(t){return this.clone().iaddn(t)};a.prototype.subn=function e(t){return this.clone().isubn(t)};a.prototype.iabs=function e(){this.negative=0;return this};a.prototype.abs=function e(){return this.clone().iabs()};a.prototype._ishlnsubmul=function e(t,r,i){var a=t.length+i;var o;this._expand(a);var s;var l=0;for(o=0;o<t.length;o++){s=(this.words[o+i]|0)+l;var u=(t.words[o]|0)*r;s-=u&67108863;l=(s>>26)-(u/67108864|0);this.words[o+i]=s&67108863}for(;o<this.length-i;o++){s=(this.words[o+i]|0)+l;l=s>>26;this.words[o+i]=s&67108863}if(l===0)return this.strip();n(l===-1);l=0;for(o=0;o<this.length;o++){s=-(this.words[o]|0)+l;l=s>>26;this.words[o]=s&67108863}this.negative=1;return this.strip()};a.prototype._wordDiv=function e(t,r){var n=this.length-t.length;var i=this.clone();var o=t;var s=o.words[o.length-1]|0;var l=this._countBits(s);n=26-l;if(n!==0){o=o.ushln(n);i.iushln(n);s=o.words[o.length-1]|0}var u=i.length-o.length;var f;if(r!=="mod"){f=new a(null);f.length=u+1;f.words=new Array(f.length);for(var c=0;c<f.length;c++){f.words[c]=0}}var h=i.clone()._ishlnsubmul(o,1,u);if(h.negative===0){i=h;if(f){f.words[u]=1}}for(var v=u-1;v>=0;v--){var d=(i.words[o.length+v]|0)*67108864+(i.words[o.length+v-1]|0);d=Math.min(d/s|0,67108863);i._ishlnsubmul(o,d,v);while(i.negative!==0){d--;i.negative=0;i._ishlnsubmul(o,1,v);if(!i.isZero()){i.negative^=1}}if(f){f.words[v]=d}}if(f){f.strip()}i.strip();if(r!=="div"&&n!==0){i.iushrn(n)}return{div:f||null,mod:i}};a.prototype.divmod=function e(t,r,i){n(!t.isZero());if(this.isZero()){return{div:new a(0),mod:new a(0)}}var o,s,l;if(this.negative!==0&&t.negative===0){l=this.neg().divmod(t,r);if(r!=="mod"){o=l.div.neg()}if(r!=="div"){s=l.mod.neg();if(i&&s.negative!==0){s.iadd(t)}}return{div:o,mod:s}}if(this.negative===0&&t.negative!==0){l=this.divmod(t.neg(),r);if(r!=="mod"){o=l.div.neg()}return{div:o,mod:l.mod}}if((this.negative&t.negative)!==0){l=this.neg().divmod(t.neg(),r);if(r!=="div"){s=l.mod.neg();if(i&&s.negative!==0){s.isub(t)}}return{div:l.div,mod:s}}if(t.length>this.length||this.cmp(t)<0){return{div:new a(0),mod:this}}if(t.length===1){if(r==="div"){return{div:this.divn(t.words[0]),mod:null}}if(r==="mod"){return{div:null,mod:new a(this.modn(t.words[0]))}}return{div:this.divn(t.words[0]),mod:new a(this.modn(t.words[0]))}}return this._wordDiv(t,r)};a.prototype.div=function e(t){return this.divmod(t,"div",false).div};a.prototype.mod=function e(t){return this.divmod(t,"mod",false).mod};a.prototype.umod=function e(t){return this.divmod(t,"mod",true).mod};a.prototype.divRound=function e(t){var r=this.divmod(t);if(r.mod.isZero())return r.div;var n=r.div.negative!==0?r.mod.isub(t):r.mod;var i=t.ushrn(1);var a=t.andln(1);var o=n.cmp(i);if(o<0||a===1&&o===0)return r.div;return r.div.negative!==0?r.div.isubn(1):r.div.iaddn(1)};a.prototype.modn=function e(t){n(t<=67108863);var r=(1<<26)%t;var i=0;for(var a=this.length-1;a>=0;a--){i=(r*i+(this.words[a]|0))%t}return i};a.prototype.idivn=function e(t){n(t<=67108863);var r=0;for(var i=this.length-1;i>=0;i--){var a=(this.words[i]|0)+r*67108864;this.words[i]=a/t|0;r=a%t}return this.strip()};a.prototype.divn=function e(t){return this.clone().idivn(t)};a.prototype.egcd=function e(t){n(t.negative===0);n(!t.isZero());var r=this;var i=t.clone();if(r.negative!==0){r=r.umod(t)}else{r=r.clone()}var o=new a(1);var s=new a(0);var l=new a(0);var u=new a(1);var f=0;while(r.isEven()&&i.isEven()){r.iushrn(1);i.iushrn(1);++f}var c=i.clone();var h=r.clone();while(!r.isZero()){for(var v=0,d=1;(r.words[0]&d)===0&&v<26;++v,d<<=1);if(v>0){r.iushrn(v);while(v-- >0){if(o.isOdd()||s.isOdd()){o.iadd(c);s.isub(h)}o.iushrn(1);s.iushrn(1)}}for(var p=0,g=1;(i.words[0]&g)===0&&p<26;++p,g<<=1);if(p>0){i.iushrn(p);while(p-- >0){if(l.isOdd()||u.isOdd()){l.iadd(c);u.isub(h)}l.iushrn(1);u.iushrn(1)}}if(r.cmp(i)>=0){r.isub(i);o.isub(l);s.isub(u)}else{i.isub(r);l.isub(o);u.isub(s)}}return{a:l,b:u,gcd:i.iushln(f)}};a.prototype._invmp=function e(t){n(t.negative===0);n(!t.isZero());var r=this;var i=t.clone();if(r.negative!==0){r=r.umod(t)}else{r=r.clone()}var o=new a(1);var s=new a(0);var l=i.clone();while(r.cmpn(1)>0&&i.cmpn(1)>0){for(var u=0,f=1;(r.words[0]&f)===0&&u<26;++u,f<<=1);if(u>0){r.iushrn(u);while(u-- >0){if(o.isOdd()){o.iadd(l)}o.iushrn(1)}}for(var c=0,h=1;(i.words[0]&h)===0&&c<26;++c,h<<=1);if(c>0){i.iushrn(c);while(c-- >0){if(s.isOdd()){s.iadd(l)}s.iushrn(1)}}if(r.cmp(i)>=0){r.isub(i);o.isub(s)}else{i.isub(r);s.isub(o)}}var v;if(r.cmpn(1)===0){v=o}else{v=s}if(v.cmpn(0)<0){v.iadd(t)}return v};a.prototype.gcd=function e(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var r=this.clone();var n=t.clone();r.negative=0;n.negative=0;for(var i=0;r.isEven()&&n.isEven();i++){r.iushrn(1);n.iushrn(1)}do{while(r.isEven()){r.iushrn(1)}while(n.isEven()){n.iushrn(1)}var a=r.cmp(n);if(a<0){var o=r;r=n;n=o}else if(a===0||n.cmpn(1)===0){break}r.isub(n)}while(true);return n.iushln(i)};a.prototype.invm=function e(t){return this.egcd(t).a.umod(t)};a.prototype.isEven=function e(){return(this.words[0]&1)===0};a.prototype.isOdd=function e(){return(this.words[0]&1)===1};a.prototype.andln=function e(t){return this.words[0]&t};a.prototype.bincn=function e(t){n(typeof t==="number");var r=t%26;var i=(t-r)/26;var a=1<<r;if(this.length<=i){this._expand(i+1);this.words[i]|=a;return this}var o=a;for(var s=i;o!==0&&s<this.length;s++){var l=this.words[s]|0;l+=o;o=l>>>26;l&=67108863;this.words[s]=l}if(o!==0){this.words[s]=o;this.length++}return this};a.prototype.isZero=function e(){return this.length===1&&this.words[0]===0};a.prototype.cmpn=function e(t){var r=t<0;if(this.negative!==0&&!r)return-1;if(this.negative===0&&r)return 1;this.strip();var i;if(this.length>1){i=1}else{if(r){t=-t}n(t<=67108863,"Number is too big");var a=this.words[0]|0;i=a===t?0:a<t?-1:1}if(this.negative!==0)return-i|0;return i};a.prototype.cmp=function e(t){if(this.negative!==0&&t.negative===0)return-1;if(this.negative===0&&t.negative!==0)return 1;var r=this.ucmp(t);if(this.negative!==0)return-r|0;return r};a.prototype.ucmp=function e(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;var r=0;for(var n=this.length-1;n>=0;n--){var i=this.words[n]|0;var a=t.words[n]|0;if(i===a)continue;if(i<a){r=-1}else if(i>a){r=1}break}return r};a.prototype.gtn=function e(t){return this.cmpn(t)===1};a.prototype.gt=function e(t){return this.cmp(t)===1};a.prototype.gten=function e(t){return this.cmpn(t)>=0};a.prototype.gte=function e(t){return this.cmp(t)>=0};a.prototype.ltn=function e(t){return this.cmpn(t)===-1};a.prototype.lt=function e(t){return this.cmp(t)===-1};a.prototype.lten=function e(t){return this.cmpn(t)<=0};a.prototype.lte=function e(t){return this.cmp(t)<=0};a.prototype.eqn=function e(t){return this.cmpn(t)===0};a.prototype.eq=function e(t){return this.cmp(t)===0};a.red=function e(t){return new A(t)};a.prototype.toRed=function e(t){n(!this.red,"Already a number in reduction context");n(this.negative===0,"red works only with positives");return t.convertTo(this)._forceRed(t)};a.prototype.fromRed=function e(){n(this.red,"fromRed works only with numbers in reduction context");return this.red.convertFrom(this)};a.prototype._forceRed=function e(t){this.red=t;return this};a.prototype.forceRed=function e(t){n(!this.red,"Already a number in reduction context");return this._forceRed(t)};a.prototype.redAdd=function e(t){n(this.red,"redAdd works only with red numbers");return this.red.add(this,t)};a.prototype.redIAdd=function e(t){n(this.red,"redIAdd works only with red numbers");return this.red.iadd(this,t)};a.prototype.redSub=function e(t){n(this.red,"redSub works only with red numbers");return this.red.sub(this,t)};a.prototype.redISub=function e(t){n(this.red,"redISub works only with red numbers");return this.red.isub(this,t)};a.prototype.redShl=function e(t){n(this.red,"redShl works only with red numbers");return this.red.shl(this,t)};a.prototype.redMul=function e(t){n(this.red,"redMul works only with red numbers");this.red._verify2(this,t);return this.red.mul(this,t)};a.prototype.redIMul=function e(t){n(this.red,"redMul works only with red numbers");this.red._verify2(this,t);return this.red.imul(this,t)};a.prototype.redSqr=function e(){n(this.red,"redSqr works only with red numbers");this.red._verify1(this);return this.red.sqr(this)};a.prototype.redISqr=function e(){n(this.red,"redISqr works only with red numbers");this.red._verify1(this);return this.red.isqr(this)};a.prototype.redSqrt=function e(){n(this.red,"redSqrt works only with red numbers");this.red._verify1(this);return this.red.sqrt(this)};a.prototype.redInvm=function e(){n(this.red,"redInvm works only with red numbers");this.red._verify1(this);return this.red.invm(this)};a.prototype.redNeg=function e(){n(this.red,"redNeg works only with red numbers");this.red._verify1(this);return this.red.neg(this)};a.prototype.redPow=function e(t){n(this.red&&!t.red,"redPow(normalNum)");this.red._verify1(this);return this.red.pow(this,t)};var y={k256:null,p224:null,p192:null,p25519:null};function b(e,t){this.name=e;this.p=new a(t,16);this.n=this.p.bitLength();this.k=new a(1).iushln(this.n).isub(this.p);this.tmp=this._tmp()}b.prototype._tmp=function e(){var t=new a(null);t.words=new Array(Math.ceil(this.n/13));return t};b.prototype.ireduce=function e(t){var r=t;var n;do{this.split(r,this.tmp);r=this.imulK(r);r=r.iadd(this.tmp);n=r.bitLength()}while(n>this.n);var i=n<this.n?-1:r.ucmp(this.p);if(i===0){r.words[0]=0;r.length=1}else if(i>0){r.isub(this.p)}else{r.strip()}return r};b.prototype.split=function e(t,r){t.iushrn(this.n,0,r)};b.prototype.imulK=function e(t){return t.imul(this.k)};function x(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(x,b);x.prototype.split=function e(t,r){var n=4194303;var i=Math.min(t.length,9);for(var a=0;a<i;a++){r.words[a]=t.words[a]}r.length=i;if(t.length<=9){t.words[0]=0;t.length=1;return}var o=t.words[9];r.words[r.length++]=o&n;for(a=10;a<t.length;a++){var s=t.words[a]|0;t.words[a-10]=(s&n)<<4|o>>>22;o=s}o>>>=22;t.words[a-10]=o;if(o===0&&t.length>10){t.length-=10}else{t.length-=9}};x.prototype.imulK=function e(t){t.words[t.length]=0;t.words[t.length+1]=0;t.length+=2;var r=0;for(var n=0;n<t.length;n++){var i=t.words[n]|0;r+=i*977;t.words[n]=r&67108863;r=i*64+(r/67108864|0)}if(t.words[t.length-1]===0){t.length--;if(t.words[t.length-1]===0){t.length--}}return t};function _(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(_,b);function w(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(w,b);function M(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(M,b);M.prototype.imulK=function e(t){var r=0;for(var n=0;n<t.length;n++){var i=(t.words[n]|0)*19+r;var a=i&67108863;i>>>=26;t.words[n]=a;r=i}if(r!==0){t.words[t.length++]=r}return t};a._prime=function e(t){if(y[t])return y[t];var e;if(t==="k256"){e=new x}else if(t==="p224"){e=new _}else if(t==="p192"){e=new w}else if(t==="p25519"){e=new M}else{throw new Error("Unknown prime "+t)}y[t]=e;return e};function A(e){if(typeof e==="string"){var t=a._prime(e);this.m=t.p;this.prime=t}else{n(e.gtn(1),"modulus must be greater than 1");this.m=e;this.prime=null}}A.prototype._verify1=function e(t){n(t.negative===0,"red works only with positives");n(t.red,"red works only with red numbers")};A.prototype._verify2=function e(t,r){n((t.negative|r.negative)===0,"red works only with positives");n(t.red&&t.red===r.red,"red works only with red numbers")};A.prototype.imod=function e(t){if(this.prime)return this.prime.ireduce(t)._forceRed(this);return t.umod(this.m)._forceRed(this)};A.prototype.neg=function e(t){if(t.isZero()){return t.clone()}return this.m.sub(t)._forceRed(this)};A.prototype.add=function e(t,r){this._verify2(t,r);var n=t.add(r);if(n.cmp(this.m)>=0){n.isub(this.m)}return n._forceRed(this)};A.prototype.iadd=function e(t,r){this._verify2(t,r);var n=t.iadd(r);if(n.cmp(this.m)>=0){n.isub(this.m)}return n};A.prototype.sub=function e(t,r){this._verify2(t,r);var n=t.sub(r);if(n.cmpn(0)<0){n.iadd(this.m)}return n._forceRed(this)};A.prototype.isub=function e(t,r){this._verify2(t,r);var n=t.isub(r);if(n.cmpn(0)<0){n.iadd(this.m)}return n};A.prototype.shl=function e(t,r){this._verify1(t);return this.imod(t.ushln(r))};A.prototype.imul=function e(t,r){this._verify2(t,r);return this.imod(t.imul(r))};A.prototype.mul=function e(t,r){this._verify2(t,r);return this.imod(t.mul(r))};A.prototype.isqr=function e(t){return this.imul(t,t.clone())};A.prototype.sqr=function e(t){return this.mul(t,t)};A.prototype.sqrt=function e(t){if(t.isZero())return t.clone();var r=this.m.andln(3);n(r%2===1);if(r===3){var i=this.m.add(new a(1)).iushrn(2);return this.pow(t,i)}var o=this.m.subn(1);var s=0;while(!o.isZero()&&o.andln(1)===0){s++;o.iushrn(1)}n(!o.isZero());var l=new a(1).toRed(this);var u=l.redNeg();var f=this.m.subn(1).iushrn(1);var c=this.m.bitLength();c=new a(2*c*c).toRed(this);while(this.pow(c,f).cmp(u)!==0){c.redIAdd(u)}var h=this.pow(c,o);var v=this.pow(t,o.addn(1).iushrn(1));var d=this.pow(t,o);var p=s;while(d.cmp(l)!==0){var g=d;for(var m=0;g.cmp(l)!==0;m++){g=g.redSqr()}n(m<p);var y=this.pow(h,new a(1).iushln(p-m-1));v=v.redMul(y);h=y.redSqr();d=d.redMul(h);p=m}return v};A.prototype.invm=function e(t){var r=t._invmp(this.m);if(r.negative!==0){r.negative=0;return this.imod(r).redNeg()}else{return this.imod(r)}};A.prototype.pow=function e(t,r){if(r.isZero())return new a(1).toRed(this);if(r.cmpn(1)===0)return t.clone();var n=4;var i=new Array(1<<n);i[0]=new a(1).toRed(this);i[1]=t;for(var o=2;o<i.length;o++){i[o]=this.mul(i[o-1],t)}var s=i[0];var l=0;var u=0;var f=r.bitLength()%26;if(f===0){f=26}for(o=r.length-1;o>=0;o--){var c=r.words[o];for(var h=f-1;h>=0;h--){var v=c>>h&1;if(s!==i[0]){s=this.sqr(s)}if(v===0&&l===0){u=0;continue}l<<=1;l|=v;u++;if(u!==n&&(o!==0||h!==0))continue;s=this.mul(s,i[l]);u=0;l=0}f=26}return s};A.prototype.convertTo=function e(t){var r=t.umod(this.m);return r===t?r.clone():r};A.prototype.convertFrom=function e(t){var r=t.clone();r.red=null;return r};a.mont=function e(t){return new T(t)};function T(e){A.call(this,e);this.shift=this.m.bitLength();if(this.shift%26!==0){this.shift+=26-this.shift%26}this.r=new a(1).iushln(this.shift);this.r2=this.imod(this.r.sqr());this.rinv=this.r._invmp(this.m);this.minv=this.rinv.mul(this.r).isubn(1).div(this.m);this.minv=this.minv.umod(this.r);this.minv=this.r.sub(this.minv)}i(T,A);T.prototype.convertTo=function e(t){return this.imod(t.ushln(this.shift))};T.prototype.convertFrom=function e(t){var r=this.imod(t.mul(this.rinv));r.red=null;return r};T.prototype.imul=function e(t,r){if(t.isZero()||r.isZero()){t.words[0]=0;t.length=1;return t}var n=t.imul(r);var i=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var a=n.isub(i).iushrn(this.shift);var o=a;if(a.cmp(this.m)>=0){o=a.isub(this.m)}else if(a.cmpn(0)<0){o=a.iadd(this.m)}return o._forceRed(this)};T.prototype.mul=function e(t,r){if(t.isZero()||r.isZero())return new a(0)._forceRed(this);var n=t.mul(r);var i=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m);var o=n.isub(i).iushrn(this.shift);var s=o;if(o.cmp(this.m)>=0){s=o.isub(this.m)}else if(o.cmpn(0)<0){s=o.iadd(this.m)}return s._forceRed(this)};T.prototype.invm=function e(t){var r=this.imod(t._invmp(this.m).mul(this.r2));return r._forceRed(this)}})(typeof t==="undefined"||t,this)},{buffer:47}],39:[function(e,t,r){"use strict";t.exports=n;function n(e){var t,r,n;var i=e.length;var a=0;for(t=0;t<i;++t){a+=e[t].length}var o=new Array(a);var s=0;for(t=0;t<i;++t){var l=e[t];var u=l.length;for(r=0;r<u;++r){var f=o[s++]=new Array(u-1);var c=0;for(n=0;n<u;++n){if(n===r){continue}f[c++]=l[n]}if(r&1){var h=f[1];f[1]=f[0];f[0]=h}}}return o}},{}],40:[function(e,t,r){"use strict";t.exports=v;var n=e("typedarray-pool");var i=e("./lib/sweep");var a=e("./lib/intersect");function o(e,t){for(var r=0;r<e;++r){if(!(t[r]<=t[r+e])){return true}}return false}function s(e,t,r,n){var i=0;var a=0;for(var s=0,l=e.length;s<l;++s){var u=e[s];if(o(t,u)){continue}for(var f=0;f<2*t;++f){r[i++]=u[f]}n[a++]=s}return a}function l(e,t,r,o){var l=e.length;var u=t.length;if(l<=0||u<=0){return}var f=e[0].length>>>1;if(f<=0){return}var c;var h=n.mallocDouble(2*f*l);var v=n.mallocInt32(l);l=s(e,f,h,v);if(l>0){if(f===1&&o){i.init(l);c=i.sweepComplete(f,r,0,l,h,v,0,l,h,v)}else{var d=n.mallocDouble(2*f*u);var p=n.mallocInt32(u);u=s(t,f,d,p);if(u>0){i.init(l+u);if(f===1){c=i.sweepBipartite(f,r,0,l,h,v,0,u,d,p)}else{c=a(f,r,o,l,h,v,u,d,p)}n.free(d);n.free(p)}}n.free(h);n.free(v)}return c}var u;function f(e,t){u.push([e,t])}function c(e){u=[];l(e,e,f,true);return u}function h(e,t){u=[];l(e,t,f,false);return u}function v(e,t,r){var n;switch(arguments.length){case 1:return c(e);case 2:if(typeof t==="function"){return l(e,e,t,true)}else{return h(e,t)}case 3:return l(e,t,r,false);default:throw new Error("box-intersect: Invalid arguments")}}},{"./lib/intersect":42,"./lib/sweep":46,"typedarray-pool":333}],41:[function(e,t,r){"use strict";var n="d";var i="ax";var a="vv";var o="fp";var s="es";var l="rs";var u="re";var f="rb";var c="ri";var h="rp";var v="bs";var d="be";var p="bb";var g="bi";var m="bp";var y="rv";var b="Q";var x=[n,i,a,l,u,f,c,v,d,p,g];function _(e,t,r){var o="bruteForce"+(e?"Red":"Blue")+(t?"Flip":"")+(r?"Full":"");var _=["function ",o,"(",x.join(),"){","var ",s,"=2*",n,";"];var w="for(var i="+l+","+h+"="+s+"*"+l+";"+"i<"+u+";"+"++i,"+h+"+="+s+"){"+"var x0="+f+"["+i+"+"+h+"],"+"x1="+f+"["+i+"+"+h+"+"+n+"],"+"xi="+c+"[i];";var M="for(var j="+v+","+m+"="+s+"*"+v+";"+"j<"+d+";"+"++j,"+m+"+="+s+"){"+"var y0="+p+"["+i+"+"+m+"],"+(r?"y1="+p+"["+i+"+"+m+"+"+n+"],":"")+"yi="+g+"[j];";if(e){_.push(w,b,":",M)}else{_.push(M,b,":",w)}if(r){_.push("if(y1<x0||x1<y0)continue;")}else if(t){_.push("if(y0<=x0||x1<y0)continue;")}else{_.push("if(y0<x0||x1<y0)continue;")}_.push("for(var k="+i+"+1;k<"+n+";++k){"+"var r0="+f+"[k+"+h+"],"+"r1="+f+"[k+"+n+"+"+h+"],"+"b0="+p+"[k+"+m+"],"+"b1="+p+"[k+"+n+"+"+m+"];"+"if(r1<b0||b1<r0)continue "+b+";}"+"var "+y+"="+a+"(");if(t){_.push("yi,xi")}else{_.push("xi,yi")}_.push(");if("+y+"!==void 0)return "+y+";}}}");return{name:o,code:_.join("")}}function w(e){var t="bruteForce"+(e?"Full":"Partial");var r=[];var n=x.slice();if(!e){n.splice(3,0,o)}var i=["function "+t+"("+n.join()+"){"];function a(t,n){var a=_(t,n,e);r.push(a.code);i.push("return "+a.name+"("+x.join()+");")}i.push("if("+u+"-"+l+">"+d+"-"+v+"){");if(e){a(true,false);i.push("}else{");a(false,false)}else{i.push("if("+o+"){");a(true,true);i.push("}else{");a(true,false);i.push("}}else{if("+o+"){");a(false,true);i.push("}else{");a(false,false);i.push("}")}i.push("}}return "+t);var s=r.join("")+i.join("");var f=new Function(s);return f()}r.partial=w(false);r.full=w(true)},{}],42:[function(e,t,r){"use strict";t.exports=L;var n=e("typedarray-pool");var i=e("bit-twiddle");var a=e("./brute");var o=a.partial;var s=a.full;var l=e("./sweep");var u=e("./median");var f=e("./partition");var c=128;var h=1<<22;var v=1<<22;var d=f("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]);var p=f("lo===p0",["p0"]);var g=f("lo<p0",["p0"]);var m=f("hi<=p0",["p0"]);var y=f("lo<=p0&&p0<=hi",["p0"]);var b=f("lo<p0&&p0<=hi",["p0"]);var x=6;var _=2;var w=1024;var M=n.mallocInt32(w);var A=n.mallocDouble(w);function T(e,t){var r=8*i.log2(t+1)*(e+1)|0;var a=i.nextPow2(x*r);if(M.length<a){n.free(M);M=n.mallocInt32(a)}var o=i.nextPow2(_*r);if(A<o){n.free(A);A=n.mallocDouble(o)}}function k(e,t,r,n,i,a,o,s,l){var u=x*e;M[u]=t;M[u+1]=r;M[u+2]=n;M[u+3]=i;M[u+4]=a;M[u+5]=o;var f=_*e;A[f]=s;A[f+1]=l}function E(e,t,r,n,i,a,o,s,l,u,f){var c=2*e;var h=l*c;var v=u[h+t];e:for(var d=i,p=i*c;d<a;++d,p+=c){var g=o[p+t];var m=o[p+t+e];if(v<g||m<v){continue}if(n&&v===g){continue}var y=s[d];for(var b=t+1;b<e;++b){var g=o[p+b];var m=o[p+b+e];var x=u[h+b];var _=u[h+b+e];if(m<x||_<g){continue e}}var w;if(n){w=r(f,y)}else{w=r(y,f)}if(w!==void 0){return w}}}function S(e,t,r,n,i,a,o,s,l,u){var f=2*e;var c=s*f;var h=l[c+t];e:for(var v=n,d=n*f;v<i;++v,d+=f){var p=o[v];if(p===u){continue}var g=a[d+t];var m=a[d+t+e];if(h<g||m<h){continue}for(var y=t+1;y<e;++y){var g=a[d+y];var m=a[d+y+e];var b=l[c+y];var x=l[c+y+e];if(m<b||x<g){continue e}}var _=r(p,u);if(_!==void 0){return _}}}function L(e,t,r,n,i,a,f,w,L){T(e,n+f);var C=0;var I=2*e;var P;k(C++,0,0,n,0,f,r?16:0,-Infinity,Infinity);if(!r){k(C++,0,0,f,0,n,1,-Infinity,Infinity)}while(C>0){C-=1;var O=C*x;var R=M[O];var N=M[O+1];var z=M[O+2];var D=M[O+3];var F=M[O+4];var j=M[O+5];var B=C*_;var U=A[B];var V=A[B+1];var H=j&1;var q=!!(j&16);var G=i;var W=a;var X=w;var Y=L;if(H){G=w;W=L;X=i;Y=a}if(j&2){z=g(e,R,N,z,G,W,V);if(N>=z){continue}}if(j&4){N=m(e,R,N,z,G,W,U);if(N>=z){continue}}var Z=z-N;var Q=F-D;if(q){if(e*Z*(Z+Q)<v){P=l.scanComplete(e,R,t,N,z,G,W,D,F,X,Y);if(P!==void 0){return P}continue}}else{if(e*Math.min(Z,Q)<c){P=o(e,R,t,H,N,z,G,W,D,F,X,Y);if(P!==void 0){return P}continue}else if(e*Z*Q<h){P=l.scanBipartite(e,R,t,H,N,z,G,W,D,F,X,Y);if(P!==void 0){return P}continue}}var K=d(e,R,N,z,G,W,U,V);if(N<K){if(e*(K-N)<c){P=s(e,R+1,t,N,K,G,W,D,F,X,Y);if(P!==void 0){return P}}else if(R===e-2){if(H){P=l.sweepBipartite(e,t,D,F,X,Y,N,K,G,W)}else{P=l.sweepBipartite(e,t,N,K,G,W,D,F,X,Y)}if(P!==void 0){return P}}else{k(C++,R+1,N,K,D,F,H,-Infinity,Infinity);k(C++,R+1,D,F,N,K,H^1,-Infinity,Infinity)}}if(K<z){var J=u(e,R,D,F,X,Y);var $=X[I*J+R];var ee=p(e,R,J,F,X,Y,$);if(ee<F){k(C++,R,K,z,ee,F,(H|4)+(q?16:0),$,V)}if(D<J){k(C++,R,K,z,D,J,(H|2)+(q?16:0),U,$)}if(J+1===ee){if(q){P=S(e,R,t,K,z,G,W,J,X,Y[J])}else{P=E(e,R,t,H,K,z,G,W,J,X,Y[J])}if(P!==void 0){return P}}else if(J<ee){var te;if(q){te=y(e,R,K,z,G,W,$);if(K<te){var re=p(e,R,K,te,G,W,$);if(R===e-2){if(K<re){P=l.sweepComplete(e,t,K,re,G,W,J,ee,X,Y);if(P!==void 0){return P}}if(re<te){P=l.sweepBipartite(e,t,re,te,G,W,J,ee,X,Y);if(P!==void 0){return P}}}else{if(K<re){k(C++,R+1,K,re,J,ee,16,-Infinity,Infinity)}if(re<te){k(C++,R+1,re,te,J,ee,0,-Infinity,Infinity);k(C++,R+1,J,ee,re,te,1,-Infinity,Infinity)}}}}else{if(H){te=b(e,R,K,z,G,W,$)}else{te=y(e,R,K,z,G,W,$)}if(K<te){if(R===e-2){if(H){P=l.sweepBipartite(e,t,J,ee,X,Y,K,te,G,W)}else{P=l.sweepBipartite(e,t,K,te,G,W,J,ee,X,Y)}}else{k(C++,R+1,K,te,J,ee,H,-Infinity,Infinity);k(C++,R+1,J,ee,K,te,H^1,-Infinity,Infinity)}}}}}}}},{"./brute":41,"./median":43,"./partition":44,"./sweep":46,"bit-twiddle":37,"typedarray-pool":333}],43:[function(e,t,r){"use strict";t.exports=s;var n=e("./partition");var i=n("lo<p0",["p0"]);var a=8;function o(e,t,r,n,i,a){var o=2*e;var s=o*(r+1)+t;for(var l=r+1;l<n;++l,s+=o){var u=i[s];for(var f=l,c=o*(l-1);f>r&&i[c+t]>u;--f,c-=o){var h=c;var v=c+o;for(var d=0;d<o;++d,++h,++v){var p=i[h];i[h]=i[v];i[v]=p}var g=a[f];a[f]=a[f-1];a[f-1]=g}}}function s(e,t,r,n,s,l){if(n<=r+1){return r}var u=r;var f=n;var c=n+r>>>1;var h=2*e;var v=c;var d=s[h*c+t];while(u<f){if(f-u<a){o(e,t,u,f,s,l);d=s[h*c+t];break}var p=f-u;var g=Math.random()*p+u|0;var m=s[h*g+t];var y=Math.random()*p+u|0;var b=s[h*y+t];var x=Math.random()*p+u|0;var _=s[h*x+t];if(m<=b){if(_>=b){v=y;d=b}else if(m>=_){v=g;d=m}else{v=x;d=_}}else{if(b>=_){v=y;d=b}else if(_>=m){v=g;d=m}else{v=x;d=_}}var w=h*(f-1);var M=h*v;for(var A=0;A<h;++A,++w,++M){var T=s[w];s[w]=s[M];s[M]=T}var k=l[f-1];l[f-1]=l[v];l[v]=k;v=i(e,t,u,f-1,s,l,d);var w=h*(f-1);var M=h*v;for(var A=0;A<h;++A,++w,++M){var T=s[w];s[w]=s[M];s[M]=T}var k=l[f-1];l[f-1]=l[v];l[v]=k;if(c<v){f=v-1;while(u<f&&s[h*(f-1)+t]===d){f-=1}f+=1}else if(v<c){u=v+1;while(u<f&&s[h*u+t]===d){u+=1}}else{break}}return i(e,t,r,c,s,l,s[h*c+t])}},{"./partition":44}],44:[function(e,t,r){"use strict";t.exports=i;var n="for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m";function i(e,t){var r="abcdef".split("").concat(t);var i=[];if(e.indexOf("lo")>=0){i.push("lo=e[k+n]")}if(e.indexOf("hi")>=0){i.push("hi=e[k+o]")}r.push(n.replace("_",i.join()).replace("$",e));return Function.apply(void 0,r)}},{}],45:[function(e,t,r){"use strict";t.exports=i;var n=32;function i(e,t){if(t<=4*n){a(0,t-1,e)}else{h(0,t-1,e)}}function a(e,t,r){var n=2*(e+1);for(var i=e+1;i<=t;++i){var a=r[n++];var o=r[n++];var s=i;var l=n-2;while(s-- >e){var u=r[l-2];var f=r[l-1];if(u<a){break}else if(u===a&&f<o){break}r[l]=u;r[l+1]=f;l-=2}r[l]=a;r[l+1]=o}}function o(e,t,r){e*=2;t*=2;var n=r[e];var i=r[e+1];r[e]=r[t];r[e+1]=r[t+1];r[t]=n;r[t+1]=i}function s(e,t,r){e*=2;t*=2;r[e]=r[t];r[e+1]=r[t+1]}function l(e,t,r,n){e*=2;t*=2;r*=2;var i=n[e];var a=n[e+1];n[e]=n[t];n[e+1]=n[t+1];n[t]=n[r];n[t+1]=n[r+1];n[r]=i;n[r+1]=a}function u(e,t,r,n,i){e*=2;t*=2;i[e]=i[t];i[t]=r;i[e+1]=i[t+1];i[t+1]=n}function f(e,t,r){e*=2;t*=2;var n=r[e],i=r[t];if(n<i){return false}else if(n===i){return r[e+1]>r[t+1]}return true}function c(e,t,r,n){e*=2;var i=n[e];if(i<t){return true}else if(i===t){return n[e+1]<r}return false}function h(e,t,r){var i=(t-e+1)/6|0,v=e+i,d=t-i,p=e+t>>1,g=p-i,m=p+i,y=v,b=g,x=p,_=m,w=d,M=e+1,A=t-1,T=0;if(f(y,b,r)){T=y;y=b;b=T}if(f(_,w,r)){T=_;_=w;w=T}if(f(y,x,r)){T=y;y=x;x=T}if(f(b,x,r)){T=b;b=x;x=T}if(f(y,_,r)){T=y;y=_;_=T}if(f(x,_,r)){T=x;x=_;_=T}if(f(b,w,r)){T=b;b=w;w=T}if(f(b,x,r)){T=b;b=x;x=T}if(f(_,w,r)){T=_;_=w;w=T}var k=r[2*b];var E=r[2*b+1];var S=r[2*_];var L=r[2*_+1];var C=2*y;var I=2*x;var P=2*w;var O=2*v;var R=2*p;var N=2*d;for(var z=0;z<2;++z){var D=r[C+z];var F=r[I+z];var j=r[P+z];r[O+z]=D;r[R+z]=F;r[N+z]=j}s(g,e,r);s(m,t,r);for(var B=M;B<=A;++B){if(c(B,k,E,r)){if(B!==M){o(B,M,r)}++M}else{if(!c(B,S,L,r)){while(true){if(!c(A,S,L,r)){if(--A<B){break}continue}else{if(c(A,k,E,r)){l(B,M,A,r);++M;--A}else{o(B,A,r);--A}break}}}}}u(e,M-1,k,E,r);u(t,A+1,S,L,r);if(M-2-e<=n){a(e,M-2,r)}else{h(e,M-2,r)}if(t-(A+2)<=n){a(A+2,t,r)}else{h(A+2,t,r)}if(A-M<=n){a(M,A,r)}else{h(M,A,r)}}},{}],46:[function(e,t,r){"use strict";t.exports={init:p,sweepBipartite:y,sweepComplete:b,scanBipartite:x,scanComplete:_};var n=e("typedarray-pool");var i=e("bit-twiddle");var a=e("./sort");var o=1<<28;var s=1024;var l=n.mallocInt32(s);var u=n.mallocInt32(s);var f=n.mallocInt32(s);var c=n.mallocInt32(s);var h=n.mallocInt32(s);var v=n.mallocInt32(s);var d=n.mallocDouble(s*8);function p(e){var t=i.nextPow2(e);if(l.length<t){n.free(l);l=n.mallocInt32(t)}if(u.length<t){n.free(u);u=n.mallocInt32(t)}if(f.length<t){n.free(f);f=n.mallocInt32(t)}if(c.length<t){n.free(c);c=n.mallocInt32(t)}if(h.length<t){n.free(h);h=n.mallocInt32(t)}if(v.length<t){n.free(v);v=n.mallocInt32(t)}var r=8*t;if(d.length<r){n.free(d);d=n.mallocDouble(r)}}function g(e,t,r,n){var i=t[n];var a=e[r-1];e[i]=a;t[a]=i}function m(e,t,r,n){e[r]=n;t[n]=r}function y(e,t,r,n,i,s,h,v,p,y){var b=0;var x=2*e;var _=e-1;var w=x-1;for(var M=r;M<n;++M){var A=s[M];var T=x*M;d[b++]=i[T+_];d[b++]=-(A+1);d[b++]=i[T+w];d[b++]=A}for(var M=h;M<v;++M){var A=y[M]+o;var k=x*M;d[b++]=p[k+_];d[b++]=-A;d[b++]=p[k+w];d[b++]=A}var E=b>>>1;a(d,E);var S=0;var L=0;for(var M=0;M<E;++M){var C=d[2*M+1]|0;if(C>=o){C=C-o|0;g(f,c,L--,C)}else if(C>=0){g(l,u,S--,C)}else if(C<=-o){C=-C-o|0;for(var I=0;I<S;++I){var P=t(l[I],C);if(P!==void 0){return P}}m(f,c,L++,C)}else{C=-C-1|0;for(var I=0;I<L;++I){var P=t(C,f[I]);if(P!==void 0){return P}}m(l,u,S++,C)}}}function b(e,t,r,n,i,o,s,p,y,b){var x=0;var _=2*e;var w=e-1;var M=_-1;for(var A=r;A<n;++A){var T=o[A]+1<<1;var k=_*A;d[x++]=i[k+w];d[x++]=-T;d[x++]=i[k+M];d[x++]=T}for(var A=s;A<p;++A){var T=b[A]+1<<1;var E=_*A;d[x++]=y[E+w];d[x++]=-T|1;d[x++]=y[E+M];d[x++]=T|1}var S=x>>>1;a(d,S);var L=0;var C=0;var I=0;for(var A=0;A<S;++A){var P=d[2*A+1]|0;var O=P&1;if(A<S-1&&P>>1===d[2*A+3]>>1){O=2;A+=1}if(P<0){var R=-(P>>1)-1;for(var N=0;N<I;++N){var z=t(h[N],R);if(z!==void 0){return z}}if(O!==0){for(var N=0;N<L;++N){var z=t(l[N],R);if(z!==void 0){return z}}}if(O!==1){for(var N=0;N<C;++N){var z=t(f[N],R);if(z!==void 0){return z}}}if(O===0){m(l,u,L++,R)}else if(O===1){m(f,c,C++,R)}else if(O===2){m(h,v,I++,R)}}else{var R=(P>>1)-1;if(O===0){g(l,u,L--,R)}else if(O===1){g(f,c,C--,R)}else if(O===2){g(h,v,I--,R)}}}}function x(e,t,r,n,i,s,f,c,h,v,p,y){var b=0;var x=2*e;var _=t;var w=t+e;var M=1;var A=1;if(n){A=o}else{M=o}for(var T=i;T<s;++T){var k=T+M;var E=x*T;d[b++]=f[E+_];d[b++]=-k;d[b++]=f[E+w];d[b++]=k}for(var T=h;T<v;++T){var k=T+A;var S=x*T;d[b++]=p[S+_];d[b++]=-k}var L=b>>>1;a(d,L);var C=0;for(var T=0;T<L;++T){var I=d[2*T+1]|0;if(I<0){var k=-I;var P=false;if(k>=o){P=!n;k-=o}else{P=!!n;k-=1}if(P){m(l,u,C++,k)}else{var O=y[k];var R=x*k;var N=p[R+t+1];var z=p[R+t+1+e];e:for(var D=0;D<C;++D){var F=l[D];var j=x*F;if(z<f[j+t+1]||f[j+t+1+e]<N){continue}for(var B=t+2;B<e;++B){if(p[R+B+e]<f[j+B]||f[j+B+e]<p[R+B]){continue e}}var U=c[F];var V;if(n){V=r(O,U)}else{V=r(U,O)}if(V!==void 0){return V}}}}else{g(l,u,C--,I-M)}}}function _(e,t,r,n,i,s,u,f,c,h,v){var p=0;var g=2*e;var m=t;var y=t+e;for(var b=n;b<i;++b){var x=b+o;var _=g*b;d[p++]=s[_+m];d[p++]=-x;d[p++]=s[_+y];d[p++]=x}for(var b=f;b<c;++b){var x=b+1;var w=g*b;d[p++]=h[w+m];d[p++]=-x}var M=p>>>1;a(d,M);var A=0;for(var b=0;b<M;++b){var T=d[2*b+1]|0;if(T<0){var x=-T;if(x>=o){l[A++]=x-o}else{x-=1;var k=v[x];var E=g*x;var S=h[E+t+1];var L=h[E+t+1+e];e:for(var C=0;C<A;++C){var I=l[C];var P=u[I];if(P===k){break}var O=g*I;if(L<s[O+t+1]||s[O+t+1+e]<S){continue}for(var R=t+2;R<e;++R){if(h[E+R+e]<s[O+R]||s[O+R+e]<h[E+R]){continue e}}var N=r(P,k);if(N!==void 0){return N}}}}else{var x=T-o;for(var C=A-1;C>=0;--C){if(l[C]===x){for(var R=C+1;R<A;++R){l[R-1]=l[R]}break}}--A}}}},{"./sort":45,"bit-twiddle":37,"typedarray-pool":333}],47:[function(e,t,r){},{}],48:[function(e,t,r){"use strict";var n=e("base64-js");var i=e("ieee754");r.Buffer=l;r.SlowBuffer=y;r.INSPECT_MAX_BYTES=50;var a=2147483647;r.kMaxLength=a;l.TYPED_ARRAY_SUPPORT=o();if(!l.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function o(){try{var e=new Uint8Array(1);e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return e.foo()===42}catch(e){return false}}Object.defineProperty(l.prototype,"parent",{get:function(){if(!(this instanceof l)){return undefined}return this.buffer}});Object.defineProperty(l.prototype,"offset",{get:function(){if(!(this instanceof l)){return undefined}return this.byteOffset}});function s(e){if(e>a){throw new RangeError("Invalid typed array length")}var t=new Uint8Array(e);t.__proto__=l.prototype;return t}function l(e,t,r){if(typeof e==="number"){if(typeof t==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return h(e)}return u(e,t,r)}if(typeof Symbol!=="undefined"&&Symbol.species&&l[Symbol.species]===l){Object.defineProperty(l,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}l.poolSize=8192;function u(e,t,r){if(typeof e==="number"){throw new TypeError('"value" argument must not be a number')}if(K(e)||e&&K(e.buffer)){return p(e,t,r)}if(typeof e==="string"){return v(e,t)}return g(e)}l.from=function(e,t,r){return u(e,t,r)};l.prototype.__proto__=Uint8Array.prototype;l.__proto__=Uint8Array;function f(e){if(typeof e!=="number"){throw new TypeError('"size" argument must be of type number')}else if(e<0){throw new RangeError('"size" argument must not be negative')}}function c(e,t,r){f(e);if(e<=0){return s(e)}if(t!==undefined){return typeof r==="string"?s(e).fill(t,r):s(e).fill(t)}return s(e)}l.alloc=function(e,t,r){return c(e,t,r)};function h(e){f(e);return s(e<0?0:m(e)|0)}l.allocUnsafe=function(e){return h(e)};l.allocUnsafeSlow=function(e){return h(e)};function v(e,t){if(typeof t!=="string"||t===""){t="utf8"}if(!l.isEncoding(t)){throw new TypeError("Unknown encoding: "+t)}var r=b(e,t)|0;var n=s(r);var i=n.write(e,t);if(i!==r){n=n.slice(0,i)}return n}function d(e){var t=e.length<0?0:m(e.length)|0;var r=s(t);for(var n=0;n<t;n+=1){r[n]=e[n]&255}return r}function p(e,t,r){if(t<0||e.byteLength<t){throw new RangeError('"offset" is outside of buffer bounds')}if(e.byteLength<t+(r||0)){throw new RangeError('"length" is outside of buffer bounds')}var n;if(t===undefined&&r===undefined){n=new Uint8Array(e)}else if(r===undefined){n=new Uint8Array(e,t)}else{n=new Uint8Array(e,t,r)}n.__proto__=l.prototype;return n}function g(e){if(l.isBuffer(e)){var t=m(e.length)|0;var r=s(t);if(r.length===0){return r}e.copy(r,0,0,t);return r}if(e){if(ArrayBuffer.isView(e)||"length"in e){if(typeof e.length!=="number"||J(e.length)){return s(0)}return d(e)}if(e.type==="Buffer"&&Array.isArray(e.data)){return d(e.data)}}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}function m(e){if(e>=a){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+a.toString(16)+" bytes")}return e|0}function y(e){if(+e!=e){e=0}return l.alloc(+e)}l.isBuffer=function e(t){return t!=null&&t._isBuffer===true};l.compare=function e(t,r){if(!l.isBuffer(t)||!l.isBuffer(r)){throw new TypeError("Arguments must be Buffers")}if(t===r)return 0;var n=t.length;var i=r.length;for(var a=0,o=Math.min(n,i);a<o;++a){if(t[a]!==r[a]){n=t[a];i=r[a];break}}if(n<i)return-1;if(i<n)return 1;return 0};l.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};l.concat=function e(t,r){if(!Array.isArray(t)){throw new TypeError('"list" argument must be an Array of Buffers')}if(t.length===0){return l.alloc(0)}var n;if(r===undefined){r=0;for(n=0;n<t.length;++n){r+=t[n].length}}var i=l.allocUnsafe(r);var a=0;for(n=0;n<t.length;++n){var o=t[n];if(ArrayBuffer.isView(o)){o=l.from(o)}if(!l.isBuffer(o)){throw new TypeError('"list" argument must be an Array of Buffers')}o.copy(i,a);a+=o.length}return i};function b(e,t){if(l.isBuffer(e)){return e.length}if(ArrayBuffer.isView(e)||K(e)){return e.byteLength}if(typeof e!=="string"){e=""+e}var r=e.length;if(r===0)return 0;var n=false;for(;;){switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case undefined:return W(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Z(e).length;default:if(n)return W(e).length;t=(""+t).toLowerCase();n=true}}}l.byteLength=b;function x(e,t,r){var n=false;if(t===undefined||t<0){t=0}if(t>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;t>>>=0;if(r<=t){return""}if(!e)e="utf8";while(true){switch(e){case"hex":return z(this,t,r);case"utf8":case"utf-8":return I(this,t,r);case"ascii":return R(this,t,r);case"latin1":case"binary":return N(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();n=true}}}l.prototype._isBuffer=true;function _(e,t,r){var n=e[t];e[t]=e[r];e[r]=n}l.prototype.swap16=function e(){var t=this.length;if(t%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<t;r+=2){_(this,r,r+1)}return this};l.prototype.swap32=function e(){var t=this.length;if(t%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<t;r+=4){_(this,r,r+3);_(this,r+1,r+2)}return this};l.prototype.swap64=function e(){var t=this.length;if(t%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<t;r+=8){_(this,r,r+7);_(this,r+1,r+6);_(this,r+2,r+5);_(this,r+3,r+4)}return this};l.prototype.toString=function e(){var t=this.length;if(t===0)return"";if(arguments.length===0)return I(this,0,t);return x.apply(this,arguments)};l.prototype.toLocaleString=l.prototype.toString;l.prototype.equals=function e(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(this===t)return true;return l.compare(this,t)===0};l.prototype.inspect=function e(){var t="";var n=r.INSPECT_MAX_BYTES;if(this.length>0){t=this.toString("hex",0,n).match(/.{2}/g).join(" ");if(this.length>n)t+=" ... "}return"<Buffer "+t+">"};l.prototype.compare=function e(t,r,n,i,a){if(!l.isBuffer(t)){throw new TypeError("Argument must be a Buffer")}if(r===undefined){r=0}if(n===undefined){n=t?t.length:0}if(i===undefined){i=0}if(a===undefined){a=this.length}if(r<0||n>t.length||i<0||a>this.length){throw new RangeError("out of range index")}if(i>=a&&r>=n){return 0}if(i>=a){return-1}if(r>=n){return 1}r>>>=0;n>>>=0;i>>>=0;a>>>=0;if(this===t)return 0;var o=a-i;var s=n-r;var u=Math.min(o,s);var f=this.slice(i,a);var c=t.slice(r,n);for(var h=0;h<u;++h){if(f[h]!==c[h]){o=f[h];s=c[h];break}}if(o<s)return-1;if(s<o)return 1;return 0};function w(e,t,r,n,i){if(e.length===0)return-1;if(typeof r==="string"){n=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(J(r)){r=i?0:e.length-1}if(r<0)r=e.length+r;if(r>=e.length){if(i)return-1;else r=e.length-1}else if(r<0){if(i)r=0;else return-1}if(typeof t==="string"){t=l.from(t,n)}if(l.isBuffer(t)){if(t.length===0){return-1}return M(e,t,r,n,i)}else if(typeof t==="number"){t=t&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(i){return Uint8Array.prototype.indexOf.call(e,t,r)}else{return Uint8Array.prototype.lastIndexOf.call(e,t,r)}}return M(e,[t],r,n,i)}throw new TypeError("val must be string, number or Buffer")}function M(e,t,r,n,i){var a=1;var o=e.length;var s=t.length;if(n!==undefined){n=String(n).toLowerCase();if(n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le"){if(e.length<2||t.length<2){return-1}a=2;o/=2;s/=2;r/=2}}function l(e,t){if(a===1){return e[t]}else{return e.readUInt16BE(t*a)}}var u;if(i){var f=-1;for(u=r;u<o;u++){if(l(e,u)===l(t,f===-1?0:u-f)){if(f===-1)f=u;if(u-f+1===s)return f*a}else{if(f!==-1)u-=u-f;f=-1}}}else{if(r+s>o)r=o-s;for(u=r;u>=0;u--){var c=true;for(var h=0;h<s;h++){if(l(e,u+h)!==l(t,h)){c=false;break}}if(c)return u}}return-1}l.prototype.includes=function e(t,r,n){return this.indexOf(t,r,n)!==-1};l.prototype.indexOf=function e(t,r,n){return w(this,t,r,n,true)};l.prototype.lastIndexOf=function e(t,r,n){return w(this,t,r,n,false)};function A(e,t,r,n){r=Number(r)||0;var i=e.length-r;if(!n){n=i}else{n=Number(n);if(n>i){n=i}}var a=t.length;if(n>a/2){n=a/2}for(var o=0;o<n;++o){var s=parseInt(t.substr(o*2,2),16);if(J(s))return o;e[r+o]=s}return o}function T(e,t,r,n){return Q(W(t,e.length-r),e,r,n)}function k(e,t,r,n){return Q(X(t),e,r,n)}function E(e,t,r,n){return k(e,t,r,n)}function S(e,t,r,n){return Q(Z(t),e,r,n)}function L(e,t,r,n){return Q(Y(t,e.length-r),e,r,n)}l.prototype.write=function e(t,r,n,i){if(r===undefined){i="utf8";n=this.length;r=0}else if(n===undefined&&typeof r==="string"){i=r;n=this.length;r=0}else if(isFinite(r)){r=r>>>0;if(isFinite(n)){n=n>>>0;if(i===undefined)i="utf8"}else{i=n;n=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var a=this.length-r;if(n===undefined||n>a)n=a;if(t.length>0&&(n<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!i)i="utf8";var o=false;for(;;){switch(i){case"hex":return A(this,t,r,n);case"utf8":case"utf-8":return T(this,t,r,n);case"ascii":return k(this,t,r,n);case"latin1":case"binary":return E(this,t,r,n);case"base64":return S(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,r,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase();o=true}}};l.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function C(e,t,r){if(t===0&&r===e.length){return n.fromByteArray(e)}else{return n.fromByteArray(e.slice(t,r))}}function I(e,t,r){r=Math.min(e.length,r);var n=[];var i=t;while(i<r){var a=e[i];var o=null;var s=a>239?4:a>223?3:a>191?2:1;if(i+s<=r){var l,u,f,c;switch(s){case 1:if(a<128){o=a}break;case 2:l=e[i+1];if((l&192)===128){c=(a&31)<<6|l&63;if(c>127){o=c}}break;case 3:l=e[i+1];u=e[i+2];if((l&192)===128&&(u&192)===128){c=(a&15)<<12|(l&63)<<6|u&63;if(c>2047&&(c<55296||c>57343)){o=c}}break;case 4:l=e[i+1];u=e[i+2];f=e[i+3];if((l&192)===128&&(u&192)===128&&(f&192)===128){c=(a&15)<<18|(l&63)<<12|(u&63)<<6|f&63;if(c>65535&&c<1114112){o=c}}}}if(o===null){o=65533;s=1}else if(o>65535){o-=65536;n.push(o>>>10&1023|55296);o=56320|o&1023}n.push(o);i+=s}return O(n)}var P=4096;function O(e){var t=e.length;if(t<=P){return String.fromCharCode.apply(String,e)}var r="";var n=0;while(n<t){r+=String.fromCharCode.apply(String,e.slice(n,n+=P))}return r}function R(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i]&127)}return n}function N(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i])}return n}function z(e,t,r){var n=e.length;if(!t||t<0)t=0;if(!r||r<0||r>n)r=n;var i="";for(var a=t;a<r;++a){i+=G(e[a])}return i}function D(e,t,r){var n=e.slice(t,r);var i="";for(var a=0;a<n.length;a+=2){i+=String.fromCharCode(n[a]+n[a+1]*256)}return i}l.prototype.slice=function e(t,r){var n=this.length;t=~~t;r=r===undefined?n:~~r;if(t<0){t+=n;if(t<0)t=0}else if(t>n){t=n}if(r<0){r+=n;if(r<0)r=0}else if(r>n){r=n}if(r<t)r=t;var i=this.subarray(t,r);i.__proto__=l.prototype;return i};function F(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUIntLE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)F(t,r,this.length);var i=this[t];var a=1;var o=0;while(++o<r&&(a*=256)){i+=this[t+o]*a}return i};l.prototype.readUIntBE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n){F(t,r,this.length)}var i=this[t+--r];var a=1;while(r>0&&(a*=256)){i+=this[t+--r]*a}return i};l.prototype.readUInt8=function e(t,r){t=t>>>0;if(!r)F(t,1,this.length);return this[t]};l.prototype.readUInt16LE=function e(t,r){t=t>>>0;if(!r)F(t,2,this.length);return this[t]|this[t+1]<<8};l.prototype.readUInt16BE=function e(t,r){t=t>>>0;if(!r)F(t,2,this.length);return this[t]<<8|this[t+1]};l.prototype.readUInt32LE=function e(t,r){t=t>>>0;if(!r)F(t,4,this.length);return(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};l.prototype.readUInt32BE=function e(t,r){t=t>>>0;if(!r)F(t,4,this.length);return this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};l.prototype.readIntLE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)F(t,r,this.length);var i=this[t];var a=1;var o=0;while(++o<r&&(a*=256)){i+=this[t+o]*a}a*=128;if(i>=a)i-=Math.pow(2,8*r);return i};l.prototype.readIntBE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)F(t,r,this.length);var i=r;var a=1;var o=this[t+--i];while(i>0&&(a*=256)){o+=this[t+--i]*a}a*=128;if(o>=a)o-=Math.pow(2,8*r);return o};l.prototype.readInt8=function e(t,r){t=t>>>0;if(!r)F(t,1,this.length);if(!(this[t]&128))return this[t];return(255-this[t]+1)*-1};l.prototype.readInt16LE=function e(t,r){t=t>>>0;if(!r)F(t,2,this.length);var n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};l.prototype.readInt16BE=function e(t,r){t=t>>>0;if(!r)F(t,2,this.length);var n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};l.prototype.readInt32LE=function e(t,r){t=t>>>0;if(!r)F(t,4,this.length);return this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};l.prototype.readInt32BE=function e(t,r){t=t>>>0;if(!r)F(t,4,this.length);return this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};l.prototype.readFloatLE=function e(t,r){t=t>>>0;if(!r)F(t,4,this.length);return i.read(this,t,true,23,4)};l.prototype.readFloatBE=function e(t,r){t=t>>>0;if(!r)F(t,4,this.length);return i.read(this,t,false,23,4)};l.prototype.readDoubleLE=function e(t,r){t=t>>>0;if(!r)F(t,8,this.length);return i.read(this,t,true,52,8)};l.prototype.readDoubleBE=function e(t,r){t=t>>>0;if(!r)F(t,8,this.length);return i.read(this,t,false,52,8)};function j(e,t,r,n,i,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}l.prototype.writeUIntLE=function e(t,r,n,i){t=+t;r=r>>>0;n=n>>>0;if(!i){var a=Math.pow(2,8*n)-1;j(this,t,r,n,a,0)}var o=1;var s=0;this[r]=t&255;while(++s<n&&(o*=256)){this[r+s]=t/o&255}return r+n};l.prototype.writeUIntBE=function e(t,r,n,i){t=+t;r=r>>>0;n=n>>>0;if(!i){var a=Math.pow(2,8*n)-1;j(this,t,r,n,a,0)}var o=n-1;var s=1;this[r+o]=t&255;while(--o>=0&&(s*=256)){this[r+o]=t/s&255}return r+n};l.prototype.writeUInt8=function e(t,r,n){t=+t;r=r>>>0;if(!n)j(this,t,r,1,255,0);this[r]=t&255;return r+1};l.prototype.writeUInt16LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)j(this,t,r,2,65535,0);this[r]=t&255;this[r+1]=t>>>8;return r+2};l.prototype.writeUInt16BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)j(this,t,r,2,65535,0);this[r]=t>>>8;this[r+1]=t&255;return r+2};l.prototype.writeUInt32LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)j(this,t,r,4,4294967295,0);this[r+3]=t>>>24;this[r+2]=t>>>16;this[r+1]=t>>>8;this[r]=t&255;return r+4};l.prototype.writeUInt32BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)j(this,t,r,4,4294967295,0);this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255;return r+4};l.prototype.writeIntLE=function e(t,r,n,i){t=+t;r=r>>>0;if(!i){var a=Math.pow(2,8*n-1);j(this,t,r,n,a-1,-a)}var o=0;var s=1;var l=0;this[r]=t&255;while(++o<n&&(s*=256)){if(t<0&&l===0&&this[r+o-1]!==0){l=1}this[r+o]=(t/s>>0)-l&255}return r+n};l.prototype.writeIntBE=function e(t,r,n,i){t=+t;r=r>>>0;if(!i){var a=Math.pow(2,8*n-1);j(this,t,r,n,a-1,-a)}var o=n-1;var s=1;var l=0;this[r+o]=t&255;while(--o>=0&&(s*=256)){if(t<0&&l===0&&this[r+o+1]!==0){l=1}this[r+o]=(t/s>>0)-l&255}return r+n};l.prototype.writeInt8=function e(t,r,n){t=+t;r=r>>>0;if(!n)j(this,t,r,1,127,-128);if(t<0)t=255+t+1;this[r]=t&255;return r+1};l.prototype.writeInt16LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)j(this,t,r,2,32767,-32768);this[r]=t&255;this[r+1]=t>>>8;return r+2};l.prototype.writeInt16BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)j(this,t,r,2,32767,-32768);this[r]=t>>>8;this[r+1]=t&255;return r+2};l.prototype.writeInt32LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)j(this,t,r,4,2147483647,-2147483648);this[r]=t&255;this[r+1]=t>>>8;this[r+2]=t>>>16;this[r+3]=t>>>24;return r+4};l.prototype.writeInt32BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)j(this,t,r,4,2147483647,-2147483648);if(t<0)t=4294967295+t+1;this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255;return r+4};function B(e,t,r,n,i,a){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function U(e,t,r,n,a){t=+t;r=r>>>0;if(!a){B(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38)}i.write(e,t,r,n,23,4);return r+4}l.prototype.writeFloatLE=function e(t,r,n){return U(this,t,r,true,n)};l.prototype.writeFloatBE=function e(t,r,n){return U(this,t,r,false,n)};function V(e,t,r,n,a){t=+t;r=r>>>0;if(!a){B(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308)}i.write(e,t,r,n,52,8);return r+8}l.prototype.writeDoubleLE=function e(t,r,n){return V(this,t,r,true,n)};l.prototype.writeDoubleBE=function e(t,r,n){return V(this,t,r,false,n)};l.prototype.copy=function e(t,r,n,i){if(!l.isBuffer(t))throw new TypeError("argument should be a Buffer");if(!n)n=0;if(!i&&i!==0)i=this.length;if(r>=t.length)r=t.length;if(!r)r=0;if(i>0&&i<n)i=n;if(i===n)return 0;if(t.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");if(i>this.length)i=this.length;if(t.length-r<i-n){i=t.length-r+n}var a=i-n;if(this===t&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(r,n,i)}else if(this===t&&n<r&&r<i){for(var o=a-1;o>=0;--o){t[o+r]=this[o+n]}}else{Uint8Array.prototype.set.call(t,this.subarray(n,i),r)}return a};l.prototype.fill=function e(t,r,n,i){if(typeof t==="string"){if(typeof r==="string"){i=r;r=0;n=this.length}else if(typeof n==="string"){i=n;n=this.length}if(i!==undefined&&typeof i!=="string"){throw new TypeError("encoding must be a string")}if(typeof i==="string"&&!l.isEncoding(i)){throw new TypeError("Unknown encoding: "+i)}if(t.length===1){var a=t.charCodeAt(0);if(i==="utf8"&&a<128||i==="latin1"){t=a}}}else if(typeof t==="number"){t=t&255}if(r<0||this.length<r||this.length<n){throw new RangeError("Out of range index")}if(n<=r){return this}r=r>>>0;n=n===undefined?this.length:n>>>0;if(!t)t=0;var o;if(typeof t==="number"){for(o=r;o<n;++o){this[o]=t}}else{var s=l.isBuffer(t)?t:new l(t,i);var u=s.length;if(u===0){throw new TypeError('The value "'+t+'" is invalid for argument "value"')}for(o=0;o<n-r;++o){this[o+r]=s[o%u]}}return this};var H=/[^+/0-9A-Za-z-_]/g;function q(e){e=e.split("=")[0];e=e.trim().replace(H,"");if(e.length<2)return"";while(e.length%4!==0){e=e+"="}return e}function G(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function W(e,t){t=t||Infinity;var r;var n=e.length;var i=null;var a=[];for(var o=0;o<n;++o){r=e.charCodeAt(o);if(r>55295&&r<57344){if(!i){if(r>56319){if((t-=3)>-1)a.push(239,191,189);continue}else if(o+1===n){if((t-=3)>-1)a.push(239,191,189);continue}i=r;continue}if(r<56320){if((t-=3)>-1)a.push(239,191,189);i=r;continue}r=(i-55296<<10|r-56320)+65536}else if(i){if((t-=3)>-1)a.push(239,191,189)}i=null;if(r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return a}function X(e){var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r)&255)}return t}function Y(e,t){var r,n,i;var a=[];for(var o=0;o<e.length;++o){if((t-=2)<0)break;r=e.charCodeAt(o);n=r>>8;i=r%256;a.push(i);a.push(n)}return a}function Z(e){return n.toByteArray(q(e))}function Q(e,t,r,n){for(var i=0;i<n;++i){if(i+r>=t.length||i>=e.length)break;t[i+r]=e[i]}return i}function K(e){return e instanceof ArrayBuffer||e!=null&&e.constructor!=null&&e.constructor.name==="ArrayBuffer"&&typeof e.byteLength==="number"}function J(e){return e!==e}},{"base64-js":19,ieee754:238}],49:[function(e,t,r){"use strict";var n=e("./lib/monotone");var i=e("./lib/triangulation");var a=e("./lib/delaunay");var o=e("./lib/filter");t.exports=c;function s(e){return[Math.min(e[0],e[1]),Math.max(e[0],e[1])]}function l(e,t){return e[0]-t[0]||e[1]-t[1]}function u(e){return e.map(s).sort(l)}function f(e,t,r){if(t in e){return e[t]}return r}function c(e,t,r){if(!Array.isArray(t)){r=t||{};t=[]}else{r=r||{};t=t||[]}var s=!!f(r,"delaunay",true);var l=!!f(r,"interior",true);var c=!!f(r,"exterior",true);var h=!!f(r,"infinity",false);if(!l&&!c||e.length===0){return[]}var v=n(e,t);if(s||l!==c||h){var d=i(e.length,u(t));for(var p=0;p<v.length;++p){var g=v[p];d.addTriangle(g[0],g[1],g[2])}if(s){a(e,d)}if(!c){return o(d,-1)}else if(!l){return o(d,1,h)}else if(h){return o(d,0,h)}else{return d.cells()}}else{return v}}},{"./lib/delaunay":50,"./lib/filter":51,"./lib/monotone":52,"./lib/triangulation":53}],50:[function(e,t,r){"use strict";var n=e("robust-in-sphere")[4];var i=e("binary-search-bounds");t.exports=o;function a(e,t,r,i,a,o){var s=t.opposite(i,a);if(s<0){return}if(a<i){var l=i;i=a;a=l;l=o;o=s;s=l}if(t.isConstraint(i,a)){return}if(n(e[i],e[a],e[o],e[s])<0){r.push(i,a)}}function o(e,t){var r=[];var i=e.length;var o=t.stars;for(var s=0;s<i;++s){var l=o[s];for(var u=1;u<l.length;u+=2){var f=l[u];if(f<s){continue}if(t.isConstraint(s,f)){continue}var c=l[u-1],h=-1;for(var v=1;v<l.length;v+=2){if(l[v-1]===f){h=l[v];break}}if(h<0){continue}if(n(e[s],e[f],e[c],e[h])<0){r.push(s,f)}}}while(r.length>0){var f=r.pop();var s=r.pop();var c=-1,h=-1;var l=o[s];for(var d=1;d<l.length;d+=2){var p=l[d-1];var g=l[d];if(p===f){h=g}else if(g===f){c=p}}if(c<0||h<0){continue}if(n(e[s],e[f],e[c],e[h])>=0){continue}t.flip(s,f);a(e,t,r,c,s,h);a(e,t,r,s,h,c);a(e,t,r,h,f,c);a(e,t,r,f,c,h)}}},{"binary-search-bounds":54,"robust-in-sphere":304}],51:[function(e,t,r){"use strict";var n=e("binary-search-bounds");t.exports=u;function i(e,t,r,n,i,a,o){this.cells=e;this.neighbor=t;this.flags=n;this.constraint=r;this.active=i;this.next=a;this.boundary=o}var a=i.prototype;function o(e,t){return e[0]-t[0]||e[1]-t[1]||e[2]-t[2]}a.locate=function(){var e=[0,0,0];return function(t,r,i){var a=t,s=r,l=i;if(r<i){if(r<t){a=r;s=i;l=t}}else if(i<t){a=i;s=t;l=r}if(a<0){return-1}e[0]=a;e[1]=s;e[2]=l;return n.eq(this.cells,e,o)}}();function s(e,t){var r=e.cells();var n=r.length;for(var a=0;a<n;++a){var s=r[a];var l=s[0],u=s[1],f=s[2];if(u<f){if(u<l){s[0]=u;s[1]=f;s[2]=l}}else if(f<l){s[0]=f;s[1]=l;s[2]=u}}r.sort(o);var c=new Array(n);for(var a=0;a<c.length;++a){c[a]=0}var h=[];var v=[];var d=new Array(3*n);var p=new Array(3*n);var g=null;if(t){g=[]}var m=new i(r,d,p,c,h,v,g);for(var a=0;a<n;++a){var s=r[a];for(var y=0;y<3;++y){var l=s[y],u=s[(y+1)%3];var b=d[3*a+y]=m.locate(u,l,e.opposite(u,l));var x=p[3*a+y]=e.isConstraint(l,u);if(b<0){if(x){v.push(a)}else{h.push(a);c[a]=1}if(t){g.push([u,l,-1])}}}}return m}function l(e,t,r){var n=0;for(var i=0;i<e.length;++i){if(t[i]===r){e[n++]=e[i]}}e.length=n;return e}function u(e,t,r){var n=s(e,r);if(t===0){if(r){return n.cells.concat(n.boundary)}else{return n.cells}}var i=1;var a=n.active;var o=n.next;var u=n.flags;var f=n.cells;var c=n.constraint;var h=n.neighbor;while(a.length>0||o.length>0){while(a.length>0){var v=a.pop();if(u[v]===-i){continue}u[v]=i;var d=f[v];for(var p=0;p<3;++p){var g=h[3*v+p];if(g>=0&&u[g]===0){if(c[3*v+p]){o.push(g)}else{a.push(g);u[g]=i}}}}var m=o;o=a;a=m;o.length=0;i=-i}var y=l(f,u,t);if(r){return y.concat(n.boundary)}return y}},{"binary-search-bounds":54}],52:[function(e,t,r){"use strict";var n=e("binary-search-bounds");var i=e("robust-orientation")[3];var a=0;var o=1;var s=2;t.exports=g;function l(e,t,r,n,i){this.a=e;this.b=t;this.idx=r;this.lowerIds=n;this.upperIds=i}function u(e,t,r,n){this.a=e;this.b=t;this.type=r;this.idx=n}function f(e,t){var r=e.a[0]-t.a[0]||e.a[1]-t.a[1]||e.type-t.type;if(r){return r}if(e.type!==a){r=i(e.a,e.b,t.b);if(r){return r}}return e.idx-t.idx}function c(e,t){return i(e.a,e.b,t)}function h(e,t,r,a,o){var s=n.lt(t,a,c);var l=n.gt(t,a,c);for(var u=s;u<l;++u){var f=t[u];var h=f.lowerIds;var v=h.length;while(v>1&&i(r[h[v-2]],r[h[v-1]],a)>0){e.push([h[v-1],h[v-2],o]);v-=1}h.length=v;h.push(o);var d=f.upperIds;var v=d.length;while(v>1&&i(r[d[v-2]],r[d[v-1]],a)<0){e.push([d[v-2],d[v-1],o]);v-=1}d.length=v;d.push(o)}}function v(e,t){var r;if(e.a[0]<t.a[0]){r=i(e.a,e.b,t.a)}else{r=i(t.b,t.a,e.a)}if(r){return r}if(t.b[0]<e.b[0]){r=i(e.a,e.b,t.b)}else{r=i(t.b,t.a,e.b)}return r||e.idx-t.idx}function d(e,t,r){var i=n.le(e,r,v);var a=e[i];var o=a.upperIds;var s=o[o.length-1];a.upperIds=[s];e.splice(i+1,0,new l(r.a,r.b,r.idx,[s],o))}function p(e,t,r){var i=r.a;r.a=r.b;r.b=i;var a=n.eq(e,r,v);var o=e[a];var s=e[a-1];s.upperIds=o.upperIds;e.splice(a,1)}function g(e,t){var r=e.length;var n=t.length;var i=[];for(var c=0;c<r;++c){i.push(new u(e[c],null,a,c))}for(var c=0;c<n;++c){var v=t[c];var g=e[v[0]];var m=e[v[1]];if(g[0]<m[0]){i.push(new u(g,m,s,c),new u(m,g,o,c))}else if(g[0]>m[0]){i.push(new u(m,g,s,c),new u(g,m,o,c))}}i.sort(f);var y=i[0].a[0]-(1+Math.abs(i[0].a[0]))*Math.pow(2,-52);var b=[new l([y,1],[y,0],-1,[],[],[],[])];var x=[];for(var c=0,_=i.length;c<_;++c){var w=i[c];var M=w.type;if(M===a){h(x,b,e,w.a,w.idx)}else if(M===s){d(b,e,w)}else{p(b,e,w)}}return x}},{"binary-search-bounds":54,"robust-orientation":306}],53:[function(e,t,r){"use strict";var n=e("binary-search-bounds");t.exports=s;function i(e,t){this.stars=e;this.edges=t}var a=i.prototype;function o(e,t,r){for(var n=1,i=e.length;n<i;n+=2){if(e[n-1]===t&&e[n]===r){e[n-1]=e[i-2];e[n]=e[i-1];e.length=i-2;return}}}a.isConstraint=function(){var e=[0,0];function t(e,t){return e[0]-t[0]||e[1]-t[1]}return function(r,i){e[0]=Math.min(r,i);e[1]=Math.max(r,i);return n.eq(this.edges,e,t)>=0}}();a.removeTriangle=function(e,t,r){var n=this.stars;o(n[e],t,r);o(n[t],r,e);o(n[r],e,t)};a.addTriangle=function(e,t,r){var n=this.stars;n[e].push(t,r);n[t].push(r,e);n[r].push(e,t)};a.opposite=function(e,t){var r=this.stars[t];for(var n=1,i=r.length;n<i;n+=2){if(r[n]===e){return r[n-1]}}return-1};a.flip=function(e,t){var r=this.opposite(e,t);var n=this.opposite(t,e);this.removeTriangle(e,t,r);this.removeTriangle(t,e,n);this.addTriangle(e,n,r);this.addTriangle(t,r,n)};a.edges=function(){var e=this.stars;var t=[];for(var r=0,n=e.length;r<n;++r){var i=e[r];for(var a=0,o=i.length;a<o;a+=2){t.push([i[a],i[a+1]])}}return t};a.cells=function(){var e=this.stars;var t=[];for(var r=0,n=e.length;r<n;++r){var i=e[r];for(var a=0,o=i.length;a<o;a+=2){var s=i[a];var l=i[a+1];if(r<Math.min(s,l)){t.push([r,s,l])}}}return t};function s(e,t){var r=new Array(e);for(var n=0;n<e;++n){r[n]=[]}return new i(r,t)}},{"binary-search-bounds":54}],54:[function(e,t,r){"use strict";function n(e,t,r,n,i){var a=["function ",e,"(a,l,h,",n.join(","),"){",i?"":"var i=",r?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];if(i){if(t.indexOf("c")<0){a.push(";if(x===y){return m}else if(x<=y){")}else{a.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){")}}else{a.push(";if(",t,"){i=m;")}if(r){a.push("l=m+1}else{h=m-1}")}else{a.push("h=m-1}else{l=m+1}")}a.push("}");if(i){a.push("return -1};")}else{a.push("return i};")}return a.join("")}function i(e,t,r,i){var a=new Function([n("A","x"+e+"y",t,["y"],i),n("P","c(x,y)"+e+"0",t,["y","c"],i),"function dispatchBsearch",r,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",r].join(""));return a()}t.exports={ge:i(">=",false,"GE"),gt:i(">",false,"GT"),lt:i("<",true,"LT"),le:i("<=",true,"LE"),eq:i("-",true,"EQ",true)}},{}],55:[function(e,t,r){"use strict";t.exports=n;function n(e){var t=1;for(var r=1;r<e.length;++r){for(var n=0;n<r;++n){if(e[r]<e[n]){t=-t}else if(e[n]===e[r]){return 0}}}return t}},{}],56:[function(e,t,r){"use strict";var n=e("dup");var i=e("robust-linear-solve");function a(e,t){var r=0;var n=e.length;for(var i=0;i<n;++i){r+=e[i]*t[i]}return r}function o(e){var t=e.length;if(t===0){return[]}var r=e[0].length;var o=n([e.length+1,e.length+1],1);var s=n([e.length+1],1);o[t][t]=0;for(var l=0;l<t;++l){for(var u=0;u<=l;++u){o[u][l]=o[l][u]=2*a(e[l],e[u])}s[l]=a(e[l],e[l])}var f=i(o,s);var c=0;var h=f[t+1];for(var l=0;l<h.length;++l){c+=h[l]}var v=new Array(t);for(var l=0;l<t;++l){var h=f[l];var d=0;for(var u=0;u<h.length;++u){d+=h[u]}v[l]=d/c}return v}function s(e){if(e.length===0){return[]}var t=e[0].length;var r=n([t]);var i=o(e);for(var a=0;a<e.length;++a){for(var s=0;s<t;++s){r[s]+=e[a][s]*i[a]}}return r}s.barycenetric=o;t.exports=s},{dup:86,"robust-linear-solve":305}],57:[function(e,t,r){t.exports=i;var n=e("circumcenter");function i(e){var t=n(e);var r=0;for(var i=0;i<e.length;++i){var a=e[i];for(var o=0;o<t.length;++o){r+=Math.pow(a[o]-t[o],2)}}return Math.sqrt(r/e.length)}},{circumcenter:56}],58:[function(e,t,r){t.exports=n;function n(e,t,r){return t<r?e<t?t:e>r?r:e:e<r?r:e>t?t:e}},{}],59:[function(e,t,r){"use strict";t.exports=A;var n=e("union-find");var i=e("box-intersect");var a=e("robust-segment-intersect");var o=e("big-rat");var s=e("big-rat/cmp");var l=e("big-rat/to-float");var u=e("rat-vec");var f=e("nextafter");var c=e("./lib/rat-seg-intersect");function h(e){var t=l(e);return[f(t,-Infinity),f(t,Infinity)]}function v(e,t){var r=new Array(t.length);for(var n=0;n<t.length;++n){var i=t[n];var a=e[i[0]];var o=e[i[1]];r[n]=[f(Math.min(a[0],o[0]),-Infinity),f(Math.min(a[1],o[1]),-Infinity),f(Math.max(a[0],o[0]),Infinity),f(Math.max(a[1],o[1]),Infinity)]}return r}function d(e){var t=new Array(e.length);for(var r=0;r<e.length;++r){var n=e[r];t[r]=[f(n[0],-Infinity),f(n[1],-Infinity),f(n[0],Infinity),f(n[1],Infinity)]}return t}function p(e,t,r){var n=[];i(r,function(r,i){var o=t[r];var s=t[i];if(o[0]===s[0]||o[0]===s[1]||o[1]===s[0]||o[1]===s[1]){return}var l=e[o[0]];var u=e[o[1]];var f=e[s[0]];var c=e[s[1]];if(a(l,u,f,c)){n.push([r,i])}});return n}function g(e,t,r,n){var o=[];i(r,n,function(r,n){var i=t[r];if(i[0]===n||i[1]===n){return}var s=e[n];var l=e[i[0]];var u=e[i[1]];if(a(l,u,s,s)){o.push([r,n])}});return o}function m(e,t,r,n,i){var a,f;var h=e.map(function(e){return[o(e[0]),o(e[1])]});for(a=0;a<r.length;++a){var v=r[a];f=v[0];var d=v[1];var p=t[f];var g=t[d];var m=c(u(e[p[0]]),u(e[p[1]]),u(e[g[0]]),u(e[g[1]]));if(!m){continue}var y=e.length;e.push([l(m[0]),l(m[1])]);h.push(m);n.push([f,y],[d,y])}n.sort(function(e,t){if(e[0]!==t[0]){return e[0]-t[0]}var r=h[e[1]];var n=h[t[1]];return s(r[0],n[0])||s(r[1],n[1])});for(a=n.length-1;a>=0;--a){var b=n[a];f=b[0];var x=t[f];var _=x[0];var w=x[1];var M=e[_];var A=e[w];if((M[0]-A[0]||M[1]-A[1])<0){var T=_;_=w;w=T}x[0]=_;var k=x[1]=b[1];var E;if(i){E=x[2]}while(a>0&&n[a-1][0]===f){var b=n[--a];var S=b[1];if(i){t.push([k,S,E])}else{t.push([k,S])}k=S}if(i){t.push([k,w,E])}else{t.push([k,w])}}return h}function y(e,t,r){var a=t.length;var o=new n(a);var s=[];for(var l=0;l<t.length;++l){var u=t[l];var c=h(u[0]);var v=h(u[1]);s.push([f(c[0],-Infinity),f(v[0],-Infinity),f(c[1],Infinity),f(v[1],Infinity)])}i(s,function(e,t){o.link(e,t)});var d=true;var p=new Array(a);for(var l=0;l<a;++l){var g=o.find(l);if(g!==l){d=false;e[g]=[Math.min(e[l][0],e[g][0]),Math.min(e[l][1],e[g][1])]}}if(d){return null}var m=0;for(var l=0;l<a;++l){var g=o.find(l);if(g===l){p[l]=m;e[m++]=e[l]}else{p[l]=-1}}e.length=m;for(var l=0;l<a;++l){if(p[l]<0){p[l]=p[o.find(l)]}}return p}function b(e,t){return e[0]-t[0]||e[1]-t[1]}function x(e,t){var r=e[0]-t[0]||e[1]-t[1];if(r){return r}if(e[2]<t[2]){return-1}else if(e[2]>t[2]){return 1}return 0}function _(e,t,r){if(e.length===0){return}if(t){for(var n=0;n<e.length;++n){var i=e[n];var a=t[i[0]];var o=t[i[1]];i[0]=Math.min(a,o);i[1]=Math.max(a,o)}}else{for(var n=0;n<e.length;++n){var i=e[n];var a=i[0];var o=i[1];i[0]=Math.min(a,o);i[1]=Math.max(a,o)}}if(r){e.sort(x)}else{e.sort(b)}var s=1;for(var n=1;n<e.length;++n){var l=e[n-1];var u=e[n];if(u[0]===l[0]&&u[1]===l[1]&&(!r||u[2]===l[2])){continue}e[s++]=u}e.length=s}function w(e,t,r){var n=y(e,[],d(e));_(t,n,r);return!!n}function M(e,t,r){var n=v(e,t);var i=p(e,t,n);var a=d(e);var o=g(e,t,n,a);var s=m(e,t,i,o,r);var l=y(e,s,a);_(t,l,r);if(!l){return i.length>0||o.length>0}return true}function A(e,t,r){var n;if(r){n=t;var i=new Array(t.length);for(var a=0;a<t.length;++a){var o=t[a];i[a]=[o[0],o[1],r[a]]}t=i}var s=w(e,t,!!r);while(M(e,t,!!r)){s=true}if(!!r&&s){n.length=0;r.length=0;for(var a=0;a<t.length;++a){var o=t[a];n.push([o[0],o[1]]);r.push(o[2])}}return s}},{"./lib/rat-seg-intersect":60,"big-rat":23,"big-rat/cmp":21,"big-rat/to-float":35,"box-intersect":40,nextafter:271,"rat-vec":295,"robust-segment-intersect":309,"union-find":334}],60:[function(e,t,r){"use strict";t.exports=c;var n=e("big-rat/mul");var i=e("big-rat/div");var a=e("big-rat/sub");var o=e("big-rat/sign");var s=e("rat-vec/sub");var l=e("rat-vec/add");var u=e("rat-vec/muls");function f(e,t){return a(n(e[0],t[1]),n(e[1],t[0]))}function c(e,t,r,n){var a=s(t,e);var c=s(n,r);var h=f(a,c);if(o(h)===0){return null}var v=s(e,r);var d=f(c,v);var p=i(d,h);var g=u(a,p);var m=l(e,g);return m}},{"big-rat/div":22,"big-rat/mul":32,"big-rat/sign":33,"big-rat/sub":34,"rat-vec/add":294,"rat-vec/muls":296,"rat-vec/sub":297}],61:[function(e,t,r){"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],62:[function(e,t,r){"use strict";var n=e("color-rgba");var i=e("clamp");var a=e("dtype");t.exports=function e(t,r){if(r==="float"||!r)r="array";if(r==="uint")r="uint8";if(r==="uint_clamped")r="uint8_clamped";var o=a(r);var s=new o(4);if(t instanceof o){if(Array.isArray(t)){return t.slice()}s.set(t);return s}var e=r!=="uint8"&&r!=="uint8_clamped";if(t instanceof Uint8Array||t instanceof Uint8ClampedArray){s[0]=t[0];s[1]=t[1];s[2]=t[2];s[3]=t[3]!=null?t[3]:255;if(e){s[0]/=255;s[1]/=255;s[2]/=255;s[3]/=255}return s}if(!t.length||typeof t==="string"){t=n(t);t[0]/=255;t[1]/=255;t[2]/=255}if(!e){s[0]=i(Math.round(t[0]*255),0,255);s[1]=i(Math.round(t[1]*255),0,255);s[2]=i(Math.round(t[2]*255),0,255);s[3]=t[3]==null?255:i(Math.floor(t[3]*255),0,255)}else{s[0]=t[0];s[1]=t[1];s[2]=t[2];s[3]=t[3]!=null?t[3]:1}return s}},{clamp:58,"color-rgba":64,dtype:85}],63:[function(e,t,r){(function(r){"use strict";var n=e("color-name");var i=e("is-plain-obj");var a=e("defined");t.exports=s;var o={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function s(e){var t,s=[],l=1,u;if(typeof e==="string"){if(n[e]){s=n[e].slice();u="rgb"}else if(e==="transparent"){l=0;u="rgb";s=[0,0,0]}else if(/^#[A-Fa-f0-9]+$/.test(e)){var f=e.slice(1);var c=f.length;var h=c<=4;l=1;if(h){s=[parseInt(f[0]+f[0],16),parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16)];if(c===4){l=parseInt(f[3]+f[3],16)/255}}else{s=[parseInt(f[0]+f[1],16),parseInt(f[2]+f[3],16),parseInt(f[4]+f[5],16)];if(c===8){l=parseInt(f[6]+f[7],16)/255}}if(!s[0])s[0]=0;if(!s[1])s[1]=0;if(!s[2])s[2]=0;u="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var v=t[1];var f=v.replace(/a$/,"");u=f;var c=f==="cmyk"?4:f==="gray"?1:3;s=t[2].trim().split(/\s*,\s*/).map(function(e,t){if(/%$/.test(e)){if(t===c)return parseFloat(e)/100;if(f==="rgb")return parseFloat(e)*255/100;return parseFloat(e)}else if(f[t]==="h"){if(/deg$/.test(e)){return parseFloat(e)}else if(o[e]!==undefined){return o[e]}}return parseFloat(e)});if(v===f)s.push(1);l=s[c]===undefined?1:s[c];s=s.slice(0,c)}else if(e.length>10&&/[0-9](?:\s|\/)/.test(e)){s=e.match(/([0-9]+)/g).map(function(e){return parseFloat(e)});u=e.match(/([a-z])/ig).join("").toLowerCase()}}else if(typeof e==="number"){u="rgb";s=[e>>>16,(e&65280)>>>8,e&255]}else if(i(e)){var d=a(e.r,e.red,e.R,null);if(d!==null){u="rgb";s=[d,a(e.g,e.green,e.G),a(e.b,e.blue,e.B)]}else{u="hsl";s=[a(e.h,e.hue,e.H),a(e.s,e.saturation,e.S),a(e.l,e.lightness,e.L,e.b,e.brightness)]}l=a(e.a,e.alpha,e.opacity,1);if(e.opacity!=null)l/=100}else if(Array.isArray(e)||r.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(e)){s=[e[0],e[1],e[2]];u="rgb";l=e.length===4?e[3]:1}return{space:u,values:s,alpha:l}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"color-name":61,defined:82,"is-plain-obj":246}],64:[function(e,t,r){"use strict";var n=e("color-parse");var i=e("color-space/hsl");var a=e("clamp");t.exports=function e(t){var r,o,s;if(typeof t!=="string")throw Error("Argument should be a string");var l=n(t);if(!l.space)return[];r=Array(3);r[0]=a(l.values[0],0,255);r[1]=a(l.values[1],0,255);r[2]=a(l.values[2],0,255);if(l.space[0]==="h"){r=i.rgb(r)}r.push(a(l.alpha,0,1));return r}},{clamp:58,"color-parse":63,"color-space/hsl":65}],65:[function(e,t,r){"use strict";var n=e("./rgb");t.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var t=e[0]/360,r=e[1]/100,n=e[2]/100,i,a,o,s,l;if(r===0){l=n*255;return[l,l,l]}if(n<.5){a=n*(1+r)}else{a=n+r-n*r}i=2*n-a;s=[0,0,0];for(var u=0;u<3;u++){o=t+1/3*-(u-1);if(o<0){o++}else if(o>1){o--}if(6*o<1){l=i+(a-i)*6*o}else if(2*o<1){l=a}else if(3*o<2){l=i+(a-i)*(2/3-o)*6}else{l=i}s[u]=l*255}return s}};n.hsl=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=a-i,s,l,u;if(a===i){s=0}else if(t===a){s=(r-n)/o}else if(r===a){s=2+(n-t)/o}else if(n===a){s=4+(t-r)/o}s=Math.min(s*60,360);if(s<0){s+=360}u=(i+a)/2;if(a===i){l=0}else if(u<=.5){l=o/(a+i)}else{l=o/(2-a-i)}return[s,l*100,u*100]}},{"./rgb":66}],66:[function(e,t,r){"use strict";t.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],67:[function(e,t,r){t.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],68:[function(e,t,r){"use strict";var n=e("./colorScale");var i=e("lerp");t.exports=a;function a(e){var t,r,a,u,f,c,h,v,d,p,g,m,y,b=[],x=[],_=[],w=[];if(!e)e={};d=(e.nshades||72)-1;v=e.format||"hex";h=e.colormap;if(!h)h="jet";if(typeof h==="string"){h=h.toLowerCase();if(!n[h]){throw Error(h+" not a supported colorscale")}c=n[h]}else if(Array.isArray(h)){c=h.slice()}else{throw Error("unsupported colormap option",h)}if(c.length>d){throw new Error(h+" map requires nshades to be at least size "+c.length)}if(!Array.isArray(e.alpha)){if(typeof e.alpha==="number"){g=[e.alpha,e.alpha]}else{g=[1,1]}}else if(e.alpha.length!==2){g=[1,1]}else{g=e.alpha.slice()}t=c.map(function(e){return Math.round(e.index*d)});g[0]=Math.min(Math.max(g[0],0),1);g[1]=Math.min(Math.max(g[1],0),1);var M=c.map(function(e,t){var r=c[t].index;var n=c[t].rgb.slice();if(n.length===4&&n[3]>=0&&n[3]<=1){return n}n[3]=g[0]+(g[1]-g[0])*r;return n});var p=[];for(y=0;y<t.length-1;++y){f=t[y+1]-t[y];a=M[y];u=M[y+1];for(var A=0;A<f;A++){var T=A/f;p.push([Math.round(i(a[0],u[0],T)),Math.round(i(a[1],u[1],T)),Math.round(i(a[2],u[2],T)),i(a[3],u[3],T)])}}p.push(c[c.length-1].rgb.concat(g[1]));if(v==="hex")p=p.map(s);else if(v==="rgbaString")p=p.map(l);else if(v==="float")p=p.map(o);return p}function o(e){return[e[0]/255,e[1]/255,e[2]/255,e[3]]}function s(e){var t,r="#";for(var n=0;n<3;++n){t=e[n];t=t.toString(16);r+=("00"+t).substr(t.length)}return r}function l(e){return"rgba("+e.join(",")+")"}},{"./colorScale":67,lerp:247}],69:[function(e,t,r){"use strict";t.exports=u;var n=e("robust-orientation");var i=e("signum");var a=e("two-sum");var o=e("robust-product");var s=e("robust-sum");function l(e,t,r){var n=a(e[0],-t[0]);var i=a(e[1],-t[1]);var l=a(r[0],-t[0]);var u=a(r[1],-t[1]);var f=s(o(n,l),o(i,u));return f[f.length-1]>=0}function u(e,t,r,a){var o=n(t,r,a);if(o===0){var s=i(n(e,t,r));var u=i(n(e,t,a));if(s===u){if(s===0){var f=l(e,t,r);var c=l(e,t,a);if(f===c){return 0}else if(f){return 1}else{return-1}}return 0}else if(u===0){if(s>0){return-1}else if(l(e,t,a)){return-1}else{return 1}}else if(s===0){if(u>0){return 1}else if(l(e,t,r)){return 1}else{return-1}}return i(u-s)}var h=n(e,t,r);if(h>0){if(o>0&&n(e,t,a)>0){return 1}return-1}else if(h<0){if(o>0||n(e,t,a)>0){return 1}return-1}else{var v=n(e,t,a);if(v>0){return 1}else{if(l(e,t,r)){return 1}else{return-1}}}}},{"robust-orientation":306,"robust-product":307,"robust-sum":311,signum:312,"two-sum":332}],70:[function(e,t,r){t.exports=a;var n=Math.min;function i(e,t){return e-t}function a(e,t){var r=e.length,a=e.length-t.length;if(a){return a}switch(r){case 0:return 0;case 1:return e[0]-t[0];case 2:return e[0]+e[1]-t[0]-t[1]||n(e[0],e[1])-n(t[0],t[1]);case 3:var o=e[0]+e[1],s=t[0]+t[1];a=o+e[2]-(s+t[2]);if(a){return a}var l=n(e[0],e[1]),u=n(t[0],t[1]);return n(l,e[2])-n(u,t[2])||n(l+e[2],o)-n(u+t[2],s);case 4:var f=e[0],c=e[1],h=e[2],v=e[3],d=t[0],p=t[1],g=t[2],m=t[3];return f+c+h+v-(d+p+g+m)||n(f,c,h,v)-n(d,p,g,m,d)||n(f+c,f+h,f+v,c+h,c+v,h+v)-n(d+p,d+g,d+m,p+g,p+m,g+m)||n(f+c+h,f+c+v,f+h+v,c+h+v)-n(d+p+g,d+p+m,d+g+m,p+g+m);default:var y=e.slice().sort(i);var b=t.slice().sort(i);for(var x=0;x<r;++x){a=y[x]-b[x];if(a){return a}}return 0}}},{}],71:[function(e,t,r){"use strict";var n=e("compare-cell");var i=e("cell-orientation");t.exports=a;function a(e,t){return n(e,t)||i(e)-i(t)}},{"cell-orientation":55,"compare-cell":70}],72:[function(e,t,r){"use strict";var n=e("./lib/ch1d");var i=e("./lib/ch2d");var a=e("./lib/chnd");t.exports=o;function o(e){var t=e.length;if(t===0){return[]}else if(t===1){return[[0]]}var r=e[0].length;if(r===0){return[]}else if(r===1){return n(e)}else if(r===2){return i(e)}return a(e,r)}},{"./lib/ch1d":73,"./lib/ch2d":74,"./lib/chnd":75}],73:[function(e,t,r){"use strict";t.exports=n;function n(e){var t=0;var r=0;for(var n=1;n<e.length;++n){if(e[n][0]<e[t][0]){t=n}if(e[n][0]>e[r][0]){r=n}}if(t<r){return[[t],[r]]}else if(t>r){return[[r],[t]]}else{return[[t]]}}},{}],74:[function(e,t,r){"use strict";t.exports=i;var n=e("monotone-convex-hull-2d");function i(e){var t=n(e);var r=t.length;if(r<=2){return[]}var i=new Array(r);var a=t[r-1];for(var o=0;o<r;++o){var s=t[o];i[o]=[a,s];a=s}return i}},{"monotone-convex-hull-2d":254}],75:[function(e,t,r){"use strict";t.exports=s;var n=e("incremental-convex-hull");var i=e("affine-hull");function a(e,t){var r=e.length;var n=new Array(r);for(var i=0;i<t.length;++i){n[i]=e[t[i]]}var a=t.length;for(var i=0;i<r;++i){if(t.indexOf(i)<0){n[a++]=e[i]}}return n}function o(e,t){var r=e.length;var n=t.length;for(var i=0;i<r;++i){var a=e[i];for(var o=0;o<a.length;++o){var s=a[o];if(s<n){a[o]=t[s]}else{s=s-n;for(var l=0;l<n;++l){if(s>=t[l]){s+=1}}a[o]=s}}}return e}function s(e,t){try{return n(e,true)}catch(u){var r=i(e);if(r.length<=t){return[]}var s=a(e,r);var l=n(s,true);return o(l,r)}}},{"affine-hull":14,"incremental-convex-hull":239}],76:[function(e,t,r){"use strict";function n(e,t,r,n,i,a){var o=6*i*i-6*i,s=3*i*i-4*i+1,l=-6*i*i+6*i,u=3*i*i-2*i;if(e.length){if(!a){a=new Array(e.length)}for(var f=e.length-1;f>=0;--f){a[f]=o*e[f]+s*t[f]+l*r[f]+u*n[f]}return a}return o*e+s*t+l*r[f]+u*n}function i(e,t,r,n,i,a){var o=i-1,s=i*i,l=o*o,u=(1+2*i)*l,f=i*l,c=s*(3-2*i),h=s*o;if(e.length){if(!a){a=new Array(e.length)}for(var v=e.length-1;v>=0;--v){a[v]=u*e[v]+f*t[v]+c*r[v]+h*n[v]}return a}return u*e+f*t+c*r+h*n}t.exports=i;t.exports.derivative=n},{}],77:[function(e,t,r){"use strict";var n=e("./lib/thunk.js");function i(){this.argTypes=[];this.shimArgs=[];this.arrayArgs=[];this.arrayBlockIndices=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.pre=null;this.body=null;this.post=null;this.debug=false}function a(e){var t=new i;t.pre=e.pre;t.body=e.body;t.post=e.post;var r=e.args.slice(0);t.argTypes=r;for(var a=0;a<r.length;++a){var o=r[a];if(o==="array"||typeof o==="object"&&o.blockIndices){t.argTypes[a]="array";t.arrayArgs.push(a);t.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0);t.shimArgs.push("array"+a);if(a<t.pre.args.length&&t.pre.args[a].count>0){throw new Error("cwise: pre() block may not reference array args")}if(a<t.post.args.length&&t.post.args[a].count>0){throw new Error("cwise: post() block may not reference array args")}}else if(o==="scalar"){t.scalarArgs.push(a);t.shimArgs.push("scalar"+a)}else if(o==="index"){t.indexArgs.push(a);if(a<t.pre.args.length&&t.pre.args[a].count>0){throw new Error("cwise: pre() block may not reference array index")}if(a<t.body.args.length&&t.body.args[a].lvalue){throw new Error("cwise: body() block may not write to array index")}if(a<t.post.args.length&&t.post.args[a].count>0){throw new Error("cwise: post() block may not reference array index")}}else if(o==="shape"){t.shapeArgs.push(a);if(a<t.pre.args.length&&t.pre.args[a].lvalue){throw new Error("cwise: pre() block may not write to array shape")}if(a<t.body.args.length&&t.body.args[a].lvalue){throw new Error("cwise: body() block may not write to array shape")}if(a<t.post.args.length&&t.post.args[a].lvalue){throw new Error("cwise: post() block may not write to array shape")}}else if(typeof o==="object"&&o.offset){t.argTypes[a]="offset";t.offsetArgs.push({array:o.array,offset:o.offset});t.offsetArgIndex.push(a)}else{throw new Error("cwise: Unknown argument type "+r[a])}}if(t.arrayArgs.length<=0){throw new Error("cwise: No array arguments specified")}if(t.pre.args.length>r.length){throw new Error("cwise: Too many arguments in pre() block")}if(t.body.args.length>r.length){throw new Error("cwise: Too many arguments in body() block")}if(t.post.args.length>r.length){throw new Error("cwise: Too many arguments in post() block")}t.debug=!!e.printCode||!!e.debug;t.funcName=e.funcName||"cwise";t.blockSize=e.blockSize||64;return n(t)}t.exports=a},{"./lib/thunk.js":79}],78:[function(e,t,r){"use strict";var n=e("uniq");function i(e,t,r){var n=e.length,i=t.arrayArgs.length,a=t.indexArgs.length>0,o=[],s=[],l=0,u=0,f,c;for(f=0;f<n;++f){s.push(["i",f,"=0"].join(""))}for(c=0;c<i;++c){for(f=0;f<n;++f){u=l;l=e[f];if(f===0){s.push(["d",c,"s",f,"=t",c,"p",l].join(""))}else{s.push(["d",c,"s",f,"=(t",c,"p",l,"-s",u,"*t",c,"p",u,")"].join(""))}}}if(s.length>0){o.push("var "+s.join(","))}for(f=n-1;f>=0;--f){l=e[f];o.push(["for(i",f,"=0;i",f,"<s",l,";++i",f,"){"].join(""))}o.push(r);for(f=0;f<n;++f){u=l;l=e[f];for(c=0;c<i;++c){o.push(["p",c,"+=d",c,"s",f].join(""))}if(a){if(f>0){o.push(["index[",u,"]-=s",u].join(""))}o.push(["++index[",l,"]"].join(""))}o.push("}")}return o.join("\n")}function a(e,t,r,n){var a=t.length,o=r.arrayArgs.length,s=r.blockSize,l=r.indexArgs.length>0,u=[];for(var f=0;f<o;++f){u.push(["var offset",f,"=p",f].join(""))}for(var f=e;f<a;++f){u.push(["for(var j"+f+"=SS[",t[f],"]|0;j",f,">0;){"].join(""));u.push(["if(j",f,"<",s,"){"].join(""));u.push(["s",t[f],"=j",f].join(""));u.push(["j",f,"=0"].join(""));u.push(["}else{s",t[f],"=",s].join(""));u.push(["j",f,"-=",s,"}"].join(""));if(l){u.push(["index[",t[f],"]=j",f].join(""))}}for(var f=0;f<o;++f){var c=["offset"+f];for(var h=e;h<a;++h){c.push(["j",h,"*t",f,"p",t[h]].join(""))}u.push(["p",f,"=(",c.join("+"),")"].join(""))}u.push(i(t,r,n));for(var f=e;f<a;++f){u.push("}")}return u.join("\n")}function o(e){var t=0,r=e[0].length;while(t<r){for(var n=1;n<e.length;++n){if(e[n][t]!==e[0][t]){return t}}++t}return t}function s(e,t,r){var n=e.body;var i=[];var a=[];for(var o=0;o<e.args.length;++o){var s=e.args[o];if(s.count<=0){continue}var l=new RegExp(s.name,"g");var u="";var f=t.arrayArgs.indexOf(o);switch(t.argTypes[o]){case"offset":var c=t.offsetArgIndex.indexOf(o);var h=t.offsetArgs[c];f=h.array;u="+q"+c;case"array":u="p"+f+u;var v="l"+o;var d="a"+f;if(t.arrayBlockIndices[f]===0){if(s.count===1){if(r[f]==="generic"){if(s.lvalue){i.push(["var ",v,"=",d,".get(",u,")"].join(""));n=n.replace(l,v);a.push([d,".set(",u,",",v,")"].join(""))}else{n=n.replace(l,[d,".get(",u,")"].join(""))}}else{n=n.replace(l,[d,"[",u,"]"].join(""))}}else if(r[f]==="generic"){i.push(["var ",v,"=",d,".get(",u,")"].join(""));n=n.replace(l,v);if(s.lvalue){a.push([d,".set(",u,",",v,")"].join(""))}}else{i.push(["var ",v,"=",d,"[",u,"]"].join(""));n=n.replace(l,v);if(s.lvalue){a.push([d,"[",u,"]=",v].join(""))}}}else{var p=[s.name],g=[u];for(var m=0;m<Math.abs(t.arrayBlockIndices[f]);m++){p.push("\\s*\\[([^\\]]+)\\]");g.push("$"+(m+1)+"*t"+f+"b"+m)}l=new RegExp(p.join(""),"g");u=g.join("+");if(r[f]==="generic"){throw new Error("cwise: Generic arrays not supported in combination with blocks!")}else{n=n.replace(l,[d,"[",u,"]"].join(""))}}break;case"scalar":n=n.replace(l,"Y"+t.scalarArgs.indexOf(o));break;case"index":n=n.replace(l,"index");break;case"shape":n=n.replace(l,"shape");break}}return[i.join("\n"),n,a.join("\n")].join("\n").trim()}function l(e){var t=new Array(e.length);var r=true;for(var n=0;n<e.length;++n){var i=e[n];var a=i.match(/\d+/);if(!a){a=""}else{a=a[0]}if(i.charAt(0)===0){t[n]="u"+i.charAt(1)+a}else{t[n]=i.charAt(0)+a}if(n>0){r=r&&t[n]===t[n-1]}}if(r){return t[0]}return t.join("")}function u(e,t){var r=t[1].length-Math.abs(e.arrayBlockIndices[0])|0;var u=new Array(e.arrayArgs.length);var f=new Array(e.arrayArgs.length);for(var c=0;c<e.arrayArgs.length;++c){f[c]=t[2*c];u[c]=t[2*c+1]}var h=[],v=[];var d=[],p=[];var g=[];for(var c=0;c<e.arrayArgs.length;++c){if(e.arrayBlockIndices[c]<0){d.push(0);p.push(r);h.push(r);v.push(r+e.arrayBlockIndices[c])}else{d.push(e.arrayBlockIndices[c]);p.push(e.arrayBlockIndices[c]+r);h.push(0);v.push(e.arrayBlockIndices[c])}var m=[];for(var y=0;y<u[c].length;y++){if(d[c]<=u[c][y]&&u[c][y]<p[c]){m.push(u[c][y]-d[c])}}g.push(m)}var b=["SS"];var x=["'use strict'"];var _=[];for(var y=0;y<r;++y){_.push(["s",y,"=SS[",y,"]"].join(""))}for(var c=0;c<e.arrayArgs.length;++c){b.push("a"+c);b.push("t"+c);b.push("p"+c);for(var y=0;y<r;++y){_.push(["t",c,"p",y,"=t",c,"[",d[c]+y,"]"].join(""))}for(var y=0;y<Math.abs(e.arrayBlockIndices[c]);++y){_.push(["t",c,"b",y,"=t",c,"[",h[c]+y,"]"].join(""))}}for(var c=0;c<e.scalarArgs.length;++c){b.push("Y"+c)}if(e.shapeArgs.length>0){_.push("shape=SS.slice(0)")}if(e.indexArgs.length>0){var w=new Array(r);for(var c=0;c<r;++c){w[c]="0"}_.push(["index=[",w.join(","),"]"].join(""))}for(var c=0;c<e.offsetArgs.length;++c){var M=e.offsetArgs[c];var A=[];for(var y=0;y<M.offset.length;++y){if(M.offset[y]===0){continue}else if(M.offset[y]===1){A.push(["t",M.array,"p",y].join(""))}else{A.push([M.offset[y],"*t",M.array,"p",y].join(""))}}if(A.length===0){_.push("q"+c+"=0")}else{_.push(["q",c,"=",A.join("+")].join(""))}}var T=n([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));_=_.concat(T);if(_.length>0){x.push("var "+_.join(","))}for(var c=0;c<e.arrayArgs.length;++c){x.push("p"+c+"|=0")}if(e.pre.body.length>3){x.push(s(e.pre,e,f))}var k=s(e.body,e,f);var E=o(g);if(E<r){x.push(a(E,g[0],e,k))}else{x.push(i(g[0],e,k))}if(e.post.body.length>3){x.push(s(e.post,e,f))}if(e.debug){console.log("-----Generated cwise routine for ",t,":\n"+x.join("\n")+"\n----------")}var S=[e.funcName||"unnamed","_cwise_loop_",u[0].join("s"),"m",E,l(f)].join("");var L=new Function(["function ",S,"(",b.join(","),"){",x.join("\n"),"} return ",S].join(""));return L()}t.exports=u},{uniq:335}],79:[function(e,t,r){"use strict";var n=e("./compile.js");function i(e){var t=["'use strict'","var CACHED={}"];var r=[];var i=e.funcName+"_cwise_thunk";t.push(["return function ",i,"(",e.shimArgs.join(","),"){"].join(""));var a=[];var o=[];var s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")];var l=[],u=[];for(var f=0;f<e.arrayArgs.length;++f){var c=e.arrayArgs[f];r.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join(""));a.push("t"+c);a.push("r"+c);o.push("t"+c);o.push("r"+c+".join()");s.push("array"+c+".data");s.push("array"+c+".stride");s.push("array"+c+".offset|0");if(f>0){l.push("array"+e.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[f])));u.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[f])+"]")}}if(e.arrayArgs.length>1){t.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')");t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {");t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')");t.push("}")}for(var f=0;f<e.scalarArgs.length;++f){s.push("scalar"+e.scalarArgs[f])}r.push(["type=[",o.join(","),"].join()"].join(""));r.push("proc=CACHED[type]");t.push("var "+r.join(","));t.push(["if(!proc){","CACHED[type]=proc=compile([",a.join(","),"])}","return proc(",s.join(","),")}"].join(""));if(e.debug){console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------")}var h=new Function("compile",t.join("\n"));return h(n.bind(undefined,e))}t.exports=i},{"./compile.js":78}],80:[function(e,t,r){t.exports=e("cwise-compiler")},{"cwise-compiler":77}],81:[function(t,r,n){!function(){var t={version:"3.5.17"};var n=[].slice,i=function(e){return n.call(e)};var a=this.document;function o(e){return e&&(e.ownerDocument||e.document||e).documentElement}function s(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}if(a){try{i(a.documentElement.childNodes)[0].nodeType}catch(e){i=function(e){var t=e.length,r=new Array(t);while(t--)r[t]=e[t];return r}}}if(!Date.now)Date.now=function(){return+new Date};if(a){try{a.createElement("DIV").style.setProperty("opacity",0,"")}catch(e){var l=this.Element.prototype,u=l.setAttribute,f=l.setAttributeNS,c=this.CSSStyleDeclaration.prototype,h=c.setProperty;l.setAttribute=function(e,t){u.call(this,e,t+"")};l.setAttributeNS=function(e,t,r){f.call(this,e,t,r+"")};c.setProperty=function(e,t,r){h.call(this,e,t+"",r)}}}t.ascending=v;function v(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}t.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN};t.min=function(e,t){var r=-1,n=e.length,i,a;if(arguments.length===1){while(++r<n)if((a=e[r])!=null&&a>=a){i=a;break}while(++r<n)if((a=e[r])!=null&&i>a)i=a}else{while(++r<n)if((a=t.call(e,e[r],r))!=null&&a>=a){i=a;break}while(++r<n)if((a=t.call(e,e[r],r))!=null&&i>a)i=a}return i};t.max=function(e,t){var r=-1,n=e.length,i,a;if(arguments.length===1){while(++r<n)if((a=e[r])!=null&&a>=a){i=a;break}while(++r<n)if((a=e[r])!=null&&a>i)i=a}else{while(++r<n)if((a=t.call(e,e[r],r))!=null&&a>=a){i=a;break}while(++r<n)if((a=t.call(e,e[r],r))!=null&&a>i)i=a}return i};t.extent=function(e,t){var r=-1,n=e.length,i,a,o;if(arguments.length===1){while(++r<n)if((a=e[r])!=null&&a>=a){i=o=a;break}while(++r<n)if((a=e[r])!=null){if(i>a)i=a;if(o<a)o=a}}else{while(++r<n)if((a=t.call(e,e[r],r))!=null&&a>=a){i=o=a;break}while(++r<n)if((a=t.call(e,e[r],r))!=null){if(i>a)i=a;if(o<a)o=a}}return[i,o]};function d(e){return e===null?NaN:+e}function p(e){return!isNaN(e)}t.sum=function(e,t){var r=0,n=e.length,i,a=-1;if(arguments.length===1){while(++a<n)if(p(i=+e[a]))r+=i}else{while(++a<n)if(p(i=+t.call(e,e[a],a)))r+=i}return r};t.mean=function(e,t){var r=0,n=e.length,i,a=-1,o=n;if(arguments.length===1){while(++a<n)if(p(i=d(e[a])))r+=i;else--o}else{while(++a<n)if(p(i=d(t.call(e,e[a],a))))r+=i;else--o}if(o)return r/o};t.quantile=function(e,t){var r=(e.length-1)*t+1,n=Math.floor(r),i=+e[n-1],a=r-n;return a?i+a*(e[n]-i):i};t.median=function(e,r){var n=[],i=e.length,a,o=-1;if(arguments.length===1){while(++o<i)if(p(a=d(e[o])))n.push(a)}else{while(++o<i)if(p(a=d(r.call(e,e[o],o))))n.push(a)}if(n.length)return t.quantile(n.sort(v),.5)};t.variance=function(e,t){var r=e.length,n=0,i,a,o=0,s=-1,l=0;if(arguments.length===1){while(++s<r){if(p(i=d(e[s]))){a=i-n;n+=a/++l;o+=a*(i-n)}}}else{while(++s<r){if(p(i=d(t.call(e,e[s],s)))){a=i-n;n+=a/++l;o+=a*(i-n)}}}if(l>1)return o/(l-1)};t.deviation=function(){var e=t.variance.apply(this,arguments);return e?Math.sqrt(e):e};function g(e){return{left:function(t,r,n,i){if(arguments.length<3)n=0;if(arguments.length<4)i=t.length;while(n<i){var a=n+i>>>1;if(e(t[a],r)<0)n=a+1;else i=a}return n},right:function(t,r,n,i){if(arguments.length<3)n=0;if(arguments.length<4)i=t.length;while(n<i){var a=n+i>>>1;if(e(t[a],r)>0)i=a;else n=a+1}return n}}}var m=g(v);t.bisectLeft=m.left;t.bisect=t.bisectRight=m.right;t.bisector=function(e){return g(e.length===1?function(t,r){return v(e(t),r)}:e)};t.shuffle=function(e,t,r){if((n=arguments.length)<3){r=e.length;if(n<2)t=0}var n=r-t,i,a;while(n){a=Math.random()*n--|0;i=e[n+t],e[n+t]=e[a+t],e[a+t]=i}return e};t.permute=function(e,t){var r=t.length,n=new Array(r);while(r--)n[r]=e[t[r]];return n};t.pairs=function(e){var t=0,r=e.length-1,n,i=e[0],a=new Array(r<0?0:r);while(t<r)a[t]=[n=i,i=e[++t]];return a};t.transpose=function(e){if(!(o=e.length))return[];for(var r=-1,n=t.min(e,y),i=new Array(n);++r<n;){for(var a=-1,o,s=i[r]=new Array(o);++a<o;){s[a]=e[a][r]}}return i};function y(e){return e.length}t.zip=function(){return t.transpose(arguments)};t.keys=function(e){var t=[];for(var r in e)t.push(r);return t};t.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t};t.entries=function(e){var t=[];for(var r in e)t.push({key:r,value:e[r]});return t};t.merge=function(e){var t=e.length,r,n=-1,i=0,a,o;while(++n<t)i+=e[n].length;a=new Array(i);while(--t>=0){o=e[t];r=o.length;while(--r>=0){a[--i]=o[r]}}return a};var b=Math.abs;t.range=function(e,t,r){if(arguments.length<3){r=1;if(arguments.length<2){t=e;e=0}}if((t-e)/r===Infinity)throw new Error("infinite range");var n=[],i=x(b(r)),a=-1,o;e*=i,t*=i,r*=i;if(r<0)while((o=e+r*++a)>t)n.push(o/i);else while((o=e+r*++a)<t)n.push(o/i);return n};function x(e){var t=1;while(e*t%1)t*=10;return t}function _(e,t){for(var r in t){Object.defineProperty(e.prototype,r,{value:t[r],enumerable:false})}}t.map=function(e,t){var r=new w;if(e instanceof w){e.forEach(function(e,t){r.set(e,t)})}else if(Array.isArray(e)){var n=-1,i=e.length,a;if(arguments.length===1)while(++n<i)r.set(n,e[n]);else while(++n<i)r.set(t.call(e,a=e[n],n),a)}else{for(var o in e)r.set(o,e[o])}return r};function w(){this._=Object.create(null)}var M="__proto__",A="\0";_(w,{has:E,get:function(e){return this._[T(e)]},set:function(e,t){return this._[T(e)]=t},remove:S,keys:L,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:k(t),value:this._[t]});return e},size:C,empty:I,forEach:function(e){for(var t in this._)e.call(this,k(t),this._[t])}});function T(e){return(e+="")===M||e[0]===A?A+e:e}function k(e){return(e+="")[0]===A?e.slice(1):e}function E(e){return T(e)in this._}function S(e){return(e=T(e))in this._&&delete this._[e]}function L(){var e=[];for(var t in this._)e.push(k(t));return e}function C(){var e=0;for(var t in this._)++e;return e}function I(){for(var e in this._)return false;return true}t.nest=function(){var e={},r=[],n=[],i,a;function o(t,n,s){if(s>=r.length)return a?a.call(e,n):i?n.sort(i):n;var l=-1,u=n.length,f=r[s++],c,h,v,d=new w,p;while(++l<u){if(p=d.get(c=f(h=n[l]))){p.push(h)}else{d.set(c,[h])}}if(t){h=t();v=function(e,r){h.set(e,o(t,r,s))}}else{h={};v=function(e,r){h[e]=o(t,r,s)}}d.forEach(v);return h}function s(e,t){if(t>=r.length)return e;var i=[],a=n[t++];e.forEach(function(e,r){i.push({key:e,values:s(r,t)})});return a?i.sort(function(e,t){return a(e.key,t.key)}):i}e.map=function(e,t){return o(t,e,0)};e.entries=function(e){return s(o(t.map,e,0),0)};e.key=function(t){r.push(t);return e};e.sortKeys=function(t){n[r.length-1]=t;return e};e.sortValues=function(t){i=t;return e};e.rollup=function(t){a=t;return e};return e};t.set=function(e){var t=new P;if(e)for(var r=0,n=e.length;r<n;++r)t.add(e[r]);return t};function P(){this._=Object.create(null)}_(P,{has:E,add:function(e){this._[T(e+="")]=true;return e},remove:S,values:L,size:C,empty:I,forEach:function(e){for(var t in this._)e.call(this,k(t))}});t.behavior={};function O(e){return e}t.rebind=function(e,t){var r=1,n=arguments.length,i;while(++r<n)e[i=arguments[r]]=R(e,t,t[i]);return e};function R(e,t,r){return function(){var n=r.apply(t,arguments);return n===t?e:n}}function N(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var r=0,n=z.length;r<n;++r){var i=z[r]+t;if(i in e)return i}}var z=["webkit","ms","moz","Moz","o","O"];function D(){}t.dispatch=function(){var e=new F,t=-1,r=arguments.length;while(++t<r)e[arguments[t]]=j(e);return e};function F(){}F.prototype.on=function(e,t){var r=e.indexOf("."),n="";if(r>=0){n=e.slice(r+1);e=e.slice(0,r)}if(e)return arguments.length<2?this[e].on(n):this[e].on(n,t);if(arguments.length===2){if(t==null)for(e in this){if(this.hasOwnProperty(e))this[e].on(n,null)}return this}};function j(e){var t=[],r=new w;function n(){var r=t,n=-1,i=r.length,a;while(++n<i)if(a=r[n].on)a.apply(this,arguments);return e}n.on=function(n,i){var a=r.get(n),o;if(arguments.length<2)return a&&a.on;if(a){a.on=null;t=t.slice(0,o=t.indexOf(a)).concat(t.slice(o+1));r.remove(n)}if(i)t.push(r.set(n,{on:i}));return e};return n}t.event=null;function B(){t.event.preventDefault()}function U(){var e=t.event,r;while(r=e.sourceEvent)e=r;return e}function V(e){var r=new F,n=0,i=arguments.length;while(++n<i)r[arguments[n]]=j(r);r.of=function(n,i){return function(a){try{var o=a.sourceEvent=t.event;a.target=e;t.event=a;r[a.type].apply(n,i)}finally{t.event=o}}};return r}t.requote=function(e){return e.replace(H,"\\$&")};var H=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;var q={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)e[r]=t[r]};function G(e){q(e,Z);return e}var W=function(e,t){return t.querySelector(e)},X=function(e,t){return t.querySelectorAll(e)},Y=function(e,t){var r=e.matches||e[N(e,"matchesSelector")];Y=function(e,t){return r.call(e,t)};return Y(e,t)};if(typeof Sizzle==="function"){W=function(e,t){return Sizzle(e,t)[0]||null};X=Sizzle;Y=Sizzle.matchesSelector}t.selection=function(){return t.select(a.documentElement)};var Z=t.selection.prototype=[];Z.select=function(e){var t=[],r,n,i,a;e=Q(e);for(var o=-1,s=this.length;++o<s;){t.push(r=[]);r.parentNode=(i=this[o]).parentNode;for(var l=-1,u=i.length;++l<u;){if(a=i[l]){r.push(n=e.call(a,a.__data__,l,o));if(n&&"__data__"in a)n.__data__=a.__data__}else{r.push(null)}}}return G(t)};function Q(e){return typeof e==="function"?e:function(){return W(e,this)}}Z.selectAll=function(e){var t=[],r,n;e=K(e);for(var a=-1,o=this.length;++a<o;){for(var s=this[a],l=-1,u=s.length;++l<u;){if(n=s[l]){t.push(r=i(e.call(n,n.__data__,l,a)));r.parentNode=n}}}return G(t)};function K(e){return typeof e==="function"?e:function(){return X(e,this)}}var J="http://www.w3.org/1999/xhtml";var $={svg:"http://www.w3.org/2000/svg",xhtml:J,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};t.ns={prefix:$,qualify:function(e){var t=e.indexOf(":"),r=e;if(t>=0&&(r=e.slice(0,t))!=="xmlns")e=e.slice(t+1);return $.hasOwnProperty(r)?{space:$[r],local:e}:e}};Z.attr=function(e,r){if(arguments.length<2){if(typeof e==="string"){var n=this.node();e=t.ns.qualify(e);return e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(r in e)this.each(ee(r,e[r]));return this}return this.each(ee(e,r))};function ee(e,r){e=t.ns.qualify(e);function n(){this.removeAttribute(e)}function i(){this.removeAttributeNS(e.space,e.local)}function a(){this.setAttribute(e,r)}function o(){this.setAttributeNS(e.space,e.local,r)}function s(){var t=r.apply(this,arguments);if(t==null)this.removeAttribute(e);else this.setAttribute(e,t)}function l(){var t=r.apply(this,arguments);if(t==null)this.removeAttributeNS(e.space,e.local);else this.setAttributeNS(e.space,e.local,t)}return r==null?e.local?i:n:typeof r==="function"?e.local?l:s:e.local?o:a}function te(e){return e.trim().replace(/\s+/g," ")}Z.classed=function(e,t){if(arguments.length<2){if(typeof e==="string"){var r=this.node(),n=(e=ne(e)).length,i=-1;if(t=r.classList){while(++i<n)if(!t.contains(e[i]))return false}else{t=r.getAttribute("class");while(++i<n)if(!re(e[i]).test(t))return false}return true}for(t in e)this.each(ie(t,e[t]));return this}return this.each(ie(e,t))};function re(e){return new RegExp("(?:^|\\s+)"+t.requote(e)+"(?:\\s+|$)","g")}function ne(e){return(e+"").trim().split(/^|\s+/)}function ie(e,t){e=ne(e).map(ae);var r=e.length;function n(){var n=-1;while(++n<r)e[n](this,t)}function i(){var n=-1,i=t.apply(this,arguments);while(++n<r)e[n](this,i)}return typeof t==="function"?i:n}function ae(e){var t=re(e);return function(r,n){if(i=r.classList)return n?i.add(e):i.remove(e);var i=r.getAttribute("class")||"";if(n){t.lastIndex=0;if(!t.test(i))r.setAttribute("class",te(i+" "+e))}else{r.setAttribute("class",te(i.replace(t," ")))}}}Z.style=function(e,t,r){var n=arguments.length;if(n<3){if(typeof e!=="string"){if(n<2)t="";for(r in e)this.each(oe(r,e[r],t));return this}if(n<2){var i=this.node();return s(i).getComputedStyle(i,null).getPropertyValue(e)}r=""}return this.each(oe(e,t,r))};function oe(e,t,r){function n(){this.style.removeProperty(e)}function i(){this.style.setProperty(e,t,r)}function a(){var n=t.apply(this,arguments);if(n==null)this.style.removeProperty(e);else this.style.setProperty(e,n,r)}return t==null?n:typeof t==="function"?a:i}Z.property=function(e,t){if(arguments.length<2){if(typeof e==="string")return this.node()[e];for(t in e)this.each(se(t,e[t]));return this}return this.each(se(e,t))};function se(e,t){function r(){delete this[e]}function n(){this[e]=t}function i(){var r=t.apply(this,arguments);if(r==null)delete this[e];else this[e]=r}return t==null?r:typeof t==="function"?i:n}Z.text=function(e){return arguments.length?this.each(typeof e==="function"?function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}:e==null?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent};Z.html=function(e){return arguments.length?this.each(typeof e==="function"?function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}:e==null?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML};Z.append=function(e){e=le(e);return this.select(function(){return this.appendChild(e.apply(this,arguments))})};function le(e){function r(){var t=this.ownerDocument,r=this.namespaceURI;return r===J&&t.documentElement.namespaceURI===J?t.createElement(e):t.createElementNS(r,e)}function n(){return this.ownerDocument.createElementNS(e.space,e.local)}return typeof e==="function"?e:(e=t.ns.qualify(e)).local?n:r}Z.insert=function(e,t){e=le(e);t=Q(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})};Z.remove=function(){return this.each(ue)};function ue(){var e=this.parentNode;if(e)e.removeChild(this)}Z.data=function(e,t){var r=-1,n=this.length,i,a;if(!arguments.length){e=new Array(n=(i=this[0]).length);while(++r<n){if(a=i[r]){e[r]=a.__data__}}return e}function o(e,r){var n,i=e.length,a=r.length,o=Math.min(i,a),f=new Array(a),c=new Array(a),h=new Array(i),v,d;if(t){var p=new w,g=new Array(i),m;for(n=-1;++n<i;){if(v=e[n]){if(p.has(m=t.call(v,v.__data__,n))){h[n]=v}else{p.set(m,v)}g[n]=m}}for(n=-1;++n<a;){if(!(v=p.get(m=t.call(r,d=r[n],n)))){c[n]=fe(d)}else if(v!==true){f[n]=v;v.__data__=d}p.set(m,true)}for(n=-1;++n<i;){if(n in g&&p.get(g[n])!==true){h[n]=e[n]}}}else{for(n=-1;++n<o;){v=e[n];d=r[n];if(v){v.__data__=d;f[n]=v}else{c[n]=fe(d)}}for(;n<a;++n){c[n]=fe(r[n])}for(;n<i;++n){h[n]=e[n]}}c.update=f;c.parentNode=f.parentNode=h.parentNode=e.parentNode;s.push(c);l.push(f);u.push(h)}var s=de([]),l=G([]),u=G([]);if(typeof e==="function"){while(++r<n){o(i=this[r],e.call(i,i.parentNode.__data__,r))}}else{while(++r<n){o(i=this[r],e)}}l.enter=function(){return s};l.exit=function(){return u};return l};function fe(e){return{__data__:e}}Z.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")};Z.filter=function(e){var t=[],r,n,i;if(typeof e!=="function")e=ce(e);for(var a=0,o=this.length;a<o;a++){t.push(r=[]);r.parentNode=(n=this[a]).parentNode;for(var s=0,l=n.length;s<l;s++){if((i=n[s])&&e.call(i,i.__data__,s,a)){r.push(i)}}}return G(t)};function ce(e){return function(){return Y(this,e)}}Z.order=function(){for(var e=-1,t=this.length;++e<t;){for(var r=this[e],n=r.length-1,i=r[n],a;--n>=0;){if(a=r[n]){if(i&&i!==a.nextSibling)i.parentNode.insertBefore(a,i);i=a}}}return this};Z.sort=function(e){e=he.apply(this,arguments);for(var t=-1,r=this.length;++t<r;)this[t].sort(e);return this.order()};function he(e){if(!arguments.length)e=v;return function(t,r){return t&&r?e(t.__data__,r.__data__):!t-!r}}Z.each=function(e){return ve(this,function(t,r,n){e.call(t,t.__data__,r,n)})};function ve(e,t){for(var r=0,n=e.length;r<n;r++){for(var i=e[r],a=0,o=i.length,s;a<o;a++){if(s=i[a])t(s,a,r)}}return e}Z.call=function(e){var t=i(arguments);e.apply(t[0]=this,t);return this};Z.empty=function(){return!this.node()};Z.node=function(){for(var e=0,t=this.length;e<t;e++){for(var r=this[e],n=0,i=r.length;n<i;n++){var a=r[n];if(a)return a}}return null};Z.size=function(){var e=0;ve(this,function(){++e});return e};function de(e){q(e,pe);return e}var pe=[];t.selection.enter=de;t.selection.enter.prototype=pe;pe.append=Z.append;pe.empty=Z.empty;pe.node=Z.node;pe.call=Z.call;pe.size=Z.size;pe.select=function(e){var t=[],r,n,i,a,o;for(var s=-1,l=this.length;++s<l;){i=(a=this[s]).update;t.push(r=[]);r.parentNode=a.parentNode;for(var u=-1,f=a.length;++u<f;){if(o=a[u]){r.push(i[u]=n=e.call(a.parentNode,o.__data__,u,s));n.__data__=o.__data__}else{r.push(null)}}}return G(t)};pe.insert=function(e,t){if(arguments.length<2)t=ge(this);return Z.insert.call(this,e,t)};function ge(e){var t,r;return function(n,i,a){var o=e[a].update,s=o.length,l;if(a!=r)r=a,t=0;if(i>=t)t=i+1;while(!(l=o[t])&&++t<s);return l}}t.select=function(e){var t;if(typeof e==="string"){t=[W(e,a)];t.parentNode=a.documentElement}else{t=[e];t.parentNode=o(e)}return G([t])};t.selectAll=function(e){var t;if(typeof e==="string"){t=i(X(e,a));t.parentNode=a.documentElement}else{t=i(e);t.parentNode=null}return G([t])};Z.on=function(e,t,r){var n=arguments.length;if(n<3){if(typeof e!=="string"){if(n<2)t=false;for(r in e)this.each(me(r,e[r],t));return this}if(n<2)return(n=this.node()["__on"+e])&&n._;r=false}return this.each(me(e,t,r))};function me(e,r,n){var a="__on"+e,o=e.indexOf("."),s=be;if(o>0)e=e.slice(0,o);var l=ye.get(e);if(l)e=l,s=xe;function u(){var t=this[a];if(t){this.removeEventListener(e,t,t.$);delete this[a]}}function f(){var t=s(r,i(arguments));u.call(this);this.addEventListener(e,this[a]=t,t.$=n);t._=r}function c(){var r=new RegExp("^__on([^.]+)"+t.requote(e)+"$"),n;for(var i in this){if(n=i.match(r)){var a=this[i];this.removeEventListener(n[1],a,a.$);delete this[i]}}}return o?r?f:u:r?D:c}var ye=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});if(a){ye.forEach(function(e){if("on"+e in a)ye.remove(e)})}function be(e,r){return function(n){var i=t.event;t.event=n;r[0]=this.__data__;try{e.apply(this,r)}finally{t.event=i}}}function xe(e,t){var r=be(e,t);return function(e){var t=this,n=e.relatedTarget;if(!n||n!==t&&!(n.compareDocumentPosition(t)&8)){r.call(t,e)}}}var _e,we=0;function Me(e){var r=".dragsuppress-"+ ++we,n="click"+r,i=t.select(s(e)).on("touchmove"+r,B).on("dragstart"+r,B).on("selectstart"+r,B);if(_e==null){_e="onselectstart"in e?false:N(e.style,"userSelect")}if(_e){var a=o(e).style,l=a[_e];a[_e]="none"}return function(e){i.on(r,null);if(_e)a[_e]=l;if(e){var t=function(){i.on(n,null)};i.on(n,function(){B();t()},true);setTimeout(t,0)}}}t.mouse=function(e){return Te(e,U())};var Ae=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function Te(e,r){if(r.changedTouches)r=r.changedTouches[0];var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();if(Ae<0){var a=s(e);if(a.scrollX||a.scrollY){n=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=n[0][0].getScreenCTM();Ae=!(o.f||o.e);n.remove()}}if(Ae)i.x=r.pageX,i.y=r.pageY;else i.x=r.clientX,i.y=r.clientY;i=i.matrixTransform(e.getScreenCTM().inverse());return[i.x,i.y]}var l=e.getBoundingClientRect();return[r.clientX-l.left-e.clientLeft,r.clientY-l.top-e.clientTop]}t.touch=function(e,t,r){if(arguments.length<3)r=t,t=U().changedTouches;if(t)for(var n=0,i=t.length,a;n<i;++n){if((a=t[n]).identifier===r){return Te(e,a)}}};t.behavior.drag=function(){var e=V(a,"drag","dragstart","dragend"),r=null,n=o(D,t.mouse,s,"mousemove","mouseup"),i=o(ke,t.touch,O,"touchmove","touchend");function a(){this.on("mousedown.drag",n).on("touchstart.drag",i)}function o(n,i,a,o,s){return function(){var l=this,u=t.event.target.correspondingElement||t.event.target,f=l.parentNode,c=e.of(l,arguments),h=0,v=n(),d=".drag"+(v==null?"":"-"+v),p,g=t.select(a(u)).on(o+d,b).on(s+d,x),m=Me(u),y=i(f,v);if(r){p=r.apply(l,arguments);p=[p.x-y[0],p.y-y[1]]}else{p=[0,0]}c({type:"dragstart"});function b(){var e=i(f,v),t,r;if(!e)return;t=e[0]-y[0];r=e[1]-y[1];h|=t|r;y=e;c({type:"drag",x:e[0]+p[0],y:e[1]+p[1],dx:t,dy:r})}function x(){if(!i(f,v))return;g.on(o+d,null).on(s+d,null);m(h);c({type:"dragend"})}}}a.origin=function(e){if(!arguments.length)return r;r=e;return a};return t.rebind(a,e,"on")};function ke(){return t.event.changedTouches[0].identifier}t.touches=function(e,t){if(arguments.length<2)t=U().touches;return t?i(t).map(function(t){var r=Te(e,t);r.identifier=t.identifier;return r}):[]};var Ee=1e-6,Se=Ee*Ee,Le=Math.PI,Ce=2*Le,Ie=Ce-Ee,Pe=Le/2,Oe=Le/180,Re=180/Le;function Ne(e){return e>0?1:e<0?-1:0}function ze(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])}function De(e){return e>1?0:e<-1?Le:Math.acos(e)}function Fe(e){return e>1?Pe:e<-1?-Pe:Math.asin(e)}function je(e){return((e=Math.exp(e))-1/e)/2}function Be(e){return((e=Math.exp(e))+1/e)/2}function Ue(e){return((e=Math.exp(2*e))-1)/(e+1)}function Ve(e){return(e=Math.sin(e/2))*e}var He=Math.SQRT2,qe=2,Ge=4;t.interpolateZoom=function(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],o=t[1],s=t[2],l=a-r,u=o-n,f=l*l+u*u,c,h;if(f<Se){h=Math.log(s/i)/He;c=function(e){return[r+e*l,n+e*u,i*Math.exp(He*e*h)]}}else{var v=Math.sqrt(f),d=(s*s-i*i+Ge*f)/(2*i*qe*v),p=(s*s-i*i-Ge*f)/(2*s*qe*v),g=Math.log(Math.sqrt(d*d+1)-d),m=Math.log(Math.sqrt(p*p+1)-p);h=(m-g)/He;c=function(e){var t=e*h,a=Be(g),o=i/(qe*v)*(a*Ue(He*t+g)-je(g));return[r+o*l,n+o*u,i*a/Be(He*t+g)]}}c.duration=h*1e3;return c};t.behavior.zoom=function(){var e={x:0,y:0,k:1},r,n,i,o=[960,500],l=We,u=250,f=0,c="mousedown.zoom",h="mousemove.zoom",v="mouseup.zoom",d,p="touchstart.zoom",g,m=V(w,"zoomstart","zoom","zoomend"),y,b,x,_;if(!Ye){Ye="onwheel"in a?(Xe=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in a?(Xe=function(){return t.event.wheelDelta},"mousewheel"):(Xe=function(){return-t.event.detail},"MozMousePixelScroll")}function w(e){e.on(c,P).on(Ye+".zoom",R).on("dblclick.zoom",N).on(p,O)}w.event=function(r){r.each(function(){var r=m.of(this,arguments),i=e;if(Pl){t.select(this).transition().each("start.zoom",function(){e=this.__chart__||{x:0,y:0,k:1};L(r)}).tween("zoom:zoom",function(){var a=o[0],s=o[1],l=n?n[0]:a/2,u=n?n[1]:s/2,f=t.interpolateZoom([(l-e.x)/e.k,(u-e.y)/e.k,a/e.k],[(l-i.x)/i.k,(u-i.y)/i.k,a/i.k]);return function(t){var n=f(t),i=a/n[2];this.__chart__=e={x:l-n[0]*i,y:u-n[1]*i,k:i};C(r)}}).each("interrupt.zoom",function(){I(r)}).each("end.zoom",function(){I(r)})}else{this.__chart__=e;L(r);C(r);I(r)}})};w.translate=function(t){if(!arguments.length)return[e.x,e.y];e={x:+t[0],y:+t[1],k:e.k};S();return w};w.scale=function(t){if(!arguments.length)return e.k;e={x:e.x,y:e.y,k:null};T(+t);S();return w};w.scaleExtent=function(e){if(!arguments.length)return l;l=e==null?We:[+e[0],+e[1]];return w};w.center=function(e){if(!arguments.length)return i;i=e&&[+e[0],+e[1]];return w};w.size=function(e){if(!arguments.length)return o;o=e&&[+e[0],+e[1]];return w};w.duration=function(e){if(!arguments.length)return u;u=+e;return w};w.x=function(t){if(!arguments.length)return b;b=t;y=t.copy();e={x:0,y:0,k:1};return w};w.y=function(t){if(!arguments.length)return _;_=t;x=t.copy();e={x:0,y:0,k:1};return w};function M(t){return[(t[0]-e.x)/e.k,(t[1]-e.y)/e.k]}function A(t){return[t[0]*e.k+e.x,t[1]*e.k+e.y]}function T(t){e.k=Math.max(l[0],Math.min(l[1],t))}function k(t,r){r=A(r);e.x+=t[0]-r[0];e.y+=t[1]-r[1]}function E(r,i,a,o){r.__chart__={x:e.x,y:e.y,k:e.k};T(Math.pow(2,o));k(n=i,a);r=t.select(r);if(u>0)r=r.transition().duration(u);r.call(w.event)}function S(){if(b)b.domain(y.range().map(function(t){return(t-e.x)/e.k}).map(y.invert));if(_)_.domain(x.range().map(function(t){return(t-e.y)/e.k}).map(x.invert))}function L(e){if(!f++)e({type:"zoomstart"})}function C(t){S();t({type:"zoom",scale:e.k,translate:[e.x,e.y]})}function I(e){if(!--f)e({type:"zoomend"}),n=null}function P(){var e=this,r=m.of(e,arguments),n=0,i=t.select(s(e)).on(h,l).on(v,u),a=M(t.mouse(e)),o=Me(e);El.call(e);L(r);function l(){n=1;k(t.mouse(e),a);C(r)}function u(){i.on(h,null).on(v,null);o(n);I(r)}}function O(){var r=this,n=m.of(r,arguments),i={},a=0,o,s=".zoom-"+t.event.changedTouches[0].identifier,l="touchmove"+s,u="touchend"+s,f=[],h=t.select(r),v=Me(r);y();L(n);h.on(c,null).on(p,y);function d(){var n=t.touches(r);o=e.k;n.forEach(function(e){if(e.identifier in i)i[e.identifier]=M(e)});return n}function y(){var n=t.event.target;t.select(n).on(l,b).on(u,x);f.push(n);var o=t.event.changedTouches;for(var s=0,c=o.length;s<c;++s){i[o[s].identifier]=null}var h=d(),v=Date.now();if(h.length===1){if(v-g<500){var p=h[0];E(r,p,i[p.identifier],Math.floor(Math.log(e.k)/Math.LN2)+1);B()}g=v}else if(h.length>1){var p=h[0],m=h[1],y=p[0]-m[0],_=p[1]-m[1];a=y*y+_*_}}function b(){var e=t.touches(r),s,l,u,f;El.call(r);for(var c=0,h=e.length;c<h;++c,f=null){u=e[c];if(f=i[u.identifier]){if(l)break;s=u,l=f}}if(f){var v=(v=u[0]-s[0])*v+(v=u[1]-s[1])*v,d=a&&Math.sqrt(v/a);s=[(s[0]+u[0])/2,(s[1]+u[1])/2];l=[(l[0]+f[0])/2,(l[1]+f[1])/2];T(d*o)}g=null;k(s,l);C(n)}function x(){if(t.event.touches.length){var e=t.event.changedTouches;for(var r=0,a=e.length;r<a;++r){delete i[e[r].identifier]}for(var o in i){return void d()}}t.selectAll(f).on(s,null);h.on(c,P).on(p,O);v();I(n)}}function R(){var a=m.of(this,arguments);if(d)clearTimeout(d);else El.call(this),r=M(n=i||t.mouse(this)),L(a);d=setTimeout(function(){d=null;I(a)},50);B();T(Math.pow(2,Xe()*.002)*e.k);k(n,r);C(a)}function N(){var r=t.mouse(this),n=Math.log(e.k)/Math.LN2;E(this,r,M(r),t.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1)}return t.rebind(w,m,"on")};var We=[0,Infinity],Xe,Ye;t.color=Ze;function Ze(){}Ze.prototype.toString=function(){return this.rgb()+""};t.hsl=Qe;function Qe(e,t,r){return this instanceof Qe?void(this.h=+e,this.s=+t,this.l=+r):arguments.length<2?e instanceof Qe?new Qe(e.h,e.s,e.l):yt(""+e,bt,Qe):new Qe(e,t,r)}var Ke=Qe.prototype=new Ze;Ke.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);return new Qe(this.h,this.s,this.l/e)};Ke.darker=function(e){e=Math.pow(.7,arguments.length?e:1);return new Qe(this.h,this.s,e*this.l)};Ke.rgb=function(){return Je(this.h,this.s,this.l)};function Je(e,t,r){var n,i;e=isNaN(e)?0:(e%=360)<0?e+360:e;t=isNaN(t)?0:t<0?0:t>1?1:t;r=r<0?0:r>1?1:r;i=r<=.5?r*(1+t):r+t-r*t;n=2*r-i;function a(e){if(e>360)e-=360;else if(e<0)e+=360;if(e<60)return n+(i-n)*e/60;if(e<180)return i;if(e<240)return n+(i-n)*(240-e)/60;return n}function o(e){return Math.round(a(e)*255)}return new vt(o(e+120),o(e),o(e-120))}t.hcl=$e;function $e(e,r,n){return this instanceof $e?void(this.h=+e,this.c=+r,this.l=+n):arguments.length<2?e instanceof $e?new $e(e.h,e.c,e.l):e instanceof rt?ut(e.l,e.a,e.b):ut((e=xt((e=t.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new $e(e,r,n)}var et=$e.prototype=new Ze;et.brighter=function(e){return new $e(this.h,this.c,Math.min(100,this.l+nt*(arguments.length?e:1)))};et.darker=function(e){return new $e(this.h,this.c,Math.max(0,this.l-nt*(arguments.length?e:1)))};et.rgb=function(){return tt(this.h,this.c,this.l).rgb()};function tt(e,t,r){if(isNaN(e))e=0;if(isNaN(t))t=0;return new rt(r,Math.cos(e*=Oe)*t,Math.sin(e)*t)}t.lab=rt;function rt(e,t,r){return this instanceof rt?void(this.l=+e,this.a=+t,this.b=+r):arguments.length<2?e instanceof rt?new rt(e.l,e.a,e.b):e instanceof $e?tt(e.h,e.c,e.l):xt((e=vt(e)).r,e.g,e.b):new rt(e,t,r)}var nt=18;var it=.95047,at=1,ot=1.08883;var st=rt.prototype=new Ze;st.brighter=function(e){return new rt(Math.min(100,this.l+nt*(arguments.length?e:1)),this.a,this.b)};st.darker=function(e){return new rt(Math.max(0,this.l-nt*(arguments.length?e:1)),this.a,this.b)};st.rgb=function(){return lt(this.l,this.a,this.b)};function lt(e,t,r){var n=(e+16)/116,i=n+t/500,a=n-r/200;i=ft(i)*it;n=ft(n)*at;a=ft(a)*ot;return new vt(ht(3.2404542*i-1.5371385*n-.4985314*a),ht(-.969266*i+1.8760108*n+.041556*a),ht(.0556434*i-.2040259*n+1.0572252*a))}function ut(e,t,r){return e>0?new $e(Math.atan2(r,t)*Re,Math.sqrt(t*t+r*r),e):new $e(NaN,NaN,e)}function ft(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function ct(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function ht(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}t.rgb=vt;function vt(e,t,r){return this instanceof vt?void(this.r=~~e,this.g=~~t,this.b=~~r):arguments.length<2?e instanceof vt?new vt(e.r,e.g,e.b):yt(""+e,vt,Je):new vt(e,t,r)}function dt(e){return new vt(e>>16,e>>8&255,e&255)}function pt(e){return dt(e)+""}var gt=vt.prototype=new Ze;gt.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,r=this.g,n=this.b,i=30;if(!t&&!r&&!n)return new vt(i,i,i);if(t&&t<i)t=i;if(r&&r<i)r=i;if(n&&n<i)n=i;return new vt(Math.min(255,t/e),Math.min(255,r/e),Math.min(255,n/e))};gt.darker=function(e){e=Math.pow(.7,arguments.length?e:1);return new vt(e*this.r,e*this.g,e*this.b)};gt.hsl=function(){return bt(this.r,this.g,this.b)};gt.toString=function(){return"#"+mt(this.r)+mt(this.g)+mt(this.b)};function mt(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function yt(e,t,r){var n=0,i=0,a=0,o,s,l;o=/([a-z]+)\((.*)\)/.exec(e=e.toLowerCase());if(o){s=o[2].split(",");switch(o[1]){case"hsl":{return r(parseFloat(s[0]),parseFloat(s[1])/100,parseFloat(s[2])/100)}case"rgb":{return t(wt(s[0]),wt(s[1]),wt(s[2]))}}}if(l=Mt.get(e)){return t(l.r,l.g,l.b)}if(e!=null&&e.charAt(0)==="#"&&!isNaN(l=parseInt(e.slice(1),16))){if(e.length===4){n=(l&3840)>>4;n=n>>4|n;i=l&240;i=i>>4|i;a=l&15;a=a<<4|a}else if(e.length===7){n=(l&16711680)>>16;i=(l&65280)>>8;a=l&255}}return t(n,i,a)}function bt(e,t,r){var n=Math.min(e/=255,t/=255,r/=255),i=Math.max(e,t,r),a=i-n,o,s,l=(i+n)/2;if(a){s=l<.5?a/(i+n):a/(2-i-n);if(e==i)o=(t-r)/a+(t<r?6:0);else if(t==i)o=(r-e)/a+2;else o=(e-t)/a+4;o*=60}else{o=NaN;s=l>0&&l<1?0:o}return new Qe(o,s,l)}function xt(e,t,r){e=_t(e);t=_t(t);r=_t(r);var n=ct((.4124564*e+.3575761*t+.1804375*r)/it),i=ct((.2126729*e+.7151522*t+.072175*r)/at),a=ct((.0193339*e+.119192*t+.9503041*r)/ot);return rt(116*i-16,500*(n-i),200*(i-a))}function _t(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function wt(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}var Mt=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Mt.forEach(function(e,t){Mt.set(e,dt(t))});function At(e){return typeof e==="function"?e:function(){return e}}t.functor=At;t.xhr=Tt(O);function Tt(e){return function(t,r,n){if(arguments.length===2&&typeof r==="function")n=r,r=null;return kt(t,r,e,n)}}function kt(e,r,n,a){var o={},s=t.dispatch("beforesend","progress","load","error"),l={},u=new XMLHttpRequest,f=null;if(this.XDomainRequest&&!("withCredentials"in u)&&/^(http(s)?:)?\/\//.test(e))u=new XDomainRequest;"onload"in u?u.onload=u.onerror=c:u.onreadystatechange=function(){u.readyState>3&&c()};function c(){var e=u.status,t;if(!e&&St(u)||e>=200&&e<300||e===304){try{t=n.call(o,u)}catch(e){s.error.call(o,e);return}s.load.call(o,t)}else{s.error.call(o,u)}}u.onprogress=function(e){var r=t.event;t.event=e;try{s.progress.call(o,u)}finally{t.event=r}};o.header=function(e,t){e=(e+"").toLowerCase();if(arguments.length<2)return l[e];if(t==null)delete l[e];else l[e]=t+"";return o};o.mimeType=function(e){if(!arguments.length)return r;r=e==null?null:e+"";return o};o.responseType=function(e){if(!arguments.length)return f;f=e;return o};o.response=function(e){n=e;return o};["get","post"].forEach(function(e){o[e]=function(){return o.send.apply(o,[e].concat(i(arguments)))}});o.send=function(t,n,i){if(arguments.length===2&&typeof n==="function")i=n,n=null;u.open(t,e,true);if(r!=null&&!("accept"in l))l["accept"]=r+",*/*";if(u.setRequestHeader)for(var a in l)u.setRequestHeader(a,l[a]);if(r!=null&&u.overrideMimeType)u.overrideMimeType(r);if(f!=null)u.responseType=f;if(i!=null)o.on("error",i).on("load",function(e){i(null,e)});s.beforesend.call(o,u);u.send(n==null?null:n);return o};o.abort=function(){u.abort();return o};t.rebind(o,s,"on");return a==null?o:o.get(Et(a))}function Et(e){return e.length===1?function(t,r){e(t==null?r:null)}:e}function St(e){var t=e.responseType;return t&&t!=="text"?e.response:e.responseText}t.dsv=function(e,t){var r=new RegExp('["'+e+"\n]"),n=e.charCodeAt(0);function i(e,r,n){if(arguments.length<3)n=r,r=null;var i=kt(e,t,r==null?a:o(r),n);i.row=function(e){return arguments.length?i.response((r=e)==null?a:o(e)):r};return i}function a(e){return i.parse(e.responseText)}function o(e){return function(t){return i.parse(t.responseText,e)}}i.parse=function(e,t){var r;return i.parseRows(e,function(e,n){if(r)return r(e,n-1);var i=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");r=t?function(e,r){return t(i(e),r)}:i})};i.parseRows=function(e,t){var r={},i={},a=[],o=e.length,s=0,l=0,u,f;function c(){if(s>=o)return i;if(f)return f=false,r;var t=s;if(e.charCodeAt(t)===34){var a=t;while(a++<o){if(e.charCodeAt(a)===34){if(e.charCodeAt(a+1)!==34)break;++a}}s=a+2;var l=e.charCodeAt(a+1);if(l===13){f=true;if(e.charCodeAt(a+2)===10)++s}else if(l===10){f=true}return e.slice(t+1,a).replace(/""/g,'"')}while(s<o){var l=e.charCodeAt(s++),u=1;if(l===10)f=true;else if(l===13){f=true;if(e.charCodeAt(s)===10)++s,++u}else if(l!==n)continue;return e.slice(t,s-u)}return e.slice(t)}while((u=c())!==i){var h=[];while(u!==r&&u!==i){h.push(u);u=c()}if(t&&(h=t(h,l++))==null)continue;a.push(h)}return a};i.format=function(t){if(Array.isArray(t[0]))return i.formatRows(t);var r=new P,n=[];t.forEach(function(e){for(var t in e){if(!r.has(t)){n.push(r.add(t))}}});return[n.map(l).join(e)].concat(t.map(function(t){return n.map(function(e){return l(t[e])}).join(e)})).join("\n")};i.formatRows=function(e){return e.map(s).join("\n")};function s(t){return t.map(l).join(e)}function l(e){return r.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}return i};t.csv=t.dsv(",","text/csv");t.tsv=t.dsv("\t","text/tab-separated-values");var Lt,Ct,It,Pt,Ot=this[N(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)};t.timer=function(){Rt.apply(this,arguments)};function Rt(e,t,r){var n=arguments.length;if(n<2)t=0;if(n<3)r=Date.now();var i=r+t,a={c:e,t:i,n:null};if(Ct)Ct.n=a;else Lt=a;Ct=a;if(!It){Pt=clearTimeout(Pt);It=1;Ot(Nt)}return a}function Nt(){var e=zt(),t=Dt()-e;if(t>24){if(isFinite(t)){clearTimeout(Pt);Pt=setTimeout(Nt,t)}It=0}else{It=1;Ot(Nt)}}t.timer.flush=function(){zt();Dt()};function zt(){var e=Date.now(),t=Lt;while(t){if(e>=t.t&&t.c(e-t.t))t.c=null;t=t.n}return e}function Dt(){var e,t=Lt,r=Infinity;while(t){if(t.c){if(t.t<r)r=t.t;t=(e=t).n}else{t=e?e.n=t.n:Lt=t.n}}Ct=e;return r}function Ft(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}t.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)};var jt=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(Bt);t.formatPrefix=function(e,r){var n=0;if(e=+e){if(e<0)e*=-1;if(r)e=t.round(e,Ft(e,r));n=1+Math.floor(1e-12+Math.log(e)/Math.LN10);n=Math.max(-24,Math.min(24,Math.floor((n-1)/3)*3))}return jt[8+n/3]};function Bt(e,t){var r=Math.pow(10,b(8-t)*3);return{scale:t>8?function(e){return e/r}:function(e){return e*r},symbol:e}}function Ut(e){var r=e.decimal,n=e.thousands,i=e.grouping,a=e.currency,o=i&&n?function(e,t){var r=e.length,a=[],o=0,s=i[0],l=0;while(r>0&&s>0){if(l+s+1>t)s=Math.max(1,t-l);a.push(e.substring(r-=s,r+s));if((l+=s+1)>t)break;s=i[o=(o+1)%i.length]}return a.reverse().join(n)}:O;return function(e){var n=Vt.exec(e),i=n[1]||" ",s=n[2]||">",l=n[3]||"-",u=n[4]||"",f=n[5],c=+n[6],h=n[7],v=n[8],d=n[9],p=1,g="",m="",y=false,b=true;if(v)v=+v.substring(1);if(f||i==="0"&&s==="="){f=i="0";s="="}switch(d){case"n":h=true;d="g";break;case"%":p=100;m="%";d="f";break;case"p":p=100;m="%";d="r";break;case"b":case"o":case"x":case"X":if(u==="#")g="0"+d.toLowerCase();case"c":b=false;case"d":y=true;v=0;break;case"s":p=-1;d="r";break}if(u==="$")g=a[0],m=a[1];if(d=="r"&&!v)d="g";if(v!=null){if(d=="g")v=Math.max(1,Math.min(21,v));else if(d=="e"||d=="f")v=Math.max(0,Math.min(20,v))}d=Ht.get(d)||qt;var x=f&&h;return function(e){var n=m;if(y&&e%1)return"";var a=e<0||e===0&&1/e<0?(e=-e,"-"):l==="-"?"":l;if(p<0){var u=t.formatPrefix(e,v);e=u.scale(e);n=u.symbol+m}else{e*=p}e=d(e,v);var _=e.lastIndexOf("."),w,M;if(_<0){var A=b?e.lastIndexOf("e"):-1;if(A<0)w=e,M="";else w=e.substring(0,A),M=e.substring(A)}else{w=e.substring(0,_);M=r+e.substring(_+1)}if(!f&&h)w=o(w,Infinity);var T=g.length+w.length+M.length+(x?0:a.length),k=T<c?new Array(T=c-T+1).join(i):"";if(x)w=o(k+w,k.length?c-M.length:Infinity);a+=g;e=w+M;return(s==="<"?a+e+k:s===">"?k+a+e:s==="^"?k.substring(0,T>>=1)+a+e+k.substring(T):a+(x?e:k+e))+n}}}var Vt=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;var Ht=t.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,r){return(e=t.round(e,Ft(e,r))).toFixed(Math.max(0,Math.min(20,Ft(e*(1+1e-15),r))))}});function qt(e){return e+""}var Gt=t.time={},Wt=Date;function Xt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}Xt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Yt.setUTCDate.apply(this._,arguments)},setDay:function(){Yt.setUTCDay.apply(this._,arguments)},setFullYear:function(){Yt.setUTCFullYear.apply(this._,arguments)},setHours:function(){Yt.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Yt.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Yt.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Yt.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Yt.setUTCSeconds.apply(this._,arguments)},setTime:function(){Yt.setTime.apply(this._,arguments)}};var Yt=Date.prototype;function Zt(e,t,r){function n(t){var r=e(t),n=a(r,1);return t-r<n-t?r:n}function i(r){t(r=e(new Wt(r-1)),1);return r}function a(e,r){t(e=new Wt(+e),r);return e}function o(e,n,a){var o=i(e),s=[];if(a>1){while(o<n){if(!(r(o)%a))s.push(new Date(+o));t(o,1)}}else{while(o<n)s.push(new Date(+o)),t(o,1)}return s}function s(e,t,r){try{Wt=Xt;var n=new Xt;n._=e;return o(n,t,r)}finally{Wt=Date}}e.floor=e;e.round=n;e.ceil=i;e.offset=a;e.range=o;var l=e.utc=Qt(e);l.floor=l;l.round=Qt(n);l.ceil=Qt(i);l.offset=Qt(a);l.range=s;return e}function Qt(e){return function(t,r){try{Wt=Xt;var n=new Xt;n._=t;return e(n,r)._}finally{Wt=Date}}}Gt.year=Zt(function(e){e=Gt.day(e);e.setMonth(0,1);return e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()});Gt.years=Gt.year.range;Gt.years.utc=Gt.year.utc.range;Gt.day=Zt(function(e){var t=new Wt(2e3,0);t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate());return t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1});Gt.days=Gt.day.range;Gt.days.utc=Gt.day.utc.range;Gt.dayOfYear=function(e){var t=Gt.year(e);return Math.floor((e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/864e5)};["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var r=Gt[e]=Zt(function(e){(e=Gt.day(e)).setDate(e.getDate()-(e.getDay()+t)%7);return e},function(e,t){e.setDate(e.getDate()+Math.floor(t)*7)},function(e){var r=Gt.year(e).getDay();return Math.floor((Gt.dayOfYear(e)+(r+t)%7)/7)-(r!==t)});Gt[e+"s"]=r.range;Gt[e+"s"].utc=r.utc.range;Gt[e+"OfYear"]=function(e){var r=Gt.year(e).getDay();return Math.floor((Gt.dayOfYear(e)+(r+t)%7)/7)}});Gt.week=Gt.sunday;Gt.weeks=Gt.sunday.range;Gt.weeks.utc=Gt.sunday.utc.range;Gt.weekOfYear=Gt.sundayOfYear;function Kt(e){var r=e.dateTime,n=e.date,i=e.time,a=e.periods,o=e.days,s=e.shortDays,l=e.months,u=e.shortMonths;function f(e){var t=e.length;function r(r){var n=[],i=-1,a=0,o,s,l;while(++i<t){if(e.charCodeAt(i)===37){n.push(e.slice(a,i));if((s=Jt[o=e.charAt(++i)])!=null)o=e.charAt(++i);if(l=_[o])o=l(r,s==null?o==="e"?" ":"0":s);n.push(o);a=i+1}}n.push(e.slice(a,i));return n.join("")}r.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},n=c(r,e,t,0);if(n!=t.length)return null;if("p"in r)r.H=r.H%12+r.p*12;var i=r.Z!=null&&Wt!==Xt,a=new(i?Xt:Wt);if("j"in r)a.setFullYear(r.y,0,r.j);else if("W"in r||"U"in r){if(!("w"in r))r.w="W"in r?1:0;a.setFullYear(r.y,0,1);a.setFullYear(r.y,0,"W"in r?(r.w+6)%7+r.W*7-(a.getDay()+5)%7:r.w+r.U*7-(a.getDay()+6)%7)}else a.setFullYear(r.y,r.m,r.d);a.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L);return i?a._:a};r.toString=function(){return e};return r}function c(e,t,r,n){var i,a,o,s=0,l=t.length,u=r.length;while(s<l){if(n>=u)return-1;i=t.charCodeAt(s++);if(i===37){o=t.charAt(s++);a=w[o in Jt?t.charAt(s++):o];if(!a||(n=a(e,r,n))<0)return-1}else if(i!=r.charCodeAt(n++)){return-1}}return n}f.utc=function(e){var t=f(e);function r(e){try{Wt=Xt;var r=new Wt;r._=e;return t(r)}finally{Wt=Date}}r.parse=function(e){try{Wt=Xt;var r=t.parse(e);return r&&r._}finally{Wt=Date}};r.toString=t.toString;return r};f.multi=f.utc.multi=xr;var h=t.map(),v=rr(o),d=nr(o),p=rr(s),g=nr(s),m=rr(l),y=nr(l),b=rr(u),x=nr(u);a.forEach(function(e,t){h.set(e.toLowerCase(),t)});var _={a:function(e){return s[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return l[e.getMonth()]},c:f(r),d:function(e,t){return tr(e.getDate(),t,2)},e:function(e,t){return tr(e.getDate(),t,2)},H:function(e,t){return tr(e.getHours(),t,2)},I:function(e,t){return tr(e.getHours()%12||12,t,2)},j:function(e,t){return tr(1+Gt.dayOfYear(e),t,3)},L:function(e,t){return tr(e.getMilliseconds(),t,3)},m:function(e,t){return tr(e.getMonth()+1,t,2)},M:function(e,t){return tr(e.getMinutes(),t,2)},p:function(e){return a[+(e.getHours()>=12)]},S:function(e,t){return tr(e.getSeconds(),t,2)},U:function(e,t){return tr(Gt.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return tr(Gt.mondayOfYear(e),t,2)},x:f(n),X:f(i),y:function(e,t){return tr(e.getFullYear()%100,t,2)},Y:function(e,t){return tr(e.getFullYear()%1e4,t,4)},Z:yr,"%":function(){return"%"}};var w={a:M,A:A,b:T,B:k,c:E,d:hr,e:hr,H:dr,I:dr,j:vr,L:mr,m:cr,M:pr,p:C,S:gr,U:ar,w:ir,W:or,x:S,X:L,y:lr,Y:sr,Z:ur,"%":br};function M(e,t,r){p.lastIndex=0;var n=p.exec(t.slice(r));return n?(e.w=g.get(n[0].toLowerCase()),r+n[0].length):-1}function A(e,t,r){v.lastIndex=0;var n=v.exec(t.slice(r));return n?(e.w=d.get(n[0].toLowerCase()),r+n[0].length):-1}function T(e,t,r){b.lastIndex=0;var n=b.exec(t.slice(r));return n?(e.m=x.get(n[0].toLowerCase()),r+n[0].length):-1}function k(e,t,r){m.lastIndex=0;var n=m.exec(t.slice(r));return n?(e.m=y.get(n[0].toLowerCase()),r+n[0].length):-1}function E(e,t,r){return c(e,_.c.toString(),t,r)}function S(e,t,r){return c(e,_.x.toString(),t,r)}function L(e,t,r){return c(e,_.X.toString(),t,r)}function C(e,t,r){var n=h.get(t.slice(r,r+=2).toLowerCase());return n==null?-1:(e.p=n,r)}return f}var Jt={"-":"",_:" ",0:"0"},$t=/^\s*\d+/,er=/^%/;function tr(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function rr(e){return new RegExp("^(?:"+e.map(t.requote).join("|")+")","i")}function nr(e){var t=new w,r=-1,n=e.length;while(++r<n)t.set(e[r].toLowerCase(),r);return t}function ir(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function ar(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r));return n?(e.U=+n[0],r+n[0].length):-1}function or(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r));return n?(e.W=+n[0],r+n[0].length):-1}function sr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function lr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+2));return n?(e.y=fr(+n[0]),r+n[0].length):-1}function ur(e,t,r){return/^[+-]\d{4}$/.test(t=t.slice(r,r+5))?(e.Z=-t,r+5):-1}function fr(e){return e+(e>68?1900:2e3)}function cr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function hr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function vr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+3));return n?(e.j=+n[0],r+n[0].length):-1}function dr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function pr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function gr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function mr(e,t,r){$t.lastIndex=0;var n=$t.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function yr(e){var t=e.getTimezoneOffset(),r=t>0?"-":"+",n=b(t)/60|0,i=b(t)%60;return r+tr(n,"0",2)+tr(i,"0",2)}function br(e,t,r){er.lastIndex=0;var n=er.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function xr(e){var t=e.length,r=-1;while(++r<t)e[r][0]=this(e[r][0]);return function(t){var r=0,n=e[r];while(!n[1](t))n=e[++r];return n[0](t)}}t.locale=function(e){return{numberFormat:Ut(e),timeFormat:Kt(e)}};var _r=t.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});t.format=_r.numberFormat;t.geo={};function wr(){}wr.prototype={s:0,t:0,add:function(e){Ar(e,this.t,Mr);Ar(Mr.s,this.s,this);if(this.s)this.t+=Mr.t;else this.s=Mr.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var Mr=new wr;function Ar(e,t,r){var n=r.s=e+t,i=n-e,a=n-i;r.t=e-a+(t-i)}t.geo.stream=function(e,t){if(e&&kr.hasOwnProperty(e.type)){kr[e.type](e,t)}else{Tr(e,t)}};function Tr(e,t){if(e&&Er.hasOwnProperty(e.type)){Er[e.type](e,t)}}var kr={Feature:function(e,t){Tr(e.geometry,t)},FeatureCollection:function(e,t){var r=e.features,n=-1,i=r.length;while(++n<i)Tr(r[n].geometry,t)}};var Er={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates;t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){var r=e.coordinates,n=-1,i=r.length;while(++n<i)e=r[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){Sr(e.coordinates,t,0)},MultiLineString:function(e,t){var r=e.coordinates,n=-1,i=r.length;while(++n<i)Sr(r[n],t,0)},Polygon:function(e,t){Lr(e.coordinates,t)},MultiPolygon:function(e,t){var r=e.coordinates,n=-1,i=r.length;while(++n<i)Lr(r[n],t)},GeometryCollection:function(e,t){var r=e.geometries,n=-1,i=r.length;while(++n<i)Tr(r[n],t)}};function Sr(e,t,r){var n=-1,i=e.length-r,a;t.lineStart();while(++n<i)a=e[n],t.point(a[0],a[1],a[2]);t.lineEnd()}function Lr(e,t){var r=-1,n=e.length;t.polygonStart();while(++r<n)Sr(e[r],t,1);t.polygonEnd()}t.geo.area=function(e){Cr=0;t.geo.stream(e,Pr);return Cr};var Cr,Ir=new wr;var Pr={sphere:function(){Cr+=4*Le},point:D,lineStart:D,lineEnd:D,polygonStart:function(){Ir.reset();Pr.lineStart=Or},polygonEnd:function(){var e=2*Ir;Cr+=e<0?4*Le+e:e;Pr.lineStart=Pr.lineEnd=Pr.point=D}};function Or(){var e,t,r,n,i;Pr.point=function(o,s){Pr.point=a;r=(e=o)*Oe,n=Math.cos(s=(t=s)*Oe/2+Le/4),i=Math.sin(s)};function a(e,t){e*=Oe;t=t*Oe/2+Le/4;var a=e-r,o=a>=0?1:-1,s=o*a,l=Math.cos(t),u=Math.sin(t),f=i*u,c=n*l+f*Math.cos(s),h=f*o*Math.sin(s);Ir.add(Math.atan2(h,c));r=e,n=l,i=u}Pr.lineEnd=function(){a(e,t)}}function Rr(e){var t=e[0],r=e[1],n=Math.cos(r);return[n*Math.cos(t),n*Math.sin(t),Math.sin(r)]}function Nr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function zr(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Dr(e,t){e[0]+=t[0];e[1]+=t[1];e[2]+=t[2]}function Fr(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function jr(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t;e[1]/=t;e[2]/=t}function Br(e){return[Math.atan2(e[1],e[0]),Fe(e[2])]}function Ur(e,t){return b(e[0]-t[0])<Ee&&b(e[1]-t[1])<Ee}t.geo.bounds=function(){var e,r,n,i,a,o,s,l,u,f,c;var h={point:v,lineStart:p,lineEnd:g,polygonStart:function(){h.point=m;h.lineStart=y;h.lineEnd=x;u=0;Pr.polygonStart()},polygonEnd:function(){Pr.polygonEnd();h.point=v;h.lineStart=p;h.lineEnd=g;if(Ir<0)e=-(n=180),r=-(i=90);else if(u>Ee)i=90;else if(u<-Ee)r=-90;c[0]=e,c[1]=n}};function v(t,a){f.push(c=[e=t,n=t]);if(a<r)r=a;if(a>i)i=a}function d(t,o){var s=Rr([t*Oe,o*Oe]);if(l){var u=zr(l,s),f=[u[1],-u[0],0],c=zr(f,u);jr(c);c=Br(c);var h=t-a,d=h>0?1:-1,p=c[0]*Re*d,g=b(h)>180;if(g^(d*a<p&&p<d*t)){var m=c[1]*Re;if(m>i)i=m}else if(p=(p+360)%360-180,g^(d*a<p&&p<d*t)){var m=-c[1]*Re;if(m<r)r=m}else{if(o<r)r=o;if(o>i)i=o}if(g){if(t<a){if(_(e,t)>_(e,n))n=t}else{if(_(t,n)>_(e,n))e=t}}else{if(n>=e){if(t<e)e=t;if(t>n)n=t}else{if(t>a){if(_(e,t)>_(e,n))n=t}else{if(_(t,n)>_(e,n))e=t}}}}else{v(t,o)}l=s,a=t}function p(){h.point=d}function g(){c[0]=e,c[1]=n;h.point=v;l=null}function m(e,t){if(l){var r=e-a;u+=b(r)>180?r+(r>0?360:-360):r}else o=e,s=t;Pr.point(e,t);d(e,t)}function y(){Pr.lineStart()}function x(){m(o,s);Pr.lineEnd();if(b(u)>Ee)e=-(n=180);c[0]=e,c[1]=n;l=null}function _(e,t){return(t-=e)<0?t+360:t}function w(e,t){return e[0]-t[0]}function M(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}return function(a){i=n=-(e=r=Infinity);f=[];t.geo.stream(a,h);var o=f.length;if(o){f.sort(w);for(var s=1,l=f[0],u,v=[l];s<o;++s){u=f[s];if(M(u[0],l)||M(u[1],l)){if(_(l[0],u[1])>_(l[0],l[1]))l[1]=u[1];if(_(u[0],l[1])>_(l[0],l[1]))l[0]=u[0]}else{v.push(l=u)}}var d=-Infinity,p;for(var o=v.length-1,s=0,l=v[o],u;s<=o;l=u,++s){u=v[s];if((p=_(l[1],u[0]))>d)d=p,e=u[0],n=l[1]}}f=c=null;return e===Infinity||r===Infinity?[[NaN,NaN],[NaN,NaN]]:[[e,r],[n,i]]}}();t.geo.centroid=function(e){Vr=Hr=qr=Gr=Wr=Xr=Yr=Zr=Qr=Kr=Jr=0;t.geo.stream(e,$r);var r=Qr,n=Kr,i=Jr,a=r*r+n*n+i*i;if(a<Se){r=Xr,n=Yr,i=Zr;if(Hr<Ee)r=qr,n=Gr,i=Wr;a=r*r+n*n+i*i;if(a<Se)return[NaN,NaN]}return[Math.atan2(n,r)*Re,Fe(i/Math.sqrt(a))*Re]};var Vr,Hr,qr,Gr,Wr,Xr,Yr,Zr,Qr,Kr,Jr;var $r={sphere:D,point:en,lineStart:rn,lineEnd:nn,polygonStart:function(){$r.lineStart=an},polygonEnd:function(){$r.lineStart=rn}};function en(e,t){e*=Oe;var r=Math.cos(t*=Oe);tn(r*Math.cos(e),r*Math.sin(e),Math.sin(t))}function tn(e,t,r){++Vr;qr+=(e-qr)/Vr;Gr+=(t-Gr)/Vr;Wr+=(r-Wr)/Vr}function rn(){var e,t,r;$r.point=function(i,a){i*=Oe;var o=Math.cos(a*=Oe);e=o*Math.cos(i);t=o*Math.sin(i);r=Math.sin(a);$r.point=n;tn(e,t,r)};function n(n,i){n*=Oe;var a=Math.cos(i*=Oe),o=a*Math.cos(n),s=a*Math.sin(n),l=Math.sin(i),u=Math.atan2(Math.sqrt((u=t*l-r*s)*u+(u=r*o-e*l)*u+(u=e*s-t*o)*u),e*o+t*s+r*l);Hr+=u;Xr+=u*(e+(e=o));Yr+=u*(t+(t=s));Zr+=u*(r+(r=l));tn(e,t,r)}}function nn(){$r.point=en}function an(){var e,t,r,n,i;$r.point=function(o,s){e=o,t=s;$r.point=a;o*=Oe;var l=Math.cos(s*=Oe);r=l*Math.cos(o);n=l*Math.sin(o);i=Math.sin(s);tn(r,n,i)};$r.lineEnd=function(){a(e,t);$r.lineEnd=nn;$r.point=en};function a(e,t){e*=Oe;var a=Math.cos(t*=Oe),o=a*Math.cos(e),s=a*Math.sin(e),l=Math.sin(t),u=n*l-i*s,f=i*o-r*l,c=r*s-n*o,h=Math.sqrt(u*u+f*f+c*c),v=r*o+n*s+i*l,d=h&&-De(v)/h,p=Math.atan2(h,v);Qr+=d*u;Kr+=d*f;Jr+=d*c;Hr+=p;Xr+=p*(r+(r=o));Yr+=p*(n+(n=s));Zr+=p*(i+(i=l));tn(r,n,i)}}function on(e,t){function r(r,n){return r=e(r,n),t(r[0],r[1])}if(e.invert&&t.invert)r.invert=function(r,n){return r=t.invert(r,n),r&&e.invert(r[0],r[1])};return r}function sn(){return true}function ln(e,t,r,n,i){var a=[],o=[];e.forEach(function(e){if((t=e.length-1)<=0)return;var t,r=e[0],n=e[t];if(Ur(r,n)){i.lineStart();for(var s=0;s<t;++s)i.point((r=e[s])[0],r[1]);i.lineEnd();return}var l=new fn(r,e,null,true),u=new fn(r,null,l,false);l.o=u;a.push(l);o.push(u);l=new fn(n,e,null,false);u=new fn(n,null,l,true);l.o=u;a.push(l);o.push(u)});o.sort(t);un(a);un(o);if(!a.length)return;for(var s=0,l=r,u=o.length;s<u;++s){o[s].e=l=!l}var f=a[0],c,h;while(1){var v=f,d=true;while(v.v)if((v=v.n)===f)return;c=v.z;i.lineStart();do{v.v=v.o.v=true;if(v.e){if(d){for(var s=0,u=c.length;s<u;++s)i.point((h=c[s])[0],h[1])}else{n(v.x,v.n.x,1,i)}v=v.n}else{if(d){c=v.p.z;for(var s=c.length-1;s>=0;--s)i.point((h=c[s])[0],h[1])}else{n(v.x,v.p.x,-1,i)}v=v.p}v=v.o;c=v.z;d=!d}while(!v.v);i.lineEnd()}}function un(e){if(!(t=e.length))return;var t,r=0,n=e[0],i;while(++r<t){n.n=i=e[r];i.p=n;n=i}n.n=i=e[0];i.p=n}function fn(e,t,r,n){this.x=e;this.z=t;this.o=r;this.e=n;this.v=false;this.n=this.p=null}function cn(e,r,n,i){return function(a,o){var s=r(o),l=a.invert(i[0],i[1]);var u={point:f,lineStart:h,lineEnd:v,polygonStart:function(){u.point=x;u.lineStart=_;u.lineEnd=w;d=[];y=[]},polygonEnd:function(){u.point=f;u.lineStart=h;u.lineEnd=v;d=t.merge(d);var e=bn(l,y);if(d.length){if(!m)o.polygonStart(),m=true;ln(d,dn,e,n,o)}else if(e){if(!m)o.polygonStart(),m=true;o.lineStart();n(null,null,1,o);o.lineEnd()}if(m)o.polygonEnd(),m=false;d=y=null},sphere:function(){o.polygonStart();o.lineStart();n(null,null,1,o);o.lineEnd();o.polygonEnd()}};function f(t,r){var n=a(t,r);if(e(t=n[0],r=n[1]))o.point(t,r)}function c(e,t){var r=a(e,t);s.point(r[0],r[1])}function h(){u.point=c;s.lineStart()}function v(){u.point=f;s.lineEnd()}var d;var p=vn(),g=r(p),m=false,y,b;function x(e,t){b.push([e,t]);var r=a(e,t);g.point(r[0],r[1])}function _(){g.lineStart();b=[]}function w(){x(b[0][0],b[0][1]);g.lineEnd();var e=g.clean(),t=p.buffer(),r,n=t.length;b.pop();y.push(b);b=null;if(!n)return;if(e&1){r=t[0];var n=r.length-1,i=-1,a;if(n>0){if(!m)o.polygonStart(),m=true;o.lineStart();while(++i<n)o.point((a=r[i])[0],a[1]);o.lineEnd()}return}if(n>1&&e&2)t.push(t.pop().concat(t.shift()));d.push(t.filter(hn))}return u}}function hn(e){return e.length>1}function vn(){var e=[],t;return{lineStart:function(){e.push(t=[])},point:function(e,r){t.push([e,r])},lineEnd:D,buffer:function(){var r=e;e=[];t=null;return r},rejoin:function(){if(e.length>1)e.push(e.pop().concat(e.shift()))}}}function dn(e,t){return((e=e.x)[0]<0?e[1]-Pe-Ee:Pe-e[1])-((t=t.x)[0]<0?t[1]-Pe-Ee:Pe-t[1])}var pn=cn(sn,gn,yn,[-Le,-Le/2]);function gn(e){var t=NaN,r=NaN,n=NaN,i;return{lineStart:function(){e.lineStart();i=1},point:function(a,o){var s=a>0?Le:-Le,l=b(a-t);if(b(l-Le)<Ee){e.point(t,r=(r+o)/2>0?Pe:-Pe);e.point(n,r);e.lineEnd();e.lineStart();e.point(s,r);e.point(a,r);i=0}else if(n!==s&&l>=Le){if(b(t-n)<Ee)t-=n*Ee;if(b(a-s)<Ee)a-=s*Ee;r=mn(t,r,a,o);e.point(n,r);e.lineEnd();e.lineStart();e.point(s,r);i=0}e.point(t=a,r=o);n=s},lineEnd:function(){e.lineEnd();t=r=NaN},clean:function(){return 2-i}}}function mn(e,t,r,n){var i,a,o=Math.sin(e-r);return b(o)>Ee?Math.atan((Math.sin(t)*(a=Math.cos(n))*Math.sin(r)-Math.sin(n)*(i=Math.cos(t))*Math.sin(e))/(i*a*o)):(t+n)/2}function yn(e,t,r,n){var i;if(e==null){i=r*Pe;n.point(-Le,i);n.point(0,i);n.point(Le,i);n.point(Le,0);n.point(Le,-i);n.point(0,-i);n.point(-Le,-i);n.point(-Le,0);n.point(-Le,i)}else if(b(e[0]-t[0])>Ee){var a=e[0]<t[0]?Le:-Le;i=r*a/2;n.point(-a,i);n.point(0,i);n.point(a,i)}else{n.point(t[0],t[1])}}function bn(e,t){var r=e[0],n=e[1],i=[Math.sin(r),-Math.cos(r),0],a=0,o=0;Ir.reset();for(var s=0,l=t.length;s<l;++s){var u=t[s],f=u.length;if(!f)continue;var c=u[0],h=c[0],v=c[1]/2+Le/4,d=Math.sin(v),p=Math.cos(v),g=1;while(true){if(g===f)g=0;e=u[g];var m=e[0],y=e[1]/2+Le/4,b=Math.sin(y),x=Math.cos(y),_=m-h,w=_>=0?1:-1,M=w*_,A=M>Le,T=d*b;Ir.add(Math.atan2(T*w*Math.sin(M),p*x+T*Math.cos(M)));a+=A?_+w*Ce:_;if(A^h>=r^m>=r){var k=zr(Rr(c),Rr(e));jr(k);var E=zr(i,k);jr(E);var S=(A^_>=0?-1:1)*Fe(E[2]);if(n>S||n===S&&(k[0]||k[1])){o+=A^_>=0?1:-1}}if(!g++)break;h=m,d=b,p=x,c=e}}return(a<-Ee||a<Ee&&Ir<-Ee)^o&1}function xn(e){var t=Math.cos(e),r=t>0,n=b(t)>Ee,i=ni(e,6*Oe);return cn(a,o,i,r?[0,-e]:[-Le,e-Le]);function a(e,r){return Math.cos(e)*Math.cos(r)>t}function o(e){var t,i,o,u,f;return{lineStart:function(){u=o=false;f=1},point:function(c,h){var v=[c,h],d,p=a(c,h),g=r?p?0:l(c,h):p?l(c+(c<0?Le:-Le),h):0;if(!t&&(u=o=p))e.lineStart();if(p!==o){d=s(t,v);if(Ur(t,d)||Ur(v,d)){v[0]+=Ee;v[1]+=Ee;p=a(v[0],v[1])}}if(p!==o){f=0;if(p){e.lineStart();d=s(v,t);e.point(d[0],d[1])}else{d=s(t,v);e.point(d[0],d[1]);e.lineEnd()}t=d}else if(n&&t&&r^p){var m;if(!(g&i)&&(m=s(v,t,true))){f=0;if(r){e.lineStart();e.point(m[0][0],m[0][1]);e.point(m[1][0],m[1][1]);e.lineEnd()}else{e.point(m[1][0],m[1][1]);e.lineEnd();e.lineStart();e.point(m[0][0],m[0][1])}}}if(p&&(!t||!Ur(t,v))){e.point(v[0],v[1])}t=v,o=p,i=g},lineEnd:function(){if(o)e.lineEnd();t=null},clean:function(){return f|(u&&o)<<1}}}function s(e,r,n){var i=Rr(e),a=Rr(r);var o=[1,0,0],s=zr(i,a),l=Nr(s,s),u=s[0],f=l-u*u;if(!f)return!n&&e;var c=t*l/f,h=-t*u/f,v=zr(o,s),d=Fr(o,c),p=Fr(s,h);Dr(d,p);var g=v,m=Nr(d,g),y=Nr(g,g),x=m*m-y*(Nr(d,d)-1);if(x<0)return;var _=Math.sqrt(x),w=Fr(g,(-m-_)/y);Dr(w,d);w=Br(w);if(!n)return w;var M=e[0],A=r[0],T=e[1],k=r[1],E;if(A<M)E=M,M=A,A=E;var S=A-M,L=b(S-Le)<Ee,C=L||S<Ee;if(!L&&k<T)E=T,T=k,k=E;if(C?L?T+k>0^w[1]<(b(w[0]-M)<Ee?T:k):T<=w[1]&&w[1]<=k:S>Le^(M<=w[0]&&w[0]<=A)){var I=Fr(g,(-m+_)/y);Dr(I,d);return[w,Br(I)]}}function l(t,n){var i=r?e:Le-e,a=0;if(t<-i)a|=1;else if(t>i)a|=2;if(n<-i)a|=4;else if(n>i)a|=8;return a}}function _n(e,t,r,n){return function(i){var a=i.a,o=i.b,s=a.x,l=a.y,u=o.x,f=o.y,c=0,h=1,v=u-s,d=f-l,p;p=e-s;if(!v&&p>0)return;p/=v;if(v<0){if(p<c)return;if(p<h)h=p}else if(v>0){if(p>h)return;if(p>c)c=p}p=r-s;if(!v&&p<0)return;p/=v;if(v<0){if(p>h)return;if(p>c)c=p}else if(v>0){if(p<c)return;if(p<h)h=p}p=t-l;if(!d&&p>0)return;p/=d;if(d<0){if(p<c)return;if(p<h)h=p}else if(d>0){if(p>h)return;if(p>c)c=p}p=n-l;if(!d&&p<0)return;p/=d;if(d<0){if(p>h)return;if(p>c)c=p}else if(d>0){if(p<c)return;if(p<h)h=p}if(c>0)i.a={x:s+c*v,y:l+c*d};if(h<1)i.b={x:s+h*v,y:l+h*d};return i}}var wn=1e9;t.geo.clipExtent=function(){var e,t,r,n,i,a,o={stream:function(e){if(i)i.valid=false;i=a(e);i.valid=true;return i},extent:function(s){if(!arguments.length)return[[e,t],[r,n]];a=Mn(e=+s[0][0],t=+s[0][1],r=+s[1][0],n=+s[1][1]);if(i)i.valid=false,i=null;return o}};return o.extent([[0,0],[960,500]])};function Mn(e,r,n,i){return function(l){var u=l,f=vn(),c=_n(e,r,n,i),h,v,d;var p={point:b,lineStart:S,lineEnd:L,polygonStart:function(){l=f;h=[];v=[];E=true},polygonEnd:function(){l=u;h=t.merge(h);var r=g([e,i]),n=E&&r,a=h.length;if(n||a){l.polygonStart();if(n){l.lineStart();m(null,null,1,l);l.lineEnd()}if(a){ln(h,o,r,m,l)}l.polygonEnd()}h=v=d=null}};function g(e){var t=0,r=v.length,n=e[1];for(var i=0;i<r;++i){for(var a=1,o=v[i],s=o.length,l=o[0],u;a<s;++a){u=o[a];if(l[1]<=n){if(u[1]>n&&ze(l,u,e)>0)++t}else{if(u[1]<=n&&ze(l,u,e)<0)--t}l=u}}return t!==0}function m(t,o,l,u){var f=0,c=0;if(t==null||(f=a(t,l))!==(c=a(o,l))||s(t,o)<0^l>0){do{u.point(f===0||f===3?e:n,f>1?i:r)}while((f=(f+l+4)%4)!==c)}else{u.point(o[0],o[1])}}function y(t,a){return e<=t&&t<=n&&r<=a&&a<=i}function b(e,t){if(y(e,t))l.point(e,t)}var x,_,w,M,A,T,k,E;function S(){p.point=C;if(v)v.push(d=[]);k=true;T=false;M=A=NaN}function L(){if(h){C(x,_);if(w&&T)f.rejoin();h.push(f.buffer())}p.point=b;if(T)l.lineEnd()}function C(e,t){e=Math.max(-wn,Math.min(wn,e));t=Math.max(-wn,Math.min(wn,t));var r=y(e,t);if(v)d.push([e,t]);if(k){x=e,_=t,w=r;k=false;if(r){l.lineStart();l.point(e,t)}}else{if(r&&T)l.point(e,t);else{var n={a:{x:M,y:A},b:{x:e,y:t}};if(c(n)){if(!T){l.lineStart();l.point(n.a.x,n.a.y)}l.point(n.b.x,n.b.y);if(!r)l.lineEnd();E=false}else if(r){l.lineStart();l.point(e,t);E=false}}}M=e,A=t,T=r}return p};function a(t,i){return b(t[0]-e)<Ee?i>0?0:3:b(t[0]-n)<Ee?i>0?2:1:b(t[1]-r)<Ee?i>0?1:0:i>0?3:2}function o(e,t){return s(e.x,t.x)}function s(e,t){var r=a(e,1),n=a(t,1);return r!==n?r-n:r===0?t[1]-e[1]:r===1?e[0]-t[0]:r===2?e[1]-t[1]:t[0]-e[0]}}function An(e){var t=0,r=Le/3,n=Zn(e),i=n(t,r);i.parallels=function(e){if(!arguments.length)return[t/Le*180,r/Le*180];return n(t=e[0]*Le/180,r=e[1]*Le/180)};return i}function Tn(e,t){var r=Math.sin(e),n=(r+Math.sin(t))/2,i=1+r*(2*n-r),a=Math.sqrt(i)/n;function o(e,t){var r=Math.sqrt(i-2*n*Math.sin(t))/n;return[r*Math.sin(e*=n),a-r*Math.cos(e)]}o.invert=function(e,t){var r=a-t;return[Math.atan2(e,r)/n,Fe((i-(e*e+r*r)*n*n)/(2*n))]};return o}(t.geo.conicEqualArea=function(){return An(Tn)}).raw=Tn;t.geo.albers=function(){return t.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};t.geo.albersUsa=function(){var e=t.geo.albers();var r=t.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]);var n=t.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]);var i,a={point:function(e,t){i=[e,t]}},o,s,l;function u(e){var t=e[0],r=e[1];i=null;(o(t,r),i)||(s(t,r),i)||l(t,r);return i}u.invert=function(t){var i=e.scale(),a=e.translate(),o=(t[0]-a[0])/i,s=(t[1]-a[1])/i;return(s>=.12&&s<.234&&o>=-.425&&o<-.214?r:s>=.166&&s<.234&&o>=-.214&&o<-.115?n:e).invert(t)};u.stream=function(t){var i=e.stream(t),a=r.stream(t),o=n.stream(t);return{point:function(e,t){i.point(e,t);a.point(e,t);o.point(e,t)},sphere:function(){i.sphere();a.sphere();o.sphere()},lineStart:function(){i.lineStart();a.lineStart();o.lineStart()},lineEnd:function(){i.lineEnd();a.lineEnd();o.lineEnd()},polygonStart:function(){i.polygonStart();a.polygonStart();o.polygonStart()},polygonEnd:function(){i.polygonEnd();a.polygonEnd();o.polygonEnd()}}};u.precision=function(t){if(!arguments.length)return e.precision();e.precision(t);r.precision(t);n.precision(t);return u};u.scale=function(t){if(!arguments.length)return e.scale();e.scale(t);r.scale(t*.35);n.scale(t);return u.translate(e.translate())};u.translate=function(t){if(!arguments.length)return e.translate();var i=e.scale(),f=+t[0],c=+t[1];o=e.translate(t).clipExtent([[f-.455*i,c-.238*i],[f+.455*i,c+.238*i]]).stream(a).point;s=r.translate([f-.307*i,c+.201*i]).clipExtent([[f-.425*i+Ee,c+.12*i+Ee],[f-.214*i-Ee,c+.234*i-Ee]]).stream(a).point;l=n.translate([f-.205*i,c+.212*i]).clipExtent([[f-.214*i+Ee,c+.166*i+Ee],[f-.115*i-Ee,c+.234*i-Ee]]).stream(a).point;return u};return u.scale(1070)};var kn,En,Sn={point:D,lineStart:D,lineEnd:D,polygonStart:function(){En=0;Sn.lineStart=Ln},polygonEnd:function(){Sn.lineStart=Sn.lineEnd=Sn.point=D;kn+=b(En/2)}};function Ln(){var e,t,r,n;Sn.point=function(a,o){Sn.point=i;e=r=a,t=n=o};function i(e,t){En+=n*e-r*t;r=e,n=t}Sn.lineEnd=function(){i(e,t)}}var Cn,In,Pn,On;var Rn={point:Nn,lineStart:D,lineEnd:D,polygonStart:D,polygonEnd:D};function Nn(e,t){if(e<Cn)Cn=e;if(e>Pn)Pn=e;if(t<In)In=t;if(t>On)On=t}function zn(){var e=Dn(4.5),t=[];var r={point:n,lineStart:function(){r.point=i},lineEnd:o,polygonStart:function(){r.lineEnd=s},polygonEnd:function(){r.lineEnd=o;r.point=n},pointRadius:function(t){e=Dn(t);return r},result:function(){if(t.length){var e=t.join("");t=[];return e}}};function n(r,n){t.push("M",r,",",n,e)}function i(e,n){t.push("M",e,",",n);r.point=a}function a(e,r){t.push("L",e,",",r)}function o(){r.point=n}function s(){t.push("Z")}return r}function Dn(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}var Fn={point:jn,lineStart:Bn,lineEnd:Un,polygonStart:function(){Fn.lineStart=Vn},polygonEnd:function(){Fn.point=jn;Fn.lineStart=Bn;Fn.lineEnd=Un}};function jn(e,t){qr+=e;Gr+=t;++Wr}function Bn(){var e,t;Fn.point=function(n,i){Fn.point=r;jn(e=n,t=i)};function r(r,n){var i=r-e,a=n-t,o=Math.sqrt(i*i+a*a);Xr+=o*(e+r)/2;Yr+=o*(t+n)/2;Zr+=o;jn(e=r,t=n)}}function Un(){Fn.point=jn}function Vn(){var e,t,r,n;Fn.point=function(a,o){Fn.point=i;jn(e=r=a,t=n=o)};function i(e,t){var i=e-r,a=t-n,o=Math.sqrt(i*i+a*a);Xr+=o*(r+e)/2;Yr+=o*(n+t)/2;Zr+=o;o=n*e-r*t;Qr+=o*(r+e);Kr+=o*(n+t);Jr+=o*3;jn(r=e,n=t)}Fn.lineEnd=function(){i(e,t)}}function Hn(e){var t=4.5;var r={point:n,lineStart:function(){r.point=i},lineEnd:o,polygonStart:function(){r.lineEnd=s},polygonEnd:function(){r.lineEnd=o;r.point=n},pointRadius:function(e){t=e;return r},result:D};function n(r,n){e.moveTo(r+t,n);e.arc(r,n,t,0,Ce)}function i(t,n){e.moveTo(t,n);r.point=a}function a(t,r){e.lineTo(t,r)}function o(){r.point=n}function s(){e.closePath()}return r}function qn(e){var t=.5,r=Math.cos(30*Oe),n=16;function i(e){return(n?o:a)(e)}function a(t){return Xn(t,function(r,n){r=e(r,n);t.point(r[0],r[1])})}function o(t){var r,i,a,o,l,u,f,c,h,v,d,p,g;var m={point:y,lineStart:b,lineEnd:_,polygonStart:function(){t.polygonStart();m.lineStart=w},polygonEnd:function(){t.polygonEnd();m.lineStart=b}};function y(r,n){r=e(r,n);t.point(r[0],r[1])}function b(){h=NaN;m.point=x;t.lineStart()}function x(r,i){var a=Rr([r,i]),o=e(r,i);s(h,v,c,d,p,g,h=o[0],v=o[1],c=r,d=a[0],p=a[1],g=a[2],n,t);t.point(h,v)}function _(){m.point=y;t.lineEnd()}function w(){b();m.point=M;m.lineEnd=A}function M(e,t){x(r=e,i=t),a=h,o=v,l=d,u=p,f=g;m.point=x}function A(){s(h,v,c,d,p,g,a,o,r,l,u,f,n,t);m.lineEnd=_;_()}return m}function s(n,i,a,o,l,u,f,c,h,v,d,p,g,m){var y=f-n,x=c-i,_=y*y+x*x;if(_>4*t&&g--){var w=o+v,M=l+d,A=u+p,T=Math.sqrt(w*w+M*M+A*A),k=Math.asin(A/=T),E=b(b(A)-1)<Ee||b(a-h)<Ee?(a+h)/2:Math.atan2(M,w),S=e(E,k),L=S[0],C=S[1],I=L-n,P=C-i,O=x*I-y*P;if(O*O/_>t||b((y*I+x*P)/_-.5)>.3||o*v+l*d+u*p<r){s(n,i,a,o,l,u,L,C,E,w/=T,M/=T,A,g,m);m.point(L,C);s(L,C,E,w,M,A,f,c,h,v,d,p,g,m)}}}i.precision=function(e){if(!arguments.length)return Math.sqrt(t);n=(t=e*e)>0&&16;return i};return i}t.geo.path=function(){var e=4.5,r,n,i,a,o;function s(r){if(r){if(typeof e==="function")a.pointRadius(+e.apply(this,arguments));if(!o||!o.valid)o=i(a);t.geo.stream(r,o)}return a.result()}s.area=function(e){kn=0;t.geo.stream(e,i(Sn));return kn};s.centroid=function(e){qr=Gr=Wr=Xr=Yr=Zr=Qr=Kr=Jr=0;t.geo.stream(e,i(Fn));return Jr?[Qr/Jr,Kr/Jr]:Zr?[Xr/Zr,Yr/Zr]:Wr?[qr/Wr,Gr/Wr]:[NaN,NaN]};s.bounds=function(e){Pn=On=-(Cn=In=Infinity);t.geo.stream(e,i(Rn));return[[Cn,In],[Pn,On]]};s.projection=function(e){if(!arguments.length)return r;i=(r=e)?e.stream||Gn(e):O;return l()};s.context=function(t){if(!arguments.length)return n;a=(n=t)==null?new zn:new Hn(t);if(typeof e!=="function")a.pointRadius(e);return l()};s.pointRadius=function(t){if(!arguments.length)return e;e=typeof t==="function"?t:(a.pointRadius(+t),+t);return s};function l(){o=null;return s}return s.projection(t.geo.albersUsa()).context(null)};function Gn(e){var t=qn(function(t,r){return e([t*Re,r*Re])});return function(e){return Qn(t(e))}}t.geo.transform=function(e){return{stream:function(t){var r=new Wn(t);for(var n in e)r[n]=e[n];return r}}};function Wn(e){this.stream=e}Wn.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Xn(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}t.geo.projection=Yn;t.geo.projectionMutator=Zn;function Yn(e){return Zn(function(){return e})()}function Zn(e){var r,n,i,a=qn(function(e,t){e=r(e,t);return[e[0]*o+d,p-e[1]*o]}),o=150,s=480,l=250,u=0,f=0,c=0,h=0,v=0,d,p,g=pn,m=O,y=null,b=null,x;function _(e){e=i(e[0]*Oe,e[1]*Oe);return[e[0]*o+d,p-e[1]*o]}function w(e){e=i.invert((e[0]-d)/o,(p-e[1])/o);return e&&[e[0]*Re,e[1]*Re]}_.stream=function(e){if(x)x.valid=false;x=Qn(g(n,a(m(e))));x.valid=true;return x};_.clipAngle=function(e){if(!arguments.length)return y;g=e==null?(y=e,pn):xn((y=+e)*Oe);return A()};_.clipExtent=function(e){if(!arguments.length)return b;b=e;m=e?Mn(e[0][0],e[0][1],e[1][0],e[1][1]):O;return A()};_.scale=function(e){if(!arguments.length)return o;o=+e;return M()};_.translate=function(e){if(!arguments.length)return[s,l];s=+e[0];l=+e[1];return M()};_.center=function(e){if(!arguments.length)return[u*Re,f*Re];u=e[0]%360*Oe;f=e[1]%360*Oe;return M()};_.rotate=function(e){if(!arguments.length)return[c*Re,h*Re,v*Re];c=e[0]%360*Oe;h=e[1]%360*Oe;v=e.length>2?e[2]%360*Oe:0;return M()};t.rebind(_,a,"precision");function M(){i=on(n=$n(c,h,v),r);var e=r(u,f);d=s-e[0]*o;p=l+e[1]*o;return A()}function A(){if(x)x.valid=false,x=null;return _}return function(){r=e.apply(this,arguments);_.invert=r.invert&&w;return M()}}function Qn(e){return Xn(e,function(t,r){e.point(t*Oe,r*Oe)})}function Kn(e,t){return[e,t]}(t.geo.equirectangular=function(){return Yn(Kn)}).raw=Kn.invert=Kn;t.geo.rotation=function(e){e=$n(e[0]%360*Oe,e[1]*Oe,e.length>2?e[2]*Oe:0);function t(t){t=e(t[0]*Oe,t[1]*Oe);return t[0]*=Re,t[1]*=Re,t}t.invert=function(t){t=e.invert(t[0]*Oe,t[1]*Oe);return t[0]*=Re,t[1]*=Re,t};return t};function Jn(e,t){return[e>Le?e-Ce:e<-Le?e+Ce:e,t]}Jn.invert=Kn;function $n(e,t,r){return e?t||r?on(ti(e),ri(t,r)):ti(e):t||r?ri(t,r):Jn}function ei(e){return function(t,r){return t+=e,[t>Le?t-Ce:t<-Le?t+Ce:t,r]}}function ti(e){var t=ei(e);t.invert=ei(-e);return t}function ri(e,t){var r=Math.cos(e),n=Math.sin(e),i=Math.cos(t),a=Math.sin(t);function o(e,t){var o=Math.cos(t),s=Math.cos(e)*o,l=Math.sin(e)*o,u=Math.sin(t),f=u*r+s*n;return[Math.atan2(l*i-f*a,s*r-u*n),Fe(f*i+l*a)]}o.invert=function(e,t){var o=Math.cos(t),s=Math.cos(e)*o,l=Math.sin(e)*o,u=Math.sin(t),f=u*i-l*a;return[Math.atan2(l*i+u*a,s*r+f*n),Fe(f*r-s*n)]};return o}t.geo.circle=function(){var e=[0,0],t,r=6,n;function i(){var t=typeof e==="function"?e.apply(this,arguments):e,r=$n(-t[0]*Oe,-t[1]*Oe,0).invert,i=[];n(null,null,1,{point:function(e,t){i.push(e=r(e,t));e[0]*=Re,e[1]*=Re}});return{type:"Polygon",coordinates:[i]}}i.origin=function(t){if(!arguments.length)return e;e=t;return i};i.angle=function(e){if(!arguments.length)return t;n=ni((t=+e)*Oe,r*Oe);return i};i.precision=function(e){if(!arguments.length)return r;n=ni(t*Oe,(r=+e)*Oe);return i};return i.angle(90)};function ni(e,t){var r=Math.cos(e),n=Math.sin(e);return function(i,a,o,s){var l=o*t;if(i!=null){i=ii(r,i);a=ii(r,a);if(o>0?i<a:i>a)i+=o*Ce}else{i=e+o*Ce;a=e-.5*l}for(var u,f=i;o>0?f>a:f<a;f-=l){s.point((u=Br([r,-n*Math.cos(f),-n*Math.sin(f)]))[0],u[1])}}}function ii(e,t){var r=Rr(t);r[0]-=e;jr(r);var n=De(-r[1]);return((-r[2]<0?-n:n)+2*Math.PI-Ee)%(2*Math.PI)}t.geo.distance=function(e,t){var r=(t[0]-e[0])*Oe,n=e[1]*Oe,i=t[1]*Oe,a=Math.sin(r),o=Math.cos(r),s=Math.sin(n),l=Math.cos(n),u=Math.sin(i),f=Math.cos(i),c;return Math.atan2(Math.sqrt((c=f*a)*c+(c=l*u-s*f*o)*c),s*u+l*f*o)};t.geo.graticule=function(){var e,r,n,i,a,o,s,l,u=10,f=u,c=90,h=360,v,d,p,g,m=2.5;function y(){return{type:"MultiLineString",coordinates:x()}}function x(){return t.range(Math.ceil(i/c)*c,n,c).map(p).concat(t.range(Math.ceil(l/h)*h,s,h).map(g)).concat(t.range(Math.ceil(r/u)*u,e,u).filter(function(e){return b(e%c)>Ee}).map(v)).concat(t.range(Math.ceil(o/f)*f,a,f).filter(function(e){return b(e%h)>Ee}).map(d))}y.lines=function(){return x().map(function(e){return{type:"LineString",coordinates:e}})};y.outline=function(){return{type:"Polygon",coordinates:[p(i).concat(g(s).slice(1),p(n).reverse().slice(1),g(l).reverse().slice(1))]}};y.extent=function(e){if(!arguments.length)return y.minorExtent();return y.majorExtent(e).minorExtent(e)};y.majorExtent=function(e){if(!arguments.length)return[[i,l],[n,s]];i=+e[0][0],n=+e[1][0];l=+e[0][1],s=+e[1][1];if(i>n)e=i,i=n,n=e;if(l>s)e=l,l=s,s=e;return y.precision(m)};y.minorExtent=function(t){if(!arguments.length)return[[r,o],[e,a]];r=+t[0][0],e=+t[1][0];o=+t[0][1],a=+t[1][1];if(r>e)t=r,r=e,e=t;if(o>a)t=o,o=a,a=t;return y.precision(m)};y.step=function(e){if(!arguments.length)return y.minorStep();return y.majorStep(e).minorStep(e)};y.majorStep=function(e){if(!arguments.length)return[c,h];c=+e[0],h=+e[1];return y};y.minorStep=function(e){if(!arguments.length)return[u,f];u=+e[0],f=+e[1];return y};y.precision=function(t){if(!arguments.length)return m;m=+t;v=ai(o,a,90);d=oi(r,e,m);p=ai(l,s,90);g=oi(i,n,m);return y};return y.majorExtent([[-180,-90+Ee],[180,90-Ee]]).minorExtent([[-180,-80-Ee],[180,80+Ee]])};function ai(e,r,n){var i=t.range(e,r-Ee,n).concat(r);return function(e){return i.map(function(t){return[e,t]})}}function oi(e,r,n){var i=t.range(e,r-Ee,n).concat(r);return function(e){return i.map(function(t){return[t,e]})}}function si(e){return e.source}function li(e){return e.target}t.geo.greatArc=function(){var e=si,r,n=li,i;function a(){return{type:"LineString",coordinates:[r||e.apply(this,arguments),i||n.apply(this,arguments)]}}a.distance=function(){return t.geo.distance(r||e.apply(this,arguments),i||n.apply(this,arguments))};a.source=function(t){if(!arguments.length)return e;e=t,r=typeof t==="function"?null:t;return a};a.target=function(e){if(!arguments.length)return n;n=e,i=typeof e==="function"?null:e;return a};a.precision=function(){return arguments.length?a:0};return a};t.geo.interpolate=function(e,t){return ui(e[0]*Oe,e[1]*Oe,t[0]*Oe,t[1]*Oe)};function ui(e,t,r,n){var i=Math.cos(t),a=Math.sin(t),o=Math.cos(n),s=Math.sin(n),l=i*Math.cos(e),u=i*Math.sin(e),f=o*Math.cos(r),c=o*Math.sin(r),h=2*Math.asin(Math.sqrt(Ve(n-t)+i*o*Ve(r-e))),v=1/Math.sin(h);var d=h?function(e){var t=Math.sin(e*=h)*v,r=Math.sin(h-e)*v,n=r*l+t*f,i=r*u+t*c,o=r*a+t*s;return[Math.atan2(i,n)*Re,Math.atan2(o,Math.sqrt(n*n+i*i))*Re]}:function(){return[e*Re,t*Re]};d.distance=h;return d}t.geo.length=function(e){fi=0;t.geo.stream(e,ci);return fi};var fi;var ci={sphere:D,point:D,lineStart:hi,lineEnd:D,polygonStart:D,polygonEnd:D};function hi(){var e,t,r;ci.point=function(i,a){e=i*Oe,t=Math.sin(a*=Oe),r=Math.cos(a);ci.point=n};ci.lineEnd=function(){ci.point=ci.lineEnd=D};function n(n,i){var a=Math.sin(i*=Oe),o=Math.cos(i),s=b((n*=Oe)-e),l=Math.cos(s);fi+=Math.atan2(Math.sqrt((s=o*Math.sin(s))*s+(s=r*a-t*o*l)*s),t*a+r*o*l);e=n,t=a,r=o}}function vi(e,t){function r(t,r){var n=Math.cos(t),i=Math.cos(r),a=e(n*i);return[a*i*Math.sin(t),a*Math.sin(r)]}r.invert=function(e,r){var n=Math.sqrt(e*e+r*r),i=t(n),a=Math.sin(i),o=Math.cos(i);return[Math.atan2(e*a,n*o),Math.asin(n&&r*a/n)]};return r}var di=vi(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(t.geo.azimuthalEqualArea=function(){return Yn(di)}).raw=di;var pi=vi(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},O);(t.geo.azimuthalEquidistant=function(){return Yn(pi)}).raw=pi;function gi(e,t){var r=Math.cos(e),n=function(e){return Math.tan(Le/4+e/2)},i=e===t?Math.sin(e):Math.log(r/Math.cos(t))/Math.log(n(t)/n(e)),a=r*Math.pow(n(e),i)/i;if(!i)return bi;function o(e,t){if(a>0){if(t<-Pe+Ee)t=-Pe+Ee}else{if(t>Pe-Ee)t=Pe-Ee}var r=a/Math.pow(n(t),i);return[r*Math.sin(i*e),a-r*Math.cos(i*e)]}o.invert=function(e,t){var r=a-t,n=Ne(i)*Math.sqrt(e*e+r*r);return[Math.atan2(e,r)/i,2*Math.atan(Math.pow(a/n,1/i))-Pe]};return o}(t.geo.conicConformal=function(){return An(gi)}).raw=gi;function mi(e,t){var r=Math.cos(e),n=e===t?Math.sin(e):(r-Math.cos(t))/(t-e),i=r/n+e;if(b(n)<Ee)return Kn;function a(e,t){var r=i-t;return[r*Math.sin(n*e),i-r*Math.cos(n*e)]}a.invert=function(e,t){var r=i-t;return[Math.atan2(e,r)/n,i-Ne(n)*Math.sqrt(e*e+r*r)]};return a}(t.geo.conicEquidistant=function(){return An(mi)}).raw=mi;var yi=vi(function(e){return 1/e},Math.atan);(t.geo.gnomonic=function(){return Yn(yi)}).raw=yi;function bi(e,t){return[e,Math.log(Math.tan(Le/4+t/2))]}bi.invert=function(e,t){return[e,2*Math.atan(Math.exp(t))-Pe]};function xi(e){var t=Yn(e),r=t.scale,n=t.translate,i=t.clipExtent,a;t.scale=function(){var e=r.apply(t,arguments);return e===t?a?t.clipExtent(null):t:e};t.translate=function(){var e=n.apply(t,arguments);return e===t?a?t.clipExtent(null):t:e};t.clipExtent=function(e){var o=i.apply(t,arguments);if(o===t){if(a=e==null){var s=Le*r(),l=n();i([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else if(a){o=null}return o};return t.clipExtent(null)}(t.geo.mercator=function(){return xi(bi)}).raw=bi;var _i=vi(function(){return 1},Math.asin);(t.geo.orthographic=function(){return Yn(_i)}).raw=_i;var wi=vi(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(t.geo.stereographic=function(){return Yn(wi)}).raw=wi;function Mi(e,t){return[Math.log(Math.tan(Le/4+t/2)),-e]}Mi.invert=function(e,t){return[-t,2*Math.atan(Math.exp(e))-Pe]};(t.geo.transverseMercator=function(){var e=xi(Mi),t=e.center,r=e.rotate;e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])};e.rotate=function(e){return e?r([e[0],e[1],e.length>2?e[2]+90:90]):(e=r(),[e[0],e[1],e[2]-90])};return r([0,0,90])}).raw=Mi;t.geom={};function Ai(e){return e[0]}function Ti(e){return e[1]}t.geom.hull=function(e){var t=Ai,r=Ti;if(arguments.length)return n(e);function n(e){if(e.length<3)return[];var n=At(t),i=At(r),a,o=e.length,s=[],l=[];for(a=0;a<o;a++){s.push([+n.call(this,e[a],a),+i.call(this,e[a],a),a])}s.sort(Ei);for(a=0;a<o;a++)l.push([s[a][0],-s[a][1]]);var u=ki(s),f=ki(l);var c=f[0]===u[0],h=f[f.length-1]===u[u.length-1],v=[];for(a=u.length-1;a>=0;--a)v.push(e[s[u[a]][2]]);for(a=+c;a<f.length-h;++a)v.push(e[s[f[a]][2]]);return v}n.x=function(e){return arguments.length?(t=e,n):t};n.y=function(e){return arguments.length?(r=e,n):r};return n};function ki(e){var t=e.length,r=[0,1],n=2;for(var i=2;i<t;i++){while(n>1&&ze(e[r[n-2]],e[r[n-1]],e[i])<=0)--n;r[n++]=i}return r.slice(0,n)}function Ei(e,t){return e[0]-t[0]||e[1]-t[1]}t.geom.polygon=function(e){q(e,Si);return e};var Si=t.geom.polygon.prototype=[];Si.area=function(){var e=-1,t=this.length,r,n=this[t-1],i=0;while(++e<t){r=n;n=this[e];i+=r[1]*n[0]-r[0]*n[1]}return i*.5};Si.centroid=function(e){var t=-1,r=this.length,n=0,i=0,a,o=this[r-1],s;if(!arguments.length)e=-1/(6*this.area());while(++t<r){a=o;o=this[t];s=a[0]*o[1]-o[0]*a[1];n+=(a[0]+o[0])*s;i+=(a[1]+o[1])*s}return[n*e,i*e]};Si.clip=function(e){var t,r=Ii(e),n=-1,i=this.length-Ii(this),a,o,s=this[i-1],l,u,f;while(++n<i){t=e.slice();e.length=0;l=this[n];u=t[(o=t.length-r)-1];a=-1;while(++a<o){f=t[a];if(Li(f,s,l)){if(!Li(u,s,l)){e.push(Ci(u,f,s,l))}e.push(f)}else if(Li(u,s,l)){e.push(Ci(u,f,s,l))}u=f}if(r)e.push(e[0]);s=l}return e};function Li(e,t,r){return(r[0]-t[0])*(e[1]-t[1])<(r[1]-t[1])*(e[0]-t[0])}function Ci(e,t,r,n){var i=e[0],a=r[0],o=t[0]-i,s=n[0]-a,l=e[1],u=r[1],f=t[1]-l,c=n[1]-u,h=(s*(l-u)-c*(i-a))/(c*o-s*f);return[i+h*o,l+h*f]}function Ii(e){var t=e[0],r=e[e.length-1];return!(t[0]-r[0]||t[1]-r[1])}var Pi,Oi,Ri,Ni=[],zi,Di,Fi=[];function ji(){oa(this);this.edge=this.site=this.circle=null}function Bi(e){var t=Ni.pop()||new ji;t.site=e;return t}function Ui(e){Ki(e);Ri.remove(e);Ni.push(e);oa(e)}function Vi(e){var t=e.circle,r=t.x,n=t.cy,i={x:r,y:n},a=e.P,o=e.N,s=[e];Ui(e);var l=a;while(l.circle&&b(r-l.circle.x)<Ee&&b(n-l.circle.cy)<Ee){a=l.P;s.unshift(l);Ui(l);l=a}s.unshift(l);Ki(l);var u=o;while(u.circle&&b(r-u.circle.x)<Ee&&b(n-u.circle.cy)<Ee){o=u.N;s.push(u);Ui(u);u=o}s.push(u);Ki(u);var f=s.length,c;for(c=1;c<f;++c){u=s[c];l=s[c-1];na(u.edge,l.site,u.site,i)}l=s[0];u=s[f-1];u.edge=ta(l.site,u.site,null,i);Qi(l);Qi(u)}function Hi(e){var t=e.x,r=e.y,n,i,a,o,s=Ri._;while(s){a=qi(s,r)-t;if(a>Ee)s=s.L;else{o=t-Gi(s,r);if(o>Ee){if(!s.R){n=s;break}s=s.R}else{if(a>-Ee){n=s.P;i=s}else if(o>-Ee){n=s;i=s.N}else{n=i=s}break}}}var l=Bi(e);Ri.insert(n,l);if(!n&&!i)return;if(n===i){Ki(n);i=Bi(n.site);Ri.insert(l,i);l.edge=i.edge=ta(n.site,l.site);Qi(n);Qi(i);return}if(!i){l.edge=ta(n.site,l.site);return}Ki(n);Ki(i);var u=n.site,f=u.x,c=u.y,h=e.x-f,v=e.y-c,d=i.site,p=d.x-f,g=d.y-c,m=2*(h*g-v*p),y=h*h+v*v,b=p*p+g*g,x={x:(g*y-v*b)/m+f,y:(h*b-p*y)/m+c};na(i.edge,u,d,x);l.edge=ta(u,e,null,x);i.edge=ta(e,d,null,x);Qi(n);Qi(i)}function qi(e,t){var r=e.site,n=r.x,i=r.y,a=i-t;if(!a)return n;var o=e.P;if(!o)return-Infinity;r=o.site;var s=r.x,l=r.y,u=l-t;if(!u)return s;var f=s-n,c=1/a-1/u,h=f/u;if(c)return(-h+Math.sqrt(h*h-2*c*(f*f/(-2*u)-l+u/2+i-a/2)))/c+n;return(n+s)/2}function Gi(e,t){var r=e.N;if(r)return qi(r,t);var n=e.site;return n.y===t?n.x:Infinity}function Wi(e){this.site=e;this.edges=[]}Wi.prototype.prepare=function(){var e=this.edges,t=e.length,r;while(t--){r=e[t].edge;if(!r.b||!r.a)e.splice(t,1)}e.sort(Yi);return e.length};function Xi(e){var t=e[0][0],r=e[1][0],n=e[0][1],i=e[1][1],a,o,s,l,u=Oi,f=u.length,c,h,v,d,p,g;while(f--){c=u[f];if(!c||!c.prepare())continue;v=c.edges;d=v.length;h=0;while(h<d){g=v[h].end(),s=g.x,l=g.y;p=v[++h%d].start(),a=p.x,o=p.y;if(b(s-a)>Ee||b(l-o)>Ee){v.splice(h,0,new ia(ra(c.site,g,b(s-t)<Ee&&i-l>Ee?{x:t,y:b(a-t)<Ee?o:i}:b(l-i)<Ee&&r-s>Ee?{x:b(o-i)<Ee?a:r,y:i}:b(s-r)<Ee&&l-n>Ee?{x:r,y:b(a-r)<Ee?o:n}:b(l-n)<Ee&&s-t>Ee?{x:b(o-n)<Ee?a:t,y:n}:null),c.site,null));++d}}}}function Yi(e,t){return t.angle-e.angle}function Zi(){oa(this);this.x=this.y=this.arc=this.site=this.cy=null}function Qi(e){var t=e.P,r=e.N;if(!t||!r)return;var n=t.site,i=e.site,a=r.site;if(n===a)return;var o=i.x,s=i.y,l=n.x-o,u=n.y-s,f=a.x-o,c=a.y-s;var h=2*(l*c-u*f);if(h>=-Se)return;var v=l*l+u*u,d=f*f+c*c,p=(c*v-u*d)/h,g=(l*d-f*v)/h,c=g+s;var m=Fi.pop()||new Zi;m.arc=e;m.site=i;m.x=p+o;m.y=c+Math.sqrt(p*p+g*g);m.cy=c;e.circle=m;var y=null,b=Di._;while(b){if(m.y<b.y||m.y===b.y&&m.x<=b.x){if(b.L)b=b.L;else{y=b.P;break}}else{if(b.R)b=b.R;else{y=b;break}}}Di.insert(y,m);if(!y)zi=m}function Ki(e){var t=e.circle;if(t){if(!t.P)zi=t.N;Di.remove(t);Fi.push(t);oa(t);e.circle=null}}function Ji(e){var t=Pi,r=_n(e[0][0],e[0][1],e[1][0],e[1][1]),n=t.length,i;while(n--){i=t[n];if(!$i(i,e)||!r(i)||b(i.a.x-i.b.x)<Ee&&b(i.a.y-i.b.y)<Ee){i.a=i.b=null;t.splice(n,1)}}}function $i(e,t){var r=e.b;if(r)return true;var n=e.a,i=t[0][0],a=t[1][0],o=t[0][1],s=t[1][1],l=e.l,u=e.r,f=l.x,c=l.y,h=u.x,v=u.y,d=(f+h)/2,p=(c+v)/2,g,m;if(v===c){if(d<i||d>=a)return;if(f>h){if(!n)n={x:d,y:o};else if(n.y>=s)return;r={x:d,y:s}}else{if(!n)n={x:d,y:s};else if(n.y<o)return;r={x:d,y:o}}}else{g=(f-h)/(v-c);m=p-g*d;if(g<-1||g>1){if(f>h){if(!n)n={x:(o-m)/g,y:o};else if(n.y>=s)return;r={x:(s-m)/g,y:s}}else{if(!n)n={x:(s-m)/g,y:s};else if(n.y<o)return;r={x:(o-m)/g,y:o}}}else{if(c<v){if(!n)n={x:i,y:g*i+m};else if(n.x>=a)return;r={x:a,y:g*a+m}}else{if(!n)n={x:a,y:g*a+m};else if(n.x<i)return;r={x:i,y:g*i+m}}}}e.a=n;e.b=r;return true}function ea(e,t){this.l=e;this.r=t;this.a=this.b=null}function ta(e,t,r,n){var i=new ea(e,t);Pi.push(i);if(r)na(i,e,t,r);if(n)na(i,t,e,n);Oi[e.i].edges.push(new ia(i,e,t));Oi[t.i].edges.push(new ia(i,t,e));return i}function ra(e,t,r){var n=new ea(e,null);n.a=t;n.b=r;Pi.push(n);return n}function na(e,t,r,n){if(!e.a&&!e.b){e.a=n;e.l=t;e.r=r}else if(e.l===r){e.b=n}else{e.a=n}}function ia(e,t,r){var n=e.a,i=e.b;this.edge=e;this.site=t;this.angle=r?Math.atan2(r.y-t.y,r.x-t.x):e.l===t?Math.atan2(i.x-n.x,n.y-i.y):Math.atan2(n.x-i.x,i.y-n.y)}ia.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function aa(){this._=null}function oa(e){e.U=e.C=e.L=e.R=e.P=e.N=null}aa.prototype={insert:function(e,t){var r,n,i;if(e){t.P=e;t.N=e.N;if(e.N)e.N.P=t;e.N=t;if(e.R){e=e.R;while(e.L)e=e.L;e.L=t}else{e.R=t}r=e}else if(this._){e=ua(this._);t.P=null;t.N=e;e.P=e.L=t;r=e}else{t.P=t.N=null;this._=t;r=null}t.L=t.R=null;t.U=r;t.C=true;e=t;while(r&&r.C){n=r.U;if(r===n.L){i=n.R;if(i&&i.C){r.C=i.C=false;n.C=true;e=n}else{if(e===r.R){sa(this,r);e=r;r=e.U}r.C=false;n.C=true;la(this,n)}}else{i=n.L;if(i&&i.C){r.C=i.C=false;n.C=true;e=n}else{if(e===r.L){la(this,r);e=r;r=e.U}r.C=false;n.C=true;sa(this,n)}}r=e.U}this._.C=false},remove:function(e){if(e.N)e.N.P=e.P;if(e.P)e.P.N=e.N;e.N=e.P=null;var t=e.U,r,n=e.L,i=e.R,a,o;if(!n)a=i;else if(!i)a=n;else a=ua(i);if(t){if(t.L===e)t.L=a;else t.R=a}else{this._=a}if(n&&i){o=a.C;a.C=e.C;a.L=n;n.U=a;if(a!==i){t=a.U;a.U=e.U;e=a.R;t.L=e;a.R=i;i.U=a}else{a.U=t;t=a;e=a.R}}else{o=e.C;e=a}if(e)e.U=t;if(o)return;if(e&&e.C){e.C=false;return}do{if(e===this._)break;if(e===t.L){r=t.R;if(r.C){r.C=false;t.C=true;sa(this,t);r=t.R}if(r.L&&r.L.C||r.R&&r.R.C){if(!r.R||!r.R.C){r.L.C=false;r.C=true;la(this,r);r=t.R}r.C=t.C;t.C=r.R.C=false;sa(this,t);e=this._;break}}else{r=t.L;if(r.C){r.C=false;t.C=true;la(this,t);r=t.L}if(r.L&&r.L.C||r.R&&r.R.C){if(!r.L||!r.L.C){r.R.C=false;r.C=true;sa(this,r);r=t.L}r.C=t.C;t.C=r.L.C=false;la(this,t);e=this._;break}}r.C=true;e=t;t=t.U}while(!e.C);if(e)e.C=false}};function sa(e,t){var r=t,n=t.R,i=r.U;if(i){if(i.L===r)i.L=n;else i.R=n}else{e._=n}n.U=i;r.U=n;r.R=n.L;if(r.R)r.R.U=r;n.L=r}function la(e,t){var r=t,n=t.L,i=r.U;if(i){if(i.L===r)i.L=n;else i.R=n}else{e._=n}n.U=i;r.U=n;r.L=n.R;if(r.L)r.L.U=r;n.R=r}function ua(e){while(e.L)e=e.L;return e}function fa(e,t){var r=e.sort(ca).pop(),n,i,a;Pi=[];Oi=new Array(e.length);Ri=new aa;Di=new aa;while(true){a=zi;if(r&&(!a||r.y<a.y||r.y===a.y&&r.x<a.x)){if(r.x!==n||r.y!==i){Oi[r.i]=new Wi(r);Hi(r);n=r.x,i=r.y}r=e.pop()}else if(a){Vi(a.arc)}else{break}}if(t)Ji(t),Xi(t);var o={cells:Oi,edges:Pi};Ri=Di=Pi=Oi=null;return o}function ca(e,t){return t.y-e.y||t.x-e.x}t.geom.voronoi=function(e){var t=Ai,r=Ti,n=t,i=r,a=ha;if(e)return o(e);function o(e){var t=new Array(e.length),r=a[0][0],n=a[0][1],i=a[1][0],o=a[1][1];fa(s(e),a).cells.forEach(function(a,s){var l=a.edges,u=a.site,f=t[s]=l.length?l.map(function(e){var t=e.start();return[t.x,t.y]}):u.x>=r&&u.x<=i&&u.y>=n&&u.y<=o?[[r,o],[i,o],[i,n],[r,n]]:[];f.point=e[s]});return t}function s(e){return e.map(function(e,t){return{x:Math.round(n(e,t)/Ee)*Ee,y:Math.round(i(e,t)/Ee)*Ee,i:t}})}o.links=function(e){return fa(s(e)).edges.filter(function(e){return e.l&&e.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})};o.triangles=function(e){var t=[];fa(s(e)).cells.forEach(function(r,n){var i=r.site,a=r.edges.sort(Yi),o=-1,s=a.length,l,u,f=a[s-1].edge,c=f.l===i?f.r:f.l;while(++o<s){l=f;u=c;f=a[o].edge;c=f.l===i?f.r:f.l;if(n<u.i&&n<c.i&&va(i,u,c)<0){t.push([e[n],e[u.i],e[c.i]])}}});return t};o.x=function(e){return arguments.length?(n=At(t=e),o):t};o.y=function(e){return arguments.length?(i=At(r=e),o):r};o.clipExtent=function(e){if(!arguments.length)return a===ha?null:a;a=e==null?ha:e;return o};o.size=function(e){if(!arguments.length)return a===ha?null:a&&a[1];return o.clipExtent(e&&[[0,0],e])};return o};var ha=[[-1e6,-1e6],[1e6,1e6]];function va(e,t,r){return(e.x-r.x)*(t.y-e.y)-(e.x-t.x)*(r.y-e.y)}t.geom.delaunay=function(e){return t.geom.voronoi().triangles(e)};t.geom.quadtree=function(e,t,r,n,i){var a=Ai,o=Ti,s;if(s=arguments.length){a=da;o=pa;if(s===3){i=r;n=t;r=t=0}return l(e)}function l(e){var l,u=At(a),f=At(o),c,h,v,d,p,g,m,y;if(t!=null){p=t,g=r,m=n,y=i}else{m=y=-(p=g=Infinity);c=[],h=[];d=e.length;if(s)for(v=0;v<d;++v){l=e[v];if(l.x<p)p=l.x;if(l.y<g)g=l.y;if(l.x>m)m=l.x;if(l.y>y)y=l.y;c.push(l.x);h.push(l.y)}else for(v=0;v<d;++v){var x=+u(l=e[v],v),_=+f(l,v);if(x<p)p=x;if(_<g)g=_;if(x>m)m=x;if(_>y)y=_;c.push(x);h.push(_)}}var w=m-p,M=y-g;if(w>M)y=g+w;else m=p+M;function A(e,t,r,n,i,a,o,s){if(isNaN(r)||isNaN(n))return;if(e.leaf){var l=e.x,u=e.y;if(l!=null){if(b(l-r)+b(u-n)<.01){T(e,t,r,n,i,a,o,s)}else{var f=e.point;e.x=e.y=e.point=null;T(e,f,l,u,i,a,o,s);T(e,t,r,n,i,a,o,s)}}else{e.x=r,e.y=n,e.point=t}}else{T(e,t,r,n,i,a,o,s)}}function T(e,t,r,n,i,a,o,s){var l=(i+o)*.5,u=(a+s)*.5,f=r>=l,c=n>=u,h=c<<1|f;e.leaf=false;e=e.nodes[h]||(e.nodes[h]=ga());if(f)i=l;else o=l;if(c)a=u;else s=u;A(e,t,r,n,i,a,o,s)}var k=ga();k.add=function(e){A(k,e,+u(e,++v),+f(e,v),p,g,m,y)};k.visit=function(e){ma(e,k,p,g,m,y)};k.find=function(e){return ya(k,e[0],e[1],p,g,m,y)};v=-1;if(t==null){while(++v<d){A(k,e[v],c[v],h[v],p,g,m,y)}--v}else e.forEach(k.add);c=h=e=l=null;return k}l.x=function(e){return arguments.length?(a=e,l):a};l.y=function(e){return arguments.length?(o=e,l):o};l.extent=function(e){if(!arguments.length)return t==null?null:[[t,r],[n,i]];if(e==null)t=r=n=i=null;else t=+e[0][0],r=+e[0][1],n=+e[1][0],i=+e[1][1];return l};l.size=function(e){if(!arguments.length)return t==null?null:[n-t,i-r];if(e==null)t=r=n=i=null;else t=r=0,n=+e[0],i=+e[1];return l};return l};function da(e){return e.x}function pa(e){return e.y}function ga(){return{leaf:true,nodes:[],point:null,x:null,y:null}}function ma(e,t,r,n,i,a){if(!e(t,r,n,i,a)){var o=(r+i)*.5,s=(n+a)*.5,l=t.nodes;if(l[0])ma(e,l[0],r,n,o,s);if(l[1])ma(e,l[1],o,n,i,s);if(l[2])ma(e,l[2],r,s,o,a);if(l[3])ma(e,l[3],o,s,i,a)}}function ya(e,t,r,n,i,a,o){var s=Infinity,l;(function e(u,f,c,h,v){if(f>a||c>o||h<n||v<i)return;if(d=u.point){var d,p=t-u.x,g=r-u.y,m=p*p+g*g;if(m<s){var y=Math.sqrt(s=m);n=t-y,i=r-y;a=t+y,o=r+y;l=d}}var b=u.nodes,x=(f+h)*.5,_=(c+v)*.5,w=t>=x,M=r>=_;for(var A=M<<1|w,T=A+4;A<T;++A){if(u=b[A&3])switch(A&3){case 0:e(u,f,c,x,_);break;case 1:e(u,x,c,h,_);break;case 2:e(u,f,_,x,v);break;case 3:e(u,x,_,h,v);break}}})(e,n,i,a,o);return l}t.interpolateRgb=ba;function ba(e,r){e=t.rgb(e);r=t.rgb(r);var n=e.r,i=e.g,a=e.b,o=r.r-n,s=r.g-i,l=r.b-a;return function(e){return"#"+mt(Math.round(n+o*e))+mt(Math.round(i+s*e))+mt(Math.round(a+l*e))}}t.interpolateObject=xa;function xa(e,t){var r={},n={},i;for(i in e){if(i in t){r[i]=Ta(e[i],t[i])}else{n[i]=e[i]}}for(i in t){if(!(i in e)){n[i]=t[i]}}return function(e){for(i in r)n[i]=r[i](e);return n}}t.interpolateNumber=_a;function _a(e,t){e=+e,t=+t;return function(r){return e*(1-r)+t*r}}t.interpolateString=wa;function wa(e,t){var r=Ma.lastIndex=Aa.lastIndex=0,n,i,a,o=-1,s=[],l=[];e=e+"",t=t+"";while((n=Ma.exec(e))&&(i=Aa.exec(t))){if((a=i.index)>r){a=t.slice(r,a);if(s[o])s[o]+=a;else s[++o]=a}if((n=n[0])===(i=i[0])){if(s[o])s[o]+=i;else s[++o]=i}else{s[++o]=null;l.push({i:o,x:_a(n,i)})}r=Aa.lastIndex}if(r<t.length){a=t.slice(r);if(s[o])s[o]+=a;else s[++o]=a}return s.length<2?l[0]?(t=l[0].x,function(e){return t(e)+""}):function(){return t}:(t=l.length,function(e){for(var r=0,n;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}var Ma=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Aa=new RegExp(Ma.source,"g");t.interpolate=Ta;function Ta(e,r){var n=t.interpolators.length,i;while(--n>=0&&!(i=t.interpolators[n](e,r)));return i}t.interpolators=[function(e,t){var r=typeof t;return(r==="string"?Mt.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?ba:wa:t instanceof Ze?ba:Array.isArray(t)?ka:r==="object"&&isNaN(t)?xa:_a)(e,t)}];t.interpolateArray=ka;function ka(e,t){var r=[],n=[],i=e.length,a=t.length,o=Math.min(e.length,t.length),s;for(s=0;s<o;++s)r.push(Ta(e[s],t[s]));for(;s<i;++s)n[s]=e[s];for(;s<a;++s)n[s]=t[s];return function(e){for(s=0;s<o;++s)n[s]=r[s](e);return n}}var Ea=function(){return O};var Sa=t.map({linear:Ea,poly:za,quad:function(){return Oa},cubic:function(){return Ra},sin:function(){return Da},exp:function(){return Fa},circle:function(){return ja},elastic:Ba,back:Ua,bounce:function(){return Va}});var La=t.map({in:O,out:Ia,"in-out":Pa,"out-in":function(e){return Pa(Ia(e))}});t.ease=function(e){var t=e.indexOf("-"),r=t>=0?e.slice(0,t):e,i=t>=0?e.slice(t+1):"in";r=Sa.get(r)||Ea;i=La.get(i)||O;return Ca(i(r.apply(null,n.call(arguments,1))))};function Ca(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function Ia(e){return function(t){return 1-e(1-t)}}function Pa(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function Oa(e){return e*e}function Ra(e){return e*e*e}function Na(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function za(e){return function(t){return Math.pow(t,e)}}function Da(e){return 1-Math.cos(e*Pe)}function Fa(e){return Math.pow(2,10*(e-1))}function ja(e){return 1-Math.sqrt(1-e*e)}function Ba(e,t){var r;if(arguments.length<2)t=.45;if(arguments.length)r=t/Ce*Math.asin(1/e);else e=1,r=t/4;return function(n){return 1+e*Math.pow(2,-10*n)*Math.sin((n-r)*Ce/t)}}function Ua(e){if(!e)e=1.70158;return function(t){return t*t*((e+1)*t-e)}}function Va(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}t.interpolateHcl=Ha;function Ha(e,r){e=t.hcl(e);r=t.hcl(r);var n=e.h,i=e.c,a=e.l,o=r.h-n,s=r.c-i,l=r.l-a;if(isNaN(s))s=0,i=isNaN(i)?r.c:i;if(isNaN(o))o=0,n=isNaN(n)?r.h:n;else if(o>180)o-=360;else if(o<-180)o+=360;return function(e){return tt(n+o*e,i+s*e,a+l*e)+""}}t.interpolateHsl=qa;function qa(e,r){e=t.hsl(e);r=t.hsl(r);var n=e.h,i=e.s,a=e.l,o=r.h-n,s=r.s-i,l=r.l-a;if(isNaN(s))s=0,i=isNaN(i)?r.s:i;if(isNaN(o))o=0,n=isNaN(n)?r.h:n;else if(o>180)o-=360;else if(o<-180)o+=360;return function(e){return Je(n+o*e,i+s*e,a+l*e)+""}}t.interpolateLab=Ga;function Ga(e,r){e=t.lab(e);r=t.lab(r);var n=e.l,i=e.a,a=e.b,o=r.l-n,s=r.a-i,l=r.b-a;return function(e){return lt(n+o*e,i+s*e,a+l*e)+""}}t.interpolateRound=Wa;function Wa(e,t){t-=e;return function(r){return Math.round(e+t*r)}}t.transform=function(e){var r=a.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(e){if(e!=null){r.setAttribute("transform",e);var t=r.transform.baseVal.consolidate()}return new Xa(t?t.matrix:Ka)})(e)};function Xa(e){var t=[e.a,e.b],r=[e.c,e.d],n=Za(t),i=Ya(t,r),a=Za(Qa(r,t,-i))||0;if(t[0]*r[1]<r[0]*t[1]){t[0]*=-1;t[1]*=-1;n*=-1;i*=-1}this.rotate=(n?Math.atan2(t[1],t[0]):Math.atan2(-r[0],r[1]))*Re;this.translate=[e.e,e.f];this.scale=[n,a];this.skew=a?Math.atan2(i,a)*Re:0}Xa.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function Ya(e,t){return e[0]*t[0]+e[1]*t[1]}function Za(e){var t=Math.sqrt(Ya(e,e));if(t){e[0]/=t;e[1]/=t}return t}function Qa(e,t,r){e[0]+=r*t[0];e[1]+=r*t[1];return e}var Ka={a:1,b:0,c:0,d:1,e:0,f:0};t.interpolateTransform=no;function Ja(e){return e.length?e.pop()+",":""}function $a(e,t,r,n){if(e[0]!==t[0]||e[1]!==t[1]){var i=r.push("translate(",null,",",null,")");n.push({i:i-4,x:_a(e[0],t[0])},{i:i-2,x:_a(e[1],t[1])})}else if(t[0]||t[1]){r.push("translate("+t+")")}}function eo(e,t,r,n){if(e!==t){if(e-t>180)t+=360;else if(t-e>180)e+=360;n.push({i:r.push(Ja(r)+"rotate(",null,")")-2,x:_a(e,t)})}else if(t){r.push(Ja(r)+"rotate("+t+")")}}function to(e,t,r,n){if(e!==t){n.push({i:r.push(Ja(r)+"skewX(",null,")")-2,x:_a(e,t)})}else if(t){r.push(Ja(r)+"skewX("+t+")")}}function ro(e,t,r,n){if(e[0]!==t[0]||e[1]!==t[1]){var i=r.push(Ja(r)+"scale(",null,",",null,")");n.push({i:i-4,x:_a(e[0],t[0])},{i:i-2,x:_a(e[1],t[1])})}else if(t[0]!==1||t[1]!==1){r.push(Ja(r)+"scale("+t+")")}}function no(e,r){var n=[],i=[];e=t.transform(e),r=t.transform(r);$a(e.translate,r.translate,n,i);eo(e.rotate,r.rotate,n,i);to(e.skew,r.skew,n,i);ro(e.scale,r.scale,n,i);e=r=null;return function(e){var t=-1,r=i.length,a;while(++t<r)n[(a=i[t]).i]=a.x(e);return n.join("")}}function io(e,t){t=(t-=e=+e)||1/t;return function(r){return(r-e)/t}}function ao(e,t){t=(t-=e=+e)||1/t;return function(r){return Math.max(0,Math.min(1,(r-e)/t))}}t.layout={};t.layout.bundle=function(){return function(e){var t=[],r=-1,n=e.length;while(++r<n)t.push(oo(e[r]));return t}};function oo(e){var t=e.source,r=e.target,n=lo(t,r),i=[t];while(t!==n){t=t.parent;i.push(t)}var a=i.length;while(r!==n){i.splice(a,0,r);r=r.parent}return i}function so(e){var t=[],r=e.parent;while(r!=null){t.push(e);e=r;r=r.parent}t.push(e);return t}function lo(e,t){if(e===t)return e;var r=so(e),n=so(t),i=r.pop(),a=n.pop(),o=null;while(i===a){o=i;i=r.pop();a=n.pop()}return o}t.layout.chord=function(){var e={},r,n,i,a,o=0,s,l,u;function f(){var e={},f=[],h=t.range(a),v=[],d,p,g,m,y;r=[];n=[];d=0,m=-1;while(++m<a){p=0,y=-1;while(++y<a){p+=i[m][y]}f.push(p);v.push(t.range(a));d+=p}if(s){h.sort(function(e,t){return s(f[e],f[t])})}if(l){v.forEach(function(e,t){e.sort(function(e,r){return l(i[t][e],i[t][r])})})}d=(Ce-o*a)/d;p=0,m=-1;while(++m<a){g=p,y=-1;while(++y<a){var b=h[m],x=v[b][y],_=i[b][x],w=p,M=p+=_*d;e[b+"-"+x]={index:b,subindex:x,startAngle:w,endAngle:M,value:_}}n[b]={index:b,startAngle:g,endAngle:p,value:f[b]};p+=o}m=-1;while(++m<a){y=m-1;while(++y<a){var A=e[m+"-"+y],T=e[y+"-"+m];if(A.value||T.value){r.push(A.value<T.value?{source:T,target:A}:{source:A,target:T})}}}if(u)c()}function c(){r.sort(function(e,t){return u((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}e.matrix=function(t){if(!arguments.length)return i;a=(i=t)&&i.length;r=n=null;return e};e.padding=function(t){if(!arguments.length)return o;o=t;r=n=null;return e};e.sortGroups=function(t){if(!arguments.length)return s;s=t;r=n=null;return e};e.sortSubgroups=function(t){if(!arguments.length)return l;l=t;r=null;return e};e.sortChords=function(t){if(!arguments.length)return u;u=t;if(r)c();return e};e.chords=function(){if(!r)f();return r};e.groups=function(){if(!n)f();return n};return e};t.layout.force=function(){var e={},r=t.dispatch("start","tick","end"),n,i=[1,1],a,o,s=.9,l=po,u=go,f=-30,c=mo,h=.1,v=.64,d=[],p=[],g,m,y;function b(e){return function(t,r,n,i){if(t.point!==e){var a=t.cx-e.x,o=t.cy-e.y,s=i-r,l=a*a+o*o;if(s*s/v<l){if(l<c){var u=t.charge/l;e.px-=a*u;e.py-=o*u}return true}if(t.point&&l&&l<c){var u=t.pointCharge/l;e.px-=a*u;e.py-=o*u}}return!t.charge}}e.tick=function(){if((o*=.99)<.005){n=null;r.end({type:"end",alpha:o=0});return true}var e=d.length,a=p.length,l,u,c,v,x,_,w,M,A;for(u=0;u<a;++u){c=p[u];v=c.source;x=c.target;M=x.x-v.x;A=x.y-v.y;if(_=M*M+A*A){_=o*m[u]*((_=Math.sqrt(_))-g[u])/_;M*=_;A*=_;x.x-=M*(w=v.weight+x.weight?v.weight/(v.weight+x.weight):.5);x.y-=A*w;v.x+=M*(w=1-w);v.y+=A*w}}if(w=o*h){M=i[0]/2;A=i[1]/2;u=-1;if(w)while(++u<e){c=d[u];c.x+=(M-c.x)*w;c.y+=(A-c.y)*w}}if(f){vo(l=t.geom.quadtree(d),o,y);u=-1;while(++u<e){if(!(c=d[u]).fixed){l.visit(b(c))}}}u=-1;while(++u<e){c=d[u];if(c.fixed){c.x=c.px;c.y=c.py}else{c.x-=(c.px-(c.px=c.x))*s;c.y-=(c.py-(c.py=c.y))*s}}r.tick({type:"tick",alpha:o})};e.nodes=function(t){if(!arguments.length)return d;d=t;return e};e.links=function(t){if(!arguments.length)return p;p=t;return e};e.size=function(t){if(!arguments.length)return i;i=t;return e};e.linkDistance=function(t){if(!arguments.length)return l;l=typeof t==="function"?t:+t;return e};e.distance=e.linkDistance;e.linkStrength=function(t){if(!arguments.length)return u;u=typeof t==="function"?t:+t;return e};e.friction=function(t){if(!arguments.length)return s;s=+t;return e};e.charge=function(t){if(!arguments.length)return f;f=typeof t==="function"?t:+t;return e};e.chargeDistance=function(t){if(!arguments.length)return Math.sqrt(c);c=t*t;return e};e.gravity=function(t){if(!arguments.length)return h;h=+t;return e};e.theta=function(t){if(!arguments.length)return Math.sqrt(v);v=t*t;return e};e.alpha=function(t){if(!arguments.length)return o;t=+t;if(o){if(t>0){o=t}else{n.c=null,n.t=NaN,n=null;r.end({type:"end",alpha:o=0})}}else if(t>0){r.start({type:"start",alpha:o=t});n=Rt(e.tick)}return e};e.start=function(){var t,r=d.length,n=p.length,a=i[0],o=i[1],s,c;for(t=0;t<r;++t){(c=d[t]).index=t;c.weight=0}for(t=0;t<n;++t){c=p[t];if(typeof c.source=="number")c.source=d[c.source];if(typeof c.target=="number")c.target=d[c.target];++c.source.weight;++c.target.weight}for(t=0;t<r;++t){c=d[t];if(isNaN(c.x))c.x=h("x",a);if(isNaN(c.y))c.y=h("y",o);if(isNaN(c.px))c.px=c.x;if(isNaN(c.py))c.py=c.y}g=[];if(typeof l==="function")for(t=0;t<n;++t)g[t]=+l.call(this,p[t],t);else for(t=0;t<n;++t)g[t]=l;m=[];if(typeof u==="function")for(t=0;t<n;++t)m[t]=+u.call(this,p[t],t);else for(t=0;t<n;++t)m[t]=u;y=[];if(typeof f==="function")for(t=0;t<r;++t)y[t]=+f.call(this,d[t],t);else for(t=0;t<r;++t)y[t]=f;function h(e,i){if(!s){s=new Array(r);for(l=0;l<r;++l){s[l]=[]}for(l=0;l<n;++l){var a=p[l];s[a.source.index].push(a.target);s[a.target.index].push(a.source)}}var o=s[t],l=-1,u=o.length,f;while(++l<u)if(!isNaN(f=o[l][e]))return f;return Math.random()*i}return e.resume()};e.resume=function(){return e.alpha(.1)};e.stop=function(){return e.alpha(0)};e.drag=function(){if(!a)a=t.behavior.drag().origin(O).on("dragstart.force",uo).on("drag.force",x).on("dragend.force",fo);if(!arguments.length)return a;this.on("mouseover.force",co).on("mouseout.force",ho).call(a)};function x(r){r.px=t.event.x,r.py=t.event.y;e.resume()}return t.rebind(e,r,"on")};function uo(e){e.fixed|=2}function fo(e){e.fixed&=~6}function co(e){e.fixed|=4;e.px=e.x,e.py=e.y}function ho(e){e.fixed&=~4}function vo(e,t,r){var n=0,i=0;e.charge=0;if(!e.leaf){var a=e.nodes,o=a.length,s=-1,l;while(++s<o){l=a[s];if(l==null)continue;vo(l,t,r);e.charge+=l.charge;n+=l.charge*l.cx;i+=l.charge*l.cy}}if(e.point){if(!e.leaf){e.point.x+=Math.random()-.5;e.point.y+=Math.random()-.5}var u=t*r[e.point.index];e.charge+=e.pointCharge=u;n+=u*e.point.x;i+=u*e.point.y}e.cx=n/e.charge;e.cy=i/e.charge}var po=20,go=1,mo=Infinity;t.layout.hierarchy=function(){var e=Mo,t=_o,r=wo;function n(i){var a=[i],o=[],s;i.depth=0;while((s=a.pop())!=null){o.push(s);if((u=t.call(n,s,s.depth))&&(l=u.length)){var l,u,f;while(--l>=0){a.push(f=u[l]);f.parent=s;f.depth=s.depth+1}if(r)s.value=0;s.children=u}else{if(r)s.value=+r.call(n,s,s.depth)||0;delete s.children}}xo(i,function(t){var n,i;if(e&&(n=t.children))n.sort(e);if(r&&(i=t.parent))i.value+=t.value});return o}n.sort=function(t){if(!arguments.length)return e;e=t;return n};n.children=function(e){if(!arguments.length)return t;t=e;return n};n.value=function(e){if(!arguments.length)return r;r=e;return n};n.revalue=function(e){if(r){bo(e,function(e){if(e.children)e.value=0});xo(e,function(e){var t;if(!e.children)e.value=+r.call(n,e,e.depth)||0;if(t=e.parent)t.value+=e.value})}return e};return n};function yo(e,r){t.rebind(e,r,"sort","children","value");e.nodes=e;e.links=Ao;return e}function bo(e,t){var r=[e];while((e=r.pop())!=null){t(e);if((i=e.children)&&(n=i.length)){var n,i;while(--n>=0)r.push(i[n])}}}function xo(e,t){var r=[e],n=[];while((e=r.pop())!=null){n.push(e);if((o=e.children)&&(a=o.length)){var i=-1,a,o;while(++i<a)r.push(o[i])}}while((e=n.pop())!=null){t(e)}}function _o(e){return e.children}function wo(e){return e.value}function Mo(e,t){return t.value-e.value}function Ao(e){return t.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}t.layout.partition=function(){var e=t.layout.hierarchy(),r=[1,1];function n(e,t,r,i){var a=e.children;e.x=t;e.y=e.depth*i;e.dx=r;e.dy=i;if(a&&(s=a.length)){var o=-1,s,l,u;r=e.value?r/e.value:0;while(++o<s){n(l=a[o],t,u=l.value*r,i);t+=u}}}function i(e){var t=e.children,r=0;if(t&&(a=t.length)){var n=-1,a;while(++n<a)r=Math.max(r,i(t[n]))}return 1+r}function a(t,a){var o=e.call(this,t,a);n(o[0],0,r[0],r[1]/i(o[0]));return o}a.size=function(e){if(!arguments.length)return r;r=e;return a};return yo(a,e)};t.layout.pie=function(){var e=Number,r=To,n=0,i=Ce,a=0;function o(s){var l=s.length,u=s.map(function(t,r){return+e.call(o,t,r)}),f=+(typeof n==="function"?n.apply(this,arguments):n),c=(typeof i==="function"?i.apply(this,arguments):i)-f,h=Math.min(Math.abs(c)/l,+(typeof a==="function"?a.apply(this,arguments):a)),v=h*(c<0?-1:1),d=t.sum(u),p=d?(c-l*v)/d:0,g=t.range(l),m=[],y;if(r!=null)g.sort(r===To?function(e,t){return u[t]-u[e]}:function(e,t){return r(s[e],s[t])});g.forEach(function(e){m[e]={data:s[e],value:y=u[e],startAngle:f,endAngle:f+=y*p+v,padAngle:h}});return m}o.value=function(t){if(!arguments.length)return e;e=t;return o};o.sort=function(e){if(!arguments.length)return r;r=e;return o};o.startAngle=function(e){if(!arguments.length)return n;n=e;return o};o.endAngle=function(e){if(!arguments.length)return i;i=e;return o};o.padAngle=function(e){if(!arguments.length)return a;a=e;return o};return o};var To={};t.layout.stack=function(){var e=O,r=Io,n=Po,i=So,a=ko,o=Eo;function s(l,u){if(!(p=l.length))return l;var f=l.map(function(t,r){return e.call(s,t,r)});var c=f.map(function(e){return e.map(function(e,t){return[a.call(s,e,t),o.call(s,e,t)]})});var h=r.call(s,c,u);f=t.permute(f,h);c=t.permute(c,h);var v=n.call(s,c,u);var d=f[0].length,p,g,m,y;for(m=0;m<d;++m){i.call(s,f[0][m],y=v[m],c[0][m][1]);for(g=1;g<p;++g){i.call(s,f[g][m],y+=c[g-1][m][1],c[g][m][1])}}return l}s.values=function(t){if(!arguments.length)return e;e=t;return s};s.order=function(e){if(!arguments.length)return r;r=typeof e==="function"?e:Lo.get(e)||Io;return s};s.offset=function(e){if(!arguments.length)return n;n=typeof e==="function"?e:Co.get(e)||Po;return s};s.x=function(e){if(!arguments.length)return a;a=e;return s};s.y=function(e){if(!arguments.length)return o;o=e;return s};s.out=function(e){if(!arguments.length)return i;i=e;return s};return s};function ko(e){return e.x}function Eo(e){return e.y}function So(e,t,r){e.y0=t;e.y=r}var Lo=t.map({"inside-out":function(e){var r=e.length,n,i,a=e.map(Oo),o=e.map(Ro),s=t.range(r).sort(function(e,t){return a[e]-a[t]}),l=0,u=0,f=[],c=[];for(n=0;n<r;++n){i=s[n];if(l<u){l+=o[i];f.push(i)}else{u+=o[i];c.push(i)}}return c.reverse().concat(f)},reverse:function(e){return t.range(e.length).reverse()},default:Io});var Co=t.map({silhouette:function(e){var t=e.length,r=e[0].length,n=[],i=0,a,o,s,l=[];for(o=0;o<r;++o){for(a=0,s=0;a<t;a++)s+=e[a][o][1];if(s>i)i=s;n.push(s)}for(o=0;o<r;++o){l[o]=(i-n[o])/2}return l},wiggle:function(e){var t=e.length,r=e[0],n=r.length,i,a,o,s,l,u,f,c,h,v=[];v[0]=c=h=0;for(a=1;a<n;++a){for(i=0,s=0;i<t;++i)s+=e[i][a][1];for(i=0,l=0,f=r[a][0]-r[a-1][0];i<t;++i){for(o=0,u=(e[i][a][1]-e[i][a-1][1])/(2*f);o<i;++o){u+=(e[o][a][1]-e[o][a-1][1])/f}l+=u*e[i][a][1]}v[a]=c-=s?l/s*f:0;if(c<h)h=c}for(a=0;a<n;++a)v[a]-=h;return v},expand:function(e){var t=e.length,r=e[0].length,n=1/t,i,a,o,s=[];for(a=0;a<r;++a){for(i=0,o=0;i<t;i++)o+=e[i][a][1];if(o)for(i=0;i<t;i++)e[i][a][1]/=o;else for(i=0;i<t;i++)e[i][a][1]=n}for(a=0;a<r;++a)s[a]=0;return s},zero:Po});function Io(e){return t.range(e.length)}function Po(e){var t=-1,r=e[0].length,n=[];while(++t<r)n[t]=0;return n}function Oo(e){var t=1,r=0,n=e[0][1],i,a=e.length;for(;t<a;++t){if((i=e[t][1])>n){r=t;n=i}}return r}function Ro(e){return e.reduce(No,0)}function No(e,t){return e+t[1]}t.layout.histogram=function(){var e=true,r=Number,n=Fo,i=zo;function a(a,o){var s=[],l=a.map(r,this),u=n.call(this,l,o),f=i.call(this,u,l,o),c,o=-1,h=l.length,v=f.length-1,d=e?1:1/h,p;while(++o<v){c=s[o]=[];c.dx=f[o+1]-(c.x=f[o]);c.y=0}if(v>0){o=-1;while(++o<h){p=l[o];if(p>=u[0]&&p<=u[1]){c=s[t.bisect(f,p,1,v)-1];c.y+=d;c.push(a[o])}}}return s}a.value=function(e){if(!arguments.length)return r;r=e;return a};a.range=function(e){if(!arguments.length)return n;n=At(e);return a};a.bins=function(e){if(!arguments.length)return i;i=typeof e==="number"?function(t){return Do(t,e)}:At(e);return a};a.frequency=function(t){if(!arguments.length)return e;e=!!t;return a};return a};function zo(e,t){return Do(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function Do(e,t){var r=-1,n=+e[0],i=(e[1]-n)/t,a=[];while(++r<=t)a[r]=i*r+n;return a}function Fo(e){return[t.min(e),t.max(e)]}t.layout.pack=function(){var e=t.layout.hierarchy().sort(jo),r=0,n=[1,1],i;function a(t,a){var o=e.call(this,t,a),s=o[0],l=n[0],u=n[1],f=i==null?Math.sqrt:typeof i==="function"?i:function(){return i};s.x=s.y=0;xo(s,function(e){e.r=+f(e.value)});xo(s,Ho);if(r){var c=r*(i?1:Math.max(2*s.r/l,2*s.r/u))/2;xo(s,function(e){e.r+=c});xo(s,Ho);xo(s,function(e){e.r-=c})}Wo(s,l/2,u/2,i?1:1/Math.max(2*s.r/l,2*s.r/u));return o}a.size=function(e){if(!arguments.length)return n;n=e;return a};a.radius=function(e){if(!arguments.length)return i;i=e==null||typeof e==="function"?e:+e;return a};a.padding=function(e){if(!arguments.length)return r;r=+e;return a};return yo(a,e)};function jo(e,t){return e.value-t.value}function Bo(e,t){var r=e._pack_next;e._pack_next=t;t._pack_prev=e;t._pack_next=r;r._pack_prev=t}function Uo(e,t){e._pack_next=t;t._pack_prev=e}function Vo(e,t){var r=t.x-e.x,n=t.y-e.y,i=e.r+t.r;return.999*i*i>r*r+n*n}function Ho(e){if(!(t=e.children)||!(h=t.length))return;var t,r=Infinity,n=-Infinity,i=Infinity,a=-Infinity,o,s,l,u,f,c,h;function v(e){r=Math.min(e.x-e.r,r);n=Math.max(e.x+e.r,n);i=Math.min(e.y-e.r,i);a=Math.max(e.y+e.r,a)}t.forEach(qo);o=t[0];o.x=-o.r;o.y=0;v(o);if(h>1){s=t[1];s.x=s.r;s.y=0;v(s);if(h>2){l=t[2];Xo(o,s,l);v(l);Bo(o,l);o._pack_prev=l;Bo(l,s);s=o._pack_next;for(u=3;u<h;u++){Xo(o,s,l=t[u]);var d=0,p=1,g=1;for(f=s._pack_next;f!==s;f=f._pack_next,p++){if(Vo(f,l)){d=1;break}}if(d==1){for(c=o._pack_prev;c!==f._pack_prev;c=c._pack_prev,g++){if(Vo(c,l)){break}}}if(d){if(p<g||p==g&&s.r<o.r)Uo(o,s=f);else Uo(o=c,s);u--}else{Bo(o,l);s=l;v(l)}}}}var m=(r+n)/2,y=(i+a)/2,b=0;for(u=0;u<h;u++){l=t[u];l.x-=m;l.y-=y;b=Math.max(b,l.r+Math.sqrt(l.x*l.x+l.y*l.y))}e.r=b;t.forEach(Go)}function qo(e){e._pack_next=e._pack_prev=e}function Go(e){delete e._pack_next;delete e._pack_prev}function Wo(e,t,r,n){var i=e.children;e.x=t+=n*e.x;e.y=r+=n*e.y;e.r*=n;if(i){var a=-1,o=i.length;while(++a<o)Wo(i[a],t,r,n)}}function Xo(e,t,r){var n=e.r+r.r,i=t.x-e.x,a=t.y-e.y;if(n&&(i||a)){var o=t.r+r.r,s=i*i+a*a;o*=o;n*=n;var l=.5+(n-o)/(2*s),u=Math.sqrt(Math.max(0,2*o*(n+s)-(n-=s)*n-o*o))/(2*s);r.x=e.x+l*i+u*a;r.y=e.y+l*a-u*i}else{r.x=e.x+n;r.y=e.y}}t.layout.tree=function(){var e=t.layout.hierarchy().sort(null).value(null),r=Yo,n=[1,1],i=null;function a(t,a){var u=e.call(this,t,a),c=u[0],h=o(c);xo(h,s),h.parent.m=-h.z;bo(h,l);if(i)bo(c,f);else{var v=c,d=c,p=c;bo(c,function(e){if(e.x<v.x)v=e;if(e.x>d.x)d=e;if(e.depth>p.depth)p=e});var g=r(v,d)/2-v.x,m=n[0]/(d.x+r(d,v)/2+g),y=n[1]/(p.depth||1);bo(c,function(e){e.x=(e.x+g)*m;e.y=e.depth*y})}return u}function o(e){var t={A:null,children:[e]},r=[t],n;while((n=r.pop())!=null){for(var i=n.children,a,o=0,s=i.length;o<s;++o){r.push((i[o]=a={_:i[o],parent:n,children:(a=i[o].children)&&a.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=a)}}return t.children[0]}function s(e){var t=e.children,n=e.parent.children,i=e.i?n[e.i-1]:null;if(t.length){Jo(e);var a=(t[0].z+t[t.length-1].z)/2;if(i){e.z=i.z+r(e._,i._);e.m=e.z-a}else{e.z=a}}else if(i){e.z=i.z+r(e._,i._)}e.parent.A=u(e,i,e.parent.A||n[0])}function l(e){e._.x=e.z+e.parent.m;e.m+=e.parent.m}function u(e,t,n){if(t){var i=e,a=e,o=t,s=i.parent.children[0],l=i.m,u=a.m,f=o.m,c=s.m,h;while(o=Qo(o),i=Zo(i),o&&i){s=Zo(s);a=Qo(a);a.a=e;h=o.z+f-i.z-l+r(o._,i._);if(h>0){Ko($o(o,e,n),e,h);l+=h;u+=h}f+=o.m;l+=i.m;c+=s.m;u+=a.m}if(o&&!Qo(a)){a.t=o;a.m+=f-u}if(i&&!Zo(s)){s.t=i;s.m+=l-c;n=e}}return n}function f(e){e.x*=n[0];e.y=e.depth*n[1]}a.separation=function(e){if(!arguments.length)return r;r=e;return a};a.size=function(e){if(!arguments.length)return i?null:n;i=(n=e)==null?f:null;return a};a.nodeSize=function(e){if(!arguments.length)return i?n:null;i=(n=e)==null?null:f;return a};return yo(a,e)};function Yo(e,t){return e.parent==t.parent?1:2}function Zo(e){var t=e.children;return t.length?t[0]:e.t}function Qo(e){var t=e.children,r;return(r=t.length)?t[r-1]:e.t}function Ko(e,t,r){var n=r/(t.i-e.i);t.c-=n;t.s+=r;e.c+=n;t.z+=r;t.m+=r}function Jo(e){var t=0,r=0,n=e.children,i=n.length,a;while(--i>=0){a=n[i];a.z+=t;a.m+=t;t+=a.s+(r+=a.c)}}function $o(e,t,r){return e.a.parent===t.parent?e.a:r}t.layout.cluster=function(){var e=t.layout.hierarchy().sort(null).value(null),r=Yo,n=[1,1],i=false;function a(t,a){var o=e.call(this,t,a),s=o[0],l,u=0;xo(s,function(e){var t=e.children;if(t&&t.length){e.x=ts(t);e.y=es(t)}else{e.x=l?u+=r(e,l):0;e.y=0;l=e}});var f=rs(s),c=ns(s),h=f.x-r(f,c)/2,v=c.x+r(c,f)/2;xo(s,i?function(e){e.x=(e.x-s.x)*n[0];e.y=(s.y-e.y)*n[1]}:function(e){e.x=(e.x-h)/(v-h)*n[0];e.y=(1-(s.y?e.y/s.y:1))*n[1]});return o}a.separation=function(e){if(!arguments.length)return r;r=e;return a};a.size=function(e){if(!arguments.length)return i?null:n;i=(n=e)==null;return a};a.nodeSize=function(e){if(!arguments.length)return i?n:null;i=(n=e)!=null;return a};return yo(a,e)};function es(e){return 1+t.max(e,function(e){return e.y})}function ts(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function rs(e){var t=e.children;return t&&t.length?rs(t[0]):e}function ns(e){var t=e.children,r;return t&&(r=t.length)?ns(t[r-1]):e}t.layout.treemap=function(){var e=t.layout.hierarchy(),r=Math.round,n=[1,1],i=null,a=is,o=false,s,l="squarify",u=.5*(1+Math.sqrt(5));function f(e,t){var r=-1,n=e.length,i,a;while(++r<n){a=(i=e[r]).value*(t<0?0:t);i.area=isNaN(a)||a<=0?0:a}}function c(e){var t=e.children;if(t&&t.length){var r=a(e),n=[],i=t.slice(),o,s=Infinity,u,h=l==="slice"?r.dx:l==="dice"?r.dy:l==="slice-dice"?e.depth&1?r.dy:r.dx:Math.min(r.dx,r.dy),p;f(i,r.dx*r.dy/e.value);n.area=0;while((p=i.length)>0){n.push(o=i[p-1]);n.area+=o.area;if(l!=="squarify"||(u=v(n,h))<=s){i.pop();s=u}else{n.area-=n.pop().area;d(n,h,r,false);h=Math.min(r.dx,r.dy);n.length=n.area=0;s=Infinity}}if(n.length){d(n,h,r,true);n.length=n.area=0}t.forEach(c)}}function h(e){var t=e.children;if(t&&t.length){var r=a(e),n=t.slice(),i,o=[];f(n,r.dx*r.dy/e.value);o.area=0;while(i=n.pop()){o.push(i);o.area+=i.area;if(i.z!=null){d(o,i.z?r.dx:r.dy,r,!n.length);o.length=o.area=0}}t.forEach(h)}}function v(e,t){var r=e.area,n,i=0,a=Infinity,o=-1,s=e.length;while(++o<s){if(!(n=e[o].area))continue;if(n<a)a=n;if(n>i)i=n}r*=r;t*=t;return r?Math.max(t*i*u/r,r/(t*a*u)):Infinity}function d(e,t,n,i){var a=-1,o=e.length,s=n.x,l=n.y,u=t?r(e.area/t):0,f;if(t==n.dx){if(i||u>n.dy)u=n.dy;while(++a<o){f=e[a];f.x=s;f.y=l;f.dy=u;s+=f.dx=Math.min(n.x+n.dx-s,u?r(f.area/u):0)}f.z=true;f.dx+=n.x+n.dx-s;n.y+=u;n.dy-=u}else{if(i||u>n.dx)u=n.dx;while(++a<o){f=e[a];f.x=s;f.y=l;f.dx=u;l+=f.dy=Math.min(n.y+n.dy-l,u?r(f.area/u):0)}f.z=false;f.dy+=n.y+n.dy-l;n.x+=u;n.dx-=u}}function p(t){var r=s||e(t),i=r[0];i.x=i.y=0;if(i.value)i.dx=n[0],i.dy=n[1];else i.dx=i.dy=0;if(s)e.revalue(i);f([i],i.dx*i.dy/i.value);(s?h:c)(i);if(o)s=r;return r}p.size=function(e){if(!arguments.length)return n;n=e;return p};p.padding=function(e){if(!arguments.length)return i;function t(t){var r=e.call(p,t,t.depth);return r==null?is(t):as(t,typeof r==="number"?[r,r,r,r]:r)}function r(t){return as(t,e)}var n;a=(i=e)==null?is:(n=typeof e)==="function"?t:n==="number"?(e=[e,e,e,e],r):r;return p};p.round=function(e){if(!arguments.length)return r!=Number;r=e?Math.round:Number;return p};p.sticky=function(e){if(!arguments.length)return o;o=e;s=null;return p};p.ratio=function(e){if(!arguments.length)return u;u=e;return p};p.mode=function(e){if(!arguments.length)return l;l=e+"";return p};return yo(p,e)};function is(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function as(e,t){var r=e.x+t[3],n=e.y+t[0],i=e.dx-t[1]-t[3],a=e.dy-t[0]-t[2];if(i<0){r+=i/2;i=0}if(a<0){n+=a/2;a=0}return{x:r,y:n,dx:i,dy:a}}t.random={normal:function(e,t){var r=arguments.length;if(r<2)t=1;if(r<1)e=0;return function(){var r,n,i;do{r=Math.random()*2-1;n=Math.random()*2-1;i=r*r+n*n}while(!i||i>1);return e+t*r*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var e=t.random.normal.apply(t,arguments);return function(){return Math.exp(e())}},bates:function(e){var r=t.random.irwinHall(e);return function(){return r()/e}},irwinHall:function(e){return function(){for(var t=0,r=0;r<e;r++)t+=Math.random();return t}}};t.scale={};function os(e){var t=e[0],r=e[e.length-1];return t<r?[t,r]:[r,t]}function ss(e){return e.rangeExtent?e.rangeExtent():os(e.range())}function ls(e,t,r,n){var i=r(e[0],e[1]),a=n(t[0],t[1]);return function(e){return a(i(e))}}function us(e,t){var r=0,n=e.length-1,i=e[r],a=e[n],o;if(a<i){o=r,r=n,n=o;o=i,i=a,a=o}e[r]=t.floor(i);e[n]=t.ceil(a);return e}function fs(e){return e?{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}:cs}var cs={floor:O,ceil:O};function hs(e,r,n,i){var a=[],o=[],s=0,l=Math.min(e.length,r.length)-1;if(e[l]<e[0]){e=e.slice().reverse();r=r.slice().reverse()}while(++s<=l){a.push(n(e[s-1],e[s]));o.push(i(r[s-1],r[s]))}return function(r){var n=t.bisect(e,r,1,l)-1;return o[n](a[n](r))}}t.scale.linear=function(){return vs([0,1],[0,1],Ta,false)};function vs(e,t,r,n){var i,a;function o(){var o=Math.min(e.length,t.length)>2?hs:ls,l=n?ao:io;i=o(e,t,l,r);a=o(t,e,l,Ta);return s}function s(e){return i(e)}s.invert=function(e){return a(e)};s.domain=function(t){if(!arguments.length)return e;e=t.map(Number);return o()};s.range=function(e){if(!arguments.length)return t;t=e;return o()};s.rangeRound=function(e){return s.range(e).interpolate(Wa)};s.clamp=function(e){if(!arguments.length)return n;n=e;return o()};s.interpolate=function(e){if(!arguments.length)return r;r=e;return o()};s.ticks=function(t){return ms(e,t)};s.tickFormat=function(t,r){return ys(e,t,r)};s.nice=function(t){ps(e,t);return o()};s.copy=function(){return vs(e,t,r,n)};return o()}function ds(e,r){return t.rebind(e,r,"range","rangeRound","interpolate","clamp")}function ps(e,t){us(e,fs(gs(e,t)[2]));us(e,fs(gs(e,t)[2]));return e}function gs(e,t){if(t==null)t=10;var r=os(e),n=r[1]-r[0],i=Math.pow(10,Math.floor(Math.log(n/t)/Math.LN10)),a=t/n*i;if(a<=.15)i*=10;else if(a<=.35)i*=5;else if(a<=.75)i*=2;r[0]=Math.ceil(r[0]/i)*i;r[1]=Math.floor(r[1]/i)*i+i*.5;r[2]=i;return r}function ms(e,r){return t.range.apply(t,gs(e,r))}function ys(e,r,n){var i=gs(e,r);if(n){var a=Vt.exec(n);a.shift();if(a[8]==="s"){var o=t.formatPrefix(Math.max(b(i[0]),b(i[1])));if(!a[7])a[7]="."+xs(o.scale(i[2]));a[8]="f";n=t.format(a.join(""));return function(e){return n(o.scale(e))+o.symbol}}if(!a[7])a[7]="."+_s(a[8],i);n=a.join("")}else{n=",."+xs(i[2])+"f"}return t.format(n)}var bs={s:1,g:1,p:1,r:1,e:1};function xs(e){return-Math.floor(Math.log(e)/Math.LN10+.01)}function _s(e,t){var r=xs(t[2]);return e in bs?Math.abs(r-xs(Math.max(b(t[0]),b(t[1]))))+ +(e!=="e"):r-(e==="%")*2}t.scale.log=function(){return ws(t.scale.linear().domain([0,1]),10,true,[1,10])};function ws(e,r,n,i){function a(e){return(n?Math.log(e<0?0:e):-Math.log(e>0?0:-e))/Math.log(r)}function o(e){return n?Math.pow(r,e):-Math.pow(r,-e)}function s(t){return e(a(t))}s.invert=function(t){return o(e.invert(t))};s.domain=function(t){if(!arguments.length)return i;n=t[0]>=0;e.domain((i=t.map(Number)).map(a));return s};s.base=function(t){if(!arguments.length)return r;r=+t;e.domain(i.map(a));return s};s.nice=function(){var t=us(i.map(a),n?Math:As);e.domain(t);i=t.map(o);return s};s.ticks=function(){var e=os(i),t=[],s=e[0],l=e[1],u=Math.floor(a(s)),f=Math.ceil(a(l)),c=r%1?2:r;if(isFinite(f-u)){if(n){for(;u<f;u++)for(var h=1;h<c;h++)t.push(o(u)*h);t.push(o(u))}else{t.push(o(u));for(;u++<f;)for(var h=c-1;h>0;h--)t.push(o(u)*h)}for(u=0;t[u]<s;u++){}for(f=t.length;t[f-1]>l;f--){}t=t.slice(u,f)}return t};s.tickFormat=function(e,n){if(!arguments.length)return Ms;if(arguments.length<2)n=Ms;else if(typeof n!=="function")n=t.format(n);var i=Math.max(1,r*e/s.ticks().length);return function(e){var t=e/o(Math.round(a(e)));if(t*r<r-.5)t*=r;return t<=i?n(e):""}};s.copy=function(){return ws(e.copy(),r,n,i)};return ds(s,e)}var Ms=t.format(".0e"),As={floor:function(e){return-Math.ceil(-e)},ceil:function(e){return-Math.floor(-e)}};t.scale.pow=function(){return Ts(t.scale.linear(),1,[0,1])};function Ts(e,t,r){var n=ks(t),i=ks(1/t);function a(t){return e(n(t))}a.invert=function(t){return i(e.invert(t))};a.domain=function(t){if(!arguments.length)return r;e.domain((r=t.map(Number)).map(n));return a};a.ticks=function(e){return ms(r,e)};a.tickFormat=function(e,t){return ys(r,e,t)};a.nice=function(e){return a.domain(ps(r,e))};a.exponent=function(o){if(!arguments.length)return t;n=ks(t=o);i=ks(1/t);e.domain(r.map(n));return a};a.copy=function(){return Ts(e.copy(),t,r)};return ds(a,e)}function ks(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}t.scale.sqrt=function(){return t.scale.pow().exponent(.5)};t.scale.ordinal=function(){return Es([],{t:"range",a:[[]]})};function Es(e,r){var n,i,a;function o(t){return i[((n.get(t)||(r.t==="range"?n.set(t,e.push(t)):NaN))-1)%i.length]}function s(r,n){return t.range(e.length).map(function(e){return r+n*e})}o.domain=function(t){if(!arguments.length)return e;e=[];n=new w;var i=-1,a=t.length,s;while(++i<a)if(!n.has(s=t[i]))n.set(s,e.push(s));return o[r.t].apply(o,r.a)};o.range=function(e){if(!arguments.length)return i;i=e;a=0;r={t:"range",a:arguments};return o};o.rangePoints=function(t,n){if(arguments.length<2)n=0;var l=t[0],u=t[1],f=e.length<2?(l=(l+u)/2,0):(u-l)/(e.length-1+n);i=s(l+f*n/2,f);a=0;r={t:"rangePoints",a:arguments};return o};o.rangeRoundPoints=function(t,n){if(arguments.length<2)n=0;var l=t[0],u=t[1],f=e.length<2?(l=u=Math.round((l+u)/2),0):(u-l)/(e.length-1+n)|0;i=s(l+Math.round(f*n/2+(u-l-(e.length-1+n)*f)/2),f);a=0;r={t:"rangeRoundPoints",a:arguments};return o};o.rangeBands=function(t,n,l){if(arguments.length<2)n=0;if(arguments.length<3)l=n;var u=t[1]<t[0],f=t[u-0],c=t[1-u],h=(c-f)/(e.length-n+2*l);i=s(f+h*l,h);if(u)i.reverse();a=h*(1-n);r={t:"rangeBands",a:arguments};return o};o.rangeRoundBands=function(t,n,l){if(arguments.length<2)n=0;if(arguments.length<3)l=n;var u=t[1]<t[0],f=t[u-0],c=t[1-u],h=Math.floor((c-f)/(e.length-n+2*l));i=s(f+Math.round((c-f-(e.length-n)*h)/2),h);if(u)i.reverse();a=Math.round(h*(1-n));r={t:"rangeRoundBands",a:arguments};return o};o.rangeBand=function(){return a};o.rangeExtent=function(){return os(r.a[0])};o.copy=function(){return Es(e,r)};return o.domain(e)}t.scale.category10=function(){return t.scale.ordinal().range(Ss)};t.scale.category20=function(){return t.scale.ordinal().range(Ls)};t.scale.category20b=function(){return t.scale.ordinal().range(Cs)};t.scale.category20c=function(){return t.scale.ordinal().range(Is)};var Ss=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(pt);var Ls=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(pt);var Cs=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(pt);var Is=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(pt);t.scale.quantile=function(){return Ps([],[])};function Ps(e,r){var n;function i(){var i=0,o=r.length;n=[];while(++i<o)n[i-1]=t.quantile(e,i/o);return a}function a(e){if(!isNaN(e=+e))return r[t.bisect(n,e)]}a.domain=function(t){if(!arguments.length)return e;e=t.map(d).filter(p).sort(v);return i()};a.range=function(e){if(!arguments.length)return r;r=e;return i()};a.quantiles=function(){return n};a.invertExtent=function(t){t=r.indexOf(t);return t<0?[NaN,NaN]:[t>0?n[t-1]:e[0],t<n.length?n[t]:e[e.length-1]]};a.copy=function(){return Ps(e,r)};return i()}t.scale.quantize=function(){return Os(0,1,[0,1])};function Os(e,t,r){var n,i;function a(t){return r[Math.max(0,Math.min(i,Math.floor(n*(t-e))))]}function o(){n=r.length/(t-e);i=r.length-1;return a}a.domain=function(r){if(!arguments.length)return[e,t];e=+r[0];t=+r[r.length-1];return o()};a.range=function(e){if(!arguments.length)return r;r=e;return o()};a.invertExtent=function(t){t=r.indexOf(t);t=t<0?NaN:t/n+e;return[t,t+1/n]};a.copy=function(){return Os(e,t,r)};return o()}t.scale.threshold=function(){return Rs([.5],[0,1])};function Rs(e,r){function n(n){if(n<=n)return r[t.bisect(e,n)]}n.domain=function(t){if(!arguments.length)return e;e=t;return n};n.range=function(e){if(!arguments.length)return r;r=e;return n};n.invertExtent=function(t){t=r.indexOf(t);return[e[t-1],e[t]]};n.copy=function(){return Rs(e,r)};return n}t.scale.identity=function(){return Ns([0,1])};function Ns(e){function t(e){return+e}t.invert=t;t.domain=t.range=function(r){if(!arguments.length)return e;e=r.map(t);return t};t.ticks=function(t){return ms(e,t)};t.tickFormat=function(t,r){return ys(e,t,r)};t.copy=function(){return Ns(e)};return t}t.svg={};function zs(){return 0}t.svg.arc=function(){var e=Fs,t=js,r=zs,n=Ds,i=Bs,a=Us,o=Vs;function s(){var s=Math.max(0,+e.apply(this,arguments)),u=Math.max(0,+t.apply(this,arguments)),f=i.apply(this,arguments)-Pe,c=a.apply(this,arguments)-Pe,h=Math.abs(c-f),v=f>c?0:1;if(u<s)d=u,u=s,s=d;if(h>=Ie)return l(u,v)+(s?l(s,1-v):"")+"Z";var d,p,g,m,y=0,b=0,x,_,w,M,A,T,k,E,S=[];if(m=(+o.apply(this,arguments)||0)/2){g=n===Ds?Math.sqrt(s*s+u*u):+n.apply(this,arguments);if(!v)b*=-1;if(u)b=Fe(g/u*Math.sin(m));if(s)y=Fe(g/s*Math.sin(m))}if(u){x=u*Math.cos(f+b);_=u*Math.sin(f+b);w=u*Math.cos(c-b);M=u*Math.sin(c-b);var L=Math.abs(c-f-2*b)<=Le?0:1;if(b&&Hs(x,_,w,M)===v^L){var C=(f+c)/2;x=u*Math.cos(C);_=u*Math.sin(C);w=M=null}}else{x=_=0}if(s){A=s*Math.cos(c-y);T=s*Math.sin(c-y);k=s*Math.cos(f+y);E=s*Math.sin(f+y);var I=Math.abs(f-c+2*y)<=Le?0:1;if(y&&Hs(A,T,k,E)===1-v^I){var P=(f+c)/2;A=s*Math.cos(P);T=s*Math.sin(P);k=E=null}}else{A=T=0}if(h>Ee&&(d=Math.min(Math.abs(u-s)/2,+r.apply(this,arguments)))>.001){p=s<u^v?0:1;var O=d,R=d;if(h<Le){var N=k==null?[A,T]:w==null?[x,_]:Ci([x,_],[k,E],[w,M],[A,T]),z=x-N[0],D=_-N[1],F=w-N[0],j=M-N[1],B=1/Math.sin(Math.acos((z*F+D*j)/(Math.sqrt(z*z+D*D)*Math.sqrt(F*F+j*j)))/2),U=Math.sqrt(N[0]*N[0]+N[1]*N[1]);R=Math.min(d,(s-U)/(B-1));O=Math.min(d,(u-U)/(B+1))}if(w!=null){var V=qs(k==null?[A,T]:[k,E],[x,_],u,O,v),H=qs([w,M],[A,T],u,O,v);if(d===O){S.push("M",V[0],"A",O,",",O," 0 0,",p," ",V[1],"A",u,",",u," 0 ",1-v^Hs(V[1][0],V[1][1],H[1][0],H[1][1]),",",v," ",H[1],"A",O,",",O," 0 0,",p," ",H[0])}else{S.push("M",V[0],"A",O,",",O," 0 1,",p," ",H[0])}}else{S.push("M",x,",",_)}if(k!=null){var q=qs([x,_],[k,E],s,-R,v),G=qs([A,T],w==null?[x,_]:[w,M],s,-R,v);if(d===R){S.push("L",G[0],"A",R,",",R," 0 0,",p," ",G[1],"A",s,",",s," 0 ",v^Hs(G[1][0],G[1][1],q[1][0],q[1][1]),",",1-v," ",q[1],"A",R,",",R," 0 0,",p," ",q[0])}else{S.push("L",G[0],"A",R,",",R," 0 0,",p," ",q[0])}}else{S.push("L",A,",",T)}}else{S.push("M",x,",",_);if(w!=null)S.push("A",u,",",u," 0 ",L,",",v," ",w,",",M);S.push("L",A,",",T);if(k!=null)S.push("A",s,",",s," 0 ",I,",",1-v," ",k,",",E)}S.push("Z");return S.join("")}function l(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}s.innerRadius=function(t){if(!arguments.length)return e;e=At(t);return s};s.outerRadius=function(e){if(!arguments.length)return t;t=At(e);return s};s.cornerRadius=function(e){if(!arguments.length)return r;r=At(e);return s};s.padRadius=function(e){if(!arguments.length)return n;n=e==Ds?Ds:At(e);return s};s.startAngle=function(e){if(!arguments.length)return i;i=At(e);return s};s.endAngle=function(e){if(!arguments.length)return a;a=At(e);return s};s.padAngle=function(e){if(!arguments.length)return o;o=At(e);return s};s.centroid=function(){var r=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,n=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Pe;return[Math.cos(n)*r,Math.sin(n)*r]};return s};var Ds="auto";function Fs(e){return e.innerRadius}function js(e){return e.outerRadius}function Bs(e){return e.startAngle}function Us(e){return e.endAngle}function Vs(e){return e&&e.padAngle}function Hs(e,t,r,n){return(e-r)*t-(t-n)*e>0?0:1}function qs(e,t,r,n,i){var a=e[0]-t[0],o=e[1]-t[1],s=(i?n:-n)/Math.sqrt(a*a+o*o),l=s*o,u=-s*a,f=e[0]+l,c=e[1]+u,h=t[0]+l,v=t[1]+u,d=(f+h)/2,p=(c+v)/2,g=h-f,m=v-c,y=g*g+m*m,b=r-n,x=f*v-h*c,_=(m<0?-1:1)*Math.sqrt(Math.max(0,b*b*y-x*x)),w=(x*m-g*_)/y,M=(-x*g-m*_)/y,A=(x*m+g*_)/y,T=(-x*g+m*_)/y,k=w-d,E=M-p,S=A-d,L=T-p;if(k*k+E*E>S*S+L*L)w=A,M=T;return[[w-l,M-u],[w*r/b,M*r/b]]}function Gs(e){var t=Ai,r=Ti,n=sn,i=Xs,a=i.key,o=.7;function s(a){var s=[],l=[],u=-1,f=a.length,c,h=At(t),v=At(r);function d(){s.push("M",i(e(l),o))}while(++u<f){if(n.call(this,c=a[u],u)){l.push([+h.call(this,c,u),+v.call(this,c,u)])}else if(l.length){d();l=[]}}if(l.length)d();return s.length?s.join(""):null}s.x=function(e){if(!arguments.length)return t;t=e;return s};s.y=function(e){if(!arguments.length)return r;r=e;return s};s.defined=function(e){if(!arguments.length)return n;n=e;return s};s.interpolate=function(e){if(!arguments.length)return a;if(typeof e==="function")a=i=e;else a=(i=Ws.get(e)||Xs).key;return s};s.tension=function(e){if(!arguments.length)return o;o=e;return s};return s}t.svg.line=function(){return Gs(O)};var Ws=t.map({linear:Xs,"linear-closed":Ys,step:Zs,"step-before":Qs,"step-after":Ks,basis:nl,"basis-open":il,"basis-closed":al,bundle:ol,cardinal:el,"cardinal-open":Js,"cardinal-closed":$s,monotone:pl});Ws.forEach(function(e,t){t.key=e;t.closed=/-closed$/.test(e)});function Xs(e){return e.length>1?e.join("L"):e+"Z"}function Ys(e){return e.join("L")+"Z"}function Zs(e){var t=0,r=e.length,n=e[0],i=[n[0],",",n[1]];while(++t<r)i.push("H",(n[0]+(n=e[t])[0])/2,"V",n[1]);if(r>1)i.push("H",n[0]);return i.join("")}function Qs(e){var t=0,r=e.length,n=e[0],i=[n[0],",",n[1]];while(++t<r)i.push("V",(n=e[t])[1],"H",n[0]);return i.join("")}function Ks(e){var t=0,r=e.length,n=e[0],i=[n[0],",",n[1]];while(++t<r)i.push("H",(n=e[t])[0],"V",n[1]);return i.join("")}function Js(e,t){return e.length<4?Xs(e):e[1]+tl(e.slice(1,-1),rl(e,t))}function $s(e,t){return e.length<3?Ys(e):e[0]+tl((e.push(e[0]),e),rl([e[e.length-2]].concat(e,[e[1]]),t))}function el(e,t){return e.length<3?Xs(e):e[0]+tl(e,rl(e,t))}function tl(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2){return Xs(e)}var r=e.length!=t.length,n="",i=e[0],a=e[1],o=t[0],s=o,l=1;if(r){n+="Q"+(a[0]-o[0]*2/3)+","+(a[1]-o[1]*2/3)+","+a[0]+","+a[1];i=e[1];l=2}if(t.length>1){s=t[1];a=e[l];l++;n+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(a[0]-s[0])+","+(a[1]-s[1])+","+a[0]+","+a[1];for(var u=2;u<t.length;u++,l++){a=e[l];s=t[u];n+="S"+(a[0]-s[0])+","+(a[1]-s[1])+","+a[0]+","+a[1]}}if(r){var f=e[l];n+="Q"+(a[0]+s[0]*2/3)+","+(a[1]+s[1]*2/3)+","+f[0]+","+f[1]}return n}function rl(e,t){var r=[],n=(1-t)/2,i,a=e[0],o=e[1],s=1,l=e.length;while(++s<l){i=a;a=o;o=e[s];r.push([n*(o[0]-i[0]),n*(o[1]-i[1])])}return r}function nl(e){if(e.length<3)return Xs(e);var t=1,r=e.length,n=e[0],i=n[0],a=n[1],o=[i,i,i,(n=e[1])[0]],s=[a,a,a,n[1]],l=[i,",",a,"L",sl(fl,o),",",sl(fl,s)];e.push(e[r-1]);while(++t<=r){n=e[t];o.shift();o.push(n[0]);s.shift();s.push(n[1]);cl(l,o,s)}e.pop();l.push("L",n);return l.join("")}function il(e){if(e.length<4)return Xs(e);var t=[],r=-1,n=e.length,i,a=[0],o=[0];while(++r<3){i=e[r];a.push(i[0]);o.push(i[1])}t.push(sl(fl,a)+","+sl(fl,o));--r;while(++r<n){i=e[r];a.shift();a.push(i[0]);o.shift();o.push(i[1]);cl(t,a,o)}return t.join("")}function al(e){var t,r=-1,n=e.length,i=n+4,a,o=[],s=[];while(++r<4){a=e[r%n];o.push(a[0]);s.push(a[1])}t=[sl(fl,o),",",sl(fl,s)];--r;while(++r<i){a=e[r%n];o.shift();o.push(a[0]);s.shift();s.push(a[1]);cl(t,o,s)}return t.join("")}function ol(e,t){var r=e.length-1;if(r){var n=e[0][0],i=e[0][1],a=e[r][0]-n,o=e[r][1]-i,s=-1,l,u;while(++s<=r){l=e[s];u=s/r;l[0]=t*l[0]+(1-t)*(n+u*a);l[1]=t*l[1]+(1-t)*(i+u*o)}}return nl(e)}function sl(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}var ll=[0,2/3,1/3,0],ul=[0,1/3,2/3,0],fl=[0,1/6,2/3,1/6];function cl(e,t,r){e.push("C",sl(ll,t),",",sl(ll,r),",",sl(ul,t),",",sl(ul,r),",",sl(fl,t),",",sl(fl,r))}function hl(e,t){return(t[1]-e[1])/(t[0]-e[0])}function vl(e){var t=0,r=e.length-1,n=[],i=e[0],a=e[1],o=n[0]=hl(i,a);while(++t<r){n[t]=(o+(o=hl(i=a,a=e[t+1])))/2}n[t]=o;return n}function dl(e){var t=[],r,n,i,a,o=vl(e),s=-1,l=e.length-1;while(++s<l){r=hl(e[s],e[s+1]);if(b(r)<Ee){o[s]=o[s+1]=0}else{n=o[s]/r;i=o[s+1]/r;a=n*n+i*i;if(a>9){a=r*3/Math.sqrt(a);o[s]=a*n;o[s+1]=a*i}}}s=-1;while(++s<=l){a=(e[Math.min(l,s+1)][0]-e[Math.max(0,s-1)][0])/(6*(1+o[s]*o[s]));t.push([a||0,o[s]*a||0])}return t}function pl(e){return e.length<3?Xs(e):e[0]+tl(e,dl(e))}t.svg.line.radial=function(){var e=Gs(gl);e.radius=e.x,delete e.x;e.angle=e.y,delete e.y;return e};function gl(e){var t,r=-1,n=e.length,i,a;while(++r<n){t=e[r];i=t[0];a=t[1]-Pe;t[0]=i*Math.cos(a);t[1]=i*Math.sin(a)}return e}function ml(e){var t=Ai,r=Ai,n=0,i=Ti,a=sn,o=Xs,s=o.key,l=o,u="L",f=.7;function c(s){var c=[],h=[],v=[],d=-1,p=s.length,g,m=At(t),y=At(n),b=t===r?function(){return _}:At(r),x=n===i?function(){return w}:At(i),_,w;function M(){c.push("M",o(e(v),f),u,l(e(h.reverse()),f),"Z")}while(++d<p){if(a.call(this,g=s[d],d)){h.push([_=+m.call(this,g,d),w=+y.call(this,g,d)]);v.push([+b.call(this,g,d),+x.call(this,g,d)])}else if(h.length){M();h=[];v=[]}}if(h.length)M();return c.length?c.join(""):null}c.x=function(e){if(!arguments.length)return r;t=r=e;return c};c.x0=function(e){if(!arguments.length)return t;t=e;return c};c.x1=function(e){if(!arguments.length)return r;r=e;return c};c.y=function(e){if(!arguments.length)return i;n=i=e;return c};c.y0=function(e){if(!arguments.length)return n;n=e;return c};c.y1=function(e){if(!arguments.length)return i;i=e;return c};c.defined=function(e){if(!arguments.length)return a;a=e;return c};c.interpolate=function(e){if(!arguments.length)return s;if(typeof e==="function")s=o=e;else s=(o=Ws.get(e)||Xs).key;l=o.reverse||o;u=o.closed?"M":"L";return c};c.tension=function(e){if(!arguments.length)return f;f=e;return c};return c}Qs.reverse=Ks;Ks.reverse=Qs;t.svg.area=function(){return ml(O)};t.svg.area.radial=function(){var e=ml(gl);e.radius=e.x,delete e.x;e.innerRadius=e.x0,delete e.x0;e.outerRadius=e.x1,delete e.x1;e.angle=e.y,delete e.y;e.startAngle=e.y0,delete e.y0;e.endAngle=e.y1,delete e.y1;return e};t.svg.chord=function(){var e=si,t=li,r=yl,n=Bs,i=Us;function a(r,n){var i=o(this,e,r,n),a=o(this,t,r,n);return"M"+i.p0+l(i.r,i.p1,i.a1-i.a0)+(s(i,a)?u(i.r,i.p1,i.r,i.p0):u(i.r,i.p1,a.r,a.p0)+l(a.r,a.p1,a.a1-a.a0)+u(a.r,a.p1,i.r,i.p0))+"Z"}function o(e,t,a,o){var s=t.call(e,a,o),l=r.call(e,s,o),u=n.call(e,s,o)-Pe,f=i.call(e,s,o)-Pe;return{r:l,a0:u,a1:f,p0:[l*Math.cos(u),l*Math.sin(u)],p1:[l*Math.cos(f),l*Math.sin(f)]}}function s(e,t){return e.a0==t.a0&&e.a1==t.a1}function l(e,t,r){return"A"+e+","+e+" 0 "+ +(r>Le)+",1 "+t}function u(e,t,r,n){return"Q 0,0 "+n}a.radius=function(e){if(!arguments.length)return r;r=At(e);return a};a.source=function(t){if(!arguments.length)return e;e=At(t);return a};a.target=function(e){if(!arguments.length)return t;t=At(e);return a};a.startAngle=function(e){if(!arguments.length)return n;n=At(e);return a};a.endAngle=function(e){if(!arguments.length)return i;i=At(e);return a};return a};function yl(e){return e.radius}t.svg.diagonal=function(){var e=si,t=li,r=bl;function n(n,i){var a=e.call(this,n,i),o=t.call(this,n,i),s=(a.y+o.y)/2,l=[a,{x:a.x,y:s},{x:o.x,y:s},o];l=l.map(r);return"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}n.source=function(t){if(!arguments.length)return e;e=At(t);return n};n.target=function(e){if(!arguments.length)return t;t=At(e);return n};n.projection=function(e){if(!arguments.length)return r;r=e;return n};return n};function bl(e){return[e.x,e.y]}t.svg.diagonal.radial=function(){var e=t.svg.diagonal(),r=bl,n=e.projection;e.projection=function(e){return arguments.length?n(xl(r=e)):r};return e};function xl(e){return function(){var t=e.apply(this,arguments),r=t[0],n=t[1]-Pe;return[r*Math.cos(n),r*Math.sin(n)]}}t.svg.symbol=function(){var e=wl,t=_l;function r(r,n){return(Al.get(e.call(this,r,n))||Ml)(t.call(this,r,n))}r.type=function(t){if(!arguments.length)return e;e=At(t);return r};r.size=function(e){if(!arguments.length)return t;t=At(e);return r};return r};function _l(){return 64}function wl(){return"circle"}function Ml(e){var t=Math.sqrt(e/Le);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}var Al=t.map({circle:Ml,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*kl)),r=t*kl;return"M0,"+-t+"L"+r+",0"+" 0,"+t+" "+-r+",0"+"Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Tl),r=t*Tl/2;return"M0,"+r+"L"+t+","+-r+" "+-t+","+-r+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Tl),r=t*Tl/2;return"M0,"+-r+"L"+t+","+r+" "+-t+","+r+"Z"}});t.svg.symbolTypes=Al.keys();var Tl=Math.sqrt(3),kl=Math.tan(30*Oe);Z.transition=function(e){var t=Pl||++Il,r=zl(e),n=[],i,a,o=Ol||{time:Date.now(),ease:Na,delay:0,duration:250};for(var s=-1,l=this.length;++s<l;){n.push(i=[]);for(var u=this[s],f=-1,c=u.length;++f<c;){if(a=u[f])Dl(a,f,r,t,o);i.push(a)}}return Ll(n,r,t)};Z.interrupt=function(e){return this.each(e==null?El:Sl(zl(e)))};var El=Sl(zl());function Sl(e){return function(){var t,r,n;if((t=this[e])&&(n=t[r=t.active])){n.timer.c=null;n.timer.t=NaN;if(--t.count)delete t[r];else delete this[e];t.active+=.5;n.event&&n.event.interrupt.call(this,this.__data__,n.index)}}}function Ll(e,t,r){q(e,Cl);e.namespace=t;e.id=r;return e}var Cl=[],Il=0,Pl,Ol;Cl.call=Z.call;Cl.empty=Z.empty;Cl.node=Z.node;Cl.size=Z.size;t.transition=function(e,r){return e&&e.transition?Pl?e.transition(r):e:t.selection().transition(e)};t.transition.prototype=Cl;Cl.select=function(e){var t=this.id,r=this.namespace,n=[],i,a,o;e=Q(e);for(var s=-1,l=this.length;++s<l;){n.push(i=[]);for(var u=this[s],f=-1,c=u.length;++f<c;){if((o=u[f])&&(a=e.call(o,o.__data__,f,s))){if("__data__"in o)a.__data__=o.__data__;Dl(a,f,r,t,o[r][t]);i.push(a)}else{i.push(null)}}}return Ll(n,r,t)};Cl.selectAll=function(e){var t=this.id,r=this.namespace,n=[],i,a,o,s,l;e=K(e);for(var u=-1,f=this.length;++u<f;){for(var c=this[u],h=-1,v=c.length;++h<v;){if(o=c[h]){l=o[r][t];a=e.call(o,o.__data__,h,u);n.push(i=[]);for(var d=-1,p=a.length;++d<p;){if(s=a[d])Dl(s,d,r,t,l);i.push(s)}}}}return Ll(n,r,t)};Cl.filter=function(e){var t=[],r,n,i;if(typeof e!=="function")e=ce(e);for(var a=0,o=this.length;a<o;a++){t.push(r=[]);for(var n=this[a],s=0,l=n.length;s<l;s++){if((i=n[s])&&e.call(i,i.__data__,s,a)){r.push(i)}}}return Ll(t,this.namespace,this.id)};Cl.tween=function(e,t){var r=this.id,n=this.namespace;if(arguments.length<2)return this.node()[n][r].tween.get(e);return ve(this,t==null?function(t){t[n][r].tween.remove(e)}:function(i){i[n][r].tween.set(e,t)})};function Rl(e,t,r,n){var i=e.id,a=e.namespace;return ve(e,typeof r==="function"?function(e,o,s){e[a][i].tween.set(t,n(r.call(e,e.__data__,o,s)))}:(r=n(r),function(e){e[a][i].tween.set(t,r)}))}Cl.attr=function(e,r){if(arguments.length<2){for(r in e)this.attr(r,e[r]);return this}var n=e=="transform"?no:Ta,i=t.ns.qualify(e);function a(){this.removeAttribute(i)}function o(){this.removeAttributeNS(i.space,i.local)}function s(e){return e==null?a:(e+="",function(){var t=this.getAttribute(i),r;return t!==e&&(r=n(t,e),function(e){this.setAttribute(i,r(e))})})}function l(e){return e==null?o:(e+="",function(){var t=this.getAttributeNS(i.space,i.local),r;return t!==e&&(r=n(t,e),function(e){this.setAttributeNS(i.space,i.local,r(e))})})}return Rl(this,"attr."+e,r,i.local?l:s)};Cl.attrTween=function(e,r){var n=t.ns.qualify(e);function i(e,t){var i=r.call(this,e,t,this.getAttribute(n));return i&&function(e){this.setAttribute(n,i(e))}}function a(e,t){var i=r.call(this,e,t,this.getAttributeNS(n.space,n.local));return i&&function(e){this.setAttributeNS(n.space,n.local,i(e))}}return this.tween("attr."+e,n.local?a:i)};Cl.style=function(e,t,r){var n=arguments.length;if(n<3){if(typeof e!=="string"){if(n<2)t="";for(r in e)this.style(r,e[r],t);return this}r=""}function i(){this.style.removeProperty(e)}function a(t){return t==null?i:(t+="",function(){var n=s(this).getComputedStyle(this,null).getPropertyValue(e),i;return n!==t&&(i=Ta(n,t),function(t){this.style.setProperty(e,i(t),r)})})}return Rl(this,"style."+e,t,a)};Cl.styleTween=function(e,t,r){if(arguments.length<3)r="";function n(n,i){var a=t.call(this,n,i,s(this).getComputedStyle(this,null).getPropertyValue(e));return a&&function(t){this.style.setProperty(e,a(t),r)}}return this.tween("style."+e,n)};Cl.text=function(e){return Rl(this,"text",e,Nl)};function Nl(e){if(e==null)e="";return function(){this.textContent=e}}Cl.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;if(this[e].count<2&&(t=this.parentNode))t.removeChild(this)})};Cl.ease=function(e){var r=this.id,n=this.namespace;if(arguments.length<1)return this.node()[n][r].ease;if(typeof e!=="function")e=t.ease.apply(t,arguments);return ve(this,function(t){t[n][r].ease=e})};Cl.delay=function(e){var t=this.id,r=this.namespace;if(arguments.length<1)return this.node()[r][t].delay;return ve(this,typeof e==="function"?function(n,i,a){n[r][t].delay=+e.call(n,n.__data__,i,a)}:(e=+e,function(n){n[r][t].delay=e}))};Cl.duration=function(e){var t=this.id,r=this.namespace;if(arguments.length<1)return this.node()[r][t].duration;return ve(this,typeof e==="function"?function(n,i,a){n[r][t].duration=Math.max(1,e.call(n,n.__data__,i,a))}:(e=Math.max(1,e),function(n){n[r][t].duration=e}))};Cl.each=function(e,r){var n=this.id,i=this.namespace;if(arguments.length<2){var a=Ol,o=Pl;try{Pl=n;ve(this,function(t,r,a){Ol=t[i][n];e.call(t,t.__data__,r,a)})}finally{Ol=a;Pl=o}}else{ve(this,function(a){var o=a[i][n];(o.event||(o.event=t.dispatch("start","end","interrupt"))).on(e,r)})}return this};Cl.transition=function(){var e=this.id,t=++Il,r=this.namespace,n=[],i,a,o,s;for(var l=0,u=this.length;l<u;l++){n.push(i=[]);for(var a=this[l],f=0,c=a.length;f<c;f++){if(o=a[f]){s=o[r][e];Dl(o,f,r,t,{time:s.time,ease:s.ease,delay:s.delay+s.duration,duration:s.duration})}i.push(o)}}return Ll(n,r,t)};function zl(e){return e==null?"__transition__":"__transition_"+e+"__"}function Dl(e,t,r,n,i){var a=e[r]||(e[r]={active:0,count:0}),o=a[n],s,l,u,f,c;function h(e){var t=o.delay;l.t=t+s;if(t<=e)return v(e-t);l.c=v}function v(r){var i=a.active,h=a[i];if(h){h.timer.c=null;h.timer.t=NaN;--a.count;delete a[i];h.event&&h.event.interrupt.call(e,e.__data__,h.index)}for(var v in a){if(+v<n){var p=a[v];p.timer.c=null;p.timer.t=NaN;--a.count;delete a[v]}}l.c=d;Rt(function(){if(l.c&&d(r||1)){l.c=null;l.t=NaN}return 1},0,s);a.active=n;o.event&&o.event.start.call(e,e.__data__,t);c=[];o.tween.forEach(function(r,n){if(n=n.call(e,e.__data__,t)){c.push(n)}});f=o.ease;u=o.duration}function d(i){var s=i/u,l=f(s),h=c.length;while(h>0){c[--h].call(e,l)}if(s>=1){o.event&&o.event.end.call(e,e.__data__,t);if(--a.count)delete a[n];else delete e[r];return 1}}if(!o){s=i.time;l=Rt(h,0,s);o=a[n]={tween:new w,time:s,timer:l,delay:i.delay,duration:i.duration,ease:i.ease,index:t};i=null;++a.count}}t.svg.axis=function(){var e=t.scale.linear(),r=Fl,n=6,a=6,o=3,s=[10],l=null,u;function f(i){i.each(function(){var i=t.select(this);var f=this.__chart__||e,c=this.__chart__=e.copy();var h=l==null?c.ticks?c.ticks.apply(c,s):c.domain():l,v=u==null?c.tickFormat?c.tickFormat.apply(c,s):O:u,d=i.selectAll(".tick").data(h,c),p=d.enter().insert("g",".domain").attr("class","tick").style("opacity",Ee),g=t.transition(d.exit()).style("opacity",Ee).remove(),m=t.transition(d.order()).style("opacity",1),y=Math.max(n,0)+o,b;var x=ss(c),_=i.selectAll(".domain").data([0]),w=(_.enter().append("path").attr("class","domain"),t.transition(_));p.append("line");p.append("text");var M=p.select("line"),A=m.select("line"),T=d.select("text").text(v),k=p.select("text"),E=m.select("text"),S=r==="top"||r==="left"?-1:1,L,C,I,P;if(r==="bottom"||r==="top"){b=Bl,L="x",I="y",C="x2",P="y2";T.attr("dy",S<0?"0em":".71em").style("text-anchor","middle");w.attr("d","M"+x[0]+","+S*a+"V0H"+x[1]+"V"+S*a)}else{b=Ul,L="y",I="x",C="y2",P="x2";T.attr("dy",".32em").style("text-anchor",S<0?"end":"start");w.attr("d","M"+S*a+","+x[0]+"H0V"+x[1]+"H"+S*a)}M.attr(P,S*n);k.attr(I,S*y);A.attr(C,0).attr(P,S*n);E.attr(L,0).attr(I,S*y);if(c.rangeBand){var R=c,N=R.rangeBand()/2;f=c=function(e){return R(e)+N}}else if(f.rangeBand){f=c}else{g.call(b,c,f)}p.call(b,f,c);m.call(b,c,c)})}f.scale=function(t){if(!arguments.length)return e;e=t;return f};f.orient=function(e){if(!arguments.length)return r;r=e in jl?e+"":Fl;return f};f.ticks=function(){if(!arguments.length)return s;s=i(arguments);return f};f.tickValues=function(e){if(!arguments.length)return l;l=e;return f};f.tickFormat=function(e){if(!arguments.length)return u;u=e;return f};f.tickSize=function(e){var t=arguments.length;if(!t)return n;n=+e;a=+arguments[t-1];return f};f.innerTickSize=function(e){if(!arguments.length)return n;n=+e;return f};f.outerTickSize=function(e){if(!arguments.length)return a;a=+e;return f};f.tickPadding=function(e){if(!arguments.length)return o;o=+e;return f};f.tickSubdivide=function(){return arguments.length&&f};return f};var Fl="bottom",jl={top:1,right:1,bottom:1,left:1};function Bl(e,t,r){e.attr("transform",function(e){var n=t(e);return"translate("+(isFinite(n)?n:r(e))+",0)"})}function Ul(e,t,r){e.attr("transform",function(e){var n=t(e);return"translate(0,"+(isFinite(n)?n:r(e))+")"})}t.svg.brush=function(){var e=V(h,"brushstart","brush","brushend"),r=null,n=null,i=[0,0],a=[0,0],o,l,u=true,f=true,c=Hl[0];function h(e){e.each(function(){var e=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",g).on("touchstart.brush",g);var i=e.selectAll(".background").data([0]);i.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");e.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=e.selectAll(".resize").data(c,O);a.exit().remove();a.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Vl[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");a.style("display",h.empty()?"none":null);var o=t.transition(e),s=t.transition(i),l;if(r){l=ss(r);s.attr("x",l[0]).attr("width",l[1]-l[0]);d(o)}if(n){l=ss(n);s.attr("y",l[0]).attr("height",l[1]-l[0]);p(o)}v(o)})}h.event=function(r){r.each(function(){var r=e.of(this,arguments),n={x:i,y:a,i:o,j:l},s=this.__chart__||n;this.__chart__=n;if(Pl){t.select(this).transition().each("start.brush",function(){o=s.i;l=s.j;i=s.x;a=s.y;r({type:"brushstart"})}).tween("brush:brush",function(){var e=ka(i,n.x),t=ka(a,n.y);o=l=null;return function(o){i=n.x=e(o);a=n.y=t(o);r({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=n.i;l=n.j;r({type:"brush",mode:"resize"});r({type:"brushend"})})}else{r({type:"brushstart"});r({type:"brush",mode:"resize"});r({type:"brushend"})}})};function v(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+i[+/e$/.test(e)]+","+a[+/^s/.test(e)]+")"})}function d(e){e.select(".extent").attr("x",i[0]);e.selectAll(".extent,.n>rect,.s>rect").attr("width",i[1]-i[0])}function p(e){e.select(".extent").attr("y",a[0]);e.selectAll(".extent,.e>rect,.w>rect").attr("height",a[1]-a[0])}function g(){var c=this,g=t.select(t.event.target),m=e.of(c,arguments),y=t.select(c),b=g.datum(),x=!/^(n|s)$/.test(b)&&r,_=!/^(e|w)$/.test(b)&&n,w=g.classed("extent"),M=Me(c),A,T=t.mouse(c),k;var E=t.select(s(c)).on("keydown.brush",C).on("keyup.brush",I);if(t.event.changedTouches){E.on("touchmove.brush",P).on("touchend.brush",R)}else{E.on("mousemove.brush",P).on("mouseup.brush",R)}y.interrupt().selectAll("*").interrupt();if(w){T[0]=i[0]-T[0];T[1]=a[0]-T[1]}else if(b){var S=+/w$/.test(b),L=+/^n/.test(b);k=[i[1-S]-T[0],a[1-L]-T[1]];T[0]=i[S];T[1]=a[L]}else if(t.event.altKey)A=T.slice();y.style("pointer-events","none").selectAll(".resize").style("display",null);t.select("body").style("cursor",g.style("cursor"));m({type:"brushstart"});P();function C(){if(t.event.keyCode==32){if(!w){A=null;T[0]-=i[1];T[1]-=a[1];w=2}B()}}function I(){if(t.event.keyCode==32&&w==2){T[0]+=i[1];T[1]+=a[1];w=0;B()}}function P(){var e=t.mouse(c),o=false;if(k){e[0]+=k[0];e[1]+=k[1]}if(!w){if(t.event.altKey){if(!A)A=[(i[0]+i[1])/2,(a[0]+a[1])/2];T[0]=i[+(e[0]<A[0])];T[1]=a[+(e[1]<A[1])]}else A=null}if(x&&O(e,r,0)){d(y);o=true}if(_&&O(e,n,1)){p(y);o=true}if(o){v(y);m({type:"brush",mode:w?"move":"resize"})}}function O(e,t,r){var n=ss(t),s=n[0],c=n[1],h=T[r],v=r?a:i,d=v[1]-v[0],p,g;if(w){s-=h;c-=d+h}p=(r?f:u)?Math.max(s,Math.min(c,e[r])):e[r];if(w){g=(p+=h)+d}else{if(A)h=Math.max(s,Math.min(c,2*A[r]-p));if(h<p){g=p;p=h}else{g=h}}if(v[0]!=p||v[1]!=g){if(r)l=null;else o=null;v[0]=p;v[1]=g;return true}}function R(){P();y.style("pointer-events","all").selectAll(".resize").style("display",h.empty()?"none":null);t.select("body").style("cursor",null);E.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);M();m({type:"brushend"})}}h.x=function(e){if(!arguments.length)return r;r=e;c=Hl[!r<<1|!n];return h};h.y=function(e){if(!arguments.length)return n;n=e;c=Hl[!r<<1|!n];return h};h.clamp=function(e){if(!arguments.length)return r&&n?[u,f]:r?u:n?f:null;if(r&&n)u=!!e[0],f=!!e[1];else if(r)u=!!e;else if(n)f=!!e;return h};h.extent=function(e){var t,s,u,f,c;if(!arguments.length){if(r){if(o){t=o[0],s=o[1]}else{t=i[0],s=i[1];if(r.invert)t=r.invert(t),s=r.invert(s);if(s<t)c=t,t=s,s=c}}if(n){if(l){u=l[0],f=l[1]}else{u=a[0],f=a[1];if(n.invert)u=n.invert(u),f=n.invert(f);if(f<u)c=u,u=f,f=c}}return r&&n?[[t,u],[s,f]]:r?[t,s]:n&&[u,f]}if(r){t=e[0],s=e[1];if(n)t=t[0],s=s[0];o=[t,s];if(r.invert)t=r(t),s=r(s);if(s<t)c=t,t=s,s=c;if(t!=i[0]||s!=i[1])i=[t,s]}if(n){u=e[0],f=e[1];if(r)u=u[1],f=f[1];l=[u,f];if(n.invert)u=n(u),f=n(f);if(f<u)c=u,u=f,f=c;if(u!=a[0]||f!=a[1])a=[u,f]}return h};h.clear=function(){if(!h.empty()){i=[0,0],a=[0,0];o=l=null}return h};h.empty=function(){return!!r&&i[0]==i[1]||!!n&&a[0]==a[1]};return t.rebind(h,e,"on")};var Vl={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};var Hl=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];var ql=Gt.format=_r.timeFormat;var Gl=ql.utc;var Wl=Gl("%Y-%m-%dT%H:%M:%S.%LZ");ql.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Xl:Wl;function Xl(e){return e.toISOString()}Xl.parse=function(e){var t=new Date(e);return isNaN(t)?null:t};Xl.toString=Wl.toString;Gt.second=Zt(function(e){return new Wt(Math.floor(e/1e3)*1e3)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*1e3)},function(e){return e.getSeconds()});Gt.seconds=Gt.second.range;Gt.seconds.utc=Gt.second.utc.range;Gt.minute=Zt(function(e){return new Wt(Math.floor(e/6e4)*6e4)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*6e4)},function(e){return e.getMinutes()});Gt.minutes=Gt.minute.range;Gt.minutes.utc=Gt.minute.utc.range;Gt.hour=Zt(function(e){var t=e.getTimezoneOffset()/60;return new Wt((Math.floor(e/36e5-t)+t)*36e5)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*36e5)},function(e){return e.getHours()});Gt.hours=Gt.hour.range;Gt.hours.utc=Gt.hour.utc.range;Gt.month=Zt(function(e){e=Gt.day(e);e.setDate(1);return e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()});Gt.months=Gt.month.range;Gt.months.utc=Gt.month.utc.range;function Yl(e,r,n){function i(t){return e(t)}i.invert=function(t){return Zl(e.invert(t))};i.domain=function(t){if(!arguments.length)return e.domain().map(Zl);e.domain(t);return i};function a(e,n){var i=e[1]-e[0],a=i/n,o=t.bisect(Ql,a);return o==Ql.length?[r.year,gs(e.map(function(e){return e/31536e6}),n)[2]]:!o?[$l,gs(e,n)[2]]:r[a/Ql[o-1]<Ql[o]/a?o-1:o]}i.nice=function(e,t){var r=i.domain(),n=os(r),o=e==null?a(n,10):typeof e==="number"&&a(n,e);if(o)e=o[0],t=o[1];function s(r){return!isNaN(r)&&!e.range(r,Zl(+r+1),t).length}return i.domain(us(r,t>1?{floor:function(t){while(s(t=e.floor(t)))t=Zl(t-1);return t},ceil:function(t){while(s(t=e.ceil(t)))t=Zl(+t+1);return t}}:e))};i.ticks=function(e,t){var r=os(i.domain()),n=e==null?a(r,10):typeof e==="number"?a(r,e):!e.range&&[{range:e},t];if(n)e=n[0],t=n[1];return e.range(r[0],Zl(+r[1]+1),t<1?1:t)};i.tickFormat=function(){return n};i.copy=function(){return Yl(e.copy(),r,n)};return ds(i,e)}function Zl(e){return new Date(e)}var Ql=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6];var Kl=[[Gt.second,1],[Gt.second,5],[Gt.second,15],[Gt.second,30],[Gt.minute,1],[Gt.minute,5],[Gt.minute,15],[Gt.minute,30],[Gt.hour,1],[Gt.hour,3],[Gt.hour,6],[Gt.hour,12],[Gt.day,1],[Gt.day,2],[Gt.week,1],[Gt.month,1],[Gt.month,3],[Gt.year,1]];var Jl=ql.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&e.getDate()!=1}],["%b %d",function(e){return e.getDate()!=1}],["%B",function(e){return e.getMonth()}],["%Y",sn]]);var $l={range:function(e,r,n){return t.range(Math.ceil(e/n)*n,+r,n).map(Zl)},floor:O,ceil:O};Kl.year=Gt.year;Gt.scale=function(){return Yl(t.scale.linear(),Kl,Jl)};var eu=Kl.map(function(e){return[e[0].utc,e[1]]});var tu=Gl.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&e.getUTCDate()!=1}],["%b %d",function(e){return e.getUTCDate()!=1}],["%B",function(e){return e.getUTCMonth()}],["%Y",sn]]);eu.year=Gt.year.utc;Gt.scale.utc=function(){return Yl(t.scale.linear(),eu,tu)};t.text=Tt(function(e){return e.responseText});t.json=function(e,t){return kt(e,"application/json",ru,t)};function ru(e){return JSON.parse(e.responseText)}t.html=function(e,t){return kt(e,"text/html",nu,t)};function nu(e){var t=a.createRange();t.selectNode(a.body);return t.createContextualFragment(e.responseText)}t.xml=Tt(function(e){return e.responseXML});if(typeof e==="function"&&e.amd)this.d3=t,e(t);else if(typeof r==="object"&&r.exports)r.exports=t;else this.d3=t}()},{}],82:[function(e,t,r){t.exports=function(){for(var e=0;e<arguments.length;e++){if(arguments[e]!==undefined)return arguments[e]}}},{}],83:[function(e,t,r){"use strict";var n=e("incremental-convex-hull");var i=e("uniq");t.exports=l;function a(e,t){this.point=e;this.index=t}function o(e,t){var r=e.point;var n=t.point;var i=r.length;for(var a=0;a<i;++a){var o=n[a]-r[a];if(o){return o}}return 0}function s(e,t,r){if(e===1){if(r){return[[-1,0]]}else{return[]}}var n=t.map(function(e,t){return[e[0],t]});n.sort(function(e,t){return e[0]-t[0]});var i=new Array(e-1);for(var a=1;a<e;++a){var o=n[a-1];var s=n[a];i[a-1]=[o[1],s[1]]}if(r){i.push([-1,i[0][1]],[i[e-1][1],-1])}return i}function l(e,t){var r=e.length;if(r===0){return[]}var l=e[0].length;if(l<1){return[]}if(l===1){return s(r,e,t)}var u=new Array(r);var f=1;for(var c=0;c<r;++c){var h=e[c];var v=new Array(l+1);var d=0;for(var p=0;p<l;++p){var g=h[p];v[p]=g;d+=g*g}v[l]=d;u[c]=new a(v,c);f=Math.max(d,f)}i(u,o);r=u.length;var m=new Array(r+l+1);var y=new Array(r+l+1);var b=(l+1)*(l+1)*f;var x=new Array(l+1);for(var c=0;c<=l;++c){x[c]=0}x[l]=b;m[0]=x.slice();y[0]=-1;for(var c=0;c<=l;++c){var v=x.slice();v[c]=1;m[c+1]=v;y[c+1]=-1}for(var c=0;c<r;++c){var _=u[c];m[c+l+1]=_.point;y[c+l+1]=_.index}var w=n(m,false);if(t){w=w.filter(function(e){var t=0;for(var r=0;r<=l;++r){var n=y[e[r]];if(n<0){if(++t>=2){return false}}e[r]=n}return true})}else{w=w.filter(function(e){for(var t=0;t<=l;++t){var r=y[e[t]];if(r<0){return false}e[t]=r}return true})}if(l&1){for(var c=0;c<w.length;++c){var _=w[c];var v=_[0];_[0]=_[1];_[1]=v}}return w}},{"incremental-convex-hull":239,uniq:335}],84:[function(e,t,r){(function(e){var r=false;if(typeof Float64Array!=="undefined"){var n=new Float64Array(1),i=new Uint32Array(n.buffer);n[0]=1;r=true;if(i[1]===1072693248){t.exports=function e(t){n[0]=t;return[i[0],i[1]]};function a(e,t){i[0]=e;i[1]=t;return n[0]}t.exports.pack=a;function o(e){n[0]=e;return i[0]}t.exports.lo=o;function s(e){n[0]=e;return i[1]}t.exports.hi=s}else if(i[0]===1072693248){t.exports=function e(t){n[0]=t;return[i[1],i[0]]};function l(e,t){i[1]=e;i[0]=t;return n[0]}t.exports.pack=l;function u(e){n[0]=e;return i[1]}t.exports.lo=u;function f(e){n[0]=e;return i[0]}t.exports.hi=f}else{r=false}}if(!r){var c=new e(8);t.exports=function e(t){c.writeDoubleLE(t,0,true);return[c.readUInt32LE(0,true),c.readUInt32LE(4,true)]};function h(e,t){c.writeUInt32LE(e,0,true);c.writeUInt32LE(t,4,true);return c.readDoubleLE(0,true)}t.exports.pack=h;function v(e){c.writeDoubleLE(e,0,true);return c.readUInt32LE(0,true)}t.exports.lo=v;function d(e){c.writeDoubleLE(e,0,true);return c.readUInt32LE(4,true)}t.exports.hi=d}t.exports.sign=function(e){return t.exports.hi(e)>>>31};t.exports.exponent=function(e){var r=t.exports.hi(e);return(r<<1>>>21)-1023};t.exports.fraction=function(e){var r=t.exports.lo(e);var n=t.exports.hi(e);var i=n&(1<<20)-1;if(n&2146435072){i+=1<<20}return[r,i]};t.exports.denormalized=function(e){var r=t.exports.hi(e);return!(r&2146435072)}}).call(this,e("buffer").Buffer)},{buffer:48}],85:[function(e,t,r){t.exports=function(e){switch(e){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],86:[function(e,t,r){"use strict";function n(e,t,r){var i=e[r]|0;if(i<=0){return[]}var a=new Array(i),o;if(r===e.length-1){for(o=0;o<i;++o){a[o]=t}}else{for(o=0;o<i;++o){a[o]=n(e,t,r+1)}}return a}function i(e,t){var r,n;r=new Array(e);for(n=0;n<e;++n){r[n]=t}return r}function a(e,t){if(typeof t==="undefined"){t=0}switch(typeof e){case"number":if(e>0){return i(e|0,t)}break;case"object":if(typeof e.length==="number"){return n(e,t,0)}break}return[]}t.exports=a},{}],87:[function(e,t,r){"use strict";t.exports=i;var n=e("uniq");function i(e,t){var r=e.length;if(typeof t!=="number"){t=0;for(var i=0;i<r;++i){var a=e[i];t=Math.max(t,a[0],a[1])}t=(t|0)+1}t=t|0;var o=new Array(t);for(var i=0;i<t;++i){o[i]=[]}for(var i=0;i<r;++i){var a=e[i];o[a[0]].push(a[1]);o[a[1]].push(a[0])}for(var s=0;s<t;++s){n(o[s],function(e,t){return e-t})}return o}},{uniq:335}],88:[function(t,r,n){(function(i,a){(function(t,i){typeof n==="object"&&typeof r!=="undefined"?r.exports=i():typeof e==="function"&&e.amd?e(i):t.ES6Promise=i()})(this,function(){"use strict";function e(e){return typeof e==="function"||typeof e==="object"&&e!==null}function r(e){return typeof e==="function"}var n=undefined;if(!Array.isArray){n=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}else{n=Array.isArray}var o=n;var s=0;var l=undefined;var u=undefined;var f=function e(t,r){M[s]=t;M[s+1]=r;s+=2;if(s===2){if(u){u(A)}else{k()}}};function c(e){u=e}function h(e){f=e}var v=typeof window!=="undefined"?window:undefined;var d=v||{};var p=d.MutationObserver||d.WebKitMutationObserver;var g=typeof self==="undefined"&&typeof i!=="undefined"&&{}.toString.call(i)==="[object process]";var m=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function y(){return function(){return i.nextTick(A)}}function b(){return function(){l(A)}}function x(){var e=0;var t=new p(A);var r=document.createTextNode("");t.observe(r,{characterData:true});return function(){r.data=e=++e%2}}function _(){var e=new MessageChannel;e.port1.onmessage=A;return function(){return e.port2.postMessage(0)}}function w(){var e=setTimeout;return function(){return e(A,1)}}var M=new Array(1e3);function A(){for(var e=0;e<s;e+=2){var t=M[e];var r=M[e+1];t(r);M[e]=undefined;M[e+1]=undefined}s=0}function T(){try{var e=t;var r=e("vertx");l=r.runOnLoop||r.runOnContext;return b()}catch(e){return w()}}var k=undefined;if(g){k=y()}else if(p){k=x()}else if(m){k=_()}else if(v===undefined&&typeof t==="function"){k=T()}else{k=w()}function E(e,t){var r=arguments;var n=this;var i=new this.constructor(C);if(i[L]===undefined){te(i)}var a=n._state;if(a){(function(){var e=r[a-1];f(function(){return K(a,i,e,n._result)})})()}else{W(n,i,e,t)}return i}function S(e){var t=this;if(e&&typeof e==="object"&&e.constructor===t){return e}var r=new t(C);V(r,e);return r}var L=Math.random().toString(36).substring(16);function C(){}var I=void 0;var P=1;var O=2;var R=new Y;function N(){return new TypeError("You cannot resolve a promise with itself")}function z(){return new TypeError("A promises callback cannot return that same promise.")}function D(e){try{return e.then}catch(e){R.error=e;return R}}function F(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}function j(e,t,r){f(function(e){var n=false;var i=F(r,t,function(r){if(n){return}n=true;if(t!==r){V(e,r)}else{q(e,r)}},function(t){if(n){return}n=true;G(e,t)},"Settle: "+(e._label||" unknown promise"));if(!n&&i){n=true;G(e,i)}},e)}function B(e,t){if(t._state===P){q(e,t._result)}else if(t._state===O){G(e,t._result)}else{W(t,undefined,function(t){return V(e,t)},function(t){return G(e,t)})}}function U(e,t,n){if(t.constructor===e.constructor&&n===E&&t.constructor.resolve===S){B(e,t)}else{if(n===R){G(e,R.error)}else if(n===undefined){q(e,t)}else if(r(n)){j(e,t,n)}else{q(e,t)}}}function V(t,r){if(t===r){G(t,N())}else if(e(r)){U(t,r,D(r))}else{q(t,r)}}function H(e){if(e._onerror){e._onerror(e._result)}X(e)}function q(e,t){if(e._state!==I){return}e._result=t;e._state=P;if(e._subscribers.length!==0){f(X,e)}}function G(e,t){if(e._state!==I){return}e._state=O;e._result=t;f(H,e)}function W(e,t,r,n){var i=e._subscribers;var a=i.length;e._onerror=null;i[a]=t;i[a+P]=r;i[a+O]=n;if(a===0&&e._state){f(X,e)}}function X(e){var t=e._subscribers;var r=e._state;if(t.length===0){return}var n=undefined,i=undefined,a=e._result;for(var o=0;o<t.length;o+=3){n=t[o];i=t[o+r];if(n){K(r,n,i,a)}else{i(a)}}e._subscribers.length=0}function Y(){this.error=null}var Z=new Y;function Q(e,t){try{return e(t)}catch(e){Z.error=e;return Z}}function K(e,t,n,i){var a=r(n),o=undefined,s=undefined,l=undefined,u=undefined;if(a){o=Q(n,i);if(o===Z){u=true;s=o.error;o=null}else{l=true}if(t===o){G(t,z());return}}else{o=i;l=true}if(t._state!==I){}else if(a&&l){V(t,o)}else if(u){G(t,s)}else if(e===P){q(t,o)}else if(e===O){G(t,o)}}function J(e,t){try{t(function t(r){V(e,r)},function t(r){G(e,r)})}catch(t){G(e,t)}}var $=0;function ee(){return $++}function te(e){e[L]=$++;e._state=undefined;e._result=undefined;e._subscribers=[]}function re(e,t){this._instanceConstructor=e;this.promise=new e(C);if(!this.promise[L]){te(this.promise)}if(o(t)){this._input=t;this.length=t.length;this._remaining=t.length;this._result=new Array(this.length);if(this.length===0){q(this.promise,this._result)}else{this.length=this.length||0;this._enumerate();if(this._remaining===0){q(this.promise,this._result)}}}else{G(this.promise,ne())}}function ne(){return new Error("Array Methods must be provided an Array")}re.prototype._enumerate=function(){var e=this.length;var t=this._input;for(var r=0;this._state===I&&r<e;r++){this._eachEntry(t[r],r)}};re.prototype._eachEntry=function(e,t){var r=this._instanceConstructor;var n=r.resolve;if(n===S){var i=D(e);if(i===E&&e._state!==I){this._settledAt(e._state,t,e._result)}else if(typeof i!=="function"){this._remaining--;this._result[t]=e}else if(r===ue){var a=new r(C);U(a,e,i);this._willSettleAt(a,t)}else{this._willSettleAt(new r(function(t){return t(e)}),t)}}else{this._willSettleAt(n(e),t)}};re.prototype._settledAt=function(e,t,r){var n=this.promise;if(n._state===I){this._remaining--;if(e===O){G(n,r)}else{this._result[t]=r}}if(this._remaining===0){q(n,this._result)}};re.prototype._willSettleAt=function(e,t){var r=this;W(e,undefined,function(e){return r._settledAt(P,t,e)},function(e){return r._settledAt(O,t,e)})};function ie(e){return new re(this,e).promise}function ae(e){var t=this;if(!o(e)){return new t(function(e,t){return t(new TypeError("You must pass an array to race."))})}else{return new t(function(r,n){var i=e.length;for(var a=0;a<i;a++){t.resolve(e[a]).then(r,n)}})}}function oe(e){var t=this;var r=new t(C);G(r,e);return r}function se(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function le(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function ue(e){this[L]=ee();this._result=this._state=undefined;this._subscribers=[];if(C!==e){typeof e!=="function"&&se();this instanceof ue?J(this,e):le()}}ue.all=ie;ue.race=ae;ue.resolve=S;ue.reject=oe;ue._setScheduler=c;ue._setAsap=h;ue._asap=f;ue.prototype={constructor:ue,then:E,catch:function e(t){return this.then(null,t)}};function fe(){var e=undefined;if(typeof a!=="undefined"){e=a}else if(typeof self!=="undefined"){e=self}else{try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if(r==="[object Promise]"&&!t.cast){return}}e.Promise=ue}fe();ue.polyfill=fe;ue.Promise=ue;return ue})}).call(this,t("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:292}],89:[function(e,t,r){function n(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}t.exports=n;n.EventEmitter=n;n.prototype._events=undefined;n.prototype._maxListeners=undefined;n.defaultMaxListeners=10;n.prototype.setMaxListeners=function(e){if(!a(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};n.prototype.emit=function(e){var t,r,n,a,l,u;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||o(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}else{var f=new Error('Uncaught, unspecified "error" event. ('+t+")");f.context=t;throw f}}}r=this._events[e];if(s(r))return false;if(i(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1);r.apply(this,a)}}else if(o(r)){a=Array.prototype.slice.call(arguments,1);u=r.slice();n=u.length;for(l=0;l<n;l++)u[l].apply(this,a)}return true};n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,i(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(o(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(o(this._events[e])&&!this._events[e].warned){if(!s(this._maxListeners)){r=this._maxListeners}else{r=n.defaultMaxListeners}if(r&&r>0&&this._events[e].length>r){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};n.prototype.on=n.prototype.addListener;n.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var r=false;function n(){this.removeListener(e,n);if(!r){r=true;t.apply(this,arguments)}}n.listener=t;this.on(e,n);return this};n.prototype.removeListener=function(e,t){var r,n,a,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;r=this._events[e];a=r.length;n=-1;if(r===t||i(r.listener)&&r.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(o(r)){for(s=a;s-- >0;){if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}}if(n<0)return this;if(r.length===1){r.length=0;delete this._events[e]}else{r.splice(n,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}r=this._events[e];if(i(r)){this.removeListener(e,r)}else if(r){while(r.length)this.removeListener(e,r[r.length-1])}delete this._events[e];return this};n.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(i(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;else if(t)return t.length}return 0};n.listenerCount=function(e,t){return e.listenerCount(t)};function i(e){return typeof e==="function"}function a(e){return typeof e==="number"}function o(e){return typeof e==="object"&&e!==null}function s(e){return e===void 0}},{}],90:[function(e,t,r){"use strict";t.exports=n;function n(e,t,r){var n=t||0;var i=r||1;return[[e[12]+e[0],e[13]+e[1],e[14]+e[2],e[15]+e[3]],[e[12]-e[0],e[13]-e[1],e[14]-e[2],e[15]-e[3]],[e[12]+e[4],e[13]+e[5],e[14]+e[6],e[15]+e[7]],[e[12]-e[4],e[13]-e[5],e[14]-e[6],e[15]-e[7]],[n*e[12]+e[8],n*e[13]+e[9],n*e[14]+e[10],n*e[15]+e[11]],[i*e[12]-e[8],i*e[13]-e[9],i*e[14]-e[10],i*e[15]-e[11]]]}},{}],91:[function(e,t,r){"use strict";function n(e){var t=e.length,r;for(var n=0;n<t;n++){r=e.charCodeAt(n);if((r<9||r>13)&&r!==32&&r!==133&&r!==160&&r!==5760&&r!==6158&&(r<8192||r>8205)&&r!==8232&&r!==8233&&r!==8239&&r!==8287&&r!==8288&&r!==12288&&r!==65279){return false}}return true}t.exports=function(e){var t=typeof e;if(t==="string"){var r=e;e=+e;if(e===0&&n(r))return false}else if(t!=="number")return false;return e-e<1}},{}],92:[function(e,t,r){"use strict";t.exports=u;var n=e("cubic-hermite");var i=e("binary-search-bounds");function a(e,t,r){return Math.min(t,Math.max(e,r))}function o(e,t,r){this.dimension=e.length;this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var n=0;n<this.dimension;++n){this.bounds[0][n]=-Infinity;this.bounds[1][n]=Infinity}this._state=e.slice().reverse();this._velocity=t.slice().reverse();this._time=[r];this._scratch=[e.slice(),e.slice(),e.slice(),e.slice(),e.slice()]}var s=o.prototype;s.flush=function(e){var t=i.gt(this._time,e)-1;if(t<=0){return}this._time.splice(0,t);this._state.splice(0,t*this.dimension);this._velocity.splice(0,t*this.dimension)};s.curve=function(e){var t=this._time;var r=t.length;var o=i.le(t,e);var s=this._scratch[0];var l=this._state;var u=this._velocity;var f=this.dimension;var c=this.bounds;if(o<0){var h=f-1;for(var v=0;v<f;++v,--h){s[v]=l[h]}}else if(o>=r-1){var h=l.length-1;var d=e-t[r-1];for(var v=0;v<f;++v,--h){s[v]=l[h]+d*u[h]}}else{var h=f*(o+1)-1;var p=t[o];var g=t[o+1];var m=g-p||1;var y=this._scratch[1];var b=this._scratch[2];var x=this._scratch[3];var _=this._scratch[4];var w=true;for(var v=0;v<f;++v,--h){y[v]=l[h];x[v]=u[h]*m;b[v]=l[h+f];_[v]=u[h+f]*m;w=w&&(y[v]===b[v]&&x[v]===_[v]&&x[v]===0)}if(w){for(var v=0;v<f;++v){s[v]=y[v]}}else{n(y,x,b,_,(e-p)/m,s)}}var M=c[0];var A=c[1];for(var v=0;v<f;++v){s[v]=a(M[v],A[v],s[v])}return s};s.dcurve=function(e){var t=this._time;var r=t.length;var a=i.le(t,e);var o=this._scratch[0];var s=this._state;var l=this._velocity;var u=this.dimension;if(a>=r-1){var f=s.length-1;var c=e-t[r-1];for(var h=0;h<u;++h,--f){o[h]=l[f]}}else{var f=u*(a+1)-1;var v=t[a];var d=t[a+1];var p=d-v||1;var g=this._scratch[1];var m=this._scratch[2];var y=this._scratch[3];var b=this._scratch[4];var x=true;for(var h=0;h<u;++h,--f){g[h]=s[f];y[h]=l[f]*p;m[h]=s[f+u];b[h]=l[f+u]*p;x=x&&(g[h]===m[h]&&y[h]===b[h]&&y[h]===0)}if(x){for(var h=0;h<u;++h){o[h]=0}}else{n.derivative(g,y,m,b,(e-v)/p,o);for(var h=0;h<u;++h){o[h]/=p}}}return o};s.lastT=function(){var e=this._time;return e[e.length-1]};s.stable=function(){var e=this._velocity;var t=e.length;for(var r=this.dimension-1;r>=0;--r){if(e[--t]){return false}}return true};s.jump=function(e){var t=this.lastT();var r=this.dimension;if(e<t||arguments.length!==r+1){return}var n=this._state;var i=this._velocity;var o=n.length-this.dimension;var s=this.bounds;var l=s[0];var u=s[1];this._time.push(t,e);for(var f=0;f<2;++f){for(var c=0;c<r;++c){n.push(n[o++]);i.push(0)}}this._time.push(e);for(var c=r;c>0;--c){n.push(a(l[c-1],u[c-1],arguments[c]));i.push(0)}};s.push=function(e){var t=this.lastT();var r=this.dimension;if(e<t||arguments.length!==r+1){return}var n=this._state;var i=this._velocity;var o=n.length-this.dimension;var s=e-t;var l=this.bounds;var u=l[0];var f=l[1];var c=s>1e-6?1/s:0;this._time.push(e);for(var h=r;h>0;--h){var v=a(u[h-1],f[h-1],arguments[h]);n.push(v);i.push((v-n[o++])*c)}};s.set=function(e){var t=this.dimension;if(e<this.lastT()||arguments.length!==t+1){return}var r=this._state;var n=this._velocity;var i=this.bounds;var o=i[0];var s=i[1];this._time.push(e);for(var l=t;l>0;--l){r.push(a(o[l-1],s[l-1],arguments[l]));n.push(0)}};s.move=function(e){var t=this.lastT();var r=this.dimension;if(e<=t||arguments.length!==r+1){return}var n=this._state;var i=this._velocity;var o=n.length-this.dimension;var s=this.bounds;var l=s[0];var u=s[1];var f=e-t;var c=f>1e-6?1/f:0;this._time.push(e);for(var h=r;h>0;--h){var v=arguments[h];n.push(a(l[h-1],u[h-1],n[o++]+v));i.push(v*c)}};s.idle=function(e){var t=this.lastT();if(e<t){return}var r=this.dimension;var n=this._state;var i=this._velocity;var o=n.length-r;var s=this.bounds;var l=s[0];var u=s[1];var f=e-t;this._time.push(e);for(var c=r-1;c>=0;--c){n.push(a(l[c],u[c],n[o]+f*i[o]));i.push(0);o+=1}};function l(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=0}return t}function u(e,t,r){switch(arguments.length){case 0:return new o([0],[0],0);case 1:if(typeof e==="number"){var n=l(e);return new o(n,n,0)}else{return new o(e,l(e.length),0)}case 2:if(typeof t==="number"){var n=l(e.length);return new o(e,n,+t)}else{r=0}case 3:if(e.length!==t.length){throw new Error("state and velocity lengths must match")}return new o(e,t,r)}}},{"binary-search-bounds":36,"cubic-hermite":76}],93:[function(e,t,r){"use strict";t.exports=b;var n=0;var i=1;function a(e,t,r,n,i,a){this._color=e;this.key=t;this.value=r;this.left=n;this.right=i;this._count=a}function o(e){return new a(e._color,e.key,e.value,e.left,e.right,e._count)}function s(e,t){return new a(e,t.key,t.value,t.left,t.right,t._count)}function l(e){e._count=1+(e.left?e.left._count:0)+(e.right?e.right._count:0)}function u(e,t){this._compare=e;this.root=t}var f=u.prototype;Object.defineProperty(f,"keys",{get:function(){var e=[];this.forEach(function(t,r){e.push(t)});return e}});Object.defineProperty(f,"values",{get:function(){var e=[];this.forEach(function(t,r){e.push(r)});return e}});Object.defineProperty(f,"length",{get:function(){if(this.root){return this.root._count}return 0}});f.insert=function(e,t){var r=this._compare;var o=this.root;var f=[];var c=[];while(o){var h=r(e,o.key);f.push(o);c.push(h);if(h<=0){o=o.left}else{o=o.right}}f.push(new a(n,e,t,null,null,1));for(var v=f.length-2;v>=0;--v){var o=f[v];if(c[v]<=0){f[v]=new a(o._color,o.key,o.value,f[v+1],o.right,o._count+1)}else{f[v]=new a(o._color,o.key,o.value,o.left,f[v+1],o._count+1)}}for(var v=f.length-1;v>1;--v){var d=f[v-1];var o=f[v];if(d._color===i||o._color===i){break}var p=f[v-2];if(p.left===d){if(d.left===o){var g=p.right;if(g&&g._color===n){d._color=i;p.right=s(i,g);p._color=n;v-=1}else{p._color=n;p.left=d.right;d._color=i;d.right=p;f[v-2]=d;f[v-1]=o;l(p);l(d);if(v>=3){var m=f[v-3];if(m.left===p){m.left=d}else{m.right=d}}break}}else{var g=p.right;if(g&&g._color===n){d._color=i;p.right=s(i,g);p._color=n;v-=1}else{d.right=o.left;p._color=n;p.left=o.right;o._color=i;o.left=d;o.right=p;f[v-2]=o;f[v-1]=d;l(p);l(d);l(o);if(v>=3){var m=f[v-3];if(m.left===p){m.left=o}else{m.right=o}}break}}}else{if(d.right===o){var g=p.left;if(g&&g._color===n){d._color=i;p.left=s(i,g);p._color=n;v-=1}else{p._color=n;p.right=d.left;d._color=i;d.left=p;f[v-2]=d;f[v-1]=o;l(p);l(d);if(v>=3){var m=f[v-3];if(m.right===p){m.right=d}else{m.left=d}}break}}else{var g=p.left;if(g&&g._color===n){d._color=i;p.left=s(i,g);p._color=n;v-=1}else{d.left=o.right;p._color=n;p.right=o.left;o._color=i;o.right=d;o.left=p;f[v-2]=o;f[v-1]=d;l(p);l(d);l(o);if(v>=3){var m=f[v-3];if(m.right===p){m.right=o}else{m.left=o}}break}}}}f[0]._color=i;return new u(r,f[0])};function c(e,t){if(t.left){var r=c(e,t.left);if(r){return r}}var r=e(t.key,t.value);if(r){return r}if(t.right){return c(e,t.right)}}function h(e,t,r,n){var i=t(e,n.key);if(i<=0){if(n.left){var a=h(e,t,r,n.left);if(a){return a}}var a=r(n.key,n.value);if(a){return a}}if(n.right){return h(e,t,r,n.right)}}function v(e,t,r,n,i){var a=r(e,i.key);var o=r(t,i.key);var s;if(a<=0){if(i.left){s=v(e,t,r,n,i.left);if(s){return s}}if(o>0){s=n(i.key,i.value);if(s){return s}}}if(o>0&&i.right){return v(e,t,r,n,i.right)}}f.forEach=function e(t,r,n){if(!this.root){return}switch(arguments.length){case 1:return c(t,this.root);break;case 2:return h(r,this._compare,t,this.root);break;case 3:if(this._compare(r,n)>=0){return}return v(r,n,this._compare,t,this.root);break}};Object.defineProperty(f,"begin",{get:function(){var e=[];var t=this.root;while(t){e.push(t);t=t.left}return new d(this,e)}});Object.defineProperty(f,"end",{get:function(){var e=[];var t=this.root;while(t){e.push(t);t=t.right}return new d(this,e)}});f.at=function(e){if(e<0){return new d(this,[])}var t=this.root;var r=[];while(true){r.push(t);if(t.left){if(e<t.left._count){t=t.left;continue}e-=t.left._count}if(!e){return new d(this,r)}e-=1;if(t.right){if(e>=t.right._count){break}t=t.right}else{break}}return new d(this,[])};f.ge=function(e){var t=this._compare;var r=this.root;var n=[];var i=0;while(r){var a=t(e,r.key);n.push(r);if(a<=0){i=n.length}if(a<=0){r=r.left}else{r=r.right}}n.length=i;return new d(this,n)};f.gt=function(e){var t=this._compare;var r=this.root;var n=[];var i=0;while(r){var a=t(e,r.key);n.push(r);if(a<0){i=n.length}if(a<0){r=r.left}else{r=r.right}}n.length=i;return new d(this,n)};f.lt=function(e){var t=this._compare;var r=this.root;var n=[];var i=0;while(r){var a=t(e,r.key);n.push(r);if(a>0){i=n.length}if(a<=0){r=r.left}else{r=r.right}}n.length=i;return new d(this,n)};f.le=function(e){var t=this._compare;var r=this.root;var n=[];var i=0;while(r){var a=t(e,r.key);n.push(r);if(a>=0){i=n.length}if(a<0){r=r.left}else{r=r.right}}n.length=i;return new d(this,n)};f.find=function(e){var t=this._compare;var r=this.root;var n=[];while(r){var i=t(e,r.key);n.push(r);if(i===0){return new d(this,n)}if(i<=0){r=r.left}else{r=r.right}}return new d(this,[])};f.remove=function(e){var t=this.find(e);if(t){return t.remove()}return this};f.get=function(e){var t=this._compare;var r=this.root;while(r){var n=t(e,r.key);if(n===0){return r.value}if(n<=0){r=r.left}else{r=r.right}}return};function d(e,t){this.tree=e;this._stack=t}var p=d.prototype;Object.defineProperty(p,"valid",{get:function(){return this._stack.length>0}});Object.defineProperty(p,"node",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1]}return null},enumerable:true});p.clone=function(){return new d(this.tree,this._stack.slice())};function g(e,t){e.key=t.key;e.value=t.value;e.left=t.left;e.right=t.right;e._color=t._color;e._count=t._count}function m(e){var t,r,a,u;for(var f=e.length-1;f>=0;--f){t=e[f];if(f===0){t._color=i;return}r=e[f-1];if(r.left===t){a=r.right;if(a.right&&a.right._color===n){a=r.right=o(a);u=a.right=o(a.right);r.right=a.left;a.left=r;a.right=u;a._color=r._color;t._color=i;r._color=i;u._color=i;l(r);l(a);if(f>1){var c=e[f-2];if(c.left===r){c.left=a}else{c.right=a}}e[f-1]=a;return}else if(a.left&&a.left._color===n){a=r.right=o(a);u=a.left=o(a.left);r.right=u.left;a.left=u.right;u.left=r;u.right=a;u._color=r._color;r._color=i;a._color=i;t._color=i;l(r);l(a);l(u);if(f>1){var c=e[f-2];if(c.left===r){c.left=u}else{c.right=u}}e[f-1]=u;return}if(a._color===i){if(r._color===n){r._color=i;r.right=s(n,a);return}else{r.right=s(n,a);continue}}else{a=o(a);r.right=a.left;a.left=r;a._color=r._color;r._color=n;l(r);l(a);if(f>1){var c=e[f-2];if(c.left===r){c.left=a}else{c.right=a}}e[f-1]=a;e[f]=r;if(f+1<e.length){e[f+1]=t}else{e.push(t)}f=f+2}}else{a=r.left;if(a.left&&a.left._color===n){a=r.left=o(a);u=a.left=o(a.left);r.left=a.right;a.right=r;a.left=u;a._color=r._color;t._color=i;r._color=i;u._color=i;l(r);l(a);if(f>1){var c=e[f-2];if(c.right===r){c.right=a}else{c.left=a}}e[f-1]=a;return}else if(a.right&&a.right._color===n){a=r.left=o(a);u=a.right=o(a.right);r.left=u.right;a.right=u.left;u.right=r;u.left=a;u._color=r._color;r._color=i;a._color=i;t._color=i;l(r);l(a);l(u);if(f>1){var c=e[f-2];if(c.right===r){c.right=u}else{c.left=u}}e[f-1]=u;return}if(a._color===i){if(r._color===n){r._color=i;r.left=s(n,a);return}else{r.left=s(n,a);continue}}else{a=o(a);r.left=a.right;a.right=r;a._color=r._color;r._color=n;l(r);l(a);if(f>1){var c=e[f-2];if(c.right===r){c.right=a}else{c.left=a}}e[f-1]=a;e[f]=r;if(f+1<e.length){e[f+1]=t}else{e.push(t)}f=f+2}}}}p.remove=function(){var e=this._stack;if(e.length===0){return this.tree}var t=new Array(e.length);var r=e[e.length-1];t[t.length-1]=new a(r._color,r.key,r.value,r.left,r.right,r._count);for(var o=e.length-2;o>=0;--o){var r=e[o];if(r.left===e[o+1]){t[o]=new a(r._color,r.key,r.value,t[o+1],r.right,r._count)}else{t[o]=new a(r._color,r.key,r.value,r.left,t[o+1],r._count)}}r=t[t.length-1];if(r.left&&r.right){var s=t.length;r=r.left;while(r.right){t.push(r);r=r.right}var l=t[s-1];t.push(new a(r._color,l.key,l.value,r.left,r.right,r._count));t[s-1].key=r.key;t[s-1].value=r.value;for(var o=t.length-2;o>=s;--o){r=t[o];t[o]=new a(r._color,r.key,r.value,r.left,t[o+1],r._count)}t[s-1].left=t[s]}r=t[t.length-1];if(r._color===n){var f=t[t.length-2];if(f.left===r){f.left=null}else if(f.right===r){f.right=null}t.pop();for(var o=0;o<t.length;++o){t[o]._count--}return new u(this.tree._compare,t[0])}else{if(r.left||r.right){if(r.left){g(r,r.left)}else if(r.right){g(r,r.right)}r._color=i;for(var o=0;o<t.length-1;++o){t[o]._count--}return new u(this.tree._compare,t[0])}else if(t.length===1){return new u(this.tree._compare,null)}else{for(var o=0;o<t.length;++o){t[o]._count--}var c=t[t.length-2];m(t);if(c.left===r){c.left=null}else{c.right=null}}}return new u(this.tree._compare,t[0])};Object.defineProperty(p,"key",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1].key}return},enumerable:true});Object.defineProperty(p,"value",{get:function(){if(this._stack.length>0){return this._stack[this._stack.length-1].value}return},enumerable:true});Object.defineProperty(p,"index",{get:function(){var e=0;var t=this._stack;if(t.length===0){var r=this.tree.root;if(r){return r._count}return 0}else if(t[t.length-1].left){e=t[t.length-1].left._count}for(var n=t.length-2;n>=0;--n){if(t[n+1]===t[n].right){++e;if(t[n].left){e+=t[n].left._count}}}return e},enumerable:true});p.next=function(){var e=this._stack;if(e.length===0){return}var t=e[e.length-1];if(t.right){t=t.right;while(t){e.push(t);t=t.left}}else{e.pop();while(e.length>0&&e[e.length-1].right===t){t=e[e.length-1];e.pop()}}};Object.defineProperty(p,"hasNext",{get:function(){var e=this._stack;if(e.length===0){return false}if(e[e.length-1].right){return true}for(var t=e.length-1;t>0;--t){if(e[t-1].left===e[t]){return true}}return false}});p.update=function(e){var t=this._stack;if(t.length===0){throw new Error("Can't update empty node!")}var r=new Array(t.length);var n=t[t.length-1];r[r.length-1]=new a(n._color,n.key,e,n.left,n.right,n._count);for(var i=t.length-2;i>=0;--i){n=t[i];if(n.left===t[i+1]){r[i]=new a(n._color,n.key,n.value,r[i+1],n.right,n._count)}else{r[i]=new a(n._color,n.key,n.value,n.left,r[i+1],n._count)}}return new u(this.tree._compare,r[0])};p.prev=function(){var e=this._stack;if(e.length===0){return}var t=e[e.length-1];if(t.left){t=t.left;while(t){e.push(t);t=t.right}}else{e.pop();while(e.length>0&&e[e.length-1].left===t){t=e[e.length-1];e.pop()}}};Object.defineProperty(p,"hasPrev",{get:function(){var e=this._stack;if(e.length===0){return false}if(e[e.length-1].left){return true}for(var t=e.length-1;t>0;--t){if(e[t-1].right===e[t]){return true}}return false}});function y(e,t){if(e<t){return-1}if(e>t){return 1}return 0}function b(e){return new u(e||y,null)}},{}],94:[function(e,t,r){var n=7;var i=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];var a=607/128;var o=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function s(e){if(e<0)return Number("0/0");var t=o[0];for(var r=o.length-1;r>0;--r)t+=o[r]/(e+r);var n=e+a+.5;return.5*Math.log(2*Math.PI)+(e+.5)*Math.log(n)-n+Math.log(t)-Math.log(e)}t.exports=function e(t){if(t<.5){return Math.PI/(Math.sin(Math.PI*t)*e(1-t))}else if(t>100)return Math.exp(s(t));else{t-=1;var r=i[0];for(var a=1;a<n+2;a++){r+=i[a]/(t+a)}var o=t+n+.5;return Math.sqrt(2*Math.PI)*Math.pow(o,t+.5)*Math.exp(-o)*r}};t.exports.log=s},{}],95:[function(e,t,r){t.exports=n;function n(e,t){if(typeof e!=="string"){throw new TypeError("must specify type string")}t=t||{};if(typeof document==="undefined"&&!t.canvas){return null}var r=t.canvas||document.createElement("canvas");if(typeof t.width==="number"){r.width=t.width}if(typeof t.height==="number"){r.height=t.height}var n=t;var i;try{var a=[e];if(e.indexOf("webgl")===0){a.push("experimental-"+e)}for(var o=0;o<a.length;o++){i=r.getContext(a[o],n);if(i)return i}}catch(e){i=null}return i||null}},{}],96:[function(e,t,r){"use strict";t.exports=x;var n=e("./lib/text.js");var i=e("./lib/lines.js");var a=e("./lib/background.js");var o=e("./lib/cube.js");var s=e("./lib/ticks.js");var l=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function u(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}function f(e){this.gl=e;this.pixelRatio=1;this.bounds=[[-10,-10,-10],[10,10,10]];this.ticks=[[],[],[]];this.autoTicks=true;this.tickSpacing=[1,1,1];this.tickEnable=[true,true,true];this.tickFont=["sans-serif","sans-serif","sans-serif"];this.tickSize=[12,12,12];this.tickAngle=[0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[10,10,10];this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]};this.labels=["x","y","z"];this.labelEnable=[true,true,true];this.labelFont="sans-serif";this.labelSize=[20,20,20];this.labelAngle=[0,0,0];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[10,10,10];this.lineEnable=[true,true,true];this.lineMirror=[false,false,false];this.lineWidth=[1,1,1];this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.lineTickEnable=[true,true,true];this.lineTickMirror=[false,false,false];this.lineTickLength=[0,0,0];this.lineTickWidth=[1,1,1];this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.gridEnable=[true,true,true];this.gridWidth=[1,1,1];this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroEnable=[true,true,true];this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroLineWidth=[2,2,2];this.backgroundEnable=[false,false,false];this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]];this._firstInit=true;this._text=null;this._lines=null;this._background=a(e)}var c=f.prototype;c.update=function(e){e=e||{};function t(t,r,n){if(n in e){var i=e[n];var a=this[n];var o;if(t?Array.isArray(i)&&Array.isArray(i[0]):Array.isArray(i)){this[n]=o=[r(i[0]),r(i[1]),r(i[2])]}else{this[n]=o=[r(i),r(i),r(i)]}for(var s=0;s<3;++s){if(o[s]!==a[s]){return true}}}return false}var r=t.bind(this,false,Number);var a=t.bind(this,false,Boolean);var o=t.bind(this,false,String);var l=t.bind(this,true,function(e){if(Array.isArray(e)){if(e.length===3){return[+e[0],+e[1],+e[2],1]}else if(e.length===4){return[+e[0],+e[1],+e[2],+e[3]]}}return[0,0,0,1]});var u;var f=false;var c=false;if("bounds"in e){var h=e.bounds;e:for(var v=0;v<2;++v){for(var d=0;d<3;++d){if(h[v][d]!==this.bounds[v][d]){c=true}this.bounds[v][d]=h[v][d]}}}if("ticks"in e){u=e.ticks;f=true;this.autoTicks=false;for(var v=0;v<3;++v){this.tickSpacing[v]=0}}else if(r("tickSpacing")){this.autoTicks=true;c=true}if(this._firstInit){if(!("ticks"in e||"tickSpacing"in e)){this.autoTicks=true}c=true;f=true;this._firstInit=false}if(c&&this.autoTicks){u=s.create(this.bounds,this.tickSpacing);f=true}if(f){for(var v=0;v<3;++v){u[v].sort(function(e,t){return e.x-t.x})}if(s.equal(u,this.ticks)){f=false}else{this.ticks=u}}a("tickEnable");if(o("tickFont")){f=true}r("tickSize");r("tickAngle");r("tickPad");l("tickColor");var p=o("labels");if(o("labelFont")){p=true}a("labelEnable");r("labelSize");r("labelPad");l("labelColor");a("lineEnable");a("lineMirror");r("lineWidth");l("lineColor");a("lineTickEnable");a("lineTickMirror");r("lineTickLength");r("lineTickWidth");l("lineTickColor");a("gridEnable");r("gridWidth");l("gridColor");a("zeroEnable");l("zeroLineColor");r("zeroLineWidth");a("backgroundEnable");l("backgroundColor");if(!this._text){this._text=n(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont)}else if(this._text&&(p||f)){this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont)}if(this._lines&&f){this._lines.dispose();this._lines=null}if(!this._lines){this._lines=i(this.gl,this.bounds,this.ticks)}};function h(){this.primalOffset=[0,0,0];this.primalMinor=[0,0,0];this.mirrorOffset=[0,0,0];this.mirrorMinor=[0,0,0]}var v=[new h,new h,new h];function d(e,t,r,n,i){var a=e.primalOffset;var o=e.primalMinor;var s=e.mirrorOffset;var l=e.mirrorMinor;var u=n[t];for(var f=0;f<3;++f){if(t===f){continue}var c=a,h=s,v=o,d=l;if(u&1<<f){c=s;h=a;v=l;d=o}c[f]=r[0][f];h[f]=r[1][f];if(i[f]>0){v[f]=-1;d[f]=0}else{v[f]=0;d[f]=+1}}}var p=[0,0,0];var g={model:l,view:l,projection:l};c.isOpaque=function(){return true};c.isTransparent=function(){return false};c.drawTransparent=function(e){};var m=[0,0,0];var y=[0,0,0];var b=[0,0,0];c.draw=function(e){e=e||g;var t=this.gl;var r=e.model||l;var n=e.view||l;var i=e.projection||l;var a=this.bounds;var s=o(r,n,i,a);var f=s.cubeEdges;var c=s.axis;var h=n[12];var x=n[13];var _=n[14];var w=n[15];var M=this.pixelRatio*(i[3]*h+i[7]*x+i[11]*_+i[15]*w)/t.drawingBufferHeight;for(var A=0;A<3;++A){this.lastCubeProps.cubeEdges[A]=f[A];this.lastCubeProps.axis[A]=c[A]}var T=v;for(var A=0;A<3;++A){d(v[A],A,this.bounds,f,c)}var t=this.gl;var k=p;for(var A=0;A<3;++A){if(this.backgroundEnable[A]){k[A]=c[A]}else{k[A]=0}}this._background.draw(r,n,i,a,k,this.backgroundColor);this._lines.bind(r,n,i,this);for(var A=0;A<3;++A){var E=[0,0,0];if(c[A]>0){E[A]=a[1][A]}else{E[A]=a[0][A]}for(var S=0;S<2;++S){var L=(A+1+S)%3;var C=(A+1+(S^1))%3;if(this.gridEnable[L]){this._lines.drawGrid(L,C,this.bounds,E,this.gridColor[L],this.gridWidth[L]*this.pixelRatio)}}for(var S=0;S<2;++S){var L=(A+1+S)%3;var C=(A+1+(S^1))%3;if(this.zeroEnable[C]){if(a[0][C]<=0&&a[1][C]>=0){this._lines.drawZero(L,C,this.bounds,E,this.zeroLineColor[C],this.zeroLineWidth[C]*this.pixelRatio)}}}}for(var A=0;A<3;++A){if(this.lineEnable[A]){this._lines.drawAxisLine(A,this.bounds,T[A].primalOffset,this.lineColor[A],this.lineWidth[A]*this.pixelRatio)}if(this.lineMirror[A]){this._lines.drawAxisLine(A,this.bounds,T[A].mirrorOffset,this.lineColor[A],this.lineWidth[A]*this.pixelRatio)}var I=u(m,T[A].primalMinor);var P=u(y,T[A].mirrorMinor);var O=this.lineTickLength;var R=0;for(var S=0;S<3;++S){var N=M/r[5*S];I[S]*=O[S]*N;P[S]*=O[S]*N}if(this.lineTickEnable[A]){this._lines.drawAxisTicks(A,T[A].primalOffset,I,this.lineTickColor[A],this.lineTickWidth[A]*this.pixelRatio)}if(this.lineTickMirror[A]){this._lines.drawAxisTicks(A,T[A].mirrorOffset,P,this.lineTickColor[A],this.lineTickWidth[A]*this.pixelRatio)}}this._lines.unbind();this._text.bind(r,n,i,this.pixelRatio);for(var A=0;A<3;++A){var z=T[A].primalMinor;var D=u(b,T[A].primalOffset);for(var S=0;S<3;++S){if(this.lineTickEnable[A]){D[S]+=M*z[S]*Math.max(this.lineTickLength[S],0)/r[5*S]}}if(this.tickEnable[A]){for(var S=0;S<3;++S){D[S]+=M*z[S]*this.tickPad[S]/r[5*S]}this._text.drawTicks(A,this.tickSize[A],this.tickAngle[A],D,this.tickColor[A])}if(this.labelEnable[A]){for(var S=0;S<3;++S){D[S]+=M*z[S]*this.labelPad[S]/r[5*S]}D[A]+=.5*(a[0][A]+a[1][A]);this._text.drawLabel(A,this.labelSize[A],this.labelAngle[A],D,this.labelColor[A])}}this._text.unbind()};c.dispose=function(){this._text.dispose();this._lines.dispose();this._background.dispose();this._lines=null;this._text=null;this._background=null;this.gl=null};function x(e,t){var r=new f(e);r.update(t);return r}},{"./lib/background.js":97,"./lib/cube.js":98,"./lib/lines.js":99,"./lib/text.js":101,"./lib/ticks.js":102}],97:[function(e,t,r){"use strict";t.exports=l;var n=e("gl-buffer");var i=e("gl-vao");var a=e("./shaders").bg;function o(e,t,r,n){this.gl=e;this.buffer=t;this.vao=r;this.shader=n}var s=o.prototype;s.draw=function(e,t,r,n,i,a){var o=false;for(var s=0;s<3;++s){o=o||i[s]}if(!o){return}var l=this.gl;l.enable(l.POLYGON_OFFSET_FILL);l.polygonOffset(1,2);this.shader.bind();this.shader.uniforms={model:e,view:t,projection:r,bounds:n,enable:i,colors:a};this.vao.bind();this.vao.draw(this.gl.TRIANGLES,36);this.vao.unbind();l.disable(l.POLYGON_OFFSET_FILL)};s.dispose=function(){this.vao.dispose();this.buffer.dispose();this.shader.dispose()};function l(e){var t=[];var r=[];var s=0;for(var l=0;l<3;++l){var u=(l+1)%3;var f=(l+2)%3;var c=[0,0,0];var h=[0,0,0];for(var v=-1;v<=1;v+=2){r.push(s,s+2,s+1,s+1,s+2,s+3);c[l]=v;h[l]=v;for(var d=-1;d<=1;d+=2){c[u]=d;for(var p=-1;p<=1;p+=2){c[f]=p;t.push(c[0],c[1],c[2],h[0],h[1],h[2]);s+=1}}var g=u;u=f;f=g}}var m=n(e,new Float32Array(t));var y=n(e,new Uint16Array(r),e.ELEMENT_ARRAY_BUFFER);var b=i(e,[{buffer:m,type:e.FLOAT,size:3,offset:0,stride:24},{buffer:m,type:e.FLOAT,size:3,offset:12,stride:24}],y);var x=a(e);x.attributes.position.location=0;x.attributes.normal.location=1;return new o(e,m,b,x)}},{"./shaders":100,"gl-buffer":104,"gl-vao":166}],98:[function(e,t,r){"use strict";t.exports=x;var n=e("bit-twiddle");var i=e("gl-mat4/multiply");var a=e("gl-mat4/invert");var o=e("split-polygon");var s=e("robust-orientation");var l=new Array(16);var u=new Array(16);var f=new Array(8);var c=new Array(8);var h=new Array(3);var v=[0,0,0];(function(){for(var e=0;e<8;++e){f[e]=[1,1,1,1];c[e]=[1,1,1]}})();function d(e,t,r){for(var n=0;n<4;++n){e[n]=r[12+n];for(var i=0;i<3;++i){e[n]+=t[i]*r[4*i+n]}}}var p=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function g(e){for(var t=0;t<p.length;++t){e=o.positive(e,p[t]);if(e.length<3){return 0}}var r=e[0];var n=r[0]/r[3];var i=r[1]/r[3];var a=0;for(var t=1;t+1<e.length;++t){var s=e[t];var l=e[t+1];var u=s[0]/s[3];var f=s[1]/s[3];var c=l[0]/l[3];var h=l[1]/l[3];var v=u-n;var d=f-i;var g=c-n;var m=h-i;a+=Math.abs(v*m-d*g)}return a}var m=[1,1,1];var y=[0,0,0];var b={cubeEdges:m,axis:y};function x(e,t,r,a){i(l,t,e);i(l,r,l);var o=0;for(var u=0;u<2;++u){h[2]=a[u][2];for(var p=0;p<2;++p){h[1]=a[p][1];for(var x=0;x<2;++x){h[0]=a[x][0];d(f[o],h,l);o+=1}}}var _=-1;for(var u=0;u<8;++u){var w=f[u][3];for(var M=0;M<3;++M){c[u][M]=f[u][M]/w}if(w<0){if(_<0){_=u}else if(c[u][2]<c[_][2]){_=u}}}if(_<0){_=0;for(var A=0;A<3;++A){var T=(A+2)%3;var k=(A+1)%3;var E=-1;var S=-1;for(var L=0;L<2;++L){var C=L<<A;var I=C+(L<<T)+(1-L<<k);var P=C+(1-L<<T)+(L<<k);if(s(c[C],c[I],c[P],v)<0){continue}if(L){E=1}else{S=1}}if(E<0||S<0){if(S>E){_|=1<<A}continue}for(var L=0;L<2;++L){var C=L<<A;var I=C+(L<<T)+(1-L<<k);var P=C+(1-L<<T)+(L<<k);var O=g([f[C],f[I],f[P],f[C+(1<<T)+(1<<k)]]);if(L){E=O}else{S=O}}if(S>E){_|=1<<A;continue}}}var R=7^_;var N=-1;for(var u=0;u<8;++u){if(u===_||u===R){continue}if(N<0){N=u}else if(c[N][1]>c[u][1]){N=u}}var z=-1;for(var u=0;u<3;++u){var D=N^1<<u;if(D===_||D===R){continue}if(z<0){z=D}var k=c[D];if(k[0]<c[z][0]){z=D}}var F=-1;for(var u=0;u<3;++u){var D=N^1<<u;if(D===_||D===R||D===z){continue}if(F<0){F=D}var k=c[D];if(k[0]>c[F][0]){F=D}}var j=m;j[0]=j[1]=j[2]=0;j[n.log2(z^N)]=N&z;j[n.log2(N^F)]=N&F;var B=F^7;if(B===_||B===R){B=z^7;j[n.log2(F^B)]=B&F}else{j[n.log2(z^B)]=B&z}var U=y;var V=_;for(var A=0;A<3;++A){if(V&1<<A){U[A]=-1}else{U[A]=1}}return b}},{"bit-twiddle":37,"gl-mat4/invert":125,"gl-mat4/multiply":127,"robust-orientation":306,"split-polygon":323}],99:[function(e,t,r){"use strict";t.exports=p;var n=e("gl-buffer");var i=e("gl-vao");var a=e("./shaders").line;var o=[0,0,0];var s=[0,0,0];var l=[0,0,0];var u=[0,0,0];var f=[1,1];function c(e){e[0]=e[1]=e[2]=0;return e}function h(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}function v(e,t,r,n,i,a,o,s){this.gl=e;this.vertBuffer=t;this.vao=r;this.shader=n;this.tickCount=i;this.tickOffset=a;this.gridCount=o;this.gridOffset=s}var d=v.prototype;d.bind=function(e,t,r){this.shader.bind();this.shader.uniforms.model=e;this.shader.uniforms.view=t;this.shader.uniforms.projection=r;f[0]=this.gl.drawingBufferWidth;f[1]=this.gl.drawingBufferHeight;this.shader.uniforms.screenShape=f;this.vao.bind()};d.unbind=function(){this.vao.unbind()};d.drawAxisLine=function(e,t,r,n,i){var a=c(s);this.shader.uniforms.majorAxis=s;a[e]=t[1][e]-t[0][e];this.shader.uniforms.minorAxis=a;var o=h(u,r);o[e]+=t[0][e];this.shader.uniforms.offset=o;this.shader.uniforms.lineWidth=i;this.shader.uniforms.color=n;var f=c(l);f[(e+2)%3]=1;this.shader.uniforms.screenAxis=f;this.vao.draw(this.gl.TRIANGLES,6);var f=c(l);f[(e+1)%3]=1;this.shader.uniforms.screenAxis=f;this.vao.draw(this.gl.TRIANGLES,6)};d.drawAxisTicks=function(e,t,r,n,i){if(!this.tickCount[e]){return}var a=c(o);a[e]=1;this.shader.uniforms.majorAxis=a;this.shader.uniforms.offset=t;this.shader.uniforms.minorAxis=r;this.shader.uniforms.color=n;this.shader.uniforms.lineWidth=i;var s=c(l);s[e]=1;this.shader.uniforms.screenAxis=s;this.vao.draw(this.gl.TRIANGLES,this.tickCount[e],this.tickOffset[e])};d.drawGrid=function(e,t,r,n,i,a){if(!this.gridCount[e]){return}var f=c(s);f[t]=r[1][t]-r[0][t];this.shader.uniforms.minorAxis=f;var v=h(u,n);v[t]+=r[0][t];this.shader.uniforms.offset=v;var d=c(o);d[e]=1;this.shader.uniforms.majorAxis=d;var p=c(l);p[e]=1;this.shader.uniforms.screenAxis=p;this.shader.uniforms.lineWidth=a;this.shader.uniforms.color=i;this.vao.draw(this.gl.TRIANGLES,this.gridCount[e],this.gridOffset[e])};d.drawZero=function(e,t,r,n,i,a){var o=c(s);this.shader.uniforms.majorAxis=o;o[e]=r[1][e]-r[0][e];this.shader.uniforms.minorAxis=o;var f=h(u,n);f[e]+=r[0][e];this.shader.uniforms.offset=f;var v=c(l);v[t]=1;this.shader.uniforms.screenAxis=v;this.shader.uniforms.lineWidth=a;this.shader.uniforms.color=i;this.vao.draw(this.gl.TRIANGLES,6)};d.dispose=function(){this.vao.dispose();this.vertBuffer.dispose();this.shader.dispose()};function p(e,t,r){var o=[];var s=[0,0,0];var l=[0,0,0];var u=[0,0,0];var f=[0,0,0];o.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var c=0;c<3;++c){var h=o.length/3|0;for(var d=0;d<r[c].length;++d){var p=+r[c][d].x;o.push(p,0,1,p,1,1,p,0,-1,p,0,-1,p,1,1,p,1,-1)}var g=o.length/3|0;s[c]=h;l[c]=g-h;var h=o.length/3|0;for(var m=0;m<r[c].length;++m){var p=+r[c][m].x;o.push(p,0,1,p,1,1,p,0,-1,p,0,-1,p,1,1,p,1,-1)}var g=o.length/3|0;u[c]=h;f[c]=g-h}var y=n(e,new Float32Array(o));var b=i(e,[{buffer:y,type:e.FLOAT,size:3,stride:0,offset:0}]);var x=a(e);x.attributes.position.location=0;return new v(e,y,b,x,l,s,f,u)}},{"./shaders":100,"gl-buffer":104,"gl-vao":166}],100:[function(e,t,r){"use strict";var n=e("glslify");var i=e("gl-shader");var a=n(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);r.line=function(e){return i(e,a,o,null,[{name:"position",type:"vec3"}])};var s=n(["#define GLSLIFY 1\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvoid main() {  \n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n  mat2 planeXform = scale * mat2(cos(angle), sin(angle),\n                                -sin(angle), cos(angle));\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n  vec4 worldPosition = model * vec4(dataPosition, 1);\n  \n  //Compute clip position\n  vec4 viewPosition = view * worldPosition;\n  vec4 clipPosition = projection * viewPosition;\n  clipPosition /= clipPosition.w;\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec4(viewOffset, 0, 0);\n\n  //Done\n  gl_Position = clipPosition;\n}"]);var l=n(["precision mediump float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);r.text=function(e){return i(e,s,l,null,[{name:"position",type:"vec3"}])};var u=n(["#define GLSLIFY 1\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  if(dot(normal, enable) > 0.0) {\n    vec3 nPosition = mix(bounds[0], bounds[1], 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n  colorChannel = abs(normal);\n}"]);var f=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] + \n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);r.bg=function(e){return i(e,u,f,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":147,glslify:235}],101:[function(e,t,r){(function(r){"use strict";t.exports=m;var n=e("gl-buffer");var i=e("gl-vao");var a=e("vectorize-text");var o=e("./shaders").text;var s=window||r.global||{};var l=s.__TEXT_CACHE||{};s.__TEXT_CACHE={};var u=3;var f=u*4;function c(e,t,r,n){this.gl=e;this.shader=t;this.buffer=r;this.vao=n;this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var h=c.prototype;var v=[0,0];h.bind=function(e,t,r,n){this.vao.bind();this.shader.bind();var i=this.shader.uniforms;i.model=e;i.view=t;i.projection=r;i.pixelScale=n;v[0]=this.gl.drawingBufferWidth;v[1]=this.gl.drawingBufferHeight;this.shader.uniforms.resolution=v};h.unbind=function(){this.vao.unbind()};h.update=function(e,t,r,n,i){var a=this.gl;var o=[];function s(e,t,r,n){var i=l[r];if(!i){i=l[r]={}}var a=i[t];if(!a){a=i[t]=g(t,{triangles:true,font:r,textAlign:"center",textBaseline:"middle"})}var s=(n||12)/12;var u=a.positions;var f=a.cells;var c=[Infinity,Infinity];var h=[-Infinity,-Infinity];for(var v=0,d=f.length;v<d;++v){var p=f[v];for(var m=2;m>=0;--m){var y=u[p[m]];o.push(s*y[0],-s*y[1],e)}}}var f=[0,0,0];var c=[0,0,0];var h=[0,0,0];var v=[0,0,0];for(var d=0;d<3;++d){h[d]=o.length/u|0;s(.5*(e[0][d]+e[1][d]),t[d],r);v[d]=(o.length/u|0)-h[d];f[d]=o.length/u|0;for(var p=0;p<n[d].length;++p){if(!n[d][p].text){continue}s(n[d][p].x,n[d][p].text,n[d][p].font||i,n[d][p].fontSize||12)}c[d]=(o.length/u|0)-f[d]}this.buffer.update(o);this.tickOffset=f;this.tickCount=c;this.labelOffset=h;this.labelCount=v};var d=[0,0,0];h.drawTicks=function(e,t,r,n,i){if(!this.tickCount[e]){return}var a=d;a[0]=a[1]=a[2]=0;a[e]=1;this.shader.uniforms.axis=a;this.shader.uniforms.color=i;this.shader.uniforms.angle=r;this.shader.uniforms.scale=t;this.shader.uniforms.offset=n;this.vao.draw(this.gl.TRIANGLES,this.tickCount[e],this.tickOffset[e])};var p=[0,0,0];h.drawLabel=function(e,t,r,n,i){if(!this.labelCount[e]){return}this.shader.uniforms.axis=p;this.shader.uniforms.color=i;this.shader.uniforms.angle=r;this.shader.uniforms.scale=t;this.shader.uniforms.offset=n;this.vao.draw(this.gl.TRIANGLES,this.labelCount[e],this.labelOffset[e])};h.dispose=function(){this.shader.dispose();this.vao.dispose();this.buffer.dispose()};function g(e,t){try{return a(e,t)}catch(e){console.warn("error vectorizing text:",e);return{cells:[],positions:[]}}}function m(e,t,r,a,s,l){var u=n(e);var f=i(e,[{buffer:u,size:3}]);var h=o(e);h.attributes.position.location=0;var v=new c(e,h,u,f);v.update(t,r,a,s,l);return v}}).call(this,e("_process"))},{"./shaders":100,_process:292,"gl-buffer":104,"gl-vao":166,"vectorize-text":336}],102:[function(e,t,r){"use strict";r.create=i;r.equal=a;function n(e,t){var r=e+"";var n=r.indexOf(".");var i=0;if(n>=0){i=r.length-n-1}var a=Math.pow(10,i);var o=Math.round(e*t*a);var s=o+"";if(s.indexOf("e")>=0){return s}var l=o/a,u=o%a;if(o<0){l=-Math.ceil(l)|0;u=-u|0}else{l=Math.floor(l)|0;u=u|0}var f=""+l;if(o<0){f="-"+f}if(i){var c=""+u;while(c.length<i){c="0"+c}return f+"."+c}else{return f}}function i(e,t){var r=[];for(var i=0;i<3;++i){var a=[];var o=.5*(e[0][i]+e[1][i]);for(var s=0;s*t[i]<=e[1][i];++s){a.push({x:s*t[i],text:n(t[i],s)})}for(var s=-1;s*t[i]>=e[0][i];--s){a.push({x:s*t[i],text:n(t[i],s)})}r.push(a)}return r}function a(e,t){for(var r=0;r<3;++r){if(e[r].length!==t[r].length){return false}for(var n=0;n<e[r].length;++n){var i=e[r][n];var a=t[r][n];if(i.x!==a.x||i.text!==a.text||i.font!==a.font||i.fontColor!==a.fontColor||i.fontSize!==a.fontSize||i.dx!==a.dx||i.dy!==a.dy){return false}}}return true}},{}],103:[function(e,t,r){"use strict";t.exports=m;var n=e("extract-frustum-planes");var i=e("split-polygon");var a=e("./lib/cube.js");var o=e("gl-mat4/multiply");var s=e("gl-mat4/transpose");var l=e("gl-vec4/transformMat4");var u=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);var f=new Float32Array(16);function c(e,t,r){this.lo=e;this.hi=t;this.pixelsPerDataUnit=r}var h=[0,0,0,1];var v=[0,0,0,1];function d(e,t,r,n,i){for(var a=0;a<3;++a){var o=h;var s=v;for(var u=0;u<3;++u){s[u]=o[u]=r[u]}s[3]=o[3]=1;s[a]+=1;l(s,s,t);if(s[3]<0){e[a]=Infinity}o[a]-=1;l(o,o,t);if(o[3]<0){e[a]=Infinity}var f=(o[0]/o[3]-s[0]/s[3])*n;var c=(o[1]/o[3]-s[1]/s[3])*i;e[a]=.25*Math.sqrt(f*f+c*c)}return e}var p=[new c(Infinity,-Infinity,Infinity),new c(Infinity,-Infinity,Infinity),new c(Infinity,-Infinity,Infinity)];var g=[0,0,0];function m(e,t,r,l,c){var h=t.model||u;var v=t.view||u;var m=t.projection||u;var y=e.bounds;var c=c||a(h,v,m,y);var b=c.axis;var x=c.edges;o(f,v,h);o(f,m,f);var _=p;for(var w=0;w<3;++w){_[w].lo=Infinity;_[w].hi=-Infinity;_[w].pixelsPerDataUnit=Infinity}var M=n(s(f,f));s(f,f);for(var A=0;A<3;++A){var T=(A+1)%3;var k=(A+2)%3;var E=g;e:for(var w=0;w<2;++w){var S=[];if(b[A]<0===!!w){continue}E[A]=y[w][A];for(var L=0;L<2;++L){E[T]=y[L^w][T];for(var C=0;C<2;++C){E[k]=y[C^L^w][k];S.push(E.slice())}}for(var L=0;L<M.length;++L){if(S.length===0){continue e}S=i.positive(S,M[L])}for(var L=0;L<S.length;++L){var k=S[L];var I=d(g,f,k,r,l);for(var C=0;C<3;++C){_[C].lo=Math.min(_[C].lo,k[C]);_[C].hi=Math.max(_[C].hi,k[C]);if(C!==A){_[C].pixelsPerDataUnit=Math.min(_[C].pixelsPerDataUnit,Math.abs(I[C]))}}}}}return _}},{"./lib/cube.js":98,"extract-frustum-planes":90,"gl-mat4/multiply":127,"gl-mat4/transpose":135,"gl-vec4/transformMat4":224,"split-polygon":323}],104:[function(e,t,r){"use strict";var n=e("typedarray-pool");var i=e("ndarray-ops");var a=e("ndarray");var o=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function s(e,t,r,n,i){this.gl=e;this.type=t;this.handle=r;this.length=n;this.usage=i}var l=s.prototype;l.bind=function(){this.gl.bindBuffer(this.type,this.handle)};l.unbind=function(){this.gl.bindBuffer(this.type,null)};l.dispose=function(){this.gl.deleteBuffer(this.handle)};function u(e,t,r,n,i,a){var o=i.length*i.BYTES_PER_ELEMENT;if(a<0){e.bufferData(t,i,n);return o}if(o+a>r){throw new Error("gl-buffer: If resizing buffer, must not specify offset")}e.bufferSubData(t,a,i);return r}function f(e,t){var r=n.malloc(e.length,t);var i=e.length;for(var a=0;a<i;++a){r[a]=e[a]}return r}function c(e,t){var r=1;for(var n=t.length-1;n>=0;--n){if(t[n]!==r){return false}r*=e[n]}return true}l.update=function(e,t){if(typeof t!=="number"){t=-1}this.bind();if(typeof e==="object"&&typeof e.shape!=="undefined"){var r=e.dtype;if(o.indexOf(r)<0){r="float32"}if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){var s=gl.getExtension("OES_element_index_uint");if(s&&r!=="uint16"){r="uint32"}else{r="uint16"}}if(r===e.dtype&&c(e.shape,e.stride)){if(e.offset===0&&e.data.length===e.shape[0]){this.length=u(this.gl,this.type,this.length,this.usage,e.data,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,e.data.subarray(e.offset,e.shape[0]),t)}}else{var l=n.malloc(e.size,r);var h=a(l,e.shape);i.assign(h,e);if(t<0){this.length=u(this.gl,this.type,this.length,this.usage,l,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,l.subarray(0,e.size),t)}n.free(l)}}else if(Array.isArray(e)){var v;if(this.type===this.gl.ELEMENT_ARRAY_BUFFER){v=f(e,"uint16")}else{v=f(e,"float32")}if(t<0){this.length=u(this.gl,this.type,this.length,this.usage,v,t)}else{this.length=u(this.gl,this.type,this.length,this.usage,v.subarray(0,e.length),t)}n.free(v)}else if(typeof e==="object"&&typeof e.length==="number"){this.length=u(this.gl,this.type,this.length,this.usage,e,t)}else if(typeof e==="number"||e===undefined){if(t>=0){throw new Error("gl-buffer: Cannot specify offset when resizing buffer")}e=e|0;if(e<=0){e=1}this.gl.bufferData(this.type,e|0,this.usage);this.length=e}else{throw new Error("gl-buffer: Invalid data type")}};function h(e,t,r,n){r=r||e.ARRAY_BUFFER;n=n||e.DYNAMIC_DRAW;if(r!==e.ARRAY_BUFFER&&r!==e.ELEMENT_ARRAY_BUFFER){throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER")}if(n!==e.DYNAMIC_DRAW&&n!==e.STATIC_DRAW&&n!==e.STREAM_DRAW){throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW")}var i=e.createBuffer();var a=new s(e,r,i,0,n);a.update(t);return a}t.exports=h},{ndarray:270,"ndarray-ops":264,"typedarray-pool":333}],105:[function(e,t,r){"use strict";var n=e("gl-vec3");var i=e("gl-vec4");var a=function(e,t,r){var i=n.create();if(e!==undefined){n.set(i,e,t,r)}return i};var o=function(e){var t=e[0],r=e[1],n=e[2];var i=[];for(var a=0;a<n.length;a++){for(var o=0;o<r.length;o++){for(var s=0;s<t.length;s++){i.push([n[a],r[o],t[s]])}}}return i};var s=function(e,t){for(var r=0;r<e.length;r++){if(e[r]>=t){return r-1}}return r};var l=n.create();var u=n.create();var f=function(e,t,r){return e<t?t:e>r?r:e};var c=function(e,t,r,i){var a=e[0];var o=e[1];var c=e[2];var h=r[0].length;var v=r[1].length;var d=r[2].length;var p=s(r[0],a);var g=s(r[1],o);var m=s(r[2],c);var y=p+1;var b=g+1;var x=m+1;if(i){p=f(p,0,h-1);y=f(y,0,h-1);g=f(g,0,v-1);b=f(b,0,v-1);m=f(m,0,d-1);x=f(x,0,d-1)}if(p<0||g<0||m<0||y>=h||b>=v||x>=d){return n.create()}var _=(a-r[0][p])/(r[0][y]-r[0][p]);var w=(o-r[1][g])/(r[1][b]-r[1][g]);var M=(c-r[2][m])/(r[2][x]-r[2][m]);if(_<0||_>1||isNaN(_))_=0;if(w<0||w>1||isNaN(w))w=0;if(M<0||M>1||isNaN(M))M=0;var A=m*h*v;var T=x*h*v;var k=g*h;var E=b*h;var S=p;var L=y;var C=t[k+A+S];var I=t[k+A+L];var P=t[E+A+S];var O=t[E+A+L];var R=t[k+T+S];var N=t[k+T+L];var z=t[E+T+S];var D=t[E+T+L];var F=n.create();n.lerp(F,C,I,_);n.lerp(l,P,O,_);n.lerp(F,F,l,w);n.lerp(l,R,N,_);n.lerp(u,z,D,_);n.lerp(l,l,u,w);n.lerp(F,F,l,M);return F};var h=function(e,t){if(t[0]===0&&t[1]===0){n.set(e,0,1,0)}else{n.set(e,-t[1],t[0],0)}return e};t.exports=function(e,t){var r;if(e.positions){r=e.positions}else{r=o(e.meshgrid)}var i=e.meshgrid;var s=e.vectors;var l={positions:[],vertexIntensity:[],vertexIntensityBounds:e.vertexIntensityBounds,vertexNormals:[],vectors:[],cells:[],coneOffset:e.coneOffset,colormap:e.colormap};if(e.positions.length===0){if(t){t[0]=[0,0,0];t[1]=[0,0,0]}return l}var u=0;var f=1/0,h=-1/0;var v=1/0,d=-1/0;var p=1/0,g=-1/0;var m=null;var y=null;var b=[];var x=1/0;for(var _=0;_<r.length;_++){var w=r[_];f=Math.min(w[0],f);h=Math.max(w[0],h);v=Math.min(w[1],v);d=Math.max(w[1],d);p=Math.min(w[2],p);g=Math.max(w[2],g);var M;if(i){M=c(w,s,i,true)}else{M=s[_]}if(n.length(M)>u){u=n.length(M)}if(_){x=Math.min(x,2*n.distance(m,w)/(n.length(y)+n.length(M)))}m=w;y=M;b.push(M)}var A=[f,v,p];var T=[h,d,g];if(t){t[0]=A;t[1]=T}if(u===0){u=1}var k=1/u;if(!isFinite(x)||isNaN(x)){x=1}l.vectorScale=x;var E=a(0,1,0);var S=e.coneSize||.5;if(e.absoluteConeSize){S=e.absoluteConeSize*k}l.coneScale=S;for(var _=0,L=0;_<r.length;_++){var w=r[_];var C=w[0],I=w[1],P=w[2];var O=b[_];var R=n.length(O)*k;for(var N=0,z=8;N<z;N++){l.positions.push([C,I,P,L++]);l.positions.push([C,I,P,L++]);l.positions.push([C,I,P,L++]);l.positions.push([C,I,P,L++]);l.positions.push([C,I,P,L++]);l.positions.push([C,I,P,L++]);l.vectors.push(O);l.vectors.push(O);l.vectors.push(O);l.vectors.push(O);l.vectors.push(O);l.vectors.push(O);l.vertexIntensity.push(R,R,R);l.vertexIntensity.push(R,R,R);l.vertexNormals.push(E,E,E);l.vertexNormals.push(E,E,E);var D=l.positions.length;l.cells.push([D-6,D-5,D-4],[D-3,D-2,D-1])}}return l};t.exports.createConeMesh=e("./lib/conemesh")},{"./lib/conemesh":107,"gl-vec3":178,"gl-vec4":208}],106:[function(e,t,r){"use strict";var n=e("barycentric");var i=e("polytope-closest-point/lib/closest_point_2d.js");t.exports=u;function a(e,t){var r=[0,0,0,0];for(var n=0;n<4;++n){for(var i=0;i<4;++i){r[i]+=e[4*n+i]*t[n]}}return r}function o(e,t,r,n,i){var o=a(n,a(r,a(t,[e[0],e[1],e[2],1])));for(var s=0;s<3;++s){o[s]/=o[3]}return[.5*i[0]*(1+o[0]),.5*i[1]*(1-o[1])]}function s(e,t){if(e.length===2){var r=0;var a=0;for(var o=0;o<2;++o){r+=Math.pow(t[o]-e[0][o],2);a+=Math.pow(t[o]-e[1][o],2)}r=Math.sqrt(r);a=Math.sqrt(a);if(r+a<1e-6){return[1,0]}return[a/(r+a),r/(a+r)]}else if(e.length===3){var s=[0,0];i(e[0],e[1],e[2],t,s);return n(e,s)}return[]}function l(e,t){var r=[0,0,0];for(var n=0;n<e.length;++n){var i=e[n];var a=t[n];for(var o=0;o<3;++o){r[o]+=a*i[o]}}return r}function u(e,t,r,n,i,a){if(e.length===1){return[0,e[0].slice()]}var u=new Array(e.length);for(var f=0;f<e.length;++f){u[f]=o(e[f],r,n,i,a)}var c=0;var h=Infinity;for(var f=0;f<u.length;++f){var v=0;for(var d=0;d<2;++d){v+=Math.pow(u[f][d]-t[d],2)}if(v<h){h=v;c=f}}var p=s(u,t);var g=0;for(var f=0;f<3;++f){if(p[f]<-.001||p[f]>1.0001){return null}g+=p[f]}if(Math.abs(g-1)>.001){return null}return[c,l(e,p),p]}},{barycentric:18,"polytope-closest-point/lib/closest_point_2d.js":291}],107:[function(e,t,r){"use strict";var n=1e-6;var i=1e-6;var a=e("gl-shader");var o=e("gl-buffer");var s=e("gl-vao");var l=e("gl-texture2d");var u=e("normals");var f=e("gl-mat4/multiply");var c=e("gl-mat4/invert");var h=e("ndarray");var v=e("colormap");var d=e("simplicial-complex-contour");var p=e("typedarray-pool");var g=e("./shaders");var m=e("./closest-point");var y=g.meshShader;var b=g.pickShader;var x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function _(e,t,r,n,i,a,o,s,l,u,f,c,h,v,d,p,g,m,y,b,_,w,M,A,T,k,E,S){this.gl=e;this.cells=[];this.positions=[];this.intensity=[];this.texture=t;this.dirty=true;this.triShader=r;this.lineShader=n;this.pointShader=i;this.pickShader=a;this.pointPickShader=o;this.contourShader=s;this.trianglePositions=l;this.triangleVectors=u;this.triangleColors=c;this.triangleNormals=v;this.triangleUVs=h;this.triangleIds=f;this.triangleVAO=d;this.triangleCount=0;this.lineWidth=1;this.edgePositions=p;this.edgeColors=m;this.edgeUVs=y;this.edgeIds=g;this.edgeVAO=b;this.edgeCount=0;this.pointPositions=_;this.pointColors=M;this.pointUVs=A;this.pointSizes=T;this.pointIds=w;this.pointVAO=k;this.pointCount=0;this.contourLineWidth=1;this.contourPositions=E;this.contourVAO=S;this.contourCount=0;this.contourColor=[0,0,0];this.contourEnable=true;this.pickId=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lightPosition=[1e5,1e5,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.opacity=1;this.coneScale=2;this.vectorScale=1;this.coneOffset=1/4;this._model=x;this._view=x;this._projection=x;this._resolution=[1,1]}var w=_.prototype;w.isOpaque=function(){return this.opacity>=1};w.isTransparent=function(){return this.opacity<1};w.pickSlots=1;w.setPickBase=function(e){this.pickId=e};function M(e){var t=v({colormap:e,nshades:256,format:"rgba"});var r=new Uint8Array(256*4);for(var n=0;n<256;++n){var i=t[n];for(var a=0;a<3;++a){r[4*n+a]=i[a]}r[4*n+3]=i[3]*255}return h(r,[256,256,4],[4,0,1])}function A(e,t,r){var n=new Array(t);for(var i=0;i<t;++i){n[i]=0}var a=e.length;for(var i=0;i<a;++i){var o=e[i];for(var s=0;s<o.length;++s){n[o[s]]=r[i]}}return n}function T(e){var t=e.length;var r=new Array(t);for(var n=0;n<t;++n){r[n]=e[n][2]}return r}w.highlight=function(e){if(!e||!this.contourEnable){this.contourCount=0;return}var t=d(this.cells,this.intensity,e.intensity);var r=t.cells;var n=t.vertexIds;var i=t.vertexWeights;var a=r.length;var o=p.mallocFloat32(2*3*a);var s=0;for(var l=0;l<a;++l){var u=r[l];for(var f=0;f<2;++f){var c=u[0];if(u.length===2){c=u[f]}var h=n[c][0];var v=n[c][1];var g=i[c];var m=1-g;var y=this.positions[h];var b=this.positions[v];for(var x=0;x<3;++x){o[s++]=g*y[x]+m*b[x]}}}this.contourCount=s/3|0;this.contourPositions.update(o.subarray(0,s));p.free(o)};w.update=function(e){e=e||{};var t=this.gl;this.dirty=true;if("contourEnable"in e){this.contourEnable=e.contourEnable}if("contourColor"in e){this.contourColor=e.contourColor}if("lineWidth"in e){this.lineWidth=e.lineWidth}if("lightPosition"in e){this.lightPosition=e.lightPosition}if("opacity"in e){this.opacity=e.opacity}if("ambient"in e){this.ambientLight=e.ambient}if("diffuse"in e){this.diffuseLight=e.diffuse}if("specular"in e){this.specularLight=e.specular}if("roughness"in e){this.roughness=e.roughness}if("fresnel"in e){this.fresnel=e.fresnel}if(e.vectorScale!==undefined){this.vectorScale=e.vectorScale}if(e.coneScale!==undefined){this.coneScale=e.coneScale}if(e.coneOffset!==undefined){this.coneOffset=e.coneOffset}if(e.texture){this.texture.dispose();this.texture=l(t,e.texture)}else if(e.colormap){this.texture.shape=[256,256];this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR;this.texture.magFilter=t.LINEAR;this.texture.setPixels(M(e.colormap));this.texture.generateMipmap()}var r=e.cells;var a=e.positions;var o=e.vectors;if(!a||!r||!o){return}var s=[];var f=[];var c=[];var h=[];var v=[];var d=[];var p=[];var g=[];var m=[];var y=[];var b=[];var x=[];var _=[];var w=[];var k=[];this.cells=r;this.positions=a;var E=e.vertexNormals;var S=e.cellNormals;var L=e.vertexNormalsEpsilon===void 0?n:e.vertexNormalsEpsilon;var C=e.faceNormalsEpsilon===void 0?i:e.faceNormalsEpsilon;if(e.useFacetNormals&&!S){S=u.faceNormals(r,a,C)}if(!S&&!E){E=u.vertexNormals(r,a,L)}var I=e.vertexColors;var P=e.cellColors;var O=e.meshColor||[1,1,1,1];var R=e.vertexUVs;var N=e.vertexIntensity;var z=e.cellUVs;var D=e.cellIntensity;var F=Infinity;var j=-Infinity;if(!R&&!z){if(N){if(e.vertexIntensityBounds){F=+e.vertexIntensityBounds[0];j=+e.vertexIntensityBounds[1]}else{for(var B=0;B<N.length;++B){var U=N[B];F=Math.min(F,U);j=Math.max(j,U)}}}else if(D){for(var B=0;B<D.length;++B){var U=D[B];F=Math.min(F,U);j=Math.max(j,U)}}else{for(var B=0;B<a.length;++B){var U=a[B][2];F=Math.min(F,U);j=Math.max(j,U)}}}if(N){this.intensity=N}else if(D){this.intensity=A(r,a.length,D)}else{this.intensity=T(a)}var V=e.pointSizes;var H=e.pointSize||1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(var B=0;B<a.length;++B){var q=a[B];for(var G=0;G<3;++G){if(isNaN(q[G])||!isFinite(q[G])){continue}this.bounds[0][G]=Math.min(this.bounds[0][G],q[G]);this.bounds[1][G]=Math.max(this.bounds[1][G],q[G])}}var W=0;var X=0;var Y=0;e:for(var B=0;B<r.length;++B){var Z=r[B];switch(Z.length){case 1:var Q=Z[0];var q=a[Q];for(var G=0;G<3;++G){if(isNaN(q[G])||!isFinite(q[G])){continue e}}b.push(q[0],q[1],q[2],q[3]);var K;if(I){K=I[Q]}else if(P){K=P[B]}else{K=O}if(K.length===3){x.push(K[0],K[1],K[2],1)}else{x.push(K[0],K[1],K[2],K[3])}var J;if(R){J=R[Q]}else if(N){J=[(N[Q]-F)/(j-F),0]}else if(z){J=z[B]}else if(D){J=[(D[B]-F)/(j-F),0]}else{J=[(q[2]-F)/(j-F),0]}_.push(J[0],J[1]);if(V){w.push(V[Q])}else{w.push(H)}k.push(B);Y+=1;break;case 2:for(var G=0;G<2;++G){var Q=Z[G];var q=a[Q];for(var $=0;$<3;++$){if(isNaN(q[$])||!isFinite(q[$])){continue e}}}for(var G=0;G<2;++G){var Q=Z[G];var q=a[Q];p.push(q[0],q[1],q[2]);var K;if(I){K=I[Q]}else if(P){K=P[B]}else{K=O}if(K.length===3){g.push(K[0],K[1],K[2],1)}else{g.push(K[0],K[1],K[2],K[3])}var J;if(R){J=R[Q]}else if(N){J=[(N[Q]-F)/(j-F),0]}else if(z){J=z[B]}else if(D){J=[(D[B]-F)/(j-F),0]}else{J=[(q[2]-F)/(j-F),0]}m.push(J[0],J[1]);y.push(B)}X+=1;break;case 3:for(var G=0;G<3;++G){var Q=Z[G];var q=a[Q];for(var $=0;$<3;++$){if(isNaN(q[$])||!isFinite(q[$])){continue e}}}for(var G=0;G<3;++G){var Q=Z[G];var q=a[Q];s.push(q[0],q[1],q[2],q[3]);var ee=o[Q];f.push(ee[0],ee[1],ee[2]);var K;if(I){K=I[Q]}else if(P){K=P[B]}else{K=O}if(K.length===3){c.push(K[0],K[1],K[2],1)}else{c.push(K[0],K[1],K[2],K[3])}var J;if(R){J=R[Q]}else if(N){J=[(N[Q]-F)/(j-F),0]}else if(z){J=z[B]}else if(D){J=[(D[B]-F)/(j-F),0]}else{J=[(q[2]-F)/(j-F),0]}v.push(J[0],J[1]);var te;if(E){te=E[Q]}else{te=S[B]}h.push(te[0],te[1],te[2]);d.push(B)}W+=1;break;default:break}}this.pointCount=Y;this.edgeCount=X;this.triangleCount=W;this.pointPositions.update(b);this.pointColors.update(x);this.pointUVs.update(_);this.pointSizes.update(w);this.pointIds.update(new Uint32Array(k));this.edgePositions.update(p);this.edgeColors.update(g);this.edgeUVs.update(m);this.edgeIds.update(new Uint32Array(y));this.trianglePositions.update(s);this.triangleVectors.update(f);this.triangleColors.update(c);this.triangleUVs.update(v);this.triangleNormals.update(h);this.triangleIds.update(new Uint32Array(d))};w.drawTransparent=w.draw=function(e){e=e||{};var t=this.gl;var r=e.model||x;var n=e.view||x;var i=e.projection||x;var a=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){a[0][o]=Math.max(a[0][o],this.clipBounds[0][o]);a[1][o]=Math.min(a[1][o],this.clipBounds[1][o])}var s={model:r,view:n,projection:i,clipBounds:a,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,contourColor:this.contourColor,texture:0};this.texture.bind(0);var l=new Array(16);f(l,s.view,s.model);f(l,s.projection,l);c(l,l);for(var o=0;o<3;++o){s.eyePosition[o]=l[12+o]/l[15]}var u=l[15];for(var o=0;o<3;++o){u+=this.lightPosition[o]*l[4*o+3]}for(var o=0;o<3;++o){var h=l[12+o];for(var v=0;v<3;++v){h+=l[4*v+o]*this.lightPosition[v]}s.lightPosition[o]=h/u}if(this.triangleCount>0){var d=this.triShader;d.bind();d.uniforms=s;this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var d=this.lineShader;d.bind();d.uniforms=s;this.edgeVAO.bind();t.lineWidth(this.lineWidth);t.drawArrays(t.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var d=this.pointShader;d.bind();d.uniforms=s;this.pointVAO.bind();t.drawArrays(t.POINTS,0,this.pointCount);this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var d=this.contourShader;d.bind();d.uniforms=s;this.contourVAO.bind();t.drawArrays(t.LINES,0,this.contourCount);this.contourVAO.unbind()}};w.drawPick=function(e){e=e||{};var t=this.gl;var r=e.model||x;var n=e.view||x;var i=e.projection||x;var a=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){a[0][o]=Math.max(a[0][o],this.clipBounds[0][o]);a[1][o]=Math.min(a[1][o],this.clipBounds[1][o])}this._model=[].slice.call(r);this._view=[].slice.call(n);this._projection=[].slice.call(i);this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:r,view:n,projection:i,clipBounds:a,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255};var l=this.pickShader;l.bind();l.uniforms=s;if(this.triangleCount>0){this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0){this.edgeVAO.bind();t.lineWidth(this.lineWidth);t.drawArrays(t.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var l=this.pointPickShader;l.bind();l.uniforms=s;this.pointVAO.bind();t.drawArrays(t.POINTS,0,this.pointCount);this.pointVAO.unbind()}};w.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=e.value[0]+256*e.value[1]+65536*e.value[2];var r=this.cells[t];var n=this.positions[r[1]].slice(0,3);return{index:Math.floor(r[1]/48),position:n,dataCoordinate:n}};w.dispose=function(){this.texture.dispose();this.triShader.dispose();this.pickShader.dispose();this.triangleVAO.dispose();this.trianglePositions.dispose();this.triangleVectors.dispose();this.triangleColors.dispose();this.triangleUVs.dispose();this.triangleNormals.dispose();this.triangleIds.dispose();this.edgeVAO.dispose();this.edgePositions.dispose();this.edgeColors.dispose();this.edgeUVs.dispose();this.edgeIds.dispose();this.pointVAO.dispose();this.pointPositions.dispose();this.pointColors.dispose();this.pointUVs.dispose();this.pointSizes.dispose();this.pointIds.dispose();this.contourVAO.dispose();this.contourPositions.dispose()};function k(e){var t=a(e,y.vertex,y.fragment,null,y.attributes);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;t.attributes.vector.location=5;return t}function E(e){var t=a(e,wireShader.vertex,wireShader.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;return t}function S(e){var t=a(e,pointShader.vertex,pointShader.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;t.attributes.pointSize.location=4;return t}function L(e){var t=a(e,b.vertex,b.fragment,null,b.attributes);t.attributes.position.location=0;t.attributes.id.location=1;t.attributes.vector.location=5;return t}function C(e){var t=a(e,pointPickShader.vertex,pointPickShader.fragment);t.attributes.position.location=0;t.attributes.id.location=1;t.attributes.pointSize.location=4;return t}function I(e){var t=a(e,contourShader.vertex,contourShader.fragment);t.attributes.position.location=0;return t}function P(e,t){if(arguments.length===1){t=e;e=t.gl}var r=t.triShader||k(e);var n=null;var i=null;var a=L(e);var u=null;var f=null;var c=l(e,h(new Uint8Array([255,255,255,255]),[1,1,4]));c.generateMipmap();c.minFilter=e.LINEAR_MIPMAP_LINEAR;c.magFilter=e.LINEAR;var v=o(e);var d=o(e);var p=o(e);var g=o(e);var m=o(e);var y=o(e);var b=s(e,[{buffer:v,type:e.FLOAT,size:4},{buffer:y,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:p,type:e.FLOAT,size:4},{buffer:g,type:e.FLOAT,size:2},{buffer:m,type:e.FLOAT,size:3},{buffer:d,type:e.FLOAT,size:3}]);var x=o(e);var w=o(e);var M=o(e);var A=o(e);var T=s(e,[{buffer:x,type:e.FLOAT,size:3},{buffer:A,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:w,type:e.FLOAT,size:4},{buffer:M,type:e.FLOAT,size:2}]);var E=o(e);var S=o(e);var C=o(e);var I=o(e);var P=o(e);var O=s(e,[{buffer:E,type:e.FLOAT,size:3},{buffer:P,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:S,type:e.FLOAT,size:4},{buffer:C,type:e.FLOAT,size:2},{buffer:I,type:e.FLOAT,size:1}]);var R=o(e);var N=s(e,[{buffer:R,type:e.FLOAT,size:3}]);var z=new _(e,c,r,n,i,a,u,f,v,d,y,p,g,m,b,x,A,w,M,T,E,P,S,C,I,O,R,N);z.update(t);return z}t.exports=P},{"./closest-point":106,"./shaders":108,colormap:68,"gl-buffer":104,"gl-mat4/invert":125,"gl-mat4/multiply":127,"gl-shader":147,"gl-texture2d":162,"gl-vao":166,ndarray:270,normals:272,"simplicial-complex-contour":314,"typedarray-pool":333}],108:[function(e,t,r){var n=e("glslify");var i=n(["precision mediump float;\n#define GLSLIFY 1\n\nfloat inverse(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float index, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  index = mod(index, segmentCount * 6.0);\n\n  float segment = floor(index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex == 3.0) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  // angle = 2pi * ((segment + ((segmentIndex == 1.0 || segmentIndex == 5.0) ? 1.0 : 0.0)) / segmentCount)\n  float nextAngle = float(segmentIndex == 1.0 || segmentIndex == 5.0);\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex <= 2.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\nuniform float vectorScale;\nuniform float coneScale;\n\nuniform float coneOffset;\n\nuniform mat4 model\n           , view\n           , projection;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal), 0.0);\n  normal = normalize(normal * inverse(mat3(model)));\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n  f_color          = color; //vec4(position.w, color.r, 0, 0);\n  f_normal         = normal;\n  f_data           = conePosition.xyz;\n  f_eyeDirection   = eyePosition   - conePosition.xyz;\n  f_lightDirection = lightPosition - conePosition.xyz;\n  f_uv             = uv;\n}\n"]);var a=n(["precision mediump float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  //if(any(lessThan(f_data, clipBounds[0])) || \n  //   any(greaterThan(f_data, clipBounds[1]))) {\n  //  discard;\n  //}\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n  \n  if(!gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = cookTorranceSpecular(L, V, N, roughness, fresnel);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor =  texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float index, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  index = mod(index, segmentCount * 6.0);\n\n  float segment = floor(index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex == 3.0) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  // angle = 2pi * ((segment + ((segmentIndex == 1.0 || segmentIndex == 5.0) ? 1.0 : 0.0)) / segmentCount)\n  float nextAngle = float(segmentIndex == 1.0 || segmentIndex == 5.0);\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex <= 2.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nuniform float vectorScale;\nuniform float coneScale;\nuniform float coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal), 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]);var s=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if(any(lessThan(f_position, clipBounds[0])) || \n     any(greaterThan(f_position, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);r.meshShader={vertex:i,fragment:a,attributes:[{name:"position",type:"vec4"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]};r.pickShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:235}],109:[function(e,t,r){t.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34000:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],110:[function(e,t,r){var n=e("./1.0/numbers");t.exports=function e(t){return n[t]}},{"./1.0/numbers":109}],111:[function(e,t,r){"use strict";t.exports=h;var n=e("gl-buffer");var i=e("gl-vao");var a=e("./shaders/index");var o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(e,t,r,n){this.gl=e;this.shader=n;this.buffer=t;this.vao=r;this.pixelRatio=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lineWidth=[1,1,1];this.capSize=[10,10,10];this.lineCount=[0,0,0];this.lineOffset=[0,0,0];this.opacity=1}var l=s.prototype;l.isOpaque=function(){return this.opacity>=1};l.isTransparent=function(){return this.opacity<1};l.drawTransparent=l.draw=function(e){var t=this.gl;var r=this.shader.uniforms;this.shader.bind();var n=r.view=e.view||o;var i=r.projection=e.projection||o;r.model=e.model||o;r.clipBounds=this.clipBounds;r.opacity=this.opacity;var a=n[12];var s=n[13];var l=n[14];var u=n[15];var f=this.pixelRatio*(i[3]*a+i[7]*s+i[11]*l+i[15]*u)/t.drawingBufferHeight;this.vao.bind();for(var c=0;c<3;++c){t.lineWidth(this.lineWidth[c]);r.capSize=this.capSize[c]*f;if(this.lineCount[c]){t.drawArrays(t.LINES,this.lineOffset[c],this.lineCount[c])}}this.vao.unbind()};function u(e,t){for(var r=0;r<3;++r){e[0][r]=Math.min(e[0][r],t[r]);e[1][r]=Math.max(e[1][r],t[r])}}var f=function(){var e=new Array(3);for(var t=0;t<3;++t){var r=[];for(var n=1;n<=2;++n){for(var i=-1;i<=1;i+=2){var a=(n+t)%3;var o=[0,0,0];o[a]=i;r.push(o)}}e[t]=r}return e}();function c(e,t,r,n){var i=f[n];for(var a=0;a<i.length;++a){var o=i[a];e.push(t[0],t[1],t[2],r[0],r[1],r[2],r[3],o[0],o[1],o[2])}return i.length}l.update=function(e){e=e||{};if("lineWidth"in e){this.lineWidth=e.lineWidth;if(!Array.isArray(this.lineWidth)){this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth]}}if("capSize"in e){this.capSize=e.capSize;if(!Array.isArray(this.capSize)){this.capSize=[this.capSize,this.capSize,this.capSize]}}if("opacity"in e){this.opacity=e.opacity}var t=e.color||[[0,0,0],[0,0,0],[0,0,0]];var r=e.position;var n=e.error;if(!Array.isArray(t[0])){t=[t,t,t]}if(r&&n){var i=[];var a=r.length;var o=0;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.lineCount=[0,0,0];for(var s=0;s<3;++s){this.lineOffset[s]=o;e:for(var l=0;l<a;++l){var f=r[l];for(var h=0;h<3;++h){if(isNaN(f[h])||!isFinite(f[h])){continue e}}var v=n[l];var d=t[s];if(Array.isArray(d[0])){d=t[l]}if(d.length===3){d=[d[0],d[1],d[2],1]}if(isNaN(v[0][s])||isNaN(v[1][s])){continue}if(v[0][s]<0){var p=f.slice();p[s]+=v[0][s];i.push(f[0],f[1],f[2],d[0],d[1],d[2],d[3],0,0,0,p[0],p[1],p[2],d[0],d[1],d[2],d[3],0,0,0);u(this.bounds,p);o+=2+c(i,p,d,s)}if(v[1][s]>0){var p=f.slice();p[s]+=v[1][s];i.push(f[0],f[1],f[2],d[0],d[1],d[2],d[3],0,0,0,p[0],p[1],p[2],d[0],d[1],d[2],d[3],0,0,0);u(this.bounds,p);o+=2+c(i,p,d,s)}}this.lineCount[s]=o-this.lineOffset[s]}this.buffer.update(i)}};l.dispose=function(){this.shader.dispose();this.buffer.dispose();this.vao.dispose()};function h(e){var t=e.gl;var r=n(t);var o=i(t,[{buffer:r,type:t.FLOAT,size:3,offset:0,stride:40},{buffer:r,type:t.FLOAT,size:4,offset:12,stride:40},{buffer:r,type:t.FLOAT,size:3,offset:28,stride:40}]);var l=a(t);l.attributes.position.location=0;l.attributes.color.location=1;l.attributes.offset.location=2;var u=new s(t,r,o,l);u.update(e);return u}},{"./shaders/index":112,"gl-buffer":104,"gl-vao":166}],112:[function(e,t,r){"use strict";var n=e("glslify");var i=e("gl-shader");var a=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if(any(lessThan(fragPosition, clipBounds[0])) || any(greaterThan(fragPosition, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = opacity * fragColor;\n}"]);t.exports=function(e){return i(e,a,o,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":147,glslify:235}],113:[function(e,t,r){"use strict";var n=e("gl-texture2d");t.exports=b;var i=null;var a;var o;var s;var l;function u(e){var t=e.getParameter(e.FRAMEBUFFER_BINDING);var r=e.getParameter(e.RENDERBUFFER_BINDING);var n=e.getParameter(e.TEXTURE_BINDING_2D);return[t,r,n]}function f(e,t){e.bindFramebuffer(e.FRAMEBUFFER,t[0]);e.bindRenderbuffer(e.RENDERBUFFER,t[1]);e.bindTexture(e.TEXTURE_2D,t[2])}function c(e,t){var r=e.getParameter(t.MAX_COLOR_ATTACHMENTS_WEBGL);i=new Array(r+1);for(var n=0;n<=r;++n){var a=new Array(r);for(var o=0;o<n;++o){a[o]=e.COLOR_ATTACHMENT0+o}for(var o=n;o<r;++o){a[o]=e.NONE}i[n]=a}}function h(e){switch(e){case a:throw new Error("gl-fbo: Framebuffer unsupported");case o:throw new Error("gl-fbo: Framebuffer incomplete attachment");case s:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case l:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function v(e,t,r,i,a,o){if(!i){return null}var s=n(e,t,r,a,i);s.magFilter=e.NEAREST;s.minFilter=e.NEAREST;s.mipSamples=1;s.bind();e.framebufferTexture2D(e.FRAMEBUFFER,o,e.TEXTURE_2D,s.handle,0);return s}function d(e,t,r,n,i){var a=e.createRenderbuffer();e.bindRenderbuffer(e.RENDERBUFFER,a);e.renderbufferStorage(e.RENDERBUFFER,n,t,r);e.framebufferRenderbuffer(e.FRAMEBUFFER,i,e.RENDERBUFFER,a);return a}function p(e){var t=u(e.gl);var r=e.gl;var n=e.handle=r.createFramebuffer();var a=e._shape[0];var o=e._shape[1];var s=e.color.length;var l=e._ext;var c=e._useStencil;var p=e._useDepth;var g=e._colorType;r.bindFramebuffer(r.FRAMEBUFFER,n);for(var m=0;m<s;++m){e.color[m]=v(r,a,o,g,r.RGBA,r.COLOR_ATTACHMENT0+m)}if(s===0){e._color_rb=d(r,a,o,r.RGBA4,r.COLOR_ATTACHMENT0);if(l){l.drawBuffersWEBGL(i[0])}}else if(s>1){l.drawBuffersWEBGL(i[s])}var y=r.getExtension("WEBGL_depth_texture");if(y){if(c){e.depth=v(r,a,o,y.UNSIGNED_INT_24_8_WEBGL,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT)}else if(p){e.depth=v(r,a,o,r.UNSIGNED_SHORT,r.DEPTH_COMPONENT,r.DEPTH_ATTACHMENT)}}else{if(p&&c){e._depth_rb=d(r,a,o,r.DEPTH_STENCIL,r.DEPTH_STENCIL_ATTACHMENT)}else if(p){e._depth_rb=d(r,a,o,r.DEPTH_COMPONENT16,r.DEPTH_ATTACHMENT)}else if(c){e._depth_rb=d(r,a,o,r.STENCIL_INDEX,r.STENCIL_ATTACHMENT)}}var b=r.checkFramebufferStatus(r.FRAMEBUFFER);if(b!==r.FRAMEBUFFER_COMPLETE){e._destroyed=true;r.bindFramebuffer(r.FRAMEBUFFER,null);r.deleteFramebuffer(e.handle);e.handle=null;if(e.depth){e.depth.dispose();e.depth=null}if(e._depth_rb){r.deleteRenderbuffer(e._depth_rb);e._depth_rb=null}for(var m=0;m<e.color.length;++m){e.color[m].dispose();e.color[m]=null}if(e._color_rb){r.deleteRenderbuffer(e._color_rb);e._color_rb=null}f(r,t);h(b)}f(r,t)}function g(e,t,r,n,i,a,o,s){this.gl=e;this._shape=[t|0,r|0];this._destroyed=false;this._ext=s;this.color=new Array(i);for(var l=0;l<i;++l){this.color[l]=null}this._color_rb=null;this.depth=null;this._depth_rb=null;this._colorType=n;this._useDepth=a;this._useStencil=o;var u=this;var f=[t|0,r|0];Object.defineProperties(f,{0:{get:function(){return u._shape[0]},set:function(e){return u.width=e}},1:{get:function(){return u._shape[1]},set:function(e){return u.height=e}}});this._shapeVector=f;p(this)}var m=g.prototype;function y(e,t,r){if(e._destroyed){throw new Error("gl-fbo: Can't resize destroyed FBO")}if(e._shape[0]===t&&e._shape[1]===r){return}var n=e.gl;var i=n.getParameter(n.MAX_RENDERBUFFER_SIZE);if(t<0||t>i||r<0||r>i){throw new Error("gl-fbo: Can't resize FBO, invalid dimensions")}e._shape[0]=t;e._shape[1]=r;var a=u(n);for(var o=0;o<e.color.length;++o){e.color[o].shape=e._shape}if(e._color_rb){n.bindRenderbuffer(n.RENDERBUFFER,e._color_rb);n.renderbufferStorage(n.RENDERBUFFER,n.RGBA4,e._shape[0],e._shape[1])}if(e.depth){e.depth.shape=e._shape}if(e._depth_rb){n.bindRenderbuffer(n.RENDERBUFFER,e._depth_rb);if(e._useDepth&&e._useStencil){n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,e._shape[0],e._shape[1])}else if(e._useDepth){n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_COMPONENT16,e._shape[0],e._shape[1])}else if(e._useStencil){n.renderbufferStorage(n.RENDERBUFFER,n.STENCIL_INDEX,e._shape[0],e._shape[1])}}n.bindFramebuffer(n.FRAMEBUFFER,e.handle);var s=n.checkFramebufferStatus(n.FRAMEBUFFER);if(s!==n.FRAMEBUFFER_COMPLETE){e.dispose();f(n,a);h(s)}f(n,a)}Object.defineProperties(m,{shape:{get:function(){if(this._destroyed){return[0,0]}return this._shapeVector},set:function(e){if(!Array.isArray(e)){e=[e|0,e|0]}if(e.length!==2){throw new Error("gl-fbo: Shape vector must be length 2")}var t=e[0]|0;var r=e[1]|0;y(this,t,r);return[t,r]},enumerable:false},width:{get:function(){if(this._destroyed){return 0}return this._shape[0]},set:function(e){e=e|0;y(this,e,this._shape[1]);return e},enumerable:false},height:{get:function(){if(this._destroyed){return 0}return this._shape[1]},set:function(e){e=e|0;y(this,this._shape[0],e);return e},enumerable:false}});m.bind=function(){if(this._destroyed){return}var e=this.gl;e.bindFramebuffer(e.FRAMEBUFFER,this.handle);e.viewport(0,0,this._shape[0],this._shape[1])};m.dispose=function(){if(this._destroyed){return}this._destroyed=true;var e=this.gl;e.deleteFramebuffer(this.handle);this.handle=null;if(this.depth){this.depth.dispose();this.depth=null}if(this._depth_rb){e.deleteRenderbuffer(this._depth_rb);this._depth_rb=null}for(var t=0;t<this.color.length;++t){this.color[t].dispose();this.color[t]=null}if(this._color_rb){e.deleteRenderbuffer(this._color_rb);this._color_rb=null}};function b(e,t,r,n){if(!a){a=e.FRAMEBUFFER_UNSUPPORTED;o=e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT;s=e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS;l=e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT}var u=e.getExtension("WEBGL_draw_buffers");if(!i&&u){c(e,u)}if(Array.isArray(t)){n=r;r=t[1]|0;t=t[0]|0}if(typeof t!=="number"){throw new Error("gl-fbo: Missing shape parameter")}var f=e.getParameter(e.MAX_RENDERBUFFER_SIZE);if(t<0||t>f||r<0||r>f){throw new Error("gl-fbo: Parameters are too large for FBO")}n=n||{};var h=1;if("color"in n){h=Math.max(n.color|0,0);if(h<0){throw new Error("gl-fbo: Must specify a nonnegative number of colors")}if(h>1){if(!u){throw new Error("gl-fbo: Multiple draw buffer extension not supported")}else if(h>e.getParameter(u.MAX_COLOR_ATTACHMENTS_WEBGL)){throw new Error("gl-fbo: Context does not support "+h+" draw buffers")}}}var v=e.UNSIGNED_BYTE;var d=e.getExtension("OES_texture_float");if(n.float&&h>0){if(!d){throw new Error("gl-fbo: Context does not support floating point textures")}v=e.FLOAT}else if(n.preferFloat&&h>0){if(d){v=e.FLOAT}}var p=true;if("depth"in n){p=!!n.depth}var m=false;if("stencil"in n){m=!!n.stencil}return new g(e,t,r,v,h,p,m,u)}},{"gl-texture2d":162}],114:[function(e,t,r){var n=e("sprintf-js").sprintf;var i=e("gl-constants/lookup");var a=e("glsl-shader-name");var o=e("add-line-numbers");t.exports=s;function s(e,t,r){"use strict";var s=a(t)||"of unknown name (see npm glsl-shader-name)";var l="unknown type";if(r!==undefined){l=r===i.FRAGMENT_SHADER?"fragment":"vertex"}var u=n("Error compiling %s shader %s:\n",l,s);var f=n("%s%s",u,e);var c=e.split("\n");var h={};for(var v=0;v<c.length;v++){var d=c[v];if(d===""||d==="\0")continue;var p=parseInt(d.split(":")[2]);if(isNaN(p)){throw new Error(n("Could not parse error: %s",d))}h[p]=d}var g=o(t).split("\n");for(var v=0;v<g.length;v++){if(!h[v+3]&&!h[v+2]&&!h[v+1])continue;var m=g[v];u+=m+"\n";if(h[v+1]){var y=h[v+1];y=y.substr(y.split(":",3).join(":").length+1).trim();u+=n("^^^ %s\n\n",y)}}return{long:u.trim(),short:f.trim()}}},{"add-line-numbers":13,"gl-constants/lookup":110,"glsl-shader-name":227,"sprintf-js":324}],115:[function(e,t,r){var n=e("glslify");var i=e("gl-shader");var a=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvoid main() {\n  vec4 projected = projection * view * model * vec4(position, 1.0);\n  vec4 tangentClip = projection * view * model * vec4(nextPosition - position, 0.0);\n  vec2 tangent = normalize(screenShape * tangentClip.xy);\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(tangent.y, -tangent.x) / screenShape;\n\n  gl_Position = vec4(projected.xy + projected.w * offset, projected.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if(any(lessThan(worldPosition, clipBounds[0])) || any(greaterThan(worldPosition, clipBounds[1]))) {\n    discard;\n  }\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]);var s=n(["precision mediump float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\nlowp vec4 encode_float_1540259130(highp float v) {\n  highp float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  highp vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  highp float e = floor(log2(av));\n  highp float m = av * pow(2.0, -e) - 1.0;\n  \n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n  \n  //Unpack exponent\n  highp float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0; \n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if(any(lessThan(worldPosition, clipBounds[0])) || any(greaterThan(worldPosition, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId/255.0, encode_float_1540259130(pixelArcLength).xyz);\n}"]);var l=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];r.createShader=function(e){return i(e,a,o,null,l)};r.createPickShader=function(e){return i(e,a,s,null,l)}},{"gl-shader":147,glslify:235}],116:[function(e,t,r){"use strict";t.exports=y;var n=e("gl-buffer");var i=e("gl-vao");var a=e("gl-texture2d");var o=e("glsl-read-float");var s=e("binary-search-bounds");var l=e("ndarray");var u=e("./lib/shaders");var f=u.createShader;var c=u.createPickShader;var h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function v(e,t){var r=0;for(var n=0;n<3;++n){var i=e[n]-t[n];r+=i*i}return Math.sqrt(r)}function d(e){var t=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var r=0;r<3;++r){t[0][r]=Math.max(e[0][r],t[0][r]);t[1][r]=Math.min(e[1][r],t[1][r])}return t}function p(e,t,r,n){this.arcLength=e;this.position=t;this.index=r;this.dataCoordinate=n}function g(e,t,r,n,i,a){this.gl=e;this.shader=t;this.pickShader=r;this.buffer=n;this.vao=i;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.points=[];this.arcLength=[];this.vertexCount=0;this.bounds=[[0,0,0],[0,0,0]];this.pickId=0;this.lineWidth=1;this.texture=a;this.dashScale=1;this.opacity=1;this.dirty=true;this.pixelRatio=1}var m=g.prototype;m.isTransparent=function(){return this.opacity<1};m.isOpaque=function(){return this.opacity>=1};m.pickSlots=1;m.setPickBase=function(e){this.pickId=e};m.drawTransparent=m.draw=function(e){var t=this.gl;var r=this.shader;var n=this.vao;r.bind();r.uniforms={model:e.model||h,view:e.view||h,projection:e.projection||h,clipBounds:d(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio};n.bind();n.draw(t.TRIANGLE_STRIP,this.vertexCount);n.unbind()};m.drawPick=function(e){var t=this.gl;var r=this.pickShader;var n=this.vao;r.bind();r.uniforms={model:e.model||h,view:e.view||h,projection:e.projection||h,pickId:this.pickId,clipBounds:d(this.clipBounds),screenShape:[t.drawingBufferWidth,t.drawingBufferHeight],pixelRatio:this.pixelRatio};n.bind();n.draw(t.TRIANGLE_STRIP,this.vertexCount);n.unbind()};m.update=function(e){var t,r;this.dirty=true;var n=!!e.connectGaps;if("dashScale"in e){this.dashScale=e.dashScale}if("opacity"in e){this.opacity=+e.opacity}var i=e.position||e.positions;if(!i){return}var a=e.color||e.colors||[0,0,0,1];var o=e.lineWidth||1;var u=[];var f=[];var c=[];var h=0;var d=0;var p=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];var g=false;e:for(t=1;t<i.length;++t){var m=i[t-1];var y=i[t];f.push(h);c.push(m.slice());for(r=0;r<3;++r){if(isNaN(m[r])||isNaN(y[r])||!isFinite(m[r])||!isFinite(y[r])){if(!n&&u.length>0){for(var b=0;b<24;++b){u.push(u[u.length-12])}d+=2;g=true}continue e}p[0][r]=Math.min(p[0][r],m[r],y[r]);p[1][r]=Math.max(p[1][r],m[r],y[r])}var x,_;if(Array.isArray(a[0])){x=a[t-1];_=a[t]}else{x=_=a}if(x.length===3){x=[x[0],x[1],x[2],1]}if(_.length===3){_=[_[0],_[1],_[2],1]}var w;if(Array.isArray(o)){w=o[t-1]}else{w=o}var M=h;h+=v(m,y);if(g){for(r=0;r<2;++r){u.push(m[0],m[1],m[2],y[0],y[1],y[2],M,w,x[0],x[1],x[2],x[3])}d+=2;g=false}u.push(m[0],m[1],m[2],y[0],y[1],y[2],M,w,x[0],x[1],x[2],x[3],m[0],m[1],m[2],y[0],y[1],y[2],M,-w,x[0],x[1],x[2],x[3],y[0],y[1],y[2],m[0],m[1],m[2],h,-w,_[0],_[1],_[2],_[3],y[0],y[1],y[2],m[0],m[1],m[2],h,w,_[0],_[1],_[2],_[3]);d+=4}this.buffer.update(u);f.push(h);c.push(i[i.length-1].slice());this.bounds=p;this.vertexCount=d;this.points=c;this.arcLength=f;if("dashes"in e){var A=e.dashes;var T=A.slice();T.unshift(0);for(t=1;t<T.length;++t){T[t]=T[t-1]+T[t]}var k=l(new Array(256*4),[256,1,4]);for(t=0;t<256;++t){for(r=0;r<4;++r){k.set(t,0,r,0)}if(s.le(T,T[T.length-1]*t/255)&1){k.set(t,0,0,0)}else{k.set(t,0,0,255)}}this.texture.setPixels(k)}};m.dispose=function(){this.shader.dispose();this.vao.dispose();this.buffer.dispose()};m.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=o(e.value[0],e.value[1],e.value[2],0);var r=s.le(this.arcLength,t);if(r<0){return null}if(r===this.arcLength.length-1){return new p(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),r)}var n=this.points[r];var i=this.points[Math.min(r+1,this.points.length-1)];var a=(t-this.arcLength[r])/(this.arcLength[r+1]-this.arcLength[r]);var l=1-a;var u=[0,0,0];for(var f=0;f<3;++f){u[f]=l*n[f]+a*i[f]}var c=Math.min(a<.5?r:r+1,this.points.length-1);return new p(t,u,c,this.points[c])};function y(e){var t=e.gl||e.scene&&e.scene.gl;var r=f(t);r.attributes.position.location=0;r.attributes.nextPosition.location=1;r.attributes.arcLength.location=2;r.attributes.lineWidth.location=3;r.attributes.color.location=4;var o=c(t);o.attributes.position.location=0;o.attributes.nextPosition.location=1;o.attributes.arcLength.location=2;o.attributes.lineWidth.location=3;o.attributes.color.location=4;var s=n(t);var u=i(t,[{buffer:s,size:3,offset:0,stride:48},{buffer:s,size:3,offset:12,stride:48},{buffer:s,size:1,offset:24,stride:48},{buffer:s,size:1,offset:28,stride:48},{buffer:s,size:4,offset:32,stride:48}]);var h=l(new Array(256*4),[256,1,4]);for(var v=0;v<256*4;++v){h.data[v]=255}var d=a(t,h);d.wrap=t.REPEAT;var p=new g(t,r,o,s,u,d);p.update(e);return p}},{"./lib/shaders":115,"binary-search-bounds":36,"gl-buffer":104,"gl-texture2d":162,"gl-vao":166,"glsl-read-float":226,ndarray:270}],117:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0];var n=t[1];var i=t[2];var a=t[3];var o=r*a-i*n;if(!o)return null;o=1/o;e[0]=a*o;e[1]=-n*o;e[2]=-i*o;e[3]=r*o;return e}},{}],118:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0],n=t[1],i=t[2];var a=t[3],o=t[4],s=t[5];var l=t[6],u=t[7],f=t[8];var c=f*o-s*u;var h=-f*a+s*l;var v=u*a-o*l;var d=r*c+n*h+i*v;if(!d)return null;d=1/d;e[0]=c*d;e[1]=(-f*n+i*u)*d;e[2]=(s*n-i*o)*d;e[3]=h*d;e[4]=(f*r-i*l)*d;e[5]=(-s*r+i*a)*d;e[6]=v*d;e[7]=(-u*r+n*l)*d;e[8]=(o*r-n*a)*d;return e}},{}],119:[function(e,t,r){t.exports=n;function n(e){var t=new Float32Array(16);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];t[4]=e[4];t[5]=e[5];t[6]=e[6];t[7]=e[7];t[8]=e[8];t[9]=e[9];t[10]=e[10];t[11]=e[11];t[12]=e[12];t[13]=e[13];t[14]=e[14];t[15]=e[15];return t}},{}],120:[function(e,t,r){t.exports=n;function n(){var e=new Float32Array(16);e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],121:[function(e,t,r){t.exports=n;function n(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],f=e[9],c=e[10],h=e[11],v=e[12],d=e[13],p=e[14],g=e[15],m=t*o-r*a,y=t*s-n*a,b=t*l-i*a,x=r*s-n*o,_=r*l-i*o,w=n*l-i*s,M=u*d-f*v,A=u*p-c*v,T=u*g-h*v,k=f*p-c*d,E=f*g-h*d,S=c*g-h*p;return m*S-y*E+b*k+x*T-_*A+w*M}},{}],122:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,l=i+i,u=r*o,f=n*o,c=n*s,h=i*o,v=i*s,d=i*l,p=a*o,g=a*s,m=a*l;e[0]=1-c-d;e[1]=f+m;e[2]=h-g;e[3]=0;e[4]=f-m;e[5]=1-u-d;e[6]=v+p;e[7]=0;e[8]=h+g;e[9]=v-p;e[10]=1-u-c;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],123:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=n+n,l=i+i,u=a+a,f=n*s,c=n*l,h=n*u,v=i*l,d=i*u,p=a*u,g=o*s,m=o*l,y=o*u;e[0]=1-(v+p);e[1]=c+y;e[2]=h-m;e[3]=0;e[4]=c-y;e[5]=1-(f+p);e[6]=d+g;e[7]=0;e[8]=h+m;e[9]=d-g;e[10]=1-(f+v);e[11]=0;e[12]=r[0];e[13]=r[1];e[14]=r[2];e[15]=1;return e}},{}],124:[function(e,t,r){t.exports=n;function n(e){e[0]=1;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=1;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=1;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],125:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],f=t[8],c=t[9],h=t[10],v=t[11],d=t[12],p=t[13],g=t[14],m=t[15],y=r*s-n*o,b=r*l-i*o,x=r*u-a*o,_=n*l-i*s,w=n*u-a*s,M=i*u-a*l,A=f*p-c*d,T=f*g-h*d,k=f*m-v*d,E=c*g-h*p,S=c*m-v*p,L=h*m-v*g,C=y*L-b*S+x*E+_*k-w*T+M*A;if(!C){return null}C=1/C;e[0]=(s*L-l*S+u*E)*C;e[1]=(i*S-n*L-a*E)*C;e[2]=(p*M-g*w+m*_)*C;e[3]=(h*w-c*M-v*_)*C;e[4]=(l*k-o*L-u*T)*C;e[5]=(r*L-i*k+a*T)*C;e[6]=(g*x-d*M-m*b)*C;e[7]=(f*M-h*x+v*b)*C;e[8]=(o*S-s*k+u*A)*C;e[9]=(n*k-r*S-a*A)*C;e[10]=(d*w-p*x+m*y)*C;e[11]=(c*x-f*w-v*y)*C;e[12]=(s*T-o*E-l*A)*C;e[13]=(r*E-n*T+i*A)*C;e[14]=(p*b-d*_-g*y)*C;e[15]=(f*_-c*b+h*y)*C;return e}},{}],126:[function(e,t,r){var n=e("./identity");t.exports=i;function i(e,t,r,i){var a,o,s,l,u,f,c,h,v,d,p=t[0],g=t[1],m=t[2],y=i[0],b=i[1],x=i[2],_=r[0],w=r[1],M=r[2];if(Math.abs(p-_)<1e-6&&Math.abs(g-w)<1e-6&&Math.abs(m-M)<1e-6){return n(e)}c=p-_;h=g-w;v=m-M;d=1/Math.sqrt(c*c+h*h+v*v);c*=d;h*=d;v*=d;a=b*v-x*h;o=x*c-y*v;s=y*h-b*c;d=Math.sqrt(a*a+o*o+s*s);if(!d){a=0;o=0;s=0}else{d=1/d;a*=d;o*=d;s*=d}l=h*s-v*o;u=v*a-c*s;f=c*o-h*a;d=Math.sqrt(l*l+u*u+f*f);if(!d){l=0;u=0;f=0}else{d=1/d;l*=d;u*=d;f*=d}e[0]=a;e[1]=l;e[2]=c;e[3]=0;e[4]=o;e[5]=u;e[6]=h;e[7]=0;e[8]=s;e[9]=f;e[10]=v;e[11]=0;e[12]=-(a*p+o*g+s*m);e[13]=-(l*p+u*g+f*m);e[14]=-(c*p+h*g+v*m);e[15]=1;return e}},{"./identity":124}],127:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],f=t[7],c=t[8],h=t[9],v=t[10],d=t[11],p=t[12],g=t[13],m=t[14],y=t[15];var b=r[0],x=r[1],_=r[2],w=r[3];e[0]=b*n+x*s+_*c+w*p;e[1]=b*i+x*l+_*h+w*g;e[2]=b*a+x*u+_*v+w*m;e[3]=b*o+x*f+_*d+w*y;b=r[4];x=r[5];_=r[6];w=r[7];e[4]=b*n+x*s+_*c+w*p;e[5]=b*i+x*l+_*h+w*g;e[6]=b*a+x*u+_*v+w*m;e[7]=b*o+x*f+_*d+w*y;b=r[8];x=r[9];_=r[10];w=r[11];e[8]=b*n+x*s+_*c+w*p;e[9]=b*i+x*l+_*h+w*g;e[10]=b*a+x*u+_*v+w*m;e[11]=b*o+x*f+_*d+w*y;b=r[12];x=r[13];_=r[14];w=r[15];e[12]=b*n+x*s+_*c+w*p;e[13]=b*i+x*l+_*h+w*g;e[14]=b*a+x*u+_*v+w*m;e[15]=b*o+x*f+_*d+w*y;return e}},{}],128:[function(e,t,r){t.exports=n;function n(e,t,r,n,i){var a=1/Math.tan(t/2),o=1/(n-i);e[0]=a/r;e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=a;e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=(i+n)*o;e[11]=-1;e[12]=0;e[13]=0;e[14]=2*i*n*o;e[15]=0;return e}},{}],129:[function(e,t,r){t.exports=n;function n(e,t,r,n){var i=n[0],a=n[1],o=n[2],s=Math.sqrt(i*i+a*a+o*o),l,u,f,c,h,v,d,p,g,m,y,b,x,_,w,M,A,T,k,E,S,L,C,I;if(Math.abs(s)<1e-6){return null}s=1/s;i*=s;a*=s;o*=s;l=Math.sin(r);u=Math.cos(r);f=1-u;c=t[0];h=t[1];v=t[2];d=t[3];p=t[4];g=t[5];m=t[6];y=t[7];b=t[8];x=t[9];_=t[10];w=t[11];M=i*i*f+u;A=a*i*f+o*l;T=o*i*f-a*l;k=i*a*f-o*l;E=a*a*f+u;S=o*a*f+i*l;L=i*o*f+a*l;C=a*o*f-i*l;I=o*o*f+u;e[0]=c*M+p*A+b*T;e[1]=h*M+g*A+x*T;e[2]=v*M+m*A+_*T;e[3]=d*M+y*A+w*T;e[4]=c*k+p*E+b*S;e[5]=h*k+g*E+x*S;e[6]=v*k+m*E+_*S;e[7]=d*k+y*E+w*S;e[8]=c*L+p*C+b*I;e[9]=h*L+g*C+x*I;e[10]=v*L+m*C+_*I;e[11]=d*L+y*C+w*I;if(t!==e){e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}return e}},{}],130:[function(e,t,r){t.exports=n;function n(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],f=t[9],c=t[10],h=t[11];if(t!==e){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[4]=a*i+u*n;e[5]=o*i+f*n;e[6]=s*i+c*n;e[7]=l*i+h*n;e[8]=u*i-a*n;e[9]=f*i-o*n;e[10]=c*i-s*n;e[11]=h*i-l*n;return e}},{}],131:[function(e,t,r){t.exports=n;function n(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[8],f=t[9],c=t[10],h=t[11];if(t!==e){e[4]=t[4];e[5]=t[5];e[6]=t[6];e[7]=t[7];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=a*i-u*n;e[1]=o*i-f*n;e[2]=s*i-c*n;e[3]=l*i-h*n;e[8]=a*n+u*i;e[9]=o*n+f*i;e[10]=s*n+c*i;e[11]=l*n+h*i;return e}},{}],132:[function(e,t,r){t.exports=n;function n(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[4],f=t[5],c=t[6],h=t[7];if(t!==e){e[8]=t[8];e[9]=t[9];e[10]=t[10];e[11]=t[11];e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15]}e[0]=a*i+u*n;e[1]=o*i+f*n;e[2]=s*i+c*n;e[3]=l*i+h*n;e[4]=u*i-a*n;e[5]=f*i-o*n;e[6]=c*i-s*n;e[7]=h*i-l*n;return e}},{}],133:[function(e,t,r){t.exports=n;function n(e,t,r){var n=r[0],i=r[1],a=r[2];e[0]=t[0]*n;e[1]=t[1]*n;e[2]=t[2]*n;e[3]=t[3]*n;e[4]=t[4]*i;e[5]=t[5]*i;e[6]=t[6]*i;e[7]=t[7]*i;e[8]=t[8]*a;e[9]=t[9]*a;e[10]=t[10]*a;e[11]=t[11]*a;e[12]=t[12];e[13]=t[13];e[14]=t[14];e[15]=t[15];return e}},{}],134:[function(e,t,r){t.exports=n;function n(e,t,r){var n=r[0],i=r[1],a=r[2],o,s,l,u,f,c,h,v,d,p,g,m;if(t===e){e[12]=t[0]*n+t[4]*i+t[8]*a+t[12];e[13]=t[1]*n+t[5]*i+t[9]*a+t[13];e[14]=t[2]*n+t[6]*i+t[10]*a+t[14];e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]}else{o=t[0];s=t[1];l=t[2];u=t[3];f=t[4];c=t[5];h=t[6];v=t[7];d=t[8];p=t[9];g=t[10];m=t[11];e[0]=o;e[1]=s;e[2]=l;e[3]=u;e[4]=f;e[5]=c;e[6]=h;e[7]=v;e[8]=d;e[9]=p;e[10]=g;e[11]=m;e[12]=o*n+f*i+d*a+t[12];e[13]=s*n+c*i+p*a+t[13];e[14]=l*n+h*i+g*a+t[14];e[15]=u*n+v*i+m*a+t[15]}return e}},{}],135:[function(e,t,r){t.exports=n;function n(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4];e[2]=t[8];e[3]=t[12];e[4]=r;e[6]=t[9];e[7]=t[13];e[8]=n;e[9]=a;e[11]=t[14];e[12]=i;e[13]=o;e[14]=s}else{e[0]=t[0];e[1]=t[4];e[2]=t[8];e[3]=t[12];e[4]=t[1];e[5]=t[5];e[6]=t[9];e[7]=t[13];e[8]=t[2];e[9]=t[6];e[10]=t[10];e[11]=t[14];e[12]=t[3];e[13]=t[7];e[14]=t[11];e[15]=t[15]}return e}},{}],136:[function(e,t,r){"use strict";t.exports=o;var n=e("gl-mat2/invert");var i=e("gl-mat3/invert");var a=e("gl-mat4/invert");function o(e,t){switch(t.length){case 0:break;case 1:e[0]=1/t[0];break;case 4:n(e,t);break;case 9:i(e,t);break;case 16:a(e,t);break;default:throw new Error("currently supports matrices up to 4x4");break}return e}},{"gl-mat2/invert":117,"gl-mat3/invert":118,"gl-mat4/invert":125}],137:[function(e,t,r){"use strict";var n=e("barycentric");var i=e("polytope-closest-point/lib/closest_point_2d.js");t.exports=u;function a(e,t){var r=[0,0,0,0];for(var n=0;n<4;++n){for(var i=0;i<4;++i){r[i]+=e[4*n+i]*t[n]}}return r}function o(e,t,r,n,i){var o=a(n,a(r,a(t,[e[0],e[1],e[2],1])));for(var s=0;s<3;++s){o[s]/=o[3]}return[.5*i[0]*(1+o[0]),.5*i[1]*(1-o[1])]}function s(e,t){if(e.length===2){var r=0;var a=0;for(var o=0;o<2;++o){r+=Math.pow(t[o]-e[0][o],2);a+=Math.pow(t[o]-e[1][o],2)}r=Math.sqrt(r);a=Math.sqrt(a);if(r+a<1e-6){return[1,0]}return[a/(r+a),r/(a+r)]}else if(e.length===3){var s=[0,0];i(e[0],e[1],e[2],t,s);return n(e,s)}return[]}function l(e,t){var r=[0,0,0];for(var n=0;n<e.length;++n){var i=e[n];var a=t[n];for(var o=0;o<3;++o){r[o]+=a*i[o]}}return r}function u(e,t,r,n,i,a){if(e.length===1){return[0,e[0].slice()]}var u=new Array(e.length);for(var f=0;f<e.length;++f){u[f]=o(e[f],r,n,i,a)}var c=0;var h=Infinity;for(var f=0;f<u.length;++f){var v=0;for(var d=0;d<2;++d){v+=Math.pow(u[f][d]-t[d],2)}if(v<h){h=v;c=f}}var p=s(u,t);var g=0;for(var f=0;f<3;++f){if(p[f]<-.001||p[f]>1.0001){return null}g+=p[f]}if(Math.abs(g-1)>.001){return null}return[c,l(e,p),p]}},{barycentric:18,"polytope-closest-point/lib/closest_point_2d.js":291}],138:[function(e,t,r){var n=e("glslify");var i=n(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec4 m_position  = model * vec4(position, 1.0);\n  vec4 t_position  = view * m_position;\n  gl_Position      = projection * t_position;\n  f_color          = color;\n  f_normal         = normal;\n  f_data           = position;\n  f_eyeDirection   = eyePosition   - position;\n  f_lightDirection = lightPosition - position;\n  f_uv             = uv;\n}\n"]);var a=n(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nvec3 normals(vec3 pos) {\n  vec3 fdx = dFdx(pos);\n  vec3 fdy = dFdy(pos);\n  return normalize(cross(fdx, fdy));\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if(any(lessThan(f_data, clipBounds[0])) ||\n     any(greaterThan(f_data, clipBounds[1]))) {\n    discard;\n  }\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  vec3 normal = normals(f_data);\n\n  if (\n    dot(N, normal) < 0.0\n    ) {\n      N = -N;\n  }\n\n  float specular = cookTorranceSpecular(L, V, N, roughness, fresnel);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]);var s=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if(any(lessThan(f_data, clipBounds[0])) || \n     any(greaterThan(f_data, clipBounds[1]))) {\n    discard;\n  }\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]);var l=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || \n     any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]);var u=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5,0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]);var f=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]);var c=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if(any(lessThan(f_position, clipBounds[0])) || \n     any(greaterThan(f_position, clipBounds[1]))) {\n    discard;\n  }\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);var h=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || \n     any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]);var v=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]);var d=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor,1);\n}\n"]);r.meshShader={vertex:i,fragment:a,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]};r.wireShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]};r.pointShader={vertex:l,fragment:u,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]};r.pickShader={vertex:f,fragment:c,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]};r.pointPickShader={vertex:h,fragment:c,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]};r.contourShader={vertex:v,fragment:d,attributes:[{name:"position",type:"vec3"}]}},{glslify:235}],139:[function(e,t,r){"use strict";var n=1e-6;var i=1e-6;var a=e("gl-shader");var o=e("gl-buffer");var s=e("gl-vao");var l=e("gl-texture2d");var u=e("normals");var f=e("gl-mat4/multiply");var c=e("gl-mat4/invert");var h=e("ndarray");var v=e("colormap");var d=e("simplicial-complex-contour");var p=e("typedarray-pool");var g=e("./lib/shaders");var m=e("./lib/closest-point");var y=g.meshShader;var b=g.wireShader;var x=g.pointShader;var _=g.pickShader;var w=g.pointPickShader;var M=g.contourShader;var A=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function T(e,t,r,n,i,a,o,s,l,u,f,c,h,v,d,p,g,m,y,b,x,_,w,M,T,k,E){this.gl=e;this.cells=[];this.positions=[];this.intensity=[];this.texture=t;this.dirty=true;this.triShader=r;this.lineShader=n;this.pointShader=i;this.pickShader=a;this.pointPickShader=o;this.contourShader=s;this.trianglePositions=l;this.triangleColors=f;this.triangleNormals=h;this.triangleUVs=c;this.triangleIds=u;this.triangleVAO=v;this.triangleCount=0;this.lineWidth=1;this.edgePositions=d;this.edgeColors=g;this.edgeUVs=m;this.edgeIds=p;this.edgeVAO=y;this.edgeCount=0;this.pointPositions=b;this.pointColors=_;this.pointUVs=w;this.pointSizes=M;this.pointIds=x;this.pointVAO=T;this.pointCount=0;this.contourLineWidth=1;this.contourPositions=k;this.contourVAO=E;this.contourCount=0;this.contourColor=[0,0,0];this.contourEnable=true;this.pickId=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lightPosition=[1e5,1e5,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.opacity=1;this._model=A;this._view=A;this._projection=A;this._resolution=[1,1]}var k=T.prototype;k.isOpaque=function(){return this.opacity>=1};k.isTransparent=function(){return this.opacity<1};k.pickSlots=1;k.setPickBase=function(e){this.pickId=e};function E(e){var t=v({colormap:e,nshades:256,format:"rgba"});var r=new Uint8Array(256*4);for(var n=0;n<256;++n){var i=t[n];for(var a=0;a<3;++a){r[4*n+a]=i[a]}r[4*n+3]=i[3]*255}return h(r,[256,256,4],[4,0,1])}function S(e,t,r){var n=new Array(t);for(var i=0;i<t;++i){n[i]=0}var a=e.length;for(var i=0;i<a;++i){var o=e[i];for(var s=0;s<o.length;++s){n[o[s]]=r[i]}}return n}function L(e){var t=e.length;var r=new Array(t);for(var n=0;n<t;++n){r[n]=e[n][2]}return r}k.highlight=function(e){if(!e||!this.contourEnable){this.contourCount=0;return}var t=d(this.cells,this.intensity,e.intensity);var r=t.cells;var n=t.vertexIds;var i=t.vertexWeights;var a=r.length;var o=p.mallocFloat32(2*3*a);var s=0;for(var l=0;l<a;++l){var u=r[l];for(var f=0;f<2;++f){var c=u[0];if(u.length===2){c=u[f]}var h=n[c][0];var v=n[c][1];var g=i[c];var m=1-g;var y=this.positions[h];var b=this.positions[v];for(var x=0;x<3;++x){o[s++]=g*y[x]+m*b[x]}}}this.contourCount=s/3|0;this.contourPositions.update(o.subarray(0,s));p.free(o)};k.update=function(e){e=e||{};var t=this.gl;this.dirty=true;if("contourEnable"in e){this.contourEnable=e.contourEnable}if("contourColor"in e){this.contourColor=e.contourColor}if("lineWidth"in e){this.lineWidth=e.lineWidth}if("lightPosition"in e){this.lightPosition=e.lightPosition}if("opacity"in e){this.opacity=e.opacity}if("ambient"in e){this.ambientLight=e.ambient}if("diffuse"in e){this.diffuseLight=e.diffuse}if("specular"in e){this.specularLight=e.specular}if("roughness"in e){this.roughness=e.roughness}if("fresnel"in e){this.fresnel=e.fresnel}if(e.texture){this.texture.dispose();this.texture=l(t,e.texture)}else if(e.colormap){this.texture.shape=[256,256];this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR;this.texture.magFilter=t.LINEAR;this.texture.setPixels(E(e.colormap));this.texture.generateMipmap()}var r=e.cells;var a=e.positions;if(!a||!r){return}var o=[];var s=[];var f=[];var c=[];var h=[];var v=[];var d=[];var p=[];var g=[];var m=[];var y=[];var b=[];var x=[];var _=[];this.cells=r;this.positions=a;var w=e.vertexNormals;var M=e.cellNormals;var A=e.vertexNormalsEpsilon===void 0?n:e.vertexNormalsEpsilon;var T=e.faceNormalsEpsilon===void 0?i:e.faceNormalsEpsilon;if(e.useFacetNormals&&!M){M=u.faceNormals(r,a,T)}if(!M&&!w){w=u.vertexNormals(r,a,A)}var k=e.vertexColors;var C=e.cellColors;var I=e.meshColor||[1,1,1,1];var P=e.vertexUVs;var O=e.vertexIntensity;var R=e.cellUVs;var N=e.cellIntensity;var z=Infinity;var D=-Infinity;if(!P&&!R){if(O){if(e.vertexIntensityBounds){z=+e.vertexIntensityBounds[0];D=+e.vertexIntensityBounds[1]}else{for(var F=0;F<O.length;++F){var j=O[F];z=Math.min(z,j);D=Math.max(D,j)}}}else if(N){for(var F=0;F<N.length;++F){var j=N[F];z=Math.min(z,j);D=Math.max(D,j)}}else{for(var F=0;F<a.length;++F){var j=a[F][2];z=Math.min(z,j);D=Math.max(D,j)}}}if(O){this.intensity=O}else if(N){this.intensity=S(r,a.length,N)}else{this.intensity=L(a)}var B=e.pointSizes;var U=e.pointSize||1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(var F=0;F<a.length;++F){var V=a[F];for(var H=0;H<3;++H){if(isNaN(V[H])||!isFinite(V[H])){continue}this.bounds[0][H]=Math.min(this.bounds[0][H],V[H]);this.bounds[1][H]=Math.max(this.bounds[1][H],V[H])}}var q=0;var G=0;var W=0;e:for(var F=0;F<r.length;++F){var X=r[F];switch(X.length){case 1:var Y=X[0];var V=a[Y];for(var H=0;H<3;++H){if(isNaN(V[H])||!isFinite(V[H])){continue e}}m.push(V[0],V[1],V[2]);var Z;if(k){Z=k[Y]}else if(C){Z=C[F]}else{Z=I}if(Z.length===3){y.push(Z[0],Z[1],Z[2],1)}else{y.push(Z[0],Z[1],Z[2],Z[3])}var Q;if(P){Q=P[Y]}else if(O){Q=[(O[Y]-z)/(D-z),0]}else if(R){Q=R[F]}else if(N){Q=[(N[F]-z)/(D-z),0]}else{Q=[(V[2]-z)/(D-z),0]}b.push(Q[0],Q[1]);if(B){x.push(B[Y])}else{x.push(U)}_.push(F);W+=1;break;case 2:for(var H=0;H<2;++H){var Y=X[H];var V=a[Y];for(var K=0;K<3;++K){if(isNaN(V[K])||!isFinite(V[K])){continue e}}}for(var H=0;H<2;++H){var Y=X[H];var V=a[Y];v.push(V[0],V[1],V[2]);var Z;if(k){Z=k[Y]}else if(C){Z=C[F]}else{Z=I}if(Z.length===3){d.push(Z[0],Z[1],Z[2],1)}else{d.push(Z[0],Z[1],Z[2],Z[3])}var Q;if(P){Q=P[Y]}else if(O){Q=[(O[Y]-z)/(D-z),0]}else if(R){Q=R[F]}else if(N){Q=[(N[F]-z)/(D-z),0]}else{Q=[(V[2]-z)/(D-z),0]}p.push(Q[0],Q[1]);g.push(F)}G+=1;break;case 3:for(var H=0;H<3;++H){var Y=X[H];var V=a[Y];for(var K=0;K<3;++K){if(isNaN(V[K])||!isFinite(V[K])){continue e}}}for(var H=0;H<3;++H){var Y=X[H];var V=a[Y];o.push(V[0],V[1],V[2]);var Z;if(k){Z=k[Y]}else if(C){Z=C[F]}else{Z=I}if(Z.length===3){s.push(Z[0],Z[1],Z[2],1)}else{s.push(Z[0],Z[1],Z[2],Z[3])}var Q;if(P){Q=P[Y]}else if(O){Q=[(O[Y]-z)/(D-z),0]}else if(R){Q=R[F]}else if(N){Q=[(N[F]-z)/(D-z),0]}else{Q=[(V[2]-z)/(D-z),0]}c.push(Q[0],Q[1]);var J;if(w){J=w[Y]}else{J=M[F]}f.push(J[0],J[1],J[2]);h.push(F)}q+=1;break;default:break}}this.pointCount=W;this.edgeCount=G;this.triangleCount=q;this.pointPositions.update(m);this.pointColors.update(y);this.pointUVs.update(b);this.pointSizes.update(x);this.pointIds.update(new Uint32Array(_));this.edgePositions.update(v);this.edgeColors.update(d);this.edgeUVs.update(p);this.edgeIds.update(new Uint32Array(g));this.trianglePositions.update(o);this.triangleColors.update(s);this.triangleUVs.update(c);this.triangleNormals.update(f);this.triangleIds.update(new Uint32Array(h))};k.drawTransparent=k.draw=function(e){e=e||{};var t=this.gl;var r=e.model||A;var n=e.view||A;var i=e.projection||A;var a=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){a[0][o]=Math.max(a[0][o],this.clipBounds[0][o]);a[1][o]=Math.min(a[1][o],this.clipBounds[1][o])}var s={model:r,view:n,projection:i,clipBounds:a,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,contourColor:this.contourColor,texture:0};this.texture.bind(0);var l=new Array(16);f(l,s.view,s.model);f(l,s.projection,l);c(l,l);for(var o=0;o<3;++o){s.eyePosition[o]=l[12+o]/l[15]}var u=l[15];for(var o=0;o<3;++o){u+=this.lightPosition[o]*l[4*o+3]}for(var o=0;o<3;++o){var h=l[12+o];for(var v=0;v<3;++v){h+=l[4*v+o]*this.lightPosition[v]}s.lightPosition[o]=h/u}if(this.triangleCount>0){var d=this.triShader;d.bind();d.uniforms=s;this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var d=this.lineShader;d.bind();d.uniforms=s;this.edgeVAO.bind();t.lineWidth(this.lineWidth);t.drawArrays(t.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var d=this.pointShader;d.bind();d.uniforms=s;this.pointVAO.bind();t.drawArrays(t.POINTS,0,this.pointCount);this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var d=this.contourShader;d.bind();d.uniforms=s;this.contourVAO.bind();t.drawArrays(t.LINES,0,this.contourCount);this.contourVAO.unbind()}};k.drawPick=function(e){e=e||{};var t=this.gl;var r=e.model||A;var n=e.view||A;var i=e.projection||A;var a=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){a[0][o]=Math.max(a[0][o],this.clipBounds[0][o]);a[1][o]=Math.min(a[1][o],this.clipBounds[1][o])}this._model=[].slice.call(r);this._view=[].slice.call(n);this._projection=[].slice.call(i);this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:r,view:n,projection:i,clipBounds:a,pickId:this.pickId/255};var l=this.pickShader;l.bind();l.uniforms=s;if(this.triangleCount>0){this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0){this.edgeVAO.bind();t.lineWidth(this.lineWidth);t.drawArrays(t.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var l=this.pointPickShader;l.bind();l.uniforms=s;this.pointVAO.bind();t.drawArrays(t.POINTS,0,this.pointCount);this.pointVAO.unbind()}};k.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=e.value[0]+256*e.value[1]+65536*e.value[2];var r=this.cells[t];var n=this.positions;var i=new Array(r.length);for(var a=0;a<r.length;++a){i[a]=n[r[a]]}var o=m(i,[e.coord[0],this._resolution[1]-e.coord[1]],this._model,this._view,this._projection,this._resolution);if(!o){return null}var s=o[2];var l=0;for(var a=0;a<r.length;++a){l+=s[a]*this.intensity[r[a]]}return{position:o[1],index:r[o[0]],cell:r,cellId:t,intensity:l,dataCoordinate:this.positions[r[o[0]]]}};k.dispose=function(){this.texture.dispose();this.triShader.dispose();this.lineShader.dispose();this.pointShader.dispose();this.pickShader.dispose();this.pointPickShader.dispose();this.triangleVAO.dispose();this.trianglePositions.dispose();this.triangleColors.dispose();this.triangleUVs.dispose();this.triangleNormals.dispose();this.triangleIds.dispose();this.edgeVAO.dispose();this.edgePositions.dispose();this.edgeColors.dispose();this.edgeUVs.dispose();this.edgeIds.dispose();this.pointVAO.dispose();this.pointPositions.dispose();this.pointColors.dispose();this.pointUVs.dispose();this.pointSizes.dispose();this.pointIds.dispose();this.contourVAO.dispose();this.contourPositions.dispose();this.contourShader.dispose()};function C(e){var t=a(e,y.vertex,y.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;t.attributes.normal.location=4;return t}function I(e){var t=a(e,b.vertex,b.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;return t}function P(e){var t=a(e,x.vertex,x.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;t.attributes.pointSize.location=4;return t}function O(e){var t=a(e,_.vertex,_.fragment);t.attributes.position.location=0;t.attributes.id.location=1;return t}function R(e){var t=a(e,w.vertex,w.fragment);t.attributes.position.location=0;t.attributes.id.location=1;t.attributes.pointSize.location=4;return t}function N(e){var t=a(e,M.vertex,M.fragment);t.attributes.position.location=0;return t}function z(e,t){if(arguments.length===1){t=e;e=t.gl}var r=e.getExtension("OES_standard_derivatives")||e.getExtension("MOZ_OES_standard_derivatives")||e.getExtension("WEBKIT_OES_standard_derivatives");if(!r)throw new Error("derivatives not supported");var n=C(e);var i=I(e);var a=P(e);var u=O(e);var f=R(e);var c=N(e);var v=l(e,h(new Uint8Array([255,255,255,255]),[1,1,4]));v.generateMipmap();v.minFilter=e.LINEAR_MIPMAP_LINEAR;v.magFilter=e.LINEAR;var d=o(e);var p=o(e);var g=o(e);var m=o(e);var y=o(e);var b=s(e,[{buffer:d,type:e.FLOAT,size:3},{buffer:y,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:p,type:e.FLOAT,size:4},{buffer:g,type:e.FLOAT,size:2},{buffer:m,type:e.FLOAT,size:3}]);var x=o(e);var _=o(e);var w=o(e);var M=o(e);var A=s(e,[{buffer:x,type:e.FLOAT,size:3},{buffer:M,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:_,type:e.FLOAT,size:4},{buffer:w,type:e.FLOAT,size:2}]);var k=o(e);var E=o(e);var S=o(e);var L=o(e);var z=o(e);var D=s(e,[{buffer:k,type:e.FLOAT,size:3},{buffer:z,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:E,type:e.FLOAT,size:4},{buffer:S,type:e.FLOAT,size:2},{buffer:L,type:e.FLOAT,size:1}]);var F=o(e);var j=s(e,[{buffer:F,type:e.FLOAT,size:3}]);var B=new T(e,v,n,i,a,u,f,c,d,y,p,g,m,b,x,M,_,w,A,k,z,E,S,L,D,F,j);B.update(t);return B}t.exports=z},{"./lib/closest-point":137,"./lib/shaders":138,colormap:68,"gl-buffer":104,"gl-mat4/invert":125,"gl-mat4/multiply":127,"gl-shader":147,"gl-texture2d":162,"gl-vao":166,ndarray:270,normals:272,"simplicial-complex-contour":314,"typedarray-pool":333}],140:[function(e,t,r){var n=e("glslify");var i=e("gl-shader");var a=n(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);t.exports=function(e){return i(e,a,o,null,[{name:"position",type:"vec2"}])}},{"gl-shader":147,glslify:235}],141:[function(e,t,r){"use strict";t.exports=y;var n=e("3d-view-controls");var i=e("gl-axes3d");var a=e("gl-axes3d/properties");var o=e("gl-spikes3d");var s=e("gl-select-static");var l=e("gl-fbo");var u=e("a-big-triangle");var f=e("mouse-change");var c=e("gl-mat4/perspective");var h=e("./lib/shader");var v=e("is-mobile")();function d(){this.mouse=[-1,-1];this.screen=null;this.distance=Infinity;this.index=null;this.dataCoordinate=null;this.dataPosition=null;this.object=null;this.data=null}function p(e,t){var r=null;try{r=e.getContext("webgl",t);if(!r){r=e.getContext("experimental-webgl",t)}}catch(e){return null}return r}function g(e){var t=Math.round(Math.log(Math.abs(e))/Math.log(10));if(t<0){var r=Math.round(Math.pow(10,-t));return Math.ceil(e*r)/r}else if(t>0){var r=Math.round(Math.pow(10,t));return Math.ceil(e/r)*r}return Math.ceil(e)}function m(e){if(typeof e==="boolean"){return e}return true}function y(e){e=e||{};var t=false;var r=e.pixelRatio||parseFloat(window.devicePixelRatio);var y=e.canvas;if(!y){y=document.createElement("canvas");if(e.container){var b=e.container;b.appendChild(y)}else{document.body.appendChild(y)}}var x=e.gl;if(!x){x=p(y,e.glOptions||{premultipliedAlpha:true,antialias:true})}if(!x){throw new Error("webgl not supported")}var _=e.bounds||[[-10,-10,-10],[10,10,10]];var w=new d;var M=l(x,[x.drawingBufferWidth,x.drawingBufferHeight],{preferFloat:!v});var A=h(x);var T=e.camera||{eye:[2,0,0],center:[0,0,0],up:[0,1,0],zoomMin:.1,zoomMax:100,mode:"turntable"};var k=e.axes||{};var E=i(x,k);E.enable=!k.disable;var S=e.spikes||{};var L=o(x,S);var C=[];var I=[];var P=[];var O=[];var R=true;var N=true;var z=new Array(16);var D=new Array(16);var F={view:null,projection:z,model:D};var N=true;var j=[x.drawingBufferWidth,x.drawingBufferHeight];var B={gl:x,contextLost:false,pixelRatio:e.pixelRatio||parseFloat(window.devicePixelRatio),canvas:y,selection:w,camera:n(y,T),axes:E,axesPixels:null,spikes:L,bounds:_,objects:C,shape:j,aspect:e.aspectRatio||[1,1,1],pickRadius:e.pickRadius||10,zNear:e.zNear||.01,zFar:e.zFar||1e3,fovy:e.fovy||Math.PI/4,clearColor:e.clearColor||[0,0,0,0],autoResize:m(e.autoResize),autoBounds:m(e.autoBounds),autoScale:!!e.autoScale,autoCenter:m(e.autoCenter),clipToBounds:m(e.clipToBounds),snapToData:!!e.snapToData,onselect:e.onselect||null,onrender:e.onrender||null,onclick:e.onclick||null,cameraParams:F,oncontextloss:null,mouseListener:null};var U=[x.drawingBufferWidth/B.pixelRatio|0,x.drawingBufferHeight/B.pixelRatio|0];function V(){if(t){return}if(!B.autoResize){return}var e=y.parentNode;var r=1;var n=1;if(e&&e!==document.body){r=e.clientWidth;n=e.clientHeight}else{r=window.innerWidth;n=window.innerHeight}var i=Math.ceil(r*B.pixelRatio)|0;var a=Math.ceil(n*B.pixelRatio)|0;if(i!==y.width||a!==y.height){y.width=i;y.height=a;var o=y.style;o.position=o.position||"absolute";o.left="0px";o.top="0px";o.width=r+"px";o.height=n+"px";R=true}}if(B.autoResize){V()}window.addEventListener("resize",V);function H(){var e=C.length;var t=O.length;for(var r=0;r<t;++r){P[r]=0}e:for(var r=0;r<e;++r){var n=C[r];var i=n.pickSlots;if(!i){I[r]=-1;continue}for(var a=0;a<t;++a){if(P[a]+i<255){I[r]=a;n.setPickBase(P[a]+1);P[a]+=i;continue e}}var o=s(x,j);I[r]=t;O.push(o);P.push(i);n.setPickBase(1);t+=1}while(t>0&&P[t-1]===0){P.pop();O.pop().dispose()}}B.update=function(e){if(t){return}e=e||{};R=true;N=true};B.add=function(e){if(t){return}e.axes=E;C.push(e);I.push(-1);R=true;N=true;H()};B.remove=function(e){if(t){return}var r=C.indexOf(e);if(r<0){return}C.splice(r,1);I.pop();R=true;N=true;H()};B.dispose=function(){if(t){return}t=true;window.removeEventListener("resize",V);y.removeEventListener("webglcontextlost",W);B.mouseListener.enabled=false;if(B.contextLost){return}E.dispose();L.dispose();for(var e=0;e<C.length;++e){C[e].dispose()}M.dispose();for(var e=0;e<O.length;++e){O[e].dispose()}A.dispose();x=null;E=null;L=null;C=[]};var q=false;var G=0;B.mouseListener=f(y,function(e,r,n){if(t){return}var i=O.length;var a=C.length;var o=w.object;w.distance=Infinity;w.mouse[0]=r;w.mouse[1]=n;w.object=null;w.screen=null;w.dataCoordinate=w.dataPosition=null;var s=false;if(e&&G){q=true}else{if(q){N=true}q=false;for(var l=0;l<i;++l){var u=O[l].query(r,U[1]-n-1,B.pickRadius);if(u){if(u.distance>w.distance){continue}for(var f=0;f<a;++f){var c=C[f];if(I[f]!==l){continue}var h=c.pick(u);if(h){w.buttons=e;w.screen=u.coord;w.distance=u.distance;w.object=c;w.index=h.distance;w.dataPosition=h.position;w.dataCoordinate=h.dataCoordinate;w.data=h;s=true}}}}}if(o&&o!==w.object){if(o.highlight){o.highlight(null)}R=true}if(w.object){if(w.object.highlight){w.object.highlight(w.data)}R=true}s=s||w.object!==o;if(s&&B.onselect){B.onselect(w)}if(e&1&&!(G&1)&&B.onclick){B.onclick(w)}G=e});function W(){if(B.contextLost){return true}if(x.isContextLost()){B.contextLost=true;B.mouseListener.enabled=false;B.selection.object=null;if(B.oncontextloss){B.oncontextloss()}}}y.addEventListener("webglcontextlost",W);function X(){if(W()){return}x.colorMask(true,true,true,true);x.depthMask(true);x.disable(x.BLEND);x.enable(x.DEPTH_TEST);var e=C.length;var t=O.length;for(var r=0;r<t;++r){var n=O[r];n.shape=U;n.begin();for(var i=0;i<e;++i){if(I[i]!==r){continue}var a=C[i];if(a.drawPick){a.pixelRatio=1;a.drawPick(F)}}n.end()}}var Y=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];var Z=[Y[0].slice(),Y[1].slice()];function Q(){if(W()){return}V();var e=B.camera.tick();F.view=B.camera.matrix;R=R||e;N=N||e;E.pixelRatio=B.pixelRatio;L.pixelRatio=B.pixelRatio;var t=C.length;var r=Y[0];var n=Y[1];r[0]=r[1]=r[2]=Infinity;n[0]=n[1]=n[2]=-Infinity;for(var i=0;i<t;++i){var o=C[i];o.pixelRatio=B.pixelRatio;o.axes=B.axes;R=R||!!o.dirty;N=N||!!o.dirty;var s=o.bounds;if(s){var l=s[0];var f=s[1];for(var h=0;h<3;++h){r[h]=Math.min(r[h],l[h]);n[h]=Math.max(n[h],f[h])}}}var v=B.bounds;if(B.autoBounds){for(var h=0;h<3;++h){if(n[h]<r[h]){r[h]=-1;n[h]=1}else{if(r[h]===n[h]){r[h]-=1;n[h]+=1}var d=.05*(n[h]-r[h]);r[h]=r[h]-d;n[h]=n[h]+d}v[0][h]=r[h];v[1][h]=n[h]}}var p=false;for(var h=0;h<3;++h){p=p||Z[0][h]!==v[0][h]||Z[1][h]!==v[1][h];Z[0][h]=v[0][h];Z[1][h]=v[1][h]}N=N||p;R=R||p;if(!R){return}if(p){var m=[0,0,0];for(var i=0;i<3;++i){m[i]=g((v[1][i]-v[0][i])/10)}if(E.autoTicks){E.update({bounds:v,tickSpacing:m})}else{E.update({bounds:v})}}var y=x.drawingBufferWidth;var b=x.drawingBufferHeight;j[0]=y;j[1]=b;U[0]=Math.max(y/B.pixelRatio,1)|0;U[1]=Math.max(b/B.pixelRatio,1)|0;c(z,B.fovy,y/b,B.zNear,B.zFar);for(var i=0;i<16;++i){D[i]=0}D[15]=1;var _=0;for(var i=0;i<3;++i){_=Math.max(_,v[1][i]-v[0][i])}for(var i=0;i<3;++i){if(B.autoScale){D[5*i]=B.aspect[i]/(v[1][i]-v[0][i])}else{D[5*i]=1/_}if(B.autoCenter){D[12+i]=-D[5*i]*.5*(v[0][i]+v[1][i])}}for(var i=0;i<t;++i){var o=C[i];o.axesBounds=v;if(B.clipToBounds){o.clipBounds=v}}if(w.object){if(B.snapToData){L.position=w.dataCoordinate}else{L.position=w.dataPosition}L.bounds=v}if(N){N=false;X()}B.axesPixels=a(B.axes,F,y,b);if(B.onrender){B.onrender()}x.bindFramebuffer(x.FRAMEBUFFER,null);x.viewport(0,0,y,b);var T=B.clearColor;x.clearColor(T[0],T[1],T[2],T[3]);x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT);x.depthMask(true);x.colorMask(true,true,true,true);x.enable(x.DEPTH_TEST);x.depthFunc(x.LEQUAL);x.disable(x.BLEND);x.disable(x.CULL_FACE);var k=false;if(E.enable){k=k||E.isTransparent();E.draw(F)}L.axes=E;if(w.object){L.draw(F)}x.disable(x.CULL_FACE);for(var i=0;i<t;++i){var o=C[i];o.axes=E;o.pixelRatio=B.pixelRatio;if(o.isOpaque&&o.isOpaque()){o.draw(F)}if(o.isTransparent&&o.isTransparent()){k=true}}if(k){M.shape=j;M.bind();x.clear(x.DEPTH_BUFFER_BIT);x.colorMask(false,false,false,false);x.depthMask(true);x.depthFunc(x.LESS);if(E.enable&&E.isTransparent()){E.drawTransparent(F)}for(var i=0;i<t;++i){var o=C[i];if(o.isOpaque&&o.isOpaque()){o.draw(F)}}x.enable(x.BLEND);x.blendEquation(x.FUNC_ADD);x.blendFunc(x.ONE,x.ONE_MINUS_SRC_ALPHA);x.colorMask(true,true,true,true);x.depthMask(false);x.clearColor(0,0,0,0);x.clear(x.COLOR_BUFFER_BIT);if(E.isTransparent()){E.drawTransparent(F)}for(var i=0;i<t;++i){var o=C[i];if(o.isTransparent&&o.isTransparent()){o.drawTransparent(F)}}x.bindFramebuffer(x.FRAMEBUFFER,null);x.blendFunc(x.ONE,x.ONE_MINUS_SRC_ALPHA);x.disable(x.DEPTH_TEST);A.bind();M.color[0].bind(0);A.uniforms.accumBuffer=0;u(x);x.disable(x.BLEND)}R=false;for(var i=0;i<t;++i){C[i].dirty=false}}function K(){if(t||B.contextLost){return}requestAnimationFrame(K);Q()}K();B.redraw=function(){if(t){return}R=true;Q()};return B}},{"./lib/shader":140,"3d-view-controls":10,"a-big-triangle":12,"gl-axes3d":96,"gl-axes3d/properties":103,"gl-fbo":113,"gl-mat4/perspective":128,"gl-select-static":146,"gl-spikes3d":155,"is-mobile":245,"mouse-change":255}],142:[function(e,t,r){t.exports=n;function n(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],l=r[0],u=r[1],f=r[2],c=r[3];var h,v,d,p,g;v=i*l+a*u+o*f+s*c;if(v<0){v=-v;l=-l;u=-u;f=-f;c=-c}if(1-v>1e-6){h=Math.acos(v);d=Math.sin(h);p=Math.sin((1-n)*h)/d;g=Math.sin(n*h)/d}else{p=1-n;g=n}e[0]=p*i+g*l;e[1]=p*a+g*u;e[2]=p*o+g*f;e[3]=p*s+g*c;return e}},{}],143:[function(e,t,r){"use strict";var n=e("vectorize-text");t.exports=a;var i={};function a(e,t){var r=i[t];if(!r){r=i[t]={}}if(e in r){return r[e]}var a=n(e,{textAlign:"center",textBaseline:"middle",lineHeight:1,font:t});var o=n(e,{triangles:true,textAlign:"center",textBaseline:"middle",lineHeight:1,font:t});var s=[[Infinity,Infinity],[-Infinity,-Infinity]];for(var l=0;l<a.positions.length;++l){var u=a.positions[l];for(var f=0;f<2;++f){s[0][f]=Math.min(s[0][f],u[f]);s[1][f]=Math.max(s[1][f],u[f])}}return r[e]=[o,a,s]}},{"vectorize-text":336}],144:[function(e,t,r){var n=e("gl-shader");var i=e("glslify");var a=i(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0]))   || \n     any(greaterThan(position, clipBounds[1])) ) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n    \n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]);var o=i(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0])) || any(greaterThan(position, clipBounds[1]))) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n    \n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]);var s=i(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(position, clipBounds[0]))   ||\n     any(greaterThan(position, clipBounds[1])) ) {\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]);var l=i(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0]))   ||\n     any(greaterThan(dataCoordinate, fragClipBounds[1])) ) {\n    discard;\n  } else {\n    gl_FragColor = interpColor * opacity;\n  }\n}\n"]);var u=i(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if(any(lessThan(dataCoordinate, fragClipBounds[0]))   || \n     any(greaterThan(dataCoordinate, fragClipBounds[1])) ) {\n    discard;\n  } else {\n    gl_FragColor = vec4(pickGroup, pickId.bgr);\n  }\n}"]);var f=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}];var c={vertex:a,fragment:l,attributes:f},h={vertex:o,fragment:l,attributes:f},v={vertex:s,fragment:l,attributes:f},d={vertex:a,fragment:u,attributes:f},p={vertex:o,fragment:u,attributes:f},g={vertex:s,fragment:u,attributes:f};function m(e,t){var r=n(e,t);var i=r.attributes;i.position.location=0;i.color.location=1;i.glyph.location=2;i.id.location=3;return r}r.createPerspective=function(e){return m(e,c)};r.createOrtho=function(e){return m(e,h)};r.createProject=function(e){return m(e,v)};r.createPickPerspective=function(e){return m(e,d)};r.createPickOrtho=function(e){return m(e,p)};r.createPickProject=function(e){return m(e,g)}},{"gl-shader":147,glslify:235}],145:[function(e,t,r){"use strict";var n=e("gl-buffer");var i=e("gl-vao");var a=e("typedarray-pool");var o=e("gl-mat4/multiply");var s=e("./lib/shaders");var l=e("./lib/glyphs");var u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];t.exports=O;function f(e,t){var r=e[0];var n=e[1];var i=e[2];var a=e[3];e[0]=t[0]*r+t[4]*n+t[8]*i+t[12]*a;e[1]=t[1]*r+t[5]*n+t[9]*i+t[13]*a;e[2]=t[2]*r+t[6]*n+t[10]*i+t[14]*a;e[3]=t[3]*r+t[7]*n+t[11]*i+t[15]*a;return e}function c(e,t,r,n){f(n,n,r);f(n,n,t);return f(n,n,e)}function h(e){var t=new Array(3);for(var r=0;r<3;++r){t[r]=Math.min(Math.max(e[r],-1e8),1e8)}return t}function v(e,t){this.index=e;this.dataCoordinate=this.position=t}function d(e,t,r,n,i,a,o,s,l,u,f,c){this.gl=e;this.pixelRatio=1;this.shader=t;this.orthoShader=r;this.projectShader=n;this.pointBuffer=i;this.colorBuffer=a;this.glyphBuffer=o;this.idBuffer=s;this.vao=l;this.vertexCount=0;this.lineVertexCount=0;this.opacity=1;this.lineWidth=0;this.projectScale=[2/3,2/3,2/3];this.projectOpacity=[1,1,1];this.pickId=0;this.pickPerspectiveShader=u;this.pickOrthoShader=f;this.pickProjectShader=c;this.points=[];this._selectResult=new v(0,[0,0,0]);this.useOrtho=true;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.axesProject=[true,true,true];this.axesBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.highlightId=[1,1,1,1];this.highlightScale=2;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.dirty=true}var p=d.prototype;p.pickSlots=1;p.setPickBase=function(e){this.pickId=e};p.isTransparent=function(){if(this.opacity<1){return true}for(var e=0;e<3;++e){if(this.axesProject[e]&&this.projectOpacity[e]<1){return true}}return false};p.isOpaque=function(){if(this.opacity>=1){return true}for(var e=0;e<3;++e){if(this.axesProject[e]&&this.projectOpacity[e]>=1){return true}}return false};var g=[0,0];var m=[0,0,0];var y=[0,0,0];var b=[0,0,0,1];var x=[0,0,0,1];var _=u.slice();var w=[0,0,0];var M=[[0,0,0],[0,0,0]];function A(e){e[0]=e[1]=e[2]=0;return e}function T(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=1;return e}function k(e,t,r,n){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[r]=n;return e}function E(e){var t=M;for(var r=0;r<2;++r){for(var n=0;n<3;++n){t[r][n]=Math.max(Math.min(e[r][n],1e8),-1e8)}}return t}function S(e,t,r,n,i){var a=t.axesProject;var s=t.gl;var l=e.uniforms;var f=r.model||u;var h=r.view||u;var v=r.projection||u;var d=t.axesBounds;var p=E(t.clipBounds);var M;if(t.axes&&t.axes.lastCubeProps){M=t.axes.lastCubeProps.axis}else{M=[1,1,1]}g[0]=2/s.drawingBufferWidth;g[1]=2/s.drawingBufferHeight;e.bind();l.view=h;l.projection=v;l.screenSize=g;l.highlightId=t.highlightId;l.highlightScale=t.highlightScale;l.clipBounds=p;l.pickGroup=t.pickId/255;l.pixelRatio=t.pixelRatio;for(var S=0;S<3;++S){if(!a[S]){continue}if(t.projectOpacity[S]<1!==n){continue}l.scale=t.projectScale[S];l.opacity=t.projectOpacity[S];var L=_;for(var C=0;C<16;++C){L[C]=0}for(var C=0;C<4;++C){L[5*C]=1}L[5*S]=0;if(M[S]<0){L[12+S]=d[0][S]}else{L[12+S]=d[1][S]}o(L,f,L);l.model=L;var I=(S+1)%3;var P=(S+2)%3;var O=A(m);var R=A(y);O[I]=1;R[P]=1;var N=c(v,h,f,T(b,O));var z=c(v,h,f,T(x,R));if(Math.abs(N[1])>Math.abs(z[1])){var D=N;N=z;z=D;D=O;O=R;R=D;var F=I;I=P;P=F}if(N[0]<0){O[I]=-1}if(z[1]>0){R[P]=-1}var j=0;var B=0;for(var C=0;C<4;++C){j+=Math.pow(f[4*I+C],2);B+=Math.pow(f[4*P+C],2)}O[I]/=Math.sqrt(j);R[P]/=Math.sqrt(B);l.axes[0]=O;l.axes[1]=R;l.fragClipBounds[0]=k(w,p[0],S,-1e8);l.fragClipBounds[1]=k(w,p[1],S,1e8);t.vao.draw(s.TRIANGLES,t.vertexCount);if(t.lineWidth>0){s.lineWidth(t.lineWidth);t.vao.draw(s.LINES,t.lineVertexCount,t.vertexCount)}}}var L=[-1e8,-1e8,-1e8];var C=[1e8,1e8,1e8];var I=[L,C];function P(e,t,r,n,i,a){var o=r.gl;r.vao.bind();if(i===r.opacity<1||a){e.bind();var s=e.uniforms;s.model=n.model||u;s.view=n.view||u;s.projection=n.projection||u;g[0]=2/o.drawingBufferWidth;g[1]=2/o.drawingBufferHeight;s.screenSize=g;s.highlightId=r.highlightId;s.highlightScale=r.highlightScale;s.fragClipBounds=I;s.clipBounds=r.axes.bounds;s.opacity=r.opacity;s.pickGroup=r.pickId/255;s.pixelRatio=r.pixelRatio;r.vao.draw(o.TRIANGLES,r.vertexCount);if(r.lineWidth>0){o.lineWidth(r.lineWidth);r.vao.draw(o.LINES,r.lineVertexCount,r.vertexCount)}}S(t,r,n,i,a);r.vao.unbind()}p.draw=function(e){var t=this.useOrtho?this.orthoShader:this.shader;P(t,this.projectShader,this,e,false,false)};p.drawTransparent=function(e){var t=this.useOrtho?this.orthoShader:this.shader;P(t,this.projectShader,this,e,true,false)};p.drawPick=function(e){var t=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;P(t,this.pickProjectShader,this,e,false,true)};p.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=e.value[2]+(e.value[1]<<8)+(e.value[0]<<16);if(t>=this.pointCount||t<0){return null}var r=this.points[t];var n=this._selectResult;n.index=t;for(var i=0;i<3;++i){n.position[i]=n.dataCoordinate[i]=r[i]}return n};p.highlight=function(e){if(!e){this.highlightId=[1,1,1,1]}else{var t=e.index;var r=t&255;var n=t>>8&255;var i=t>>16&255;this.highlightId=[r/255,n/255,i/255,0]}};p.update=function(e){e=e||{};if("perspective"in e){this.useOrtho=!e.perspective}if("orthographic"in e){this.useOrtho=!!e.orthographic}if("lineWidth"in e){this.lineWidth=e.lineWidth}if("project"in e){if(Array.isArray(e.project)){this.axesProject=e.project}else{var t=!!e.project;this.axesProject=[t,t,t]}}if("projectScale"in e){if(Array.isArray(e.projectScale)){this.projectScale=e.projectScale.slice()}else{var r=+e.projectScale;this.projectScale=[r,r,r]}}if("projectOpacity"in e){if(Array.isArray(e.projectOpacity)){this.projectOpacity=e.projectOpacity.slice()}else{var r=+e.projectOpacity;this.projectOpacity=[r,r,r]}}if("opacity"in e){this.opacity=e.opacity}this.dirty=true;var n=e.position;if(!n){return}var i=e.font||"normal";var o=e.alignment||[0,0];var s=[Infinity,Infinity,Infinity];var u=[-Infinity,-Infinity,-Infinity];var f=e.glyph;var c=e.color;var h=e.size;var v=e.angle;var d=e.lineColor;var p=0;var g=0;var m=0;var y=n.length;e:for(var b=0;b<y;++b){var x=n[b];for(var _=0;_<3;++_){if(isNaN(x[_])||!isFinite(x[_])){continue e}}var w;if(Array.isArray(f)){w=l(f[b],i)}else if(f){w=l(f,i)}else{w=l("\u25cf",i)}var M=w[0];var A=w[1];var T=w[2];g+=M.cells.length*3;m+=A.edges.length*2}var k=g+m;var E=a.mallocFloat(3*k);var S=a.mallocFloat(4*k);var L=a.mallocFloat(2*k);var C=a.mallocUint32(k);var I=[0,o[1]];var P=0;var O=g;var R=[0,0,0,1];var N=[0,0,0,1];var z=Array.isArray(c)&&Array.isArray(c[0]);var D=Array.isArray(d)&&Array.isArray(d[0]);e:for(var b=0;b<y;++b){var x=n[b];for(var _=0;_<3;++_){if(isNaN(x[_])||!isFinite(x[_])){p+=1;continue e}u[_]=Math.max(u[_],x[_]);s[_]=Math.min(s[_],x[_])}var w;if(Array.isArray(f)){w=l(f[b],i)}else if(f){w=l(f,i)}else{w=l("\u25cf",i)}var M=w[0];var A=w[1];var T=w[2];if(Array.isArray(c)){var F;if(z){F=c[b]}else{F=c}if(F.length===3){for(var _=0;_<3;++_){R[_]=F[_]}R[3]=1}else if(F.length===4){for(var _=0;_<4;++_){R[_]=F[_]}}}else{R[0]=R[1]=R[2]=0;R[3]=1}if(Array.isArray(d)){var F;if(D){F=d[b]}else{F=d}if(F.length===3){for(var _=0;_<3;++_){N[_]=F[_]}N[_]=1}else if(F.length===4){for(var _=0;_<4;++_){N[_]=F[_]}}}else{N[0]=N[1]=N[2]=0;N[3]=1}var j=.5;if(Array.isArray(h)){j=+h[b]}else if(h){j=+h}else if(this.useOrtho){j=12}var B=0;if(Array.isArray(v)){B=+v[b]}else if(v){B=+v}var U=Math.cos(B);var V=Math.sin(B);var x=n[b];for(var _=0;_<3;++_){u[_]=Math.max(u[_],x[_]);s[_]=Math.min(s[_],x[_])}if(o[0]<0){I[0]=o[0]*(1+T[1][0])}else if(o[0]>0){I[0]=-o[0]*(1+T[0][0])}var H=M.cells;var q=M.positions;for(var _=0;_<H.length;++_){var G=H[_];for(var W=0;W<3;++W){for(var X=0;X<3;++X){E[3*P+X]=x[X]}for(var X=0;X<4;++X){S[4*P+X]=R[X]}C[P]=p;var Y=q[G[W]];L[2*P]=j*(U*Y[0]-V*Y[1]+I[0]);L[2*P+1]=j*(V*Y[0]+U*Y[1]+I[1]);P+=1}}var H=A.edges;var q=A.positions;for(var _=0;_<H.length;++_){var G=H[_];for(var W=0;W<2;++W){for(var X=0;X<3;++X){E[3*O+X]=x[X]}for(var X=0;X<4;++X){S[4*O+X]=N[X]}C[O]=p;var Y=q[G[W]];L[2*O]=j*(U*Y[0]-V*Y[1]+I[0]);L[2*O+1]=j*(V*Y[0]+U*Y[1]+I[1]);O+=1}}p+=1}this.vertexCount=g;this.lineVertexCount=m;this.pointBuffer.update(E);this.colorBuffer.update(S);this.glyphBuffer.update(L);this.idBuffer.update(new Uint32Array(C));a.free(E);a.free(S);a.free(L);a.free(C);this.bounds=[s,u];this.points=n;this.pointCount=n.length};p.dispose=function(){this.shader.dispose();this.orthoShader.dispose();this.pickPerspectiveShader.dispose();this.pickOrthoShader.dispose();this.vao.dispose();this.pointBuffer.dispose();this.colorBuffer.dispose();this.glyphBuffer.dispose();this.idBuffer.dispose()};function O(e){var t=e.gl;var r=s.createPerspective(t);var a=s.createOrtho(t);var o=s.createProject(t);var l=s.createPickPerspective(t);var u=s.createPickOrtho(t);var f=s.createPickProject(t);var c=n(t);var h=n(t);var v=n(t);var p=n(t);var g=i(t,[{buffer:c,size:3,type:t.FLOAT},{buffer:h,size:4,type:t.FLOAT},{buffer:v,size:2,type:t.FLOAT},{buffer:p,size:4,type:t.UNSIGNED_BYTE,normalized:true}]);var m=new d(t,r,a,o,c,h,v,p,g,l,u,f);m.update(e);return m}},{"./lib/glyphs":143,"./lib/shaders":144,"gl-buffer":104,"gl-mat4/multiply":127,"gl-vao":166,"typedarray-pool":333}],146:[function(e,t,r){"use strict";t.exports=c;var n=e("gl-fbo");var i=e("typedarray-pool");var a=e("ndarray");var o=e("bit-twiddle").nextPow2;var s=e("cwise/lib/wrapper")({args:["array",{offset:[0,0,1],array:0},{offset:[0,0,2],array:0},{offset:[0,0,3],array:0},"scalar","scalar","index"],pre:{body:"{this_closestD2=1e8,this_closestX=-1,this_closestY=-1}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},body:{body:"{if(_inline_52_arg0_<255||_inline_52_arg1_<255||_inline_52_arg2_<255||_inline_52_arg3_<255){var _inline_52_l=_inline_52_arg4_-_inline_52_arg6_[0],_inline_52_a=_inline_52_arg5_-_inline_52_arg6_[1],_inline_52_f=_inline_52_l*_inline_52_l+_inline_52_a*_inline_52_a;_inline_52_f<this_closestD2&&(this_closestD2=_inline_52_f,this_closestX=_inline_52_arg6_[0],this_closestY=_inline_52_arg6_[1])}}",args:[{name:"_inline_52_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_52_arg1_",lvalue:false,rvalue:true,count:1},{name:"_inline_52_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_52_arg3_",lvalue:false,rvalue:true,count:1},{name:"_inline_52_arg4_",lvalue:false,rvalue:true,count:1},{name:"_inline_52_arg5_",lvalue:false,rvalue:true,count:1},{name:"_inline_52_arg6_",lvalue:false,rvalue:true,count:4}],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:["_inline_52_a","_inline_52_f","_inline_52_l"]},post:{body:"{return[this_closestX,this_closestY,this_closestD2]}",args:[],thisVars:["this_closestD2","this_closestX","this_closestY"],localVars:[]},debug:false,funcName:"cwise",blockSize:64});function l(e,t,r,n,i){this.coord=[e,t];this.id=r;this.value=n;this.distance=i}function u(e,t,r){this.gl=e;this.fbo=t;this.buffer=r;this._readTimeout=null;var n=this;this._readCallback=function(){if(!n.gl){return}t.bind();e.readPixels(0,0,t.shape[0],t.shape[1],e.RGBA,e.UNSIGNED_BYTE,n.buffer);n._readTimeout=null}}var f=u.prototype;Object.defineProperty(f,"shape",{get:function(){if(!this.gl){return[0,0]}return this.fbo.shape.slice()},set:function(e){if(!this.gl){return}this.fbo.shape=e;var t=this.fbo.shape[0];var r=this.fbo.shape[1];if(r*t*4>this.buffer.length){i.free(this.buffer);var n=this.buffer=i.mallocUint8(o(r*t*4));for(var a=0;a<r*t*4;++a){n[a]=255}}return e}});f.begin=function(){var e=this.gl;var t=this.shape;if(!e){return}this.fbo.bind();e.clearColor(1,1,1,1);e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)};f.end=function(){var e=this.gl;if(!e){return}e.bindFramebuffer(e.FRAMEBUFFER,null);if(!this._readTimeout){clearTimeout(this._readTimeout)}this._readTimeout=setTimeout(this._readCallback,1)};f.query=function(e,t,r){if(!this.gl){return null}var n=this.fbo.shape.slice();e=e|0;t=t|0;if(typeof r!=="number"){r=1}var i=Math.min(Math.max(e-r,0),n[0])|0;var o=Math.min(Math.max(e+r,0),n[0])|0;var u=Math.min(Math.max(t-r,0),n[1])|0;var f=Math.min(Math.max(t+r,0),n[1])|0;if(o<=i||f<=u){return null}var c=[o-i,f-u];var h=a(this.buffer,[c[0],c[1],4],[4,n[0]*4,1],4*(i+n[0]*u));var v=s(h.hi(c[0],c[1],1),r,r);var d=v[0];var p=v[1];if(d<0||Math.pow(this.radius,2)<v[2]){return null}var g=h.get(d,p,0);var m=h.get(d,p,1);var y=h.get(d,p,2);var b=h.get(d,p,3);return new l(d+i|0,p+u|0,g,[m,y,b],Math.sqrt(v[2]))};f.dispose=function(){if(!this.gl){return}this.fbo.dispose();i.free(this.buffer);this.gl=null;if(this._readTimeout){clearTimeout(this._readTimeout)}};function c(e,t){var r=n(e,t);var a=i.mallocUint8(t[0]*t[1]*4);return new u(e,r,a)}},{"bit-twiddle":37,"cwise/lib/wrapper":80,"gl-fbo":113,ndarray:270,"typedarray-pool":333}],147:[function(e,t,r){"use strict";var n=e("./lib/create-uniforms");var i=e("./lib/create-attributes");var a=e("./lib/reflect");var o=e("./lib/shader-cache");var s=e("./lib/runtime-reflect");var l=e("./lib/GLError");function u(e){this.gl=e;this.gl.lastAttribCount=0;this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var f=u.prototype;f.bind=function(){if(!this.program){this._relink()}var e;var t=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES);var r=this.gl.lastAttribCount;if(t>r){for(e=r;e<t;e++){this.gl.enableVertexAttribArray(e)}}else if(r>t){for(e=t;e<r;e++){this.gl.disableVertexAttribArray(e)}}this.gl.lastAttribCount=t;this.gl.useProgram(this.program)};f.dispose=function(){var e=this.gl.lastAttribCount;for(var t=0;t<e;t++){this.gl.disableVertexAttribArray(t)}this.gl.lastAttribCount=0;if(this._fref){this._fref.dispose()}if(this._vref){this._vref.dispose()}this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};function c(e,t){if(e.name<t.name){return-1}return 1}f.update=function(e,t,r,u){if(!t||arguments.length===1){var f=e;e=f.vertex;t=f.fragment;r=f.uniforms;u=f.attributes}var h=this;var v=h.gl;var d=h._vref;h._vref=o.shader(v,v.VERTEX_SHADER,e);if(d){d.dispose()}h.vertShader=h._vref.shader;var p=this._fref;h._fref=o.shader(v,v.FRAGMENT_SHADER,t);if(p){p.dispose()}h.fragShader=h._fref.shader;if(!r||!u){var g=v.createProgram();v.attachShader(g,h.fragShader);v.attachShader(g,h.vertShader);v.linkProgram(g);if(!v.getProgramParameter(g,v.LINK_STATUS)){var m=v.getProgramInfoLog(g);throw new l(m,"Error linking program:"+m)}r=r||s.uniforms(v,g);u=u||s.attributes(v,g);v.deleteProgram(g)}u=u.slice();u.sort(c);var y=[];var b=[];var x=[];var _;for(_=0;_<u.length;++_){var w=u[_];if(w.type.indexOf("mat")>=0){var M=w.type.charAt(w.type.length-1)|0;var A=new Array(M);for(var T=0;T<M;++T){A[T]=x.length;b.push(w.name+"["+T+"]");if(typeof w.location==="number"){x.push(w.location+T)}else if(Array.isArray(w.location)&&w.location.length===M&&typeof w.location[T]==="number"){x.push(w.location[T]|0)}else{x.push(-1)}}y.push({name:w.name,type:w.type,locations:A})}else{y.push({name:w.name,type:w.type,locations:[x.length]});b.push(w.name);if(typeof w.location==="number"){x.push(w.location|0)}else{x.push(-1)}}}var k=0;for(_=0;_<x.length;++_){if(x[_]<0){while(x.indexOf(k)>=0){k+=1}x[_]=k}}var E=new Array(r.length);function S(){h.program=o.program(v,h._vref,h._fref,b,x);for(var e=0;e<r.length;++e){E[e]=v.getUniformLocation(h.program,r[e].name)}}S();h._relink=S;h.types={uniforms:a(r),attributes:a(u)};h.attributes=i(v,h,y,x);Object.defineProperty(h,"uniforms",n(v,h,r,E))};function h(e,t,r,n,i){var a=new u(e);a.update(t,r,n,i);return a}t.exports=h},{"./lib/GLError":148,"./lib/create-attributes":149,"./lib/create-uniforms":150,"./lib/reflect":151,"./lib/runtime-reflect":152,"./lib/shader-cache":153}],148:[function(e,t,r){function n(e,t,r){this.shortMessage=t||"";this.longMessage=r||"";this.rawError=e||"";this.message="gl-shader: "+(t||e||"")+(r?"\n"+r:"");this.stack=(new Error).stack}n.prototype=new Error;n.prototype.name="GLError";n.prototype.constructor=n;t.exports=n},{}],149:[function(e,t,r){"use strict";t.exports=l;var n=e("./GLError");function i(e,t,r,n,i,a){this._gl=e;this._wrapper=t;this._index=r;this._locations=n;this._dimension=i;this._constFunc=a}var a=i.prototype;a.pointer=function e(t,r,n,i){var a=this;var o=a._gl;var s=a._locations[a._index];o.vertexAttribPointer(s,a._dimension,t||o.FLOAT,!!r,n||0,i||0);o.enableVertexAttribArray(s)};a.set=function(e,t,r,n){return this._constFunc(this._locations[this._index],e,t,r,n)};Object.defineProperty(a,"location",{get:function(){return this._locations[this._index]},set:function(e){if(e!==this._locations[this._index]){this._locations[this._index]=e|0;this._wrapper.program=null}return e|0}});function o(e,t,r,n,a,o,s){var l=["gl","v"];var u=[];for(var f=0;f<a;++f){l.push("x"+f);u.push("x"+f)}l.push("if(x0.length===void 0){return gl.vertexAttrib"+a+"f(v,"+u.join()+")}else{return gl.vertexAttrib"+a+"fv(v,x0)}");var c=Function.apply(null,l);var h=new i(e,t,r,n,a,c);Object.defineProperty(o,s,{set:function(t){e.disableVertexAttribArray(n[r]);c(e,n[r],t);return t},get:function(){return h},enumerable:true})}function s(e,t,r,n,i,a,s){var l=new Array(i);var u=new Array(i);for(var f=0;f<i;++f){o(e,t,r[f],n,i,l,f);u[f]=l[f]}Object.defineProperty(l,"location",{set:function(e){if(Array.isArray(e)){for(var t=0;t<i;++t){u[t].location=e[t]}}else{for(var t=0;t<i;++t){u[t].location=e+t}}return e},get:function(){var e=new Array(i);for(var t=0;t<i;++t){e[t]=n[r[t]]}return e},enumerable:true});l.pointer=function(t,a,o,s){t=t||e.FLOAT;a=!!a;o=o||i*i;s=s||0;for(var l=0;l<i;++l){var u=n[r[l]];e.vertexAttribPointer(u,i,t,a,o,s+l*i);e.enableVertexAttribArray(u)}};var c=new Array(i);var h=e["vertexAttrib"+i+"fv"];Object.defineProperty(a,s,{set:function(t){for(var a=0;a<i;++a){var o=n[r[a]];e.disableVertexAttribArray(o);if(Array.isArray(t[0])){h.call(e,o,t[a])}else{for(var s=0;s<i;++s){c[s]=t[i*a+s]}h.call(e,o,c)}}return t},get:function(){return l},enumerable:true})}function l(e,t,r,i){var a={};for(var l=0,u=r.length;l<u;++l){var f=r[l];var c=f.name;var h=f.type;var v=f.locations;switch(h){case"bool":case"int":case"float":o(e,t,v[0],i,1,a,c);break;default:if(h.indexOf("vec")>=0){var d=h.charCodeAt(h.length-1)-48;if(d<2||d>4){throw new n("","Invalid data type for attribute "+c+": "+h)}o(e,t,v[0],i,d,a,c)}else if(h.indexOf("mat")>=0){var d=h.charCodeAt(h.length-1)-48;if(d<2||d>4){throw new n("","Invalid data type for attribute "+c+": "+h)}s(e,t,v,i,d,a,c)}else{throw new n("","Unknown data type for attribute "+c+": "+h)}break}}return a}},{"./GLError":148}],150:[function(e,t,r){"use strict";var n=e("./reflect");var i=e("./GLError");t.exports=s;function a(e){var t=new Function("y","return function(){return y}");return t(e)}function o(e,t){var r=new Array(e);for(var n=0;n<e;++n){r[n]=t}return r}function s(e,t,r,s){function l(r){var n=new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+r+"])}");return n(e,t,s)}function u(e,t,r){switch(r){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+t+"],obj"+e+")";case"float":return"gl.uniform1f(locations["+t+"],obj"+e+")";default:var n=r.indexOf("vec");if(0<=n&&n<=1&&r.length===4+n){var a=r.charCodeAt(r.length-1)-48;if(a<2||a>4){throw new i("","Invalid data type")}switch(r.charAt(0)){case"b":case"i":return"gl.uniform"+a+"iv(locations["+t+"],obj"+e+")";case"v":return"gl.uniform"+a+"fv(locations["+t+"],obj"+e+")";default:throw new i("","Unrecognized data type for vector "+name+": "+r)}}else if(r.indexOf("mat")===0&&r.length===4){var a=r.charCodeAt(r.length-1)-48;if(a<2||a>4){throw new i("","Invalid uniform dimension type for matrix "+name+": "+r)}return"gl.uniformMatrix"+a+"fv(locations["+t+"],false,obj"+e+")"}else{throw new i("","Unknown uniform data type for "+name+": "+r)}break}}function f(e,t){if(typeof t!=="object"){return[[e,t]]}var r=[];for(var n in t){var i=t[n];var a=e;if(parseInt(n)+""===n){a+="["+n+"]"}else{a+="."+n}if(typeof i==="object"){r.push.apply(r,f(a,i))}else{r.push([a,i])}}return r}function c(t){var n=["return function updateProperty(obj){"];var i=f("",t);for(var a=0;a<i.length;++a){var o=i[a];var l=o[0];var c=o[1];if(s[c]){n.push(u(l,c,r[c].type))}}n.push("return obj}");var h=new Function("gl","locations",n.join("\n"));return h(e,s)}function h(e){switch(e){case"bool":return false;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var t=e.indexOf("vec");if(0<=t&&t<=1&&e.length===4+t){var r=e.charCodeAt(e.length-1)-48;if(r<2||r>4){throw new i("","Invalid data type")}if(e.charAt(0)==="b"){return o(r,false)}return o(r,0)}else if(e.indexOf("mat")===0&&e.length===4){var r=e.charCodeAt(e.length-1)-48;if(r<2||r>4){throw new i("","Invalid uniform dimension type for matrix "+name+": "+e)}return o(r*r,0)}else{throw new i("","Unknown uniform data type for "+name+": "+e)}break}}function v(e,t,n){if(typeof n==="object"){var i=d(n);Object.defineProperty(e,t,{get:a(i),set:c(n),enumerable:true,configurable:false})}else{if(s[n]){Object.defineProperty(e,t,{get:l(n),set:c(n),enumerable:true,configurable:false})}else{e[t]=h(r[n].type)}}}function d(e){var t;if(Array.isArray(e)){t=new Array(e.length);for(var r=0;r<e.length;++r){v(t,r,e[r])}}else{t={};for(var n in e){v(t,n,e[n])}}return t}var p=n(r,true);return{get:a(d(p)),set:c(p),enumerable:true,configurable:true}}},{"./GLError":148,"./reflect":151}],151:[function(e,t,r){"use strict";t.exports=n;function n(e,t){var r={};for(var n=0;n<e.length;++n){var i=e[n].name;var a=i.split(".");var o=r;for(var s=0;s<a.length;++s){var l=a[s].split("[");if(l.length>1){if(!(l[0]in o)){o[l[0]]=[]}o=o[l[0]];for(var u=1;u<l.length;++u){var f=parseInt(l[u]);if(u<l.length-1||s<a.length-1){if(!(f in o)){if(u<l.length-1){o[f]=[]}else{o[f]={}}}o=o[f]}else{if(t){o[f]=n}else{o[f]=e[n].type}}}}else if(s<a.length-1){if(!(l[0]in o)){o[l[0]]={}}o=o[l[0]]}else{if(t){o[l[0]]=n}else{o[l[0]]=e[n].type}}}}return r}},{}],152:[function(e,t,r){"use strict";r.uniforms=o;r.attributes=s;var n={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"};var i=null;function a(e,t){if(!i){var r=Object.keys(n);i={};for(var a=0;a<r.length;++a){var o=r[a];i[e[o]]=n[o]}}return i[t]}function o(e,t){var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);var n=[];for(var i=0;i<r;++i){var o=e.getActiveUniform(t,i);if(o){var s=a(e,o.type);if(o.size>1){for(var l=0;l<o.size;++l){n.push({name:o.name.replace("[0]","["+l+"]"),type:s})}}else{n.push({name:o.name,type:s})}}}return n}function s(e,t){var r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);var n=[];for(var i=0;i<r;++i){var o=e.getActiveAttrib(t,i);if(o){n.push({name:o.name,type:a(e,o.type)})}}return n}},{}],153:[function(e,t,r){"use strict";r.shader=d;r.program=p;var n=e("./GLError");var i=e("gl-format-compiler-error");var a=typeof WeakMap==="undefined"?e("weakmap-shim"):WeakMap;var o=new a;var s=0;function l(e,t,r,n,i,a,o){this.id=e;this.src=t;this.type=r;this.shader=n;this.count=a;this.programs=[];this.cache=o}l.prototype.dispose=function(){if(--this.count===0){var e=this.cache;var t=e.gl;var r=this.programs;for(var n=0,i=r.length;n<i;++n){var a=e.programs[r[n]];if(a){delete e.programs[n];t.deleteProgram(a)}}t.deleteShader(this.shader);delete e.shaders[this.type===t.FRAGMENT_SHADER|0][this.src]}};function u(e){this.gl=e;this.shaders=[{},{}];this.programs={}}var f=u.prototype;function c(e,t,r){var a=e.createShader(t);e.shaderSource(a,r);e.compileShader(a);if(!e.getShaderParameter(a,e.COMPILE_STATUS)){var o=e.getShaderInfoLog(a);try{var s=i(o,r,t)}catch(e){console.warn("Failed to format compiler error: "+e);throw new n(o,"Error compiling shader:\n"+o)}throw new n(o,s.short,s.long)}return a}f.getShaderReference=function(e,t){var r=this.gl;var n=this.shaders[e===r.FRAGMENT_SHADER|0];var i=n[t];if(!i||!r.isShader(i.shader)){var a=c(r,e,t);i=n[t]=new l(s++,t,e,a,[],1,this)}else{i.count+=1}return i};function h(e,t,r,i,a){var o=e.createProgram();e.attachShader(o,t);e.attachShader(o,r);for(var s=0;s<i.length;++s){e.bindAttribLocation(o,a[s],i[s])}e.linkProgram(o);if(!e.getProgramParameter(o,e.LINK_STATUS)){var l=e.getProgramInfoLog(o);throw new n(l,"Error linking program: "+l)}return o}f.getProgram=function(e,t,r,n){var i=[e.id,t.id,r.join(":"),n.join(":")].join("@");var a=this.programs[i];if(!a||!this.gl.isProgram(a)){this.programs[i]=a=h(this.gl,e.shader,t.shader,r,n);e.programs.push(i);t.programs.push(i)}return a};function v(e){var t=o.get(e);if(!t){t=new u(e);o.set(e,t)}return t}function d(e,t,r){return v(e).getShaderReference(t,r)}function p(e,t,r,n,i){return v(e).getProgram(t,r,n,i)}},{"./GLError":148,"gl-format-compiler-error":114,"weakmap-shim":341}],154:[function(e,t,r){"use strict";var n=e("glslify");var i=e("gl-shader");var a=n(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);t.exports=function(e){return i(e,a,o,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":147,glslify:235}],155:[function(e,t,r){"use strict";var n=e("gl-buffer");var i=e("gl-vao");var a=e("./shaders/index");t.exports=h;var o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function s(e,t,r,n){this.gl=e;this.buffer=t;this.vao=r;this.shader=n;this.pixelRatio=1;this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]];this.position=[0,0,0];this.lineWidth=[2,2,2];this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.enabled=[true,true,true];this.drawSides=[true,true,true];this.axes=null}var l=s.prototype;var u=[0,0,0];var f=[0,0,0];var c=[0,0];l.isTransparent=function(){return false};l.drawTransparent=function(e){};l.draw=function(e){var t=this.gl;var r=this.vao;var n=this.shader;r.bind();n.bind();var i=e.model||o;var a=e.view||o;var s=e.projection||o;var l;if(this.axes){l=this.axes.lastCubeProps.axis}var h=u;var v=f;for(var d=0;d<3;++d){if(l&&l[d]<0){h[d]=this.bounds[0][d];v[d]=this.bounds[1][d]}else{h[d]=this.bounds[1][d];v[d]=this.bounds[0][d]}}c[0]=t.drawingBufferWidth;c[1]=t.drawingBufferHeight;n.uniforms.model=i;n.uniforms.view=a;n.uniforms.projection=s;n.uniforms.coordinates=[this.position,h,v];n.uniforms.colors=this.colors;n.uniforms.screenShape=c;for(var d=0;d<3;++d){n.uniforms.lineWidth=this.lineWidth[d]*this.pixelRatio;if(this.enabled[d]){r.draw(t.TRIANGLES,6,6*d);if(this.drawSides[d]){r.draw(t.TRIANGLES,12,18+12*d)}}}r.unbind()};l.update=function(e){if(!e){return}if("bounds"in e){this.bounds=e.bounds}if("position"in e){this.position=e.position}if("lineWidth"in e){this.lineWidth=e.lineWidth}if("colors"in e){this.colors=e.colors}if("enabled"in e){this.enabled=e.enabled}if("drawSides"in e){this.drawSides=e.drawSides}};l.dispose=function(){this.vao.dispose();this.buffer.dispose();this.shader.dispose()};function h(e,t){var r=[];function o(e,t,n,i,a,o){var s=[e,t,n,0,0,0,1];s[i+3]=1;s[i]=a;r.push.apply(r,s);s[6]=-1;r.push.apply(r,s);s[i]=o;r.push.apply(r,s);r.push.apply(r,s);s[6]=1;r.push.apply(r,s);s[i]=a;r.push.apply(r,s)}o(0,0,0,0,0,1);o(0,0,0,1,0,1);o(0,0,0,2,0,1);o(1,0,0,1,-1,1);o(1,0,0,2,-1,1);o(0,1,0,0,-1,1);o(0,1,0,2,-1,1);o(0,0,1,0,-1,1);o(0,0,1,1,-1,1);var l=n(e,r);var u=i(e,[{type:e.FLOAT,buffer:l,size:3,offset:0,stride:28},{type:e.FLOAT,buffer:l,size:3,offset:12,stride:28},{type:e.FLOAT,buffer:l,size:1,offset:24,stride:28}]);var f=a(e);f.attributes.position.location=0;f.attributes.color.location=1;f.attributes.weight.location=2;var c=new s(e,l,u,f);c.update(t);return c}},{"./shaders/index":154,"gl-buffer":104,"gl-vao":166}],156:[function(e,t,r){arguments[4][106][0].apply(r,arguments)},{barycentric:18,dup:106,"polytope-closest-point/lib/closest_point_2d.js":291}],157:[function(e,t,r){var n=e("glslify");var i=n(["precision mediump float;\n#define GLSLIFY 1\n\nfloat inverse(float m) {\n  return 1.0 / m;\n}\n\nmat2 inverse(mat2 m) {\n  return mat2(m[1][1],-m[0][1],\n             -m[1][0], m[0][0]) / (m[0][0]*m[1][1] - m[0][1]*m[1][0]);\n}\n\nmat3 inverse(mat3 m) {\n  float a00 = m[0][0], a01 = m[0][1], a02 = m[0][2];\n  float a10 = m[1][0], a11 = m[1][1], a12 = m[1][2];\n  float a20 = m[2][0], a21 = m[2][1], a22 = m[2][2];\n\n  float b01 = a22 * a11 - a12 * a21;\n  float b11 = -a22 * a10 + a12 * a20;\n  float b21 = a21 * a10 - a11 * a20;\n\n  float det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  return mat3(b01, (-a22 * a01 + a02 * a21), (a12 * a01 - a02 * a11),\n              b11, (a22 * a00 - a02 * a20), (-a12 * a00 + a02 * a10),\n              b21, (-a21 * a00 + a01 * a20), (a11 * a00 - a01 * a10)) / det;\n}\n\nmat4 inverse(mat4 m) {\n  float\n      a00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],\n      a10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],\n      a20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],\n      a30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],\n\n      b00 = a00 * a11 - a01 * a10,\n      b01 = a00 * a12 - a02 * a10,\n      b02 = a00 * a13 - a03 * a10,\n      b03 = a01 * a12 - a02 * a11,\n      b04 = a01 * a13 - a03 * a11,\n      b05 = a02 * a13 - a03 * a12,\n      b06 = a20 * a31 - a21 * a30,\n      b07 = a20 * a32 - a22 * a30,\n      b08 = a20 * a33 - a23 * a30,\n      b09 = a21 * a32 - a22 * a31,\n      b10 = a21 * a33 - a23 * a31,\n      b11 = a22 * a33 - a23 * a32,\n\n      det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  return mat4(\n      a11 * b11 - a12 * b10 + a13 * b09,\n      a02 * b10 - a01 * b11 - a03 * b09,\n      a31 * b05 - a32 * b04 + a33 * b03,\n      a22 * b04 - a21 * b05 - a23 * b03,\n      a12 * b08 - a10 * b11 - a13 * b07,\n      a00 * b11 - a02 * b08 + a03 * b07,\n      a32 * b02 - a30 * b05 - a33 * b01,\n      a20 * b05 - a22 * b02 + a23 * b01,\n      a10 * b10 - a11 * b08 + a13 * b06,\n      a01 * b08 - a00 * b10 - a03 * b06,\n      a30 * b04 - a31 * b02 + a33 * b00,\n      a21 * b02 - a20 * b04 - a23 * b00,\n      a11 * b07 - a10 * b09 - a12 * b06,\n      a00 * b09 - a01 * b07 + a02 * b06,\n      a31 * b01 - a30 * b03 - a32 * b00,\n      a20 * b03 - a21 * b01 + a22 * b00) / det;\n}\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\nuniform float tubeScale;\n\nuniform mat4 model\n           , view\n           , projection;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal), 0.0);\n  normal = normalize(normal * inverse(mat3(model)));\n\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n  f_color          = color;\n  f_normal         = normal;\n  f_data           = tubePosition.xyz;\n  f_eyeDirection   = eyePosition   - tubePosition.xyz;\n  f_lightDirection = lightPosition - tubePosition.xyz;\n  f_uv             = uv;\n}\n"]);var a=n(["precision mediump float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular\n            , opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n  \n  if(!gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = cookTorranceSpecular(L, V, N, roughness, fresnel);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor =  texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}"]);var o=n(["precision mediump float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal), 0.0);\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]);var s=n(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);r.meshShader={vertex:i,fragment:a,attributes:[{name:"position",type:"vec4"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]};r.pickShader={vertex:o,fragment:s,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:235}],158:[function(e,t,r){"use strict";var n=1e-6;var i=1e-6;var a=e("gl-shader");var o=e("gl-buffer");var s=e("gl-vao");var l=e("gl-texture2d");var u=e("normals");var f=e("gl-mat4/multiply");var c=e("gl-mat4/invert");var h=e("ndarray");var v=e("colormap");var d=e("simplicial-complex-contour");var p=e("typedarray-pool");var g=e("./shaders");var m=e("./closest-point");var y=g.meshShader;var b=g.pickShader;var x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function _(e,t,r,n,i,a,o,s,l,u,f,c,h,v,d,p,g,m,y,b,_,w,M,A,T,k,E,S){this.gl=e;this.cells=[];this.positions=[];this.intensity=[];this.texture=t;this.dirty=true;this.triShader=r;this.lineShader=n;this.pointShader=i;this.pickShader=a;this.pointPickShader=o;this.contourShader=s;this.trianglePositions=l;this.triangleVectors=u;this.triangleColors=c;this.triangleNormals=v;this.triangleUVs=h;this.triangleIds=f;this.triangleVAO=d;this.triangleCount=0;this.lineWidth=1;this.edgePositions=p;this.edgeColors=m;this.edgeUVs=y;this.edgeIds=g;this.edgeVAO=b;this.edgeCount=0;this.pointPositions=_;this.pointColors=M;this.pointUVs=A;this.pointSizes=T;this.pointIds=w;this.pointVAO=k;this.pointCount=0;this.contourLineWidth=1;this.contourPositions=E;this.contourVAO=S;this.contourCount=0;this.contourColor=[0,0,0];this.contourEnable=false;this.pickId=1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.lightPosition=[1e5,1e5,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.opacity=1;this.tubeScale=1;this._model=x;this._view=x;this._projection=x;this._resolution=[1,1]}var w=_.prototype;w.isOpaque=function(){return this.opacity>=1};w.isTransparent=function(){return this.opacity<1};w.pickSlots=1;w.setPickBase=function(e){this.pickId=e};function M(e){var t=v({colormap:e,nshades:256,format:"rgba"});var r=new Uint8Array(256*4);for(var n=0;n<256;++n){var i=t[n];for(var a=0;a<3;++a){r[4*n+a]=i[a]}r[4*n+3]=i[3]*255}return h(r,[256,256,4],[4,0,1])}function A(e,t,r){var n=new Array(t);for(var i=0;i<t;++i){n[i]=0}var a=e.length;for(var i=0;i<a;++i){var o=e[i];for(var s=0;s<o.length;++s){n[o[s]]=r[i]}}return n}function T(e){var t=e.length;var r=new Array(t);for(var n=0;n<t;++n){r[n]=e[n][2]}return r}w.highlight=function(e){if(!e||!this.contourEnable){this.contourCount=0;return}var t=d(this.cells,this.intensity,e.intensity);var r=t.cells;var n=t.vertexIds;var i=t.vertexWeights;var a=r.length;var o=p.mallocFloat32(2*3*a);var s=0;for(var l=0;l<a;++l){var u=r[l];for(var f=0;f<2;++f){var c=u[0];if(u.length===2){c=u[f]}var h=n[c][0];var v=n[c][1];var g=i[c];var m=1-g;var y=this.positions[h];var b=this.positions[v];for(var x=0;x<3;++x){o[s++]=g*y[x]+m*b[x]}}}this.contourCount=s/3|0;this.contourPositions.update(o.subarray(0,s));p.free(o)};w.update=function(e){e=e||{};var t=this.gl;this.dirty=true;if("contourEnable"in e){this.contourEnable=e.contourEnable}if("contourColor"in e){this.contourColor=e.contourColor}if("lineWidth"in e){this.lineWidth=e.lineWidth}if("lightPosition"in e){this.lightPosition=e.lightPosition}if("opacity"in e){this.opacity=e.opacity}if("ambient"in e){this.ambientLight=e.ambient}if("diffuse"in e){this.diffuseLight=e.diffuse}if("specular"in e){this.specularLight=e.specular}if("roughness"in e){this.roughness=e.roughness}if("fresnel"in e){this.fresnel=e.fresnel}if(e.texture){this.texture.dispose();this.texture=l(t,e.texture)}else if(e.colormap){this.texture.shape=[256,256];this.texture.minFilter=t.LINEAR_MIPMAP_LINEAR;this.texture.magFilter=t.LINEAR;this.texture.setPixels(M(e.colormap));this.texture.generateMipmap()}var r=e.cells;var a=e.positions;var o=e.vectors;if(!a||!r||!o){return}if(e.tubeScale!==undefined){this.tubeScale=e.tubeScale}var s=[];var f=[];var c=[];var h=[];var v=[];var d=[];var p=[];var g=[];var m=[];var y=[];var b=[];var x=[];var _=[];var w=[];var k=[];this.cells=r;this.positions=a;this.vectors=o;var E=e.vertexNormals;var S=e.cellNormals;var L=e.vertexNormalsEpsilon===void 0?n:e.vertexNormalsEpsilon;var C=e.faceNormalsEpsilon===void 0?i:e.faceNormalsEpsilon;if(e.useFacetNormals&&!S){S=u.faceNormals(r,a,C)}if(!S&&!E){E=u.vertexNormals(r,a,L)}var I=e.vertexColors;var P=e.cellColors;var O=e.meshColor||[1,1,1,1];var R=e.vertexUVs;var N=e.vertexIntensity;var z=e.cellUVs;var D=e.cellIntensity;var F=Infinity;var j=-Infinity;if(!R&&!z){if(N){if(e.vertexIntensityBounds){F=+e.vertexIntensityBounds[0];j=+e.vertexIntensityBounds[1]}else{for(var B=0;B<N.length;++B){var U=N[B];F=Math.min(F,U);j=Math.max(j,U)}}}else if(D){for(var B=0;B<D.length;++B){var U=D[B];F=Math.min(F,U);j=Math.max(j,U)}}else{for(var B=0;B<a.length;++B){var U=a[B][2];F=Math.min(F,U);j=Math.max(j,U)}}}if(N){this.intensity=N}else if(D){this.intensity=A(r,a.length,D)}else{this.intensity=T(a)}var V=e.pointSizes;var H=e.pointSize||1;this.bounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(var B=0;B<a.length;++B){var q=a[B];for(var G=0;G<3;++G){if(isNaN(q[G])||!isFinite(q[G])){continue}this.bounds[0][G]=Math.min(this.bounds[0][G],q[G]);this.bounds[1][G]=Math.max(this.bounds[1][G],q[G])}}var W=0;var X=0;var Y=0;e:for(var B=0;B<r.length;++B){var Z=r[B];switch(Z.length){case 1:var Q=Z[0];var q=a[Q];for(var G=0;G<3;++G){if(isNaN(q[G])||!isFinite(q[G])){continue e}}b.push(q[0],q[1],q[2],q[3]);var K;if(I){K=I[Q]}else if(P){K=P[B]}else{K=O}if(K.length===3){x.push(K[0],K[1],K[2],1)}else{x.push(K[0],K[1],K[2],K[3])}var J;if(R){J=R[Q]}else if(N){J=[(N[Q]-F)/(j-F),0]}else if(z){J=z[B]}else if(D){J=[(D[B]-F)/(j-F),0]}else{J=[(q[2]-F)/(j-F),0]}_.push(J[0],J[1]);if(V){w.push(V[Q])}else{w.push(H)}k.push(B);Y+=1;break;case 2:for(var G=0;G<2;++G){var Q=Z[G];var q=a[Q];for(var $=0;$<3;++$){if(isNaN(q[$])||!isFinite(q[$])){continue e}}}for(var G=0;G<2;++G){var Q=Z[G];var q=a[Q];p.push(q[0],q[1],q[2]);var K;if(I){K=I[Q]}else if(P){K=P[B]}else{K=O}if(K.length===3){g.push(K[0],K[1],K[2],1)}else{g.push(K[0],K[1],K[2],K[3])}var J;if(R){J=R[Q]}else if(N){J=[(N[Q]-F)/(j-F),0]}else if(z){J=z[B]}else if(D){J=[(D[B]-F)/(j-F),0]}else{J=[(q[2]-F)/(j-F),0]}m.push(J[0],J[1]);y.push(B)}X+=1;break;case 3:for(var G=0;G<3;++G){var Q=Z[G];var q=a[Q];for(var $=0;$<3;++$){if(isNaN(q[$])||!isFinite(q[$])){continue e}}}for(var G=0;G<3;++G){var Q=Z[G];var q=a[Q];s.push(q[0],q[1],q[2],q[3]);var ee=o[Q];f.push(ee[0],ee[1],ee[2],ee[3]);var K;if(I){K=I[Q]}else if(P){K=P[B]}else{K=O}if(K.length===3){c.push(K[0],K[1],K[2],1)}else{c.push(K[0],K[1],K[2],K[3])}var J;if(R){J=R[Q]}else if(N){J=[(N[Q]-F)/(j-F),0]}else if(z){J=z[B]}else if(D){J=[(D[B]-F)/(j-F),0]}else{J=[(q[2]-F)/(j-F),0]}v.push(J[0],J[1]);var te;if(E){te=E[Q]}else{te=S[B]}h.push(te[0],te[1],te[2]);d.push(B)}W+=1;break;default:break}}this.pointCount=Y;this.edgeCount=X;this.triangleCount=W;this.pointPositions.update(b);this.pointColors.update(x);this.pointUVs.update(_);this.pointSizes.update(w);this.pointIds.update(new Uint32Array(k));this.edgePositions.update(p);this.edgeColors.update(g);this.edgeUVs.update(m);this.edgeIds.update(new Uint32Array(y));this.trianglePositions.update(s);this.triangleVectors.update(f);this.triangleColors.update(c);this.triangleUVs.update(v);this.triangleNormals.update(h);this.triangleIds.update(new Uint32Array(d))};w.drawTransparent=w.draw=function(e){e=e||{};var t=this.gl;var r=e.model||x;var n=e.view||x;var i=e.projection||x;var a=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){a[0][o]=Math.max(a[0][o],this.clipBounds[0][o]);a[1][o]=Math.min(a[1][o],this.clipBounds[1][o])}var s={model:r,view:n,projection:i,clipBounds:a,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,contourColor:this.contourColor,texture:0};this.texture.bind(0);var l=new Array(16);f(l,s.view,s.model);f(l,s.projection,l);c(l,l);for(var o=0;o<3;++o){s.eyePosition[o]=l[12+o]/l[15]}var u=l[15];for(var o=0;o<3;++o){u+=this.lightPosition[o]*l[4*o+3]}for(var o=0;o<3;++o){var h=l[12+o];for(var v=0;v<3;++v){h+=l[4*v+o]*this.lightPosition[v]}s.lightPosition[o]=h/u}if(this.triangleCount>0){var d=this.triShader;d.bind();d.uniforms=s;this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var d=this.lineShader;d.bind();d.uniforms=s;this.edgeVAO.bind();t.lineWidth(this.lineWidth);t.drawArrays(t.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var d=this.pointShader;d.bind();d.uniforms=s;this.pointVAO.bind();t.drawArrays(t.POINTS,0,this.pointCount);this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var d=this.contourShader;d.bind();d.uniforms=s;this.contourVAO.bind();t.drawArrays(t.LINES,0,this.contourCount);this.contourVAO.unbind()}};w.drawPick=function(e){e=e||{};var t=this.gl;var r=e.model||x;var n=e.view||x;var i=e.projection||x;var a=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]];for(var o=0;o<3;++o){a[0][o]=Math.max(a[0][o],this.clipBounds[0][o]);a[1][o]=Math.min(a[1][o],this.clipBounds[1][o])}this._model=[].slice.call(r);this._view=[].slice.call(n);this._projection=[].slice.call(i);this._resolution=[t.drawingBufferWidth,t.drawingBufferHeight];var s={model:r,view:n,projection:i,clipBounds:a,tubeScale:this.tubeScale,pickId:this.pickId/255};var l=this.pickShader;l.bind();l.uniforms=s;if(this.triangleCount>0){this.triangleVAO.bind();t.drawArrays(t.TRIANGLES,0,this.triangleCount*3);this.triangleVAO.unbind()}if(this.edgeCount>0){this.edgeVAO.bind();t.lineWidth(this.lineWidth);t.drawArrays(t.LINES,0,this.edgeCount*2);this.edgeVAO.unbind()}if(this.pointCount>0){var l=this.pointPickShader;l.bind();l.uniforms=s;this.pointVAO.bind();t.drawArrays(t.POINTS,0,this.pointCount);this.pointVAO.unbind()}};w.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=e.value[0]+256*e.value[1]+65536*e.value[2];var r=this.cells[t];var n=this.positions[r[1]].slice(0,3);var i=this.intensity[r[1]];var a=this.vectors[r[1]].slice(0,3);var o=this.vectors[r[1]][3];return{index:t,position:n,intensity:i,velocity:a,divergence:o,dataCoordinate:n}};w.dispose=function(){this.texture.dispose();this.triShader.dispose();this.pickShader.dispose();this.triangleVAO.dispose();this.trianglePositions.dispose();this.triangleVectors.dispose();this.triangleColors.dispose();this.triangleUVs.dispose();this.triangleNormals.dispose();this.triangleIds.dispose();this.edgeVAO.dispose();this.edgePositions.dispose();this.edgeColors.dispose();this.edgeUVs.dispose();this.edgeIds.dispose();this.pointVAO.dispose();this.pointPositions.dispose();this.pointColors.dispose();this.pointUVs.dispose();this.pointSizes.dispose();this.pointIds.dispose();this.contourVAO.dispose();this.contourPositions.dispose()};function k(e){var t=a(e,y.vertex,y.fragment,null,y.attributes);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;t.attributes.vector.location=5;return t}function E(e){var t=a(e,wireShader.vertex,wireShader.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;return t}function S(e){var t=a(e,pointShader.vertex,pointShader.fragment);t.attributes.position.location=0;t.attributes.color.location=2;t.attributes.uv.location=3;t.attributes.pointSize.location=4;return t}function L(e){var t=a(e,b.vertex,b.fragment,null,b.attributes);t.attributes.position.location=0;t.attributes.id.location=1;t.attributes.vector.location=5;return t}function C(e){var t=a(e,pointPickShader.vertex,pointPickShader.fragment);t.attributes.position.location=0;t.attributes.id.location=1;t.attributes.pointSize.location=4;return t}function I(e){var t=a(e,contourShader.vertex,contourShader.fragment);t.attributes.position.location=0;return t}function P(e,t){if(arguments.length===1){t=e;e=t.gl}var r=t.triShader||k(e);var n=null;var i=null;var a=L(e);var u=null;var f=null;var c=l(e,h(new Uint8Array([255,255,255,255]),[1,1,4]));c.generateMipmap();c.minFilter=e.LINEAR_MIPMAP_LINEAR;c.magFilter=e.LINEAR;var v=o(e);var d=o(e);var p=o(e);var g=o(e);var m=o(e);var y=o(e);var b=s(e,[{buffer:v,type:e.FLOAT,size:4},{buffer:y,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:p,type:e.FLOAT,size:4},{buffer:g,type:e.FLOAT,size:2},{buffer:m,type:e.FLOAT,size:3},{buffer:d,type:e.FLOAT,size:4}]);var x=o(e);var w=o(e);var M=o(e);var A=o(e);var T=s(e,[{buffer:x,type:e.FLOAT,size:3},{buffer:A,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:w,type:e.FLOAT,size:4},{buffer:M,type:e.FLOAT,size:2}]);var E=o(e);var S=o(e);var C=o(e);var I=o(e);var P=o(e);var O=s(e,[{buffer:E,type:e.FLOAT,size:3},{buffer:P,type:e.UNSIGNED_BYTE,size:4,normalized:true},{buffer:S,type:e.FLOAT,size:4},{buffer:C,type:e.FLOAT,size:2},{buffer:I,type:e.FLOAT,size:1}]);var R=o(e);var N=s(e,[{buffer:R,type:e.FLOAT,size:3}]);var z=new _(e,c,r,n,i,a,u,f,v,d,y,p,g,m,b,x,A,w,M,T,E,P,S,C,I,O,R,N);z.update(t);return z}t.exports=P},{"./closest-point":156,"./shaders":157,colormap:68,"gl-buffer":104,"gl-mat4/invert":125,"gl-mat4/multiply":127,"gl-shader":147,"gl-texture2d":162,"gl-vao":166,ndarray:270,normals:272,"simplicial-complex-contour":314,"typedarray-pool":333}],159:[function(e,t,r){"use strict";var n=e("gl-vec3");var i=e("gl-vec4");var a=function(e,t,r,a){var o=e.points;var s=e.velocities;var l=e.divergences;var u,f,c,h,v,d;d=n.set(n.create(),0,1,0);h=n.create();v=n.create();var p=n.create();var g=[];var m=[];var y=[];var b=[];var x=[];var _=[];var w=0;var M=0;var A=i.create();var T=i.create();var k=8;for(var E=0;E<o.length;E++){u=o[E];f=s[E];c=l[E];if(t===0){c=r*.05}M=n.length(f)/a;A=i.create();n.copy(A,f);A[3]=c;for(var S=0;S<k;S++){x[S]=[u[0],u[1],u[2],S]}if(b.length>0){for(var S=0;S<k;S++){var L=(S+1)%k;g.push(b[S],x[S],x[L],x[L],b[L],b[S]);y.push(T,A,A,A,T,T);_.push(w,M,M,M,w,w);m.push([g.length-6,g.length-5,g.length-4],[g.length-3,g.length-2,g.length-1])}}var C=b;b=x;x=C;C=T;T=A;A=C;C=w;w=M;M=C}return{positions:g,cells:m,vectors:y,vertexIntensity:_}};var o=function(e,t,r,i){var o=0;for(var s=0;s<e.length;s++){var l=e[s].velocities;for(var u=0;u<l.length;u++){var f=n.length(l[u]);if(f>o){o=f}}}var c=e.map(function(e){return a(e,r,i,o)});var h=[];var v=[];var d=[];var p=[];for(var s=0;s<c.length;s++){var g=c[s];var m=h.length;h=h.concat(g.positions);d=d.concat(g.vectors);p=p.concat(g.vertexIntensity);for(var u=0;u<g.cells.length;u++){var y=g.cells[u];var b=[];v.push(b);for(var x=0;x<y.length;x++){b.push(y[x]+m)}}}return{positions:h,cells:v,vectors:d,vertexIntensity:p,colormap:t}};var s=function(e,t){var r=n.create();var i=1/1e4;n.add(r,e,[i,0,0]);var a=this.getVelocity(r);n.subtract(a,a,t);n.scale(a,a,1/i);n.add(r,e,[0,i,0]);var o=this.getVelocity(r);n.subtract(o,o,t);n.scale(o,o,1/i);n.add(r,e,[0,0,i]);var s=this.getVelocity(r);n.subtract(s,s,t);n.scale(s,s,1/i);n.add(r,a,o);n.add(r,r,s);return r};var l=function(e){var t=v(e,this.vectors,this.meshgrid,this.clampBorders);return t};var u=function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n===t)return r;if(n>t)return r-1}return r};var f=n.create();var c=n.create();var h=function(e,t,r){return e<t?t:e>r?r:e};var v=function(e,t,r,i){var a=e[0];var o=e[1];var s=e[2];var l=r[0].length;var v=r[1].length;var d=r[2].length;var p=u(r[0],a);var g=u(r[1],o);var m=u(r[2],s);var y=p+1;var b=g+1;var x=m+1;if(r[0][p]===a)y=p;if(r[1][g]===o)b=g;if(r[2][m]===s)x=m;if(i){p=h(p,0,l-1);y=h(y,0,l-1);g=h(g,0,v-1);b=h(b,0,v-1);m=h(m,0,d-1);x=h(x,0,d-1)}if(p<0||g<0||m<0||y>=l||b>=v||x>=d){return n.create()}var _=(a-r[0][p])/(r[0][y]-r[0][p]);var w=(o-r[1][g])/(r[1][b]-r[1][g]);var M=(s-r[2][m])/(r[2][x]-r[2][m]);if(_<0||_>1||isNaN(_))_=0;if(w<0||w>1||isNaN(w))w=0;if(M<0||M>1||isNaN(M))M=0;var A=m*l*v;var T=x*l*v;var k=g*l;var E=b*l;var S=p;var L=y;var C=t[k+A+S];var I=t[k+A+L];var P=t[E+A+S];var O=t[E+A+L];var R=t[k+T+S];var N=t[k+T+L];var z=t[E+T+S];var D=t[E+T+L];var F=n.create();n.lerp(F,C,I,_);n.lerp(f,P,O,_);n.lerp(F,F,f,w);n.lerp(f,R,N,_);n.lerp(c,z,D,_);n.lerp(f,f,c,w);n.lerp(F,F,f,M);return F};var d=function(e,t){var r=t[0];var n=t[1];var i=t[2];e[0]=r>=0?r:-r;e[1]=n>=0?n:-n;e[2]=i>=0?i:-i;return e};var p=function(e){var t=1/0;e.sort(function(e,t){return e-t});for(var r=1;r<e.length;r++){var n=Math.abs(e[r]-e[r-1]);if(n<t){t=n}}return t};var g=function(e){var t=[],r=[],n=[];var i={},a={},o={};for(var s=0;s<e.length;s++){var l=e[s];var u=l[0],f=l[1],c=l[2];if(!i[u]){t.push(u);i[u]=true}if(!a[f]){r.push(f);a[f]=true}if(!o[c]){n.push(c);o[c]=true}}var h=p(t);var v=p(r);var d=p(n);var g=Math.min(h,v,d);if(!isFinite(g)){return 1}return g};t.exports=function(e,t){var r=e.startingPositions;var i=e.maxLength||1e3;var a=e.tubeSize||1;var u=e.absoluteTubeSize;if(!e.getDivergence){e.getDivergence=s}if(!e.getVelocity){e.getVelocity=l}if(e.clampBorders===undefined){e.clampBorders=true}var f=[];var c=t[0][0],h=t[0][1],v=t[0][2];var d=t[1][0],p=t[1][1],m=t[1][2];var y=function(e,t){var r=t[0];var n=t[1];var i=t[2];return r>=c&&r<=d&&n>=h&&n<=p&&i>=v&&i<=m};var b=n.distance(t[0],t[1]);var x=10*b/i;var _=x*x;var w=1;var M=0;var A=n.create();if(r.length>=2){w=g(r)}for(var T=0;T<r.length;T++){var k=n.create();n.copy(k,r[T]);var E=[k];var S=[];var L=e.getVelocity(k);var C=k;S.push(L);var I=[];var P=e.getDivergence(k,L);var O=n.length(P);if(O>M&&!isNaN(O)&&isFinite(O)){M=O}I.push(O);f.push({points:E,velocities:S,divergences:I});var R=0;while(R<i*100&&E.length<i&&y(t,k)){R++;var N=n.clone(L);var z=n.squaredLength(N);if(z===0){break}else if(z>_){n.scale(N,N,x/Math.sqrt(z))}n.add(N,N,k);L=e.getVelocity(N);if(n.squaredDistance(C,N)-_>-1e-4*_){E.push(N);C=N;S.push(L);var P=e.getDivergence(N,L);var O=n.length(P);if(O>M&&!isNaN(O)&&isFinite(O)){M=O}I.push(O)}k=N}}for(var T=0;T<I.length;T++){var O=I[T];if(isNaN(O)||!isFinite(O)){I[T]=M}}var D=o(f,e.colormap,M,w);if(u){D.tubeScale=u}else{if(M===0){M=1}D.tubeScale=a*.5*w/M}return D};t.exports.createTubeMesh=e("./lib/tubemesh")},{"./lib/tubemesh":158,"gl-vec3":178,"gl-vec4":208}],160:[function(e,t,r){var n=e("gl-shader");var i=e("glslify");var a=i(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  worldCoordinate = vec3(uv.zw, f.x);\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]);var o=i(["precision mediump float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if (kill > 0.0 ||\n    any(lessThan(worldCoordinate, clipBounds[0])) || any(greaterThan(worldCoordinate, clipBounds[1]))) {\n    discard;\n  }\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color \u2014 in vertex or in fragment\n  vec4 surfaceColor = step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) + step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]);var s=i(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  vec4 worldPosition = model * vec4(dataCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z = clipPosition.z + zOffset;\n\n  gl_Position = clipPosition;\n  value = f;\n  kill = -1.0;\n  worldCoordinate = dataCoordinate;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]);var l=i(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if(kill > 0.0 ||\n    any(lessThan(worldCoordinate, clipBounds[0])) || any(greaterThan(worldCoordinate, clipBounds[1]))) {\n    discard;\n  }\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);r.createShader=function(e){var t=n(e,a,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);t.attributes.uv.location=0;t.attributes.f.location=1;t.attributes.normal.location=2;return t};r.createPickShader=function(e){var t=n(e,a,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);t.attributes.uv.location=0;t.attributes.f.location=1;t.attributes.normal.location=2;return t};r.createContourShader=function(e){var t=n(e,s,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);t.attributes.uv.location=0;t.attributes.f.location=1;return t};r.createPickContourShader=function(e){var t=n(e,s,l,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);t.attributes.uv.location=0;t.attributes.f.location=1;return t}},{"gl-shader":147,glslify:235}],161:[function(e,t,r){"use strict";t.exports=H;var n=e("bit-twiddle");var i=e("gl-buffer");var a=e("gl-vao");var o=e("gl-texture2d");var s=e("typedarray-pool");var l=e("colormap");var u=e("ndarray-ops");var f=e("ndarray-pack");var c=e("ndarray");var h=e("surface-nets");var v=e("gl-mat4/multiply");var d=e("gl-mat4/invert");var p=e("binary-search-bounds");var g=e("ndarray-gradient");var m=e("./lib/shaders");var y=m.createShader;var b=m.createContourShader;var x=m.createPickShader;var _=m.createPickContourShader;var w=4*(4+3+3);var M=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var A=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]];var T=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var e=0;e<3;++e){var t=T[e];var r=(e+1)%3;var n=(e+2)%3;t[r+0]=1;t[n+3]=1;t[e+6]=1}})();function k(e,t,r,n,i){this.position=e;this.index=t;this.uv=r;this.level=n;this.dataCoordinate=i}var E=256;function S(e){var t=f([l({colormap:e,nshades:E,format:"rgba"}).map(function(e){return[e[0],e[1],e[2],255*e[3]]})]);u.divseq(t,255);return t}function L(e,t,r,n,i,a,o,l,u,f,h,v,d,p){this.gl=e;this.shape=t;this.bounds=r;this.intensityBounds=[];this._shader=n;this._pickShader=i;this._coordinateBuffer=a;this._vao=o;this._colorMap=l;this._contourShader=u;this._contourPickShader=f;this._contourBuffer=h;this._contourVAO=v;this._contourOffsets=[[],[],[]];this._contourCounts=[[],[],[]];this._vertexCount=0;this._pickResult=new k([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]);this._dynamicBuffer=d;this._dynamicVAO=p;this._dynamicOffsets=[0,0,0];this._dynamicCounts=[0,0,0];this.contourWidth=[1,1,1];this.contourLevels=[[1],[1],[1]];this.contourTint=[0,0,0];this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]];this.showContour=true;this.showSurface=true;this.enableHighlight=[true,true,true];this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.highlightTint=[1,1,1];this.highlightLevel=[-1,-1,-1];this.enableDynamic=[true,true,true];this.dynamicLevel=[NaN,NaN,NaN];this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.dynamicTint=[1,1,1];this.dynamicWidth=[1,1,1];this.axesBounds=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];this.surfaceProject=[false,false,false];this.contourProject=[[false,false,false],[false,false,false],[false,false,false]];this.colorBounds=[false,false];this._field=[c(s.mallocFloat(1024),[0,0]),c(s.mallocFloat(1024),[0,0]),c(s.mallocFloat(1024),[0,0])];this.pickId=1;this.clipBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.snapToData=false;this.opacity=1;this.lightPosition=[10,1e4,0];this.ambientLight=.8;this.diffuseLight=.8;this.specularLight=2;this.roughness=.5;this.fresnel=1.5;this.vertexColor=0;this.dirty=true}var C=L.prototype;C.isTransparent=function(){return this.opacity<1};C.isOpaque=function(){if(this.opacity>=1){return true}for(var e=0;e<3;++e){if(this._contourCounts[e].length>0||this._dynamicCounts[e]>0){return true}}return false};C.pickSlots=1;C.setPickBase=function(e){this.pickId=e};var I=[0,0,0];var P={showSurface:false,showContour:false,projections:[M.slice(),M.slice(),M.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function O(e,t){var r,n,i;var a=t.axes&&t.axes.lastCubeProps.axis||I;var o=t.showSurface;var s=t.showContour;for(r=0;r<3;++r){o=o||t.surfaceProject[r];for(n=0;n<3;++n){s=s||t.contourProject[r][n]}}for(r=0;r<3;++r){var l=P.projections[r];for(n=0;n<16;++n){l[n]=0}for(n=0;n<4;++n){l[5*n]=1}l[5*r]=0;l[12+r]=t.axesBounds[+(a[r]>0)][r];v(l,e.model,l);var u=P.clipBounds[r];for(i=0;i<2;++i){for(n=0;n<3;++n){u[i][n]=e.clipBounds[i][n]}}u[0][r]=-1e8;u[1][r]=1e8}P.showSurface=o;P.showContour=s;return P}var R={model:M,view:M,projection:M,inverseModel:M.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0};var N=M.slice();var z=[1,0,0,0,1,0,0,0,1];function D(e,t){e=e||{};var r=this.gl;r.disable(r.CULL_FACE);this._colorMap.bind(0);var n=R;n.model=e.model||M;n.view=e.view||M;n.projection=e.projection||M;n.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]];n.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]];n.contourColor=this.contourColor[0];n.inverseModel=d(n.inverseModel,n.model);for(var i=0;i<2;++i){var a=n.clipBounds[i];for(var o=0;o<3;++o){a[o]=Math.min(Math.max(this.clipBounds[i][o],-1e8),1e8)}}n.kambient=this.ambientLight;n.kdiffuse=this.diffuseLight;n.kspecular=this.specularLight;n.roughness=this.roughness;n.fresnel=this.fresnel;n.opacity=this.opacity;n.height=0;n.permutation=z;n.vertexColor=this.vertexColor;var s=N;v(s,n.view,n.model);v(s,n.projection,s);d(s,s);for(i=0;i<3;++i){n.eyePosition[i]=s[12+i]/s[15]}var l=s[15];for(i=0;i<3;++i){l+=this.lightPosition[i]*s[4*i+3]}for(i=0;i<3;++i){var u=s[12+i];for(o=0;o<3;++o){u+=s[4*o+i]*this.lightPosition[o]}n.lightPosition[i]=u/l}var f=O(n,this);if(f.showSurface&&t===this.opacity<1){this._shader.bind();this._shader.uniforms=n;this._vao.bind();if(this.showSurface&&this._vertexCount){this._vao.draw(r.TRIANGLES,this._vertexCount)}for(i=0;i<3;++i){if(!this.surfaceProject[i]||!this.vertexCount){continue}this._shader.uniforms.model=f.projections[i];this._shader.uniforms.clipBounds=f.clipBounds[i];this._vao.draw(r.TRIANGLES,this._vertexCount)}this._vao.unbind()}if(f.showContour&&!t){var c=this._contourShader;n.kambient=1;n.kdiffuse=0;n.kspecular=0;n.opacity=1;c.bind();c.uniforms=n;var h=this._contourVAO;h.bind();for(i=0;i<3;++i){c.uniforms.permutation=T[i];r.lineWidth(this.contourWidth[i]);for(o=0;o<this.contourLevels[i].length;++o){if(o===this.highlightLevel[i]){c.uniforms.contourColor=this.highlightColor[i];c.uniforms.contourTint=this.highlightTint[i]}else if(o===0||o-1===this.highlightLevel[i]){c.uniforms.contourColor=this.contourColor[i];c.uniforms.contourTint=this.contourTint[i]}if(!this._contourCounts[i][o]){continue}c.uniforms.height=this.contourLevels[i][o];h.draw(r.LINES,this._contourCounts[i][o],this._contourOffsets[i][o])}}for(i=0;i<3;++i){c.uniforms.model=f.projections[i];c.uniforms.clipBounds=f.clipBounds[i];for(o=0;o<3;++o){if(!this.contourProject[i][o]){continue}c.uniforms.permutation=T[o];r.lineWidth(this.contourWidth[o]);for(var p=0;p<this.contourLevels[o].length;++p){if(p===this.highlightLevel[o]){c.uniforms.contourColor=this.highlightColor[o];c.uniforms.contourTint=this.highlightTint[o]}else if(p===0||p-1===this.highlightLevel[o]){c.uniforms.contourColor=this.contourColor[o];c.uniforms.contourTint=this.contourTint[o]}c.uniforms.height=this.contourLevels[o][p];h.draw(r.LINES,this._contourCounts[o][p],this._contourOffsets[o][p])}}}h.unbind();h=this._dynamicVAO;h.bind();for(i=0;i<3;++i){if(this._dynamicCounts[i]===0){continue}c.uniforms.model=n.model;c.uniforms.clipBounds=n.clipBounds;c.uniforms.permutation=T[i];r.lineWidth(this.dynamicWidth[i]);c.uniforms.contourColor=this.dynamicColor[i];c.uniforms.contourTint=this.dynamicTint[i];c.uniforms.height=this.dynamicLevel[i];h.draw(r.LINES,this._dynamicCounts[i],this._dynamicOffsets[i]);for(o=0;o<3;++o){if(!this.contourProject[o][i]){continue}c.uniforms.model=f.projections[o];c.uniforms.clipBounds=f.clipBounds[o];h.draw(r.LINES,this._dynamicCounts[i],this._dynamicOffsets[i])}}h.unbind()}}C.draw=function(e){return D.call(this,e,false)};C.drawTransparent=function(e){return D.call(this,e,true)};var F={model:M,view:M,projection:M,inverseModel:M,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};C.drawPick=function(e){e=e||{};var t=this.gl;t.disable(t.CULL_FACE);var r=F;r.model=e.model||M;r.view=e.view||M;r.projection=e.projection||M;r.shape=this._field[2].shape;r.pickId=this.pickId/255;r.lowerBound=this.bounds[0];r.upperBound=this.bounds[1];r.permutation=z;for(var n=0;n<2;++n){var i=r.clipBounds[n];for(var a=0;a<3;++a){i[a]=Math.min(Math.max(this.clipBounds[n][a],-1e8),1e8)}}var o=O(r,this);if(o.showSurface){this._pickShader.bind();this._pickShader.uniforms=r;this._vao.bind();this._vao.draw(t.TRIANGLES,this._vertexCount);for(n=0;n<3;++n){if(!this.surfaceProject[n]){continue}this._pickShader.uniforms.model=o.projections[n];this._pickShader.uniforms.clipBounds=o.clipBounds[n];this._vao.draw(t.TRIANGLES,this._vertexCount)}this._vao.unbind()}if(o.showContour){var s=this._contourPickShader;s.bind();s.uniforms=r;var l=this._contourVAO;l.bind();for(a=0;a<3;++a){t.lineWidth(this.contourWidth[a]);s.uniforms.permutation=T[a];for(n=0;n<this.contourLevels[a].length;++n){if(this._contourCounts[a][n]){s.uniforms.height=this.contourLevels[a][n];l.draw(t.LINES,this._contourCounts[a][n],this._contourOffsets[a][n])}}}for(n=0;n<3;++n){s.uniforms.model=o.projections[n];s.uniforms.clipBounds=o.clipBounds[n];for(a=0;a<3;++a){if(!this.contourProject[n][a]){continue}s.uniforms.permutation=T[a];t.lineWidth(this.contourWidth[a]);for(var u=0;u<this.contourLevels[a].length;++u){if(this._contourCounts[a][u]){s.uniforms.height=this.contourLevels[a][u];l.draw(t.LINES,this._contourCounts[a][u],this._contourOffsets[a][u])}}}}l.unbind()}};C.pick=function(e){if(!e){return null}if(e.id!==this.pickId){return null}var t=this._field[2].shape;var r=this._pickResult;var n=t[0]*(e.value[0]+(e.value[2]>>4)/16)/255;var i=Math.floor(n);var a=n-i;var o=t[1]*(e.value[1]+(e.value[2]&15)/16)/255;var s=Math.floor(o);var l=o-s;i+=1;s+=1;var u=r.position;u[0]=u[1]=u[2]=0;for(var f=0;f<2;++f){var c=f?a:1-a;for(var h=0;h<2;++h){var v=h?l:1-l;var d=i+f;var g=s+h;var m=c*v;for(var y=0;y<3;++y){u[y]+=this._field[y].get(d,g)*m}}}var b=this._pickResult.level;for(var x=0;x<3;++x){b[x]=p.le(this.contourLevels[x],u[x]);if(b[x]<0){if(this.contourLevels[x].length>0){b[x]=0}}else if(b[x]<this.contourLevels[x].length-1){var _=this.contourLevels[x][b[x]];var w=this.contourLevels[x][b[x]+1];if(Math.abs(_-u[x])>Math.abs(w-u[x])){b[x]+=1}}}r.index[0]=a<.5?i:i+1;r.index[1]=l<.5?s:s+1;r.uv[0]=n/t[0];r.uv[1]=o/t[1];for(y=0;y<3;++y){r.dataCoordinate[y]=this._field[y].get(r.index[0],r.index[1])}return r};function j(e,t){var r=t.shape.slice();var n=e.shape.slice();u.assign(e.lo(1,1).hi(r[0],r[1]),t);u.assign(e.lo(1).hi(r[0],1),t.hi(r[0],1));u.assign(e.lo(1,n[1]-1).hi(r[0],1),t.lo(0,r[1]-1).hi(r[0],1));u.assign(e.lo(0,1).hi(1,r[1]),t.hi(1));u.assign(e.lo(n[0]-1,1).hi(1,r[1]),t.lo(r[0]-1));e.set(0,0,t.get(0,0));e.set(0,n[1]-1,t.get(0,r[1]-1));e.set(n[0]-1,0,t.get(r[0]-1,0));e.set(n[0]-1,n[1]-1,t.get(r[0]-1,r[1]-1))}function B(e,t){if(Array.isArray(e)){return[t(e[0]),t(e[1]),t(e[2])]}return[t(e),t(e),t(e)]}function U(e){if(Array.isArray(e)){if(e.length===3){return[e[0],e[1],e[2],1]}return[e[0],e[1],e[2],e[3]]}return[0,0,0,1]}function V(e){if(Array.isArray(e)){if(Array.isArray(e)){return[U(e[0]),U(e[1]),U(e[2])]}else{var t=U(e);return[t.slice(),t.slice(),t.slice()]}}}C.update=function(e){e=e||{};this.dirty=true;if("contourWidth"in e){this.contourWidth=B(e.contourWidth,Number)}if("showContour"in e){this.showContour=B(e.showContour,Boolean)}if("showSurface"in e){this.showSurface=!!e.showSurface}if("contourTint"in e){this.contourTint=B(e.contourTint,Boolean)}if("contourColor"in e){this.contourColor=V(e.contourColor)}if("contourProject"in e){this.contourProject=B(e.contourProject,function(e){return B(e,Boolean)})}if("surfaceProject"in e){this.surfaceProject=e.surfaceProject}if("dynamicColor"in e){this.dynamicColor=V(e.dynamicColor)}if("dynamicTint"in e){this.dynamicTint=B(e.dynamicTint,Number)}if("dynamicWidth"in e){this.dynamicWidth=B(e.dynamicWidth,Number)}if("opacity"in e){this.opacity=e.opacity}if("colorBounds"in e){this.colorBounds=e.colorBounds}if("vertexColor"in e){this.vertexColor=e.vertexColor?1:0}var t=e.field||e.coords&&e.coords[2]||null;var r=false;if(!t){if(this._field[2].shape[0]||this._field[2].shape[2]){t=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2)}else{t=this._field[2].hi(0,0)}}if("field"in e||"coords"in e){var i=(t.shape[0]+2)*(t.shape[1]+2);if(i>this._field[2].data.length){s.freeFloat(this._field[2].data);this._field[2].data=s.mallocFloat(n.nextPow2(i))}this._field[2]=c(this._field[2].data,[t.shape[0]+2,t.shape[1]+2]);j(this._field[2],t);this.shape=t.shape.slice();var a=this.shape;for(var o=0;o<2;++o){if(this._field[2].size>this._field[o].data.length){s.freeFloat(this._field[o].data);this._field[o].data=s.mallocFloat(this._field[2].size)}this._field[o]=c(this._field[o].data,[a[0]+2,a[1]+2])}if(e.coords){var l=e.coords;if(!Array.isArray(l)||l.length!==3){throw new Error("gl-surface: invalid coordinates for x/y")}for(o=0;o<2;++o){var u=l[o];for(m=0;m<2;++m){if(u.shape[m]!==a[m]){throw new Error("gl-surface: coords have incorrect shape")}}j(this._field[o],u)}}else if(e.ticks){var f=e.ticks;if(!Array.isArray(f)||f.length!==2){throw new Error("gl-surface: invalid ticks")}for(o=0;o<2;++o){var v=f[o];if(Array.isArray(v)||v.length){v=c(v)}if(v.shape[0]!==a[o]){throw new Error("gl-surface: invalid tick length")}var d=c(v.data,a);d.stride[o]=v.stride[0];d.stride[o^1]=0;j(this._field[o],d)}}else{for(o=0;o<2;++o){var p=[0,0];p[o]=1;this._field[o]=c(this._field[o].data,[a[0]+2,a[1]+2],p,0)}this._field[0].set(0,0,0);for(var m=0;m<a[0];++m){this._field[0].set(m+1,0,m)}this._field[0].set(a[0]+1,0,a[0]-1);this._field[1].set(0,0,0);for(m=0;m<a[1];++m){this._field[1].set(0,m+1,m)}this._field[1].set(0,a[1]+1,a[1]-1)}var y=this._field;var b=c(s.mallocFloat(y[2].size*3*2),[3,a[0]+2,a[1]+2,2]);for(o=0;o<3;++o){g(b.pick(o),y[o],"mirror")}var x=c(s.mallocFloat(y[2].size*3),[a[0]+2,a[1]+2,3]);for(o=0;o<a[0]+2;++o){for(m=0;m<a[1]+2;++m){var _=b.get(0,o,m,0);var w=b.get(0,o,m,1);var M=b.get(1,o,m,0);var T=b.get(1,o,m,1);var k=b.get(2,o,m,0);var E=b.get(2,o,m,1);var L=M*E-T*k;var C=k*w-E*_;var I=_*T-w*M;var P=Math.sqrt(L*L+C*C+I*I);if(P<1e-8){P=Math.max(Math.abs(L),Math.abs(C),Math.abs(I));if(P<1e-8){I=1;C=L=0;P=1}else{P=1/P}}else{P=1/Math.sqrt(P)}x.set(o,m,0,L*P);x.set(o,m,1,C*P);x.set(o,m,2,I*P)}}s.free(b.data);var O=[Infinity,Infinity,Infinity];var R=[-Infinity,-Infinity,-Infinity];var N=Infinity;var z=-Infinity;var D=(a[0]-1)*(a[1]-1)*6;var F=s.mallocFloat(n.nextPow2(10*D));var U=0;var H=0;for(o=0;o<a[0]-1;++o){e:for(m=0;m<a[1]-1;++m){for(var q=0;q<2;++q){for(var G=0;G<2;++G){for(var W=0;W<3;++W){var X=this._field[W].get(1+o+q,1+m+G);if(isNaN(X)||!isFinite(X)){continue e}}}}for(W=0;W<6;++W){var Y=o+A[W][0];var Z=m+A[W][1];var Q=this._field[0].get(Y+1,Z+1);var K=this._field[1].get(Y+1,Z+1);X=this._field[2].get(Y+1,Z+1);var J=X;L=x.get(Y+1,Z+1,0);C=x.get(Y+1,Z+1,1);I=x.get(Y+1,Z+1,2);if(e.intensity){J=e.intensity.get(Y,Z)}F[U++]=Y;F[U++]=Z;F[U++]=Q;F[U++]=K;F[U++]=X;F[U++]=0;F[U++]=J;F[U++]=L;F[U++]=C;F[U++]=I;O[0]=Math.min(O[0],Q);O[1]=Math.min(O[1],K);O[2]=Math.min(O[2],X);N=Math.min(N,J);R[0]=Math.max(R[0],Q);R[1]=Math.max(R[1],K);R[2]=Math.max(R[2],X);z=Math.max(z,J);H+=1}}}if(e.intensityBounds){N=+e.intensityBounds[0];z=+e.intensityBounds[1]}for(o=6;o<U;o+=10){F[o]=(F[o]-N)/(z-N)}this._vertexCount=H;this._coordinateBuffer.update(F.subarray(0,U));s.freeFloat(F);s.free(x.data);this.bounds=[O,R];this.intensity=e.intensity||this._field[2];if(this.intensityBounds[0]!==N||this.intensityBounds[1]!==z){r=true}this.intensityBounds=[N,z]}if("levels"in e){var $=e.levels;if(!Array.isArray($[0])){$=[[],[],$]}else{$=$.slice()}for(o=0;o<3;++o){$[o]=$[o].slice();$.sort(function(e,t){return e-t})}e:for(o=0;o<3;++o){if($[o].length!==this.contourLevels[o].length){r=true;break}for(m=0;m<$[o].length;++m){if($[o][m]!==this.contourLevels[o][m]){r=true;break e}}}this.contourLevels=$}if(r){y=this._field;a=this.shape;var ee=[];for(var te=0;te<3;++te){$=this.contourLevels[te];var re=[];var ne=[];var ie=[0,0,0];for(o=0;o<$.length;++o){var ae=h(this._field[te],$[o]);re.push(ee.length/5|0);H=0;e:for(m=0;m<ae.cells.length;++m){var oe=ae.cells[m];for(W=0;W<2;++W){var se=ae.positions[oe[W]];var le=se[0];var ue=Math.floor(le)|0;var fe=le-ue;var ce=se[1];var he=Math.floor(ce)|0;var ve=ce-he;var de=false;t:for(var pe=0;pe<3;++pe){ie[pe]=0;var ge=(te+pe+1)%3;for(q=0;q<2;++q){var me=q?fe:1-fe;Y=Math.min(Math.max(ue+q,0),a[0])|0;for(G=0;G<2;++G){var ye=G?ve:1-ve;Z=Math.min(Math.max(he+G,0),a[1])|0;if(pe<2){X=this._field[ge].get(Y,Z)}else{X=(this.intensity.get(Y,Z)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0])}if(!isFinite(X)||isNaN(X)){de=true;break t}var be=me*ye;ie[pe]+=be*X}}}if(!de){ee.push(ie[0],ie[1],se[0],se[1],ie[2]);H+=1}else{if(W>0){for(var xe=0;xe<5;++xe){ee.pop()}H-=1}continue e}}}ne.push(H)}this._contourOffsets[te]=re;this._contourCounts[te]=ne}var _e=s.mallocFloat(ee.length);for(o=0;o<ee.length;++o){_e[o]=ee[o]}this._contourBuffer.update(_e);s.freeFloat(_e)}if(e.colormap){this._colorMap.setPixels(S(e.colormap))}};C.dispose=function(){this._shader.dispose();this._vao.dispose();this._coordinateBuffer.dispose();this._colorMap.dispose();this._contourBuffer.dispose();this._contourVAO.dispose();this._contourShader.dispose();this._contourPickShader.dispose();this._dynamicBuffer.dispose();this._dynamicVAO.dispose();for(var e=0;e<3;++e){s.freeFloat(this._field[e].data)}};C.highlight=function(e){if(!e){this._dynamicCounts=[0,0,0];this.dyanamicLevel=[NaN,NaN,NaN];this.highlightLevel=[-1,-1,-1];return}for(var t=0;t<3;++t){if(this.enableHighlight[t]){this.highlightLevel[t]=e.level[t]}else{this.highlightLevel[t]=-1}}var r;if(this.snapToData){r=e.dataCoordinate}else{r=e.position}if((!this.enableDynamic[0]||r[0]===this.dynamicLevel[0])&&(!this.enableDynamic[1]||r[1]===this.dynamicLevel[1])&&(!this.enableDynamic[2]||r[2]===this.dynamicLevel[2])){return}var n=0;var i=this.shape;var a=s.mallocFloat(12*i[0]*i[1]);for(var o=0;o<3;++o){if(!this.enableDynamic[o]){this.dynamicLevel[o]=NaN;this._dynamicCounts[o]=0;continue}this.dynamicLevel[o]=r[o];var l=(o+1)%3;var u=(o+2)%3;var f=this._field[o];var c=this._field[l];var v=this._field[u];var d=this.intensity;var p=h(f,r[o]);var g=p.cells;var m=p.positions;this._dynamicOffsets[o]=n;for(t=0;t<g.length;++t){var y=g[t];for(var b=0;b<2;++b){var x=m[y[b]];var _=+x[0];var w=_|0;var M=Math.min(w+1,i[0])|0;var A=_-w;var T=1-A;var k=+x[1];var E=k|0;var S=Math.min(E+1,i[1])|0;var L=k-E;var C=1-L;var I=T*C;var P=T*L;var O=A*C;var R=A*L;var N=I*c.get(w,E)+P*c.get(w,S)+O*c.get(M,E)+R*c.get(M,S);var z=I*v.get(w,E)+P*v.get(w,S)+O*v.get(M,E)+R*v.get(M,S);if(isNaN(N)||isNaN(z)){if(b){n-=1}break}a[2*n+0]=N;a[2*n+1]=z;n+=1}}this._dynamicCounts[o]=n-this._dynamicOffsets[o]}this._dynamicBuffer.update(a.subarray(0,2*n));s.freeFloat(a)};function H(e){var t=e.gl;var r=y(t);var n=x(t);var s=b(t);var l=_(t);var u=i(t);var f=a(t,[{buffer:u,size:4,stride:w,offset:0},{buffer:u,size:3,stride:w,offset:16},{buffer:u,size:3,stride:w,offset:28}]);var c=i(t);var h=a(t,[{buffer:c,size:4,stride:20,offset:0},{buffer:c,size:1,stride:20,offset:16}]);var v=i(t);var d=a(t,[{buffer:v,size:2,type:t.FLOAT}]);var p=o(t,1,E,t.RGBA,t.UNSIGNED_BYTE);p.minFilter=t.LINEAR;p.magFilter=t.LINEAR;var g=new L(t,[0,0],[[0,0,0],[0,0,0]],r,n,u,f,p,s,l,c,h,v,d);var m={levels:[[],[],[]]};for(var M in e){m[M]=e[M]}m.colormap=m.colormap||"jet";g.update(m);return g}},{"./lib/shaders":160,"binary-search-bounds":36,"bit-twiddle":37,colormap:68,"gl-buffer":104,"gl-mat4/invert":125,"gl-mat4/multiply":127,"gl-texture2d":162,"gl-vao":166,ndarray:270,"ndarray-gradient":261,"ndarray-ops":264,"ndarray-pack":265,"surface-nets":326,"typedarray-pool":333}],162:[function(e,t,r){"use strict";var n=e("ndarray");var i=e("ndarray-ops");var a=e("typedarray-pool");t.exports=_;var o=null;var s=null;var l=null;function u(e){o=[e.LINEAR,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_NEAREST];s=[e.NEAREST,e.LINEAR,e.NEAREST_MIPMAP_NEAREST,e.NEAREST_MIPMAP_LINEAR,e.LINEAR_MIPMAP_NEAREST,e.LINEAR_MIPMAP_LINEAR];l=[e.REPEAT,e.CLAMP_TO_EDGE,e.MIRRORED_REPEAT]}function f(e){return"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&e instanceof ImageData}var c=function(e,t){i.muls(e,t,255)};function h(e,t,r){var n=e.gl;var i=n.getParameter(n.MAX_TEXTURE_SIZE);if(t<0||t>i||r<0||r>i){throw new Error("gl-texture2d: Invalid texture size")}e._shape=[t,r];e.bind();n.texImage2D(n.TEXTURE_2D,0,e.format,t,r,0,e.format,e.type,null);e._mipLevels=[0];return e}function v(e,t,r,n,i,a){this.gl=e;this.handle=t;this.format=i;this.type=a;this._shape=[r,n];this._mipLevels=[0];this._magFilter=e.NEAREST;this._minFilter=e.NEAREST;this._wrapS=e.CLAMP_TO_EDGE;this._wrapT=e.CLAMP_TO_EDGE;this._anisoSamples=1;var o=this;var s=[this._wrapS,this._wrapT];Object.defineProperties(s,[{get:function(){return o._wrapS},set:function(e){return o.wrapS=e}},{get:function(){return o._wrapT},set:function(e){return o.wrapT=e}}]);this._wrapVector=s;var l=[this._shape[0],this._shape[1]];Object.defineProperties(l,[{get:function(){return o._shape[0]},set:function(e){return o.width=e}},{get:function(){return o._shape[1]},set:function(e){return o.height=e}}]);this._shapeVector=l}var d=v.prototype;Object.defineProperties(d,{minFilter:{get:function(){return this._minFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&o.indexOf(e)>=0){if(!t.getExtension("OES_texture_float_linear")){e=t.NEAREST}}if(s.indexOf(e)<0){throw new Error("gl-texture2d: Unknown filter mode "+e)}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,e);return this._minFilter=e}},magFilter:{get:function(){return this._magFilter},set:function(e){this.bind();var t=this.gl;if(this.type===t.FLOAT&&o.indexOf(e)>=0){if(!t.getExtension("OES_texture_float_linear")){e=t.NEAREST}}if(s.indexOf(e)<0){throw new Error("gl-texture2d: Unknown filter mode "+e)}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,e);return this._magFilter=e}},mipSamples:{get:function(){return this._anisoSamples},set:function(e){var t=this._anisoSamples;this._anisoSamples=Math.max(e,1)|0;if(t!==this._anisoSamples){var r=this.gl.getExtension("EXT_texture_filter_anisotropic");if(r){this.gl.texParameterf(this.gl.TEXTURE_2D,r.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(e){this.bind();if(l.indexOf(e)<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,e);return this._wrapS=e}},wrapT:{get:function(){return this._wrapT},set:function(e){this.bind();if(l.indexOf(e)<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,e);return this._wrapT=e}},wrap:{get:function(){return this._wrapVector},set:function(e){if(!Array.isArray(e)){e=[e,e]}if(e.length!==2){throw new Error("gl-texture2d: Must specify wrap mode for rows and columns")}for(var t=0;t<2;++t){if(l.indexOf(e[t])<0){throw new Error("gl-texture2d: Unknown wrap mode "+e)}}this._wrapS=e[0];this._wrapT=e[1];var r=this.gl;this.bind();r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,this._wrapS);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,this._wrapT);return e}},shape:{get:function(){return this._shapeVector},set:function(e){if(!Array.isArray(e)){e=[e|0,e|0]}else{if(e.length!==2){throw new Error("gl-texture2d: Invalid texture shape")}}h(this,e[0]|0,e[1]|0);return[e[0]|0,e[1]|0]}},width:{get:function(){return this._shape[0]},set:function(e){e=e|0;h(this,e,this._shape[1]);return e}},height:{get:function(){return this._shape[1]},set:function(e){e=e|0;h(this,this._shape[0],e);return e}}});d.bind=function(e){var t=this.gl;if(e!==undefined){t.activeTexture(t.TEXTURE0+(e|0))}t.bindTexture(t.TEXTURE_2D,this.handle);if(e!==undefined){return e|0}return t.getParameter(t.ACTIVE_TEXTURE)-t.TEXTURE0};d.dispose=function(){this.gl.deleteTexture(this.handle)};d.generateMipmap=function(){this.bind();this.gl.generateMipmap(this.gl.TEXTURE_2D);var e=Math.min(this._shape[0],this._shape[1]);for(var t=0;e>0;++t,e>>>=1){if(this._mipLevels.indexOf(t)<0){this._mipLevels.push(t)}}};d.setPixels=function(e,t,r,n){var i=this.gl;this.bind();if(Array.isArray(t)){n=r;r=t[1]|0;t=t[0]|0}else{t=t||0;r=r||0}n=n||0;var a=f(e)?e:e.raw;if(a){var o=this._mipLevels.indexOf(n)<0;if(o){i.texImage2D(i.TEXTURE_2D,0,this.format,this.format,this.type,a);this._mipLevels.push(n)}else{i.texSubImage2D(i.TEXTURE_2D,n,t,r,this.format,this.type,a)}}else if(e.shape&&e.stride&&e.data){if(e.shape.length<2||t+e.shape[1]>this._shape[1]>>>n||r+e.shape[0]>this._shape[0]>>>n||t<0||r<0){throw new Error("gl-texture2d: Texture dimensions are out of bounds")}g(i,t,r,n,this.format,this.type,this._mipLevels,e)}else{throw new Error("gl-texture2d: Unsupported data type")}};function p(e,t){if(e.length===3){return t[2]===1&&t[1]===e[0]*e[2]&&t[0]===e[2]}return t[0]===1&&t[1]===e[0]}function g(e,t,r,o,s,l,u,f){var h=f.dtype;var v=f.shape.slice();if(v.length<2||v.length>3){throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d")}var d=0,g=0;var m=p(v,f.stride.slice());if(h==="float32"){d=e.FLOAT}else if(h==="float64"){d=e.FLOAT;m=false;h="float32"}else if(h==="uint8"){d=e.UNSIGNED_BYTE}else{d=e.UNSIGNED_BYTE;m=false;h="uint8"}var y=1;if(v.length===2){g=e.LUMINANCE;v=[v[0],v[1],1];f=n(f.data,v,[f.stride[0],f.stride[1],1],f.offset)}else if(v.length===3){if(v[2]===1){g=e.ALPHA}else if(v[2]===2){g=e.LUMINANCE_ALPHA}else if(v[2]===3){g=e.RGB}else if(v[2]===4){g=e.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}y=v[2]}else{throw new Error("gl-texture2d: Invalid shape for texture")}if((g===e.LUMINANCE||g===e.ALPHA)&&(s===e.LUMINANCE||s===e.ALPHA)){g=s}if(g!==s){throw new Error("gl-texture2d: Incompatible texture format for setPixels")}var b=f.size;var x=u.indexOf(o)<0;if(x){u.push(o)}if(d===l&&m){if(f.offset===0&&f.data.length===b){if(x){e.texImage2D(e.TEXTURE_2D,o,s,v[0],v[1],0,s,l,f.data)}else{e.texSubImage2D(e.TEXTURE_2D,o,t,r,v[0],v[1],s,l,f.data)}}else{if(x){e.texImage2D(e.TEXTURE_2D,o,s,v[0],v[1],0,s,l,f.data.subarray(f.offset,f.offset+b))}else{e.texSubImage2D(e.TEXTURE_2D,o,t,r,v[0],v[1],s,l,f.data.subarray(f.offset,f.offset+b))}}}else{var _;if(l===e.FLOAT){_=a.mallocFloat32(b)}else{_=a.mallocUint8(b)}var w=n(_,v,[v[2],v[2]*v[0],1]);if(d===e.FLOAT&&l===e.UNSIGNED_BYTE){c(w,f)}else{i.assign(w,f)}if(x){e.texImage2D(e.TEXTURE_2D,o,s,v[0],v[1],0,s,l,_.subarray(0,b))}else{e.texSubImage2D(e.TEXTURE_2D,o,t,r,v[0],v[1],s,l,_.subarray(0,b))}if(l===e.FLOAT){a.freeFloat32(_)}else{a.freeUint8(_)}}}function m(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE);e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);return t}function y(e,t,r,n,i){var a=e.getParameter(e.MAX_TEXTURE_SIZE);if(t<0||t>a||r<0||r>a){throw new Error("gl-texture2d: Invalid texture shape")}if(i===e.FLOAT&&!e.getExtension("OES_texture_float")){throw new Error("gl-texture2d: Floating point textures not supported on this platform")}var o=m(e);e.texImage2D(e.TEXTURE_2D,0,n,t,r,0,n,i,null);return new v(e,o,t,r,n,i)}function b(e,t,r,n,i,a){var o=m(e);e.texImage2D(e.TEXTURE_2D,0,i,i,a,t);return new v(e,o,r,n,i,a)}function x(e,t){var r=t.dtype;var o=t.shape.slice();var s=e.getParameter(e.MAX_TEXTURE_SIZE);if(o[0]<0||o[0]>s||o[1]<0||o[1]>s){throw new Error("gl-texture2d: Invalid texture size")}var l=p(o,t.stride.slice());var u=0;if(r==="float32"){u=e.FLOAT}else if(r==="float64"){u=e.FLOAT;l=false;r="float32"}else if(r==="uint8"){u=e.UNSIGNED_BYTE}else{u=e.UNSIGNED_BYTE;l=false;r="uint8"}var f=0;if(o.length===2){f=e.LUMINANCE;o=[o[0],o[1],1];t=n(t.data,o,[t.stride[0],t.stride[1],1],t.offset)}else if(o.length===3){if(o[2]===1){f=e.ALPHA}else if(o[2]===2){f=e.LUMINANCE_ALPHA}else if(o[2]===3){f=e.RGB}else if(o[2]===4){f=e.RGBA}else{throw new Error("gl-texture2d: Invalid shape for pixel coords")}}else{throw new Error("gl-texture2d: Invalid shape for texture")}if(u===e.FLOAT&&!e.getExtension("OES_texture_float")){u=e.UNSIGNED_BYTE;l=false}var h,d;var g=t.size;if(!l){var y=[o[2],o[2]*o[0],1];d=a.malloc(g,r);var b=n(d,o,y,0);if((r==="float32"||r==="float64")&&u===e.UNSIGNED_BYTE){c(b,t)}else{i.assign(b,t)}h=d.subarray(0,g)}else if(t.offset===0&&t.data.length===g){h=t.data}else{h=t.data.subarray(t.offset,t.offset+g)}var x=m(e);e.texImage2D(e.TEXTURE_2D,0,f,o[0],o[1],0,f,u,h);if(!l){a.free(d)}return new v(e,x,o[0],o[1],f,u)}function _(e){if(arguments.length<=1){throw new Error("gl-texture2d: Missing arguments for texture2d constructor")}if(!o){u(e)}if(typeof arguments[1]==="number"){return y(e,arguments[1],arguments[2],arguments[3]||e.RGBA,arguments[4]||e.UNSIGNED_BYTE)}if(Array.isArray(arguments[1])){return y(e,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE)}if(typeof arguments[1]==="object"){var t=arguments[1];var r=f(t)?t:t.raw;if(r){return b(e,r,t.width|0,t.height|0,arguments[2]||e.RGBA,arguments[3]||e.UNSIGNED_BYTE)}else if(t.shape&&t.data&&t.stride){return x(e,t)}}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:270,"ndarray-ops":264,"typedarray-pool":333}],163:[function(e,t,r){"use strict";function n(e,t,r){if(t){t.bind()}else{e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}var n=e.getParameter(e.MAX_VERTEX_ATTRIBS)|0;if(r){if(r.length>n){throw new Error("gl-vao: Too many vertex attributes")}for(var i=0;i<r.length;++i){var a=r[i];if(a.buffer){var o=a.buffer;var s=a.size||4;var l=a.type||e.FLOAT;var u=!!a.normalized;var f=a.stride||0;var c=a.offset||0;o.bind();e.enableVertexAttribArray(i);e.vertexAttribPointer(i,s,l,u,f,c)}else{if(typeof a==="number"){e.vertexAttrib1f(i,a)}else if(a.length===1){e.vertexAttrib1f(i,a[0])}else if(a.length===2){e.vertexAttrib2f(i,a[0],a[1])}else if(a.length===3){e.vertexAttrib3f(i,a[0],a[1],a[2])}else if(a.length===4){e.vertexAttrib4f(i,a[0],a[1],a[2],a[3])}else{throw new Error("gl-vao: Invalid vertex attribute")}e.disableVertexAttribArray(i)}}for(;i<n;++i){e.disableVertexAttribArray(i)}}else{e.bindBuffer(e.ARRAY_BUFFER,null);for(var i=0;i<n;++i){e.disableVertexAttribArray(i)}}}t.exports=n},{}],164:[function(e,t,r){"use strict";var n=e("./do-bind.js");function i(e){this.gl=e;this._elements=null;this._attributes=null;this._elementsType=e.UNSIGNED_SHORT}i.prototype.bind=function(){n(this.gl,this._elements,this._attributes)};i.prototype.update=function(e,t,r){this._elements=t;this._attributes=e;this._elementsType=r||this.gl.UNSIGNED_SHORT};i.prototype.dispose=function(){};i.prototype.unbind=function(){};i.prototype.draw=function(e,t,r){r=r||0;var n=this.gl;if(this._elements){n.drawElements(e,t,this._elementsType,r)}else{n.drawArrays(e,r,t)}};function a(e){return new i(e)}t.exports=a},{"./do-bind.js":163}],165:[function(e,t,r){"use strict";var n=e("./do-bind.js");function i(e,t,r,n,i,a){this.location=e;this.dimension=t;this.a=r;this.b=n;this.c=i;this.d=a}i.prototype.bind=function(e){switch(this.dimension){case 1:e.vertexAttrib1f(this.location,this.a);break;case 2:e.vertexAttrib2f(this.location,this.a,this.b);break;case 3:e.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:e.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function a(e,t,r){this.gl=e;this._ext=t;this.handle=r;this._attribs=[];this._useElements=false;this._elementsType=e.UNSIGNED_SHORT}a.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var e=0;e<this._attribs.length;++e){this._attribs[e].bind(this.gl)}};a.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)};a.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)};a.prototype.update=function(e,t,r){this.bind();n(this.gl,t,e);this.unbind();this._attribs.length=0;if(e)for(var a=0;a<e.length;++a){var o=e[a];if(typeof o==="number"){this._attribs.push(new i(a,1,o))}else if(Array.isArray(o)){this._attribs.push(new i(a,o.length,o[0],o[1],o[2],o[3]))}}this._useElements=!!t;this._elementsType=r||this.gl.UNSIGNED_SHORT};a.prototype.draw=function(e,t,r){r=r||0;var n=this.gl;if(this._useElements){n.drawElements(e,t,this._elementsType,r)}else{n.drawArrays(e,r,t)}};function o(e,t){return new a(e,t,t.createVertexArrayOES())}t.exports=o},{"./do-bind.js":163}],166:[function(e,t,r){"use strict";var n=e("./lib/vao-native.js");var i=e("./lib/vao-emulated.js");function a(e){this.bindVertexArrayOES=e.bindVertexArray.bind(e);this.createVertexArrayOES=e.createVertexArray.bind(e);this.deleteVertexArrayOES=e.deleteVertexArray.bind(e)}function o(e,t,r,o){var s=e.createVertexArray?new a(e):e.getExtension("OES_vertex_array_object");var l;if(s){l=n(e,s)}else{l=i(e)}l.update(t,r,o);return l}t.exports=o},{"./lib/vao-emulated.js":164,"./lib/vao-native.js":165}],167:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];return e}},{}],168:[function(e,t,r){t.exports=o;var n=e("./fromValues");var i=e("./normalize");var a=e("./dot");function o(e,t){var r=n(e[0],e[1],e[2]);var o=n(t[0],t[1],t[2]);i(r,r);i(o,o);var s=a(r,o);if(s>1){return 0}else{return Math.acos(s)}}},{"./dot":175,"./fromValues":177,"./normalize":186}],169:[function(e,t,r){t.exports=n;function n(e){var t=new Float32Array(3);t[0]=e[0];t[1]=e[1];t[2]=e[2];return t}},{}],170:[function(e,t,r){t.exports=n;function n(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];return e}},{}],171:[function(e,t,r){t.exports=n;function n(){var e=new Float32Array(3);e[0]=0;e[1]=0;e[2]=0;return e}},{}],172:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],l=r[2];e[0]=i*l-a*s;e[1]=a*o-n*l;e[2]=n*s-i*o;return e}},{}],173:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}},{}],174:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]/r[0];e[1]=t[1]/r[1];e[2]=t[2]/r[2];return e}},{}],175:[function(e,t,r){t.exports=n;function n(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{}],176:[function(e,t,r){t.exports=i;var n=e("./create")();function i(e,t,r,i,a,o){var s,l;if(!t){t=3}if(!r){r=0}if(i){l=Math.min(i*t+r,e.length)}else{l=e.length}for(s=r;s<l;s+=t){n[0]=e[s];n[1]=e[s+1];n[2]=e[s+2];a(n,n,o);e[s]=n[0];e[s+1]=n[1];e[s+2]=n[2]}return e}},{"./create":171}],177:[function(e,t,r){t.exports=n;function n(e,t,r){var n=new Float32Array(3);n[0]=e;n[1]=t;n[2]=r;return n}},{}],178:[function(e,t,r){t.exports={create:e("./create"),clone:e("./clone"),angle:e("./angle"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),add:e("./add"),subtract:e("./subtract"),multiply:e("./multiply"),divide:e("./divide"),min:e("./min"),max:e("./max"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),squaredDistance:e("./squaredDistance"),length:e("./length"),squaredLength:e("./squaredLength"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),cross:e("./cross"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformMat3:e("./transformMat3"),transformQuat:e("./transformQuat"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),forEach:e("./forEach")}},{"./add":167,"./angle":168,"./clone":169,"./copy":170,"./create":171,"./cross":172,"./distance":173,"./divide":174,"./dot":175,"./forEach":176,"./fromValues":177,"./inverse":179,"./length":180,"./lerp":181,"./max":182,"./min":183,"./multiply":184,"./negate":185,"./normalize":186,"./random":187,"./rotateX":188,"./rotateY":189,"./rotateZ":190,"./scale":191,"./scaleAndAdd":192,"./set":193,"./squaredDistance":194,"./squaredLength":195,"./subtract":196,"./transformMat3":197,"./transformMat4":198,"./transformQuat":199}],179:[function(e,t,r){t.exports=n;function n(e,t){e[0]=1/t[0];e[1]=1/t[1];e[2]=1/t[2];return e}},{}],180:[function(e,t,r){t.exports=n;function n(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}},{}],181:[function(e,t,r){t.exports=n;function n(e,t,r,n){var i=t[0],a=t[1],o=t[2];e[0]=i+n*(r[0]-i);e[1]=a+n*(r[1]-a);e[2]=o+n*(r[2]-o);return e}},{}],182:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=Math.max(t[0],r[0]);e[1]=Math.max(t[1],r[1]);e[2]=Math.max(t[2],r[2]);return e}},{}],183:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=Math.min(t[0],r[0]);e[1]=Math.min(t[1],r[1]);e[2]=Math.min(t[2],r[2]);return e}},{}],184:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]*r[0];e[1]=t[1]*r[1];e[2]=t[2]*r[2];return e}},{}],185:[function(e,t,r){t.exports=n;function n(e,t){e[0]=-t[0];e[1]=-t[1];e[2]=-t[2];return e}},{}],186:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0],n=t[1],i=t[2];var a=r*r+n*n+i*i;if(a>0){a=1/Math.sqrt(a);e[0]=t[0]*a;e[1]=t[1]*a;e[2]=t[2]*a}return e}},{}],187:[function(e,t,r){t.exports=n;function n(e,t){t=t||1;var r=Math.random()*2*Math.PI;var n=Math.random()*2-1;var i=Math.sqrt(1-n*n)*t;e[0]=Math.cos(r)*i;e[1]=Math.sin(r)*i;e[2]=n*t;return e}},{}],188:[function(e,t,r){t.exports=n;function n(e,t,r,n){var i=[],a=[];i[0]=t[0]-r[0];i[1]=t[1]-r[1];i[2]=t[2]-r[2];a[0]=i[0];a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n);a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n);e[0]=a[0]+r[0];e[1]=a[1]+r[1];e[2]=a[2]+r[2];return e}},{}],189:[function(e,t,r){t.exports=n;function n(e,t,r,n){var i=[],a=[];i[0]=t[0]-r[0];i[1]=t[1]-r[1];i[2]=t[2]-r[2];a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n);a[1]=i[1];a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n);e[0]=a[0]+r[0];e[1]=a[1]+r[1];e[2]=a[2]+r[2];return e}},{}],190:[function(e,t,r){t.exports=n;function n(e,t,r,n){var i=[],a=[];i[0]=t[0]-r[0];i[1]=t[1]-r[1];i[2]=t[2]-r[2];a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n);a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n);a[2]=i[2];e[0]=a[0]+r[0];e[1]=a[1]+r[1];e[2]=a[2]+r[2];return e}},{}],191:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;return e}},{}],192:[function(e,t,r){t.exports=n;function n(e,t,r,n){e[0]=t[0]+r[0]*n;e[1]=t[1]+r[1]*n;e[2]=t[2]+r[2]*n;return e}},{}],193:[function(e,t,r){t.exports=n;function n(e,t,r,n){e[0]=t;e[1]=r;e[2]=n;return e}},{}],194:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}},{}],195:[function(e,t,r){t.exports=n;function n(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}},{}],196:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];return e}},{}],197:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],i=t[1],a=t[2];e[0]=n*r[0]+i*r[3]+a*r[6];e[1]=n*r[1]+i*r[4]+a*r[7];e[2]=n*r[2]+i*r[5]+a*r[8];return e}},{}],198:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];o=o||1;e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o;e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o;e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o;return e}},{}],199:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],l=r[2],u=r[3],f=u*n+s*a-l*i,c=u*i+l*n-o*a,h=u*a+o*i-s*n,v=-o*n-s*i-l*a;e[0]=f*u+v*-o+c*-l-h*-s;e[1]=c*u+v*-s+h*-o-f*-l;e[2]=h*u+v*-l+f*-s-c*-o;return e}},{}],200:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]+r[0];e[1]=t[1]+r[1];e[2]=t[2]+r[2];e[3]=t[3]+r[3];return e}},{}],201:[function(e,t,r){t.exports=n;function n(e){var t=new Float32Array(4);t[0]=e[0];t[1]=e[1];t[2]=e[2];t[3]=e[3];return t}},{}],202:[function(e,t,r){t.exports=n;function n(e,t){e[0]=t[0];e[1]=t[1];e[2]=t[2];e[3]=t[3];return e}},{}],203:[function(e,t,r){t.exports=n;function n(){var e=new Float32Array(4);e[0]=0;e[1]=0;e[2]=0;e[3]=0;return e}},{}],204:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+a*a)}},{}],205:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]/r[0];e[1]=t[1]/r[1];e[2]=t[2]/r[2];e[3]=t[3]/r[3];return e}},{}],206:[function(e,t,r){t.exports=n;function n(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},{}],207:[function(e,t,r){t.exports=n;function n(e,t,r,n){var i=new Float32Array(4);i[0]=e;i[1]=t;i[2]=r;i[3]=n;return i}},{}],208:[function(e,t,r){t.exports={create:e("./create"),clone:e("./clone"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),add:e("./add"),subtract:e("./subtract"),multiply:e("./multiply"),divide:e("./divide"),min:e("./min"),max:e("./max"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),squaredDistance:e("./squaredDistance"),length:e("./length"),squaredLength:e("./squaredLength"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformQuat:e("./transformQuat")}},{"./add":200,"./clone":201,"./copy":202,"./create":203,"./distance":204,"./divide":205,"./dot":206,"./fromValues":207,"./inverse":209,"./length":210,"./lerp":211,"./max":212,"./min":213,"./multiply":214,"./negate":215,"./normalize":216,"./random":217,"./scale":218,"./scaleAndAdd":219,"./set":220,"./squaredDistance":221,"./squaredLength":222,"./subtract":223,"./transformMat4":224,"./transformQuat":225}],209:[function(e,t,r){t.exports=n;function n(e,t){e[0]=1/t[0];e[1]=1/t[1];e[2]=1/t[2];e[3]=1/t[3];return e}},{}],210:[function(e,t,r){t.exports=n;function n(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}},{}],211:[function(e,t,r){t.exports=n;function n(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3];e[0]=i+n*(r[0]-i);e[1]=a+n*(r[1]-a);e[2]=o+n*(r[2]-o);e[3]=s+n*(r[3]-s);return e}},{}],212:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=Math.max(t[0],r[0]);e[1]=Math.max(t[1],r[1]);e[2]=Math.max(t[2],r[2]);e[3]=Math.max(t[3],r[3]);return e}},{}],213:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=Math.min(t[0],r[0]);e[1]=Math.min(t[1],r[1]);e[2]=Math.min(t[2],r[2]);e[3]=Math.min(t[3],r[3]);return e}},{}],214:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]*r[0];e[1]=t[1]*r[1];e[2]=t[2]*r[2];e[3]=t[3]*r[3];return e}},{}],215:[function(e,t,r){t.exports=n;function n(e,t){e[0]=-t[0];e[1]=-t[1];e[2]=-t[2];e[3]=-t[3];return e}},{}],216:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];var o=r*r+n*n+i*i+a*a;if(o>0){o=1/Math.sqrt(o);e[0]=r*o;e[1]=n*o;e[2]=i*o;e[3]=a*o}return e}},{}],217:[function(e,t,r){var n=e("./normalize");var i=e("./scale");t.exports=a;function a(e,t){t=t||1;e[0]=Math.random();e[1]=Math.random();e[2]=Math.random();e[3]=Math.random();n(e,e);i(e,e,t);return e}},{"./normalize":216,"./scale":218}],218:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]*r;e[1]=t[1]*r;e[2]=t[2]*r;e[3]=t[3]*r;return e}},{}],219:[function(e,t,r){t.exports=n;function n(e,t,r,n){e[0]=t[0]+r[0]*n;e[1]=t[1]+r[1]*n;e[2]=t[2]+r[2]*n;e[3]=t[3]+r[3]*n;return e}},{}],220:[function(e,t,r){t.exports=n;function n(e,t,r,n,i){e[0]=t;e[1]=r;e[2]=n;e[3]=i;return e}},{}],221:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return r*r+n*n+i*i+a*a}},{}],222:[function(e,t,r){t.exports=n;function n(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}},{}],223:[function(e,t,r){t.exports=n;function n(e,t,r){e[0]=t[0]-r[0];e[1]=t[1]-r[1];e[2]=t[2]-r[2];e[3]=t[3]-r[3];return e}},{}],224:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o;e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o;e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o;e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o;return e}},{}],225:[function(e,t,r){t.exports=n;function n(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],l=r[2],u=r[3],f=u*n+s*a-l*i,c=u*i+l*n-o*a,h=u*a+o*i-s*n,v=-o*n-s*i-l*a;e[0]=f*u+v*-o+c*-l-h*-s;e[1]=c*u+v*-s+h*-o-f*-l;e[2]=h*u+v*-l+f*-s-c*-o;e[3]=t[3];return e}},{}],226:[function(e,t,r){t.exports=a;var n=new Uint8Array(4);var i=new Float32Array(n.buffer);function a(e,t,r,a){n[0]=a;n[1]=r;n[2]=t;n[3]=e;return i[0]}},{}],227:[function(e,t,r){var n=e("glsl-tokenizer");var i=e("atob-lite");t.exports=a;function a(e){var t=Array.isArray(e)?e:n(e);for(var r=0;r<t.length;r++){var a=t[r];if(a.type!=="preprocessor")continue;var o=a.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(!o)continue;if(!o[2])continue;var s=o[1];var l=o[2];return(s?i(l):l).trim()}}},{"atob-lite":17,"glsl-tokenizer":234}],228:[function(e,t,r){t.exports=M;var n=e("./lib/literals"),i=e("./lib/operators"),a=e("./lib/builtins"),o=e("./lib/literals-300es"),s=e("./lib/builtins-300es");var l=999,u=9999,f=0,c=1,h=2,v=3,d=4,p=5,g=6,m=7,y=8,b=9,x=10,_=11;var w=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function M(e){var t=0,r=0,M=l,A,T,k=[],E=[],S=0,L=0,C=1,I=0,P=0,O=false,R=false,N="",z;e=e||{};var D=a;var F=n;if(e.version==="300 es"){D=s;F=o}return function(e){E=[];if(e!==null)return B(e.replace?e.replace(/\r\n/g,"\n"):e);return U()};function j(e){if(e.length){E.push({type:w[M],data:e,position:P,line:C,column:I})}}function B(e){t=0;N+=e;z=N.length;var n;while(A=N[t],t<z){n=t;switch(M){case f:t=W();break;case c:t=G();break;case h:t=q();break;case v:t=X();break;case d:t=Q();break;case _:t=Z();break;case p:t=K();break;case u:t=J();break;case b:t=H();break;case l:t=V();break}if(n!==t){switch(N[n]){case"\n":I=0;++C;break;default:++I;break}}}r+=t;N=N.slice(t);return E}function U(e){if(k.length){j(k.join(""))}M=x;j("(eof)");return E}function V(){k=k.length?[]:k;if(T==="/"&&A==="*"){P=r+t-1;M=f;T=A;return t+1}if(T==="/"&&A==="/"){P=r+t-1;M=c;T=A;return t+1}if(A==="#"){M=h;P=r+t;return t}if(/\s/.test(A)){M=b;P=r+t;return t}O=/\d/.test(A);R=/[^\w_]/.test(A);P=r+t;M=O?d:R?v:u;return t}function H(){if(/[^\s]/g.test(A)){j(k.join(""));M=l;return t}k.push(A);T=A;return t+1}function q(){if((A==="\r"||A==="\n")&&T!=="\\"){j(k.join(""));M=l;return t}k.push(A);T=A;return t+1}function G(){return q()}function W(){if(A==="/"&&T==="*"){k.push(A);j(k.join(""));M=l;return t+1}k.push(A);T=A;return t+1}function X(){if(T==="."&&/\d/.test(A)){M=p;return t}if(T==="/"&&A==="*"){M=f;return t}if(T==="/"&&A==="/"){M=c;return t}if(A==="."&&k.length){while(Y(k));M=p;return t}if(A===";"||A===")"||A==="("){if(k.length)while(Y(k));j(A);M=l;return t+1}var e=k.length===2&&A!=="=";if(/[\w_\d\s]/.test(A)||e){while(Y(k));M=l;return t}k.push(A);T=A;return t+1}function Y(e){var t=0,r,n;do{r=i.indexOf(e.slice(0,e.length+t).join(""));n=i[r];if(r===-1){if(t--+e.length>0)continue;n=e.slice(0,1).join("")}j(n);P+=n.length;k=k.slice(n.length);return k.length}while(1)}function Z(){if(/[^a-fA-F0-9]/.test(A)){j(k.join(""));M=l;return t}k.push(A);T=A;return t+1}function Q(){if(A==="."){k.push(A);M=p;T=A;return t+1}if(/[eE]/.test(A)){k.push(A);M=p;T=A;return t+1}if(A==="x"&&k.length===1&&k[0]==="0"){M=_;k.push(A);T=A;return t+1}if(/[^\d]/.test(A)){j(k.join(""));M=l;return t}k.push(A);T=A;return t+1}function K(){if(A==="f"){k.push(A);T=A;t+=1}if(/[eE]/.test(A)){k.push(A);T=A;return t+1}if(A==="-"&&/[eE]/.test(T)){k.push(A);T=A;return t+1}if(/[^\d]/.test(A)){j(k.join(""));M=l;return t}k.push(A);T=A;return t+1}function J(){if(/[^\d\w_]/.test(A)){var e=k.join("");if(F.indexOf(e)>-1){M=y}else if(D.indexOf(e)>-1){M=m}else{M=g}j(k.join(""));M=l;return t}k.push(A);T=A;return t+1}}},{"./lib/builtins":230,"./lib/builtins-300es":229,"./lib/literals":232,"./lib/literals-300es":231,"./lib/operators":233}],229:[function(e,t,r){var n=e("./builtins");n=n.slice().filter(function(e){return!/^(gl\_|texture)/.test(e)});t.exports=n.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":230}],230:[function(e,t,r){t.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],231:[function(e,t,r){var n=e("./literals");t.exports=n.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":232}],232:[function(e,t,r){t.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],233:[function(e,t,r){t.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],234:[function(e,t,r){var n=e("./index");t.exports=i;function i(e,t){var r=n(t);var i=[];i=i.concat(r(e));i=i.concat(r(null));return i}},{"./index":228}],235:[function(e,t,r){t.exports=function(e){if(typeof e==="string")e=[e];var t=[].slice.call(arguments,1);var r=[];for(var n=0;n<e.length-1;n++){r.push(e[n],t[n]||"")}r.push(e[n]);return r.join("")}},{}],236:[function(e,t,r){(function(r){"use strict";var n=e("is-browser");var i;if(typeof r.matchMedia==="function"){i=!r.matchMedia("(hover: none)").matches}else{i=n}t.exports=i}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"is-browser":243}],237:[function(e,t,r){"use strict";var n=e("is-browser");function i(){var e=false;try{var t=Object.defineProperty({},"passive",{get:function(){e=true}});window.addEventListener("test",null,t);window.removeEventListener("test",null,t)}catch(t){e=false}return e}t.exports=n&&i()},{"is-browser":243}],238:[function(e,t,r){r.read=function(e,t,r,n,i){var a,o;var s=i*8-n-1;var l=(1<<s)-1;var u=l>>1;var f=-7;var c=r?i-1:0;var h=r?-1:1;var v=e[t+c];c+=h;a=v&(1<<-f)-1;v>>=-f;f+=s;for(;f>0;a=a*256+e[t+c],c+=h,f-=8){}o=a&(1<<-f)-1;a>>=-f;f+=n;for(;f>0;o=o*256+e[t+c],c+=h,f-=8){}if(a===0){a=1-u}else if(a===l){return o?NaN:(v?-1:1)*Infinity}else{o=o+Math.pow(2,n);a=a-u}return(v?-1:1)*o*Math.pow(2,a-n)};r.write=function(e,t,r,n,i,a){var o,s,l;var u=a*8-i-1;var f=(1<<u)-1;var c=f>>1;var h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0;var v=n?0:a-1;var d=n?1:-1;var p=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){s=isNaN(t)?1:0;o=f}else{o=Math.floor(Math.log(t)/Math.LN2);if(t*(l=Math.pow(2,-o))<1){o--;l*=2}if(o+c>=1){t+=h/l}else{t+=h*Math.pow(2,1-c)}if(t*l>=2){o++;l/=2}if(o+c>=f){s=0;o=f}else if(o+c>=1){s=(t*l-1)*Math.pow(2,i);o=o+c}else{s=t*Math.pow(2,c-1)*Math.pow(2,i);o=0}}for(;i>=8;e[r+v]=s&255,v+=d,s/=256,i-=8){}o=o<<i|s;u+=i;for(;u>0;e[r+v]=o&255,v+=d,o/=256,u-=8){}e[r+v-d]|=p*128}},{}],239:[function(e,t,r){"use strict";t.exports=v;var n=e("robust-orientation");var i=e("simplicial-complex").compareCells;function a(e,t){return e-t}function o(e,t,r){this.vertices=e;this.adjacent=t;this.boundary=r;this.lastVisited=-1}o.prototype.flip=function(){var e=this.vertices[0];this.vertices[0]=this.vertices[1];this.vertices[1]=e;var t=this.adjacent[0];this.adjacent[0]=this.adjacent[1];this.adjacent[1]=t};function s(e,t,r){this.vertices=e;this.cell=t;this.index=r}function l(e,t){return i(e.vertices,t.vertices)}function u(e){var t=["function orient(){var tuple=this.tuple;return test("];for(var r=0;r<=e;++r){if(r>0){t.push(",")}t.push("tuple[",r,"]")}t.push(")}return orient");var i=new Function("test",t.join(""));var a=n[e+1];if(!a){a=n}return i(a)}var f=[];function c(e,t,r){this.dimension=e;this.vertices=t;this.simplices=r;this.interior=r.filter(function(e){return!e.boundary});this.tuple=new Array(e+1);for(var n=0;n<=e;++n){this.tuple[n]=this.vertices[n]}var i=f[e];if(!i){i=f[e]=u(e)}this.orient=i}var h=c.prototype;h.handleBoundaryDegeneracy=function(e,t){var r=this.dimension;var n=this.vertices.length-1;var i=this.tuple;var a=this.vertices;var o=[e];e.lastVisited=-n;while(o.length>0){e=o.pop();var s=e.vertices;var l=e.adjacent;for(var u=0;u<=r;++u){var f=l[u];if(!f.boundary||f.lastVisited<=-n){continue}var c=f.vertices;for(var h=0;h<=r;++h){var v=c[h];if(v<0){i[h]=t}else{i[h]=a[v]}}var d=this.orient();if(d>0){return f}f.lastVisited=-n;if(d===0){o.push(f)}}}return null};h.walk=function(e,t){var r=this.vertices.length-1;var n=this.dimension;var i=this.vertices;var a=this.tuple;var o=t?this.interior.length*Math.random()|0:this.interior.length-1;var s=this.interior[o];e:while(!s.boundary){var l=s.vertices;var u=s.adjacent;for(var f=0;f<=n;++f){a[f]=i[l[f]]}s.lastVisited=r;for(var f=0;f<=n;++f){var c=u[f];if(c.lastVisited>=r){continue}var h=a[f];a[f]=e;var v=this.orient();a[f]=h;if(v<0){s=c;continue e}else{if(!c.boundary){c.lastVisited=r}else{c.lastVisited=-r}}}return}return s};h.addPeaks=function(e,t){var r=this.vertices.length-1;var n=this.dimension;var i=this.vertices;var a=this.tuple;var u=this.interior;var f=this.simplices;var c=[t];t.lastVisited=r;t.vertices[t.vertices.indexOf(-1)]=r;t.boundary=false;u.push(t);var h=[];while(c.length>0){var t=c.pop();var v=t.vertices;var d=t.adjacent;var p=v.indexOf(r);if(p<0){continue}for(var g=0;g<=n;++g){if(g===p){continue}var m=d[g];if(!m.boundary||m.lastVisited>=r){continue}var y=m.vertices;if(m.lastVisited!==-r){var b=0;for(var x=0;x<=n;++x){if(y[x]<0){b=x;a[x]=e}else{a[x]=i[y[x]]}}var _=this.orient();if(_>0){y[b]=r;m.boundary=false;u.push(m);c.push(m);m.lastVisited=r;continue}else{m.lastVisited=-r}}var w=m.adjacent;var M=v.slice();var A=d.slice();var T=new o(M,A,true);f.push(T);var k=w.indexOf(t);if(k<0){continue}w[k]=T;A[p]=m;M[g]=-1;A[g]=t;d[g]=T;T.flip();for(var x=0;x<=n;++x){var E=M[x];if(E<0||E===r){continue}var S=new Array(n-1);var L=0;for(var C=0;C<=n;++C){var I=M[C];if(I<0||C===x){continue}S[L++]=I}h.push(new s(S,T,x))}}}h.sort(l);for(var g=0;g+1<h.length;g+=2){var P=h[g];var O=h[g+1];var R=P.index;var N=O.index;if(R<0||N<0){continue}P.cell.adjacent[P.index]=O.cell;O.cell.adjacent[O.index]=P.cell}};h.insert=function(e,t){var r=this.vertices;r.push(e);var n=this.walk(e,t);if(!n){return}var i=this.dimension;var a=this.tuple;for(var o=0;o<=i;++o){var s=n.vertices[o];if(s<0){a[o]=e}else{a[o]=r[s]}}var l=this.orient(a);if(l<0){return}else if(l===0){n=this.handleBoundaryDegeneracy(n,e);if(!n){return}}this.addPeaks(e,n)};h.boundary=function(){var e=this.dimension;var t=[];var r=this.simplices;var n=r.length;for(var i=0;i<n;++i){var a=r[i];if(a.boundary){var o=new Array(e);var s=a.vertices;var l=0;var u=0;for(var f=0;f<=e;++f){if(s[f]>=0){o[l++]=s[f]}else{u=f&1}}if(u===(e&1)){var c=o[0];o[0]=o[1];o[1]=c}t.push(o)}}return t};function v(e,t){var r=e.length;if(r===0){throw new Error("Must have at least d+1 points")}var i=e[0].length;if(r<=i){throw new Error("Must input at least d+1 points")}var a=e.slice(0,i+1);var s=n.apply(void 0,a);if(s===0){throw new Error("Input not in general position")}var l=new Array(i+1);for(var u=0;u<=i;++u){l[u]=u}if(s<0){l[0]=1;l[1]=0}var f=new o(l,new Array(i+1),false);var h=f.adjacent;var v=new Array(i+2);for(var u=0;u<=i;++u){var d=l.slice();for(var p=0;p<=i;++p){if(p===u){d[p]=-1}}var g=d[0];d[0]=d[1];d[1]=g;var m=new o(d,new Array(i+1),true);h[u]=m;v[u]=m}v[i+1]=f;for(var u=0;u<=i;++u){var d=h[u].vertices;var y=h[u].adjacent;for(var p=0;p<=i;++p){var b=d[p];if(b<0){y[p]=f;continue}for(var x=0;x<=i;++x){if(h[x].vertices.indexOf(b)<0){y[p]=h[x]}}}}var _=new c(i,a,v);var w=!!t;for(var u=i+1;u<r;++u){_.insert(e[u],w)}return _.boundary()}},{"robust-orientation":306,"simplicial-complex":316}],240:[function(e,t,r){"use strict";var n=e("binary-search-bounds");var i=0;var a=1;var o=2;t.exports=w;function s(e,t,r,n,i){this.mid=e;this.left=t;this.right=r;this.leftPoints=n;this.rightPoints=i;this.count=(t?t.count:0)+(r?r.count:0)+n.length}var l=s.prototype;function u(e,t){e.mid=t.mid;e.left=t.left;e.right=t.right;e.leftPoints=t.leftPoints;e.rightPoints=t.rightPoints;e.count=t.count}function f(e,t){var r=b(t);e.mid=r.mid;e.left=r.left;e.right=r.right;e.leftPoints=r.leftPoints;e.rightPoints=r.rightPoints;e.count=r.count}function c(e,t){var r=e.intervals([]);r.push(t);f(e,r)}function h(e,t){var r=e.intervals([]);var n=r.indexOf(t);if(n<0){return i}r.splice(n,1);f(e,r);return a}l.intervals=function(e){e.push.apply(e,this.leftPoints);if(this.left){this.left.intervals(e)}if(this.right){this.right.intervals(e)}return e};l.insert=function(e){var t=this.count-this.leftPoints.length;this.count+=1;if(e[1]<this.mid){if(this.left){if(4*(this.left.count+1)>3*(t+1)){c(this,e)}else{this.left.insert(e)}}else{this.left=b([e])}}else if(e[0]>this.mid){if(this.right){if(4*(this.right.count+1)>3*(t+1)){c(this,e)}else{this.right.insert(e)}}else{this.right=b([e])}}else{var r=n.ge(this.leftPoints,e,m);var i=n.ge(this.rightPoints,e,y);this.leftPoints.splice(r,0,e);this.rightPoints.splice(i,0,e)}};l.remove=function(e){var t=this.count-this.leftPoints;if(e[1]<this.mid){if(!this.left){return i}var r=this.right?this.right.count:0;if(4*r>3*(t-1)){return h(this,e)}var s=this.left.remove(e);if(s===o){this.left=null;this.count-=1;return a}else if(s===a){this.count-=1}return s}else if(e[0]>this.mid){if(!this.right){return i}var l=this.left?this.left.count:0;if(4*l>3*(t-1)){return h(this,e)}var s=this.right.remove(e);if(s===o){this.right=null;this.count-=1;return a}else if(s===a){this.count-=1}return s}else{if(this.count===1){if(this.leftPoints[0]===e){return o}else{return i}}if(this.leftPoints.length===1&&this.leftPoints[0]===e){if(this.left&&this.right){var f=this;var c=this.left;while(c.right){f=c;c=c.right}if(f===this){c.right=this.right}else{var v=this.left;var s=this.right;f.count-=c.count;f.right=c.left;c.left=v;c.right=s}u(this,c);this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else if(this.left){u(this,this.left)}else{u(this,this.right)}return a}for(var v=n.ge(this.leftPoints,e,m);v<this.leftPoints.length;++v){if(this.leftPoints[v][0]!==e[0]){break}if(this.leftPoints[v]===e){this.count-=1;this.leftPoints.splice(v,1);for(var s=n.ge(this.rightPoints,e,y);s<this.rightPoints.length;++s){if(this.rightPoints[s][1]!==e[1]){break}else if(this.rightPoints[s]===e){this.rightPoints.splice(s,1);return a}}}}return i}};function v(e,t,r){for(var n=0;n<e.length&&e[n][0]<=t;++n){var i=r(e[n]);if(i){return i}}}function d(e,t,r){for(var n=e.length-1;n>=0&&e[n][1]>=t;--n){var i=r(e[n]);if(i){return i}}}function p(e,t){for(var r=0;r<e.length;++r){var n=t(e[r]);if(n){return n}}}l.queryPoint=function(e,t){if(e<this.mid){if(this.left){var r=this.left.queryPoint(e,t);if(r){return r}}return v(this.leftPoints,e,t)}else if(e>this.mid){if(this.right){var r=this.right.queryPoint(e,t);if(r){return r}}return d(this.rightPoints,e,t)}else{return p(this.leftPoints,t)}};l.queryInterval=function(e,t,r){if(e<this.mid&&this.left){var n=this.left.queryInterval(e,t,r);if(n){return n}}if(t>this.mid&&this.right){var n=this.right.queryInterval(e,t,r);if(n){return n}}if(t<this.mid){return v(this.leftPoints,t,r)}else if(e>this.mid){return d(this.rightPoints,e,r)}else{return p(this.leftPoints,r)}};function g(e,t){return e-t}function m(e,t){var r=e[0]-t[0];if(r){return r}return e[1]-t[1]}function y(e,t){var r=e[1]-t[1];if(r){return r}return e[0]-t[0]}function b(e){if(e.length===0){return null}var t=[];for(var r=0;r<e.length;++r){t.push(e[r][0],e[r][1])}t.sort(g);var n=t[t.length>>1];var i=[];var a=[];var o=[];for(var r=0;r<e.length;++r){var l=e[r];if(l[1]<n){i.push(l)}else if(n<l[0]){a.push(l)}else{o.push(l)}}var u=o;var f=o.slice();u.sort(m);f.sort(y);return new s(n,b(i),b(a),u,f)}function x(e){this.root=e}var _=x.prototype;_.insert=function(e){if(this.root){this.root.insert(e)}else{this.root=new s(e[0],null,null,[e],[e])}};_.remove=function(e){if(this.root){var t=this.root.remove(e);if(t===o){this.root=null}return t!==i}return false};_.queryPoint=function(e,t){if(this.root){return this.root.queryPoint(e,t)}};_.queryInterval=function(e,t,r){if(e<=t&&this.root){return this.root.queryInterval(e,t,r)}};Object.defineProperty(_,"count",{get:function(){if(this.root){return this.root.count}return 0}});Object.defineProperty(_,"intervals",{get:function(){if(this.root){return this.root.intervals([])}return[]}});function w(e){if(!e||e.length===0){return new x(null)}return new x(b(e))}},{"binary-search-bounds":36}],241:[function(e,t,r){"use strict";function n(e,t){t=t||new Array(e.length);for(var r=0;r<e.length;++r){t[e[r]]=r}return t}t.exports=n},{}],242:[function(e,t,r){"use strict";function n(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=r}return t}t.exports=n},{}],243:[function(e,t,r){t.exports=true},{}],244:[function(e,t,r){t.exports=function(e){return e!=null&&(n(e)||i(e)||!!e._isBuffer)};function n(e){return!!e.constructor&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)}function i(e){return typeof e.readFloatLE==="function"&&typeof e.slice==="function"&&n(e.slice(0,0))}},{}],245:[function(e,t,r){t.exports=n;function n(e){if(!e&&typeof navigator!="undefined")e=navigator.userAgent;if(e&&e.headers&&typeof e.headers["user-agent"]=="string"){e=e.headers["user-agent"]}if(typeof e!="string")return false;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}},{}],246:[function(e,t,r){"use strict";var n=Object.prototype.toString;t.exports=function(e){var t;return n.call(e)==="[object Object]"&&(t=Object.getPrototypeOf(e),t===null||t===Object.getPrototypeOf({}))}},{}],247:[function(e,t,r){function n(e,t,r){return e*(1-r)+t*r}t.exports=n},{}],248:[function(e,t,r){"use strict";t.exports=o;var n=e("convex-hull");function i(e,t,r){var n=new Array(e);for(var i=0;i<e;++i){n[i]=0;if(i===t){n[i]+=.5}if(i===r){n[i]+=.5}}return n}function a(e,t){if(t===0||t===(1<<e+1)-1){return[]}var r=[];var a=[];for(var o=0;o<=e;++o){if(t&1<<o){r.push(i(e,o-1,o-1));a.push(null);for(var s=0;s<=e;++s){if(~t&1<<s){r.push(i(e,o-1,s-1));a.push([o,s])}}}}var l=n(r);var u=[];e:for(var o=0;o<l.length;++o){var f=l[o];var c=[];for(var s=0;s<f.length;++s){if(!a[f[s]]){continue e}c.push(a[f[s]].slice())}u.push(c)}return u}function o(e){var t=1<<e+1;var r=new Array(t);for(var n=0;n<t;++n){r[n]=a(e,n)}return r}},{"convex-hull":72}],249:[function(e,t,r){var n=e("./normalize");var i=e("gl-mat4/create");var a=e("gl-mat4/clone");var o=e("gl-mat4/determinant");var s=e("gl-mat4/invert");var l=e("gl-mat4/transpose");var u={length:e("gl-vec3/length"),normalize:e("gl-vec3/normalize"),dot:e("gl-vec3/dot"),cross:e("gl-vec3/cross")};var f=i();var c=i();var h=[0,0,0,0];var v=[[0,0,0],[0,0,0],[0,0,0]];var d=[0,0,0];t.exports=function e(t,r,i,y,b,x){if(!r)r=[0,0,0];if(!i)i=[0,0,0];if(!y)y=[0,0,0];if(!b)b=[0,0,0,1];if(!x)x=[0,0,0,1];if(!n(f,t))return false;a(c,f);c[3]=0;c[7]=0;c[11]=0;c[15]=1;if(Math.abs(o(c)<1e-8))return false;var _=f[3],w=f[7],M=f[11],A=f[12],T=f[13],k=f[14],E=f[15];if(_!==0||w!==0||M!==0){h[0]=_;h[1]=w;h[2]=M;h[3]=E;var S=s(c,c);if(!S)return false;l(c,c);p(b,h,c)}else{b[0]=b[1]=b[2]=0;b[3]=1}r[0]=A;r[1]=T;r[2]=k;g(v,f);i[0]=u.length(v[0]);u.normalize(v[0],v[0]);y[0]=u.dot(v[0],v[1]);m(v[1],v[1],v[0],1,-y[0]);i[1]=u.length(v[1]);u.normalize(v[1],v[1]);y[0]/=i[1];y[1]=u.dot(v[0],v[2]);m(v[2],v[2],v[0],1,-y[1]);y[2]=u.dot(v[1],v[2]);m(v[2],v[2],v[1],1,-y[2]);i[2]=u.length(v[2]);u.normalize(v[2],v[2]);y[1]/=i[2];y[2]/=i[2];u.cross(d,v[1],v[2]);if(u.dot(v[0],d)<0){for(var L=0;L<3;L++){i[L]*=-1;v[L][0]*=-1;v[L][1]*=-1;v[L][2]*=-1}}x[0]=.5*Math.sqrt(Math.max(1+v[0][0]-v[1][1]-v[2][2],0));x[1]=.5*Math.sqrt(Math.max(1-v[0][0]+v[1][1]-v[2][2],0));x[2]=.5*Math.sqrt(Math.max(1-v[0][0]-v[1][1]+v[2][2],0));x[3]=.5*Math.sqrt(Math.max(1+v[0][0]+v[1][1]+v[2][2],0));if(v[2][1]>v[1][2])x[0]=-x[0];if(v[0][2]>v[2][0])x[1]=-x[1];if(v[1][0]>v[0][1])x[2]=-x[2];return true};function p(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o;e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o;e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o;e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o;return e}function g(e,t){e[0][0]=t[0];e[0][1]=t[1];e[0][2]=t[2];e[1][0]=t[4];e[1][1]=t[5];e[1][2]=t[6];e[2][0]=t[8];e[2][1]=t[9];e[2][2]=t[10]}function m(e,t,r,n,i){e[0]=t[0]*n+r[0]*i;e[1]=t[1]*n+r[1]*i;e[2]=t[2]*n+r[2]*i}},{"./normalize":250,"gl-mat4/clone":119,"gl-mat4/create":120,"gl-mat4/determinant":121,"gl-mat4/invert":125,"gl-mat4/transpose":135,"gl-vec3/cross":172,"gl-vec3/dot":175,"gl-vec3/length":180,"gl-vec3/normalize":186}],250:[function(e,t,r){t.exports=function e(t,r){var n=r[15];if(n===0)return false;var i=1/n;for(var a=0;a<16;a++)t[a]=r[a]*i;return true}},{}],251:[function(e,t,r){var n=e("gl-vec3/lerp");var i=e("mat4-recompose");var a=e("mat4-decompose");var o=e("gl-mat4/determinant");var s=e("quat-slerp");var l=h();var u=h();var f=h();t.exports=c;function c(e,t,r,c){if(o(t)===0||o(r)===0)return false;var h=a(t,l.translate,l.scale,l.skew,l.perspective,l.quaternion);var v=a(r,u.translate,u.scale,u.skew,u.perspective,u.quaternion);if(!h||!v)return false;n(f.translate,l.translate,u.translate,c);n(f.skew,l.skew,u.skew,c);n(f.scale,l.scale,u.scale,c);n(f.perspective,l.perspective,u.perspective,c);s(f.quaternion,l.quaternion,u.quaternion,c);i(e,f.translate,f.scale,f.skew,f.perspective,f.quaternion);return true}function h(){return{translate:v(),scale:v(1),skew:v(),perspective:d(),quaternion:d()}}function v(e){return[e||0,e||0,e||0]}function d(){return[0,0,0,1]}},{"gl-mat4/determinant":121,"gl-vec3/lerp":181,"mat4-decompose":249,"mat4-recompose":252,"quat-slerp":293}],252:[function(e,t,r){var n={identity:e("gl-mat4/identity"),translate:e("gl-mat4/translate"),multiply:e("gl-mat4/multiply"),create:e("gl-mat4/create"),scale:e("gl-mat4/scale"),fromRotationTranslation:e("gl-mat4/fromRotationTranslation")};var i=n.create();var a=n.create();t.exports=function e(t,r,i,o,s,l){n.identity(t);n.fromRotationTranslation(t,l,r);t[3]=s[0];t[7]=s[1];t[11]=s[2];t[15]=s[3];n.identity(a);if(o[2]!==0){a[9]=o[2];n.multiply(t,t,a)}if(o[1]!==0){a[9]=0;a[8]=o[1];n.multiply(t,t,a)}if(o[0]!==0){a[8]=0;a[4]=o[0];n.multiply(t,t,a)}n.scale(t,t,i);return t}},{"gl-mat4/create":120,"gl-mat4/fromRotationTranslation":123,"gl-mat4/identity":124,"gl-mat4/multiply":127,"gl-mat4/scale":133,"gl-mat4/translate":134}],253:[function(e,t,r){"use strict";var n=e("binary-search-bounds");var i=e("mat4-interpolate");var a=e("gl-mat4/invert");var o=e("gl-mat4/rotateX");var s=e("gl-mat4/rotateY");var l=e("gl-mat4/rotateZ");var u=e("gl-mat4/lookAt");var f=e("gl-mat4/translate");var c=e("gl-mat4/scale");var h=e("gl-vec3/normalize");var v=[0,0,0];t.exports=m;function d(e){this._components=e.slice();this._time=[0];this.prevMatrix=e.slice();this.nextMatrix=e.slice();this.computedMatrix=e.slice();this.computedInverse=e.slice();this.computedEye=[0,0,0];this.computedUp=[0,0,0];this.computedCenter=[0,0,0];this.computedRadius=[0];this._limits=[-Infinity,Infinity]}var p=d.prototype;p.recalcMatrix=function(e){var t=this._time;var r=n.le(t,e);var o=this.computedMatrix;if(r<0){return}var s=this._components;if(r===t.length-1){var l=16*r;for(var u=0;u<16;++u){o[u]=s[l++]}}else{var f=t[r+1]-t[r];var l=16*r;var c=this.prevMatrix;var v=true;for(var u=0;u<16;++u){c[u]=s[l++]}var d=this.nextMatrix;for(var u=0;u<16;++u){d[u]=s[l++];v=v&&c[u]===d[u]}if(f<1e-6||v){for(var u=0;u<16;++u){o[u]=c[u]}}else{i(o,c,d,(e-t[r])/f)}}var p=this.computedUp;p[0]=o[1];p[1]=o[5];p[2]=o[9];h(p,p);var g=this.computedInverse;a(g,o);var m=this.computedEye;var y=g[15];m[0]=g[12]/y;m[1]=g[13]/y;m[2]=g[14]/y;var b=this.computedCenter;var x=Math.exp(this.computedRadius[0]);for(var u=0;u<3;++u){b[u]=m[u]-o[2+4*u]*x}};p.idle=function(e){if(e<this.lastT()){return}var t=this._components;var r=t.length-16;for(var n=0;n<16;++n){t.push(t[r++])}this._time.push(e)};p.flush=function(e){var t=n.gt(this._time,e)-2;if(t<0){return}this._time.splice(0,t);this._components.splice(0,16*t)};p.lastT=function(){return this._time[this._time.length-1]};p.lookAt=function(e,t,r,n){this.recalcMatrix(e);t=t||this.computedEye;r=r||v;n=n||this.computedUp;this.setMatrix(e,u(this.computedMatrix,t,r,n));var i=0;for(var a=0;a<3;++a){i+=Math.pow(r[a]-t[a],2)}i=Math.log(Math.sqrt(i));this.computedRadius[0]=i};p.rotate=function(e,t,r,n){this.recalcMatrix(e);var i=this.computedInverse;if(t)s(i,i,t);if(r)o(i,i,r);if(n)l(i,i,n);this.setMatrix(e,a(this.computedMatrix,i))};var g=[0,0,0];p.pan=function(e,t,r,n){g[0]=-(t||0);g[1]=-(r||0);g[2]=-(n||0);this.recalcMatrix(e);var i=this.computedInverse;f(i,i,g);this.setMatrix(e,a(i,i))};p.translate=function(e,t,r,n){g[0]=t||0;g[1]=r||0;g[2]=n||0;this.recalcMatrix(e);var i=this.computedMatrix;f(i,i,g);this.setMatrix(e,i)};p.setMatrix=function(e,t){if(e<this.lastT()){return}this._time.push(e);for(var r=0;r<16;++r){this._components.push(t[r])}};p.setDistance=function(e,t){this.computedRadius[0]=t};p.setDistanceLimits=function(e,t){var r=this._limits;r[0]=e;r[1]=t};p.getDistanceLimits=function(e){var t=this._limits;if(e){e[0]=t[0];e[1]=t[1];return e}return t};function m(e){e=e||{};var t=e.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new d(t)}},{"binary-search-bounds":36,"gl-mat4/invert":125,"gl-mat4/lookAt":126,"gl-mat4/rotateX":130,"gl-mat4/rotateY":131,"gl-mat4/rotateZ":132,"gl-mat4/scale":133,"gl-mat4/translate":134,"gl-vec3/normalize":186,"mat4-interpolate":251}],254:[function(e,t,r){"use strict";t.exports=i;var n=e("robust-orientation")[3];function i(e){var t=e.length;if(t<3){var r=new Array(t);for(var i=0;i<t;++i){r[i]=i}if(t===2&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]){return[0]}return r}var a=new Array(t);for(var i=0;i<t;++i){a[i]=i}a.sort(function(t,r){var n=e[t][0]-e[r][0];if(n){return n}return e[t][1]-e[r][1]});var o=[a[0],a[1]];var s=[a[0],a[1]];for(var i=2;i<t;++i){var l=a[i];var u=e[l];var f=o.length;while(f>1&&n(e[o[f-2]],e[o[f-1]],u)<=0){f-=1;o.pop()}o.push(l);f=s.length;while(f>1&&n(e[s[f-2]],e[s[f-1]],u)>=0){f-=1;s.pop()}s.push(l)}var r=new Array(s.length+o.length-2);var c=0;for(var i=0,h=o.length;i<h;++i){r[c++]=o[i]}for(var v=s.length-2;v>0;--v){r[c++]=s[v]}return r}},{"robust-orientation":306}],255:[function(e,t,r){"use strict";t.exports=i;var n=e("mouse-event");function i(e,t){if(!t){t=e;e=window}var r=0;var i=0;var a=0;var o={shift:false,alt:false,control:false,meta:false};var s=false;function l(e){var t=false;if("altKey"in e){t=t||e.altKey!==o.alt;o.alt=!!e.altKey}if("shiftKey"in e){t=t||e.shiftKey!==o.shift;o.shift=!!e.shiftKey}if("ctrlKey"in e){t=t||e.ctrlKey!==o.control;o.control=!!e.ctrlKey}if("metaKey"in e){t=t||e.metaKey!==o.meta;o.meta=!!e.metaKey}return t}function u(e,s){var u=n.x(s);var f=n.y(s);if("buttons"in s){e=s.buttons|0}if(e!==r||u!==i||f!==a||l(s)){r=e|0;i=u||0;a=f||0;t&&t(r,i,a,o)}}function f(e){u(0,e)}function c(){if(r||i||a||o.shift||o.alt||o.meta||o.control){i=a=0;r=0;o.shift=o.alt=o.control=o.meta=false;t&&t(0,0,0,o)}}function h(e){if(l(e)){t&&t(r,i,a,o)}}function v(e){if(n.buttons(e)===0){u(0,e)}else{u(r,e)}}function d(e){u(r|n.buttons(e),e)}function p(e){u(r&~n.buttons(e),e)}function g(){if(s){return}s=true;e.addEventListener("mousemove",v);e.addEventListener("mousedown",d);e.addEventListener("mouseup",p);e.addEventListener("mouseleave",f);e.addEventListener("mouseenter",f);e.addEventListener("mouseout",f);e.addEventListener("mouseover",f);e.addEventListener("blur",c);e.addEventListener("keyup",h);e.addEventListener("keydown",h);e.addEventListener("keypress",h);if(e!==window){window.addEventListener("blur",c);window.addEventListener("keyup",h);window.addEventListener("keydown",h);window.addEventListener("keypress",h)}}function m(){if(!s){return}s=false;e.removeEventListener("mousemove",v);e.removeEventListener("mousedown",d);e.removeEventListener("mouseup",p);e.removeEventListener("mouseleave",f);e.removeEventListener("mouseenter",f);e.removeEventListener("mouseout",f);e.removeEventListener("mouseover",f);e.removeEventListener("blur",c);e.removeEventListener("keyup",h);e.removeEventListener("keydown",h);e.removeEventListener("keypress",h);if(e!==window){window.removeEventListener("blur",c);window.removeEventListener("keyup",h);window.removeEventListener("keydown",h);window.removeEventListener("keypress",h)}}g();var y={element:e};Object.defineProperties(y,{enabled:{get:function(){return s},set:function(e){if(e){g()}else{m()}},enumerable:true},buttons:{get:function(){return r},enumerable:true},x:{get:function(){return i},enumerable:true},y:{get:function(){return a},enumerable:true},mods:{get:function(){return o},enumerable:true}});return y}},{"mouse-event":257}],256:[function(e,t,r){var n={left:0,top:0};t.exports=i;function i(e,t,r){t=t||e.currentTarget||e.srcElement;if(!Array.isArray(r)){r=[0,0]}var n=e.clientX||0;var i=e.clientY||0;var o=a(t);r[0]=n-o.left;r[1]=i-o.top;return r}function a(e){if(e===window||e===document||e===document.body){return n}else{return e.getBoundingClientRect()}}},{}],257:[function(e,t,r){"use strict";function n(e){if(typeof e==="object"){if("buttons"in e){return e.buttons}else if("which"in e){var t=e.which;if(t===2){return 4}else if(t===3){return 2}else if(t>0){return 1<<t-1}}else if("button"in e){var t=e.button;if(t===1){return 4}else if(t===2){return 2}else if(t>=0){return 1<<t}}}return 0}r.buttons=n;function i(e){return e.target||e.srcElement||window}r.element=i;function a(e){if(typeof e==="object"){if("offsetX"in e){return e.offsetX}var t=i(e);var r=t.getBoundingClientRect();return e.clientX-r.left}return 0}r.x=a;function o(e){if(typeof e==="object"){if("offsetY"in e){return e.offsetY}var t=i(e);var r=t.getBoundingClientRect();return e.clientY-r.top}return 0}r.y=o},{}],258:[function(e,t,r){"use strict";var n=e("to-px");t.exports=i;function i(e,t,r){if(typeof e==="function"){r=!!t;t=e;e=window}var i=n("ex",e);var a=function(e){if(r){e.preventDefault()}var n=e.deltaX||0;var a=e.deltaY||0;var o=e.deltaZ||0;var s=e.deltaMode;var l=1;switch(s){case 1:l=i;break;case 2:l=window.innerHeight;break}n*=l;a*=l;o*=l;if(n||a||o){return t(n,a,o,e)}};e.addEventListener("wheel",a);return a}},{"to-px":328}],259:[function(e,t,r){"use strict";var n=e("typedarray-pool");t.exports=E;function i(e){return"a"+e}function a(e){return"d"+e}function o(e,t){return"c"+e+"_"+t}function s(e){return"s"+e}function l(e,t){return"t"+e+"_"+t}function u(e){return"o"+e}function f(e){return"x"+e}function c(e){return"p"+e}function h(e,t){return"d"+e+"_"+t}function v(e){return"i"+e}function d(e,t){return"u"+e+"_"+t}function p(e){return"b"+e}function g(e){return"y"+e}function m(e){return"e"+e}function y(e){return"v"+e}var b="V";var x="P";var _="N";var w="Q";var M="X";var A="T";function T(e,t,r){var n=0;for(var i=0;i<e;++i){if(t&1<<i){n|=1<<r[i]}}return n}function k(e,t,r,k,E,S){var L=S.length;var C=E.length;if(C<2){throw new Error("ndarray-extract-contour: Dimension must be at least 2")}var I="extractContour"+E.join("_");var P=[];var O=[];var R=[];for(var N=0;N<L;++N){R.push(i(N))}for(var N=0;N<k;++N){R.push(f(N))}for(var N=0;N<C;++N){O.push(s(N)+"="+i(0)+".shape["+N+"]|0")}for(var N=0;N<L;++N){O.push(a(N)+"="+i(N)+".data",u(N)+"="+i(N)+".offset|0");for(var z=0;z<C;++z){O.push(l(N,z)+"="+i(N)+".stride["+z+"]|0")}}for(var N=0;N<L;++N){O.push(c(N)+"="+u(N));O.push(o(N,0));for(var z=1;z<1<<C;++z){var D=[];for(var F=0;F<C;++F){if(z&1<<F){D.push("-"+l(N,F))}}O.push(h(N,z)+"=("+D.join("")+")|0");O.push(o(N,z)+"=0")}}for(var N=0;N<L;++N){for(var z=0;z<C;++z){var j=[l(N,E[z])];if(z>0){j.push(l(N,E[z-1])+"*"+s(E[z-1]))}O.push(d(N,E[z])+"=("+j.join("-")+")|0")}}for(var N=0;N<C;++N){O.push(v(N)+"=0")}O.push(_+"=0");var B=["2"];for(var N=C-2;N>=0;--N){B.push(s(E[N]))}O.push(w+"=("+B.join("*")+")|0",x+"=mallocUint32("+w+")",b+"=mallocUint32("+w+")",M+"=0");O.push(p(0)+"=0");for(var z=1;z<1<<C;++z){var U=[];var V=[];for(var F=0;F<C;++F){if(z&1<<F){if(V.length===0){U.push("1")}else{U.unshift(V.join("*"))}}V.push(s(E[F]))}var H="";if(U[0].indexOf(s(E[C-2]))<0){H="-"}var q=T(C,z,E);O.push(m(q)+"=(-"+U.join("-")+")|0",g(q)+"=("+H+U.join("-")+")|0",p(q)+"=0")}O.push(y(0)+"=0",A+"=0");function G(e,t){P.push("for(",v(E[e]),"=",t,";",v(E[e]),"<",s(E[e]),";","++",v(E[e]),"){")}function W(e){for(var t=0;t<L;++t){P.push(c(t),"+=",d(t,E[e]),";")}P.push("}")}function X(e){for(var t=e-1;t>=0;--t){G(t,0)}var r=[];for(var t=0;t<L;++t){if(S[t]){r.push(a(t)+".get("+c(t)+")")}else{r.push(a(t)+"["+c(t)+"]")}}for(var t=0;t<k;++t){r.push(f(t))}P.push(x,"[",M,"++]=phase(",r.join(),");");for(var t=0;t<e;++t){W(t)}for(var n=0;n<L;++n){P.push(c(n),"+=",d(n,E[e]),";")}}function Y(e){for(var t=0;t<L;++t){if(S[t]){P.push(o(t,0),"=",a(t),".get(",c(t),");")}else{P.push(o(t,0),"=",a(t),"[",c(t),"];")}}var r=[];for(var t=0;t<L;++t){r.push(o(t,0))}for(var t=0;t<k;++t){r.push(f(t))}P.push(p(0),"=",x,"[",M,"]=phase(",r.join(),");");for(var n=1;n<1<<C;++n){P.push(p(n),"=",x,"[",M,"+",m(n),"];")}var i=[];for(var n=1;n<1<<C;++n){i.push("("+p(0)+"!=="+p(n)+")")}P.push("if(",i.join("||"),"){");var s=[];for(var t=0;t<C;++t){s.push(v(t))}for(var t=0;t<L;++t){s.push(o(t,0));for(var n=1;n<1<<C;++n){if(S[t]){P.push(o(t,n),"=",a(t),".get(",c(t),"+",h(t,n),");")}else{P.push(o(t,n),"=",a(t),"[",c(t),"+",h(t,n),"];")}s.push(o(t,n))}}for(var t=0;t<1<<C;++t){s.push(p(t))}for(var t=0;t<k;++t){s.push(f(t))}P.push("vertex(",s.join(),");",y(0),"=",b,"[",M,"]=",_,"++;");var l=(1<<C)-1;var u=p(l);for(var n=0;n<C;++n){if((e&~(1<<n))===0){var d=l^1<<n;var g=p(d);var w=[];for(var A=d;A>0;A=A-1&d){w.push(b+"["+M+"+"+m(A)+"]")}w.push(y(0));for(var A=0;A<L;++A){if(n&1){w.push(o(A,l),o(A,d))}else{w.push(o(A,d),o(A,l))}}if(n&1){w.push(u,g)}else{w.push(g,u)}for(var A=0;A<k;++A){w.push(f(A))}P.push("if(",u,"!==",g,"){","face(",w.join(),")}")}}P.push("}",M,"+=1;")}function Z(){for(var e=1;e<1<<C;++e){P.push(A,"=",m(e),";",m(e),"=",g(e),";",g(e),"=",A,";")}}function Q(e,t){if(e<0){Y(t);return}X(e);P.push("if(",s(E[e]),">0){",v(E[e]),"=1;");Q(e-1,t|1<<E[e]);for(var r=0;r<L;++r){P.push(c(r),"+=",d(r,E[e]),";")}if(e===C-1){P.push(M,"=0;");Z()}G(e,2);Q(e-1,t);if(e===C-1){P.push("if(",v(E[C-1]),"&1){",M,"=0;}");Z()}W(e);P.push("}")}Q(C-1,0);P.push("freeUint32(",b,");freeUint32(",x,");");var K=["'use strict';","function ",I,"(",R.join(),"){","var ",O.join(),";",P.join(""),"}","return ",I].join("");var J=new Function("vertex","face","phase","mallocUint32","freeUint32",K);return J(e,t,r,n.mallocUint32,n.freeUint32)}function E(e){function t(e){throw new Error("ndarray-extract-contour: "+e)}if(typeof e!=="object"){t("Must specify arguments")}var r=e.order;if(!Array.isArray(r)){t("Must specify order")}var n=e.arrayArguments||1;if(n<1){t("Must have at least one array argument")}var i=e.scalarArguments||0;if(i<0){t("Scalar arg count must be > 0")}if(typeof e.vertex!=="function"){t("Must specify vertex creation function")}if(typeof e.cell!=="function"){t("Must specify cell creation function")}if(typeof e.phase!=="function"){t("Must specify phase function")}var a=e.getters||[];var o=new Array(n);for(var s=0;s<n;++s){if(a.indexOf(s)>=0){o[s]=true}else{o[s]=false}}return k(e.vertex,e.cell,e.phase,i,r,o)}},{"typedarray-pool":333}],260:[function(e,t,r){"use strict";var n=e("cwise/lib/wrapper")({args:["index","array","scalar"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{_inline_37_arg1_=_inline_37_arg2_.apply(void 0,_inline_37_arg0_)}",args:[{name:"_inline_37_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_37_arg1_",lvalue:true,rvalue:false,count:1},{name:"_inline_37_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:false,funcName:"cwise",blockSize:64});t.exports=function(e,t){n(e,t);return e}},{"cwise/lib/wrapper":80}],261:[function(e,t,r){"use strict";t.exports=h;var n=e("dup");var i=e("cwise-compiler");var a={};var o={};var s={body:"",args:[],thisVars:[],localVars:[]};var l=i({args:["array","array","array"],pre:s,post:s,body:{args:[{name:"out",lvalue:true,rvalue:false,count:1},{name:"left",lvalue:false,rvalue:true,count:1},{name:"right",lvalue:false,rvalue:true,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"});var u=i({args:["array"],pre:s,post:s,body:{args:[{name:"out",lvalue:true,rvalue:false,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"});function f(e){if(e in a){return a[e]}var t=[];for(var r=0;r<e;++r){t.push("out",r,"s=0.5*(inp",r,"l-inp",r,"r);")}var o=["array"];var l=["junk"];for(var r=0;r<e;++r){o.push("array");l.push("out"+r+"s");var u=n(e);u[r]=-1;o.push({array:0,offset:u.slice()});u[r]=1;o.push({array:0,offset:u.slice()});l.push("inp"+r+"l","inp"+r+"r")}return a[e]=i({args:o,pre:s,post:s,body:{body:t.join(""),args:l.map(function(e){return{name:e,lvalue:e.indexOf("out")===0,rvalue:e.indexOf("inp")===0,count:e!=="junk"|0}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+e})}function c(e){var t=e.join();var r=o[t];if(r){return r}var n=e.length;var i=["function gradient(dst,src){var s=src.shape.slice();"];function s(t){var r=n-t.length;var a=[];var o=[];var s=[];for(var l=0;l<n;++l){if(t.indexOf(l+1)>=0){s.push("0")}else if(t.indexOf(-(l+1))>=0){s.push("s["+l+"]-1")}else{s.push("-1");a.push("1");o.push("s["+l+"]-2")}}var u=".lo("+a.join()+").hi("+o.join()+")";if(a.length===0){u=""}if(r>0){i.push("if(1");for(var l=0;l<n;++l){if(t.indexOf(l+1)>=0||t.indexOf(-(l+1))>=0){continue}i.push("&&s[",l,"]>2")}i.push("){grad",r,"(src.pick(",s.join(),")",u);for(var l=0;l<n;++l){if(t.indexOf(l+1)>=0||t.indexOf(-(l+1))>=0){continue}i.push(",dst.pick(",s.join(),",",l,")",u)}i.push(");")}for(var l=0;l<t.length;++l){var f=Math.abs(t[l])-1;var c="dst.pick("+s.join()+","+f+")"+u;switch(e[f]){case"clamp":var h=s.slice();var v=s.slice();if(t[l]<0){h[f]="s["+f+"]-2"}else{v[f]="1"}if(r===0){i.push("if(s[",f,"]>1){dst.set(",s.join(),",",f,",0.5*(src.get(",h.join(),")-src.get(",v.join(),")))}else{dst.set(",s.join(),",",f,",0)};")}else{i.push("if(s[",f,"]>1){diff(",c,",src.pick(",h.join(),")",u,",src.pick(",v.join(),")",u,");}else{zero(",c,");};")}break;case"mirror":if(r===0){i.push("dst.set(",s.join(),",",f,",0);")}else{i.push("zero(",c,");")}break;case"wrap":var d=s.slice();var p=s.slice();if(t[l]<0){d[f]="s["+f+"]-2";p[f]="0"}else{d[f]="s["+f+"]-1";p[f]="1"}if(r===0){i.push("if(s[",f,"]>2){dst.set(",s.join(),",",f,",0.5*(src.get(",d.join(),")-src.get(",p.join(),")))}else{dst.set(",s.join(),",",f,",0)};")}else{i.push("if(s[",f,"]>2){diff(",c,",src.pick(",d.join(),")",u,",src.pick(",p.join(),")",u,");}else{zero(",c,");};")}break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}if(r>0){i.push("};")}}for(var c=0;c<1<<n;++c){var h=[];for(var v=0;v<n;++v){if(c&1<<v){h.push(v+1)}}for(var d=0;d<1<<h.length;++d){var p=h.slice();for(var v=0;v<h.length;++v){if(d&1<<v){p[v]=-p[v]}}s(p)}}i.push("return dst;};return gradient");var g=["diff","zero"];var m=[l,u];for(var c=1;c<=n;++c){g.push("grad"+c);m.push(f(c))}g.push(i.join(""));var y=Function.apply(void 0,g);var r=y.apply(void 0,m);a[t]=r;return r}function h(e,t,r){if(Array.isArray(r)){if(r.length!==t.dimension){throw new Error("ndarray-gradient: invalid boundary conditions")}}else if(typeof r==="string"){r=n(t.dimension,r)}else{r=n(t.dimension,"clamp")}if(e.dimension!==t.dimension+1){throw new Error("ndarray-gradient: output dimension must be +1 input dimension")}if(e.shape[t.dimension]!==t.dimension){throw new Error("ndarray-gradient: output shape must match input shape")}for(var i=0;i<t.dimension;++i){if(e.shape[i]!==t.shape[i]){throw new Error("ndarray-gradient: shape mismatch")}}if(t.size===0){return e}if(t.dimension<=0){e.set(0);return e}var a=c(r);return a(e,t)}},{"cwise-compiler":77,dup:86}],262:[function(e,t,r){"use strict";var n=e("ndarray-warp");var i=e("gl-matrix-invert");t.exports=a;function a(e,t,r){var a=t.dimension;var o=i([],r);n(e,t,function(e,t){for(var r=0;r<a;++r){e[r]=o[(a+1)*a+r];for(var n=0;n<a;++n){e[r]+=o[(a+1)*n+r]*t[n]}}var i=o[(a+1)*(a+1)-1];for(var n=0;n<a;++n){i+=o[(a+1)*n+a]*t[n]}var s=1/i;for(var r=0;r<a;++r){e[r]*=s}return e});return e}},{"gl-matrix-invert":136,"ndarray-warp":269}],263:[function(e,t,r){"use strict";function n(e,t){var r=Math.floor(t),n=t-r,i=0<=r&&r<e.shape[0],a=0<=r+1&&r+1<e.shape[0],o=i?+e.get(r):0,s=a?+e.get(r+1):0;return(1-n)*o+n*s}function i(e,t,r){var n=Math.floor(t),i=t-n,a=0<=n&&n<e.shape[0],o=0<=n+1&&n+1<e.shape[0],s=Math.floor(r),l=r-s,u=0<=s&&s<e.shape[1],f=0<=s+1&&s+1<e.shape[1],c=a&&u?e.get(n,s):0,h=a&&f?e.get(n,s+1):0,v=o&&u?e.get(n+1,s):0,d=o&&f?e.get(n+1,s+1):0;return(1-l)*((1-i)*c+i*v)+l*((1-i)*h+i*d)}function a(e,t,r,n){var i=Math.floor(t),a=t-i,o=0<=i&&i<e.shape[0],s=0<=i+1&&i+1<e.shape[0],l=Math.floor(r),u=r-l,f=0<=l&&l<e.shape[1],c=0<=l+1&&l+1<e.shape[1],h=Math.floor(n),v=n-h,d=0<=h&&h<e.shape[2],p=0<=h+1&&h+1<e.shape[2],g=o&&f&&d?e.get(i,l,h):0,m=o&&c&&d?e.get(i,l+1,h):0,y=s&&f&&d?e.get(i+1,l,h):0,b=s&&c&&d?e.get(i+1,l+1,h):0,x=o&&f&&p?e.get(i,l,h+1):0,_=o&&c&&p?e.get(i,l+1,h+1):0,w=s&&f&&p?e.get(i+1,l,h+1):0,M=s&&c&&p?e.get(i+1,l+1,h+1):0;return(1-v)*((1-u)*((1-a)*g+a*y)+u*((1-a)*m+a*b))+v*((1-u)*((1-a)*x+a*w)+u*((1-a)*_+a*M))}function o(e){var t=e.shape.length|0,r=new Array(t),n=new Array(t),i=new Array(t),a=new Array(t),o,s;for(o=0;o<t;++o){s=+arguments[o+1];r[o]=Math.floor(s);n[o]=s-r[o];i[o]=0<=r[o]&&r[o]<e.shape[o];a[o]=0<=r[o]+1&&r[o]+1<e.shape[o]}var l=0,u,f,c;e:for(o=0;o<1<<t;++o){f=1;c=e.offset;for(u=0;u<t;++u){if(o&1<<u){if(!a[u]){continue e}f*=n[u];c+=e.stride[u]*(r[u]+1)}else{if(!i[u]){continue e}f*=1-n[u];c+=e.stride[u]*r[u]}}l+=f*e.data[c]}return l}function s(e,t,r,s){switch(e.shape.length){case 0:return 0;case 1:return n(e,t);case 2:return i(e,t,r);case 3:return a(e,t,r,s);default:return o.apply(undefined,arguments)}}t.exports=s;t.exports.d1=n;t.exports.d2=i;t.exports.d3=a},{}],264:[function(e,t,r){"use strict";var n=e("cwise-compiler");var i={body:"",args:[],thisVars:[],localVars:[]};function a(e){if(!e){return i}for(var t=0;t<e.args.length;++t){var r=e.args[t];if(t===0){e.args[t]={name:r,lvalue:true,rvalue:!!e.rvalue,count:e.count||1}}else{e.args[t]={name:r,lvalue:false,rvalue:true,count:1}}}if(!e.thisVars){e.thisVars=[]}if(!e.localVars){e.localVars=[]}return e}function o(e){return n({args:e.args,pre:a(e.pre),body:a(e.body),post:a(e.proc),funcName:e.funcName})}function s(e){var t=[];for(var r=0;r<e.args.length;++r){t.push("a"+r)}var n=new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""));return n(o(e))}var l={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var e in l){var t=l[e];r[e]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e});r[e+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a"+t+"=b"},rvalue:true,funcName:e+"eq"});r[e+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"});r[e+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a"+t+"=s"},rvalue:true,funcName:e+"seq"})}})();var u={not:"!",bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var e in u){var t=u[e];r[e]=s({args:["array","array"],body:{args:["a","b"],body:"a="+t+"b"},funcName:e});r[e+"eq"]=s({args:["array"],body:{args:["a"],body:"a="+t+"a"},rvalue:true,count:2,funcName:e+"eq"})}})();var f={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var e in f){var t=f[e];r[e]=s({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+t+"c"},funcName:e});r[e+"s"]=s({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+t+"s"},funcName:e+"s"});r[e+"eq"]=s({args:["array","array"],body:{args:["a","b"],body:"a=a"+t+"b"},rvalue:true,count:2,funcName:e+"eq"});r[e+"seq"]=s({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+t+"s"},rvalue:true,count:2,funcName:e+"seq"})}})();var c=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];(function(){for(var e=0;e<c.length;++e){var t=c[e];r[t]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:t});r[t+"eq"]=s({args:["array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"eq"})}})();var h=["max","min","atan2","pow"];(function(){for(var e=0;e<h.length;++e){var t=h[e];r[t]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t});r[t+"s"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:t+"s"});r[t+"eq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"eq"});r[t+"seq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"seq"})}})();var v=["atan2","pow"];(function(){for(var e=0;e<v.length;++e){var t=v[e];r[t+"op"]=s({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"op"});r[t+"ops"]=s({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:t+"ops"});r[t+"opeq"]=s({args:["array","array"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"opeq"});r[t+"opseq"]=s({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+t,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:t+"opseq"})}})();r.any=n({args:["array"],pre:i,body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"});r.all=n({args:["array"],pre:i,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"});r.sum=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"});r.prod=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"});r.norm2squared=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"});r.norm2=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"});r.norminf=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"});r.norm1=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"});r.sup=n({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});r.inf=n({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});r.argmin=n({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});r.argmax=n({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});r.random=s({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"});r.assign=s({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"});r.assigns=s({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"});r.equals=n({args:["array","array"],pre:i,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1},{name:"y",lvalue:false,rvalue:true,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":77}],265:[function(e,t,r){"use strict";var n=e("ndarray");var i=e("./doConvert.js");t.exports=function e(t,r){var a=[],o=t,s=1;while(Array.isArray(o)){a.push(o.length);s*=o.length;o=o[0]}if(a.length===0){return n()}if(!r){r=n(new Float64Array(s),a)}i(r,t);return r}},{"./doConvert.js":266,ndarray:270}],266:[function(e,t,r){t.exports=e("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:true,rvalue:false,count:1},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg2_",lvalue:false,rvalue:true,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":77}],267:[function(e,t,r){"use strict";var n=e("typedarray-pool");var i=32;function a(e){switch(e){case"uint8":return[n.mallocUint8,n.freeUint8];case"uint16":return[n.mallocUint16,n.freeUint16];case"uint32":return[n.mallocUint32,n.freeUint32];case"int8":return[n.mallocInt8,n.freeInt8];case"int16":return[n.mallocInt16,n.freeInt16];case"int32":return[n.mallocInt32,n.freeInt32];case"float32":return[n.mallocFloat,n.freeFloat];case"float64":return[n.mallocDouble,n.freeDouble];default:return null}}function o(e){var t=[];for(var r=0;r<e;++r){t.push("s"+r)}for(var r=0;r<e;++r){t.push("n"+r)}for(var r=1;r<e;++r){t.push("d"+r)}for(var r=1;r<e;++r){t.push("e"+r)}for(var r=1;r<e;++r){t.push("f"+r)}return t}function s(e,t){var r=["'use strict'"];var n=["ndarrayInsertionSort",e.join("d"),t].join("");var i=["left","right","data","offset"].concat(o(e.length));var s=a(t);var l=["i,j,cptr,ptr=left*s0+offset"];if(e.length>1){var u=[];for(var f=1;f<e.length;++f){l.push("i"+f);u.push("n"+f)}if(s){l.push("scratch=malloc("+u.join("*")+")")}else{l.push("scratch=new Array("+u.join("*")+")")}l.push("dptr","sptr","a","b")}else{l.push("scratch")}function c(e){if(t==="generic"){return["data.get(",e,")"].join("")}return["data[",e,"]"].join("")}function h(e,r){if(t==="generic"){return["data.set(",e,",",r,")"].join("")}return["data[",e,"]=",r].join("")}r.push(["function ",n,"(",i.join(","),"){var ",l.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr");if(e.length>1){r.push("dptr=0;sptr=ptr");for(var f=e.length-1;f>=0;--f){var v=e[f];if(v===0){continue}r.push(["for(i",v,"=0;i",v,"<n",v,";++i",v,"){"].join(""))}r.push("scratch[dptr++]=",c("sptr"));for(var f=0;f<e.length;++f){var v=e[f];if(v===0){continue}r.push("sptr+=d"+v,"}")}r.push("__g:while(j--\x3eleft){","dptr=0","sptr=cptr-s0");for(var f=1;f<e.length;++f){if(f===1){r.push("__l:")}r.push(["for(i",f,"=0;i",f,"<n",f,";++i",f,"){"].join(""))}r.push(["a=",c("sptr"),"\nb=scratch[dptr]\nif(a<b){break __g}\nif(a>b){break __l}"].join(""));for(var f=e.length-1;f>=1;--f){r.push("sptr+=e"+f,"dptr+=f"+f,"}")}r.push("dptr=cptr;sptr=cptr-s0");for(var f=e.length-1;f>=0;--f){var v=e[f];if(v===0){continue}r.push(["for(i",v,"=0;i",v,"<n",v,";++i",v,"){"].join(""))}r.push(h("dptr",c("sptr")));for(var f=0;f<e.length;++f){var v=e[f];if(v===0){continue}r.push(["dptr+=d",v,";sptr+=d",v].join(""),"}")}r.push("cptr-=s0\n}");r.push("dptr=cptr;sptr=0");for(var f=e.length-1;f>=0;--f){var v=e[f];if(v===0){continue}r.push(["for(i",v,"=0;i",v,"<n",v,";++i",v,"){"].join(""))}r.push(h("dptr","scratch[sptr++]"));for(var f=0;f<e.length;++f){var v=e[f];if(v===0){continue}r.push("dptr+=d"+v,"}")}}else{r.push("scratch="+c("ptr"),"while((j--\x3eleft)&&("+c("cptr-s0")+">scratch)){",h("cptr",c("cptr-s0")),"cptr-=s0","}",h("cptr","scratch"))}r.push("}");if(e.length>1&&s){r.push("free(scratch)")}r.push("} return "+n);if(s){var d=new Function("malloc","free",r.join("\n"));return d(s[0],s[1])}else{var d=new Function(r.join("\n"));return d()}}function l(e,t,r){var n=["'use strict'"];var s=["ndarrayQuickSort",e.join("d"),t].join("");var l=["left","right","data","offset"].concat(o(e.length));var u=a(t);var f=0;n.push(["function ",s,"(",l.join(","),"){"].join(""));var c=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"];if(e.length>1){var h=[];for(var v=1;v<e.length;++v){h.push("n"+v);c.push("i"+v)}for(var v=0;v<8;++v){c.push("b_ptr"+v)}c.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+h.join("*"));if(u){c.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)")}else{c.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}}else{c.push("pivot1","pivot2")}n.push("var "+c.join(","));function d(e){return["(offset+",e,"*s0)"].join("")}function p(e){if(t==="generic"){return["data.get(",e,")"].join("")}return["data[",e,"]"].join("")}function g(e,r){if(t==="generic"){return["data.set(",e,",",r,")"].join("")}return["data[",e,"]=",r].join("")}function m(t,r,i){if(t.length===1){n.push("ptr0="+d(t[0]))}else{for(var a=0;a<t.length;++a){n.push(["b_ptr",a,"=s0*",t[a]].join(""))}}if(r){n.push("pivot_ptr=0")}n.push("ptr_shift=offset");for(var a=e.length-1;a>=0;--a){var o=e[a];if(o===0){continue}n.push(["for(i",o,"=0;i",o,"<n",o,";++i",o,"){"].join(""))}if(t.length>1){for(var a=0;a<t.length;++a){n.push(["ptr",a,"=b_ptr",a,"+ptr_shift"].join(""))}}n.push(i);if(r){n.push("++pivot_ptr")}for(var a=0;a<e.length;++a){var o=e[a];if(o===0){continue}if(t.length>1){n.push("ptr_shift+=d"+o)}else{n.push("ptr0+=d"+o)}n.push("}")}}function y(t,r,i,a){if(r.length===1){n.push("ptr0="+d(r[0]))}else{for(var o=0;o<r.length;++o){n.push(["b_ptr",o,"=s0*",r[o]].join(""))}n.push("ptr_shift=offset")}if(i){n.push("pivot_ptr=0")}if(t){n.push(t+":")}for(var o=1;o<e.length;++o){n.push(["for(i",o,"=0;i",o,"<n",o,";++i",o,"){"].join(""))}if(r.length>1){for(var o=0;o<r.length;++o){n.push(["ptr",o,"=b_ptr",o,"+ptr_shift"].join(""))}}n.push(a);for(var o=e.length-1;o>=1;--o){if(i){n.push("pivot_ptr+=f"+o)}if(r.length>1){n.push("ptr_shift+=e"+o)}else{n.push("ptr0+=e"+o)}n.push("}")}}function b(){if(e.length>1&&u){n.push("free(pivot1)","free(pivot2)")}}function x(t,r){var i="el"+t;var a="el"+r;if(e.length>1){var o="__l"+ ++f;y(o,[i,a],false,["comp=",p("ptr0"),"-",p("ptr1"),"\n","if(comp>0){tmp0=",i,";",i,"=",a,";",a,"=tmp0;break ",o,"}\n","if(comp<0){break ",o,"}"].join(""))}else{n.push(["if(",p(d(i)),">",p(d(a)),"){tmp0=",i,";",i,"=",a,";",a,"=tmp0}"].join(""))}}x(1,2);x(4,5);x(1,3);x(2,3);x(1,4);x(3,4);x(2,5);x(2,3);x(4,5);if(e.length>1){m(["el1","el2","el3","el4","el5","index1","index3","index5"],true,["pivot1[pivot_ptr]=",p("ptr1"),"\n","pivot2[pivot_ptr]=",p("ptr3"),"\n","pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])\n","x=",p("ptr0"),"\n","y=",p("ptr2"),"\n","z=",p("ptr4"),"\n",g("ptr5","x"),"\n",g("ptr6","y"),"\n",g("ptr7","z")].join(""))}else{n.push(["pivot1=",p(d("el2")),"\n","pivot2=",p(d("el4")),"\n","pivots_are_equal=pivot1===pivot2\n","x=",p(d("el1")),"\n","y=",p(d("el3")),"\n","z=",p(d("el5")),"\n",g(d("index1"),"x"),"\n",g(d("index3"),"y"),"\n",g(d("index5"),"z")].join(""))}function _(t,r){if(e.length>1){m([t,r],false,g("ptr0",p("ptr1")))}else{n.push(g(d(t),p(d(r))))}}_("index2","left");_("index4","right");function w(t,r,i){if(e.length>1){var a="__l"+ ++f;y(a,[r],true,[t,"=",p("ptr0"),"-pivot",i,"[pivot_ptr]\n","if(",t,"!==0){break ",a,"}"].join(""))}else{n.push([t,"=",p(d(r)),"-pivot",i].join(""))}}function M(t,r){if(e.length>1){m([t,r],false,["tmp=",p("ptr0"),"\n",g("ptr0",p("ptr1")),"\n",g("ptr1","tmp")].join(""))}else{n.push(["ptr0=",d(t),"\n","ptr1=",d(r),"\n","tmp=",p("ptr0"),"\n",g("ptr0",p("ptr1")),"\n",g("ptr1","tmp")].join(""))}}function A(t,r,i){if(e.length>1){m([t,r,i],false,["tmp=",p("ptr0"),"\n",g("ptr0",p("ptr1")),"\n",g("ptr1",p("ptr2")),"\n",g("ptr2","tmp")].join(""));n.push("++"+r,"--"+i)}else{n.push(["ptr0=",d(t),"\n","ptr1=",d(r),"\n","ptr2=",d(i),"\n","++",r,"\n","--",i,"\n","tmp=",p("ptr0"),"\n",g("ptr0",p("ptr1")),"\n",g("ptr1",p("ptr2")),"\n",g("ptr2","tmp")].join(""))}}function T(e,t){M(e,t);n.push("--"+t)}n.push("if(pivots_are_equal){");n.push("for(k=less;k<=great;++k){");w("comp","k",1);n.push("if(comp===0){continue}");n.push("if(comp<0){");n.push("if(k!==less){");M("k","less");n.push("}");n.push("++less");n.push("}else{");n.push("while(true){");w("comp","great",1);n.push("if(comp>0){");n.push("great--");n.push("}else if(comp<0){");A("k","less","great");n.push("break");n.push("}else{");T("k","great");n.push("break");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}else{");n.push("for(k=less;k<=great;++k){");w("comp_pivot1","k",1);n.push("if(comp_pivot1<0){");n.push("if(k!==less){");M("k","less");n.push("}");n.push("++less");n.push("}else{");w("comp_pivot2","k",2);n.push("if(comp_pivot2>0){");n.push("while(true){");w("comp","great",2);n.push("if(comp>0){");n.push("if(--great<k){break}");n.push("continue");n.push("}else{");w("comp","great",1);n.push("if(comp<0){");A("k","less","great");n.push("}else{");T("k","great");n.push("}");n.push("break");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}");function k(t,r,i){if(e.length>1){m([t,r],true,[g("ptr0",p("ptr1")),"\n",g("ptr1",["pivot",i,"[pivot_ptr]"].join(""))].join(""))}else{n.push(g(d(t),p(d(r))),g(d(r),"pivot"+i))}}k("left","(less-1)",1);k("right","(great+1)",2);function E(t,r){n.push(["if((",r,"-",t,")<=",i,"){\n","insertionSort(",t,",",r,",data,offset,",o(e.length).join(","),")\n","}else{\n",s,"(",t,",",r,",data,offset,",o(e.length).join(","),")\n","}"].join(""))}E("left","(less-2)");E("(great+2)","right");n.push("if(pivots_are_equal){");b();n.push("return");n.push("}");function S(t,r,i){if(e.length>1){n.push(["__l",++f,":while(true){"].join(""));m([t],true,["if(",p("ptr0"),"!==pivot",r,"[pivot_ptr]){break __l",f,"}"].join(""));n.push(i,"}")}else{n.push(["while(",p(d(t)),"===pivot",r,"){",i,"}"].join(""))}}n.push("if(less<index1&&great>index5){");S("less",1,"++less");S("great",2,"--great");n.push("for(k=less;k<=great;++k){");w("comp_pivot1","k",1);n.push("if(comp_pivot1===0){");n.push("if(k!==less){");M("k","less");n.push("}");n.push("++less");n.push("}else{");w("comp_pivot2","k",2);n.push("if(comp_pivot2===0){");n.push("while(true){");w("comp","great",2);n.push("if(comp===0){");n.push("if(--great<k){break}");n.push("continue");n.push("}else{");w("comp","great",1);n.push("if(comp<0){");A("k","less","great");n.push("}else{");T("k","great");n.push("}");n.push("break");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}");n.push("}");b();E("less","great");n.push("}return "+s);if(e.length>1&&u){var L=new Function("insertionSort","malloc","free",n.join("\n"));return L(r,u[0],u[1])}var L=new Function("insertionSort",n.join("\n"));return L(r)}function u(e,t){var r=["'use strict'"];var n=["ndarraySortWrapper",e.join("d"),t].join("");var a=["array"];r.push(["function ",n,"(",a.join(","),"){"].join(""));var u=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"];for(var f=0;f<e.length;++f){u.push(["s",f,"=stride[",f,"]|0,n",f,"=shape[",f,"]|0"].join(""))}var c=new Array(e.length);var h=[];for(var f=0;f<e.length;++f){var v=e[f];if(v===0){continue}if(h.length===0){c[v]="1"}else{c[v]=h.join("*")}h.push("n"+v)}var d=-1,p=-1;for(var f=0;f<e.length;++f){var g=e[f];if(g!==0){if(d>0){u.push(["d",g,"=s",g,"-d",d,"*n",d].join(""))}else{u.push(["d",g,"=s",g].join(""))}d=g}var v=e.length-1-f;if(v!==0){if(p>0){u.push(["e",v,"=s",v,"-e",p,"*n",p,",f",v,"=",c[v],"-f",p,"*n",p].join(""))}else{u.push(["e",v,"=s",v,",f",v,"=",c[v]].join(""))}p=v}}r.push("var "+u.join(","));var m=["0","n0-1","data","offset"].concat(o(e.length));r.push(["if(n0<=",i,"){","insertionSort(",m.join(","),")}else{","quickSort(",m.join(","),")}"].join(""));r.push("}return "+n);var y=new Function("insertionSort","quickSort",r.join("\n"));var b=s(e,t);var x=l(e,t,b);return y(b,x)}t.exports=u},{"typedarray-pool":333}],268:[function(e,t,r){"use strict";var n=e("./lib/compile_sort.js");var i={};function a(e){var t=e.order;var r=e.dtype;var a=[t,r];var o=a.join(":");var s=i[o];if(!s){i[o]=s=n(t,r)}s(e);return e}t.exports=a},{"./lib/compile_sort.js":267}],269:[function(e,t,r){"use strict";var n=e("ndarray-linear-interpolate");var i=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=new Array(_inline_39_arg4_)}",args:[{name:"_inline_39_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_39_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_39_arg2_",lvalue:false,rvalue:false,count:0},{name:"_inline_39_arg3_",lvalue:false,rvalue:false,count:0},{name:"_inline_39_arg4_",lvalue:false,rvalue:true,count:1}],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_40_arg2_(this_warped,_inline_40_arg0_),_inline_40_arg1_=_inline_40_arg3_.apply(void 0,this_warped)}",args:[{name:"_inline_40_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_40_arg1_",lvalue:true,rvalue:false,count:1},{name:"_inline_40_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_40_arg3_",lvalue:false,rvalue:true,count:1},{name:"_inline_40_arg4_",lvalue:false,rvalue:false,count:0}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:false,funcName:"warpND",blockSize:64});var a=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_43_arg2_(this_warped,_inline_43_arg0_),_inline_43_arg1_=_inline_43_arg3_(_inline_43_arg4_,this_warped[0])}",args:[{name:"_inline_43_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_43_arg1_",lvalue:true,rvalue:false,count:1},{name:"_inline_43_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_43_arg3_",lvalue:false,rvalue:true,count:1},{name:"_inline_43_arg4_",lvalue:false,rvalue:true,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:false,funcName:"warp1D",blockSize:64});var o=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_46_arg2_(this_warped,_inline_46_arg0_),_inline_46_arg1_=_inline_46_arg3_(_inline_46_arg4_,this_warped[0],this_warped[1])}",args:[{name:"_inline_46_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_46_arg1_",lvalue:true,rvalue:false,count:1},{name:"_inline_46_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_46_arg3_",lvalue:false,rvalue:true,count:1},{name:"_inline_46_arg4_",lvalue:false,rvalue:true,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:false,funcName:"warp2D",blockSize:64});var s=e("cwise/lib/wrapper")({args:["index","array","scalar","scalar","scalar"],pre:{body:"{this_warped=[0,0,0]}",args:[],thisVars:["this_warped"],localVars:[]},body:{body:"{_inline_49_arg2_(this_warped,_inline_49_arg0_),_inline_49_arg1_=_inline_49_arg3_(_inline_49_arg4_,this_warped[0],this_warped[1],this_warped[2])}",args:[{name:"_inline_49_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_49_arg1_",lvalue:true,rvalue:false,count:1},{name:"_inline_49_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_49_arg3_",lvalue:false,rvalue:true,count:1},{name:"_inline_49_arg4_",lvalue:false,rvalue:true,count:1}],thisVars:["this_warped"],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},debug:false,funcName:"warp3D",blockSize:64});t.exports=function e(t,r,l){switch(r.shape.length){case 1:a(t,l,n.d1,r);break;case 2:o(t,l,n.d2,r);break;case 3:s(t,l,n.d3,r);break;default:i(t,l,n.bind(undefined,r),r.shape.length);break}return t}},{"cwise/lib/wrapper":80,"ndarray-linear-interpolate":263}],270:[function(e,t,r){var n=e("iota-array");var i=e("is-buffer");var a=typeof Float64Array!=="undefined";function o(e,t){return e[0]-t[0]}function s(){var e=this.stride;var t=new Array(e.length);var r;for(r=0;r<t.length;++r){t[r]=[Math.abs(e[r]),r]}t.sort(o);var n=new Array(t.length);for(r=0;r<n.length;++r){n[r]=t[r][1]}return n}function l(e,t){var r=["View",t,"d",e].join("");if(t<0){r="View_Nil"+e}var i=e==="generic";if(t===-1){var a="function "+r+"(a){this.data=a;};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+r+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+r+"(a){return new "+r+"(a);}";var o=new Function(a);return o()}else if(t===0){var a="function "+r+"(a,d) {this.data = a;this.offset = d};var proto="+r+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+r+"_copy() {return new "+r+"(this.data,this.offset)};proto.pick=function "+r+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+r+"_get(){return "+(i?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+r+"_set(v){return "+(i?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+r+"(a,b,c,d){return new "+r+"(a,d)}";var o=new Function("TrivialArray",a);return o(f[e][0])}var a=["'use strict'"];var l=n(t);var u=l.map(function(e){return"i"+e});var c="this.offset+"+l.map(function(e){return"this.stride["+e+"]*i"+e}).join("+");var h=l.map(function(e){return"b"+e}).join(",");var v=l.map(function(e){return"c"+e}).join(",");a.push("function "+r+"(a,"+h+","+v+",d){this.data=a","this.shape=["+h+"]","this.stride=["+v+"]","this.offset=d|0}","var proto="+r+".prototype","proto.dtype='"+e+"'","proto.dimension="+t);a.push("Object.defineProperty(proto,'size',{get:function "+r+"_size(){return "+l.map(function(e){return"this.shape["+e+"]"}).join("*"),"}})");if(t===1){a.push("proto.order=[0]")}else{a.push("Object.defineProperty(proto,'order',{get:");if(t<4){a.push("function "+r+"_order(){");if(t===2){a.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})")}else if(t===3){a.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")}}else{a.push("ORDER})")}}a.push("proto.set=function "+r+"_set("+u.join(",")+",v){");if(i){a.push("return this.data.set("+c+",v)}")}else{a.push("return this.data["+c+"]=v}")}a.push("proto.get=function "+r+"_get("+u.join(",")+"){");if(i){a.push("return this.data.get("+c+")}")}else{a.push("return this.data["+c+"]}")}a.push("proto.index=function "+r+"_index(",u.join(),"){return "+c+"}");a.push("proto.hi=function "+r+"_hi("+u.join(",")+"){return new "+r+"(this.data,"+l.map(function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")}).join(",")+","+l.map(function(e){return"this.stride["+e+"]"}).join(",")+",this.offset)}");var d=l.map(function(e){return"a"+e+"=this.shape["+e+"]"});var p=l.map(function(e){return"c"+e+"=this.stride["+e+"]"});a.push("proto.lo=function "+r+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+d.join(",")+","+p.join(","));for(var g=0;g<t;++g){a.push("if(typeof i"+g+"==='number'&&i"+g+">=0){d=i"+g+"|0;b+=c"+g+"*d;a"+g+"-=d}")}a.push("return new "+r+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"c"+e}).join(",")+",b)}");a.push("proto.step=function "+r+"_step("+u.join(",")+"){var "+l.map(function(e){return"a"+e+"=this.shape["+e+"]"}).join(",")+","+l.map(function(e){return"b"+e+"=this.stride["+e+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var g=0;g<t;++g){a.push("if(typeof i"+g+"==='number'){d=i"+g+"|0;if(d<0){c+=b"+g+"*(a"+g+"-1);a"+g+"=ceil(-a"+g+"/d)}else{a"+g+"=ceil(a"+g+"/d)}b"+g+"*=d}")}a.push("return new "+r+"(this.data,"+l.map(function(e){return"a"+e}).join(",")+","+l.map(function(e){return"b"+e}).join(",")+",c)}");var m=new Array(t);var y=new Array(t);for(var g=0;g<t;++g){m[g]="a[i"+g+"]";y[g]="b[i"+g+"]"}a.push("proto.transpose=function "+r+"_transpose("+u+"){"+u.map(function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+r+"(this.data,"+m.join(",")+","+y.join(",")+",this.offset)}");a.push("proto.pick=function "+r+"_pick("+u+"){var a=[],b=[],c=this.offset");for(var g=0;g<t;++g){a.push("if(typeof i"+g+"==='number'&&i"+g+">=0){c=(c+this.stride["+g+"]*i"+g+")|0}else{a.push(this.shape["+g+"]);b.push(this.stride["+g+"])}")}a.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");a.push("return function construct_"+r+"(data,shape,stride,offset){return new "+r+"(data,"+l.map(function(e){return"shape["+e+"]"}).join(",")+","+l.map(function(e){return"stride["+e+"]"}).join(",")+",offset)}");var o=new Function("CTOR_LIST","ORDER",a.join("\n"));return o(f[e],s)}function u(e){if(i(e)){return"buffer"}if(a){switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}}if(Array.isArray(e)){return"array"}return"generic"}var f={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};(function(){for(var e in f){f[e].push(l(e,-1))}});function c(e,t,r,n){if(e===undefined){var i=f.array[0];return i([])}else if(typeof e==="number"){e=[e]}if(t===undefined){t=[e.length]}var a=t.length;if(r===undefined){r=new Array(a);for(var o=a-1,s=1;o>=0;--o){r[o]=s;s*=t[o]}}if(n===undefined){n=0;for(var o=0;o<a;++o){if(r[o]<0){n-=(t[o]-1)*r[o]}}}var c=u(e);var h=f[c];while(h.length<=a+1){h.push(l(c,h.length-1))}var i=h[a+1];return i(e,t,r,n)}t.exports=c},{"iota-array":242,"is-buffer":244}],271:[function(e,t,r){"use strict";var n=e("double-bits");var i=Math.pow(2,-1074);var a=-1>>>0;t.exports=o;function o(e,t){if(isNaN(e)||isNaN(t)){return NaN}if(e===t){return e}if(e===0){if(t<0){return-i}else{return i}}var r=n.hi(e);var o=n.lo(e);if(t>e===e>0){if(o===a){r+=1;o=0}else{o+=1}}else{if(o===0){o=a;r-=1}else{o-=1}}return n.pack(o,r)}},{"double-bits":84}],272:[function(e,t,r){var n=1e-6;var i=1e-6;r.vertexNormals=function(e,t,r){var i=t.length;var a=new Array(i);var o=r===void 0?n:r;for(var s=0;s<i;++s){a[s]=[0,0,0]}for(var s=0;s<e.length;++s){var l=e[s];var u=0;var f=l[l.length-1];var c=l[0];for(var h=0;h<l.length;++h){u=f;f=c;c=l[(h+1)%l.length];var v=t[u];var d=t[f];var p=t[c];var g=new Array(3);var m=0;var y=new Array(3);var b=0;for(var x=0;x<3;++x){g[x]=v[x]-d[x];m+=g[x]*g[x];y[x]=p[x]-d[x];b+=y[x]*y[x]}if(m*b>o){var _=a[f];var w=1/Math.sqrt(m*b);for(var x=0;x<3;++x){var M=(x+1)%3;var A=(x+2)%3;_[x]+=w*(y[M]*g[A]-y[A]*g[M])}}}}for(var s=0;s<i;++s){var _=a[s];var T=0;for(var x=0;x<3;++x){T+=_[x]*_[x]}if(T>o){var w=1/Math.sqrt(T);for(var x=0;x<3;++x){_[x]*=w}}else{for(var x=0;x<3;++x){_[x]=0}}}return a};r.faceNormals=function(e,t,r){var n=e.length;var a=new Array(n);var o=r===void 0?i:r;for(var s=0;s<n;++s){var l=e[s];var u=new Array(3);for(var f=0;f<3;++f){u[f]=t[l[f]]}var c=new Array(3);var h=new Array(3);for(var f=0;f<3;++f){c[f]=u[1][f]-u[0][f];h[f]=u[2][f]-u[0][f]}var v=new Array(3);var d=0;for(var f=0;f<3;++f){var p=(f+1)%3;var g=(f+2)%3;v[f]=c[p]*h[g]-c[g]*h[p];d+=v[f]*v[f]}if(d>o){d=1/Math.sqrt(d)}else{d=0}for(var f=0;f<3;++f){v[f]*=d}a[s]=v}return a}},{}],273:[function(e,t,r){"use strict";t.exports=n;function n(e,t,r,n,i,a,o,s,l,u){var f=t+a+u;if(c>0){var c=Math.sqrt(f+1);e[0]=.5*(o-l)/c;e[1]=.5*(s-n)/c;e[2]=.5*(r-a)/c;e[3]=.5*c}else{var h=Math.max(t,a,u);var c=Math.sqrt(2*h-f+1);if(t>=h){e[0]=.5*c;e[1]=.5*(i+r)/c;e[2]=.5*(s+n)/c;e[3]=.5*(o-l)/c}else if(a>=h){e[0]=.5*(r+i)/c;e[1]=.5*c;e[2]=.5*(l+o)/c;e[3]=.5*(s-n)/c}else{e[0]=.5*(n+s)/c;e[1]=.5*(o+l)/c;e[2]=.5*c;e[3]=.5*(r-i)/c}}return e}},{}],274:[function(e,t,r){"use strict";t.exports=v;var n=e("filtered-vector");var i=e("gl-mat4/lookAt");var a=e("gl-mat4/fromQuat");var o=e("gl-mat4/invert");var s=e("./lib/quatFromFrame");function l(e,t,r){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(r,2))}function u(e,t,r,n){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(r,2)+Math.pow(n,2))}function f(e,t){var r=t[0];var n=t[1];var i=t[2];var a=t[3];var o=u(r,n,i,a);if(o>1e-6){e[0]=r/o;e[1]=n/o;e[2]=i/o;e[3]=a/o}else{e[0]=e[1]=e[2]=0;e[3]=1}}function c(e,t,r){this.radius=n([r]);this.center=n(t);this.rotation=n(e);this.computedRadius=this.radius.curve(0);this.computedCenter=this.center.curve(0);this.computedRotation=this.rotation.curve(0);this.computedUp=[.1,0,0];this.computedEye=[.1,0,0];this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.recalcMatrix(0)}var h=c.prototype;h.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())};h.recalcMatrix=function(e){this.radius.curve(e);this.center.curve(e);this.rotation.curve(e);var t=this.computedRotation;f(t,t);var r=this.computedMatrix;a(r,t);var n=this.computedCenter;var i=this.computedEye;var o=this.computedUp;var s=Math.exp(this.computedRadius[0]);i[0]=n[0]+s*r[2];i[1]=n[1]+s*r[6];i[2]=n[2]+s*r[10];o[0]=r[1];o[1]=r[5];o[2]=r[9];for(var l=0;l<3;++l){var u=0;for(var c=0;c<3;++c){u+=r[l+4*c]*i[c]}r[12+l]=-u}};h.getMatrix=function(e,t){this.recalcMatrix(e);var r=this.computedMatrix;if(t){for(var n=0;n<16;++n){t[n]=r[n]}return t}return r};h.idle=function(e){this.center.idle(e);this.radius.idle(e);this.rotation.idle(e)};h.flush=function(e){this.center.flush(e);this.radius.flush(e);this.rotation.flush(e)};h.pan=function(e,t,r,n){t=t||0;r=r||0;n=n||0;this.recalcMatrix(e);var i=this.computedMatrix;var a=i[1];var o=i[5];var s=i[9];var u=l(a,o,s);a/=u;o/=u;s/=u;var f=i[0];var c=i[4];var h=i[8];var v=f*a+c*o+h*s;f-=a*v;c-=o*v;h-=s*v;var d=l(f,c,h);f/=d;c/=d;h/=d;var p=i[2];var g=i[6];var m=i[10];var y=p*a+g*o+m*s;var b=p*f+g*c+m*h;p-=y*a+b*f;g-=y*o+b*c;m-=y*s+b*h;var x=l(p,g,m);p/=x;g/=x;m/=x;var _=f*t+a*r;var w=c*t+o*r;var M=h*t+s*r;this.center.move(e,_,w,M);var A=Math.exp(this.computedRadius[0]);A=Math.max(1e-4,A+n);this.radius.set(e,Math.log(A))};h.rotate=function(e,t,r,n){this.recalcMatrix(e);t=t||0;r=r||0;var i=this.computedMatrix;var a=i[0];var o=i[4];var s=i[8];var f=i[1];var c=i[5];var h=i[9];var v=i[2];var d=i[6];var p=i[10];var g=t*a+r*f;var m=t*o+r*c;var y=t*s+r*h;var b=-(d*y-p*m);var x=-(p*g-v*y);var _=-(v*m-d*g);var w=Math.sqrt(Math.max(0,1-Math.pow(b,2)-Math.pow(x,2)-Math.pow(_,2)));var M=u(b,x,_,w);if(M>1e-6){b/=M;x/=M;_/=M;w/=M}else{b=x=_=0;w=1}var A=this.computedRotation;var T=A[0];var k=A[1];var E=A[2];var S=A[3];var L=T*w+S*b+k*_-E*x;var C=k*w+S*x+E*b-T*_;var I=E*w+S*_+T*x-k*b;var P=S*w-T*b-k*x-E*_;if(n){b=v;x=d;_=p;var O=Math.sin(n)/l(b,x,_);b*=O;x*=O;_*=O;w=Math.cos(t);L=L*w+P*b+C*_-I*x;C=C*w+P*x+I*b-L*_;I=I*w+P*_+L*x-C*b;P=P*w-L*b-C*x-I*_}var R=u(L,C,I,P);if(R>1e-6){L/=R;C/=R;I/=R;P/=R}else{L=C=I=0;P=1}this.rotation.set(e,L,C,I,P)};h.lookAt=function(e,t,r,n){this.recalcMatrix(e);r=r||this.computedCenter;t=t||this.computedEye;n=n||this.computedUp;var a=this.computedMatrix;i(a,t,r,n);var o=this.computedRotation;s(o,a[0],a[1],a[2],a[4],a[5],a[6],a[8],a[9],a[10]);f(o,o);this.rotation.set(e,o[0],o[1],o[2],o[3]);var l=0;for(var u=0;u<3;++u){l+=Math.pow(r[u]-t[u],2)}this.radius.set(e,.5*Math.log(Math.max(l,1e-6)));this.center.set(e,r[0],r[1],r[2])};h.translate=function(e,t,r,n){this.center.move(e,t||0,r||0,n||0)};h.setMatrix=function(e,t){var r=this.computedRotation;s(r,t[0],t[1],t[2],t[4],t[5],t[6],t[8],t[9],t[10]);f(r,r);this.rotation.set(e,r[0],r[1],r[2],r[3]);var n=this.computedMatrix;o(n,t);var i=n[15];if(Math.abs(i)>1e-6){var a=n[12]/i;var l=n[13]/i;var u=n[14]/i;this.recalcMatrix(e);var c=Math.exp(this.computedRadius[0]);this.center.set(e,a-n[2]*c,l-n[6]*c,u-n[10]*c);this.radius.idle(e)}else{this.center.idle(e);this.radius.idle(e)}};h.setDistance=function(e,t){if(t>0){this.radius.set(e,Math.log(t))}};h.setDistanceLimits=function(e,t){if(e>0){e=Math.log(e)}else{e=-Infinity}if(t>0){t=Math.log(t)}else{t=Infinity}t=Math.max(t,e);this.radius.bounds[0][0]=e;this.radius.bounds[1][0]=t};h.getDistanceLimits=function(e){var t=this.radius.bounds;if(e){e[0]=Math.exp(t[0][0]);e[1]=Math.exp(t[1][0]);return e}return[Math.exp(t[0][0]),Math.exp(t[1][0])]};h.toJSON=function(){this.recalcMatrix(this.lastT());return{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}};h.fromJSON=function(e){var t=this.lastT();var r=e.center;if(r){this.center.set(t,r[0],r[1],r[2])}var n=e.rotation;if(n){this.rotation.set(t,n[0],n[1],n[2],n[3])}var i=e.distance;if(i&&i>0){this.radius.set(t,Math.log(i))}this.setDistanceLimits(e.zoomMin,e.zoomMax)};function v(e){e=e||{};var t=e.center||[0,0,0];var r=e.rotation||[0,0,0,1];var n=e.radius||1;t=[].slice.call(t,0,3);r=[].slice.call(r,0,4);f(r,r);var i=new c(r,t,Math.log(n));i.setDistanceLimits(e.zoomMin,e.zoomMax);if("eye"in e||"up"in e){i.lookAt(0,e.eye,e.center,e.up)}return i}},{"./lib/quatFromFrame":273,"filtered-vector":92,"gl-mat4/fromQuat":122,"gl-mat4/invert":125,"gl-mat4/lookAt":126}],275:[function(e,t,r){"use strict";var n=e("repeat-string");t.exports=function e(t,r,i){i=typeof i!=="undefined"?i+"":" ";return n(i,r)+t}},{"repeat-string":299}],276:[function(e,t,r){t.exports=function e(t,r){if(!r)r=[0,""];t=String(t);var n=parseFloat(t,10);r[0]=n;r[1]=t.match(/[\d.\-\+]*\s*(.*)/)[1]||"";return r}},{}],277:[function(e,t,r){"use strict";t.exports=a;var n=32;var i=e("typedarray-pool");function a(e){var t=e.length;if(t<n){var r=1;for(var a=0;a<t;++a){for(var o=0;o<a;++o){if(e[a]<e[o]){r=-r}else if(e[a]===e[o]){return 0}}}return r}else{var s=i.mallocUint8(t);for(var a=0;a<t;++a){s[a]=0}var r=1;for(var a=0;a<t;++a){if(!s[a]){var l=1;s[a]=1;for(var o=e[a];o!==a;o=e[o]){if(s[o]){i.freeUint8(s);return 0}l+=1;s[o]=1}if(!(l&1)){r=-r}}}i.freeUint8(s);return r}}},{"typedarray-pool":333}],278:[function(e,t,r){"use strict";var n=e("typedarray-pool");var i=e("invert-permutation");function a(e){var t=e.length;switch(t){case 0:case 1:return 0;case 2:return e[1];default:break}var r=n.mallocUint32(t);var a=n.mallocUint32(t);var o=0,s,l,u;i(e,a);for(u=0;u<t;++u){r[u]=e[u]}for(u=t-1;u>0;--u){l=a[u];s=r[u];r[u]=r[l];r[l]=s;a[u]=a[s];a[s]=l;o=(o+s)*u}n.freeUint32(a);n.freeUint32(r);return o}function o(e,t,r){switch(e){case 0:if(r){return r}return[];case 1:if(r){r[0]=0;return r}else{return[0]}case 2:if(r){if(t){r[0]=0;r[1]=1}else{r[0]=1;r[1]=0}return r}else{return t?[0,1]:[1,0]}default:break}r=r||new Array(e);var n,i,a,o=1;r[0]=0;for(a=1;a<e;++a){r[a]=a;o=o*a|0}for(a=e-1;a>0;--a){n=t/o|0;t=t-n*o|0;o=o/a|0;i=r[a]|0;r[a]=r[n]|0;r[n]=i|0}return r}r.rank=a;r.unrank=o},{"invert-permutation":241,"typedarray-pool":333}],279:[function(e,t,r){"use strict";t.exports=i;var n=e("compare-angle");function i(e,t){var r=t.length|0;var i=e.length;var a=[new Array(r),new Array(r)];for(var o=0;o<r;++o){a[0][o]=[];a[1][o]=[]}for(var o=0;o<i;++o){var s=e[o];a[0][s[0]].push(s);a[1][s[1]].push(s)}var l=[];for(var o=0;o<r;++o){if(a[0][o].length+a[1][o].length===0){l.push([o])}}function u(e,t){var r=a[t][e[t]];r.splice(r.indexOf(e),1)}function f(e,r,i){var o,s,l;for(var f=0;f<2;++f){if(a[f][r].length>0){o=a[f][r][0];l=f;break}}s=o[l^1];for(var c=0;c<2;++c){var h=a[c][r];for(var v=0;v<h.length;++v){var d=h[v];var p=d[c^1];var g=n(t[e],t[r],t[s],t[p]);if(g>0){o=d;s=p;l=c}}}if(i){return s}if(o){u(o,l)}return s}function c(e,r){var i=a[r][e][0];var o=[e];u(i,r);var s=i[r^1];var l=r;while(true){while(s!==e){o.push(s);s=f(o[o.length-2],s,false)}if(a[0][e].length+a[1][e].length===0){break}var c=o[o.length-1];var h=e;var v=o[1];var d=f(c,h,true);if(n(t[c],t[h],t[v],t[d])<0){break}o.push(e);s=f(c,h)}return o}function h(e,t){return t[1]===t[t.length-1]}for(var o=0;o<r;++o){for(var v=0;v<2;++v){var d=[];while(a[v][o].length>0){var p=a[0][o].length;var g=c(o,v);if(h(d,g)){d.push.apply(d,g)}else{if(d.length>0){l.push(d)}d=g}}if(d.length>0){l.push(d)}}}return l}},{"compare-angle":69}],280:[function(e,t,r){"use strict";t.exports=i;var n=e("edges-to-adjacency-list");function i(e,t){var r=n(e,t.length);var i=new Array(t.length);var a=new Array(t.length);var o=[];for(var s=0;s<t.length;++s){var l=r[s].length;a[s]=l;i[s]=true;if(l<=1){o.push(s)}}while(o.length>0){var u=o.pop();i[u]=false;var f=r[u];for(var s=0;s<f.length;++s){var c=f[s];if(--a[c]===0){o.push(c)}}}var h=new Array(t.length);var v=[];for(var s=0;s<t.length;++s){if(i[s]){var u=v.length;h[s]=u;v.push(t[s])}else{h[s]=-1}}var d=[];for(var s=0;s<e.length;++s){var p=e[s];if(i[p[0]]&&i[p[1]]){d.push([h[p[0]],h[p[1]]])}}return[d,v]}},{"edges-to-adjacency-list":87}],281:[function(e,t,r){"use strict";t.exports=h;var n=e("edges-to-adjacency-list");var i=e("planar-dual");var a=e("point-in-big-polygon");var o=e("two-product");var s=e("robust-sum");var l=e("uniq");var u=e("./lib/trim-leaves");function f(e,t){var r=new Array(e);for(var n=0;n<e;++n){r[n]=t}return r}function c(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=[]}return t}function h(e,t){var r=u(e,t);e=r[0];t=r[1];var h=t.length;var v=e.length;var d=n(e,t.length);for(var p=0;p<h;++p){if(d[p].length%2===1){throw new Error("planar-graph-to-polyline: graph must be manifold")}}var g=i(e,t);function m(e){var r=e.length;var n=[0];for(var i=0;i<r;++i){var a=t[e[i]];var l=t[e[(i+1)%r]];var u=o(-a[0],a[1]);var f=o(-a[0],l[1]);var c=o(l[0],a[1]);var h=o(l[0],l[1]);n=s(n,s(s(u,f),s(c,h)))}return n[n.length-1]>0}g=g.filter(m);var y=g.length;var b=new Array(y);var x=new Array(y);for(var p=0;p<y;++p){b[p]=p;var _=new Array(y);var w=g[p].map(function(e){return t[e]});var M=a([w]);var A=0;e:for(var T=0;T<y;++T){_[T]=0;if(p===T){continue}var k=g[T];var E=k.length;for(var S=0;S<E;++S){var L=M(t[k[S]]);if(L!==0){if(L<0){_[T]=1;A+=1}continue e}}_[T]=1;A+=1}x[p]=[A,p,_]}x.sort(function(e,t){return t[0]-e[0]});for(var p=0;p<y;++p){var _=x[p];var C=_[1];var I=_[2];for(var T=0;T<y;++T){if(I[T]){b[T]=C}}}var P=c(y);for(var p=0;p<y;++p){P[p].push(b[p]);P[b[p]].push(p)}var O={};var R=f(h,false);for(var p=0;p<y;++p){var k=g[p];var E=k.length;for(var T=0;T<E;++T){var N=k[T];var z=k[(T+1)%E];var D=Math.min(N,z)+":"+Math.max(N,z);if(D in O){var F=O[D];P[F].push(p);P[p].push(F);R[N]=R[z]=true}else{O[D]=p}}}function j(e){var t=e.length;for(var r=0;r<t;++r){if(!R[e[r]]){return false}}return true}var B=[];var U=f(y,-1);for(var p=0;p<y;++p){if(b[p]===p&&!j(g[p])){B.push(p);U[p]=0}else{U[p]=-1}}var r=[];while(B.length>0){var V=B.pop();var H=P[V];l(H,function(e,t){return e-t});var q=H.length;var G=U[V];var W;if(G===0){var k=g[V];W=[k]}for(var p=0;p<q;++p){var X=H[p];if(U[X]>=0){continue}U[X]=G^1;B.push(X);if(G===0){var k=g[X];if(!j(k)){k.reverse();W.push(k)}}}if(G===0){r.push(W)}}return r}},{"./lib/trim-leaves":280,"edges-to-adjacency-list":87,"planar-dual":279,"point-in-big-polygon":282,"robust-sum":311,"two-product":331,uniq:335}],282:[function(e,t,r){t.exports=d;var n=e("robust-orientation")[3];var i=e("slab-decomposition");var a=e("interval-tree-1d");var o=e("binary-search-bounds");function s(){return true}function l(e){return function(t,r){var n=e[t];if(n){return!!n.queryPoint(r,s)}return false}}function u(e){var t={};for(var r=0;r<e.length;++r){var n=e[r];var i=n[0][0];var o=n[0][1];var s=n[1][1];var u=[Math.min(o,s),Math.max(o,s)];if(i in t){t[i].push(u)}else{t[i]=[u]}}var f={};var c=Object.keys(t);for(var r=0;r<c.length;++r){var h=t[c[r]];f[c[r]]=a(h)}return l(f)}function f(e,t){return function(r){var i=o.le(t,r[0]);if(i<0){return 1}var a=e[i];if(!a){if(i>0&&t[i]===r[0]){a=e[i-1]}else{return 1}}var s=1;while(a){var l=a.key;var u=n(r,l[0],l[1]);if(l[0][0]<l[1][0]){if(u<0){a=a.left}else if(u>0){s=-1;a=a.right}else{return 0}}else{if(u>0){a=a.left}else if(u<0){s=1;a=a.right}else{return 0}}}return s}}function c(e){return 1}function h(e){return function t(r){if(e(r[0],r[1])){return 0}return 1}}function v(e,t){return function r(n){if(e(n[0],n[1])){return 0}return t(n)}}function d(e){var t=e.length;var r=[];var n=[];var a=0;for(var o=0;o<t;++o){var s=e[o];var l=s.length;for(var d=l-1,p=0;p<l;d=p++){var g=s[d];var m=s[p];if(g[0]===m[0]){n.push([g,m])}else{r.push([g,m])}}}if(r.length===0){if(n.length===0){return c}else{return h(u(n))}}var y=i(r);var b=f(y.slabs,y.coordinates);if(n.length===0){return b}else{return v(u(n),b)}}},{"binary-search-bounds":36,"interval-tree-1d":240,"robust-orientation":306,"slab-decomposition":322}],283:[function(e,t,r){var n=e("./lib/build-log");var i=e("./lib/epsilon");var a=e("./lib/intersecter");var o=e("./lib/segment-chainer");var s=e("./lib/segment-selector");var l=e("./lib/geojson");var u=false;var f=i();var c;c={buildLog:function(e){if(e===true)u=n();else if(e===false)u=false;return u===false?false:u.list},epsilon:function(e){return f.epsilon(e)},segments:function(e){var t=a(true,f,u);e.regions.forEach(t.addRegion);return{segments:t.calculate(e.inverted),inverted:e.inverted}},combine:function(e,t){var r=a(false,f,u);return{combined:r.calculate(e.segments,e.inverted,t.segments,t.inverted),inverted1:e.inverted,inverted2:t.inverted}},selectUnion:function(e){return{segments:s.union(e.combined,u),inverted:e.inverted1||e.inverted2}},selectIntersect:function(e){return{segments:s.intersect(e.combined,u),inverted:e.inverted1&&e.inverted2}},selectDifference:function(e){return{segments:s.difference(e.combined,u),inverted:e.inverted1&&!e.inverted2}},selectDifferenceRev:function(e){return{segments:s.differenceRev(e.combined,u),inverted:!e.inverted1&&e.inverted2}},selectXor:function(e){return{segments:s.xor(e.combined,u),inverted:e.inverted1!==e.inverted2}},polygon:function(e){return{regions:o(e.segments,f,u),inverted:e.inverted}},polygonFromGeoJSON:function(e){return l.toPolygon(c,e)},polygonToGeoJSON:function(e){return l.fromPolygon(c,f,e)},union:function(e,t){return h(e,t,c.selectUnion)},intersect:function(e,t){return h(e,t,c.selectIntersect)},difference:function(e,t){return h(e,t,c.selectDifference)},differenceRev:function(e,t){return h(e,t,c.selectDifferenceRev)},xor:function(e,t){return h(e,t,c.selectXor)}};function h(e,t,r){var n=c.segments(e);var i=c.segments(t);var a=c.combine(n,i);var o=r(a);return c.polygon(o)}if(typeof window==="object")window.PolyBool=c;t.exports=c},{"./lib/build-log":284,"./lib/epsilon":285,"./lib/geojson":286,"./lib/intersecter":287,"./lib/segment-chainer":289,"./lib/segment-selector":290}],284:[function(e,t,r){function n(){var e;var t=0;var r=false;function n(t,r){e.list.push({type:t,data:r?JSON.parse(JSON.stringify(r)):void 0});return e}e={list:[],segmentId:function(){return t++},checkIntersection:function(e,t){return n("check",{seg1:e,seg2:t})},segmentChop:function(e,t){n("div_seg",{seg:e,pt:t});return n("chop",{seg:e,pt:t})},statusRemove:function(e){return n("pop_seg",{seg:e})},segmentUpdate:function(e){return n("seg_update",{seg:e})},segmentNew:function(e,t){return n("new_seg",{seg:e,primary:t})},segmentRemove:function(e){return n("rem_seg",{seg:e})},tempStatus:function(e,t,r){return n("temp_status",{seg:e,above:t,below:r})},rewind:function(e){return n("rewind",{seg:e})},status:function(e,t,r){return n("status",{seg:e,above:t,below:r})},vert:function(t){if(t===r)return e;r=t;return n("vert",{x:t})},log:function(e){if(typeof e!=="string")e=JSON.stringify(e,false,"  ");return n("log",{txt:e})},reset:function(){return n("reset")},selected:function(e){return n("selected",{segs:e})},chainStart:function(e){return n("chain_start",{seg:e})},chainRemoveHead:function(e,t){return n("chain_rem_head",{index:e,pt:t})},chainRemoveTail:function(e,t){return n("chain_rem_tail",{index:e,pt:t})},chainNew:function(e,t){return n("chain_new",{pt1:e,pt2:t})},chainMatch:function(e){return n("chain_match",{index:e})},chainClose:function(e){return n("chain_close",{index:e})},chainAddHead:function(e,t){return n("chain_add_head",{index:e,pt:t})},chainAddTail:function(e,t){return n("chain_add_tail",{index:e,pt:t})},chainConnect:function(e,t){return n("chain_con",{index1:e,index2:t})},chainReverse:function(e){return n("chain_rev",{index:e})},chainJoin:function(e,t){return n("chain_join",{index1:e,index2:t})},done:function(){return n("done")}};return e}t.exports=n},{}],285:[function(e,t,r){function n(e){if(typeof e!=="number")e=1e-10;var t={epsilon:function(t){if(typeof t==="number")e=t;return e},pointAboveOrOnLine:function(t,r,n){var i=r[0];var a=r[1];var o=n[0];var s=n[1];var l=t[0];var u=t[1];return(o-i)*(u-a)-(s-a)*(l-i)>=-e},pointBetween:function(t,r,n){var i=t[1]-r[1];var a=n[0]-r[0];var o=t[0]-r[0];var s=n[1]-r[1];var l=o*a+i*s;if(l<e)return false;var u=a*a+s*s;if(l-u>-e)return false;return true},pointsSameX:function(t,r){return Math.abs(t[0]-r[0])<e},pointsSameY:function(t,r){return Math.abs(t[1]-r[1])<e},pointsSame:function(e,r){return t.pointsSameX(e,r)&&t.pointsSameY(e,r)},pointsCompare:function(e,r){if(t.pointsSameX(e,r))return t.pointsSameY(e,r)?0:e[1]<r[1]?-1:1;return e[0]<r[0]?-1:1},pointsCollinear:function(t,r,n){var i=t[0]-r[0];var a=t[1]-r[1];var o=r[0]-n[0];var s=r[1]-n[1];return Math.abs(i*s-o*a)<e},linesIntersect:function(t,r,n,i){var a=r[0]-t[0];var o=r[1]-t[1];var s=i[0]-n[0];var l=i[1]-n[1];var u=a*l-o*s;if(Math.abs(u)<e)return false;var f=t[0]-n[0];var c=t[1]-n[1];var h=(s*c-l*f)/u;var v=(a*c-o*f)/u;var d={alongA:0,alongB:0,pt:[t[0]+h*a,t[1]+h*o]};if(h<=-e)d.alongA=-2;else if(h<e)d.alongA=-1;else if(h-1<=-e)d.alongA=0;else if(h-1<e)d.alongA=1;else d.alongA=2;if(v<=-e)d.alongB=-2;else if(v<e)d.alongB=-1;else if(v-1<=-e)d.alongB=0;else if(v-1<e)d.alongB=1;else d.alongB=2;return d},pointInsideRegion:function(t,r){var n=t[0];var i=t[1];var a=r[r.length-1][0];var o=r[r.length-1][1];var s=false;for(var l=0;l<r.length;l++){var u=r[l][0];var f=r[l][1];if(f-i>e!=o-i>e&&(a-u)*(i-f)/(o-f)+u-n>e)s=!s;a=u;o=f}return s}};return t}t.exports=n},{}],286:[function(e,t,r){var n={toPolygon:function(e,t){function r(t){if(t.length<=0)return e.segments({inverted:false,regions:[]});function r(t){var r=t.slice(0,t.length-1);return e.segments({inverted:false,regions:[r]})}var n=r(t[0]);for(var i=1;i<t.length;i++)n=e.selectDifference(e.combine(n,r(t[i])));return n}if(t.type==="Polygon"){return e.polygon(r(t.coordinates))}else if(t.type==="MultiPolygon"){var n=e.segments({inverted:false,regions:[]});for(var i=0;i<t.coordinates.length;i++)n=e.selectUnion(e.combine(n,r(t.coordinates[i])));return e.polygon(n)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(e,t,r){r=e.polygon(e.segments(r));function n(e,r){return t.pointInsideRegion([(e[0][0]+e[1][0])*.5,(e[0][1]+e[1][1])*.5],r)}function i(e){return{region:e,children:[]}}var a=i(null);function o(e,t){for(var r=0;r<e.children.length;r++){var a=e.children[r];if(n(t,a.region)){o(a,t);return}}var s=i(t);for(var r=0;r<e.children.length;r++){var a=e.children[r];if(n(a.region,t)){s.children.push(a);e.children.splice(r,1);r--}}e.children.push(s)}for(var s=0;s<r.regions.length;s++){var l=r.regions[s];if(l.length<3)continue;o(a,l)}function u(e,t){var r=0;var n=e[e.length-1][0];var i=e[e.length-1][1];var a=[];for(var o=0;o<e.length;o++){var s=e[o][0];var l=e[o][1];a.push([s,l]);r+=l*n-s*i;n=s;i=l}var u=r<0;if(u!==t)a.reverse();a.push([a[0][0],a[0][1]]);return a}var f=[];function c(e){var t=[u(e.region,false)];f.push(t);for(var r=0;r<e.children.length;r++)t.push(h(e.children[r]))}function h(e){for(var t=0;t<e.children.length;t++)c(e.children[t]);return u(e.region,true)}for(var s=0;s<a.children.length;s++)c(a.children[s]);if(f.length<=0)return{type:"Polygon",coordinates:[]};if(f.length==1)return{type:"Polygon",coordinates:f[0]};return{type:"MultiPolygon",coordinates:f}}};t.exports=n},{}],287:[function(e,t,r){var n=e("./linked-list");function i(e,t,r){function i(e,t){return{id:r?r.segmentId():-1,start:e,end:t,myFill:{above:null,below:null},otherFill:null}}function a(e,t,n){return{id:r?r.segmentId():-1,start:e,end:t,myFill:{above:n.myFill.above,below:n.myFill.below},otherFill:null}}var o=n.create();function s(e,r,n,i,a,o){var s=t.pointsCompare(r,a);if(s!==0)return s;if(t.pointsSame(n,o))return 0;if(e!==i)return e?1:-1;return t.pointAboveOrOnLine(n,i?a:o,i?o:a)?1:-1}function l(e,t){o.insertBefore(e,function(r){var n=s(e.isStart,e.pt,t,r.isStart,r.pt,r.other.pt);return n<0})}function u(e,t){var r=n.node({isStart:true,pt:e.start,seg:e,primary:t,other:null,status:null});l(r,e.end);return r}function f(e,t,r){var i=n.node({isStart:false,pt:t.end,seg:t,primary:r,other:e,status:null});e.other=i;l(i,e.pt)}function c(e,t){var r=u(e,t);f(r,e,t);return r}function h(e,t){if(r)r.segmentChop(e.seg,t);e.other.remove();e.seg.end=t;e.other.pt=t;l(e.other,e.pt)}function v(e,t){var r=a(t,e.seg.end,e.seg);h(e,t);return c(r,e.primary)}function d(i,a){var s=n.create();function l(e,r){var n=e.seg.start;var i=e.seg.end;var a=r.seg.start;var o=r.seg.end;if(t.pointsCollinear(n,a,o)){if(t.pointsCollinear(i,a,o))return 1;return t.pointAboveOrOnLine(i,a,o)?1:-1}return t.pointAboveOrOnLine(n,a,o)?1:-1}function u(e){return s.findTransition(function(t){var r=l(e,t.ev);return r>0})}function f(e,n){var i=e.seg;var a=n.seg;var o=i.start;var s=i.end;var l=a.start;var u=a.end;if(r)r.checkIntersection(i,a);var f=t.linesIntersect(o,s,l,u);if(f===false){if(!t.pointsCollinear(o,s,l))return false;if(t.pointsSame(o,u)||t.pointsSame(s,l))return false;var c=t.pointsSame(o,l);var h=t.pointsSame(s,u);if(c&&h)return n;var d=!c&&t.pointBetween(o,l,u);var p=!h&&t.pointBetween(s,l,u);if(c){if(p){v(n,s)}else{v(e,u)}return n}else if(d){if(!h){if(p){v(n,s)}else{v(e,u)}}v(n,o)}}else{if(f.alongA===0){if(f.alongB===-1)v(e,l);else if(f.alongB===0)v(e,f.pt);else if(f.alongB===1)v(e,u)}if(f.alongB===0){if(f.alongA===-1)v(n,o);else if(f.alongA===0)v(n,f.pt);else if(f.alongA===1)v(n,s)}}return false}var c=[];while(!o.isEmpty()){var h=o.getHead();if(r)r.vert(h.pt[0]);if(h.isStart){if(r)r.segmentNew(h.seg,h.primary);var d=u(h);var p=d.before?d.before.ev:null;var g=d.after?d.after.ev:null;if(r){r.tempStatus(h.seg,p?p.seg:false,g?g.seg:false)}function m(){if(p){var e=f(h,p);if(e)return e}if(g)return f(h,g);return false}var y=m();if(y){if(e){var b;if(h.seg.myFill.below===null)b=true;else b=h.seg.myFill.above!==h.seg.myFill.below;if(b)y.seg.myFill.above=!y.seg.myFill.above}else{y.seg.otherFill=h.seg.myFill}if(r)r.segmentUpdate(y.seg);h.other.remove();h.remove()}if(o.getHead()!==h){if(r)r.rewind(h.seg);continue}if(e){var b;if(h.seg.myFill.below===null)b=true;else b=h.seg.myFill.above!==h.seg.myFill.below;if(!g){h.seg.myFill.below=i}else{h.seg.myFill.below=g.seg.myFill.above}if(b)h.seg.myFill.above=!h.seg.myFill.below;else h.seg.myFill.above=h.seg.myFill.below}else{if(h.seg.otherFill===null){var x;if(!g){x=h.primary?a:i}else{if(h.primary===g.primary)x=g.seg.otherFill.above;else x=g.seg.myFill.above}h.seg.otherFill={above:x,below:x}}}if(r){r.status(h.seg,p?p.seg:false,g?g.seg:false)}h.other.status=d.insert(n.node({ev:h}))}else{var _=h.status;if(_===null){throw new Error("PolyBool: Zero-length segment detected; your epsilon is "+"probably too small or too large")}if(s.exists(_.prev)&&s.exists(_.next))f(_.prev.ev,_.next.ev);if(r)r.statusRemove(_.ev.seg);_.remove();if(!h.primary){var w=h.seg.myFill;h.seg.myFill=h.seg.otherFill;h.seg.otherFill=w}c.push(h.seg)}o.getHead().remove()}if(r)r.done();return c}if(!e){return{calculate:function(e,t,r,n){e.forEach(function(e){c(a(e.start,e.end,e),true)});r.forEach(function(e){c(a(e.start,e.end,e),false)});return d(t,n)}}}return{addRegion:function(e){var r;var n=e[e.length-1];for(var a=0;a<e.length;a++){r=n;n=e[a];var o=t.pointsCompare(r,n);if(o===0)continue;c(i(o<0?r:n,o<0?n:r),true)}},calculate:function(e){return d(e,false)}}}t.exports=i},{"./linked-list":288}],288:[function(e,t,r){var n={create:function(){var e={root:{root:true,next:null},exists:function(t){if(t===null||t===e.root)return false;return true},isEmpty:function(){return e.root.next===null},getHead:function(){return e.root.next},insertBefore:function(t,r){var n=e.root;var i=e.root.next;while(i!==null){if(r(i)){t.prev=i.prev;t.next=i;i.prev.next=t;i.prev=t;return}n=i;i=i.next}n.next=t;t.prev=n;t.next=null},findTransition:function(t){var r=e.root;var n=e.root.next;while(n!==null){if(t(n))break;r=n;n=n.next}return{before:r===e.root?null:r,after:n,insert:function(e){e.prev=r;e.next=n;r.next=e;if(n!==null)n.prev=e;return e}}}};return e},node:function(e){e.prev=null;e.next=null;e.remove=function(){e.prev.next=e.next;if(e.next)e.next.prev=e.prev;e.prev=null;e.next=null};return e}};t.exports=n},{}],289:[function(e,t,r){function n(e,t,r){var n=[];var i=[];e.forEach(function(e){var a=e.start;var o=e.end;if(t.pointsSame(a,o)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is "+"probably too small or too large");return}if(r)r.chainStart(e);var s={index:0,matches_head:false,matches_pt1:false};var l={index:0,matches_head:false,matches_pt1:false};var u=s;function f(e,t,r){u.index=e;u.matches_head=t;u.matches_pt1=r;if(u===s){u=l;return false}u=null;return true}for(var c=0;c<n.length;c++){var h=n[c];var v=h[0];var d=h[1];var p=h[h.length-1];var g=h[h.length-2];if(t.pointsSame(v,a)){if(f(c,true,true))break}else if(t.pointsSame(v,o)){if(f(c,true,false))break}else if(t.pointsSame(p,a)){if(f(c,false,true))break}else if(t.pointsSame(p,o)){if(f(c,false,false))break}}if(u===s){n.push([a,o]);if(r)r.chainNew(a,o);return}if(u===l){if(r)r.chainMatch(s.index);var m=s.index;var y=s.matches_pt1?o:a;var b=s.matches_head;var h=n[m];var x=b?h[0]:h[h.length-1];var _=b?h[1]:h[h.length-2];var w=b?h[h.length-1]:h[0];var M=b?h[h.length-2]:h[1];if(t.pointsCollinear(_,x,y)){if(b){if(r)r.chainRemoveHead(s.index,y);h.shift()}else{if(r)r.chainRemoveTail(s.index,y);h.pop()}x=_}if(t.pointsSame(w,y)){n.splice(m,1);if(t.pointsCollinear(M,w,x)){if(b){if(r)r.chainRemoveTail(s.index,x);h.pop()}else{if(r)r.chainRemoveHead(s.index,x);h.shift()}}if(r)r.chainClose(s.index);i.push(h);return}if(b){if(r)r.chainAddHead(s.index,y);h.unshift(y)}else{if(r)r.chainAddTail(s.index,y);h.push(y)}return}function A(e){if(r)r.chainReverse(e);n[e].reverse()}function T(e,i){var a=n[e];var o=n[i];var s=a[a.length-1];var l=a[a.length-2];var u=o[0];var f=o[1];if(t.pointsCollinear(l,s,u)){if(r)r.chainRemoveTail(e,s);a.pop();s=l}if(t.pointsCollinear(s,u,f)){if(r)r.chainRemoveHead(i,u);o.shift()}if(r)r.chainJoin(e,i);n[e]=a.concat(o);n.splice(i,1)}var k=s.index;var E=l.index;if(r)r.chainConnect(k,E);var S=n[k].length<n[E].length;if(s.matches_head){if(l.matches_head){if(S){A(k);T(k,E)}else{A(E);T(E,k)}}else{T(E,k)}}else{if(l.matches_head){T(k,E)}else{if(S){A(k);T(E,k)}else{A(E);T(k,E)}}}});return i}t.exports=n},{}],290:[function(e,t,r){function n(e,t,r){var n=[];e.forEach(function(e){var i=(e.myFill.above?8:0)+(e.myFill.below?4:0)+(e.otherFill&&e.otherFill.above?2:0)+(e.otherFill&&e.otherFill.below?1:0);if(t[i]!==0){n.push({id:r?r.segmentId():-1,start:e.start,end:e.end,myFill:{above:t[i]===1,below:t[i]===2},otherFill:null})}});if(r)r.selected(n);return n}var i={union:function(e,t){return n(e,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],t)},intersect:function(e,t){return n(e,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],t)},difference:function(e,t){return n(e,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],t)},differenceRev:function(e,t){return n(e,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],t)},xor:function(e,t){return n(e,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],t)}};t.exports=i},{}],291:[function(e,t,r){"use strict";var n=new Float64Array(4);var i=new Float64Array(4);var a=new Float64Array(4);function o(e,t,r,o,s){if(n.length<o.length){n=new Float64Array(o.length);i=new Float64Array(o.length);a=new Float64Array(o.length)}for(var l=0;l<o.length;++l){n[l]=e[l]-o[l];i[l]=t[l]-e[l];a[l]=r[l]-e[l]}var u=0,f=0,c=0,h=0,v=0,d=0;for(var l=0;l<o.length;++l){var p=i[l],g=a[l],m=n[l];u+=p*p;f+=p*g;c+=g*g;h+=m*p;v+=m*g;d+=m*m}var y=Math.abs(u*c-f*f);var b=f*v-c*h;var x=f*h-u*v;var _;if(b+x<=y){if(b<0){if(x<0){if(h<0){x=0;if(-h>=u){b=1;_=u+2*h+d}else{b=-h/u;_=h*b+d}}else{b=0;if(v>=0){x=0;_=d}else if(-v>=c){x=1;_=c+2*v+d}else{x=-v/c;_=v*x+d}}}else{b=0;if(v>=0){x=0;_=d}else if(-v>=c){x=1;_=c+2*v+d}else{x=-v/c;_=v*x+d}}}else if(x<0){x=0;if(h>=0){b=0;_=d}else if(-h>=u){b=1;_=u+2*h+d}else{b=-h/u;_=h*b+d}}else{var w=1/y;b*=w;x*=w;_=b*(u*b+f*x+2*h)+x*(f*b+c*x+2*v)+d}}else{var M,A,T,k;if(b<0){M=f+h;A=c+v;if(A>M){T=A-M;k=u-2*f+c;if(T>=k){b=1;x=0;_=u+2*h+d}else{b=T/k;x=1-b;_=b*(u*b+f*x+2*h)+x*(f*b+c*x+2*v)+d}}else{b=0;if(A<=0){x=1;_=c+2*v+d}else if(v>=0){x=0;_=d}else{x=-v/c;_=v*x+d}}}else if(x<0){M=f+v;A=u+h;if(A>M){T=A-M;k=u-2*f+c;if(T>=k){x=1;b=0;_=c+2*v+d}else{x=T/k;b=1-x;_=b*(u*b+f*x+2*h)+x*(f*b+c*x+2*v)+d}}else{x=0;if(A<=0){b=1;_=u+2*h+d}else if(h>=0){b=0;_=d}else{b=-h/u;_=h*b+d}}}else{T=c+v-f-h;if(T<=0){b=0;x=1;_=c+2*v+d}else{k=u-2*f+c;if(T>=k){b=1;x=0;_=u+2*h+d}else{b=T/k;x=1-b;_=b*(u*b+f*x+2*h)+x*(f*b+c*x+2*v)+d}}}}var E=1-b-x;for(var l=0;l<o.length;++l){s[l]=E*e[l]+b*t[l]+x*r[l]}if(_<0){return 0}return _}t.exports=o},{}],292:[function(e,t,r){var n=t.exports={};var i;var a;function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){i=setTimeout}else{i=o}}catch(e){i=o}try{if(typeof clearTimeout==="function"){a=clearTimeout}else{a=s}}catch(e){a=s}})();function l(e){if(i===setTimeout){return setTimeout(e,0)}if((i===o||!i)&&setTimeout){i=setTimeout;return setTimeout(e,0)}try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}function u(e){if(a===clearTimeout){return clearTimeout(e)}if((a===s||!a)&&clearTimeout){a=clearTimeout;return clearTimeout(e)}try{return a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}var f=[];var c=false;var h;var v=-1;function d(){if(!c||!h){return}c=false;if(h.length){f=h.concat(f)}else{v=-1}if(f.length){p()}}function p(){if(c){return}var e=l(d);c=true;var t=f.length;while(t){h=f;f=[];while(++v<t){if(h){h[v].run()}}v=-1;t=f.length}h=null;c=false;u(e)}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}f.push(new g(e,t));if(f.length===1&&!c){l(p)}};function g(e,t){this.fun=e;this.array=t}g.prototype.run=function(){this.fun.apply(null,this.array)};n.title="browser";n.browser=true;n.env={};n.argv=[];n.version="";n.versions={};function m(){}n.on=m;n.addListener=m;n.once=m;n.off=m;n.removeListener=m;n.removeAllListeners=m;n.emit=m;n.prependListener=m;n.prependOnceListener=m;n.listeners=function(e){return[]};n.binding=function(e){throw new Error("process.binding is not supported")};n.cwd=function(){return"/"};n.chdir=function(e){throw new Error("process.chdir is not supported")};n.umask=function(){return 0}},{}],293:[function(e,t,r){t.exports=e("gl-quat/slerp")},{"gl-quat/slerp":142}],294:[function(e,t,r){"use strict";var n=e("big-rat/add");t.exports=i;function i(e,t){var r=e.length;var i=new Array(r);for(var a=0;a<r;++a){i[a]=n(e[a],t[a])}return i}},{"big-rat/add":20}],295:[function(e,t,r){"use strict";t.exports=i;var n=e("big-rat");function i(e){var t=new Array(e.length);for(var r=0;r<e.length;++r){t[r]=n(e[r])}return t}},{"big-rat":23}],296:[function(e,t,r){"use strict";var n=e("big-rat");var i=e("big-rat/mul");t.exports=a;function a(e,t){var r=n(t);var a=e.length;var o=new Array(a);for(var s=0;s<a;++s){o[s]=i(e[s],r)}return o}},{"big-rat":23,"big-rat/mul":32}],297:[function(e,t,r){"use strict";var n=e("big-rat/sub");t.exports=i;function i(e,t){var r=e.length;var i=new Array(r);for(var a=0;a<r;++a){i[a]=n(e[a],t[a])}return i}},{"big-rat/sub":34}],298:[function(e,t,r){"use strict";var n=e("compare-cell");var i=e("compare-oriented-cell");var a=e("cell-orientation");t.exports=o;function o(e){e.sort(i);var t=e.length;var r=0;for(var o=0;o<t;++o){var s=e[o];var l=a(s);if(l===0){continue}if(r>0){var u=e[r-1];if(n(s,u)===0&&a(u)!==l){r-=1;continue}}e[r++]=s}e.length=r;return e}},{"cell-orientation":55,"compare-cell":70,"compare-oriented-cell":71}],299:[function(e,t,r){"use strict";var n="";var i;t.exports=a;function a(e,t){if(typeof e!=="string"){throw new TypeError("expected a string")}if(t===1)return e;if(t===2)return e+e;var r=e.length*t;if(i!==e||typeof i==="undefined"){i=e;n=""}else if(n.length>=r){return n.substr(0,r)}while(r>n.length&&t>1){if(t&1){n+=e}t>>=1;e+=e}n+=e;n=n.substr(0,r);return n}},{}],300:[function(e,t,r){(function(e){t.exports=e.performance&&e.performance.now?function e(){return performance.now()}:Date.now||function e(){return+new Date}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],301:[function(e,t,r){"use strict";t.exports=n;function n(e){var t=e.length;var r=e[e.length-1];var n=t;for(var i=t-2;i>=0;--i){var a=r;var o=e[i];r=a+o;var s=r-a;var l=o-s;if(l){e[--n]=r;r=l}}var u=0;for(var i=n;i<t;++i){var a=e[i];var o=r;r=a+o;var s=r-a;var l=o-s;if(l){e[u++]=l}}e[u++]=r;e.length=u;return e}},{}],302:[function(e,t,r){"use strict";var n=e("two-product");var i=e("robust-sum");var a=e("robust-scale");var o=e("robust-compress");var s=6;function l(e,t){var r=new Array(e.length-1);for(var n=1;n<e.length;++n){var i=r[n-1]=new Array(e.length-1);for(var a=0,o=0;a<e.length;++a){if(a===t){continue}i[o++]=e[n][a]}}return r}function u(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=new Array(e);for(var n=0;n<e;++n){t[r][n]=["m[",r,"][",n,"]"].join("")}}return t}function f(e){if(e&1){return"-"}return""}function c(e){if(e.length===1){return e[0]}else if(e.length===2){return["sum(",e[0],",",e[1],")"].join("")}else{var t=e.length>>1;return["sum(",c(e.slice(0,t)),",",c(e.slice(t)),")"].join("")}}function h(e){if(e.length===2){return["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")}else{var t=[];for(var r=0;r<e.length;++r){t.push(["scale(",h(l(e,r)),",",f(r),e[0][r],")"].join(""))}return c(t)}}function v(e){var t=new Function("sum","scale","prod","compress",["function robustDeterminant",e,"(m){return compress(",h(u(e)),")};return robustDeterminant",e].join(""));return t(i,a,n,o)}var d=[function e(){return[0]},function e(t){return[t[0][0]]}];function p(){while(d.length<s){d.push(v(d.length))}var e=[];var r=["function robustDeterminant(m){switch(m.length){"];for(var n=0;n<s;++n){e.push("det"+n);r.push("case ",n,":return det",n,"(m);")}r.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant");e.push("CACHE","gen",r.join(""));var i=Function.apply(undefined,e);t.exports=i.apply(undefined,d.concat([d,v]));for(var n=0;n<d.length;++n){t.exports[n]=d[n]}}p()},{"robust-compress":301,"robust-scale":308,"robust-sum":311,"two-product":331}],303:[function(e,t,r){"use strict";var n=e("two-product");var i=e("robust-sum");t.exports=a;function a(e,t){var r=n(e[0],t[0]);for(var a=1;a<e.length;++a){r=i(r,n(e[a],t[a]))}return r}},{"robust-sum":311,"two-product":331}],304:[function(e,t,r){"use strict";var n=e("two-product");var i=e("robust-sum");var a=e("robust-subtract");var o=e("robust-scale");var s=6;function l(e,t){var r=new Array(e.length-1);for(var n=1;n<e.length;++n){var i=r[n-1]=new Array(e.length-1);for(var a=0,o=0;a<e.length;++a){if(a===t){continue}i[o++]=e[n][a]}}return r}function u(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=new Array(e);for(var n=0;n<e;++n){t[r][n]=["m",n,"[",e-r-2,"]"].join("")}}return t}function f(e){if(e.length===1){return e[0]}else if(e.length===2){return["sum(",e[0],",",e[1],")"].join("")}else{var t=e.length>>1;return["sum(",f(e.slice(0,t)),",",f(e.slice(t)),")"].join("")}}function c(e,t){if(e.charAt(0)==="m"){if(t.charAt(0)==="w"){var r=e.split("[");return["w",t.substr(1),"m",r[0].substr(1)].join("")}else{return["prod(",e,",",t,")"].join("")}}else{return c(t,e)}}function h(e){if(e&1!==0){return"-"}return""}function v(e){if(e.length===2){return[["diff(",c(e[0][0],e[1][1]),",",c(e[1][0],e[0][1]),")"].join("")]}else{var t=[];for(var r=0;r<e.length;++r){t.push(["scale(",f(v(l(e,r))),",",h(r),e[0][r],")"].join(""))}return t}}function d(e,t){var r=[];for(var n=0;n<t-2;++n){r.push(["prod(m",e,"[",n,"],m",e,"[",n,"])"].join(""))}return f(r)}function p(e){var t=[];var r=[];var s=u(e);for(var c=0;c<e;++c){s[0][c]="1";s[e-1][c]="w"+c}for(var c=0;c<e;++c){if((c&1)===0){t.push.apply(t,v(l(s,c)))}else{r.push.apply(r,v(l(s,c)))}}var h=f(t);var p=f(r);var g="exactInSphere"+e;var m=[];for(var c=0;c<e;++c){m.push("m"+c)}var y=["function ",g,"(",m.join(),"){"];for(var c=0;c<e;++c){y.push("var w",c,"=",d(c,e),";");for(var b=0;b<e;++b){if(b!==c){y.push("var w",c,"m",b,"=scale(w",c,",m",b,"[0]);")}}}y.push("var p=",h,",n=",p,",d=diff(p,n);return d[d.length-1];}return ",g);var x=new Function("sum","diff","prod","scale",y.join(""));return x(i,a,n,o)}function g(){return 0}function m(){return 0}function y(){return 0}var b=[g,m,y];function x(e){var t=b[e.length];if(!t){t=b[e.length]=p(e.length)}return t.apply(undefined,e)}function _(){while(b.length<=s){b.push(p(b.length))}var e=[];var r=["slow"];for(var n=0;n<=s;++n){e.push("a"+n);r.push("o"+n)}var i=["function testInSphere(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(var n=2;n<=s;++n){i.push("case ",n,":return o",n,"(",e.slice(0,n).join(),");")}i.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere");r.push(i.join(""));var a=Function.apply(undefined,r);t.exports=a.apply(undefined,[x].concat(b));for(var n=0;n<=s;++n){t.exports[n]=b[n]}}_()},{"robust-scale":308,"robust-subtract":310,"robust-sum":311,"two-product":331}],305:[function(e,t,r){"use strict";var n=e("robust-determinant");var i=6;function a(e){var t="robustLinearSolve"+e+"d";var r=["function ",t,"(A,b){return ["];for(var i=0;i<e;++i){r.push("det([");for(var a=0;a<e;++a){if(a>0){r.push(",")}r.push("[");for(var o=0;o<e;++o){if(o>0){r.push(",")}if(o===i){r.push("+b[",a,"]")}else{r.push("+A[",a,"][",o,"]")}}r.push("]")}r.push("]),")}r.push("det(A)]}return ",t);var s=new Function("det",r.join(""));if(e<6){return s(n[e])}return s(n)}function o(){return[0]}function s(e,t){return[[t[0]],[e[0][0]]]}var l=[o,s];function u(){while(l.length<i){l.push(a(l.length))}var e=[];var r=["function dispatchLinearSolve(A,b){switch(A.length){"];for(var n=0;n<i;++n){e.push("s"+n);r.push("case ",n,":return s",n,"(A,b);")}r.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve");e.push("CACHE","g",r.join(""));var o=Function.apply(undefined,e);t.exports=o.apply(undefined,l.concat([l,a]));for(var n=0;n<i;++n){t.exports[n]=l[n]}}u()},{"robust-determinant":302}],306:[function(e,t,r){"use strict";var n=e("two-product");var i=e("robust-sum");var a=e("robust-scale");var o=e("robust-subtract");var s=5;var l=1.1102230246251565e-16;var u=(3+16*l)*l;var f=(7+56*l)*l;function c(e,t){var r=new Array(e.length-1);for(var n=1;n<e.length;++n){var i=r[n-1]=new Array(e.length-1);for(var a=0,o=0;a<e.length;++a){if(a===t){continue}i[o++]=e[n][a]}}return r}function h(e){var t=new Array(e);for(var r=0;r<e;++r){t[r]=new Array(e);for(var n=0;n<e;++n){t[r][n]=["m",n,"[",e-r-1,"]"].join("")}}return t}function v(e){if(e&1){return"-"}return""}function d(e){if(e.length===1){return e[0]}else if(e.length===2){return["sum(",e[0],",",e[1],")"].join("")}else{var t=e.length>>1;return["sum(",d(e.slice(0,t)),",",d(e.slice(t)),")"].join("")}}function p(e){if(e.length===2){return[["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")]}else{var t=[];for(var r=0;r<e.length;++r){t.push(["scale(",d(p(c(e,r))),",",v(r),e[0][r],")"].join(""))}return t}}function g(e){var t=[];var r=[];var s=h(e);var l=[];for(var u=0;u<e;++u){if((u&1)===0){t.push.apply(t,p(c(s,u)))}else{r.push.apply(r,p(c(s,u)))}l.push("m"+u)}var f=d(t);var v=d(r);var g="orientation"+e+"Exact";var m=["function ",g,"(",l.join(),"){var p=",f,",n=",v,",d=sub(p,n);return d[d.length-1];};return ",g].join("");var y=new Function("sum","prod","scale","sub",m);return y(i,n,a,o)}var m=g(3);var y=g(4);var b=[function e(){return 0},function e(){return 0},function e(t,r){return r[0]-t[0]},function e(t,r,n){var i=(t[1]-n[1])*(r[0]-n[0]);var a=(t[0]-n[0])*(r[1]-n[1]);var o=i-a;var s;if(i>0){if(a<=0){return o}else{s=i+a}}else if(i<0){if(a>=0){return o}else{s=-(i+a)}}else{return o}var l=u*s;if(o>=l||o<=-l){return o}return m(t,r,n)},function e(t,r,n,i){var a=t[0]-i[0];var o=r[0]-i[0];var s=n[0]-i[0];var l=t[1]-i[1];var u=r[1]-i[1];var c=n[1]-i[1];var h=t[2]-i[2];var v=r[2]-i[2];var d=n[2]-i[2];var p=o*c;var g=s*u;var m=s*l;var b=a*c;var x=a*u;var _=o*l;var w=h*(p-g)+v*(m-b)+d*(x-_);var M=(Math.abs(p)+Math.abs(g))*Math.abs(h)+(Math.abs(m)+Math.abs(b))*Math.abs(v)+(Math.abs(x)+Math.abs(_))*Math.abs(d);var A=f*M;if(w>A||-w>A){return w}return y(t,r,n,i)}];function x(e){var t=b[e.length];if(!t){t=b[e.length]=g(e.length)}return t.apply(undefined,e)}function _(){while(b.length<=s){b.push(g(b.length))}var e=[];var r=["slow"];for(var n=0;n<=s;++n){e.push("a"+n);r.push("o"+n)}var i=["function getOrientation(",e.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(var n=2;n<=s;++n){i.push("case ",n,":return o",n,"(",e.slice(0,n).join(),");")}i.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation");r.push(i.join(""));var a=Function.apply(undefined,r);t.exports=a.apply(undefined,[x].concat(b));for(var n=0;n<=s;++n){t.exports[n]=b[n]}}_()},{"robust-scale":308,"robust-subtract":310,"robust-sum":311,"two-product":331}],307:[function(e,t,r){"use strict";var n=e("robust-sum");var i=e("robust-scale");t.exports=a;function a(e,t){if(e.length===1){return i(t,e[0])}if(t.length===1){return i(e,t[0])}if(e.length===0||t.length===0){return[0]}var r=[0];if(e.length<t.length){for(var a=0;a<e.length;++a){r=n(r,i(t,e[a]))}}else{for(var a=0;a<t.length;++a){r=n(r,i(e,t[a]))}}return r}},{"robust-scale":308,"robust-sum":311}],308:[function(e,t,r){"use strict";var n=e("two-product");var i=e("two-sum");t.exports=a;function a(e,t){var r=e.length;if(r===1){var a=n(e[0],t);if(a[0]){return a}return[a[1]]}var o=new Array(2*r);var s=[.1,.1];var l=[.1,.1];var u=0;n(e[0],t,s);if(s[0]){o[u++]=s[0]}for(var f=1;f<r;++f){n(e[f],t,l);var c=s[1];i(c,l[0],s);if(s[0]){o[u++]=s[0]}var h=l[1];var v=s[1];var d=h+v;var p=d-h;var g=v-p;s[1]=d;if(g){o[u++]=g}}if(s[1]){o[u++]=s[1]}if(u===0){o[u++]=0}o.length=u;return o}},{"two-product":331,"two-sum":332}],309:[function(e,t,r){"use strict";t.exports=a;var n=e("robust-orientation")[3];function i(e,t,r,n){for(var i=0;i<2;++i){var a=e[i];var o=t[i];var s=Math.min(a,o);var l=Math.max(a,o);var u=r[i];var f=n[i];var c=Math.min(u,f);var h=Math.max(u,f);if(h<s||l<c){return false}}return true}function a(e,t,r,a){var o=n(e,r,a);var s=n(t,r,a);if(o>0&&s>0||o<0&&s<0){return false}var l=n(r,e,t);var u=n(a,e,t);if(l>0&&u>0||l<0&&u<0){return false}if(o===0&&s===0&&l===0&&u===0){return i(e,t,r,a)}return true}},{"robust-orientation":306}],310:[function(e,t,r){"use strict";t.exports=i;function n(e,t){var r=e+t;var n=r-e;var i=r-n;var a=t-n;var o=e-i;var s=o+a;if(s){return[s,r]}return[r]}function i(e,t){var r=e.length|0;var i=t.length|0;if(r===1&&i===1){return n(e[0],-t[0])}var a=r+i;var o=new Array(a);var s=0;var l=0;var u=0;var f=Math.abs;var c=e[l];var h=f(c);var v=-t[u];var d=f(v);var p,g;if(h<d){g=c;l+=1;if(l<r){c=e[l];h=f(c)}}else{g=v;u+=1;if(u<i){v=-t[u];d=f(v)}}if(l<r&&h<d||u>=i){p=c;l+=1;if(l<r){c=e[l];h=f(c)}}else{p=v;u+=1;if(u<i){v=-t[u];d=f(v)}}var m=p+g;var y=m-p;var b=g-y;var x=b;var _=m;var w,M,A,T,k;while(l<r&&u<i){if(h<d){p=c;l+=1;if(l<r){c=e[l];h=f(c)}}else{p=v;u+=1;if(u<i){v=-t[u];d=f(v)}}g=x;m=p+g;y=m-p;b=g-y;if(b){o[s++]=b}w=_+m;M=w-_;A=w-M;T=m-M;k=_-A;x=k+T;_=w}while(l<r){p=c;g=x;m=p+g;y=m-p;b=g-y;if(b){o[s++]=b}w=_+m;M=w-_;A=w-M;T=m-M;k=_-A;x=k+T;_=w;l+=1;if(l<r){c=e[l]}}while(u<i){p=v;g=x;m=p+g;y=m-p;b=g-y;if(b){o[s++]=b}w=_+m;M=w-_;A=w-M;T=m-M;k=_-A;x=k+T;_=w;u+=1;if(u<i){v=-t[u]}}if(x){o[s++]=x}if(_){o[s++]=_}if(!s){o[s++]=0}o.length=s;return o}},{}],311:[function(e,t,r){"use strict";t.exports=i;function n(e,t){var r=e+t;var n=r-e;var i=r-n;var a=t-n;var o=e-i;var s=o+a;if(s){return[s,r]}return[r]}function i(e,t){var r=e.length|0;var i=t.length|0;if(r===1&&i===1){return n(e[0],t[0])}var a=r+i;var o=new Array(a);var s=0;var l=0;var u=0;var f=Math.abs;var c=e[l];var h=f(c);var v=t[u];var d=f(v);var p,g;if(h<d){g=c;l+=1;if(l<r){c=e[l];h=f(c)}}else{g=v;u+=1;if(u<i){v=t[u];d=f(v)}}if(l<r&&h<d||u>=i){p=c;l+=1;if(l<r){c=e[l];h=f(c)}}else{p=v;u+=1;if(u<i){v=t[u];d=f(v)}}var m=p+g;var y=m-p;var b=g-y;var x=b;var _=m;var w,M,A,T,k;while(l<r&&u<i){if(h<d){p=c;l+=1;if(l<r){c=e[l];h=f(c)}}else{p=v;u+=1;if(u<i){v=t[u];d=f(v)}}g=x;m=p+g;y=m-p;b=g-y;if(b){o[s++]=b}w=_+m;M=w-_;A=w-M;T=m-M;k=_-A;x=k+T;_=w}while(l<r){p=c;g=x;m=p+g;y=m-p;b=g-y;if(b){o[s++]=b}w=_+m;M=w-_;A=w-M;T=m-M;k=_-A;x=k+T;_=w;l+=1;if(l<r){c=e[l]}}while(u<i){p=v;g=x;m=p+g;y=m-p;b=g-y;if(b){o[s++]=b}w=_+m;M=w-_;A=w-M;T=m-M;k=_-A;x=k+T;_=w;u+=1;if(u<i){v=t[u]}}if(x){o[s++]=x}if(_){o[s++]=_}if(!s){o[s++]=0}o.length=s;return o}},{}],312:[function(e,t,r){"use strict";t.exports=function e(t){if(t<0){return-1}if(t>0){return 1}return 0}},{}],313:[function(e,t,r){"use strict";t.exports=a;var n=e("boundary-cells");var i=e("reduce-simplicial-complex");function a(e){return i(n(e))}},{"boundary-cells":39,"reduce-simplicial-complex":298}],314:[function(e,t,r){"use strict";t.exports=v;var n=e("ndarray");var i=e("typedarray-pool");var a=e("ndarray-sort");var o=e("./lib/codegen");function s(e){var t=e.length;var r=0;for(var n=0;n<t;++n){r=Math.max(r,e[n].length)|0}return r-1}function l(e,t){var r=e.length;var n=i.mallocUint8(r);for(var a=0;a<r;++a){n[a]=e[a]<t|0}return n}function u(e,t){var r=e.length;var o=t*(t+1)/2*r|0;var s=i.mallocUint32(o*2);var l=0;for(var u=0;u<r;++u){var f=e[u];var t=f.length;for(var c=0;c<t;++c){for(var h=0;h<c;++h){var v=f[h];var d=f[c];s[l++]=Math.min(v,d)|0;s[l++]=Math.max(v,d)|0}}}var p=l/2|0;a(n(s,[p,2]));var g=2;for(var u=2;u<l;u+=2){if(s[u-2]===s[u]&&s[u-1]===s[u+1]){continue}s[g++]=s[u];s[g++]=s[u+1]}return n(s,[g/2|0,2])}function f(e,t,r,a){var o=e.data;var s=e.shape[0];var l=i.mallocDouble(s);var u=0;for(var f=0;f<s;++f){var c=o[2*f];var h=o[2*f+1];if(r[c]===r[h]){continue}var v=t[c];var d=t[h];o[2*u]=c;o[2*u+1]=h;l[u++]=(d-a)/(d-v)}e.shape[0]=u;return n(l,[u])}function c(e,t){var r=i.mallocInt32(t*2);var n=e.shape[0];var a=e.data;r[0]=0;var o=0;for(var s=0;s<n;++s){var l=a[2*s];if(l!==o){r[2*o+1]=s;while(++o<l){r[2*o]=s;r[2*o+1]=s}r[2*o]=s}}r[2*o+1]=n;while(++o<t){r[2*o]=r[2*o+1]=n}return r}function h(e){var t=e.shape[0]|0;var r=e.data;var n=new Array(t);for(var i=0;i<t;++i){n[i]=[r[2*i],r[2*i+1]]}return n}function v(e,t,r,n){r=r||0;if(typeof n==="undefined"){n=s(e)}var a=e.length;if(a===0||n<1){return{cells:[],vertexIds:[],vertexWeights:[]}}var v=l(t,+r);var d=u(e,n);var p=f(d,t,v,+r);var g=c(d,t.length|0);var m=o(n)(e,d.data,g,v);var y=h(d);var b=[].slice.call(p.data,0,p.shape[0]);i.free(v);i.free(d.data);i.free(p.data);i.free(g);return{cells:m,vertexIds:y,vertexWeights:b}}},{"./lib/codegen":315,ndarray:270,"ndarray-sort":268,"typedarray-pool":333}],315:[function(e,t,r){"use strict";t.exports=s;var n=e("typedarray-pool");var i=e("marching-simplex-table");var a={};function o(e){var t=0;var r=new Array(e+1);r[0]=[[]];for(var a=1;a<=e;++a){var o=r[a]=i(a);for(var s=0;s<o.length;++s){t=Math.max(t,o[a].length)}}var l=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",e,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"];function u(e){if(e.length<=0){return}l.push("R.push(");for(var t=0;t<e.length;++t){var r=e[t];if(t>0){l.push(",")}l.push("[");for(var n=0;n<r.length;++n){var i=r[n];if(n>0){l.push(",")}l.push("B(C,E,c[",i[0],"],c[",i[1],"])")}l.push("]")}l.push(");")}for(var a=e+1;a>1;--a){if(a<e+1){l.push("else ")}l.push("if(l===",a,"){");var f=[];for(var s=0;s<a;++s){f.push("(S[c["+s+"]]<<"+s+")")}l.push("var M=",f.join("+"),";if(M===0||M===",(1<<a)-1,"){continue}switch(M){");var o=r[a-1];for(var s=0;s<o.length;++s){l.push("case ",s,":");u(o[s]);l.push("break;")}l.push("}}")}l.push("}return R;};return getContour",e,"d");var c=new Function("pool",l.join(""));return c(n)}function s(e){var t=a[e];if(!t){t=a[e]=o(e)}return t}},{"marching-simplex-table":248,"typedarray-pool":333}],316:[function(e,t,r){"use strict";"use restrict";var n=e("bit-twiddle"),i=e("union-find");function a(e){var t=0,r=Math.max;for(var n=0,i=e.length;n<i;++n){t=r(t,e[n].length)}return t-1}r.dimension=a;function o(e){var t=-1,r=Math.max;for(var n=0,i=e.length;n<i;++n){var a=e[n];for(var o=0,s=a.length;o<s;++o){t=r(t,a[o])}}return t+1}r.countVertices=o;function s(e){var t=new Array(e.length);for(var r=0,n=e.length;r<n;++r){t[r]=e[r].slice(0)}return t}r.cloneCells=s;function l(e,t){var r=e.length,n=e.length-t.length,i=Math.min;if(n){return n}switch(r){case 0:return 0;case 1:return e[0]-t[0];case 2:var a=e[0]+e[1]-t[0]-t[1];if(a){return a}return i(e[0],e[1])-i(t[0],t[1]);case 3:var o=e[0]+e[1],s=t[0]+t[1];a=o+e[2]-(s+t[2]);if(a){return a}var l=i(e[0],e[1]),u=i(t[0],t[1]),a=i(l,e[2])-i(u,t[2]);if(a){return a}return i(l+e[2],o)-i(u+t[2],s);default:var f=e.slice(0);f.sort();var c=t.slice(0);c.sort();for(var h=0;h<r;++h){n=f[h]-c[h];if(n){return n}}return 0}}r.compareCells=l;function u(e,t){return l(e[0],t[0])}function f(e,t){if(t){var r=e.length;var n=new Array(r);for(var i=0;i<r;++i){n[i]=[e[i],t[i]]}n.sort(u);for(var i=0;i<r;++i){e[i]=n[i][0];t[i]=n[i][1]}return e}else{e.sort(l);return e}}r.normalize=f;function c(e){if(e.length===0){return[]}var t=1,r=e.length;for(var n=1;n<r;++n){var i=e[n];if(l(i,e[n-1])){if(n===t){t++;continue}e[t++]=i}}e.length=t;return e}r.unique=c;function h(e,t){var r=0,n=e.length-1,i=-1;while(r<=n){var a=r+n>>1,o=l(e[a],t);if(o<=0){if(o===0){i=a}r=a+1}else if(o>0){n=a-1}}return i}r.findCell=h;function v(e,t){var r=new Array(e.length);for(var i=0,a=r.length;i<a;++i){r[i]=[]}var o=[];for(var i=0,s=t.length;i<s;++i){var u=t[i];var f=u.length;for(var c=1,v=1<<f;c<v;++c){o.length=n.popCount(c);var d=0;for(var p=0;p<f;++p){if(c&1<<p){o[d++]=u[p]}}var g=h(e,o);if(g<0){continue}while(true){r[g++].push(i);if(g>=e.length||l(e[g],o)!==0){break}}}}return r}r.incidence=v;function d(e,t){if(!t){return v(c(g(e,0)),e,0)}var r=new Array(t);for(var n=0;n<t;++n){r[n]=[]}for(var n=0,i=e.length;n<i;++n){var a=e[n];for(var o=0,s=a.length;o<s;++o){r[a[o]].push(n)}}return r}r.dual=d;function p(e){var t=[];for(var r=0,n=e.length;r<n;++r){var i=e[r],a=i.length|0;for(var o=1,s=1<<a;o<s;++o){var l=[];for(var u=0;u<a;++u){if(o>>>u&1){l.push(i[u])}}t.push(l)}}return f(t)}r.explode=p;function g(e,t){if(t<0){return[]}var r=[],i=(1<<t+1)-1;for(var a=0;a<e.length;++a){var o=e[a];for(var s=i;s<1<<o.length;s=n.nextCombination(s)){var l=new Array(t+1),u=0;for(var c=0;c<o.length;++c){if(s&1<<c){l[u++]=o[c]}}r.push(l)}}return f(r)}r.skeleton=g;function m(e){var t=[];for(var r=0,n=e.length;r<n;++r){var i=e[r];for(var a=0,o=i.length;a<o;++a){var s=new Array(i.length-1);for(var l=0,u=0;l<o;++l){if(l!==a){s[u++]=i[l]}}t.push(s)}}return f(t)}r.boundary=m;function y(e,t){var r=new i(t);for(var n=0;n<e.length;++n){var a=e[n];for(var o=0;o<a.length;++o){for(var s=o+1;s<a.length;++s){r.link(a[o],a[s])}}}var l=[],u=r.ranks;for(var n=0;n<u.length;++n){u[n]=-1}for(var n=0;n<e.length;++n){var f=r.find(e[n][0]);if(u[f]<0){u[f]=l.length;l.push([e[n].slice(0)])}else{l[u[f]].push(e[n].slice(0))}}return l}function b(e){var t=c(f(g(e,0))),r=new i(t.length);for(var n=0;n<e.length;++n){var a=e[n];for(var o=0;o<a.length;++o){var s=h(t,[a[o]]);for(var l=o+1;l<a.length;++l){r.link(s,h(t,[a[l]]))}}}var u=[],v=r.ranks;for(var n=0;n<v.length;++n){v[n]=-1}for(var n=0;n<e.length;++n){var d=r.find(h(t,[e[n][0]]));if(v[d]<0){v[d]=u.length;u.push([e[n].slice(0)])}else{u[v[d]].push(e[n].slice(0))}}return u}function x(e,t){if(t){return y(e,t)}return b(e)}r.connectedComponents=x},{"bit-twiddle":37,"union-find":334}],317:[function(e,t,r){arguments[4][37][0].apply(r,arguments)},{dup:37}],318:[function(e,t,r){arguments[4][316][0].apply(r,arguments)},{"bit-twiddle":317,dup:316,"union-find":319}],319:[function(e,t,r){"use strict";"use restrict";t.exports=n;function n(e){this.roots=new Array(e);this.ranks=new Array(e);for(var t=0;t<e;++t){this.roots[t]=t;this.ranks[t]=0}}n.prototype.length=function(){return this.roots.length};n.prototype.makeSet=function(){var e=this.roots.length;this.roots.push(e);this.ranks.push(0);return e};n.prototype.find=function(e){var t=this.roots;while(t[e]!==e){var r=t[e];t[e]=t[r];e=r}return e};n.prototype.link=function(e,t){var r=this.find(e),n=this.find(t);if(r===n){return}var i=this.ranks,a=this.roots,o=i[r],s=i[n];if(o<s){a[r]=n}else if(s<o){a[n]=r}else{a[n]=r;++i[r]}}},{}],320:[function(e,t,r){"use strict";t.exports=o;var n=e("robust-orientation");var i=e("simplicial-complex");function a(e,t,r){var i=Math.abs(n(e,t,r));var a=Math.sqrt(Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2));return i/a}function o(e,t,r){var n=t.length;var o=e.length;var s=new Array(n);var l=new Array(n);var u=new Array(n);var f=new Array(n);for(var c=0;c<n;++c){s[c]=l[c]=-1;u[c]=Infinity;f[c]=false}for(var c=0;c<o;++c){var h=e[c];if(h.length!==2){throw new Error("Input must be a graph")}var v=h[1];var d=h[0];if(l[d]!==-1){l[d]=-2}else{l[d]=v}if(s[v]!==-1){s[v]=-2}else{s[v]=d}}function p(e){if(f[e]){return Infinity}var r=s[e];var n=l[e];if(r<0||n<0){return Infinity}else{return a(t[e],t[r],t[n])}}function g(e,t){var r=A[e];var n=A[t];A[e]=n;A[t]=r;T[r]=t;T[n]=e}function m(e){return u[A[e]]}function y(e){if(e&1){return e-1>>1}return(e>>1)-1}function b(e){var t=m(e);while(true){var r=t;var n=2*e+1;var i=2*(e+1);var a=e;if(n<E){var o=m(n);if(o<r){a=n;r=o}}if(i<E){var s=m(i);if(s<r){a=i}}if(a===e){return e}g(e,a);e=a}}function x(e){var t=m(e);while(e>0){var r=y(e);if(r>=0){var n=m(r);if(t<n){g(e,r);e=r;continue}}return e}}function _(){if(E>0){var e=A[0];g(0,E-1);E-=1;b(0);return e}return-1}function w(e,t){var r=A[e];if(u[r]===t){return e}u[r]=-Infinity;x(e);_();u[r]=t;E+=1;return x(E-1)}function M(e){if(f[e]){return}f[e]=true;var t=s[e];var r=l[e];if(s[r]>=0){s[r]=t}if(l[t]>=0){l[t]=r}if(T[t]>=0){w(T[t],p(t))}if(T[r]>=0){w(T[r],p(r))}}var A=[];var T=new Array(n);for(var c=0;c<n;++c){var k=u[c]=p(c);if(k<Infinity){T[c]=A.length;A.push(c)}else{T[c]=-1}}var E=A.length;for(var c=E>>1;c>=0;--c){b(c)}while(true){var S=_();if(S<0||u[S]>r){break}M(S)}var L=[];for(var c=0;c<n;++c){if(!f[c]){T[c]=L.length;L.push(t[c].slice())}}var C=L.length;function I(e,t){if(e[t]<0){return t}var r=t;var n=t;do{var i=e[n];if(!f[n]||i<0||i===n){break}n=i;i=e[n];if(!f[n]||i<0||i===n){break}n=i;r=e[r]}while(r!==n);for(var a=t;a!==n;a=e[a]){e[a]=n}return n}var P=[];e.forEach(function(e){var t=I(s,e[0]);var r=I(l,e[1]);if(t>=0&&r>=0&&t!==r){var n=T[t];var i=T[r];if(n!==i){P.push([n,i])}}});i.unique(i.normalize(P));return{positions:L,edges:P}}},{"robust-orientation":306,"simplicial-complex":318}],321:[function(e,t,r){"use strict";t.exports=a;var n=e("robust-orientation");function i(e,t){var r,i;if(t[0][0]<t[1][0]){r=t[0];i=t[1]}else if(t[0][0]>t[1][0]){r=t[1];i=t[0]}else{var a=Math.min(e[0][1],e[1][1]);var o=Math.max(e[0][1],e[1][1]);var s=Math.min(t[0][1],t[1][1]);var l=Math.max(t[0][1],t[1][1]);if(o<s){return o-s}if(a>l){return a-l}return o-l}var u,f;if(e[0][1]<e[1][1]){u=e[0];f=e[1]}else{u=e[1];f=e[0]}var c=n(i,r,u);if(c){return c}c=n(i,r,f);if(c){return c}return f-i}function a(e,t){var r,a;if(t[0][0]<t[1][0]){r=t[0];a=t[1]}else if(t[0][0]>t[1][0]){r=t[1];a=t[0]}else{return i(t,e)}var o,s;if(e[0][0]<e[1][0]){o=e[0];s=e[1]}else if(e[0][0]>e[1][0]){o=e[1];s=e[0]}else{return-i(e,t)}var l=n(r,a,s);var u=n(r,a,o);if(l<0){if(u<=0){return l}}else if(l>0){if(u>=0){return l}}else if(u){return u}l=n(s,o,a);u=n(s,o,r);if(l<0){if(u<=0){return l}}else if(l>0){if(u>=0){return l}}else if(u){return u}return a[0]-s[0]}},{"robust-orientation":306}],322:[function(e,t,r){"use strict";t.exports=v;var n=e("binary-search-bounds");var i=e("functional-red-black-tree");var a=e("robust-orientation");var o=e("./lib/order-segments");function s(e,t,r){this.slabs=e;this.coordinates=t;this.horizontal=r}var l=s.prototype;function u(e,t){return e.y-t}function f(e,t){var r=null;while(e){var n=e.key;var i,o;if(n[0][0]<n[1][0]){i=n[0];o=n[1]}else{i=n[1];o=n[0]}var s=a(i,o,t);if(s<0){e=e.left}else if(s>0){if(t[0]!==n[1][0]){r=e;e=e.right}else{var l=f(e.right,t);if(l){return l}e=e.left}}else{if(t[0]!==n[1][0]){return e}else{var l=f(e.right,t);if(l){return l}e=e.left}}}return r}l.castUp=function(e){var t=n.le(this.coordinates,e[0]);if(t<0){return-1}var r=this.slabs[t];var i=f(this.slabs[t],e);var s=-1;if(i){s=i.value}if(this.coordinates[t]===e[0]){var l=null;if(i){l=i.key}if(t>0){var c=f(this.slabs[t-1],e);if(c){if(l){if(o(c.key,l)>0){l=c.key;s=c.value}}else{s=c.value;l=c.key}}}var h=this.horizontal[t];if(h.length>0){var v=n.ge(h,e[1],u);if(v<h.length){var d=h[v];if(e[1]===d.y){if(d.closed){return d.index}else{while(v<h.length-1&&h[v+1].y===e[1]){v=v+1;d=h[v];if(d.closed){return d.index}}if(d.y===e[1]&&!d.start){v=v+1;if(v>=h.length){return s}d=h[v]}}}if(d.start){if(l){var p=a(l[0],l[1],[e[0],d.y]);if(l[0][0]>l[1][0]){p=-p}if(p>0){s=d.index}}else{s=d.index}}else if(d.y!==e[1]){s=d.index}}}}return s};function c(e,t,r,n){this.y=e;this.index=t;this.start=r;this.closed=n}function h(e,t,r,n){this.x=e;this.segment=t;this.create=r;this.index=n}function v(e){var t=e.length;var r=2*t;var n=new Array(r);for(var a=0;a<t;++a){var l=e[a];var u=l[0][0]<l[1][0];n[2*a]=new h(l[0][0],l,u,a);n[2*a+1]=new h(l[1][0],l,!u,a)}n.sort(function(e,t){var r=e.x-t.x;if(r){return r}r=e.create-t.create;if(r){return r}return Math.min(e.segment[0][1],e.segment[1][1])-Math.min(t.segment[0][1],t.segment[1][1])});var f=i(o);var v=[];var d=[];var p=[];var g=-Infinity;for(var a=0;a<r;){var m=n[a].x;var y=[];while(a<r){var b=n[a];if(b.x!==m){break}a+=1;if(b.segment[0][0]===b.x&&b.segment[1][0]===b.x){if(b.create){if(b.segment[0][1]<b.segment[1][1]){y.push(new c(b.segment[0][1],b.index,true,true));y.push(new c(b.segment[1][1],b.index,false,false))}else{y.push(new c(b.segment[1][1],b.index,true,false));y.push(new c(b.segment[0][1],b.index,false,true))}}}else{if(b.create){f=f.insert(b.segment,b.index)}else{f=f.remove(b.segment)}}}v.push(f.root);d.push(m);p.push(y)}return new s(v,d,p)}},{"./lib/order-segments":321,"binary-search-bounds":36,"functional-red-black-tree":93,"robust-orientation":306}],323:[function(e,t,r){"use strict";var n=e("robust-dot-product");var i=e("robust-sum");t.exports=s;t.exports.positive=l;t.exports.negative=u;function a(e,t){var r=i(n(e,t),[t[t.length-1]]);return r[r.length-1]}function o(e,t,r,n){var i=n-t;var a=-t/i;if(a<0){a=0}else if(a>1){a=1}var o=1-a;var s=e.length;var l=new Array(s);for(var u=0;u<s;++u){l[u]=a*e[u]+o*r[u]}return l}function s(e,t){var r=[];var n=[];var i=a(e[e.length-1],t);for(var s=e[e.length-1],l=e[0],u=0;u<e.length;++u,s=l){l=e[u];var f=a(l,t);if(i<0&&f>0||i>0&&f<0){var c=o(s,f,l,i);r.push(c);n.push(c.slice())}if(f<0){n.push(l.slice())}else if(f>0){r.push(l.slice())}else{r.push(l.slice());n.push(l.slice())}i=f}return{positive:r,negative:n}}function l(e,t){var r=[];var n=a(e[e.length-1],t);for(var i=e[e.length-1],s=e[0],l=0;l<e.length;++l,i=s){s=e[l];var u=a(s,t);if(n<0&&u>0||n>0&&u<0){r.push(o(i,u,s,n))}if(u>=0){r.push(s.slice())}n=u}return r}function u(e,t){var r=[];var n=a(e[e.length-1],t);for(var i=e[e.length-1],s=e[0],l=0;l<e.length;++l,i=s){s=e[l];var u=a(s,t);if(n<0&&u>0||n>0&&u<0){r.push(o(i,u,s,n))}if(u<=0){r.push(s.slice())}n=u}return r}},{"robust-dot-product":303,"robust-sum":311}],324:[function(t,r,n){!function(){"use strict";var t={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};function r(e){return a(s(e),arguments)}function i(e,t){return r.apply(null,[e].concat(t||[]))}function a(e,n){var i=1,a=e.length,o,s="",l,u,f,c,h,v,d,p;for(l=0;l<a;l++){if(typeof e[l]==="string"){s+=e[l]}else if(Array.isArray(e[l])){f=e[l];if(f[2]){o=n[i];for(u=0;u<f[2].length;u++){if(!o.hasOwnProperty(f[2][u])){throw new Error(r('[sprintf] property "%s" does not exist',f[2][u]))}o=o[f[2][u]]}}else if(f[1]){o=n[f[1]]}else{o=n[i++]}if(t.not_type.test(f[8])&&t.not_primitive.test(f[8])&&o instanceof Function){o=o()}if(t.numeric_arg.test(f[8])&&(typeof o!=="number"&&isNaN(o))){throw new TypeError(r("[sprintf] expecting number but found %T",o))}if(t.number.test(f[8])){d=o>=0}switch(f[8]){case"b":o=parseInt(o,10).toString(2);break;case"c":o=String.fromCharCode(parseInt(o,10));break;case"d":case"i":o=parseInt(o,10);break;case"j":o=JSON.stringify(o,null,f[6]?parseInt(f[6]):0);break;case"e":o=f[7]?parseFloat(o).toExponential(f[7]):parseFloat(o).toExponential();break;case"f":o=f[7]?parseFloat(o).toFixed(f[7]):parseFloat(o);break;case"g":o=f[7]?String(Number(o.toPrecision(f[7]))):parseFloat(o);break;case"o":o=(parseInt(o,10)>>>0).toString(8);break;case"s":o=String(o);o=f[7]?o.substring(0,f[7]):o;break;case"t":o=String(!!o);o=f[7]?o.substring(0,f[7]):o;break;case"T":o=Object.prototype.toString.call(o).slice(8,-1).toLowerCase();o=f[7]?o.substring(0,f[7]):o;break;case"u":o=parseInt(o,10)>>>0;break;case"v":o=o.valueOf();o=f[7]?o.substring(0,f[7]):o;break;case"x":o=(parseInt(o,10)>>>0).toString(16);break;case"X":o=(parseInt(o,10)>>>0).toString(16).toUpperCase();break}if(t.json.test(f[8])){s+=o}else{if(t.number.test(f[8])&&(!d||f[3])){p=d?"+":"-";o=o.toString().replace(t.sign,"")}else{p=""}h=f[4]?f[4]==="0"?"0":f[4].charAt(1):" ";v=f[6]-(p+o).length;c=f[6]?v>0?h.repeat(v):"":"";s+=f[5]?p+o+c:h==="0"?p+c+o:c+p+o}}}return s}var o=Object.create(null);function s(e){if(o[e]){return o[e]}var r=e,n,i=[],a=0;while(r){if((n=t.text.exec(r))!==null){i.push(n[0])}else if((n=t.modulo.exec(r))!==null){i.push("%")}else if((n=t.placeholder.exec(r))!==null){if(n[2]){a|=1;var s=[],l=n[2],u=[];if((u=t.key.exec(l))!==null){s.push(u[1]);while((l=l.substring(u[0].length))!==""){if((u=t.key_access.exec(l))!==null){s.push(u[1])}else if((u=t.index_access.exec(l))!==null){s.push(u[1])}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}}}else{throw new SyntaxError("[sprintf] failed to parse named argument key")}n[2]=s}else{a|=2}if(a===3){throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported")}i.push(n)}else{throw new SyntaxError("[sprintf] unexpected placeholder")}r=r.substring(n[0].length)}return o[e]=i}if(typeof n!=="undefined"){n["sprintf"]=r;n["vsprintf"]=i}if(typeof window!=="undefined"){window["sprintf"]=r;window["vsprintf"]=i;if(typeof e==="function"&&e["amd"]){e(function(){return{sprintf:r,vsprintf:i}})}}}()},{}],325:[function(e,t,r){"use strict";t.exports=i;var n={" ":" ",0:"\u2070",1:"\xb9",2:"\xb2",3:"\xb3",4:"\u2074",5:"\u2075",6:"\u2076",7:"\u2077",8:"\u2078",9:"\u2079","+":"\u207a","-":"\u207b",a:"\u1d43",b:"\u1d47",c:"\u1d9c",d:"\u1d48",e:"\u1d49",f:"\u1da0",g:"\u1d4d",h:"\u02b0",i:"\u2071",j:"\u02b2",k:"\u1d4f",l:"\u02e1",m:"\u1d50",n:"\u207f",o:"\u1d52",p:"\u1d56",r:"\u02b3",s:"\u02e2",t:"\u1d57",u:"\u1d58",v:"\u1d5b",w:"\u02b7",x:"\u02e3",y:"\u02b8",z:"\u1dbb"};function i(e){return e.split("").map(function(e){if(e in n){return n[e]}return""}).join("")}},{}],326:[function(e,t,r){"use strict";t.exports=u;var n=e("ndarray-extract-contour");var i=e("triangulate-hypercube");var a=e("zero-crossings");function o(e,t){var r=e.length;var a=["'use strict';"];var o="surfaceNets"+e.join("_")+"d"+t;a.push("var contour=genContour({","order:[",e.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },");if(t==="generic"){a.push("getters:[0],")}var s=[];var l=[];for(var u=0;u<r;++u){s.push("d"+u);l.push("d"+u)}for(var u=0;u<1<<r;++u){s.push("v"+u);l.push("v"+u)}for(var u=0;u<1<<r;++u){s.push("p"+u);l.push("p"+u)}s.push("a","b","c");l.push("a","c");a.push("vertex:function vertexFunc(",s.join(),"){");var f=[];for(var u=0;u<1<<r;++u){f.push("(p"+u+"<<"+u+")")}a.push("var m=(",f.join("+"),")|0;if(m===0||m===",(1<<(1<<r))-1,"){return}");var c=[];var h=[];if(1<<(1<<r)<=128){a.push("switch(m){");h=a}else{a.push("switch(m>>>7){")}for(var u=0;u<1<<(1<<r);++u){if(1<<(1<<r)>128){if(u%128===0){if(c.length>0){h.push("}}")}var v="vExtra"+c.length;a.push("case ",u>>>7,":",v,"(m&0x7f,",l.join(),");break;");h=["function ",v,"(m,",l.join(),"){switch(m){"];c.push(h)}}h.push("case ",u&127,":");var d=new Array(r);var p=new Array(r);var g=new Array(r);var m=new Array(r);var y=0;for(var b=0;b<r;++b){d[b]=[];p[b]=[];g[b]=0;m[b]=0}for(var b=0;b<1<<r;++b){for(var x=0;x<r;++x){var _=b^1<<x;if(_>b){continue}if(!(u&1<<_)!==!(u&1<<b)){var w=1;if(u&1<<_){p[x].push("v"+_+"-v"+b)}else{p[x].push("v"+b+"-v"+_);w=-w}if(w<0){d[x].push("-v"+b+"-v"+_);g[x]+=2}else{d[x].push("v"+b+"+v"+_);g[x]-=2}y+=1;for(var M=0;M<r;++M){if(M===x){continue}if(_&1<<M){m[M]+=1}else{m[M]-=1}}}}}var A=[];for(var x=0;x<r;++x){if(d[x].length===0){A.push("d"+x+"-0.5")}else{var T="";if(g[x]<0){T=g[x]+"*c"}else if(g[x]>0){T="+"+g[x]+"*c"}var k=.5*(d[x].length/y);var E=.5+.5*(m[x]/y);A.push("d"+x+"-"+E+"-"+k+"*("+d[x].join("+")+T+")/("+p[x].join("+")+")")}}h.push("a.push([",A.join(),"]);","break;")}a.push("}},");if(c.length>0){h.push("}}")}var S=[];for(var u=0;u<1<<r-1;++u){S.push("v"+u)}S.push("c0","c1","p0","p1","a","b","c");a.push("cell:function cellFunc(",S.join(),"){");var L=i(r-1);a.push("if(p0){b.push(",L.map(function(e){return"["+e.map(function(e){return"v"+e})+"]"}).join(),")}else{b.push(",L.map(function(e){var t=e.slice();t.reverse();return"["+t.map(function(e){return"v"+e})+"]"}).join(),")}}});function ",o,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",o,";");for(var u=0;u<c.length;++u){a.push(c[u].join(""))}var C=new Function("genContour",a.join(""));return C(n)}function s(e,t){var r=a(e,t);var n=r.length;var i=new Array(n);var o=new Array(n);for(var s=0;s<n;++s){i[s]=[r[s]];o[s]=[s]}return{positions:i,cells:o}}var l={};function u(e,t){if(e.dimension<=0){return{positions:[],cells:[]}}else if(e.dimension===1){return s(e,t)}var r=e.order.join()+"-"+e.dtype;var n=l[r];var t=+t||0;if(!n){n=l[r]=o(e.order,e.dtype)}return n(e,t)}},{"ndarray-extract-contour":259,"triangulate-hypercube":329,"zero-crossings":344}],327:[function(t,r,n){(function(t){var n=/^\s+/,i=/\s+$/,a=0,o=t.round,s=t.min,l=t.max,u=t.random;function f(e,t){e=e?e:"";t=t||{};if(e instanceof f){return e}if(!(this instanceof f)){return new f(e,t)}var r=c(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=o(100*this._a)/100,this._format=t.format||r.format;this._gradientType=t.gradientType;if(this._r<1){this._r=o(this._r)}if(this._g<1){this._g=o(this._g)}if(this._b<1){this._b=o(this._b)}this._ok=r.ok;this._tc_id=a++}f.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb();var r,n,i,a,o,s;r=e.r/255;n=e.g/255;i=e.b/255;if(r<=.03928){a=r/12.92}else{a=t.pow((r+.055)/1.055,2.4)}if(n<=.03928){o=n/12.92}else{o=t.pow((n+.055)/1.055,2.4)}if(i<=.03928){s=i/12.92}else{s=t.pow((i+.055)/1.055,2.4)}return.2126*a+.7152*o+.0722*s},setAlpha:function(e){this._a=z(e);this._roundA=o(100*this._a)/100;return this},toHsv:function(){var e=p(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=p(this._r,this._g,this._b);var t=o(e.h*360),r=o(e.s*100),n=o(e.v*100);return this._a==1?"hsv("+t+", "+r+"%, "+n+"%)":"hsva("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var e=v(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=v(this._r,this._g,this._b);var t=o(e.h*360),r=o(e.s*100),n=o(e.l*100);return this._a==1?"hsl("+t+", "+r+"%, "+n+"%)":"hsla("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHex:function(e){return m(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return y(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:o(this._r),g:o(this._g),b:o(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+o(this._r)+", "+o(this._g)+", "+o(this._b)+")":"rgba("+o(this._r)+", "+o(this._g)+", "+o(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:o(D(this._r,255)*100)+"%",g:o(D(this._g,255)*100)+"%",b:o(D(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+o(D(this._r,255)*100)+"%, "+o(D(this._g,255)*100)+"%, "+o(D(this._b,255)*100)+"%)":"rgba("+o(D(this._r,255)*100)+"%, "+o(D(this._g,255)*100)+"%, "+o(D(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){if(this._a===0){return"transparent"}if(this._a<1){return false}return R[m(this._r,this._g,this._b,true)]||false},toFilter:function(e){var t="#"+b(this._r,this._g,this._b,this._a);var r=t;var n=this._gradientType?"GradientType = 1, ":"";if(e){var i=f(e);r="#"+b(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+t+",endColorstr="+r+")"},toString:function(e){var t=!!e;e=e||this._format;var r=false;var n=this._a<1&&this._a>=0;var i=!t&&n&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");if(i){if(e==="name"&&this._a===0){return this.toName()}return this.toRgbString()}if(e==="rgb"){r=this.toRgbString()}if(e==="prgb"){r=this.toPercentageRgbString()}if(e==="hex"||e==="hex6"){r=this.toHexString()}if(e==="hex3"){r=this.toHexString(true)}if(e==="hex4"){r=this.toHex8String(true)}if(e==="hex8"){r=this.toHex8String()}if(e==="name"){r=this.toName()}if(e==="hsl"){r=this.toHslString()}if(e==="hsv"){r=this.toHsvString()}return r||this.toHexString()},clone:function(){return f(this.toString())},_applyModification:function(e,t){var r=e.apply(null,[this].concat([].slice.call(t)));this._r=r._r;this._g=r._g;this._b=r._b;this.setAlpha(r._a);return this},lighten:function(){return this._applyModification(M,arguments)},brighten:function(){return this._applyModification(A,arguments)},darken:function(){return this._applyModification(T,arguments)},desaturate:function(){return this._applyModification(x,arguments)},saturate:function(){return this._applyModification(_,arguments)},greyscale:function(){return this._applyModification(w,arguments)},spin:function(){return this._applyModification(k,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(I,arguments)},complement:function(){return this._applyCombination(E,arguments)},monochromatic:function(){return this._applyCombination(P,arguments)},splitcomplement:function(){return this._applyCombination(C,arguments)},triad:function(){return this._applyCombination(S,arguments)},tetrad:function(){return this._applyCombination(L,arguments)}};f.fromRatio=function(e,t){if(typeof e=="object"){var r={};for(var n in e){if(e.hasOwnProperty(n)){if(n==="a"){r[n]=e[n]}else{r[n]=H(e[n])}}}e=r}return f(e,t)};function c(e){var t={r:0,g:0,b:0};var r=1;var n=null;var i=null;var a=null;var o=false;var u=false;if(typeof e=="string"){e=Y(e)}if(typeof e=="object"){if(X(e.r)&&X(e.g)&&X(e.b)){t=h(e.r,e.g,e.b);o=true;u=String(e.r).substr(-1)==="%"?"prgb":"rgb"}else if(X(e.h)&&X(e.s)&&X(e.v)){n=H(e.s);i=H(e.v);t=g(e.h,n,i);o=true;u="hsv"}else if(X(e.h)&&X(e.s)&&X(e.l)){n=H(e.s);a=H(e.l);t=d(e.h,n,a);o=true;u="hsl"}if(e.hasOwnProperty("a")){r=e.a}}r=z(r);return{ok:o,format:e.format||u,r:s(255,l(t.r,0)),g:s(255,l(t.g,0)),b:s(255,l(t.b,0)),a:r}}function h(e,t,r){return{r:D(e,255)*255,g:D(t,255)*255,b:D(r,255)*255}}function v(e,t,r){e=D(e,255);t=D(t,255);r=D(r,255);var n=l(e,t,r),i=s(e,t,r);var a,o,u=(n+i)/2;if(n==i){a=o=0}else{var f=n-i;o=u>.5?f/(2-n-i):f/(n+i);switch(n){case e:a=(t-r)/f+(t<r?6:0);break;case t:a=(r-e)/f+2;break;case r:a=(e-t)/f+4;break}a/=6}return{h:a,s:o,l:u}}function d(e,t,r){var n,i,a;e=D(e,360);t=D(t,100);r=D(r,100);function o(e,t,r){if(r<0)r+=1;if(r>1)r-=1;if(r<1/6)return e+(t-e)*6*r;if(r<1/2)return t;if(r<2/3)return e+(t-e)*(2/3-r)*6;return e}if(t===0){n=i=a=r}else{var s=r<.5?r*(1+t):r+t-r*t;var l=2*r-s;n=o(l,s,e+1/3);i=o(l,s,e);a=o(l,s,e-1/3)}return{r:n*255,g:i*255,b:a*255}}function p(e,t,r){e=D(e,255);t=D(t,255);r=D(r,255);var n=l(e,t,r),i=s(e,t,r);var a,o,u=n;var f=n-i;o=n===0?0:f/n;if(n==i){a=0}else{switch(n){case e:a=(t-r)/f+(t<r?6:0);break;case t:a=(r-e)/f+2;break;case r:a=(e-t)/f+4;break}a/=6}return{h:a,s:o,v:u}}function g(e,r,n){e=D(e,360)*6;r=D(r,100);n=D(n,100);var i=t.floor(e),a=e-i,o=n*(1-r),s=n*(1-a*r),l=n*(1-(1-a)*r),u=i%6,f=[n,s,o,o,l,n][u],c=[l,n,n,s,o,o][u],h=[o,o,l,n,n,s][u];return{r:f*255,g:c*255,b:h*255}}function m(e,t,r,n){var i=[V(o(e).toString(16)),V(o(t).toString(16)),V(o(r).toString(16))];if(n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)){return i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0)}return i.join("")}function y(e,t,r,n,i){var a=[V(o(e).toString(16)),V(o(t).toString(16)),V(o(r).toString(16)),V(q(n))];if(i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)){return a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0)}return a.join("")}function b(e,t,r,n){var i=[V(q(n)),V(o(e).toString(16)),V(o(t).toString(16)),V(o(r).toString(16))];return i.join("")}f.equals=function(e,t){if(!e||!t){return false}return f(e).toRgbString()==f(t).toRgbString()};f.random=function(){return f.fromRatio({r:u(),g:u(),b:u()})};function x(e,t){t=t===0?0:t||10;var r=f(e).toHsl();r.s-=t/100;r.s=F(r.s);return f(r)}function _(e,t){t=t===0?0:t||10;var r=f(e).toHsl();r.s+=t/100;r.s=F(r.s);return f(r)}function w(e){return f(e).desaturate(100)}function M(e,t){t=t===0?0:t||10;var r=f(e).toHsl();r.l+=t/100;r.l=F(r.l);return f(r)}function A(e,t){t=t===0?0:t||10;var r=f(e).toRgb();r.r=l(0,s(255,r.r-o(255*-(t/100))));r.g=l(0,s(255,r.g-o(255*-(t/100))));r.b=l(0,s(255,r.b-o(255*-(t/100))));return f(r)}function T(e,t){t=t===0?0:t||10;var r=f(e).toHsl();r.l-=t/100;r.l=F(r.l);return f(r)}function k(e,t){var r=f(e).toHsl();var n=(r.h+t)%360;r.h=n<0?360+n:n;return f(r)}function E(e){var t=f(e).toHsl();t.h=(t.h+180)%360;return f(t)}function S(e){var t=f(e).toHsl();var r=t.h;return[f(e),f({h:(r+120)%360,s:t.s,l:t.l}),f({h:(r+240)%360,s:t.s,l:t.l})]}function L(e){var t=f(e).toHsl();var r=t.h;return[f(e),f({h:(r+90)%360,s:t.s,l:t.l}),f({h:(r+180)%360,s:t.s,l:t.l}),f({h:(r+270)%360,s:t.s,l:t.l})]}function C(e){var t=f(e).toHsl();var r=t.h;return[f(e),f({h:(r+72)%360,s:t.s,l:t.l}),f({h:(r+216)%360,s:t.s,l:t.l})]}function I(e,t,r){t=t||6;r=r||30;var n=f(e).toHsl();var i=360/r;var a=[f(e)];for(n.h=(n.h-(i*t>>1)+720)%360;--t;){n.h=(n.h+i)%360;a.push(f(n))}return a}function P(e,t){t=t||6;var r=f(e).toHsv();var n=r.h,i=r.s,a=r.v;var o=[];var s=1/t;while(t--){o.push(f({h:n,s:i,v:a}));a=(a+s)%1}return o}f.mix=function(e,t,r){r=r===0?0:r||50;var n=f(e).toRgb();var i=f(t).toRgb();var a=r/100;var o={r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a};return f(o)};f.readability=function(e,r){var n=f(e);var i=f(r);return(t.max(n.getLuminance(),i.getLuminance())+.05)/(t.min(n.getLuminance(),i.getLuminance())+.05)};f.isReadable=function(e,t,r){var n=f.readability(e,t);var i,a;a=false;i=Z(r);switch(i.level+i.size){case"AAsmall":case"AAAlarge":a=n>=4.5;break;case"AAlarge":a=n>=3;break;case"AAAsmall":a=n>=7;break}return a};f.mostReadable=function(e,t,r){var n=null;var i=0;var a;var o,s,l;r=r||{};o=r.includeFallbackColors;s=r.level;l=r.size;for(var u=0;u<t.length;u++){a=f.readability(e,t[u]);if(a>i){i=a;n=f(t[u])}}if(f.isReadable(e,n,{level:s,size:l})||!o){return n}else{r.includeFallbackColors=false;return f.mostReadable(e,["#fff","#000"],r)}};var O=f.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var R=f.hexNames=N(O);function N(e){var t={};for(var r in e){if(e.hasOwnProperty(r)){t[e[r]]=r}}return t}function z(e){e=parseFloat(e);if(isNaN(e)||e<0||e>1){e=1}return e}function D(e,r){if(B(e)){e="100%"}var n=U(e);e=s(r,l(0,parseFloat(e)));if(n){e=parseInt(e*r,10)/100}if(t.abs(e-r)<1e-6){return 1}return e%r/parseFloat(r)}function F(e){return s(1,l(0,e))}function j(e){return parseInt(e,16)}function B(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function U(e){return typeof e==="string"&&e.indexOf("%")!=-1}function V(e){return e.length==1?"0"+e:""+e}function H(e){if(e<=1){e=e*100+"%"}return e}function q(e){return t.round(parseFloat(e)*255).toString(16)}function G(e){return j(e)/255}var W=function(){var e="[-\\+]?\\d+%?";var t="[-\\+]?\\d*\\.\\d+%?";var r="(?:"+t+")|(?:"+e+")";var n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";var i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function X(e){return!!W.CSS_UNIT.exec(e)}function Y(e){e=e.replace(n,"").replace(i,"").toLowerCase();var t=false;if(O[e]){e=O[e];t=true}else if(e=="transparent"){return{r:0,g:0,b:0,a:0,format:"name"}}var r;if(r=W.rgb.exec(e)){return{r:r[1],g:r[2],b:r[3]}}if(r=W.rgba.exec(e)){return{r:r[1],g:r[2],b:r[3],a:r[4]}}if(r=W.hsl.exec(e)){return{h:r[1],s:r[2],l:r[3]}}if(r=W.hsla.exec(e)){return{h:r[1],s:r[2],l:r[3],a:r[4]}}if(r=W.hsv.exec(e)){return{h:r[1],s:r[2],v:r[3]}}if(r=W.hsva.exec(e)){return{h:r[1],s:r[2],v:r[3],a:r[4]}}if(r=W.hex8.exec(e)){return{r:j(r[1]),g:j(r[2]),b:j(r[3]),a:G(r[4]),format:t?"name":"hex8"}}if(r=W.hex6.exec(e)){return{r:j(r[1]),g:j(r[2]),b:j(r[3]),format:t?"name":"hex"}}if(r=W.hex4.exec(e)){return{r:j(r[1]+""+r[1]),g:j(r[2]+""+r[2]),b:j(r[3]+""+r[3]),a:G(r[4]+""+r[4]),format:t?"name":"hex8"}}if(r=W.hex3.exec(e)){return{r:j(r[1]+""+r[1]),g:j(r[2]+""+r[2]),b:j(r[3]+""+r[3]),format:t?"name":"hex"}}return false}function Z(e){var t,r;e=e||{level:"AA",size:"small"};t=(e.level||"AA").toUpperCase();r=(e.size||"small").toLowerCase();if(t!=="AA"&&t!=="AAA"){t="AA"}if(r!=="small"&&r!=="large"){r="small"}return{level:t,size:r}}if(typeof r!=="undefined"&&r.exports){r.exports=f}else if(typeof e==="function"&&e.amd){e(function(){return f})}else{window.tinycolor=f}})(Math)},{}],328:[function(e,t,r){"use strict";var n=e("parse-unit");t.exports=s;var i=96;function a(e,t){var r=n(getComputedStyle(e).getPropertyValue(t));return r[0]*s(r[1],e)}function o(e,t){var r=document.createElement("div");r.style["font-size"]="128"+e;t.appendChild(r);var n=a(r,"font-size")/128;t.removeChild(r);return n}function s(e,t){t=t||document.body;e=(e||"px").trim().toLowerCase();if(t===window||t===document){t=document.body}switch(e){case"%":return t.clientHeight/100;case"ch":case"ex":return o(e,t);case"em":return a(t,"font-size");case"rem":return a(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return i;case"cm":return i/2.54;case"mm":return i/25.4;case"pt":return i/72;case"pc":return i/6}return 1}},{"parse-unit":276}],329:[function(e,t,r){"use strict";t.exports=o;var n=e("permutation-rank");var i=e("permutation-parity");var a=e("gamma");function o(e){if(e<0){return[]}if(e===0){return[[0]]}var t=Math.round(a(e+1))|0;var r=[];for(var o=0;o<t;++o){var s=n.unrank(e,o);var l=[0];var u=0;for(var f=0;f<s.length;++f){u+=1<<s[f];l.push(u)}if(i(s)<1){l[0]=u;l[e]=0}r.push(l)}return r}},{gamma:94,"permutation-parity":277,"permutation-rank":278}],330:[function(e,t,r){"use strict";t.exports=p;var n=e("filtered-vector");var i=e("gl-mat4/invert");var a=e("gl-mat4/rotate");var o=e("gl-vec3/cross");var s=e("gl-vec3/normalize");var l=e("gl-vec3/dot");function u(e,t,r){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(r,2))}function f(e){return Math.min(1,Math.max(-1,e))}function c(e){var t=Math.abs(e[0]);var r=Math.abs(e[1]);var n=Math.abs(e[2]);var i=[0,0,0];if(t>Math.max(r,n)){i[2]=1}else if(r>Math.max(t,n)){i[0]=1}else{i[1]=1}var a=0;var o=0;for(var l=0;l<3;++l){a+=e[l]*e[l];o+=i[l]*e[l]}for(var l=0;l<3;++l){i[l]-=o/a*e[l]}s(i,i);return i}function h(e,t,r,i,a,o,s,l){this.center=n(r);this.up=n(i);this.right=n(a);this.radius=n([o]);this.angle=n([s,l]);this.angle.bounds=[[-Infinity,-Math.PI/2],[Infinity,Math.PI/2]];this.setDistanceLimits(e,t);this.computedCenter=this.center.curve(0);this.computedUp=this.up.curve(0);this.computedRight=this.right.curve(0);this.computedRadius=this.radius.curve(0);this.computedAngle=this.angle.curve(0);this.computedToward=[0,0,0];this.computedEye=[0,0,0];this.computedMatrix=new Array(16);for(var u=0;u<16;++u){this.computedMatrix[u]=.5}this.recalcMatrix(0)}var v=h.prototype;v.setDistanceLimits=function(e,t){if(e>0){e=Math.log(e)}else{e=-Infinity}if(t>0){t=Math.log(t)}else{t=Infinity}t=Math.max(t,e);this.radius.bounds[0][0]=e;this.radius.bounds[1][0]=t};v.getDistanceLimits=function(e){var t=this.radius.bounds[0];if(e){e[0]=Math.exp(t[0][0]);e[1]=Math.exp(t[1][0]);return e}return[Math.exp(t[0][0]),Math.exp(t[1][0])]};v.recalcMatrix=function(e){this.center.curve(e);this.up.curve(e);this.right.curve(e);this.radius.curve(e);this.angle.curve(e);var t=this.computedUp;var r=this.computedRight;var n=0;var i=0;for(var a=0;a<3;++a){i+=t[a]*r[a];n+=t[a]*t[a]}var l=Math.sqrt(n);var f=0;for(var a=0;a<3;++a){r[a]-=t[a]*i/n;f+=r[a]*r[a];t[a]/=l}var c=Math.sqrt(f);for(var a=0;a<3;++a){r[a]/=c}var h=this.computedToward;o(h,t,r);s(h,h);var v=Math.exp(this.computedRadius[0]);var d=this.computedAngle[0];var p=this.computedAngle[1];var g=Math.cos(d);var m=Math.sin(d);var y=Math.cos(p);var b=Math.sin(p);var x=this.computedCenter;var _=g*y;var w=m*y;var M=b;var A=-g*b;var T=-m*b;var k=y;var E=this.computedEye;var S=this.computedMatrix;for(var a=0;a<3;++a){var L=_*r[a]+w*h[a]+M*t[a];S[4*a+1]=A*r[a]+T*h[a]+k*t[a];S[4*a+2]=L;S[4*a+3]=0}var C=S[1];var I=S[5];var P=S[9];var O=S[2];var R=S[6];var N=S[10];var z=I*N-P*R;var D=P*O-C*N;var F=C*R-I*O;var j=u(z,D,F);z/=j;D/=j;F/=j;S[0]=z;S[4]=D;S[8]=F;for(var a=0;a<3;++a){E[a]=x[a]+S[2+4*a]*v}for(var a=0;a<3;++a){var f=0;for(var B=0;B<3;++B){f+=S[a+4*B]*E[B]}S[12+a]=-f}S[15]=1};v.getMatrix=function(e,t){this.recalcMatrix(e);var r=this.computedMatrix;if(t){for(var n=0;n<16;++n){t[n]=r[n]}return t}return r};var d=[0,0,0];v.rotate=function(e,t,r,n){this.angle.move(e,t,r);if(n){this.recalcMatrix(e);var i=this.computedMatrix;d[0]=i[2];d[1]=i[6];d[2]=i[10];var o=this.computedUp;var s=this.computedRight;var l=this.computedToward;for(var u=0;u<3;++u){i[4*u]=o[u];i[4*u+1]=s[u];i[4*u+2]=l[u]}a(i,i,n,d);for(var u=0;u<3;++u){o[u]=i[4*u];s[u]=i[4*u+1]}this.up.set(e,o[0],o[1],o[2]);this.right.set(e,s[0],s[1],s[2])}};v.pan=function(e,t,r,n){t=t||0;r=r||0;n=n||0;this.recalcMatrix(e);var i=this.computedMatrix;var a=Math.exp(this.computedRadius[0]);var o=i[1];var s=i[5];var l=i[9];var f=u(o,s,l);o/=f;s/=f;l/=f;var c=i[0];var h=i[4];var v=i[8];var d=c*o+h*s+v*l;c-=o*d;h-=s*d;v-=l*d;var p=u(c,h,v);c/=p;h/=p;v/=p;var g=c*t+o*r;var m=h*t+s*r;var y=v*t+l*r;this.center.move(e,g,m,y);var b=Math.exp(this.computedRadius[0]);b=Math.max(1e-4,b+n);this.radius.set(e,Math.log(b))};v.translate=function(e,t,r,n){this.center.move(e,t||0,r||0,n||0)};v.setMatrix=function(e,t,r,n){var a=1;if(typeof r==="number"){a=r|0}if(a<0||a>3){a=1}var o=(a+2)%3;var s=(a+1)%3;if(!t){this.recalcMatrix(e);t=this.computedMatrix}var l=t[a];var c=t[a+4];var h=t[a+8];if(!n){var v=u(l,c,h);l/=v;c/=v;h/=v}else{var d=Math.abs(l);var p=Math.abs(c);var g=Math.abs(h);var m=Math.max(d,p,g);if(d===m){l=l<0?-1:1;c=h=0}else if(g===m){h=h<0?-1:1;l=c=0}else{c=c<0?-1:1;l=h=0}}var y=t[o];var b=t[o+4];var x=t[o+8];var _=y*l+b*c+x*h;y-=l*_;b-=c*_;x-=h*_;var w=u(y,b,x);y/=w;b/=w;x/=w;var M=c*x-h*b;var A=h*y-l*x;var T=l*b-c*y;var k=u(M,A,T);M/=k;A/=k;T/=k;this.center.jump(e,G,W,X);this.radius.idle(e);this.up.jump(e,l,c,h);this.right.jump(e,y,b,x);var E,S;if(a===2){var L=t[1];var C=t[5];var I=t[9];var P=L*y+C*b+I*x;var O=L*M+C*A+I*T;if(D<0){E=-Math.PI/2}else{E=Math.PI/2}S=Math.atan2(O,P)}else{var R=t[2];var N=t[6];var z=t[10];var D=R*l+N*c+z*h;var F=R*y+N*b+z*x;var j=R*M+N*A+z*T;E=Math.asin(f(D));S=Math.atan2(j,F)}this.angle.jump(e,S,E);this.recalcMatrix(e);var B=t[2];var U=t[6];var V=t[10];var H=this.computedMatrix;i(H,t);var q=H[15];var G=H[12]/q;var W=H[13]/q;var X=H[14]/q;var Y=Math.exp(this.computedRadius[0]);this.center.jump(e,G-B*Y,W-U*Y,X-V*Y)};v.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())};v.idle=function(e){this.center.idle(e);this.up.idle(e);this.right.idle(e);this.radius.idle(e);this.angle.idle(e)};v.flush=function(e){this.center.flush(e);this.up.flush(e);this.right.flush(e);this.radius.flush(e);this.angle.flush(e)};v.setDistance=function(e,t){if(t>0){this.radius.set(e,Math.log(t))}};v.lookAt=function(e,t,r,n){this.recalcMatrix(e);t=t||this.computedEye;r=r||this.computedCenter;n=n||this.computedUp;var i=n[0];var a=n[1];var o=n[2];var s=u(i,a,o);if(s<1e-6){return}i/=s;a/=s;o/=s;var l=t[0]-r[0];var c=t[1]-r[1];var h=t[2]-r[2];var v=u(l,c,h);if(v<1e-6){return}l/=v;c/=v;h/=v;var d=this.computedRight;var p=d[0];var g=d[1];var m=d[2];var y=i*p+a*g+o*m;p-=y*i;g-=y*a;m-=y*o;var b=u(p,g,m);if(b<.01){p=a*h-o*c;g=o*l-i*h;m=i*c-a*l;b=u(p,g,m);if(b<1e-6){return}}p/=b;g/=b;m/=b;this.up.set(e,i,a,o);this.right.set(e,p,g,m);this.center.set(e,r[0],r[1],r[2]);this.radius.set(e,Math.log(v));var x=a*m-o*g;var _=o*p-i*m;var w=i*g-a*p;var M=u(x,_,w);x/=M;_/=M;w/=M;var A=i*l+a*c+o*h;var T=p*l+g*c+m*h;var k=x*l+_*c+w*h;var E=Math.asin(f(A));var S=Math.atan2(k,T);var L=this.angle._state;var C=L[L.length-1];var I=L[L.length-2];C=C%(2*Math.PI);var P=Math.abs(C+2*Math.PI-S);var O=Math.abs(C-S);var R=Math.abs(C-2*Math.PI-S);if(P<O){C+=2*Math.PI}if(R<O){C-=2*Math.PI}this.angle.jump(this.angle.lastT(),C,I);this.angle.set(e,S,E)};function p(e){e=e||{};var t=e.center||[0,0,0];var r=e.up||[0,1,0];var n=e.right||c(r);var i=e.radius||1;var a=e.theta||0;var f=e.phi||0;t=[].slice.call(t,0,3);r=[].slice.call(r,0,3);s(r,r);n=[].slice.call(n,0,3);s(n,n);if("eye"in e){var v=e.eye;var d=[v[0]-t[0],v[1]-t[1],v[2]-t[2]];o(n,d,r);if(u(n[0],n[1],n[2])<1e-6){n=c(r)}else{s(n,n)}i=u(d[0],d[1],d[2]);var p=l(r,d)/i;var g=l(n,d)/i;f=Math.acos(p);a=Math.acos(g)}i=Math.log(i);return new h(e.zoomMin,e.zoomMax,t,r,n,i,a,f)}},{"filtered-vector":92,"gl-mat4/invert":125,"gl-mat4/rotate":129,"gl-vec3/cross":172,"gl-vec3/dot":175,"gl-vec3/normalize":186}],331:[function(e,t,r){"use strict";t.exports=i;var n=+(Math.pow(2,27)+1);function i(e,t,r){var i=e*t;var a=n*e;var o=a-e;var s=a-o;var l=e-s;var u=n*t;var f=u-t;var c=u-f;var h=t-c;var v=i-s*c;var d=v-l*c;var p=d-s*h;var g=l*h-p;if(r){r[0]=g;r[1]=i;return r}return[g,i]}},{}],332:[function(e,t,r){"use strict";t.exports=n;function n(e,t,r){var n=e+t;var i=n-e;var a=n-i;var o=t-i;var s=e-a;if(r){r[0]=s+o;r[1]=n;return r}return[s+o,n]}},{}],333:[function(e,t,r){(function(t,n){"use strict";var i=e("bit-twiddle");var a=e("dup");if(!t.__TYPEDARRAY_POOL){t.__TYPEDARRAY_POOL={UINT8:a([32,0]),UINT16:a([32,0]),UINT32:a([32,0]),INT8:a([32,0]),INT16:a([32,0]),INT32:a([32,0]),FLOAT:a([32,0]),DOUBLE:a([32,0]),DATA:a([32,0]),UINT8C:a([32,0]),BUFFER:a([32,0])}}var o=typeof Uint8ClampedArray!=="undefined";var s=t.__TYPEDARRAY_POOL;if(!s.UINT8C){s.UINT8C=a([32,0])}if(!s.BUFFER){s.BUFFER=a([32,0])}var l=s.DATA,u=s.BUFFER;r.free=function e(t){if(n.isBuffer(t)){u[i.log2(t.length)].push(t)}else{if(Object.prototype.toString.call(t)!=="[object ArrayBuffer]"){t=t.buffer}if(!t){return}var r=t.length||t.byteLength;var a=i.log2(r)|0;l[a].push(t)}};function f(e){if(!e){return}var t=e.length||e.byteLength;var r=i.log2(t);l[r].push(e)}function c(e){f(e.buffer)}r.freeUint8=r.freeUint16=r.freeUint32=r.freeInt8=r.freeInt16=r.freeInt32=r.freeFloat32=r.freeFloat=r.freeFloat64=r.freeDouble=r.freeUint8Clamped=r.freeDataView=c;r.freeArrayBuffer=f;r.freeBuffer=function e(t){u[i.log2(t.length)].push(t)};r.malloc=function e(t,r){if(r===undefined||r==="arraybuffer"){return h(t)}else{switch(r){case"uint8":return v(t);case"uint16":return d(t);case"uint32":return p(t);case"int8":return g(t);case"int16":return m(t);case"int32":return y(t);case"float":case"float32":return b(t);case"double":case"float64":return x(t);case"uint8_clamped":return _(t);case"buffer":return M(t);case"data":case"dataview":return w(t);default:return null}}return null};function h(e){var e=i.nextPow2(e);var t=i.log2(e);var r=l[t];if(r.length>0){return r.pop()}return new ArrayBuffer(e)}r.mallocArrayBuffer=h;function v(e){return new Uint8Array(h(e),0,e)}r.mallocUint8=v;function d(e){return new Uint16Array(h(2*e),0,e)}r.mallocUint16=d;function p(e){return new Uint32Array(h(4*e),0,e)}r.mallocUint32=p;function g(e){return new Int8Array(h(e),0,e)}r.mallocInt8=g;function m(e){return new Int16Array(h(2*e),0,e)}r.mallocInt16=m;function y(e){return new Int32Array(h(4*e),0,e)}r.mallocInt32=y;function b(e){return new Float32Array(h(4*e),0,e)}r.mallocFloat32=r.mallocFloat=b;function x(e){return new Float64Array(h(8*e),0,e)}r.mallocFloat64=r.mallocDouble=x;function _(e){if(o){return new Uint8ClampedArray(h(e),0,e)}else{return v(e)}}r.mallocUint8Clamped=_;function w(e){return new DataView(h(e),0,e)}r.mallocDataView=w;function M(e){e=i.nextPow2(e);var t=i.log2(e);var r=u[t];if(r.length>0){return r.pop()}return new n(e)}r.mallocBuffer=M;r.clearCache=function e(){for(var t=0;t<32;++t){s.UINT8[t].length=0;s.UINT16[t].length=0;s.UINT32[t].length=0;s.INT8[t].length=0;s.INT16[t].length=0;s.INT32[t].length=0;s.FLOAT[t].length=0;s.DOUBLE[t].length=0;s.UINT8C[t].length=0;l[t].length=0;u[t].length=0}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer)},{"bit-twiddle":37,buffer:48,dup:86}],334:[function(e,t,r){"use strict";"use restrict";t.exports=n;function n(e){this.roots=new Array(e);this.ranks=new Array(e);for(var t=0;t<e;++t){this.roots[t]=t;this.ranks[t]=0}}var i=n.prototype;Object.defineProperty(i,"length",{get:function(){return this.roots.length}});i.makeSet=function(){var e=this.roots.length;this.roots.push(e);this.ranks.push(0);return e};i.find=function(e){var t=e;var r=this.roots;while(r[e]!==e){e=r[e]}while(r[t]!==e){var n=r[t];r[t]=e;t=n}return e};i.link=function(e,t){var r=this.find(e),n=this.find(t);if(r===n){return}var i=this.ranks,a=this.roots,o=i[r],s=i[n];if(o<s){a[r]=n}else if(s<o){a[n]=r}else{a[n]=r;++i[r]}}},{}],335:[function(e,t,r){"use strict";function n(e,t){var r=1,n=e.length,i=e[0],a=e[0];for(var o=1;o<n;++o){a=i;i=e[o];if(t(i,a)){if(o===r){r++;continue}e[r++]=i}}e.length=r;return e}function i(e){var t=1,r=e.length,n=e[0],i=e[0];for(var a=1;a<r;++a,i=n){i=n;n=e[a];if(n!==i){if(a===t){t++;continue}e[t++]=n}}e.length=t;return e}function a(e,t,r){if(e.length===0){return e}if(t){if(!r){e.sort(t)}return n(e,t)}if(!r){e.sort()}return i(e)}t.exports=a},{}],336:[function(e,t,r){"use strict";t.exports=o;var n=e("./lib/vtext");var i=null;var a=null;if(typeof document!=="undefined"){i=document.createElement("canvas");i.width=8192;i.height=1024;a=i.getContext("2d")}function o(e,t){if(typeof t!=="object"||t===null){t={}}return n(e,t.canvas||i,t.context||a,t)}},{"./lib/vtext":337}],337:[function(e,t,r){"use strict";t.exports=d;t.exports.processPixels=v;var n=e("surface-nets");var i=e("ndarray");var a=e("simplify-planar-graph");var o=e("clean-pslg");var s=e("cdt2d");var l=e("planar-graph-to-polyline");function u(e,t,r){var n=t.textAlign||"start";var i=t.textBaseline||"alphabetic";var a=[1<<30,1<<30];var o=[0,0];var s=e.length;for(var l=0;l<s;++l){var u=e[l];for(var f=0;f<2;++f){a[f]=Math.min(a[f],u[f])|0;o[f]=Math.max(o[f],u[f])|0}}var c=0;switch(n){case"center":c=-.5*(a[0]+o[0]);break;case"right":case"end":c=-o[0];break;case"left":case"start":c=-a[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+n+"'")}var h=0;switch(i){case"hanging":case"top":h=-a[1];break;case"middle":h=-.5*(a[1]+o[1]);break;case"alphabetic":case"ideographic":h=-3*r;break;case"bottom":h=-o[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+i+"'")}var v=1/r;if("lineHeight"in t){v*=+t.lineHeight}else if("width"in t){v=t.width/(o[0]-a[0])}else if("height"in t){v=t.height/(o[1]-a[1])}return e.map(function(e){return[v*(e[0]+c),v*(e[1]+h)]})}function f(e,t,r,n){var a=Math.ceil(t.measureText(r).width+2*n)|0;if(a>8192){throw new Error("vectorize-text: String too long (sorry, this will get fixed later)")}var o=3*n;if(e.height<o){e.height=o}t.fillStyle="#000";t.fillRect(0,0,e.width,e.height);t.fillStyle="#fff";t.fillText(r,n,2*n);var s=t.getImageData(0,0,a,o);var l=i(s.data,[o,a,4]);return l.pick(-1,-1,0).transpose(1,0)}function c(e,t){var r=n(e,128);if(t){return a(r.cells,r.positions,.25)}return{edges:r.cells,positions:r.positions}}function h(e,t,r,n){var i=c(e,n);var a=u(i.positions,t,r);var f=i.edges;var h="ccw"===t.orientation;o(a,f);if(t.polygons||t.polygon||t.polyline){var v=l(f,a);var d=new Array(v.length);for(var p=0;p<v.length;++p){var g=v[p];var m=new Array(g.length);for(var y=0;y<g.length;++y){var b=g[y];var x=new Array(b.length);for(var _=0;_<b.length;++_){x[_]=a[b[_]].slice()}if(h){x.reverse()}m[y]=x}d[p]=m}return d}else if(t.triangles||t.triangulate||t.triangle){return{cells:s(a,f,{delaunay:false,exterior:false,interior:true}),positions:a}}else{return{edges:f,positions:a}}}function v(e,t,r){try{return h(e,t,r,true)}catch(e){}try{return h(e,t,r,false)}catch(e){}if(t.polygons||t.polyline||t.polygon){return[]}if(t.triangles||t.triangulate||t.triangle){return{cells:[],positions:[]}}return{edges:[],positions:[]}}function d(e,t,r,n){var i=n.size||64;var a=n.font||"normal";r.font=i+"px "+a;r.textAlign="start";r.textBaseline="alphabetic";r.direction="ltr";var o=f(t,r,e,i);return v(o,n,i)}},{cdt2d:49,"clean-pslg":59,ndarray:270,"planar-graph-to-polyline":281,"simplify-planar-graph":320,"surface-nets":326}],338:[function(e,t,r){(function e(){"use strict";if(typeof ses!=="undefined"&&ses.ok&&!ses.ok()){return}function r(e){if(e.permitHostObjects___){e.permitHostObjects___(r)}}if(typeof ses!=="undefined"){ses.weakMapPermitHostObjects=r}var n=false;if(typeof WeakMap==="function"){var i=WeakMap;if(typeof navigator!=="undefined"&&/Firefox/.test(navigator.userAgent)){}else{var a=new i;var o=Object.freeze({});a.set(o,1);if(a.get(o)!==1){n=true}else{t.exports=WeakMap;return}}}var s=Object.prototype.hasOwnProperty;var l=Object.getOwnPropertyNames;var u=Object.defineProperty;var f=Object.isExtensible;var c="weakmap:";var h=c+"ident:"+Math.random()+"___";if(typeof crypto!=="undefined"&&typeof crypto.getRandomValues==="function"&&typeof ArrayBuffer==="function"&&typeof Uint8Array==="function"){var v=new ArrayBuffer(25);var d=new Uint8Array(v);crypto.getRandomValues(d);h=c+"rand:"+Array.prototype.map.call(d,function(e){return(e%36).toString(36)}).join("")+"___"}function p(e){return!(e.substr(0,c.length)==c&&e.substr(e.length-3)==="___")}u(Object,"getOwnPropertyNames",{value:function e(t){return l(t).filter(p)}});if("getPropertyNames"in Object){var g=Object.getPropertyNames;u(Object,"getPropertyNames",{value:function e(t){return g(t).filter(p)}})}function m(e){if(e!==Object(e)){throw new TypeError("Not an object: "+e)}var t=e[h];if(t&&t.key===e){return t}if(!f(e)){return void 0}t={key:e};try{u(e,h,{value:t,writable:false,enumerable:false,configurable:false});return t}catch(e){return void 0}}(function(){var e=Object.freeze;u(Object,"freeze",{value:function t(r){m(r);return e(r)}});var t=Object.seal;u(Object,"seal",{value:function e(r){m(r);return t(r)}});var r=Object.preventExtensions;u(Object,"preventExtensions",{value:function e(t){m(t);return r(t)}})})();function y(e){e.prototype=null;return Object.freeze(e)}var b=false;function x(){if(!b&&typeof console!=="undefined"){b=true;console.warn("WeakMap should be invoked as new WeakMap(), not "+"WeakMap(). This will be an error in the future.")}}var _=0;var w=function(){if(!(this instanceof w)){x()}var e=[];var t=[];var r=_++;function n(n,i){var a;var o=m(n);if(o){return r in o?o[r]:i}else{a=e.indexOf(n);return a>=0?t[a]:i}}function i(t){var n=m(t);if(n){return r in n}else{return e.indexOf(t)>=0}}function a(n,i){var a;var o=m(n);if(o){o[r]=i}else{a=e.indexOf(n);if(a>=0){t[a]=i}else{a=e.length;t[a]=i;e[a]=n}}return this}function o(n){var i=m(n);var a,o;if(i){return r in i&&delete i[r]}else{a=e.indexOf(n);if(a<0){return false}o=e.length-1;e[a]=void 0;t[a]=t[o];e[a]=e[o];e.length=o;t.length=o;return true}}return Object.create(w.prototype,{get___:{value:y(n)},has___:{value:y(i)},set___:{value:y(a)},delete___:{value:y(o)}})};w.prototype=Object.create(Object.prototype,{get:{value:function e(t,r){return this.get___(t,r)},writable:true,configurable:true},has:{value:function e(t){return this.has___(t)},writable:true,configurable:true},set:{value:function e(t,r){return this.set___(t,r)},writable:true,configurable:true},delete:{value:function e(t){return this.delete___(t)},writable:true,configurable:true}});if(typeof i==="function"){(function(){if(n&&typeof Proxy!=="undefined"){Proxy=undefined}function e(){if(!(this instanceof w)){x()}var e=new i;var t=undefined;var a=false;function o(r,n){if(t){return e.has(r)?e.get(r):t.get___(r,n)}else{return e.get(r,n)}}function s(r){return e.has(r)||(t?t.has___(r):false)}var l;if(n){l=function(r,n){e.set(r,n);if(!e.has(r)){if(!t){t=new w}t.set(r,n)}return this}}else{l=function(r,n){if(a){try{e.set(r,n)}catch(e){if(!t){t=new w}t.set___(r,n)}}else{e.set(r,n)}return this}}function u(r){var n=!!e["delete"](r);if(t){return t.delete___(r)||n}return n}return Object.create(w.prototype,{get___:{value:y(o)},has___:{value:y(s)},set___:{value:y(l)},delete___:{value:y(u)},permitHostObjects___:{value:y(function(e){if(e===r){a=true}else{throw new Error("bogus call to permitHostObjects___")}})}})}e.prototype=w.prototype;t.exports=e;Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:false,configurable:true,writable:true})})()}else{if(typeof Proxy!=="undefined"){Proxy=undefined}t.exports=w}})()},{}],339:[function(e,t,r){var n=e("./hidden-store.js");t.exports=i;function i(){var e={};return function(t){if((typeof t!=="object"||t===null)&&typeof t!=="function"){throw new Error("Weakmap-shim: Key must be object")}var r=t.valueOf(e);return r&&r.identity===e?r:n(t,e)}}},{"./hidden-store.js":340}],340:[function(e,t,r){t.exports=n;function n(e,t){var r={identity:t};var n=e.valueOf;Object.defineProperty(e,"valueOf",{value:function(e){return e!==t?n.apply(this,arguments):r},writable:true});return r}},{}],341:[function(e,t,r){var n=e("./create-store.js");t.exports=i;function i(){var e=n();return{get:function(t,r){var n=e(t);return n.hasOwnProperty("value")?n.value:r},set:function(t,r){e(t).value=r;return this},has:function(t){return"value"in e(t)},delete:function(t){return delete e(t).value}}}},{"./create-store.js":339}],342:[function(e,t,r){var n=e("get-canvas-context");t.exports=function e(t){return n("webgl",t)}},{"get-canvas-context":95}],343:[function(e,t,r){t.exports=e("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg2_",lvalue:false,rvalue:true,count:1},{name:"_inline_1_arg3_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg4_",lvalue:false,rvalue:true,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":77}],344:[function(e,t,r){"use strict";t.exports=i;var n=e("./lib/zc-core");function i(e,t){var r=[];t=+t||0;n(e.hi(e.shape[0]-1),r,t);return r}},{"./lib/zc-core":343}],345:[function(e,t,r){"use strict";t.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:true},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:true}]},{}],346:[function(e,t,r){"use strict";var n=e("./arrow_paths");var i=e("../../plots/font_attributes");var a=e("../../plots/cartesian/constants");var o=e("../../plot_api/plot_template").templatedArray;t.exports=o("annotation",{visible:{valType:"boolean",dflt:true,editType:"calcIfAutorange+arraydraw"},text:{valType:"string",editType:"calcIfAutorange+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calcIfAutorange+arraydraw"},font:i({editType:"calcIfAutorange+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calcIfAutorange+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calcIfAutorange+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calcIfAutorange+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calcIfAutorange+arraydraw"},showarrow:{valType:"boolean",dflt:true,editType:"calcIfAutorange+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:n.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:n.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calcIfAutorange+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calcIfAutorange+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calcIfAutorange+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calcIfAutorange+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calcIfAutorange+arraydraw"},ax:{valType:"any",editType:"calcIfAutorange+arraydraw"},ay:{valType:"any",editType:"calcIfAutorange+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",a.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",a.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",a.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calcIfAutorange+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calcIfAutorange+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calcIfAutorange+arraydraw"},yref:{valType:"enumerated",values:["paper",a.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calcIfAutorange+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calcIfAutorange+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calcIfAutorange+arraydraw"},clicktoshow:{valType:"enumerated",values:[false,"onoff","onout"],dflt:false,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:i({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../plot_api/plot_template":519,"../../plots/cartesian/constants":534,"../../plots/font_attributes":555,"./arrow_paths":345}],347:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");var a=e("./draw").draw;t.exports=function e(t){var r=t._fullLayout,s=n.filterVisible(r.annotations);if(!s.length||!t._fullData.length)return;var l={};s.forEach(function(e){l[e.xref]=1;l[e.yref]=1});for(var u in l){var f=i.getFromId(t,u);if(f&&f.autorange){return n.syncOrAsync([a,o],t)}}};function o(e){var t=e._fullLayout;n.filterVisible(t.annotations).forEach(function(t){var r=i.getFromId(e,t.xref),n=i.getFromId(e,t.yref),a=3*t.arrowsize*t.arrowwidth||0,o=3*t.startarrowsize*t.arrowwidth||0;var s,l,u,f;if(r&&r.autorange){s=a+t.xshift;l=a-t.xshift;u=o+t.xshift;f=o-t.xshift;if(t.axref===t.xref){i.expand(r,[r.r2c(t.x)],{ppadplus:s,ppadminus:l});i.expand(r,[r.r2c(t.ax)],{ppadplus:Math.max(t._xpadplus,u),ppadminus:Math.max(t._xpadminus,f)})}else{u=t.ax?u+t.ax:u;f=t.ax?f-t.ax:f;i.expand(r,[r.r2c(t.x)],{ppadplus:Math.max(t._xpadplus,s,u),ppadminus:Math.max(t._xpadminus,l,f)})}}if(n&&n.autorange){s=a-t.yshift;l=a+t.yshift;u=o-t.yshift;f=o+t.yshift;if(t.ayref===t.yref){i.expand(n,[n.r2c(t.y)],{ppadplus:s,ppadminus:l});i.expand(n,[n.r2c(t.ay)],{ppadplus:Math.max(t._ypadplus,u),ppadminus:Math.max(t._ypadminus,f)})}else{u=t.ay?u+t.ay:u;f=t.ay?f-t.ay:f;i.expand(n,[n.r2c(t.y)],{ppadplus:Math.max(t._ypadplus,s,u),ppadminus:Math.max(t._ypadminus,l,f)})}}})}},{"../../lib":483,"../../plots/cartesian/axes":529,"./draw":352}],348:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../registry");var a=e("../../plot_api/plot_template").arrayEditor;t.exports={hasClickToShow:o,onClick:s};function o(e,t){var r=l(e,t);return r.on.length>0||r.explicitOff.length>0}function s(e,t){var r=l(e,t);var o=r.on;var s=r.off.concat(r.explicitOff);var u={};var f=e._fullLayout.annotations;var c,h;if(!(o.length||s.length))return;for(c=0;c<o.length;c++){h=a(e.layout,"annotations",f[o[c]]);h.modifyItem("visible",true);n.extendFlat(u,h.getUpdateObj())}for(c=0;c<s.length;c++){h=a(e.layout,"annotations",f[s[c]]);h.modifyItem("visible",false);n.extendFlat(u,h.getUpdateObj())}return i.call("update",e,{},u)}function l(e,t){var r=e._fullLayout.annotations,n=[],i=[],a=[],o=(t||[]).length;var s,l,f,c,h,v,d,p;for(s=0;s<r.length;s++){f=r[s];c=f.clicktoshow;if(c){for(l=0;l<o;l++){h=t[l];v=h.xaxis;d=h.yaxis;if(v._id===f.xref&&d._id===f.yref&&v.d2r(h.x)===u(f._xclick,v)&&d.d2r(h.y)===u(f._yclick,d)){if(f.visible){if(c==="onout")p=i;else p=a}else{p=n}p.push(s);break}}if(l===o){if(f.visible&&c==="onout")i.push(s)}}}return{on:n,off:i,explicitOff:a}}function u(e,t){return t.type==="log"?t.l2r(e):t.d2r(e)}},{"../../lib":483,"../../plot_api/plot_template":519,"../../registry":582}],349:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../color");t.exports=function e(t,r,a,o){o("opacity");var s=o("bgcolor");var l=o("bordercolor");var u=i.opacity(l);o("borderpad");var f=o("borderwidth");var c=o("showarrow");o("text",c?" ":a._dfltTitle.annotation);o("textangle");n.coerceFont(o,"font",a.font);o("width");o("align");var h=o("height");if(h)o("valign");if(c){var v=o("arrowside");var d;var p;if(v.indexOf("end")!==-1){d=o("arrowhead");p=o("arrowsize")}if(v.indexOf("start")!==-1){o("startarrowhead",d);o("startarrowsize",p)}o("arrowcolor",u?r.bordercolor:i.defaultLine);o("arrowwidth",(u&&f||1)*2);o("standoff");o("startstandoff")}var g=o("hovertext");var m=a.hoverlabel||{};if(g){var y=o("hoverlabel.bgcolor",m.bgcolor||(i.opacity(s)?i.rgb(s):i.defaultLine));var b=o("hoverlabel.bordercolor",m.bordercolor||i.contrast(y));n.coerceFont(o,"hoverlabel.font",{family:m.font.family,size:m.font.size,color:m.font.color||b})}o("captureevents",!!g)}},{"../../lib":483,"../color":361}],350:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib/to_log_range");t.exports=function e(t,r,a,o){r=r||{};var s=a==="log"&&r.type==="linear",l=a==="linear"&&r.type==="log";if(!(s||l))return;var u=t._fullLayout.annotations,f=r._id.charAt(0),c,h;function v(e){var t=c[e],a=null;if(s)a=i(t,r.range);else a=Math.pow(10,t);if(!n(a))a=null;o(h+e,a)}for(var d=0;d<u.length;d++){c=u[d];h="annotations["+d+"].";if(c[f+"ref"]===r._id)v(f);if(c["a"+f+"ref"]===r._id)v("a"+f)}}},{"../../lib/to_log_range":508,"fast-isnumeric":91}],351:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");var a=e("../../plots/array_container_defaults");var o=e("./common_defaults");var s=e("./attributes");t.exports=function e(t,r){a(t,r,{name:"annotations",handleItemDefaults:l})};function l(e,t,r){function a(r,i){return n.coerce(e,t,s,r,i)}var l=a("visible");var u=a("clicktoshow");if(!(l||u))return;o(e,t,r,a);var f=t.showarrow;var c=["x","y"],h=[-10,-30],v={_fullLayout:r};for(var d=0;d<2;d++){var p=c[d];var g=i.coerceRef(e,t,v,p,"","paper");i.coercePosition(t,v,a,g,p,.5);if(f){var m="a"+p,y=i.coerceRef(e,t,v,m,"pixel");if(y!=="pixel"&&y!==g){y=t[m]="pixel"}var b=y==="pixel"?h[d]:.4;i.coercePosition(t,v,a,y,m,b)}a(p+"anchor");a(p+"shift")}n.noneOrAll(e,t,["x","y"]);if(f){n.noneOrAll(e,t,["ax","ay"])}if(u){var x=a("xclick");var _=a("yclick");t._xclick=x===undefined?t.x:i.cleanPosition(x,v,t.xref);t._yclick=_===undefined?t.y:i.cleanPosition(_,v,t.yref)}}},{"../../lib":483,"../../plots/array_container_defaults":525,"../../plots/cartesian/axes":529,"./attributes":346,"./common_defaults":349}],352:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../plots/plots");var o=e("../../lib");var s=e("../../plots/cartesian/axes");var l=e("../color");var u=e("../drawing");var f=e("../fx");var c=e("../../lib/svg_text_utils");var h=e("../../lib/setcursor");var v=e("../dragelement");var d=e("../../plot_api/plot_template").arrayEditor;var p=e("./draw_arrow_head");t.exports={draw:g,drawOne:m,drawRaw:y};function g(e){var t=e._fullLayout;t._infolayer.selectAll(".annotation").remove();for(var r=0;r<t.annotations.length;r++){if(t.annotations[r].visible){m(e,r)}}return a.previousPromises(e)}function m(e,t){var r=e._fullLayout;var n=r.annotations[t]||{};var i=s.getFromId(e,n.xref);var a=s.getFromId(e,n.yref);y(e,n,t,false,i,a)}function y(e,t,r,a,s,g){var m=e._fullLayout;var y=e._fullLayout._size;var b=e._context.edits;var x,_;if(a){x="annotation-"+a;_=a+".annotations"}else{x="annotation";_="annotations"}var w=d(e.layout,_,t);var M=w.modifyBase;var A=w.modifyItem;var T=w.getUpdateObj;m._infolayer.selectAll("."+x+'[data-index="'+r+'"]').remove();var k="clip"+m._uid+"_ann"+r;if(!t._input||t.visible===false){n.selectAll("#"+k).remove();return}var E={x:{},y:{}},S=+t.textangle||0;var L=m._infolayer.append("g").classed(x,true).attr("data-index",String(r)).style("opacity",t.opacity);var C=L.append("g").classed("annotation-text-g",true);var I=b[t.showarrow?"annotationTail":"annotationPosition"];var P=t.captureevents||b.annotationText||I;var O=C.append("g").style("pointer-events",P?"all":null).call(h,"pointer").on("click",function(){e._dragging=false;var i={index:r,annotation:t._input,fullAnnotation:t,event:n.event};if(a){i.subplotId=a}e.emit("plotly_clickannotation",i)});if(t.hovertext){O.on("mouseover",function(){var r=t.hoverlabel;var n=r.font;var i=this.getBoundingClientRect();var a=e.getBoundingClientRect();f.loneHover({x0:i.left-a.left,x1:i.right-a.left,y:(i.top+i.bottom)/2-a.top,text:t.hovertext,color:r.bgcolor,borderColor:r.bordercolor,fontFamily:n.family,fontSize:n.size,fontColor:n.color},{container:m._hoverlayer.node(),outerContainer:m._paper.node(),gd:e})}).on("mouseout",function(){f.loneUnhover(m._hoverlayer.node())})}var R=t.borderwidth,N=t.borderpad,z=R+N;var D=O.append("rect").attr("class","bg").style("stroke-width",R+"px").call(l.stroke,t.bordercolor).call(l.fill,t.bgcolor);var F=t.width||t.height;var j=m._topclips.selectAll("#"+k).data(F?[0]:[]);j.enter().append("clipPath").classed("annclip",true).attr("id",k).append("rect");j.exit().remove();var B=t.font;var U=O.append("text").classed("annotation-text",true).text(t.text);function V(r){r.call(u.font,B).attr({"text-anchor":{left:"start",right:"end"}[t.align]||"middle"});c.convertToTspans(r,e,H);return r}function H(){var r=U.selectAll("a");if(r.size()===1&&r.text()===U.text()){var n=O.insert("a",":first-child").attr({"xlink:xlink:href":r.attr("xlink:href"),"xlink:xlink:show":r.attr("xlink:show")}).style({cursor:"pointer"});n.node().appendChild(D.node())}var f=O.select(".annotation-text-math-group");var d=!f.empty();var x=u.bBox((d?f:U).node());var _=x.width;var w=x.height;var P=t.width||_;var N=t.height||w;var B=Math.round(P+2*z);var V=Math.round(N+2*z);t._w=P;t._h=N;function H(e,t){if(t==="auto"){if(e<1/3)t="left";else if(e>2/3)t="right";else t="center"}return{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[t]}var q=false;var G=["x","y"];for(var W=0;W<G.length;W++){var X=G[W],Y=t[X+"ref"]||X,Z=t["a"+X+"ref"],Q={x:s,y:g}[X],K=(S+(X==="x"?0:-90))*Math.PI/180,J=B*Math.cos(K),$=V*Math.sin(K),ee=Math.abs(J)+Math.abs($),te=t[X+"anchor"],re=t[X+"shift"]*(X==="x"?1:-1),ne=E[X],ie,ae,oe,se,le;if(Q){var ue=Q.r2fraction(t[X]);if((e._dragging||!Q.autorange)&&(ue<0||ue>1)){if(Z===Y){ue=Q.r2fraction(t["a"+X]);if(ue<0||ue>1){q=true}}else{q=true}if(q)continue}ie=Q._offset+Q.r2p(t[X]);se=.5}else{if(X==="x"){oe=t[X];ie=y.l+y.w*oe}else{oe=1-t[X];ie=y.t+y.h*oe}se=t.showarrow?.5:oe}if(t.showarrow){ne.head=ie;var fe=t["a"+X];le=J*H(.5,t.xanchor)-$*H(.5,t.yanchor);if(Z===Y){ne.tail=Q._offset+Q.r2p(fe);ae=le}else{ne.tail=ie+fe;ae=le+fe}ne.text=ne.tail+le;var ce=m[X==="x"?"width":"height"];if(Y==="paper"){ne.head=o.constrain(ne.head,1,ce-1)}if(Z==="pixel"){var he=-Math.max(ne.tail-3,ne.text),ve=Math.min(ne.tail+3,ne.text)-ce;if(he>0){ne.tail+=he;ne.text+=he}else if(ve>0){ne.tail-=ve;ne.text-=ve}}ne.tail+=re;ne.head+=re}else{le=ee*H(se,te);ae=le;ne.text=ie+le}ne.text+=re;le+=re;ae+=re;t["_"+X+"padplus"]=ee/2+ae;t["_"+X+"padminus"]=ee/2-ae;t["_"+X+"size"]=ee;t["_"+X+"shift"]=le}if(q){O.remove();return}var de=0;var pe=0;if(t.align!=="left"){de=(P-_)*(t.align==="center"?.5:1)}if(t.valign!=="top"){pe=(N-w)*(t.valign==="middle"?.5:1)}if(d){f.select("svg").attr({x:z+de-1,y:z+pe}).call(u.setClipUrl,F?k:null)}else{var ge=z+pe-x.top;var me=z+de-x.left;U.call(c.positionText,me,ge).call(u.setClipUrl,F?k:null)}j.select("rect").call(u.setRect,z,z,P,N);D.call(u.setRect,R/2,R/2,B-R,V-R);O.call(u.setTranslate,Math.round(E.x.text-B/2),Math.round(E.y.text-V/2));C.attr({transform:"rotate("+S+","+E.x.text+","+E.y.text+")"});var ye=function(r,n){L.selectAll(".annotation-arrow-g").remove();var f=E.x.head,c=E.y.head,h=E.x.tail+r,d=E.y.tail+n,m=E.x.text+r,x=E.y.text+n,_=o.rotationXYMatrix(S,m,x),w=o.apply2DTransform(_),k=o.apply2DTransform2(_),I=+D.attr("width"),P=+D.attr("height"),R=m-.5*I,N=R+I,z=x-.5*P,F=z+P,j=[[R,z,R,F],[R,F,N,F],[N,F,N,z],[N,z,R,z]].map(k);if(j.reduce(function(e,t){return e^!!o.segmentsIntersect(f,c,f+1e6,c+1e6,t[0],t[1],t[2],t[3])},false)){return}j.forEach(function(e){var t=o.segmentsIntersect(h,d,f,c,e[0],e[1],e[2],e[3]);if(t){h=t.x;d=t.y}});var B=t.arrowwidth,U=t.arrowcolor,V=t.arrowside;var H=L.append("g").style({opacity:l.opacity(U)}).classed("annotation-arrow-g",true);var q=H.append("path").attr("d","M"+h+","+d+"L"+f+","+c).style("stroke-width",B+"px").call(l.stroke,l.rgb(U));p(q,V,t);if(b.annotationPosition&&q.node().parentNode&&!a){var G=f;var W=c;if(t.standoff){var X=Math.sqrt(Math.pow(f-h,2)+Math.pow(c-d,2));G+=t.standoff*(h-f)/X;W+=t.standoff*(d-c)/X}var Y=H.append("path").classed("annotation-arrow",true).classed("anndrag",true).classed("cursor-move",true).attr({d:"M3,3H-3V-3H3ZM0,0L"+(h-G)+","+(d-W),transform:"translate("+G+","+W+")"}).style("stroke-width",B+6+"px").call(l.stroke,"rgba(0,0,0,0)").call(l.fill,"rgba(0,0,0,0)");var Z,Q;v.init({element:Y.node(),gd:e,prepFn:function(){var e=u.getTranslate(O);Z=e.x;Q=e.y;if(s&&s.autorange){M(s._name+".autorange",true)}if(g&&g.autorange){M(g._name+".autorange",true)}},moveFn:function(e,r){var n=w(Z,Q),i=n[0]+e,a=n[1]+r;O.call(u.setTranslate,i,a);A("x",s?s.p2r(s.r2p(t.x)+e):t.x+e/y.w);A("y",g?g.p2r(g.r2p(t.y)+r):t.y-r/y.h);if(t.axref===t.xref){A("ax",s.p2r(s.r2p(t.ax)+e))}if(t.ayref===t.yref){A("ay",g.p2r(g.r2p(t.ay)+r))}H.attr("transform","translate("+e+","+r+")");C.attr({transform:"rotate("+S+","+i+","+a+")"})},doneFn:function(){i.call("relayout",e,T());var t=document.querySelector(".js-notes-box-panel");if(t)t.redraw(t.selectedObj)}})}};if(t.showarrow)ye(0,0);if(I){var be;v.init({element:O.node(),gd:e,prepFn:function(){be=C.attr("transform")},moveFn:function(e,r){var n="pointer";if(t.showarrow){if(t.axref===t.xref){A("ax",s.p2r(s.r2p(t.ax)+e))}else{A("ax",t.ax+e)}if(t.ayref===t.yref){A("ay",g.p2r(g.r2p(t.ay)+r))}else{A("ay",t.ay+r)}ye(e,r)}else if(!a){var i,o;if(s){i=s.p2r(s.r2p(t.x)+e)}else{var l=t._xsize/y.w,u=t.x+(t._xshift-t.xshift)/y.w-l/2;i=v.align(u+e/y.w,l,0,1,t.xanchor)}if(g){o=g.p2r(g.r2p(t.y)+r)}else{var f=t._ysize/y.h,c=t.y-(t._yshift+t.yshift)/y.h-f/2;o=v.align(c-r/y.h,f,0,1,t.yanchor)}A("x",i);A("y",o);if(!s||!g){n=v.getCursor(s?.5:i,g?.5:o,t.xanchor,t.yanchor)}}else return;C.attr({transform:"translate("+e+","+r+")"+be});h(O,n)},doneFn:function(){h(O);i.call("relayout",e,T());var t=document.querySelector(".js-notes-box-panel");if(t)t.redraw(t.selectedObj)}})}}if(b.annotationText){U.call(c.makeEditable,{delegate:O,gd:e}).call(V).on("edit",function(r){t.text=r;this.call(V);A("text",r);if(s&&s.autorange){M(s._name+".autorange",true)}if(g&&g.autorange){M(g._name+".autorange",true)}i.call("relayout",e,T())})}else U.call(V)}},{"../../lib":483,"../../lib/setcursor":502,"../../lib/svg_text_utils":506,"../../plot_api/plot_template":519,"../../plots/cartesian/axes":529,"../../plots/plots":573,"../../registry":582,"../color":361,"../dragelement":383,"../drawing":386,"../fx":403,"./draw_arrow_head":353,d3:81}],353:[function(e,t,r){"use strict";var n=e("d3");var i=e("../color");var a=e("./arrow_paths");t.exports=function e(t,r,o){var s=t.node();var l=a[o.arrowhead||0];var u=a[o.startarrowhead||0];var f=(o.arrowwidth||1)*(o.arrowsize||1);var c=(o.arrowwidth||1)*(o.startarrowsize||1);var h=r.indexOf("start")>=0;var v=r.indexOf("end")>=0;var d=l.backoff*f+o.standoff;var p=u.backoff*c+o.startstandoff;var g,m,y,b;if(s.nodeName==="line"){g={x:+t.attr("x1"),y:+t.attr("y1")};m={x:+t.attr("x2"),y:+t.attr("y2")};var x=g.x-m.x;var _=g.y-m.y;y=Math.atan2(_,x);b=y+Math.PI;if(d&&p){if(d+p>Math.sqrt(x*x+_*_)){O();return}}if(d){if(d*d>x*x+_*_){O();return}var w=d*Math.cos(y),M=d*Math.sin(y);m.x+=w;m.y+=M;t.attr({x2:m.x,y2:m.y})}if(p){if(p*p>x*x+_*_){O();return}var A=p*Math.cos(y),T=p*Math.sin(y);g.x-=A;g.y-=T;t.attr({x1:g.x,y1:g.y})}}else if(s.nodeName==="path"){var k=s.getTotalLength(),E="";if(k<d+p){O();return}var S=s.getPointAtLength(0);var L=s.getPointAtLength(.1);y=Math.atan2(S.y-L.y,S.x-L.x);g=s.getPointAtLength(Math.min(p,k));E="0px,"+p+"px,";var C=s.getPointAtLength(k);var I=s.getPointAtLength(k-.1);b=Math.atan2(C.y-I.y,C.x-I.x);m=s.getPointAtLength(Math.max(0,k-d));var P=E?p+d:d;E+=k-P+"px,"+k+"px";t.style("stroke-dasharray",E)}function O(){t.style("stroke-dasharray","0px,100px")}function R(e,r,a,l){if(!e.path)return;if(e.noRotate)a=0;n.select(s.parentNode).append("path").attr({class:t.attr("class"),d:e.path,transform:"translate("+r.x+","+r.y+")"+(a?"rotate("+a*180/Math.PI+")":"")+"scale("+l+")"}).style({fill:i.rgb(o.arrowcolor),"stroke-width":0})}if(h)R(u,g,y,c);if(v)R(l,m,b,f)}},{"../color":361,"./arrow_paths":345,d3:81}],354:[function(e,t,r){"use strict";var n=e("./draw");var i=e("./click");t.exports={moduleType:"component",name:"annotations",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("annotations"),calcAutorange:e("./calc_autorange"),draw:n.draw,drawOne:n.drawOne,drawRaw:n.drawRaw,hasClickToShow:i.hasClickToShow,onClick:i.onClick,convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":539,"./attributes":346,"./calc_autorange":347,"./click":348,"./convert_coords":350,"./defaults":351,"./draw":352}],355:[function(e,t,r){"use strict";var n=e("../annotations/attributes");var i=e("../../plot_api/edit_types").overrideAll;var a=e("../../plot_api/plot_template").templatedArray;t.exports=i(a("annotation",{visible:n.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:n.xanchor,xshift:n.xshift,yanchor:n.yanchor,yshift:n.yshift,text:n.text,textangle:n.textangle,font:n.font,width:n.width,height:n.height,opacity:n.opacity,align:n.align,valign:n.valign,bgcolor:n.bgcolor,bordercolor:n.bordercolor,borderpad:n.borderpad,borderwidth:n.borderwidth,showarrow:n.showarrow,arrowcolor:n.arrowcolor,arrowhead:n.arrowhead,startarrowhead:n.startarrowhead,arrowside:n.arrowside,arrowsize:n.arrowsize,startarrowsize:n.startarrowsize,arrowwidth:n.arrowwidth,standoff:n.standoff,startstandoff:n.startstandoff,hovertext:n.hovertext,hoverlabel:n.hoverlabel,captureevents:n.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":512,"../../plot_api/plot_template":519,"../annotations/attributes":346}],356:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");t.exports=function e(t){var r=t.fullSceneLayout;var n=r.annotations;for(var i=0;i<n.length;i++){a(n[i],t)}t.fullLayout._infolayer.selectAll(".annotation-"+t.id).remove()};function a(e,t){var r=t.fullSceneLayout;var a=r.domain;var o=t.fullLayout._size;var s={pdata:null,type:"linear",autorange:false,range:[-Infinity,Infinity]};e._xa={};n.extendFlat(e._xa,s);i.setConvert(e._xa);e._xa._offset=o.l+a.x[0]*o.w;e._xa.l2p=function(){return.5*(1+e._pdata[0]/e._pdata[3])*o.w*(a.x[1]-a.x[0])};e._ya={};n.extendFlat(e._ya,s);i.setConvert(e._ya);e._ya._offset=o.t+(1-a.y[1])*o.h;e._ya.l2p=function(){return.5*(1-e._pdata[1]/e._pdata[3])*o.h*(a.y[1]-a.y[0])}}},{"../../lib":483,"../../plots/cartesian/axes":529}],357:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");var a=e("../../plots/array_container_defaults");var o=e("../annotations/common_defaults");var s=e("./attributes");t.exports=function e(t,r,n){a(t,r,{name:"annotations",handleItemDefaults:l,fullLayout:n.fullLayout})};function l(e,t,r,a){function l(r,i){return n.coerce(e,t,s,r,i)}function u(e){var n=e+"axis";var a={_fullLayout:{}};a._fullLayout[n]=r[n];return i.coercePosition(t,a,l,e,e,.5)}var f=l("visible");if(!f)return;o(e,t,a.fullLayout,l);u("x");u("y");u("z");n.noneOrAll(e,t,["x","y","z"]);t.xref="x";t.yref="y";t.zref="z";l("xanchor");l("yanchor");l("xshift");l("yshift");if(t.showarrow){t.axref="pixel";t.ayref="pixel";l("ax",-10);l("ay",-30);n.noneOrAll(e,t,["ax","ay"])}}},{"../../lib":483,"../../plots/array_container_defaults":525,"../../plots/cartesian/axes":529,"../annotations/common_defaults":349,"./attributes":355}],358:[function(e,t,r){"use strict";var n=e("../annotations/draw").drawRaw;var i=e("../../plots/gl3d/project");var a=["x","y","z"];t.exports=function e(t){var r=t.fullSceneLayout;var o=t.dataScale;var s=r.annotations;for(var l=0;l<s.length;l++){var u=s[l];var f=false;for(var c=0;c<3;c++){var h=a[c];var v=u[h];var d=r[h+"axis"];var p=d.r2fraction(v);if(p<0||p>1){f=true;break}}if(f){t.fullLayout._infolayer.select(".annotation-"+t.id+'[data-index="'+l+'"]').remove()}else{u._pdata=i(t.glplot.cameraParams,[r.xaxis.r2l(u.x)*o[0],r.yaxis.r2l(u.y)*o[1],r.zaxis.r2l(u.z)*o[2]]);n(t.graphDiv,u,l,t.id,u._xa,u._ya)}}}},{"../../plots/gl3d/project":568,"../annotations/draw":352}],359:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");t.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),includeBasePlot:a,convert:e("./convert"),draw:e("./draw")};function a(e,t){var r=n.subplotsRegistry.gl3d;if(!r)return;var a=r.attrRegex;var o=Object.keys(e);for(var s=0;s<o.length;s++){var l=o[s];if(a.test(l)&&(e[l].annotations||[]).length){i.pushUnique(t._basePlotModules,r);i.pushUnique(t._subplots.gl3d,l)}}}},{"../../lib":483,"../../registry":582,"./attributes":355,"./convert":356,"./defaults":357,"./draw":358}],360:[function(e,t,r){"use strict";r.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];r.defaultLine="#444";r.lightLine="#eee";r.background="#fff";r.borderLine="#BEC8D9";r.lightFraction=100*(14-4)/(15-4)},{}],361:[function(e,t,r){"use strict";var n=e("tinycolor2");var i=e("fast-isnumeric");var a=t.exports={};var o=e("./attributes");a.defaults=o.defaults;var s=a.defaultLine=o.defaultLine;a.lightLine=o.lightLine;var l=a.background=o.background;a.tinyRGB=function(e){var t=e.toRgb();return"rgb("+Math.round(t.r)+", "+Math.round(t.g)+", "+Math.round(t.b)+")"};a.rgb=function(e){return a.tinyRGB(n(e))};a.opacity=function(e){return e?n(e).getAlpha():0};a.addOpacity=function(e,t){var r=n(e).toRgb();return"rgba("+Math.round(r.r)+", "+Math.round(r.g)+", "+Math.round(r.b)+", "+t+")"};a.combine=function(e,t){var r=n(e).toRgb();if(r.a===1)return n(e).toRgbString();var i=n(t||l).toRgb(),a=i.a===1?i:{r:255*(1-i.a)+i.r*i.a,g:255*(1-i.a)+i.g*i.a,b:255*(1-i.a)+i.b*i.a},o={r:a.r*(1-r.a)+r.r*r.a,g:a.g*(1-r.a)+r.g*r.a,b:a.b*(1-r.a)+r.b*r.a};return n(o).toRgbString()};a.contrast=function(e,t,r){var i=n(e);if(i.getAlpha()!==1)i=n(a.combine(e,l));var o=i.isDark()?t?i.lighten(t):l:r?i.darken(r):s;return o.toString()};a.stroke=function(e,t){var r=n(t);e.style({stroke:a.tinyRGB(r),"stroke-opacity":r.getAlpha()})};a.fill=function(e,t){var r=n(t);e.style({fill:a.tinyRGB(r),"fill-opacity":r.getAlpha()})};a.clean=function(e){if(!e||typeof e!=="object")return;var t=Object.keys(e),r,n,i,o;for(r=0;r<t.length;r++){i=t[r];o=e[i];if(i.substr(i.length-5)==="color"){if(Array.isArray(o)){for(n=0;n<o.length;n++)o[n]=u(o[n])}else e[i]=u(o)}else if(i.substr(i.length-10)==="colorscale"&&Array.isArray(o)){for(n=0;n<o.length;n++){if(Array.isArray(o[n]))o[n][1]=u(o[n][1])}}else if(Array.isArray(o)){var s=o[0];if(!Array.isArray(s)&&s&&typeof s==="object"){for(n=0;n<o.length;n++)a.clean(o[n])}}else if(o&&typeof o==="object")a.clean(o)}};function u(e){if(i(e)||typeof e!=="string")return e;var t=e.trim();if(t.substr(0,3)!=="rgb")return e;var r=t.match(/^rgba?\s*\(([^()]*)\)$/);if(!r)return e;var n=r[1].trim().split(/\s*[\s,]\s*/),a=t.charAt(3)==="a"&&n.length===4;if(!a&&n.length!==3)return e;for(var o=0;o<n.length;o++){if(!n[o].length)return e;n[o]=Number(n[o]);if(!(n[o]>=0))return e;if(o===3){if(n[o]>1)n[o]=1}else if(n[o]>=1)return e}var s=Math.round(n[0]*255)+", "+Math.round(n[1]*255)+", "+Math.round(n[2]*255);if(a)return"rgba("+s+", "+n[3]+")";return"rgb("+s+")"}},{"./attributes":360,"fast-isnumeric":91,tinycolor2:327}],362:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/layout_attributes");var i=e("../../plots/font_attributes");var a=e("../../lib/extend").extendFlat;var o=e("../../plot_api/edit_types").overrideAll;t.exports=o({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:n.linecolor,outlinewidth:n.linewidth,bordercolor:n.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:a({},n.ticks,{dflt:""}),ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,showticklabels:n.showticklabels,tickfont:i({}),tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,separatethousands:n.separatethousands,exponentformat:n.exponentformat,showexponent:n.showexponent,title:{valType:"string"},titlefont:i({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},"colorbars","from-root")},{"../../lib/extend":475,"../../plot_api/edit_types":512,"../../plots/cartesian/layout_attributes":541,"../../plots/font_attributes":555}],363:[function(e,t,r){"use strict";var n=e("../colorscale");var i=e("./draw");t.exports=function e(t,r,a){if(typeof a==="function")return a(t,r);var o=r[0].trace;var s="cb"+o.uid;var l=a.container;var u=l?o[l]:o;t._fullLayout._infolayer.selectAll("."+s).remove();if(!u||!u.showscale)return;var f=u[a.min];var c=u[a.max];var h=r[0].t.cb=i(t,s);var v=n.makeColorScaleFunc(n.extractScale(u.colorscale,f,c),{noNumericCheck:true});h.fillcolor(v).filllevels({start:f,end:c,size:(c-f)/254}).options(u.colorbar)()}},{"../colorscale":376,"./draw":366}],364:[function(e,t,r){"use strict";t.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],365:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plot_api/plot_template");var a=e("../../plots/cartesian/tick_value_defaults");var o=e("../../plots/cartesian/tick_mark_defaults");var s=e("../../plots/cartesian/tick_label_defaults");var l=e("./attributes");t.exports=function e(t,r,u){var f=i.newContainer(r,"colorbar"),c=t.colorbar||{};function h(e,t){return n.coerce(c,f,l,e,t)}var v=h("thicknessmode");h("thickness",v==="fraction"?30/(u.width-u.margin.l-u.margin.r):30);var d=h("lenmode");h("len",d==="fraction"?1:u.height-u.margin.t-u.margin.b);h("x");h("xanchor");h("xpad");h("y");h("yanchor");h("ypad");n.noneOrAll(c,f,["x","y"]);h("outlinecolor");h("outlinewidth");h("bordercolor");h("borderwidth");h("bgcolor");a(c,f,h,"linear");var p={outerTicks:false,font:u.font};s(c,f,h,"linear",p);o(c,f,h,"linear",p);h("title",u._dfltTitle.colorbar);n.coerceFont(h,"titlefont",u.font);h("titleside")}},{"../../lib":483,"../../plot_api/plot_template":519,"../../plots/cartesian/tick_label_defaults":548,"../../plots/cartesian/tick_mark_defaults":549,"../../plots/cartesian/tick_value_defaults":550,"./attributes":362}],366:[function(e,t,r){"use strict";var n=e("d3");var i=e("tinycolor2");var a=e("../../plots/plots");var o=e("../../registry");var s=e("../../plots/cartesian/axes");var l=e("../dragelement");var u=e("../../lib");var f=e("../../lib/extend").extendFlat;var c=e("../../lib/setcursor");var h=e("../drawing");var v=e("../color");var d=e("../titles");var p=e("../../lib/svg_text_utils");var g=e("../../constants/alignment");var m=g.LINE_SPACING;var y=g.FROM_TL;var b=g.FROM_BR;var x=e("../../plots/cartesian/axis_defaults");var _=e("../../plots/cartesian/position_defaults");var w=e("../../plots/cartesian/layout_attributes");var M=e("./attributes");var A=e("./constants").cn;t.exports=function e(t,r){var g={};Object.keys(M).forEach(function(e){g[e]=null});g.fillcolor=null;g.line={color:null,width:null,dash:null};g.levels={start:null,end:null,size:null};g.filllevels=null;function T(){var e=t._fullLayout,M=e._size;if(typeof g.fillcolor!=="function"&&typeof g.line.color!=="function"){e._infolayer.selectAll("g."+r).remove();return}var E=n.extent((typeof g.fillcolor==="function"?g.fillcolor:g.line.color).domain());var S=[];var L=[];var C=typeof g.line.color==="function"?g.line.color:function(){return g.line.color};var I=typeof g.fillcolor==="function"?g.fillcolor:function(){return g.fillcolor};var P;var O;var R=g.levels.end+g.levels.size/100,N=g.levels.size,z=1.001*E[0]-.001*E[1],D=1.001*E[1]-.001*E[0];for(O=0;O<1e5;O++){P=g.levels.start+O*N;if(N>0?P>=R:P<=R)break;if(P>z&&P<D)S.push(P)}if(typeof g.fillcolor==="function"){if(g.filllevels){R=g.filllevels.end+g.filllevels.size/100;N=g.filllevels.size;for(O=0;O<1e5;O++){P=g.filllevels.start+O*N;if(N>0?P>=R:P<=R)break;if(P>E[0]&&P<E[1])L.push(P)}}else{L=S.map(function(e){return e-g.levels.size/2});L.push(L[L.length-1]+g.levels.size)}}else if(g.fillcolor&&typeof g.fillcolor==="string"){L=[0]}if(g.levels.size<0){S.reverse();L.reverse()}var F=M.h,j=M.w,B=Math.round(g.thickness*(g.thicknessmode==="fraction"?j:1)),U=B/M.w,V=Math.round(g.len*(g.lenmode==="fraction"?F:1)),H=V/M.h,q=g.xpad/M.w,G=(g.borderwidth+g.outlinewidth)/2,W=g.ypad/M.h,X=Math.round(g.x*M.w+g.xpad),Y=g.x-U*({middle:.5,right:1}[g.xanchor]||0),Z=g.y+H*(({top:-.5,bottom:.5}[g.yanchor]||0)-.5),Q=Math.round(M.h*(1-Z)),K=Q-V,J,$={type:"linear",range:E,tickmode:g.tickmode,nticks:g.nticks,tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:g.ticks,ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,showticklabels:g.showticklabels,tickfont:g.tickfont,tickangle:g.tickangle,tickformat:g.tickformat,exponentformat:g.exponentformat,separatethousands:g.separatethousands,showexponent:g.showexponent,showtickprefix:g.showtickprefix,tickprefix:g.tickprefix,showticksuffix:g.showticksuffix,ticksuffix:g.ticksuffix,title:g.title,titlefont:g.titlefont,showline:true,anchor:"free",position:1},ee={type:"linear",_id:"y"+r},te={letter:"y",font:e.font,noHover:true,calendar:e.calendar};function re(e,t){return u.coerce($,ee,w,e,t)}x($,ee,re,te,e);_($,ee,re,te);ee.position=g.x+q+U;T.axis=ee;if(["top","bottom"].indexOf(g.titleside)!==-1){ee.titleside=g.titleside;ee.titlex=g.x+q;ee.titley=Z+(g.titleside==="top"?H-W:W)}if(g.line.color&&g.tickmode==="auto"){ee.tickmode="linear";ee.tick0=g.levels.start;var ne=g.levels.size;var ie=u.constrain((Q-K)/50,4,15)+1,ae=(E[1]-E[0])/((g.nticks||ie)*ne);if(ae>1){var oe=Math.pow(10,Math.floor(Math.log(ae)/Math.LN10));ne*=oe*u.roundUp(ae/oe,[2,5,10]);if((Math.abs(g.levels.start)/g.levels.size+1e-6)%1<2e-6){ee.tick0=0}}ee.dtick=ne}ee.domain=[Z+W,Z+H-W];ee.setScale();var se=u.ensureSingle(e._infolayer,"g",r,function(e){e.classed(A.colorbar,true).each(function(){var e=n.select(this);e.append("rect").classed(A.cbbg,true);e.append("g").classed(A.cbfills,true);e.append("g").classed(A.cblines,true);e.append("g").classed(A.cbaxis,true).classed(A.crisp,true);e.append("g").classed(A.cbtitleunshift,true).append("g").classed(A.cbtitle,true);e.append("rect").classed(A.cboutline,true);e.select(".cbtitle").datum(0)})});se.attr("transform","translate("+Math.round(M.l)+","+Math.round(M.t)+")");var le=se.select(".cbtitleunshift").attr("transform","translate(-"+Math.round(M.l)+",-"+Math.round(M.t)+")");ee._axislayer=se.select(".cbaxis");var ue=0;if(["top","bottom"].indexOf(g.titleside)!==-1){var fe=M.l+(g.x+q)*M.w,ce=ee.titlefont.size,he;if(g.titleside==="top"){he=(1-(Z+H-W))*M.h+M.t+3+ce*.75}else{he=(1-(Z+W))*M.h+M.t-3-ce*.25}de(ee._id+"title",{attributes:{x:fe,y:he,"text-anchor":"start"}})}function ve(){if(["top","bottom"].indexOf(g.titleside)!==-1){var r=se.select(".cbtitle"),a=r.select("text"),o=[-g.outlinewidth/2,g.outlinewidth/2],l=r.select(".h"+ee._id+"title-math-group").node(),f=15.6;if(a.node()){f=parseInt(a.node().style.fontSize,10)*m}if(l){ue=h.bBox(l).height;if(ue>f){o[1]-=(ue-f)/2}}else if(a.node()&&!a.classed(A.jsPlaceholder)){ue=h.bBox(a.node()).height}if(ue){ue+=5;if(g.titleside==="top"){ee.domain[1]-=ue/M.h;o[1]*=-1}else{ee.domain[0]+=ue/M.h;var c=p.lineCount(a);o[1]+=(1-c)*f}r.attr("transform","translate("+o+")");ee.setScale()}}se.selectAll(".cbfills,.cblines").attr("transform","translate(0,"+Math.round(M.h*(1-ee.domain[1]))+")");ee._axislayer.attr("transform","translate(0,"+Math.round(-M.t)+")");var v=se.select(".cbfills").selectAll("rect.cbfill").data(L);v.enter().append("rect").classed(A.cbfill,true).style("stroke","none");v.exit().remove();v.each(function(e,t){var r=[t===0?E[0]:(L[t]+L[t-1])/2,t===L.length-1?E[1]:(L[t]+L[t+1])/2].map(ee.c2p).map(Math.round);if(t!==L.length-1){r[1]+=r[1]>r[0]?1:-1}var a=I(e).replace("e-",""),o=i(a).toHexString();n.select(this).attr({x:X,width:Math.max(B,2),y:n.min(r),height:Math.max(n.max(r)-n.min(r),2),fill:o})});var d=se.select(".cblines").selectAll("path.cbline").data(g.line.color&&g.line.width?S:[]);d.enter().append("path").classed(A.cbline,true);d.exit().remove();d.each(function(e){n.select(this).attr("d","M"+X+","+(Math.round(ee.c2p(e))+g.line.width/2%1)+"h"+B).call(h.lineGroupStyle,g.line.width,C(e),g.line.dash)});ee._axislayer.selectAll("g."+ee._id+"tick,path").remove();ee._pos=X+B+(g.outlinewidth||0)/2-(g.ticks==="outside"?1:0);ee.side="right";return u.syncOrAsync([function(){return s.doTicksSingle(t,ee,true)},function(){if(["top","bottom"].indexOf(g.titleside)===-1){var r=ee.titlefont.size,i=ee._offset+ee._length/2,a=M.l+(ee.position||0)*M.w+(ee.side==="right"?10+r*(ee.showticklabels?1:.5):-10-r*(ee.showticklabels?.5:0));de("h"+ee._id+"title",{avoid:{selection:n.select(t).selectAll("g."+ee._id+"tick"),side:g.titleside,offsetLeft:M.l,offsetTop:0,maxShift:e.width},attributes:{x:a,y:i,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}}])}function de(r,n){var i=k();var a="colorbar.title";var o=i._module.colorbar.container;if(o)a=o+"."+a;var s={propContainer:ee,propName:a,traceIndex:i.index,placeholder:e._dfltTitle.colorbar,containerGroup:se.select(".cbtitle")};var l=r.charAt(0)==="h"?r.substr(1):"h"+r;se.selectAll("."+l+",."+l+"-math-group").remove();d.draw(t,r,f(s,n||{}))}function pe(){var e=B+g.outlinewidth/2+h.bBox(ee._axislayer.node()).width;J=le.select("text");if(J.node()&&!J.classed(A.jsPlaceholder)){var n=le.select(".h"+ee._id+"title-math-group").node(),i;if(n&&["top","bottom"].indexOf(g.titleside)!==-1){i=h.bBox(n).width}else{i=h.bBox(le.node()).right-X-M.l}e=Math.max(e,i)}var o=2*g.xpad+e+g.borderwidth+g.outlinewidth/2,s=Q-K;se.select(".cbbg").attr({x:X-g.xpad-(g.borderwidth+g.outlinewidth)/2,y:K-G,width:Math.max(o,2),height:Math.max(s+2*G,2)}).call(v.fill,g.bgcolor).call(v.stroke,g.bordercolor).style({"stroke-width":g.borderwidth});se.selectAll(".cboutline").attr({x:X,y:K+g.ypad+(g.titleside==="top"?ue:0),width:Math.max(B,2),height:Math.max(s-2*g.ypad-ue,2)}).call(v.stroke,g.outlinecolor).style({fill:"None","stroke-width":g.outlinewidth});var l=({center:.5,right:1}[g.xanchor]||0)*o;se.attr("transform","translate("+(M.l-l)+","+M.t+")");var u={};var f=y[g.yanchor];var c=b[g.yanchor];if(g.lenmode==="pixels"){u.y=g.y;u.t=s*f;u.b=s*c}else{u.t=u.b=0;u.yt=g.y+g.len*f;u.yb=g.y-g.len*c}var d=y[g.xanchor];var p=b[g.xanchor];if(g.thicknessmode==="pixels"){u.x=g.x;u.l=o*d;u.r=o*p}else{var m=o-B;u.l=m*d;u.r=m*p;u.xl=g.x-g.thickness*d;u.xr=g.x+g.thickness*p}a.autoMargin(t,r,u)}var ge=u.syncOrAsync([a.previousPromises,ve,a.previousPromises,pe],t);if(ge&&ge.then)(t._promises||[]).push(ge);if(t._context.edits.colorbarPosition){var me,ye,be;l.init({element:se.node(),gd:t,prepFn:function(){me=se.attr("transform");c(se)},moveFn:function(e,t){se.attr("transform",me+" "+"translate("+e+","+t+")");ye=l.align(Y+e/M.w,U,0,1,g.xanchor);be=l.align(Z-t/M.h,H,0,1,g.yanchor);var r=l.getCursor(ye,be,g.xanchor,g.yanchor);c(se,r)},doneFn:function(){c(se);if(ye!==undefined&&be!==undefined){o.call("restyle",t,{"colorbar.x":ye,"colorbar.y":be},k().index)}}})}return ge}function k(){var e=r.substr(2),n,i;for(n=0;n<t._fullData.length;n++){i=t._fullData[n];if(i.uid===e)return i}}Object.keys(g).forEach(function(e){T[e]=function(t){if(!arguments.length)return g[e];g[e]=u.isPlainObject(g[e])?u.extendFlat(g[e],t):t;return T}});T.options=function(e){Object.keys(e).forEach(function(t){if(typeof T[t]==="function"){T[t](e[t])}});return T};T._opts=g;return T}},{"../../constants/alignment":459,"../../lib":483,"../../lib/extend":475,"../../lib/setcursor":502,"../../lib/svg_text_utils":506,"../../plots/cartesian/axes":529,"../../plots/cartesian/axis_defaults":531,"../../plots/cartesian/layout_attributes":541,"../../plots/cartesian/position_defaults":544,"../../plots/plots":573,"../../registry":582,"../color":361,"../dragelement":383,"../drawing":386,"../titles":452,"./attributes":362,"./constants":364,d3:81,tinycolor2:327}],367:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t){return n.isPlainObject(t.colorbar)}},{"../../lib":483}],368:[function(e,t,r){"use strict";var n=e("./scales.js");var i=Object.keys(n);function a(e){return"`"+e+"`"}t.exports=function e(t,r){t=t||"";r=r||{};var i=r.cLetter||"c";var o="onlyIfNumerical"in r?r.onlyIfNumerical:Boolean(t);var s="noScale"in r?r.noScale:t==="marker.line";var l="showScaleDflt"in r?r.showScaleDflt:i==="z";var u=typeof r.colorscaleDflt==="string"?n[r.colorscaleDflt]:null;var f=r.editTypeOverride||"";var c=t?t+".":"";var h,v;if("colorAttr"in r){h=r.colorAttr;v=r.colorAttr}else{h={z:"z",c:"color"}[i];v="in "+a(c+h)}var d=o?" Has an effect only if "+v+"is set to a numerical array.":"";var p=i+"auto";var g=i+"min";var m=i+"max";var y=a(c+g);var b=a(c+m);var x=y+" and "+b;var _={};_[g]=_[m]=undefined;var w={};w[p]=false;var M={};if(h==="color"){M.color={valType:"color",arrayOk:true,editType:f||"style"}}M[p]={valType:"boolean",dflt:true,editType:"calc",impliedEdits:_};M[g]={valType:"number",dflt:null,editType:f||"plot",impliedEdits:w};M[m]={valType:"number",dflt:null,editType:f||"plot",impliedEdits:w};M.colorscale={valType:"colorscale",editType:"calc",dflt:u,impliedEdits:{autocolorscale:false}};M.autocolorscale={valType:"boolean",dflt:r.autoColorDflt===false?false:true,editType:"calc",impliedEdits:{colorscale:undefined}};M.reversescale={valType:"boolean",dflt:false,editType:"calc"};if(!s){M.showscale={valType:"boolean",dflt:l,editType:"calc"}}return M}},{"./scales.js":380}],369:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./scales");var a=e("./flip_scale");t.exports=function e(t,r,o,s){var l=t;var u=t._input;var f=t._fullInput;var c=t.updateStyle;function h(e,r,n){if(n===undefined)n=r;if(c){c(t._input,o?o+"."+e:e,r)}else{u[e]=r}l[e]=n;if(f&&t!==t._fullInput){if(c){c(t._fullInput,o?o+"."+e:e,n)}else{f[e]=n}}}if(o){l=n.nestedProperty(l,o).get();u=n.nestedProperty(u,o).get();f=n.nestedProperty(f,o).get()||{}}var v=s+"auto";var d=s+"min";var p=s+"max";var g=l[v];var m=l[d];var y=l[p];var b=l.colorscale;if(g!==false||m===undefined){m=n.aggNums(Math.min,null,r)}if(g!==false||y===undefined){y=n.aggNums(Math.max,null,r)}if(m===y){m-=.5;y+=.5}h(d,m);h(p,y);h(v,g!==false||m===undefined&&y===undefined);if(l.autocolorscale){if(m*y<0)b=i.RdBu;else if(m>=0)b=i.Reds;else b=i.Blues;h("colorscale",b,l.reversescale?a(b):b);if(!u.autocolorscale){h("autocolorscale",false)}}}},{"../../lib":483,"./flip_scale":373,"./scales":380}],370:[function(e,t,r){"use strict";var n=e("./scales");t.exports=n.RdBu},{"./scales":380}],371:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");var a=e("../colorbar/has_colorbar");var o=e("../colorbar/defaults");var s=e("./is_valid_scale");var l=e("./flip_scale");t.exports=function e(t,r,u,f,c){var h=c.prefix,v=c.cLetter,d=h.slice(0,h.length-1),p=h?i.nestedProperty(t,d).get()||{}:t,g=h?i.nestedProperty(r,d).get()||{}:r,m=p[v+"min"],y=p[v+"max"],b=p.colorscale;var x=n(m)&&n(y)&&m<y;f(h+v+"auto",!x);f(h+v+"min");f(h+v+"max");var _;if(b!==undefined)_=!s(b);f(h+"autocolorscale",_);var w=f(h+"colorscale");var M=f(h+"reversescale");if(M)g.colorscale=l(w);if(h==="marker.line.")return;var A;if(h)A=a(p);var T=f(h+"showscale",A);if(T)o(p,g,u)}},{"../../lib":483,"../colorbar/defaults":365,"../colorbar/has_colorbar":367,"./flip_scale":373,"./is_valid_scale":377,"fast-isnumeric":91}],372:[function(e,t,r){"use strict";t.exports=function e(t,r,n){var i=t.length,a=new Array(i),o=new Array(i);for(var s=0;s<i;s++){var l=t[s];a[s]=r+l[0]*(n-r);o[s]=l[1]}return{domain:a,range:o}}},{}],373:[function(e,t,r){"use strict";t.exports=function e(t){var r=t.length,n=new Array(r),i;for(var a=r-1,o=0;a>=0;a--,o++){i=t[a];n[o]=[1-i[0],i[1]]}return n}},{}],374:[function(e,t,r){"use strict";var n=e("./scales");var i=e("./default_scale");var a=e("./is_valid_scale_array");t.exports=function e(t,r){if(!r)r=i;if(!t)return r;function o(){try{t=n[t]||JSON.parse(t)}catch(e){t=r}}if(typeof t==="string"){o();if(typeof t==="string")o()}if(!a(t))return r;return t}},{"./default_scale":370,"./is_valid_scale_array":378,"./scales":380}],375:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");var a=e("./is_valid_scale");t.exports=function e(t,r){var o=r?i.nestedProperty(t,r).get()||{}:t;var s=o.color;var l=false;if(i.isArrayOrTypedArray(s)){for(var u=0;u<s.length;u++){if(n(s[u])){l=true;break}}}return i.isPlainObject(o)&&(l||o.showscale===true||n(o.cmin)&&n(o.cmax)||a(o.colorscale)||i.isPlainObject(o.colorbar))}},{"../../lib":483,"./is_valid_scale":377,"fast-isnumeric":91}],376:[function(e,t,r){"use strict";r.scales=e("./scales");r.defaultScale=e("./default_scale");r.attributes=e("./attributes");r.handleDefaults=e("./defaults");r.calc=e("./calc");r.hasColorscale=e("./has_colorscale");r.isValidScale=e("./is_valid_scale");r.getScale=e("./get_scale");r.flipScale=e("./flip_scale");r.extractScale=e("./extract_scale");r.makeColorScaleFunc=e("./make_color_scale_func")},{"./attributes":368,"./calc":369,"./default_scale":370,"./defaults":371,"./extract_scale":372,"./flip_scale":373,"./get_scale":374,"./has_colorscale":375,"./is_valid_scale":377,"./make_color_scale_func":379,"./scales":380}],377:[function(e,t,r){"use strict";var n=e("./scales");var i=e("./is_valid_scale_array");t.exports=function e(t){if(n[t]!==undefined)return true;else return i(t)}},{"./is_valid_scale_array":378,"./scales":380}],378:[function(e,t,r){"use strict";var n=e("tinycolor2");t.exports=function e(t){var r=0;if(!Array.isArray(t)||t.length<2)return false;if(!t[0]||!t[t.length-1])return false;if(+t[0][0]!==0||+t[t.length-1][0]!==1)return false;for(var i=0;i<t.length;i++){var a=t[i];if(a.length!==2||+a[0]<r||!n(a[1]).isValid()){return false}r=+a[0]}return true}},{tinycolor2:327}],379:[function(e,t,r){"use strict";var n=e("d3");var i=e("tinycolor2");var a=e("fast-isnumeric");var o=e("../color");t.exports=function e(t,r){r=r||{};var l=t.domain,u=t.range,f=u.length,c=new Array(f);for(var h=0;h<f;h++){var v=i(u[h]).toRgb();c[h]=[v.r,v.g,v.b,v.a]}var d=n.scale.linear().domain(l).range(c).clamp(true);var p=r.noNumericCheck,g=r.returnArray,m;if(p&&g){m=d}else if(p){m=function(e){return s(d(e))}}else if(g){m=function(e){if(a(e))return d(e);else if(i(e).isValid())return e;else return o.defaultLine}}else{m=function(e){if(a(e))return s(d(e));else if(i(e).isValid())return e;else return o.defaultLine}}m.domain=d.domain;m.range=function(){return u};return m};function s(e){var t={r:e[0],g:e[1],b:e[2],a:e[3]};return i(t).toRgbString()}},{"../color":361,d3:81,"fast-isnumeric":91,tinycolor2:327}],380:[function(e,t,r){"use strict";t.exports={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]}},{}],381:[function(e,t,r){"use strict";t.exports=function e(t,r,n,i,a){var o=(t-n)/(i-n),s=o+r/(i-n),l=(o+s)/2;if(a==="left"||a==="bottom")return o;if(a==="center"||a==="middle")return l;if(a==="right"||a==="top")return s;if(o<2/3-l)return o;if(s>4/3-l)return s;return l}},{}],382:[function(e,t,r){"use strict";var n=e("../../lib");var i=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];t.exports=function e(t,r,a,o){if(a==="left")t=0;else if(a==="center")t=1;else if(a==="right")t=2;else t=n.constrain(Math.floor(t*3),0,2);if(o==="bottom")r=0;else if(o==="middle")r=1;else if(o==="top")r=2;else r=n.constrain(Math.floor(r*3),0,2);return i[r][t]}},{"../../lib":483}],383:[function(e,t,r){"use strict";var n=e("mouse-event-offset");var i=e("has-hover");var a=e("has-passive-events");var o=e("../../registry");var s=e("../../lib");var l=e("../../plots/cartesian/constants");var u=e("../../constants/interactions");var f=t.exports={};f.align=e("./align");f.getCursor=e("./cursor");var c=e("./unhover");f.unhover=c.wrapped;f.unhoverRaw=c.raw;f.init=function e(t){var r=t.gd;var n=1;var o=u.DBLCLICKDELAY;var c=t.element;var p,g,m,y,b,x,_,w;if(!r._mouseDownTime)r._mouseDownTime=0;c.style.pointerEvents="all";c.onmousedown=T;if(!a){c.ontouchstart=T}else{if(c._ontouchstart){c.removeEventListener("touchstart",c._ontouchstart)}c._ontouchstart=T;c.addEventListener("touchstart",T,{passive:false})}function M(e,t,r){if(Math.abs(e)<r)e=0;if(Math.abs(t)<r)t=0;return[e,t]}var A=t.clampFn||M;function T(e){e.preventDefault();r._dragged=false;r._dragging=true;var a=d(e);p=a[0];g=a[1];_=e.target;x=e;w=e.buttons===2||e.ctrlKey;m=(new Date).getTime();if(m-r._mouseDownTime<o){n+=1}else{n=1;r._mouseDownTime=m}if(t.prepFn)t.prepFn(e,p,g);if(i&&!w){b=h();b.style.cursor=window.getComputedStyle(c).cursor}else if(!i){b=document;y=window.getComputedStyle(document.documentElement).cursor;document.documentElement.style.cursor=window.getComputedStyle(c).cursor}document.addEventListener("mousemove",k);document.addEventListener("mouseup",E);document.addEventListener("touchmove",k);document.addEventListener("touchend",E);return}function k(e){e.preventDefault();var n=d(e);var i=t.minDrag||l.MINDRAG;var a=A(n[0]-p,n[1]-g,i);var o=a[0];var s=a[1];if(o||s){r._dragged=true;f.unhover(r)}if(r._dragged&&t.moveFn&&!w)t.moveFn(o,s);return}function E(e){document.removeEventListener("mousemove",k);document.removeEventListener("mouseup",E);document.removeEventListener("touchmove",k);document.removeEventListener("touchend",E);e.preventDefault();if(i){s.removeElement(b)}else if(y){b.documentElement.style.cursor=y;y=null}if(!r._dragging){r._dragged=false;return}r._dragging=false;if((new Date).getTime()-r._mouseDownTime>o){n=Math.max(n-1,1)}if(r._dragged){if(t.doneFn)t.doneFn()}else{if(t.clickFn)t.clickFn(n,x);if(!w){var a;try{a=new MouseEvent("click",e)}catch(t){var l=d(e);a=document.createEvent("MouseEvents");a.initMouseEvent("click",e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,l[0],l[1],e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget)}_.dispatchEvent(a)}}v(r);r._dragged=false;return}};function h(){var e=document.createElement("div");e.className="dragcover";var t=e.style;t.position="fixed";t.left=0;t.right=0;t.top=0;t.bottom=0;t.zIndex=999999999;t.background="none";document.body.appendChild(e);return e}f.coverSlip=h;function v(e){e._dragging=false;if(e._replotPending)o.call("plot",e)}function d(e){return n(e.changedTouches?e.changedTouches[0]:e,document.body)}},{"../../constants/interactions":462,"../../lib":483,"../../plots/cartesian/constants":534,"../../registry":582,"./align":381,"./cursor":382,"./unhover":384,"has-hover":236,"has-passive-events":237,"mouse-event-offset":256}],384:[function(e,t,r){"use strict";var n=e("../../lib/events");var i=e("../../lib/throttle");var a=e("../../lib/get_graph_div");var o=e("../fx/constants");var s=t.exports={};s.wrapped=function(e,t,r){e=a(e);if(e._fullLayout){i.clear(e._fullLayout._uid+o.HOVERID)}s.raw(e,t,r)};s.raw=function e(t,r){var i=t._fullLayout;var a=t._hoverdata;if(!r)r={};if(r.target&&n.triggerHandler(t,"plotly_beforehover",r)===false){return}i._hoverlayer.selectAll("g").remove();i._hoverlayer.selectAll("line").remove();i._hoverlayer.selectAll("circle").remove();t._hoverdata=undefined;if(r.target&&a){t.emit("plotly_unhover",{event:r,points:a})}}},{"../../lib/events":474,"../../lib/get_graph_div":479,"../../lib/throttle":507,"../fx/constants":398}],385:[function(e,t,r){"use strict";r.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"}},{}],386:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("tinycolor2");var o=e("../../registry");var s=e("../color");var l=e("../colorscale");var u=e("../../lib");var f=e("../../lib/svg_text_utils");var c=e("../../constants/xmlns_namespaces");var h=e("../../constants/alignment");var v=h.LINE_SPACING;var d=e("../../constants/interactions").DESELECTDIM;var p=e("../../traces/scatter/subtypes");var g=e("../../traces/scatter/make_bubble_size_func");var m=t.exports={};m.font=function(e,t,r,n){if(u.isPlainObject(t)){n=t.color;r=t.size;t=t.family}if(t)e.style("font-family",t);if(r+1)e.style("font-size",r+"px");if(n)e.call(s.fill,n)};m.setPosition=function(e,t,r){e.attr("x",t).attr("y",r)};m.setSize=function(e,t,r){e.attr("width",t).attr("height",r)};m.setRect=function(e,t,r,n,i){e.call(m.setPosition,t,r).call(m.setSize,n,i)};m.translatePoint=function(e,t,r,n){var a=r.c2p(e.x);var o=n.c2p(e.y);if(i(a)&&i(o)&&t.node()){if(t.node().nodeName==="text"){t.attr("x",a).attr("y",o)}else{t.attr("transform","translate("+a+","+o+")")}}else{return false}return true};m.translatePoints=function(e,t,r){e.each(function(e){var i=n.select(this);m.translatePoint(e,i,t,r)})};m.hideOutsideRangePoint=function(e,t,r,n,i,a){t.attr("display",r.isPtWithinRange(e,i)&&n.isPtWithinRange(e,a)?null:"none")};m.hideOutsideRangePoints=function(e,t){if(!t._hasClipOnAxisFalse)return;var r=t.xaxis;var i=t.yaxis;e.each(function(t){var a=t[0].trace;var o=a.xcalendar;var s=a.ycalendar;var l=a.type==="bar"?".bartext":".point,.textpoint";e.selectAll(l).each(function(e){m.hideOutsideRangePoint(e,n.select(this),r,i,o,s)})})};m.crispRound=function(e,t,r){if(!t||!i(t))return r||0;if(e._context.staticPlot)return t;if(t<1)return 1;return Math.round(t)};m.singleLineStyle=function(e,t,r,n,i){t.style("fill","none");var a=(((e||[])[0]||{}).trace||{}).line||{},o=r||a.width||0,l=i||a.dash||"";s.stroke(t,n||a.color);m.dashLine(t,l,o)};m.lineGroupStyle=function(e,t,r,i){e.style("fill","none").each(function(e){var a=(((e||[])[0]||{}).trace||{}).line||{},o=t||a.width||0,l=i||a.dash||"";n.select(this).call(s.stroke,r||a.color).call(m.dashLine,l,o)})};m.dashLine=function(e,t,r){r=+r||0;t=m.dashStyle(t,r);e.style({"stroke-dasharray":t,"stroke-width":r+"px"})};m.dashStyle=function(e,t){t=+t||1;var r=Math.max(t,3);if(e==="solid")e="";else if(e==="dot")e=r+"px,"+r+"px";else if(e==="dash")e=3*r+"px,"+3*r+"px";else if(e==="longdash")e=5*r+"px,"+5*r+"px";else if(e==="dashdot"){e=3*r+"px,"+r+"px,"+r+"px,"+r+"px"}else if(e==="longdashdot"){e=5*r+"px,"+2*r+"px,"+r+"px,"+2*r+"px"}return e};m.singleFillStyle=function(e){var t=n.select(e.node());var r=t.data();var i=(((r[0]||[])[0]||{}).trace||{}).fillcolor;if(i){e.call(s.fill,i)}};m.fillGroupStyle=function(e){e.style("stroke-width",0).each(function(t){var r=n.select(this);try{r.call(s.fill,t[0].trace.fillcolor)}catch(t){u.error(t,e);r.remove()}})};var y=e("./symbol_defs");m.symbolNames=[];m.symbolFuncs=[];m.symbolNeedLines={};m.symbolNoDot={};m.symbolNoFill={};m.symbolList=[];Object.keys(y).forEach(function(e){var t=y[e];m.symbolList=m.symbolList.concat([t.n,e,t.n+100,e+"-open"]);m.symbolNames[t.n]=e;m.symbolFuncs[t.n]=t.f;if(t.needLine){m.symbolNeedLines[t.n]=true}if(t.noDot){m.symbolNoDot[t.n]=true}else{m.symbolList=m.symbolList.concat([t.n+200,e+"-dot",t.n+300,e+"-open-dot"])}if(t.noFill){m.symbolNoFill[t.n]=true}});var b=m.symbolNames.length,x="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";m.symbolNumber=function(e){if(typeof e==="string"){var t=0;if(e.indexOf("-open")>0){t=100;e=e.replace("-open","")}if(e.indexOf("-dot")>0){t+=200;e=e.replace("-dot","")}e=m.symbolNames.indexOf(e);if(e>=0){e+=t}}if(e%100>=b||e>=400){return 0}return Math.floor(Math.max(e,0))};function _(e,t){var r=e%100;return m.symbolFuncs[r](t)+(e>=200?x:"")}var w={x1:1,x2:0,y1:0,y2:0};var M={x1:0,x2:0,y1:1,y2:0};m.gradient=function(e,t,r,i,o,l){var f=t._fullLayout._defs.select(".gradients").selectAll("#"+r).data([i+o+l],u.identity);f.exit().remove();f.enter().append(i==="radial"?"radialGradient":"linearGradient").each(function(){var e=n.select(this);if(i==="horizontal")e.attr(w);else if(i==="vertical")e.attr(M);e.attr("id",r);var t=a(o);var u=a(l);e.append("stop").attr({offset:"0%","stop-color":s.tinyRGB(u),"stop-opacity":u.getAlpha()});e.append("stop").attr({offset:"100%","stop-color":s.tinyRGB(t),"stop-opacity":t.getAlpha()})});e.style({fill:"url(#"+r+")","fill-opacity":null})};m.initGradients=function(e){var t=u.ensureSingle(e._fullLayout._defs,"g","gradients");t.selectAll("linearGradient,radialGradient").remove()};m.pointStyle=function(e,t,r){if(!e.size())return;var i=m.makePointStyleFns(t);e.each(function(e){m.singlePointStyle(e,n.select(this),t,i,r)})};m.singlePointStyle=function(e,t,r,n,i){var a=r.marker;var o=a.line;t.style("opacity",n.selectedOpacityFn?n.selectedOpacityFn(e):e.mo===undefined?a.opacity:e.mo);if(n.ms2mrc){var l;if(e.ms==="various"||a.size==="various"){l=3}else{l=n.ms2mrc(e.ms)}e.mrc=l;if(n.selectedSizeFn){l=e.mrc=n.selectedSizeFn(e)}var f=m.symbolNumber(e.mx||a.symbol)||0;e.om=f%200>=100;t.attr("d",_(f,l))}var c=false;var h,v,d;if(e.so){d=o.outlierwidth;v=o.outliercolor;h=a.outliercolor}else{var p=(o||{}).width;d=(e.mlw+1||p+1||(e.trace?(e.trace.marker.line||{}).width:0)+1)-1||0;if("mlc"in e)v=e.mlcc=n.lineScale(e.mlc);else if(u.isArrayOrTypedArray(o.color))v=s.defaultLine;else v=o.color;if(u.isArrayOrTypedArray(a.color)){h=s.defaultLine;c=true}if("mc"in e){h=e.mcc=n.markerScale(e.mc)}else{h=a.color||"rgba(0,0,0,0)"}if(n.selectedColorFn){h=n.selectedColorFn(e)}}if(e.om){t.call(s.stroke,h).style({"stroke-width":(d||1)+"px",fill:"none"})}else{t.style("stroke-width",d+"px");var g=a.gradient;var y=e.mgt;if(y)c=true;else y=g&&g.type;if(y&&y!=="none"){var b=e.mgc;if(b)c=true;else b=g.color;var x="g"+i._fullLayout._uid+"-"+r.uid;if(c)x+="-"+e.i;t.call(m.gradient,i,x,y,h,b)}else{t.call(s.fill,h)}if(d){t.call(s.stroke,v)}}};m.makePointStyleFns=function(e){var t={};var r=e.marker;t.markerScale=m.tryColorscale(r,"");t.lineScale=m.tryColorscale(r,"line");if(o.traceIs(e,"symbols")){t.ms2mrc=p.isBubble(e)?g(e):function(){return(r.size||6)/2}}if(e.selectedpoints){u.extendFlat(t,m.makeSelectedPointStyleFns(e))}return t};m.makeSelectedPointStyleFns=function(e){var t={};var r=e.selected||{};var n=e.unselected||{};var i=e.marker||{};var a=r.marker||{};var s=n.marker||{};var l=i.opacity;var f=a.opacity;var c=s.opacity;var h=f!==undefined;var v=c!==undefined;if(u.isArrayOrTypedArray(l)||h||v){t.selectedOpacityFn=function(e){var t=e.mo===undefined?i.opacity:e.mo;if(e.selected){return h?f:t}else{return v?c:d*t}}}var p=i.color;var g=a.color;var m=s.color;if(g||m){t.selectedColorFn=function(e){var t=e.mcc||p;if(e.selected){return g||t}else{return m||t}}}var y=i.size;var b=a.size;var x=s.size;var _=b!==undefined;var w=x!==undefined;if(o.traceIs(e,"symbols")&&(_||w)){t.selectedSizeFn=function(e){var t=e.mrc||y/2;if(e.selected){return _?b/2:t}else{return w?x/2:t}}}return t};m.makeSelectedTextStyleFns=function(e){var t={};var r=e.selected||{};var n=e.unselected||{};var i=e.textfont||{};var a=r.textfont||{};var o=n.textfont||{};var l=i.color;var u=a.color;var f=o.color;t.selectedTextColorFn=function(e){var t=e.tc||l;if(e.selected){return u||t}else{if(f)return f;else return u?t:s.addOpacity(t,d)}};return t};m.selectedPointStyle=function(e,t){if(!e.size()||!t.selectedpoints)return;var r=m.makeSelectedPointStyleFns(t);var i=t.marker||{};var a=[];if(r.selectedOpacityFn){a.push(function(e,t){e.style("opacity",r.selectedOpacityFn(t))})}if(r.selectedColorFn){a.push(function(e,t){s.fill(e,r.selectedColorFn(t))})}if(r.selectedSizeFn){a.push(function(e,t){var n=t.mx||i.symbol||0;var a=r.selectedSizeFn(t);e.attr("d",_(m.symbolNumber(n),a));t.mrc2=a})}if(a.length){e.each(function(e){var t=n.select(this);for(var r=0;r<a.length;r++){a[r](t,e)}})}};m.tryColorscale=function(e,t){var r=t?u.nestedProperty(e,t).get():e;if(r){var n=r.colorscale;var i=r.color;if(n&&u.isArrayOrTypedArray(i)){return l.makeColorScaleFunc(l.extractScale(n,r.cmin,r.cmax))}}return u.identity};var A={start:1,end:-1,middle:0,bottom:1,top:-1};function T(e,t,r,i){var a=n.select(e.node().parentNode);var o=t.indexOf("top")!==-1?"top":t.indexOf("bottom")!==-1?"bottom":"middle";var s=t.indexOf("left")!==-1?"end":t.indexOf("right")!==-1?"start":"middle";var l=i?i/.8+1:0;var u=(f.lineCount(e)-1)*v+1;var c=A[s]*l;var h=r*.75+A[o]*l+(A[o]-1)*u*r/2;e.attr("text-anchor",s);a.attr("transform","translate("+c+","+h+")")}function k(e,t){var r=e.ts||t.textfont.size;return i(r)&&r>0?r:0}m.textPointStyle=function(e,t,r){if(!e.size())return;var i;if(t.selectedpoints){var a=m.makeSelectedTextStyleFns(t);i=a.selectedTextColorFn}e.each(function(e){var a=n.select(this);var o=u.extractOption(e,t,"tx","text");if(!o&&o!==0){a.remove();return}var s=e.tp||t.textposition;var l=k(e,t);var c=i?i(e):e.tc||t.textfont.color;a.call(m.font,e.tf||t.textfont.family,l,c).text(o).call(f.convertToTspans,r).call(T,s,l,e.mrc)})};m.selectedTextStyle=function(e,t){if(!e.size()||!t.selectedpoints)return;var r=m.makeSelectedTextStyleFns(t);e.each(function(e){var i=n.select(this);var a=r.selectedTextColorFn(e);var o=e.tp||t.textposition;var l=k(e,t);s.fill(i,a);T(i,o,l,e.mrc2||e.mrc)})};var E=.5;m.smoothopen=function(e,t){if(e.length<3){return"M"+e.join("L")}var r="M"+e[0],n=[],i;for(i=1;i<e.length-1;i++){n.push(S(e[i-1],e[i],e[i+1],t))}r+="Q"+n[0][0]+" "+e[1];for(i=2;i<e.length-1;i++){r+="C"+n[i-2][1]+" "+n[i-1][0]+" "+e[i]}r+="Q"+n[e.length-3][1]+" "+e[e.length-1];return r};m.smoothclosed=function(e,t){if(e.length<3){return"M"+e.join("L")+"Z"}var r="M"+e[0],n=e.length-1,i=[S(e[n],e[0],e[1],t)],a;for(a=1;a<n;a++){i.push(S(e[a-1],e[a],e[a+1],t))}i.push(S(e[n-1],e[n],e[0],t));for(a=1;a<=n;a++){r+="C"+i[a-1][1]+" "+i[a][0]+" "+e[a]}r+="C"+i[n][1]+" "+i[0][0]+" "+e[0]+"Z";return r};function S(e,t,r,i){var a=e[0]-t[0],o=e[1]-t[1],s=r[0]-t[0],l=r[1]-t[1],u=Math.pow(a*a+o*o,E/2),f=Math.pow(s*s+l*l,E/2),c=(f*f*a-u*u*s)*i,h=(f*f*o-u*u*l)*i,v=3*f*(u+f),d=3*u*(u+f);return[[n.round(t[0]+(v&&c/v),2),n.round(t[1]+(v&&h/v),2)],[n.round(t[0]-(d&&c/d),2),n.round(t[1]-(d&&h/d),2)]]}var L={hv:function(e,t){return"H"+n.round(t[0],2)+"V"+n.round(t[1],2)},vh:function(e,t){return"V"+n.round(t[1],2)+"H"+n.round(t[0],2)},hvh:function(e,t){return"H"+n.round((e[0]+t[0])/2,2)+"V"+n.round(t[1],2)+"H"+n.round(t[0],2)},vhv:function(e,t){return"V"+n.round((e[1]+t[1])/2,2)+"H"+n.round(t[0],2)+"V"+n.round(t[1],2)}};var C=function(e,t){return"L"+n.round(t[0],2)+","+n.round(t[1],2)};m.steps=function(e){var t=L[e]||C;return function(e){var r="M"+n.round(e[0][0],2)+","+n.round(e[0][1],2);for(var i=1;i<e.length;i++){r+=t(e[i-1],e[i])}return r}};m.makeTester=function(){var e=u.ensureSingleById(n.select("body"),"svg","js-plotly-tester",function(e){e.attr(c.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})});var t=u.ensureSingle(e,"path","js-reference-point",function(e){e.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});m.tester=e;m.testref=t};m.savedBBoxes={};var I=0;var P=1e4;m.bBox=function(e,t,r){if(!r)r=O(e);var i;if(r){i=m.savedBBoxes[r];if(i)return u.extendFlat({},i)}else if(e.childNodes.length===1){var a=e.childNodes[0];r=O(a);if(r){var o=+a.getAttribute("x")||0;var s=+a.getAttribute("y")||0;var l=a.getAttribute("transform");if(!l){var c=m.bBox(a,false,r);if(o){c.left+=o;c.right+=o}if(s){c.top+=s;c.bottom+=s}return c}r+="~"+o+"~"+s+"~"+l;i=m.savedBBoxes[r];if(i)return u.extendFlat({},i)}}var h,v;if(t){h=e}else{v=m.tester.node();h=e.cloneNode(true);v.appendChild(h)}n.select(h).attr("transform",null).call(f.positionText,0,0);var d=h.getBoundingClientRect();var p=m.testref.node().getBoundingClientRect();if(!t)v.removeChild(h);var g={height:d.height,width:d.width,left:d.left-p.left,top:d.top-p.top,right:d.right-p.left,bottom:d.bottom-p.top};if(I>=P){m.savedBBoxes={};I=0}if(r)m.savedBBoxes[r]=g;I++;return u.extendFlat({},g)};function O(e){var t=e.getAttribute("data-unformatted");if(t===null)return;return t+e.getAttribute("data-math")+e.getAttribute("text-anchor")+e.getAttribute("style")}m.setClipUrl=function(e,t){if(!t){e.attr("clip-path",null);return}if(m.baseUrl===undefined){var r=n.select("base");if(r.size()&&r.attr("href")){m.baseUrl=window.location.href.split("#")[0]}else{m.baseUrl=""}}e.attr("clip-path","url("+m.baseUrl+"#"+t+")")};m.getTranslate=function(e){var t=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,r=e.attr?"attr":"getAttribute",n=e[r]("transform")||"";var i=n.replace(t,function(e,t,r){return[t,r].join(" ")}).split(" ");return{x:+i[0]||0,y:+i[1]||0}};m.setTranslate=function(e,t,r){var n=/(\btranslate\(.*?\);?)/,i=e.attr?"attr":"getAttribute",a=e.attr?"attr":"setAttribute",o=e[i]("transform")||"";t=t||0;r=r||0;o=o.replace(n,"").trim();o+=" translate("+t+", "+r+")";o=o.trim();e[a]("transform",o);return o};m.getScale=function(e){var t=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,r=e.attr?"attr":"getAttribute",n=e[r]("transform")||"";var i=n.replace(t,function(e,t,r){return[t,r].join(" ")}).split(" ");return{x:+i[0]||1,y:+i[1]||1}};m.setScale=function(e,t,r){var n=/(\bscale\(.*?\);?)/,i=e.attr?"attr":"getAttribute",a=e.attr?"attr":"setAttribute",o=e[i]("transform")||"";t=t||1;r=r||1;o=o.replace(n,"").trim();o+=" scale("+t+", "+r+")";o=o.trim();e[a]("transform",o);return o};var R=/\s*sc.*/;m.setPointGroupScale=function(e,t,r){t=t||1;r=r||1;if(!e)return;var n=t===1&&r===1?"":" scale("+t+","+r+")";e.each(function(){var e=(this.getAttribute("transform")||"").replace(R,"");e+=n;e=e.trim();this.setAttribute("transform",e)})};var N=/translate\([^)]*\)\s*$/;m.setTextPointsScale=function(e,t,r){if(!e)return;e.each(function(){var e;var i=n.select(this);var a=i.select("text");if(!a.node())return;var o=parseFloat(a.attr("x")||0);var s=parseFloat(a.attr("y")||0);var l=(i.attr("transform")||"").match(N);if(t===1&&r===1){e=[]}else{e=["translate("+o+","+s+")","scale("+t+","+r+")","translate("+-o+","+-s+")"]}if(l){e.push(l)}i.attr("transform",e.join(" "))})}},{"../../constants/alignment":459,"../../constants/interactions":462,"../../constants/xmlns_namespaces":465,"../../lib":483,"../../lib/svg_text_utils":506,"../../registry":582,"../../traces/scatter/make_bubble_size_func":620,"../../traces/scatter/subtypes":626,"../color":361,"../colorscale":376,"./symbol_defs":387,d3:81,"fast-isnumeric":91,tinycolor2:327}],387:[function(e,t,r){"use strict";var n=e("d3");t.exports={circle:{n:0,f:function(e){var t=n.round(e,2);return"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"}},square:{n:1,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"}},diamond:{n:2,f:function(e){var t=n.round(e*1.3,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"}},cross:{n:3,f:function(e){var t=n.round(e*.4,2),r=n.round(e*1.2,2);return"M"+r+","+t+"H"+t+"V"+r+"H-"+t+"V"+t+"H-"+r+"V-"+t+"H-"+t+"V-"+r+"H"+t+"V-"+t+"H"+r+"Z"}},x:{n:4,f:function(e){var t=n.round(e*.8/Math.sqrt(2),2),r="l"+t+","+t,i="l"+t+",-"+t,a="l-"+t+",-"+t,o="l-"+t+","+t;return"M0,"+t+r+i+a+i+a+o+a+o+r+o+r+"Z"}},"triangle-up":{n:5,f:function(e){var t=n.round(e*2/Math.sqrt(3),2),r=n.round(e/2,2),i=n.round(e,2);return"M-"+t+","+r+"H"+t+"L0,-"+i+"Z"}},"triangle-down":{n:6,f:function(e){var t=n.round(e*2/Math.sqrt(3),2),r=n.round(e/2,2),i=n.round(e,2);return"M-"+t+",-"+r+"H"+t+"L0,"+i+"Z"}},"triangle-left":{n:7,f:function(e){var t=n.round(e*2/Math.sqrt(3),2),r=n.round(e/2,2),i=n.round(e,2);return"M"+r+",-"+t+"V"+t+"L-"+i+",0Z"}},"triangle-right":{n:8,f:function(e){var t=n.round(e*2/Math.sqrt(3),2),r=n.round(e/2,2),i=n.round(e,2);return"M-"+r+",-"+t+"V"+t+"L"+i+",0Z"}},"triangle-ne":{n:9,f:function(e){var t=n.round(e*.6,2),r=n.round(e*1.2,2);return"M-"+r+",-"+t+"H"+t+"V"+r+"Z"}},"triangle-se":{n:10,f:function(e){var t=n.round(e*.6,2),r=n.round(e*1.2,2);return"M"+t+",-"+r+"V"+t+"H-"+r+"Z"}},"triangle-sw":{n:11,f:function(e){var t=n.round(e*.6,2),r=n.round(e*1.2,2);return"M"+r+","+t+"H-"+t+"V-"+r+"Z"}},"triangle-nw":{n:12,f:function(e){var t=n.round(e*.6,2),r=n.round(e*1.2,2);return"M-"+t+","+r+"V-"+t+"H"+r+"Z"}},pentagon:{n:13,f:function(e){var t=n.round(e*.951,2),r=n.round(e*.588,2),i=n.round(-e,2),a=n.round(e*-.309,2),o=n.round(e*.809,2);return"M"+t+","+a+"L"+r+","+o+"H-"+r+"L-"+t+","+a+"L0,"+i+"Z"}},hexagon:{n:14,f:function(e){var t=n.round(e,2),r=n.round(e/2,2),i=n.round(e*Math.sqrt(3)/2,2);return"M"+i+",-"+r+"V"+r+"L0,"+t+"L-"+i+","+r+"V-"+r+"L0,-"+t+"Z"}},hexagon2:{n:15,f:function(e){var t=n.round(e,2),r=n.round(e/2,2),i=n.round(e*Math.sqrt(3)/2,2);return"M-"+r+","+i+"H"+r+"L"+t+",0L"+r+",-"+i+"H-"+r+"L-"+t+",0Z"}},octagon:{n:16,f:function(e){var t=n.round(e*.924,2),r=n.round(e*.383,2);return"M-"+r+",-"+t+"H"+r+"L"+t+",-"+r+"V"+r+"L"+r+","+t+"H-"+r+"L-"+t+","+r+"V-"+r+"Z"}},star:{n:17,f:function(e){var t=e*1.4,r=n.round(t*.225,2),i=n.round(t*.951,2),a=n.round(t*.363,2),o=n.round(t*.588,2),s=n.round(-t,2),l=n.round(t*-.309,2),u=n.round(t*.118,2),f=n.round(t*.809,2),c=n.round(t*.382,2);return"M"+r+","+l+"H"+i+"L"+a+","+u+"L"+o+","+f+"L0,"+c+"L-"+o+","+f+"L-"+a+","+u+"L-"+i+","+l+"H-"+r+"L0,"+s+"Z"}},hexagram:{n:18,f:function(e){var t=n.round(e*.66,2),r=n.round(e*.38,2),i=n.round(e*.76,2);return"M-"+i+",0l-"+r+",-"+t+"h"+i+"l"+r+",-"+t+"l"+r+","+t+"h"+i+"l-"+r+","+t+"l"+r+","+t+"h-"+i+"l-"+r+","+t+"l-"+r+",-"+t+"h-"+i+"Z"}},"star-triangle-up":{n:19,f:function(e){var t=n.round(e*Math.sqrt(3)*.8,2),r=n.round(e*.8,2),i=n.round(e*1.6,2),a=n.round(e*4,2),o="A "+a+","+a+" 0 0 1 ";return"M-"+t+","+r+o+t+","+r+o+"0,-"+i+o+"-"+t+","+r+"Z"}},"star-triangle-down":{n:20,f:function(e){var t=n.round(e*Math.sqrt(3)*.8,2),r=n.round(e*.8,2),i=n.round(e*1.6,2),a=n.round(e*4,2),o="A "+a+","+a+" 0 0 1 ";return"M"+t+",-"+r+o+"-"+t+",-"+r+o+"0,"+i+o+t+",-"+r+"Z"}},"star-square":{n:21,f:function(e){var t=n.round(e*1.1,2),r=n.round(e*2,2),i="A "+r+","+r+" 0 0 1 ";return"M-"+t+",-"+t+i+"-"+t+","+t+i+t+","+t+i+t+",-"+t+i+"-"+t+",-"+t+"Z"}},"star-diamond":{n:22,f:function(e){var t=n.round(e*1.4,2),r=n.round(e*1.9,2),i="A "+r+","+r+" 0 0 1 ";return"M-"+t+",0"+i+"0,"+t+i+t+",0"+i+"0,-"+t+i+"-"+t+",0"+"Z"}},"diamond-tall":{n:23,f:function(e){var t=n.round(e*.7,2),r=n.round(e*1.4,2);return"M0,"+r+"L"+t+",0L0,-"+r+"L-"+t+",0Z"}},"diamond-wide":{n:24,f:function(e){var t=n.round(e*1.4,2),r=n.round(e*.7,2);return"M0,"+r+"L"+t+",0L0,-"+r+"L-"+t+",0Z"}},hourglass:{n:25,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"H-"+t+"L"+t+",-"+t+"H-"+t+"Z"},noDot:true},bowtie:{n:26,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"V-"+t+"L-"+t+","+t+"V-"+t+"Z"},noDot:true},"circle-cross":{n:27,f:function(e){var t=n.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:true,noDot:true},"circle-x":{n:28,f:function(e){var t=n.round(e,2),r=n.round(e/Math.sqrt(2),2);return"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:true,noDot:true},"square-cross":{n:29,f:function(e){var t=n.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:true,noDot:true},"square-x":{n:30,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:true,noDot:true},"diamond-cross":{n:31,f:function(e){var t=n.round(e*1.3,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"+"M0,-"+t+"V"+t+"M-"+t+",0H"+t},needLine:true,noDot:true},"diamond-x":{n:32,f:function(e){var t=n.round(e*1.3,2),r=n.round(e*.65,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"+"M-"+r+",-"+r+"L"+r+","+r+"M-"+r+","+r+"L"+r+",-"+r},needLine:true,noDot:true},"cross-thin":{n:33,f:function(e){var t=n.round(e*1.4,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t},needLine:true,noDot:true,noFill:true},"x-thin":{n:34,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t},needLine:true,noDot:true,noFill:true},asterisk:{n:35,f:function(e){var t=n.round(e*1.2,2);var r=n.round(e*.85,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r},needLine:true,noDot:true,noFill:true},hash:{n:36,f:function(e){var t=n.round(e/2,2),r=n.round(e,2);return"M"+t+","+r+"V-"+r+"m-"+r+",0V"+r+"M"+r+","+t+"H-"+r+"m0,-"+r+"H"+r},needLine:true,noFill:true},"y-up":{n:37,f:function(e){var t=n.round(e*1.2,2),r=n.round(e*1.6,2),i=n.round(e*.8,2);return"M-"+t+","+i+"L0,0M"+t+","+i+"L0,0M0,-"+r+"L0,0"},needLine:true,noDot:true,noFill:true},"y-down":{n:38,f:function(e){var t=n.round(e*1.2,2),r=n.round(e*1.6,2),i=n.round(e*.8,2);return"M-"+t+",-"+i+"L0,0M"+t+",-"+i+"L0,0M0,"+r+"L0,0"},needLine:true,noDot:true,noFill:true},"y-left":{n:39,f:function(e){var t=n.round(e*1.2,2),r=n.round(e*1.6,2),i=n.round(e*.8,2);return"M"+i+","+t+"L0,0M"+i+",-"+t+"L0,0M-"+r+",0L0,0"},needLine:true,noDot:true,noFill:true},"y-right":{n:40,f:function(e){var t=n.round(e*1.2,2),r=n.round(e*1.6,2),i=n.round(e*.8,2);return"M-"+i+","+t+"L0,0M-"+i+",-"+t+"L0,0M"+r+",0L0,0"},needLine:true,noDot:true,noFill:true},"line-ew":{n:41,f:function(e){var t=n.round(e*1.4,2);return"M"+t+",0H-"+t},needLine:true,noDot:true,noFill:true},"line-ns":{n:42,f:function(e){var t=n.round(e*1.4,2);return"M0,"+t+"V-"+t},needLine:true,noDot:true,noFill:true},"line-ne":{n:43,f:function(e){var t=n.round(e,2);return"M"+t+",-"+t+"L-"+t+","+t},needLine:true,noDot:true,noFill:true},"line-nw":{n:44,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t},needLine:true,noDot:true,noFill:true}}},{d3:81}],388:[function(e,t,r){"use strict";t.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],389:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../registry");var a=e("../../plots/cartesian/axes");var o=e("./compute_error");t.exports=function e(t){var r=t.calcdata;for(var n=0;n<r.length;n++){var o=r[n],l=o[0].trace;if(!i.traceIs(l,"errorBarsOK"))continue;var u=a.getFromId(t,l.xaxis),f=a.getFromId(t,l.yaxis);s(o,l,u,"x");s(o,l,f,"y")}};function s(e,t,r,i){var s=t["error_"+i]||{},l=s.visible&&["linear","log"].indexOf(r.type)!==-1,u=[];if(!l)return;var f=o(s);for(var c=0;c<e.length;c++){var h=e[c],v=h[i];if(!n(r.c2l(v)))continue;var d=f(v,c);if(n(d[0])&&n(d[1])){var p=h[i+"s"]=v-d[0],g=h[i+"h"]=v+d[1];u.push(p,g)}}a.expand(r,u,{padded:true})}},{"../../plots/cartesian/axes":529,"../../registry":582,"./compute_error":390,"fast-isnumeric":91}],390:[function(e,t,r){"use strict";t.exports=function e(t){var r=t.type,i=t.symmetric;if(r==="data"){var a=t.array||[];if(i){return function e(t,r){var n=+a[r];return[n,n]}}else{var o=t.arrayminus||[];return function e(t,r){var n=+a[r];var i=+o[r];if(!isNaN(n)||!isNaN(i)){return[i||0,n||0]}return[NaN,NaN]}}}else{var s=n(r,t.value),l=n(r,t.valueminus);if(i||t.valueminus===undefined){return function e(t){var r=s(t);return[r,r]}}else{return function e(t){return[l(t),s(t)]}}}};function n(e,t){if(e==="percent"){return function(e){return Math.abs(e*t/100)}}if(e==="constant"){return function(){return Math.abs(t)}}if(e==="sqrt"){return function(e){return Math.sqrt(Math.abs(e))}}}},{}],391:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../registry");var a=e("../../lib");var o=e("../../plot_api/plot_template");var s=e("./attributes");t.exports=function(e,t,r,l){var u="error_"+l.axis;var f=o.newContainer(t,u);var c=e[u]||{};function h(e,t){return a.coerce(c,f,s,e,t)}var v=c.array!==undefined||c.value!==undefined||c.type==="sqrt";var d=h("visible",v);if(d===false)return;var p=h("type","array"in c?"data":"percent"),g=true;if(p!=="sqrt"){g=h("symmetric",!((p==="data"?"arrayminus":"valueminus")in c))}if(p==="data"){h("array");h("traceref");if(!g){h("arrayminus");h("tracerefminus")}}else if(p==="percent"||p==="constant"){h("value");if(!g)h("valueminus")}var m="copy_"+l.inherit+"style";if(l.inherit){var y=t["error_"+l.inherit];if((y||{}).visible){h(m,!(c.color||n(c.thickness)||n(c.width)))}}if(!l.inherit||!f[m]){h("color",r);h("thickness");h("width",i.traceIs(t,"gl3d")?0:4)}}},{"../../lib":483,"../../plot_api/plot_template":519,"../../registry":582,"./attributes":388,"fast-isnumeric":91}],392:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plot_api/edit_types").overrideAll;var a=e("./attributes");var o={error_x:n.extendFlat({},a),error_y:n.extendFlat({},a)};delete o.error_x.copy_zstyle;delete o.error_y.copy_zstyle;delete o.error_y.copy_ystyle;var s={error_x:n.extendFlat({},a),error_y:n.extendFlat({},a),error_z:n.extendFlat({},a)};delete s.error_x.copy_ystyle;delete s.error_y.copy_ystyle;delete s.error_z.copy_ystyle;delete s.error_z.copy_zstyle;t.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:o,bar:o,histogram:o,scatter3d:i(s,"calc","nested"),scattergl:i(o,"calc","nested")}},supplyDefaults:e("./defaults"),calc:e("./calc"),makeComputeError:e("./compute_error"),plot:e("./plot"),style:e("./style"),hoverInfo:l};function l(e,t,r){if((t.error_y||{}).visible){r.yerr=e.yh-e.y;if(!t.error_y.symmetric)r.yerrneg=e.y-e.ys}if((t.error_x||{}).visible){r.xerr=e.xh-e.x;if(!t.error_x.symmetric)r.xerrneg=e.x-e.xs}}},{"../../lib":483,"../../plot_api/edit_types":512,"./attributes":388,"./calc":389,"./compute_error":390,"./defaults":391,"./plot":393,"./style":394}],393:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../drawing");var o=e("../../traces/scatter/subtypes");t.exports=function e(t,r,l){var u;var f=r.xaxis;var c=r.yaxis;var h=l&&l.duration>0;t.each(function(e){var t=e[0].trace,v=t.error_x||{},d=t.error_y||{};var p;if(t.ids){p=function(e){return e.id}}var g=o.hasMarkers(t)&&t.marker.maxdisplayed>0;if(!d.visible&&!v.visible)e=[];var m=n.select(this).selectAll("g.errorbar").data(e,p);m.exit().remove();if(!e.length)return;if(!v.visible)m.selectAll("path.xerror").remove();if(!d.visible)m.selectAll("path.yerror").remove();m.style("opacity",1);var y=m.enter().append("g").classed("errorbar",true);if(h){y.style("opacity",0).transition().duration(l.duration).style("opacity",1)}a.setClipUrl(m,r.layerClipId);m.each(function(e){var t=n.select(this);var r=s(e,f,c);if(g&&!e.vis)return;var a;var o=t.select("path.yerror");if(d.visible&&i(r.x)&&i(r.yh)&&i(r.ys)){var p=d.width;a="M"+(r.x-p)+","+r.yh+"h"+2*p+"m-"+p+",0V"+r.ys;if(!r.noYS)a+="m-"+p+",0h"+2*p;u=!o.size();if(u){o=t.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",true)}else if(h){o=o.transition().duration(l.duration).ease(l.easing)}o.attr("d",a)}else o.remove();var m=t.select("path.xerror");if(v.visible&&i(r.y)&&i(r.xh)&&i(r.xs)){var y=(v.copy_ystyle?d:v).width;a="M"+r.xh+","+(r.y-y)+"v"+2*y+"m0,-"+y+"H"+r.xs;if(!r.noXS)a+="m0,-"+y+"v"+2*y;u=!m.size();if(u){m=t.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",true)}else if(h){m=m.transition().duration(l.duration).ease(l.easing)}m.attr("d",a)}else m.remove()})})};function s(e,t,r){var n={x:t.c2p(e.x),y:r.c2p(e.y)};if(e.yh!==undefined){n.yh=r.c2p(e.yh);n.ys=r.c2p(e.ys);if(!i(n.ys)){n.noYS=true;n.ys=r.c2p(e.ys,true)}}if(e.xh!==undefined){n.xh=t.c2p(e.xh);n.xs=t.c2p(e.xs);if(!i(n.xs)){n.noXS=true;n.xs=t.c2p(e.xs,true)}}return n}},{"../../traces/scatter/subtypes":626,"../drawing":386,d3:81,"fast-isnumeric":91}],394:[function(e,t,r){"use strict";var n=e("d3");var i=e("../color");t.exports=function e(t){t.each(function(e){var t=e[0].trace,r=t.error_y||{},a=t.error_x||{};var o=n.select(this);o.selectAll("path.yerror").style("stroke-width",r.thickness+"px").call(i.stroke,r.color);if(a.copy_ystyle)a=r;o.selectAll("path.xerror").style("stroke-width",a.thickness+"px").call(i.stroke,a.color)})}},{"../color":361,d3:81}],395:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");t.exports={hoverlabel:{bgcolor:{valType:"color",arrayOk:true,editType:"none"},bordercolor:{valType:"color",arrayOk:true,editType:"none"},font:n({arrayOk:true,editType:"none"}),namelength:{valType:"integer",min:-1,arrayOk:true,editType:"none"},editType:"calc"}}},{"../../plots/font_attributes":555}],396:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../registry");t.exports=function e(t){var r=t.calcdata;var o=t._fullLayout;function s(e){return function(t){return n.coerceHoverinfo({hoverinfo:t},{_module:e._module},o)}}for(var l=0;l<r.length;l++){var u=r[l];var f=u[0].trace;if(i.traceIs(f,"pie"))continue;var c=i.traceIs(f,"2dMap")?a:n.fillArray;c(f.hoverinfo,u,"hi",s(f));if(!f.hoverlabel)continue;c(f.hoverlabel.bgcolor,u,"hbg");c(f.hoverlabel.bordercolor,u,"hbc");c(f.hoverlabel.font.size,u,"hts");c(f.hoverlabel.font.color,u,"htc");c(f.hoverlabel.font.family,u,"htf");c(f.hoverlabel.namelength,u,"hnl")}};function a(e,t,r,i){i=i||n.identity;if(Array.isArray(e)){t[0][r]=i(e)}}},{"../../lib":483,"../../registry":582}],397:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("./hover").hover;t.exports=function e(t,r,a){var o=n.getComponentMethod("annotations","onClick")(t,t._hoverdata);if(a!==undefined){i(t,r,a,true)}function s(){t.emit("plotly_click",{points:t._hoverdata,event:r})}if(t._hoverdata&&r&&r.target){if(o&&o.then){o.then(s)}else s();if(r.stopImmediatePropagation)r.stopImmediatePropagation()}}},{"../../registry":582,"./hover":401}],398:[function(e,t,r){"use strict";t.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],399:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./attributes");var a=e("./hoverlabel_defaults");t.exports=function e(t,r,o,s){function l(e,a){return n.coerce(t,r,i,e,a)}a(t,r,l,s.hoverlabel)}},{"../../lib":483,"./attributes":395,"./hoverlabel_defaults":402}],400:[function(e,t,r){"use strict";var n=e("../../lib");r.getSubplot=function e(t){return t.subplot||t.xaxis+t.yaxis||t.geo};r.isTraceInSubplots=function e(t,n){if(t.type==="splom"){var i=t.xaxes||[];var a=t.yaxes||[];for(var o=0;o<i.length;o++){for(var s=0;s<a.length;s++){if(n.indexOf(i[o]+a[s])!==-1){return true}}}return false}return n.indexOf(r.getSubplot(t))!==-1};r.flat=function e(t,r){var n=new Array(t.length);for(var i=0;i<t.length;i++){n[i]=r}return n};r.p2c=function e(t,r){var n=new Array(t.length);for(var i=0;i<t.length;i++){n[i]=t[i].p2c(r)}return n};r.getDistanceFunction=function e(t,n,i,a){if(t==="closest")return a||r.quadrature(n,i);return t==="x"?n:i};r.getClosest=function e(t,r,n){if(n.index!==false){if(n.index>=0&&n.index<t.length){n.distance=0}else n.index=false}else{for(var i=0;i<t.length;i++){var a=r(t[i]);if(a<=n.distance){n.index=i;n.distance=a}}}return n};r.inbox=function e(t,r,n){return t*r<0||t===0?n:Infinity};r.quadrature=function e(t,r){return function(e){var n=t(e),i=r(e);return Math.sqrt(n*n+i*i)}};r.makeEventData=function e(t,n,i){var a="index"in t?t.index:t.pointNumber;var o={data:n._input,fullData:n,curveNumber:n.index,pointNumber:a};if(n._indexToPoints){var s=n._indexToPoints[a];if(s.length===1){o.pointIndex=s[0]}else{o.pointIndices=s}}else{o.pointIndex=a}if(n._module.eventData){o=n._module.eventData(o,t,n,i,a)}else{if("xVal"in t)o.x=t.xVal;else if("x"in t)o.x=t.x;if("yVal"in t)o.y=t.yVal;else if("y"in t)o.y=t.y;if(t.xa)o.xaxis=t.xa;if(t.ya)o.yaxis=t.ya;if(t.zLabelVal!==undefined)o.z=t.zLabelVal}r.appendArrayPointValue(o,n,a);return o};r.appendArrayPointValue=function(e,t,r){var i=t._arrayAttrs;if(!i){return}for(var s=0;s<i.length;s++){var l=i[s];var u=a(l);if(e[u]===undefined){var f=n.nestedProperty(t,l).get();var c=o(f,r);if(c!==undefined)e[u]=c}}};r.appendArrayMultiPointValues=function(e,t,r){var i=t._arrayAttrs;if(!i){return}for(var s=0;s<i.length;s++){var l=i[s];var u=a(l);if(e[u]===undefined){var f=n.nestedProperty(t,l).get();var c=new Array(r.length);for(var h=0;h<r.length;h++){c[h]=o(f,r[h])}e[u]=c}}};var i={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color"};function a(e){return i[e]||e}function o(e,t){if(Array.isArray(t)){if(Array.isArray(e)&&Array.isArray(e[t[0]])){return e[t[0]][t[1]]}}else{return e[t]}}},{"../../lib":483}],401:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("tinycolor2");var o=e("../../lib");var s=e("../../lib/events");var l=e("../../lib/svg_text_utils");var u=e("../../lib/override_cursor");var f=e("../drawing");var c=e("../color");var h=e("../dragelement");var v=e("../../plots/cartesian/axes");var d=e("../../registry");var p=e("./helpers");var g=e("./constants");var m=g.YANGLE;var y=Math.PI*m/180;var b=1/Math.sin(y);var x=Math.cos(y);var _=Math.sin(y);var w=g.HOVERARROWSIZE;var M=g.HOVERTEXTPAD;r.hover=function e(t,r,n,i){t=o.getGraphDiv(t);o.throttle(t._fullLayout._uid+g.HOVERID,g.HOVERMINTIME,function(){A(t,r,n,i)})};r.loneHover=function e(t,r){var i={color:t.color||c.defaultLine,x0:t.x0||t.x||0,x1:t.x1||t.x||0,y0:t.y0||t.y||0,y1:t.y1||t.y||0,xLabel:t.xLabel,yLabel:t.yLabel,zLabel:t.zLabel,text:t.text,name:t.name,idealAlign:t.idealAlign,borderColor:t.borderColor,fontFamily:t.fontFamily,fontSize:t.fontSize,fontColor:t.fontColor,trace:{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0};var a=n.select(r.container),o=r.outerContainer?n.select(r.outerContainer):a;var s={hovermode:"closest",rotateLabels:false,bgColor:r.bgColor||c.background,container:a,outerContainer:o};var l=T([i],s,r.gd);E(l,s.rotateLabels);return l.node()};function A(e,t,r,a){if(!r)r="xy";var l=Array.isArray(r)?r:[r];var f=e._fullLayout;var g=f._plots||[];var m=g[r];var y=f._has("cartesian");if(m){var b=m.overlays.map(function(e){return e.id});l=l.concat(b)}var x=l.length;var _=new Array(x);var w=new Array(x);var M=false;for(var A=0;A<x;A++){var P=l[A];var O=g[P];if(O){M=true;_[A]=v.getFromId(e,O.xaxis._id);w[A]=v.getFromId(e,O.yaxis._id);continue}var R=f[P]._subplot;_[A]=R.xaxis;w[A]=R.yaxis}var N=t.hovermode||f.hovermode;if(N&&!M)N="closest";if(["x","y","closest"].indexOf(N)===-1||!e.calcdata||e.querySelector(".zoombox")||e._dragging){return h.unhoverRaw(e,t)}var z=f.hoverdistance===-1?Infinity:f.hoverdistance;var D=f.spikedistance===-1?Infinity:f.spikedistance;var F=[],j=[],B,U,V,H,q,G,W,X,Y,Z,Q,K,J,$={hLinePoint:null,vLinePoint:null};if(Array.isArray(t)){N="array";for(V=0;V<t.length;V++){q=e.calcdata[t[V].curveNumber||0];if(q[0].trace.hoverinfo!=="skip"){j.push(q)}}}else{for(H=0;H<e.calcdata.length;H++){q=e.calcdata[H];G=q[0].trace;if(G.hoverinfo!=="skip"&&p.isTraceInSubplots(G,l)){j.push(q)}}var ee=!t.target,te,re;if(ee){if("xpx"in t)te=t.xpx;else te=_[0]._length/2;if("ypx"in t)re=t.ypx;else re=w[0]._length/2}else{if(s.triggerHandler(e,"plotly_beforehover",t)===false){return}var ne=t.target.getBoundingClientRect();te=t.clientX-ne.left;re=t.clientY-ne.top;if(te<0||te>_[0]._length||re<0||re>w[0]._length){return h.unhoverRaw(e,t)}}t.pointerX=te+_[0]._offset;t.pointerY=re+w[0]._offset;if("xval"in t)B=p.flat(l,t.xval);else B=p.p2c(_,te);if("yval"in t)U=p.flat(l,t.yval);else U=p.p2c(w,re);if(!i(B[0])||!i(U[0])){o.warn("Fx.hover failed",t,e);return h.unhoverRaw(e,t)}}var ie=Infinity;for(H=0;H<j.length;H++){q=j[H];if(!q||!q[0]||!q[0].trace||q[0].trace.visible!==true)continue;G=q[0].trace;if(["carpet","contourcarpet"].indexOf(G._module.name)!==-1)continue;if(G.type==="splom"){X=0;W=l[X]}else{W=p.getSubplot(G);X=l.indexOf(W)}Y=N;K={cd:q,trace:G,xa:_[X],ya:w[X],maxHoverDistance:z,maxSpikeDistance:D,index:false,distance:Math.min(ie,z),spikeDistance:Infinity,xSpike:undefined,ySpike:undefined,color:c.defaultLine,name:G.name,x0:undefined,x1:undefined,y0:undefined,y1:undefined,xLabelVal:undefined,yLabelVal:undefined,zLabelVal:undefined,text:undefined};if(f[W]){K.subplot=f[W]._subplot}J=F.length;if(Y==="array"){var ae=t[H];if("pointNumber"in ae){K.index=ae.pointNumber;Y="closest"}else{Y="";if("xval"in ae){Z=ae.xval;Y="x"}if("yval"in ae){Q=ae.yval;Y=Y?"closest":"y"}}}else{Z=B[X];Q=U[X]}if(z!==0){if(G._module&&G._module.hoverPoints){var oe=G._module.hoverPoints(K,Z,Q,Y,f._hoverlayer);if(oe){var se;for(var le=0;le<oe.length;le++){se=oe[le];if(i(se.x0)&&i(se.y0)){F.push(S(se,N))}}}}else{o.log("Unrecognized trace type in hover:",G)}}if(N==="closest"&&F.length>J){F.splice(0,J);ie=F[0].distance}if(y&&D!==0){if(F.length===0){K.distance=D;K.index=false;var ue=G._module.hoverPoints(K,Z,Q,"closest",f._hoverlayer);if(ue){ue=ue.filter(function(e){return e.spikeDistance<=D})}if(ue&&ue.length){var fe;var ce=ue.filter(function(e){return e.xa.showspikes});if(ce.length){var he=ce[0];if(i(he.x0)&&i(he.y0)){fe=ge(he);if(!$.vLinePoint||$.vLinePoint.spikeDistance>fe.spikeDistance){$.vLinePoint=fe}}}var ve=ue.filter(function(e){return e.ya.showspikes});if(ve.length){var de=ve[0];if(i(de.x0)&&i(de.y0)){fe=ge(de);if(!$.hLinePoint||$.hLinePoint.spikeDistance>fe.spikeDistance){$.hLinePoint=fe}}}}}}}function pe(e,t){var r=null;var n=Infinity;var i;for(var a=0;a<e.length;a++){i=e[a].spikeDistance;if(i<n&&i<=t){r=e[a];n=i}}return r}function ge(e){if(!e)return null;return{xa:e.xa,ya:e.ya,x:e.xSpike!==undefined?e.xSpike:(e.x0+e.x1)/2,y:e.ySpike!==undefined?e.ySpike:(e.y0+e.y1)/2,distance:e.distance,spikeDistance:e.spikeDistance,curveNumber:e.trace.index,color:e.color,pointNumber:e.index}}var me={fullLayout:f,container:f._hoverlayer,outerContainer:f._paperdiv,event:t};var ye=e._spikepoints,be={vLinePoint:$.vLinePoint,hLinePoint:$.hLinePoint};e._spikepoints=be;if(y&&D!==0){if(F.length!==0){var xe=F.filter(function(e){return e.ya.showspikes});var _e=pe(xe,D);$.hLinePoint=ge(_e);var we=F.filter(function(e){return e.xa.showspikes});var Me=pe(we,D);$.vLinePoint=ge(Me)}}if(F.length===0){var Ae=h.unhoverRaw(e,t);if(y&&($.hLinePoint!==null||$.vLinePoint!==null)){if(I(ye)){L($,me)}}return Ae}if(y){if(I(ye)){L($,me)}}F.sort(function(e,t){return e.distance-t.distance});var Te=e._hoverdata,ke=[];for(V=0;V<F.length;V++){var Ee=F[V];ke.push(p.makeEventData(Ee,Ee.trace,Ee.cd))}e._hoverdata=ke;var Se=N==="y"&&j.length>1;var Le=c.combine(f.plot_bgcolor||c.background,f.paper_bgcolor);var Ce={hovermode:N,rotateLabels:Se,bgColor:Le,container:f._hoverlayer,outerContainer:f._paperdiv,commonLabelOpts:f.hoverlabel,hoverdistance:f.hoverdistance};var Ie=T(F,Ce,e);k(F,Se?"xa":"ya",f);E(Ie,Se);if(t.target&&t.target.tagName){var Pe=d.getComponentMethod("annotations","hasClickToShow")(e,ke);u(n.select(t.target),Pe?"pointer":"")}if(!t.target||a||!C(e,t,Te))return;if(Te){e.emit("plotly_unhover",{event:t,points:Te})}e.emit("plotly_hover",{event:t,points:e._hoverdata,xaxes:_,yaxes:w,xvals:B,yvals:U})}function T(e,t,r){var i=t.hovermode;var a=t.rotateLabels;var s=t.bgColor;var u=t.container;var h=t.outerContainer;var v=t.commonLabelOpts||{};var d=t.fontFamily||g.HOVERFONT;var p=t.fontSize||g.HOVERFONTSIZE;var y=e[0];var b=y.xa;var x=y.ya;var _=i==="y"?"yLabel":"xLabel";var A=y[_];var T=(String(A)||"").split(" ")[0];var k=h.node().getBoundingClientRect();var E=k.top;var S=k.width;var L=k.height;var C=A!==undefined&&y.distance<=t.hoverdistance&&(i==="x"||i==="y");if(C){var I,P;var O=true;for(I=0;I<e.length;I++){if(O&&e[I].zLabel===undefined)O=false;P=e[I].hoverinfo||e[I].trace.hoverinfo;var R=Array.isArray(P)?P:P.split("+");if(R.indexOf("all")===-1&&R.indexOf(i)===-1){C=false;break}}if(O)C=false}var N=u.selectAll("g.axistext").data(C?[0]:[]);N.enter().append("g").classed("axistext",true);N.exit().remove();N.each(function(){var t=n.select(this);var a=o.ensureSingle(t,"path","",function(e){e.style({"stroke-width":"1px"})});var s=o.ensureSingle(t,"text","",function(e){e.attr("data-notex",1)});var u=v.bgcolor||c.defaultLine;var h=v.bordercolor||c.contrast(u);a.style({fill:u,stroke:h});s.text(A).call(f.font,v.font.family||d,v.font.size||p,v.font.color||c.background).call(l.positionText,0,0).call(l.convertToTspans,r);t.attr("transform","");var g=s.node().getBoundingClientRect();if(i==="x"){s.attr("text-anchor","middle").call(l.positionText,0,b.side==="top"?E-g.bottom-w-M:E-g.top+w+M);var m=b.side==="top"?"-":"";a.attr("d","M0,0"+"L"+w+","+m+w+"H"+(M+g.width/2)+"v"+m+(M*2+g.height)+"H-"+(M+g.width/2)+"V"+m+w+"H-"+w+"Z");t.attr("transform","translate("+(b._offset+(y.x0+y.x1)/2)+","+(x._offset+(b.side==="top"?0:x._length))+")")}else{s.attr("text-anchor",x.side==="right"?"start":"end").call(l.positionText,(x.side==="right"?1:-1)*(M+w),E-g.top-g.height/2);var k=x.side==="right"?"":"-";a.attr("d","M0,0"+"L"+k+w+","+w+"V"+(M+g.height/2)+"h"+k+(M*2+g.width)+"V-"+(M+g.height/2)+"H"+k+w+"V-"+w+"Z");t.attr("transform","translate("+(b._offset+(x.side==="right"?b._length:0))+","+(x._offset+(y.y0+y.y1)/2)+")")}e=e.filter(function(e){return e.zLabelVal!==undefined||(e[_]||"").split(" ")[0]===T})});var z=u.selectAll("g.hovertext").data(e,function(e){return[e.trace.index,e.index,e.x0,e.y0,e.name,e.attr,e.xa,e.ya||""].join(",")});z.enter().append("g").classed("hovertext",true).each(function(){var e=n.select(this);e.append("rect").call(c.fill,c.addOpacity(s,.8));e.append("text").classed("name",true);e.append("path").style("stroke-width","1px");e.append("text").classed("nums",true).call(f.font,d,p)});z.exit().remove();z.each(function(e){var t=n.select(this).attr("transform",""),o="",u="";var h=c.opacity(e.color)?e.color:c.defaultLine;var v=c.combine(h,s);var g=e.borderColor||c.contrast(v);if(e.nameOverride!==undefined)e.name=e.nameOverride;if(e.name){o=l.plainText(e.name||"");var y=Math.round(e.nameLength);if(y>-1&&o.length>y){if(y>3)o=o.substr(0,y-3)+"...";else o=o.substr(0,y)}}if(e.zLabel!==undefined){if(e.xLabel!==undefined)u+="x: "+e.xLabel+"<br>";if(e.yLabel!==undefined)u+="y: "+e.yLabel+"<br>";u+=(u?"z: ":"")+e.zLabel}else if(C&&e[i+"Label"]===A){u=e[(i==="x"?"y":"x")+"Label"]||""}else if(e.xLabel===undefined){if(e.yLabel!==undefined)u=e.yLabel}else if(e.yLabel===undefined)u=e.xLabel;else u="("+e.xLabel+", "+e.yLabel+")";if((e.text||e.text===0)&&!Array.isArray(e.text)){u+=(u?"<br>":"")+e.text}if(e.extraText!==undefined)u+=(u?"<br>":"")+e.extraText;if(u===""){if(o==="")t.remove();u=o}var b=t.select("text.nums").call(f.font,e.fontFamily||d,e.fontSize||p,e.fontColor||g).text(u).attr("data-notex",1).call(l.positionText,0,0).call(l.convertToTspans,r);var x=t.select("text.name"),_=0;if(o&&o!==u){x.call(f.font,e.fontFamily||d,e.fontSize||p,v).text(o).attr("data-notex",1).call(l.positionText,0,0).call(l.convertToTspans,r);_=x.node().getBoundingClientRect().width+2*M}else{x.remove();t.select("rect").remove()}t.select("path").style({fill:v,stroke:g});var T=b.node().getBoundingClientRect(),k=e.xa._offset+(e.x0+e.x1)/2,I=e.ya._offset+(e.y0+e.y1)/2,P=Math.abs(e.x1-e.x0),O=Math.abs(e.y1-e.y0),R=T.width+w+M+_,N,z;e.ty0=E-T.top;e.bx=T.width+2*M;e.by=T.height+2*M;e.anchor="start";e.txwidth=T.width;e.tx2width=_;e.offset=0;if(a){e.pos=k;N=I+O/2+R<=L;z=I-O/2-R>=0;if((e.idealAlign==="top"||!N)&&z){I-=O/2;e.anchor="end"}else if(N){I+=O/2;e.anchor="start"}else e.anchor="middle"}else{e.pos=I;N=k+P/2+R<=S;z=k-P/2-R>=0;if((e.idealAlign==="left"||!N)&&z){k-=P/2;e.anchor="end"}else if(N){k+=P/2;e.anchor="start"}else e.anchor="middle"}b.attr("text-anchor",e.anchor);if(_)x.attr("text-anchor",e.anchor);t.attr("transform","translate("+k+","+I+")"+(a?"rotate("+m+")":""))});return z}function k(e,t,r){var n=0,i=e.map(function(e,n){var i=e[t];return[{i:n,dp:0,pos:e.pos,posref:e.posref,size:e.by*(i._id.charAt(0)==="x"?b:1)/2,pmin:0,pmax:i._id.charAt(0)==="x"?r.width:r.height}]}).sort(function(e,t){return e[0].posref-t[0].posref}),a,o,s,l,u,f,c;function h(e){var t=e[0],r=e[e.length-1];o=t.pmin-t.pos-t.dp+t.size;s=r.pos+r.dp+r.size-t.pmax;if(o>.01){for(u=e.length-1;u>=0;u--)e[u].dp+=o;a=false}if(s<.01)return;if(o<-.01){for(u=e.length-1;u>=0;u--)e[u].dp-=s;a=false}if(!a)return;var n=0;for(l=0;l<e.length;l++){f=e[l];if(f.pos+f.dp+f.size>t.pmax)n++}for(l=e.length-1;l>=0;l--){if(n<=0)break;f=e[l];if(f.pos>t.pmax-1){f.del=true;n--}}for(l=0;l<e.length;l++){if(n<=0)break;f=e[l];if(f.pos<t.pmin+1){f.del=true;n--;s=f.size*2;for(u=e.length-1;u>=0;u--)e[u].dp-=s}}for(l=e.length-1;l>=0;l--){if(n<=0)break;f=e[l];if(f.pos+f.dp+f.size>t.pmax){f.del=true;n--}}}while(!a&&n<=e.length){n++;a=true;l=0;while(l<i.length-1){var v=i[l],d=i[l+1],p=v[v.length-1],g=d[0];o=p.pos+p.dp+p.size-g.pos-g.dp+g.size;if(o>.01&&p.pmin===g.pmin&&p.pmax===g.pmax){for(u=d.length-1;u>=0;u--)d[u].dp+=o;v.push.apply(v,d);i.splice(l+1,1);c=0;for(u=v.length-1;u>=0;u--)c+=v[u].dp;s=c/v.length;for(u=v.length-1;u>=0;u--)v[u].dp-=s;a=false}else l++}i.forEach(h)}for(l=i.length-1;l>=0;l--){var m=i[l];for(u=m.length-1;u>=0;u--){var y=m[u],x=e[y.i];x.offset=y.dp;x.del=y.del}}}function E(e,t){e.each(function(e){var r=n.select(this);if(e.del){r.remove();return}var i=e.anchor==="end"?-1:1,a=r.select("text.nums"),o={start:1,end:-1,middle:0}[e.anchor],s=o*(w+M),u=s+o*(e.txwidth+M),c=0,h=e.offset;if(e.anchor==="middle"){s-=e.tx2width/2;u+=e.txwidth/2+M}if(t){h*=-_;c=e.offset*x}r.select("path").attr("d",e.anchor==="middle"?"M-"+(e.bx/2+e.tx2width/2)+","+(h-e.by/2)+"h"+e.bx+"v"+e.by+"h-"+e.bx+"Z":"M0,0L"+(i*w+c)+","+(w+h)+"v"+(e.by/2-w)+"h"+i*e.bx+"v-"+e.by+"H"+(i*w+c)+"V"+(h-w)+"Z");a.call(l.positionText,s+c,h+e.ty0-e.by/2+M);if(e.tx2width){r.select("text.name").call(l.positionText,u+o*M+c,h+e.ty0-e.by/2+M);r.select("rect").call(f.setRect,u+(o-1)*e.tx2width/2+c,h-e.by/2-1,e.tx2width,e.by+2)}})}function S(e,t){var r=e.index;var n=e.trace||{};var i=e.cd[0];var a=e.cd[r]||{};var s=Array.isArray(r)?function(e,t){return o.castOption(i,r,e)||o.extractOption({},n,"",t)}:function(e,t){return o.extractOption(a,n,e,t)};function l(t,r,n){var i=s(r,n);if(i)e[t]=i}l("hoverinfo","hi","hoverinfo");l("color","hbg","hoverlabel.bgcolor");l("borderColor","hbc","hoverlabel.bordercolor");l("fontFamily","htf","hoverlabel.font.family");l("fontSize","hts","hoverlabel.font.size");l("fontColor","htc","hoverlabel.font.color");l("nameLength","hnl","hoverlabel.namelength");e.posref=t==="y"?e.xa._offset+(e.x0+e.x1)/2:e.ya._offset+(e.y0+e.y1)/2;e.x0=o.constrain(e.x0,0,e.xa._length);e.x1=o.constrain(e.x1,0,e.xa._length);e.y0=o.constrain(e.y0,0,e.ya._length);e.y1=o.constrain(e.y1,0,e.ya._length);if(e.xLabelVal!==undefined){e.xLabel="xLabel"in e?e.xLabel:v.hoverLabelText(e.xa,e.xLabelVal);e.xVal=e.xa.c2d(e.xLabelVal)}if(e.yLabelVal!==undefined){e.yLabel="yLabel"in e?e.yLabel:v.hoverLabelText(e.ya,e.yLabelVal);e.yVal=e.ya.c2d(e.yLabelVal)}if(e.zLabelVal!==undefined&&e.zLabel===undefined){e.zLabel=String(e.zLabelVal)}if(!isNaN(e.xerr)&&!(e.xa.type==="log"&&e.xerr<=0)){var u=v.tickText(e.xa,e.xa.c2l(e.xerr),"hover").text;if(e.xerrneg!==undefined){e.xLabel+=" +"+u+" / -"+v.tickText(e.xa,e.xa.c2l(e.xerrneg),"hover").text}else e.xLabel+=" \xb1 "+u;if(t==="x")e.distance+=1}if(!isNaN(e.yerr)&&!(e.ya.type==="log"&&e.yerr<=0)){var f=v.tickText(e.ya,e.ya.c2l(e.yerr),"hover").text;if(e.yerrneg!==undefined){e.yLabel+=" +"+f+" / -"+v.tickText(e.ya,e.ya.c2l(e.yerrneg),"hover").text}else e.yLabel+=" \xb1 "+f;if(t==="y")e.distance+=1}var c=e.hoverinfo||e.trace.hoverinfo;if(c!=="all"){c=Array.isArray(c)?c:c.split("+");if(c.indexOf("x")===-1)e.xLabel=undefined;if(c.indexOf("y")===-1)e.yLabel=undefined;if(c.indexOf("z")===-1)e.zLabel=undefined;if(c.indexOf("text")===-1)e.text=undefined;if(c.indexOf("name")===-1)e.name=undefined}return e}function L(e,t){var r=t.container;var n=t.fullLayout;var i=t.event;var o,s;var l=!!e.hLinePoint;var u=!!e.vLinePoint;r.selectAll(".spikeline").remove();if(!(u||l))return;var h=c.combine(n.plot_bgcolor,n.paper_bgcolor);if(l){var v=e.hLinePoint,d,p;o=v&&v.xa;s=v&&v.ya;var g=s.spikesnap;if(g==="cursor"){d=i.pointerX;p=i.pointerY}else{d=o._offset+v.x;p=s._offset+v.y}var m=a.readability(v.color,h)<1.5?c.contrast(h):v.color;var y=s.spikemode,b=s.spikethickness,x=s.spikecolor||m,_=s._boundingBox,w=(_.left+_.right)/2<d?_.right:_.left,M,A;if(y.indexOf("toaxis")!==-1||y.indexOf("across")!==-1){if(y.indexOf("toaxis")!==-1){M=w;A=d}if(y.indexOf("across")!==-1){M=s._counterSpan[0];A=s._counterSpan[1]}r.insert("line",":first-child").attr({x1:M,x2:A,y1:p,y2:p,"stroke-width":b,stroke:x,"stroke-dasharray":f.dashStyle(s.spikedash,b)}).classed("spikeline",true).classed("crisp",true);r.insert("line",":first-child").attr({x1:M,x2:A,y1:p,y2:p,"stroke-width":b+2,stroke:h}).classed("spikeline",true).classed("crisp",true)}if(y.indexOf("marker")!==-1){r.insert("circle",":first-child").attr({cx:w+(s.side!=="right"?b:-b),cy:p,r:b,fill:x}).classed("spikeline",true)}}if(u){var T=e.vLinePoint,k,E;o=T&&T.xa;s=T&&T.ya;var S=o.spikesnap;if(S==="cursor"){k=i.pointerX;E=i.pointerY}else{k=o._offset+T.x;E=s._offset+T.y}var L=a.readability(T.color,h)<1.5?c.contrast(h):T.color;var C=o.spikemode,I=o.spikethickness,P=o.spikecolor||L,O=o._boundingBox,R=(O.top+O.bottom)/2<E?O.bottom:O.top,N,z;if(C.indexOf("toaxis")!==-1||C.indexOf("across")!==-1){if(C.indexOf("toaxis")!==-1){N=R;z=E}if(C.indexOf("across")!==-1){N=o._counterSpan[0];z=o._counterSpan[1]}r.insert("line",":first-child").attr({x1:k,x2:k,y1:N,y2:z,"stroke-width":I,stroke:P,"stroke-dasharray":f.dashStyle(o.spikedash,I)}).classed("spikeline",true).classed("crisp",true);r.insert("line",":first-child").attr({x1:k,x2:k,y1:N,y2:z,"stroke-width":I+2,stroke:h}).classed("spikeline",true).classed("crisp",true)}if(C.indexOf("marker")!==-1){r.insert("circle",":first-child").attr({cx:k,cy:R-(o.side!=="top"?I:-I),r:I,fill:P}).classed("spikeline",true)}}}function C(e,t,r){if(!r||r.length!==e._hoverdata.length)return true;for(var n=r.length-1;n>=0;n--){var i=r[n],a=e._hoverdata[n];if(i.curveNumber!==a.curveNumber||String(i.pointNumber)!==String(a.pointNumber)){return true}}return false}function I(e,t){if(!t)return true;if(t.vLinePoint!==e._spikepoints.vLinePoint||t.hLinePoint!==e._spikepoints.hLinePoint)return true;return false}},{"../../lib":483,"../../lib/events":474,"../../lib/override_cursor":494,"../../lib/svg_text_utils":506,"../../plots/cartesian/axes":529,"../../registry":582,"../color":361,"../dragelement":383,"../drawing":386,"./constants":398,"./helpers":400,d3:81,"fast-isnumeric":91,tinycolor2:327}],402:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r,i,a){a=a||{};i("hoverlabel.bgcolor",a.bgcolor);i("hoverlabel.bordercolor",a.bordercolor);i("hoverlabel.namelength",a.namelength);n.coerceFont(i,"hoverlabel.font",a.font)}},{"../../lib":483}],403:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../lib");var a=e("../dragelement");var o=e("./helpers");var s=e("./layout_attributes");t.exports={moduleType:"component",name:"fx",constants:e("./constants"),schema:{layout:s},attributes:e("./attributes"),layoutAttributes:s,supplyLayoutGlobalDefaults:e("./layout_global_defaults"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),getDistanceFunction:o.getDistanceFunction,getClosest:o.getClosest,inbox:o.inbox,quadrature:o.quadrature,appendArrayPointValue:o.appendArrayPointValue,castHoverOption:u,castHoverinfo:f,hover:e("./hover").hover,unhover:a.unhover,loneHover:e("./hover").loneHover,loneUnhover:l,click:e("./click")};function l(e){var t=i.isD3Selection(e)?e:n.select(e);t.selectAll("g.hovertext").remove();t.selectAll(".spikeline").remove()}function u(e,t,r){return i.castOption(e,t,"hoverlabel."+r)}function f(e,t,r){function n(r){return i.coerceHoverinfo({hoverinfo:r},{_module:e._module},t)}return i.castOption(e,r,"hoverinfo",n)}},{"../../lib":483,"../dragelement":383,"./attributes":395,"./calc":396,"./click":397,"./constants":398,"./defaults":399,"./helpers":400,"./hover":401,"./layout_attributes":404,"./layout_defaults":405,"./layout_global_defaults":406,d3:81}],404:[function(e,t,r){"use strict";var n=e("./constants");var i=e("../../plots/font_attributes")({editType:"none"});i.family.dflt=n.HOVERFONT;i.size.dflt=n.HOVERFONTSIZE;t.exports={dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","orbit","turntable"],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",false],editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:20,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:i,namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":555,"./constants":398}],405:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./layout_attributes");t.exports=function e(t,r,o){function s(e,a){return n.coerce(t,r,i,e,a)}var l=s("dragmode");if(l==="select")s("selectdirection");var u;if(r._has("cartesian")){r._isHoriz=a(o);u=r._isHoriz?"y":"x"}else u="closest";var f=s("hovermode",u);if(f){s("hoverdistance");s("spikedistance")}var c=r._has("mapbox");var h=r._has("geo");var v=r._basePlotModules.length;if(r.dragmode==="zoom"&&((c||h)&&v===1||c&&h&&v===2)){r.dragmode="pan"}};function a(e){var t=true;for(var r=0;r<e.length;r++){var n=e[r];if(n.orientation!=="h"){t=false;break}}return t}},{"../../lib":483,"./layout_attributes":404}],406:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./hoverlabel_defaults");var a=e("./layout_attributes");t.exports=function e(t,r){function o(e,i){return n.coerce(t,r,a,e,i)}i(t,r,o)}},{"../../lib":483,"./hoverlabel_defaults":402,"./layout_attributes":404}],407:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../lib/regex").counter;var a=e("../../plots/domain").attributes;var o=e("../../plots/cartesian/constants").idRegex;var s=e("../../plot_api/plot_template");var l={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:true,dimensions:2,items:{valType:"enumerated",values:[i("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:true,items:{valType:"enumerated",values:[o.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:true,items:{valType:"enumerated",values:[o.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:a({name:"grid",editType:"plot",noGridCell:true},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function u(e,t,r){var n=t[r+"axes"];var i=Object.keys((e._splomAxes||{})[r]||{});if(Array.isArray(n))return n;if(i.length)return i}function f(e,t){var r=e.grid||{};var i=u(t,r,"x");var a=u(t,r,"y");if(!e.grid&&!i&&!a)return;var o=Array.isArray(r.subplots)&&Array.isArray(r.subplots[0]);var f=Array.isArray(i);var h=Array.isArray(a);var v=f&&i!==r.xaxes&&h&&a!==r.yaxes;var d,p;if(o){d=r.subplots.length;p=r.subplots[0].length}else{if(h)d=a.length;if(f)p=i.length}var g=s.newContainer(t,"grid");function m(e,t){return n.coerce(r,g,l,e,t)}var y=m("rows",d);var b=m("columns",p);if(!(y*b>1)){delete t.grid;return}if(!o&&!f&&!h){var x=m("pattern")==="independent";if(x)o=true}g._hasSubplotGrid=o;var _=m("roworder");var w=_==="top to bottom";var M=o?.2:.1;var A=o?.3:.1;var T,k;if(v&&t._splomGridDflt){T=t._splomGridDflt.xside;k=t._splomGridDflt.yside}g._domains={x:c("x",m,M,T,b),y:c("y",m,A,k,y,w)}}function c(e,t,r,n,i,a){var o=t(e+"gap",r);var s=t("domain."+e);t(e+"side",n);var l=new Array(i);var u=s[0];var f=(s[1]-u)/(i-o);var c=f*(1-o);for(var h=0;h<i;h++){var v=u+f*h;l[a?i-1-h:h]=[v,v+c]}return l}function h(e,t){var r=t.grid;if(!r||!r._domains)return;var n=e.grid||{};var i=t._subplots;var a=r._hasSubplotGrid;var o=r.rows;var s=r.columns;var l=r.pattern==="independent";var f,c,h,d,p,g,m;var y=r._axisMap={};if(a){var b=n.subplots||[];g=r.subplots=new Array(o);var x=1;for(f=0;f<o;f++){var _=g[f]=new Array(s);var w=b[f]||[];for(c=0;c<s;c++){if(l){p=x===1?"xy":"x"+x+"y"+x;x++}else p=w[c];_[c]="";if(i.cartesian.indexOf(p)!==-1){m=p.indexOf("y");h=p.slice(0,m);d=p.slice(m);if(y[h]!==undefined&&y[h]!==c||y[d]!==undefined&&y[d]!==f){continue}_[c]=p;y[h]=c;y[d]=f}}}}else{var M=u(t,n,"x");var A=u(t,n,"y");r.xaxes=v(M,i.xaxis,s,y,"x");r.yaxes=v(A,i.yaxis,o,y,"y")}var T=r._anchors={};var k=r.roworder==="top to bottom";for(var E in y){var S=E.charAt(0);var L=r[S+"side"];var C,I,P;if(L.length<8){T[E]="free"}else if(S==="x"){if(L.charAt(0)==="t"===k){C=0;I=1;P=o}else{C=o-1;I=-1;P=-1}if(a){var O=y[E];for(f=C;f!==P;f+=I){p=g[f][O];if(!p)continue;m=p.indexOf("y");if(p.slice(0,m)===E){T[E]=p.slice(m);break}}}else{for(f=C;f!==P;f+=I){d=r.yaxes[f];if(i.cartesian.indexOf(E+d)!==-1){T[E]=d;break}}}}else{if(L.charAt(0)==="l"){C=0;I=1;P=s}else{C=s-1;I=-1;P=-1}if(a){var R=y[E];for(f=C;f!==P;f+=I){p=g[R][f];if(!p)continue;m=p.indexOf("y");if(p.slice(m)===E){T[E]=p.slice(0,m);break}}}else{for(f=C;f!==P;f+=I){h=r.xaxes[f];if(i.cartesian.indexOf(h+E)!==-1){T[E]=h;break}}}}}}function v(e,t,r,n,i){var a=new Array(r);var o;function s(e,r){if(t.indexOf(r)!==-1&&n[r]===undefined){a[e]=r;n[r]=e}else a[e]=""}if(Array.isArray(e)){for(o=0;o<r;o++){s(o,e[o])}}else{s(0,i);for(o=1;o<r;o++){s(o,i+(o+1))}}return a}t.exports={moduleType:"component",name:"grid",schema:{layout:{grid:l}},layoutAttributes:l,sizeDefaults:f,contentDefaults:h}},{"../../lib":483,"../../lib/regex":498,"../../plot_api/plot_template":519,"../../plots/cartesian/constants":534,"../../plots/domain":554}],408:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/constants");var i=e("../../plot_api/plot_template").templatedArray;t.exports=i("image",{visible:{valType:"boolean",dflt:true,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",n.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",n.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../plot_api/plot_template":519,"../../plots/cartesian/constants":534}],409:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib/to_log_range");t.exports=function e(t,r,a,o){r=r||{};var s=a==="log"&&r.type==="linear",l=a==="linear"&&r.type==="log";if(!(s||l))return;var u=t._fullLayout.images,f=r._id.charAt(0),c,h;for(var v=0;v<u.length;v++){c=u[v];h="images["+v+"].";if(c[f+"ref"]===r._id){var d=c[f],p=c["size"+f],g=null,m=null;if(s){g=i(d,r.range);var y=p/Math.pow(10,g)/2;m=2*Math.log(y+Math.sqrt(1+y*y))/Math.LN10}else{g=Math.pow(10,d);m=g*(Math.pow(10,p/2)-Math.pow(10,-p/2))}if(!n(g)){g=null;m=null}else if(!n(m))m=null;o(h+f,g);o(h+"size"+f,m)}}}},{"../../lib/to_log_range":508,"fast-isnumeric":91}],410:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");var a=e("../../plots/array_container_defaults");var o=e("./attributes");var s="images";t.exports=function e(t,r){var n={name:s,handleItemDefaults:l};a(t,r,n)};function l(e,t,r){function a(r,i){return n.coerce(e,t,o,r,i)}var s=a("source");var l=a("visible",!!s);if(!l)return t;a("layer");a("xanchor");a("yanchor");a("sizex");a("sizey");a("sizing");a("opacity");var u={_fullLayout:r},f=["x","y"];for(var c=0;c<2;c++){var h=f[c],v=i.coerceRef(e,t,u,h,"paper");i.coercePosition(t,u,a,v,h,0)}return t}},{"../../lib":483,"../../plots/array_container_defaults":525,"../../plots/cartesian/axes":529,"./attributes":408}],411:[function(e,t,r){"use strict";var n=e("d3");var i=e("../drawing");var a=e("../../plots/cartesian/axes");var o=e("../../constants/xmlns_namespaces");t.exports=function e(t){var r=t._fullLayout,s=[],l={},u=[],f,c;for(c=0;c<r.images.length;c++){var h=r.images[c];if(h.visible){if(h.layer==="below"&&h.xref!=="paper"&&h.yref!=="paper"){f=h.xref+h.yref;var v=r._plots[f];if(!v){u.push(h);continue}if(v.mainplot){f=v.mainplot.id}if(!l[f]){l[f]=[]}l[f].push(h)}else if(h.layer==="above"){s.push(h)}else{u.push(h)}}}var d={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};function p(e){var r=n.select(this);if(this.img&&this.img.src===e.source){return}r.attr("xmlns",o.svg);var i=new Promise(function(t){var n=new Image;this.img=n;n.setAttribute("crossOrigin","anonymous");n.onerror=i;n.onload=function(){var e=document.createElement("canvas");e.width=this.width;e.height=this.height;var n=e.getContext("2d");n.drawImage(this,0,0);var i=e.toDataURL("image/png");r.attr("xlink:href",i);t()};r.on("error",i);n.src=e.source;function i(){r.remove();t()}}.bind(this));t._promises.push(i)}function g(e){var o=n.select(this);var s=a.getFromId(t,e.xref),l=a.getFromId(t,e.yref);var u=r._size,f=s?Math.abs(s.l2p(e.sizex)-s.l2p(0)):e.sizex*u.w,c=l?Math.abs(l.l2p(e.sizey)-l.l2p(0)):e.sizey*u.h;var h=f*d.x[e.xanchor].offset,v=c*d.y[e.yanchor].offset;var p=d.x[e.xanchor].sizing+d.y[e.yanchor].sizing;var g=(s?s.r2p(e.x)+s._offset:e.x*u.w+u.l)+h,m=(l?l.r2p(e.y)+l._offset:u.h-e.y*u.h+u.t)+v;switch(e.sizing){case"fill":p+=" slice";break;case"stretch":p="none";break}o.attr({x:g,y:m,width:f,height:c,preserveAspectRatio:p,opacity:e.opacity});var y=s?s._id:"",b=l?l._id:"",x=y+b;o.call(i.setClipUrl,x?"clip"+r._uid+x:null)}var m=r._imageLowerLayer.selectAll("image").data(u),y=r._imageUpperLayer.selectAll("image").data(s);m.enter().append("image");y.enter().append("image");m.exit().remove();y.exit().remove();m.each(function(e){p.bind(this)(e);g.bind(this)(e)});y.each(function(e){p.bind(this)(e);g.bind(this)(e)});var b=Object.keys(r._plots);for(c=0;c<b.length;c++){f=b[c];var x=r._plots[f];if(!x.imagelayer)continue;var _=x.imagelayer.selectAll("image").data(l[f]||[]);_.enter().append("image");_.exit().remove();_.each(function(e){p.bind(this)(e);g.bind(this)(e)})}}},{"../../constants/xmlns_namespaces":465,"../../plots/cartesian/axes":529,"../drawing":386,d3:81}],412:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"images",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("images"),draw:e("./draw"),convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":539,"./attributes":408,"./convert_coords":409,"./defaults":410,"./draw":411}],413:[function(e,t,r){"use strict";r.isRightAnchor=function e(t){return t.xanchor==="right"||t.xanchor==="auto"&&t.x>=2/3};r.isCenterAnchor=function e(t){return t.xanchor==="center"||t.xanchor==="auto"&&t.x>1/3&&t.x<2/3};r.isBottomAnchor=function e(t){return t.yanchor==="bottom"||t.yanchor==="auto"&&t.y<=1/3};r.isMiddleAnchor=function e(t){return t.yanchor==="middle"||t.yanchor==="auto"&&t.y>1/3&&t.y<2/3}},{}],414:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var i=e("../color/attributes");t.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:i.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:n({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},x:{valType:"number",min:-2,max:3,dflt:1.02,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,dflt:1,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":555,"../color/attributes":360}],415:[function(e,t,r){"use strict";t.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4}},{}],416:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");var a=e("../../plot_api/plot_template");var o=e("./attributes");var s=e("../../plots/layout_attributes");var l=e("./helpers");t.exports=function e(t,r,u){var f=t.legend||{};var c=0;var h="normal";var v,d,p,g;for(var m=0;m<u.length;m++){var y=u[m];if(l.legendGetsTrace(y)){c++;if(n.traceIs(y,"pie"))c++}if(n.traceIs(y,"bar")&&r.barmode==="stack"||["tonextx","tonexty"].indexOf(y.fill)!==-1){h=l.isGrouped({traceorder:h})?"grouped+reversed":"reversed"}if(y.legendgroup!==undefined&&y.legendgroup!==""){h=l.isReversed({traceorder:h})?"reversed+grouped":"grouped"}}var b=i.coerce(t,r,s,"showlegend",c>1);if(b===false)return;var x=a.newContainer(r,"legend");function _(e,t){return i.coerce(f,x,o,e,t)}_("bgcolor",r.paper_bgcolor);_("bordercolor");_("borderwidth");i.coerceFont(_,"font",r.font);_("orientation");if(x.orientation==="h"){var w=t.xaxis;if(w&&w.rangeslider&&w.rangeslider.visible){v=0;p="left";d=1.1;g="bottom"}else{v=0;p="left";d=-.1;g="top"}}_("traceorder",h);if(l.isGrouped(r.legend))_("tracegroupgap");_("x",v);_("xanchor",p);_("y",d);_("yanchor",g);i.noneOrAll(f,x,["x","y"])}},{"../../lib":483,"../../plot_api/plot_template":519,"../../plots/layout_attributes":571,"../../registry":582,"./attributes":414,"./helpers":420}],417:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../lib");var a=e("../../plots/plots");var o=e("../../registry");var s=e("../../lib/events");var l=e("../dragelement");var u=e("../drawing");var f=e("../color");var c=e("../../lib/svg_text_utils");var h=e("./handle_click");var v=e("./constants");var d=e("../../constants/interactions");var p=e("../../constants/alignment");var g=p.LINE_SPACING;var m=p.FROM_TL;var y=p.FROM_BR;var b=e("./get_legend_data");var x=e("./style");var _=e("./helpers");var w=e("./anchor_utils");var M=d.DBLCLICKDELAY;t.exports=function e(t){var r=t._fullLayout;var s="legend"+r._uid;if(!r._infolayer||!t.calcdata)return;if(!t._legendMouseDownTime)t._legendMouseDownTime=0;var c=r.legend;var h=r.showlegend&&b(t.calcdata,c);var d=r.hiddenlabels||[];if(!r.showlegend||!h.length){r._infolayer.selectAll(".legend").remove();r._topdefs.select("#"+s).remove();a.autoMargin(t,"legend");return}var p=0;for(var g=0;g<h.length;g++){for(var m=0;m<h[g].length;m++){var y=h[g][m][0];var _=y.trace;var M=o.traceIs(_,"pie");var k=M?y.label:_.name;p=Math.max(p,k&&k.length||0)}}var S=false;var P=i.ensureSingle(r._infolayer,"g","legend",function(e){e.attr("pointer-events","all");S=true});var O=i.ensureSingleById(r._topdefs,"clipPath",s,function(e){e.append("rect")});var R=i.ensureSingle(P,"rect","bg",function(e){e.attr("shape-rendering","crispEdges")});R.call(f.stroke,c.bordercolor).call(f.fill,c.bgcolor).style("stroke-width",c.borderwidth+"px");var N=i.ensureSingle(P,"g","scrollbox");var z=i.ensureSingle(P,"rect","scrollbar",function(e){e.attr({rx:20,ry:3,width:0,height:0}).call(f.fill,"#808BA4")});var D=N.selectAll("g.groups").data(h);D.enter().append("g").attr("class","groups");D.exit().remove();var F=D.selectAll("g.traces").data(i.identity);F.enter().append("g").attr("class","traces");F.exit().remove();F.call(x,t).style("opacity",function(e){var t=e[0].trace;if(o.traceIs(t,"pie")){return d.indexOf(e[0].label)!==-1?.5:1}else{return t.visible==="legendonly"?.5:1}}).each(function(){n.select(this).call(T,t,p).call(E,t)});if(S){L(t,D,F);C(t)}var j=0,B=r.width,U=0,V=r.height;L(t,D,F);if(c._height>V){I(t)}else{C(t)}var H=r._size,q=H.l+H.w*c.x,G=H.t+H.h*(1-c.y);if(w.isRightAnchor(c)){q-=c._width}else if(w.isCenterAnchor(c)){q-=c._width/2}if(w.isBottomAnchor(c)){G-=c._height}else if(w.isMiddleAnchor(c)){G-=c._height/2}var W=c._width,X=H.w;if(W>X){q=H.l;W=X}else{if(q+W>B)q=B-W;if(q<j)q=j;W=Math.min(B-q,c._width)}var Y=c._height,Z=H.h;if(Y>Z){G=H.t;Y=Z}else{if(G+Y>V)G=V-Y;if(G<U)G=U;Y=Math.min(V-G,c._height)}u.setTranslate(P,q,G);z.on(".drag",null);P.on("wheel",null);if(c._height<=Y||t._context.staticPlot){R.attr({width:W-c.borderwidth,height:Y-c.borderwidth,x:c.borderwidth/2,y:c.borderwidth/2});u.setTranslate(N,0,0);O.select("rect").attr({width:W-2*c.borderwidth,height:Y-2*c.borderwidth,x:c.borderwidth,y:c.borderwidth});u.setClipUrl(N,s);u.setRect(z,0,0,0,0);delete c._scrollY}else{var Q=Math.max(v.scrollBarMinHeight,Y*Y/c._height);var K=Y-Q-2*v.scrollBarMargin;var J=c._height-Y;var $=K/J;var ee=Math.min(c._scrollY||0,J);R.attr({width:W-2*c.borderwidth+v.scrollBarWidth+v.scrollBarMargin,height:Y-c.borderwidth,x:c.borderwidth/2,y:c.borderwidth/2});O.select("rect").attr({width:W-2*c.borderwidth+v.scrollBarWidth+v.scrollBarMargin,height:Y-2*c.borderwidth,x:c.borderwidth,y:c.borderwidth+ee});u.setClipUrl(N,s);ie(ee,Q,$);P.on("wheel",function(){ee=i.constrain(c._scrollY+n.event.deltaY/K*J,0,J);ie(ee,Q,$);if(ee!==0&&ee!==J){n.event.preventDefault()}});var te,re;var ne=n.behavior.drag().on("dragstart",function(){te=n.event.sourceEvent.clientY;re=ee}).on("drag",function(){var e=n.event.sourceEvent;if(e.buttons===2||e.ctrlKey)return;ee=i.constrain((e.clientY-te)/$+re,0,J);ie(ee,Q,$)});z.call(ne)}function ie(e,r,n){c._scrollY=t._fullLayout.legend._scrollY=e;u.setTranslate(N,0,-e);u.setRect(z,W,v.scrollBarMargin+e*n,v.scrollBarWidth,r);O.select("rect").attr({y:c.borderwidth+e})}if(t._context.edits.legendPosition){var ae,oe,se,le;P.classed("cursor-move",true);l.init({element:P.node(),gd:t,prepFn:function(){var e=u.getTranslate(P);se=e.x;le=e.y},moveFn:function(e,t){var r=se+e,n=le+t;u.setTranslate(P,r,n);ae=l.align(r,0,H.l,H.l+H.w,c.xanchor);oe=l.align(n,0,H.t+H.h,H.t,c.yanchor)},doneFn:function(){if(ae!==undefined&&oe!==undefined){o.call("relayout",t,{"legend.x":ae,"legend.y":oe})}},clickFn:function(e,n){var i=r._infolayer.selectAll("g.traces").filter(function(){var e=this.getBoundingClientRect();return n.clientX>=e.left&&n.clientX<=e.right&&n.clientY>=e.top&&n.clientY<=e.bottom});if(i.size()>0){A(t,P,i,e,n)}}})}};function A(e,t,r,n,i){var a=r.data()[0][0].trace;var o={event:i,node:r.node(),curveNumber:a.index,expandedIndex:a._expandedIndex,data:e.data,layout:e.layout,frames:e._transitionData._frames,config:e._context,fullData:e._fullData,fullLayout:e._fullLayout};if(a._group){o.group=a._group}if(a.type==="pie"){o.label=r.datum()[0].label}var l=s.triggerHandler(e,"plotly_legendclick",o);if(l===false)return;if(n===1){t._clickTimeout=setTimeout(function(){h(r,e,n)},M)}else if(n===2){if(t._clickTimeout)clearTimeout(t._clickTimeout);e._legendMouseDownTime=0;var u=s.triggerHandler(e,"plotly_legenddoubleclick",o);if(u!==false)h(r,e,n)}}function T(e,t,r){var n=e.data()[0][0];var a=t._fullLayout;var s=n.trace;var l=o.traceIs(s,"pie");var f=s.index;var h=l?n.label:s.name;var v=t._context.edits.legendText&&!l;var d=i.ensureSingle(e,"text","legendtext");d.attr("text-anchor","start").classed("user-select-none",true).call(u.font,a.legend.font).text(v?k(h,r):h);function p(r){c.convertToTspans(r,t,function(){S(e,t)})}if(v){d.call(c.makeEditable,{gd:t,text:h}).call(p).on("edit",function(e){this.text(k(e,r)).call(p);var a=n.trace._fullInput||{};var s={};if(o.hasTransform(a,"groupby")){var l=o.getTransformIndices(a,"groupby");var u=l[l.length-1];var c=i.keyedContainer(a,"transforms["+u+"].styles","target","value.name");c.set(n.trace._group,e);s=c.constructUpdate()}else{s.name=e}return o.call("restyle",t,s,f)})}else{p(d)}}function k(e,t){var r=Math.max(4,t);if(e&&e.trim().length>=r/2)return e;e=e||"";for(var n=r-e.length;n>0;n--)e+=" ";return e}function E(e,t){var r,a=1;var o=i.ensureSingle(e,"rect","legendtoggle",function(e){e.style("cursor","pointer").attr("pointer-events","all").call(f.fill,"rgba(0,0,0,0)")});o.on("mousedown",function(){r=(new Date).getTime();if(r-t._legendMouseDownTime<M){a+=1}else{a=1;t._legendMouseDownTime=r}});o.on("mouseup",function(){if(t._dragged||t._editing)return;var r=t._fullLayout.legend;if((new Date).getTime()-t._legendMouseDownTime>M){a=Math.max(a-1,1)}A(t,r,e,a,n.event)})}function S(e,t){var r=e.data()[0][0];if(!r.trace.showlegend){e.remove();return}var n=e.select("g[class*=math-group]");var i=n.node();var a=t._fullLayout.legend;var o=a.font.size*g;var s,l;if(i){var f=u.bBox(i);s=f.height;l=f.width;u.setTranslate(n,0,s/4)}else{var h=e.select(".legendtext");var v=c.lineCount(h);var d=h.node();s=o*v;l=d?u.bBox(d).width:0;var p=o*(.3+(1-v)/2);c.positionText(h,40,p)}s=Math.max(s,16)+3;r.height=s;r.width=l}function L(e,t,r){var i=e._fullLayout;var a=i.legend;var o=a.borderwidth;var s=_.isGrouped(a);var l=0;a._width=0;a._height=0;if(_.isVertical(a)){if(s){t.each(function(e,t){u.setTranslate(this,0,t*a.tracegroupgap)})}r.each(function(e){var t=e[0],r=t.height,n=t.width;u.setTranslate(this,o,5+o+a._height+r/2);a._height+=r;a._width=Math.max(a._width,n)});a._width+=45+o*2;a._height+=10+o*2;if(s){a._height+=(a._lgroupsLength-1)*a.tracegroupgap}l=40}else if(s){var f=[a._width],c=t.data();for(var h=0,v=c.length;h<v;h++){var d=c[h].map(function(e){return e[0].width});var p=40+Math.max.apply(null,d);a._width+=a.tracegroupgap+p;f.push(a._width)}t.each(function(e,t){u.setTranslate(this,f[t],0)});t.each(function(){var e=n.select(this),t=e.selectAll("g.traces"),r=0;t.each(function(e){var t=e[0],n=t.height;u.setTranslate(this,0,5+o+r+n/2);r+=n});a._height=Math.max(a._height,r)});a._height+=10+o*2;a._width+=o*2}else{var g=0,m=0,y=0,b=0,x=0,w=a.tracegroupgap||5,M;r.each(function(e){y=Math.max(40+e[0].width,y);x+=40+e[0].width+w});M=i.width-(i.margin.r+i.margin.l)>o+x-w;r.each(function(e){var t=e[0],r=M?40+e[0].width:y;if(o+b+w+r>i.width-(i.margin.r+i.margin.l)){b=0;g=g+m;a._height=a._height+m;m=0}u.setTranslate(this,o+b,5+o+t.height/2+g);a._width+=w+r;a._height=Math.max(a._height,t.height);b+=w+r;m=Math.max(t.height,m)});a._width+=o*2;a._height+=10+o*2}a._width=Math.ceil(a._width);a._height=Math.ceil(a._height);r.each(function(t){var r=t[0],i=n.select(this).select(".legendtoggle");u.setRect(i,0,-r.height/2,(e._context.edits.legendText?0:a._width)+l,r.height)})}function C(e){var t=e._fullLayout,r=t.legend;var n="left";if(w.isRightAnchor(r)){n="right"}else if(w.isCenterAnchor(r)){n="center"}var i="top";if(w.isBottomAnchor(r)){i="bottom"}else if(w.isMiddleAnchor(r)){i="middle"}a.autoMargin(e,"legend",{x:r.x,y:r.y,l:r._width*m[n],r:r._width*y[n],b:r._height*y[i],t:r._height*m[i]})}function I(e){var t=e._fullLayout,r=t.legend;var n="left";if(w.isRightAnchor(r)){n="right"}else if(w.isCenterAnchor(r)){n="center"}a.autoMargin(e,"legend",{x:r.x,y:.5,l:r._width*m[n],r:r._width*y[n],b:0,t:0})}},{"../../constants/alignment":459,"../../constants/interactions":462,"../../lib":483,"../../lib/events":474,"../../lib/svg_text_utils":506,"../../plots/plots":573,"../../registry":582,"../color":361,"../dragelement":383,"../drawing":386,"./anchor_utils":413,"./constants":415,"./get_legend_data":418,"./handle_click":419,"./helpers":420,"./style":422,d3:81}],418:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("./helpers");t.exports=function e(t,r){var a={},o=[],s=false,l={},u=0;var f,c;function h(e,t){if(e===""||!i.isGrouped(r)){var n="~~i"+u;o.push(n);a[n]=[[t]];u++}else if(o.indexOf(e)===-1){o.push(e);s=true;a[e]=[[t]]}else a[e].push([t])}for(f=0;f<t.length;f++){var v=t[f],d=v[0],p=d.trace,g=p.legendgroup;if(!i.legendGetsTrace(p)||!p.showlegend)continue;if(n.traceIs(p,"pie")){if(!l[g])l[g]={};for(c=0;c<v.length;c++){var m=v[c].label;if(!l[g][m]){h(g,{label:m,color:v[c].color,i:v[c].i,trace:p});l[g][m]=true}}}else h(g,d)}if(!o.length)return[];var y=o.length,b,x;if(s&&i.isGrouped(r)){x=new Array(y);for(f=0;f<y;f++){b=a[o[f]];x[f]=i.isReversed(r)?b.reverse():b}}else{x=[new Array(y)];for(f=0;f<y;f++){b=a[o[f]][0];x[0][i.isReversed(r)?y-f-1:f]=b}y=1}r._lgroupsLength=y;return x}},{"../../registry":582,"./helpers":420}],419:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../registry");var a=true;t.exports=function e(t,r,o){if(r._dragged||r._editing)return;var s=r._fullLayout.hiddenlabels?r._fullLayout.hiddenlabels.slice():[];var l=t.data()[0][0];var u=r._fullData;var f=l.trace;var c=f.legendgroup;var h,v,d,p,g,m;var y={};var b=[];var x=[];var _=[];function w(e,t,r){var n=b.indexOf(e);var i=y[t];if(!i){i=y[t]=[]}if(b.indexOf(e)===-1){b.push(e);n=b.length-1}i[n]=r;return n}function M(e,t){var r=e._fullInput;if(i.hasTransform(r,"groupby")){var a=x[r.index];if(!a){var o=i.getTransformIndices(r,"groupby");var s=o[o.length-1];a=n.keyedContainer(r,"transforms["+s+"].styles","target","value.visible");x[r.index]=a}var l=a.get(e._group);if(l===undefined){l=true}if(l!==false){a.set(e._group,t)}_[r.index]=w(r.index,"visible",r.visible===false?false:true)}else{var u=r.visible===false?false:t;w(r.index,"visible",u)}}if(o===1&&a&&r.data&&r._context.showTips){n.notifier(n._(r,"Double-click on legend to isolate one trace"),"long");a=false}else{a=false}if(i.traceIs(f,"pie")){var A=l.label,T=s.indexOf(A);if(o===1){if(T===-1)s.push(A);else s.splice(T,1)}else if(o===2){s=[];r.calcdata[0].forEach(function(e){if(A!==e.label){s.push(e.label)}});if(r._fullLayout.hiddenlabels&&r._fullLayout.hiddenlabels.length===s.length&&T===-1){s=[]}}i.call("relayout",r,"hiddenlabels",s)}else{var k=c&&c.length;var E=[];var S;if(k){for(h=0;h<u.length;h++){S=u[h];if(!S.visible)continue;if(S.legendgroup===c){E.push(h)}}}if(o===1){var L;switch(f.visible){case true:L="legendonly";break;case false:L=false;break;case"legendonly":L=true;break}if(k){for(h=0;h<u.length;h++){if(u[h].visible!==false&&u[h].legendgroup===c){M(u[h],L)}}}else{M(f,L)}}else if(o===2){var C,I,P;var O=true;for(h=0;h<u.length;h++){C=u[h]===f;if(C)continue;I=k&&u[h].legendgroup===c;if(!I&&u[h].visible===true&&!i.traceIs(u[h],"notLegendIsolatable")){O=false;break}}for(h=0;h<u.length;h++){if(u[h].visible===false)continue;if(i.traceIs(u[h],"notLegendIsolatable")){continue}switch(f.visible){case"legendonly":M(u[h],true);break;case true:P=O?true:"legendonly";C=u[h]===f;I=C||k&&u[h].legendgroup===c;M(u[h],I?true:P);break}}}for(h=0;h<x.length;h++){d=x[h];if(!d)continue;var R=d.constructUpdate();var N=Object.keys(R);for(v=0;v<N.length;v++){p=N[v];m=y[p]=y[p]||[];m[_[h]]=R[p]}}g=Object.keys(y);for(h=0;h<g.length;h++){p=g[h];for(v=0;v<b.length;v++){if(!y[p].hasOwnProperty(v)){y[p][v]=undefined}}}i.call("restyle",r,y,b)}}},{"../../lib":483,"../../registry":582}],420:[function(e,t,r){"use strict";r.legendGetsTrace=function e(t){return t.visible&&t.showlegend!==undefined};r.isGrouped=function e(t){return(t.traceorder||"").indexOf("grouped")!==-1};r.isVertical=function e(t){return t.orientation!=="h"};r.isReversed=function e(t){return(t.traceorder||"").indexOf("reversed")!==-1}},{}],421:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"legend",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw"),style:e("./style")}},{"./attributes":414,"./defaults":416,"./draw":417,"./style":422}],422:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../lib");var o=e("../drawing");var s=e("../color");var l=e("../../traces/scatter/subtypes");var u=e("../../traces/pie/style_one");t.exports=function e(t,r){t.each(function(e){var t=n.select(this);var r=a.ensureSingle(t,"g","layers");r.style("opacity",e[0].trace.opacity);var i=r.selectAll("g.legendfill").data([e]);i.enter().append("g").classed("legendfill",true);var o=r.selectAll("g.legendlines").data([e]);o.enter().append("g").classed("legendlines",true);var s=r.selectAll("g.legendsymbols").data([e]);s.enter().append("g").classed("legendsymbols",true);s.selectAll("g.legendpoints").data([e]).enter().append("g").classed("legendpoints",true)}).each(h).each(v).each(g).each(f).each(c).each(d).each(p);function f(e){var t=e[0].trace;var r=t.visible&&t.fill&&t.fill!=="none";var i=l.hasLines(t);var a=t.contours;if(a&&a.type==="constraint"){i=a.showlines;r=a._operation!=="="}var s=n.select(this).select(".legendfill").selectAll("path").data(r?[e]:[]);s.enter().append("path").classed("js-fill",true);s.exit().remove();s.attr("d","M5,0h30v6h-30z").call(o.fillGroupStyle);var u=n.select(this).select(".legendlines").selectAll("path").data(i?[e]:[]);u.enter().append("path").classed("js-line",true).attr("d","M5,0h30");u.exit().remove();u.call(o.lineGroupStyle)}function c(e){var t=e[0],i=t.trace,s=l.hasMarkers(i),u=l.hasText(i),f=l.hasLines(i);var c,h;function v(e,t,r){var n=a.nestedProperty(i,e).get(),o=Array.isArray(n)&&t?t(n):n;if(r){if(o<r[0])return r[0];else if(o>r[1])return r[1]}return o}function d(e){return e[0]}if(s||u||f){var p={};var g={};if(s){p.mc=v("marker.color",d);p.mo=v("marker.opacity",a.mean,[.2,1]);p.ms=v("marker.size",a.mean,[2,16]);p.mlc=v("marker.line.color",d);p.mlw=v("marker.line.width",a.mean,[0,5]);g.marker={sizeref:1,sizemin:1,sizemode:"diameter"}}if(f){g.line={width:v("line.width",d,[0,10])}}if(u){p.tx="Aa";p.tp=v("textposition",d);p.ts=10;p.tc=v("textfont.color",d);p.tf=v("textfont.family",d)}c=[a.minExtend(t,p)];h=a.minExtend(i,g);h.selectedpoints=null}var m=n.select(this).select("g.legendpoints");var y=m.selectAll("path.scatterpts").data(s?c:[]);y.enter().append("path").classed("scatterpts",true).attr("transform","translate(20,0)");y.exit().remove();y.call(o.pointStyle,h,r);if(s)c[0].mrc=3;var b=m.selectAll("g.pointtext").data(u?c:[]);b.enter().append("g").classed("pointtext",true).append("text").attr("transform","translate(20,0)");b.exit().remove();b.selectAll("text").call(o.textPointStyle,h,r)}function h(e){var t=e[0].trace,r=t.marker||{},a=r.line||{},o=n.select(this).select("g.legendpoints").selectAll("path.legendbar").data(i.traceIs(t,"bar")?[e]:[]);o.enter().append("path").classed("legendbar",true).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)");o.exit().remove();o.each(function(e){var t=n.select(this),i=e[0],o=(i.mlw+1||a.width+1)-1;t.style("stroke-width",o+"px").call(s.fill,i.mc||r.color);if(o){t.call(s.stroke,i.mlc||a.color)}})}function v(e){var t=e[0].trace,r=n.select(this).select("g.legendpoints").selectAll("path.legendbox").data(i.traceIs(t,"box-violin")&&t.visible?[e]:[]);r.enter().append("path").classed("legendbox",true).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)");r.exit().remove();r.each(function(){var e=t.line.width,r=n.select(this);r.style("stroke-width",e+"px").call(s.fill,t.fillcolor);if(e){s.stroke(r,t.line.color)}})}function d(e){var t=e[0].trace,r=n.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(t.type==="candlestick"&&t.visible?[e,e]:[]);r.enter().append("path").classed("legendcandle",true).attr("d",function(e,t){if(t)return"M-15,0H-8M-8,6V-6H8Z";return"M15,0H8M8,-6V6H-8Z"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1);r.exit().remove();r.each(function(e,r){var i=t[r?"increasing":"decreasing"];var a=i.line.width,o=n.select(this);o.style("stroke-width",a+"px").call(s.fill,i.fillcolor);if(a){s.stroke(o,i.line.color)}})}function p(e){var t=e[0].trace,r=n.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(t.type==="ohlc"&&t.visible?[e,e]:[]);r.enter().append("path").classed("legendohlc",true).attr("d",function(e,t){if(t)return"M-15,0H0M-8,-6V0";return"M15,0H0M8,6V0"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1);r.exit().remove();r.each(function(e,r){var i=t[r?"increasing":"decreasing"];var a=i.line.width,l=n.select(this);l.style("fill","none").call(o.dashLine,i.line.dash,a);if(a){s.stroke(l,i.line.color)}})}function g(e){var t=e[0].trace,r=n.select(this).select("g.legendpoints").selectAll("path.legendpie").data(i.traceIs(t,"pie")&&t.visible?[e]:[]);r.enter().append("path").classed("legendpie",true).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)");r.exit().remove();if(r.size())r.call(u,e[0],t)}}},{"../../lib":483,"../../registry":582,"../../traces/pie/style_one":602,"../../traces/scatter/subtypes":626,"../color":361,"../drawing":386,d3:81}],423:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../plots/plots");var a=e("../../plots/cartesian/axis_ids");var o=e("../../lib");var s=e("../../../build/ploticon");var l=o._;var u=t.exports={};u.toImage={name:"toImage",title:function(e){var t=e._context.toImageButtonOptions||{};var r=t.format||"png";return r==="png"?l(e,"Download plot as a png"):l(e,"Download plot")},icon:s.camera,click:function(e){var t=e._context.toImageButtonOptions;var r={format:t.format||"png"};o.notifier(l(e,"Taking snapshot - this may take a few seconds"),"long");if(r.format!=="svg"&&o.isIE()){o.notifier(l(e,"IE only supports svg.  Changing format to svg."),"long");r.format="svg"}["filename","width","height","scale"].forEach(function(e){if(t[e]){r[e]=t[e]}});n.call("downloadImage",e,r).then(function(t){o.notifier(l(e,"Snapshot succeeded")+" - "+t,"long")}).catch(function(){o.notifier(l(e,"Sorry, there was a problem downloading your snapshot!"),"long")})}};u.sendDataToCloud={name:"sendDataToCloud",title:function(e){return l(e,"Edit in Chart Studio")},icon:s.disk,click:function(e){i.sendDataToCloud(e)}};u.zoom2d={name:"zoom2d",title:function(e){return l(e,"Zoom")},attr:"dragmode",val:"zoom",icon:s.zoombox,click:f};u.pan2d={name:"pan2d",title:function(e){return l(e,"Pan")},attr:"dragmode",val:"pan",icon:s.pan,click:f};u.select2d={name:"select2d",title:function(e){return l(e,"Box Select")},attr:"dragmode",val:"select",icon:s.selectbox,click:f};u.lasso2d={name:"lasso2d",title:function(e){return l(e,"Lasso Select")},attr:"dragmode",val:"lasso",icon:s.lasso,click:f};u.zoomIn2d={name:"zoomIn2d",title:function(e){return l(e,"Zoom in")},attr:"zoom",val:"in",icon:s.zoom_plus,click:f};u.zoomOut2d={name:"zoomOut2d",title:function(e){return l(e,"Zoom out")},attr:"zoom",val:"out",icon:s.zoom_minus,click:f};u.autoScale2d={name:"autoScale2d",title:function(e){return l(e,"Autoscale")},attr:"zoom",val:"auto",icon:s.autoscale,click:f};u.resetScale2d={name:"resetScale2d",title:function(e){return l(e,"Reset axes")},attr:"zoom",val:"reset",icon:s.home,click:f};u.hoverClosestCartesian={name:"hoverClosestCartesian",title:function(e){return l(e,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:s.tooltip_basic,gravity:"ne",click:f};u.hoverCompareCartesian={name:"hoverCompareCartesian",title:function(e){return l(e,"Compare data on hover")},attr:"hovermode",val:function(e){return e._fullLayout._isHoriz?"y":"x"},icon:s.tooltip_compare,gravity:"ne",click:f};function f(e,t){var r=t.currentTarget;var i=r.getAttribute("data-attr");var o=r.getAttribute("data-val")||true;var s=e._fullLayout;var l={};var u=a.list(e,null,true);var f="on";var c,h;if(i==="zoom"){var v=o==="in"?.5:2,d=(1+v)/2,p=(1-v)/2;var g;for(h=0;h<u.length;h++){c=u[h];if(!c.fixedrange){g=c._name;if(o==="auto")l[g+".autorange"]=true;else if(o==="reset"){if(c._rangeInitial===undefined){l[g+".autorange"]=true}else{var m=c._rangeInitial.slice();l[g+".range[0]"]=m[0];l[g+".range[1]"]=m[1]}if(c._showSpikeInitial!==undefined){l[g+".showspikes"]=c._showSpikeInitial;if(f==="on"&&!c._showSpikeInitial){f="off"}}}else{var y=[c.r2l(c.range[0]),c.r2l(c.range[1])];var b=[d*y[0]+p*y[1],d*y[1]+p*y[0]];l[g+".range[0]"]=c.l2r(b[0]);l[g+".range[1]"]=c.l2r(b[1])}}}s._cartesianSpikesEnabled=f}else{if(i==="hovermode"&&(o==="x"||o==="y")){o=s._isHoriz?"y":"x";r.setAttribute("data-val",o)}else if(i==="hovermode"&&o==="closest"){for(h=0;h<u.length;h++){c=u[h];if(f==="on"&&!c.showspikes){f="off"}}s._cartesianSpikesEnabled=f}l[i]=o}n.call("relayout",e,l)}u.zoom3d={name:"zoom3d",title:function(e){return l(e,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:s.zoombox,click:c};u.pan3d={name:"pan3d",title:function(e){return l(e,"Pan")},attr:"scene.dragmode",val:"pan",icon:s.pan,click:c};u.orbitRotation={name:"orbitRotation",title:function(e){return l(e,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:s["3d_rotate"],click:c};u.tableRotation={name:"tableRotation",title:function(e){return l(e,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:s["z-axis"],click:c};function c(e,t){var r=t.currentTarget;var i=r.getAttribute("data-attr");var a=r.getAttribute("data-val")||true;var o=e._fullLayout._subplots.gl3d;var s={};var l=i.split(".");for(var u=0;u<o.length;u++){s[o[u]+"."+l[1]]=a}var f=a==="pan"?a:"zoom";s.dragmode=f;n.call("relayout",e,s)}u.resetCameraDefault3d={name:"resetCameraDefault3d",title:function(e){return l(e,"Reset camera to default")},attr:"resetDefault",icon:s.home,click:h};u.resetCameraLastSave3d={name:"resetCameraLastSave3d",title:function(e){return l(e,"Reset camera to last save")},attr:"resetLastSave",icon:s.movie,click:h};function h(e,t){var r=t.currentTarget;var i=r.getAttribute("data-attr");var a=e._fullLayout;var s=a._subplots.gl3d;var l={};for(var u=0;u<s.length;u++){var f=s[u],c=f+".camera",h=a[f]._scene;if(i==="resetDefault"){l[c]=null}else if(i==="resetLastSave"){l[c]=o.extendDeep({},h.cameraInitial)}}n.call("relayout",e,l)}u.hoverClosest3d={name:"hoverClosest3d",title:function(e){return l(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:s.tooltip_basic,gravity:"ne",click:v};function v(e,t){var r=t.currentTarget;var i=r._previousVal||false;var a=e.layout;var s=e._fullLayout;var l=s._subplots.gl3d;var u=["xaxis","yaxis","zaxis"];var f=["showspikes","spikesides","spikethickness","spikecolor"];var c={};var h={};var v={};if(i){v=o.extendDeep(a,i);r._previousVal=null}else{v={"allaxes.showspikes":false};for(var d=0;d<l.length;d++){var p=l[d],g=s[p],m=c[p]={};m.hovermode=g.hovermode;v[p+".hovermode"]=false;for(var y=0;y<3;y++){var b=u[y];h=m[b]={};for(var x=0;x<f.length;x++){var _=f[x];h[_]=g[b][_]}}}r._previousVal=o.extendDeep({},c)}n.call("relayout",e,v)}u.zoomInGeo={name:"zoomInGeo",title:function(e){return l(e,"Zoom in")},attr:"zoom",val:"in",icon:s.zoom_plus,click:d};u.zoomOutGeo={name:"zoomOutGeo",title:function(e){return l(e,"Zoom out")},attr:"zoom",val:"out",icon:s.zoom_minus,click:d};u.resetGeo={name:"resetGeo",title:function(e){return l(e,"Reset")},attr:"reset",val:null,icon:s.autoscale,click:d};u.hoverClosestGeo={name:"hoverClosestGeo",title:function(e){return l(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:s.tooltip_basic,gravity:"ne",click:p};function d(e,t){var r=t.currentTarget;var i=r.getAttribute("data-attr");var a=r.getAttribute("data-val")||true;var o=e._fullLayout;var s=o._subplots.geo;for(var l=0;l<s.length;l++){var u=s[l];var f=o[u];if(i==="zoom"){var c=f.projection.scale;var h=a==="in"?2*c:.5*c;n.call("relayout",e,u+".projection.scale",h)}else if(i==="reset"){m(e,"geo")}}}u.hoverClosestGl2d={name:"hoverClosestGl2d",title:function(e){return l(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:s.tooltip_basic,gravity:"ne",click:p};u.hoverClosestPie={name:"hoverClosestPie",title:function(e){return l(e,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:s.tooltip_basic,gravity:"ne",click:p};function p(e){var t=e._fullLayout;var r;if(t._has("cartesian")){r=t._isHoriz?"y":"x"}else r="closest";var i=e._fullLayout.hovermode?false:r;n.call("relayout",e,"hovermode",i)}u.toggleHover={name:"toggleHover",title:function(e){return l(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:s.tooltip_basic,gravity:"ne",click:function(e,t){p(e);v(e,t)}};u.resetViews={name:"resetViews",title:function(e){return l(e,"Reset views")},icon:s.home,click:function(e,t){var r=t.currentTarget;r.setAttribute("data-attr","zoom");r.setAttribute("data-val","reset");f(e,t);r.setAttribute("data-attr","resetLastSave");h(e,t);m(e,"geo");m(e,"mapbox")}};u.toggleSpikelines={name:"toggleSpikelines",title:function(e){return l(e,"Toggle Spike Lines")},icon:s.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(e){var t=e._fullLayout;t._cartesianSpikesEnabled=t._cartesianSpikesEnabled==="on"?"off":"on";var r=g(e);n.call("relayout",e,r)}};function g(e){var t=e._fullLayout;var r=a.list(e,null,true);var n={};var i,o;for(var s=0;s<r.length;s++){i=r[s];o=i._name;n[o+".showspikes"]=t._cartesianSpikesEnabled==="on"?true:i._showSpikeInitial}return n}u.resetViewMapbox={name:"resetViewMapbox",title:function(e){return l(e,"Reset view")},attr:"reset",icon:s.home,click:function(e){m(e,"mapbox")}};function m(e,t){var r=e._fullLayout;var i=r._subplots[t];var a={};for(var o=0;o<i.length;o++){var s=i[o];var l=r[s]._subplot;var u=l.viewInitial;var f=Object.keys(u);for(var c=0;c<f.length;c++){var h=f[c];a[s+"."+h]=u[h]}}n.call("relayout",e,a)}},{"../../../build/ploticon":2,"../../lib":483,"../../plots/cartesian/axis_ids":532,"../../plots/plots":573,"../../registry":582}],424:[function(e,t,r){"use strict";r.manage=e("./manage")},{"./manage":425}],425:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axis_ids");var i=e("../../traces/scatter/subtypes");var a=e("../../registry");var o=e("./modebar");var s=e("./buttons");t.exports=function e(t){var r=t._fullLayout,n=t._context,i=r._modeBar;if(!n.displayModeBar){if(i){i.destroy();delete r._modeBar}return}if(!Array.isArray(n.modeBarButtonsToRemove)){throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "))}if(!Array.isArray(n.modeBarButtonsToAdd)){throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "))}var a=n.modeBarButtons;var s;if(Array.isArray(a)&&a.length){s=h(a)}else{s=l(t,n.modeBarButtonsToRemove,n.modeBarButtonsToAdd)}if(i)i.update(t,s);else r._modeBar=o(t,s)};function l(e,t,r){var n=e._fullLayout;var i=e._fullData;var a=n._has("cartesian");var o=n._has("gl3d");var l=n._has("geo");var h=n._has("pie");var v=n._has("gl2d");var d=n._has("ternary");var p=n._has("mapbox");var g=n._has("polar");var m=u(n);var y=[];function b(e){if(!e.length)return;var r=[];for(var n=0;n<e.length;n++){var i=e[n];if(t.indexOf(i)!==-1)continue;r.push(s[i])}y.push(r)}b(["toImage","sendDataToCloud"]);var x=[];var _=[];var w=[];var M=[];if((a||v||h||d)+l+o+p+g>1){_=["toggleHover"];w=["resetViews"]}else if(l){x=["zoomInGeo","zoomOutGeo"];_=["hoverClosestGeo"];w=["resetGeo"]}else if(o){_=["hoverClosest3d"];w=["resetCameraDefault3d","resetCameraLastSave3d"]}else if(p){_=["toggleHover"];w=["resetViewMapbox"]}else if(v){_=["hoverClosestGl2d"]}else if(h){_=["hoverClosestPie"]}else{_=["toggleHover"]}if(a){_=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]}if((a||v)&&!m){x=["zoomIn2d","zoomOut2d","autoScale2d"];if(w[0]!=="resetViews")w=["resetScale2d"]}if(o){M=["zoom3d","pan3d","orbitRotation","tableRotation"]}else if((a||v)&&!m||d){M=["zoom2d","pan2d"]}else if(p||l){M=["pan2d"]}else if(g){M=["zoom2d"]}if(f(i)){M.push("select2d","lasso2d")}b(M);b(x.concat(w));b(_);return c(y,r)}function u(e){var t=n.list({_fullLayout:e},null,true);for(var r=0;r<t.length;r++){if(!t[r].fixedrange){return false}}return true}function f(e){var t=false;for(var r=0;r<e.length;r++){if(t)break;var n=e[r];if(!n._module||!n._module.selectPoints)continue;if(a.traceIs(n,"scatter-like")){if(i.hasMarkers(n)||i.hasText(n)){t=true}}else if(a.traceIs(n,"box-violin")){if(n.boxpoints==="all"||n.points==="all"){t=true}}else t=true}return t}function c(e,t){if(t.length){if(Array.isArray(t[0])){for(var r=0;r<t.length;r++){e.push(t[r])}}else e.push(t)}return e}function h(e){for(var t=0;t<e.length;t++){var r=e[t];for(var n=0;n<r.length;n++){var i=r[n];if(typeof i==="string"){if(s[i]!==undefined){e[t][n]=s[i]}else{throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "))}}}}return e}},{"../../plots/cartesian/axis_ids":532,"../../registry":582,"../../traces/scatter/subtypes":626,"./buttons":423,"./modebar":426}],426:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../../lib");var o=e("../../../build/ploticon");function s(e){this.container=e.container;this.element=document.createElement("div");this.update(e.graphInfo,e.buttons);this.container.appendChild(this.element)}var l=s.prototype;l.update=function(e,t){this.graphInfo=e;var r=this.graphInfo._context;if(r.displayModeBar==="hover"){this.element.className="modebar modebar--hover"}else this.element.className="modebar";var n=!this.hasButtons(t);var i=this.hasLogo!==r.displaylogo;var a=this.locale!==r.locale;this.locale=r.locale;if(n||i||a){this.removeAllButtons();this.updateButtons(t);if(r.displaylogo){this.element.appendChild(this.getLogo());this.hasLogo=true}}this.updateActiveButton()};l.updateButtons=function(e){var t=this;this.buttons=e;this.buttonElements=[];this.buttonsNames=[];this.buttons.forEach(function(e){var r=t.createGroup();e.forEach(function(e){var n=e.name;if(!n){throw new Error("must provide button 'name' in button config")}if(t.buttonsNames.indexOf(n)!==-1){throw new Error("button name '"+n+"' is taken")}t.buttonsNames.push(n);var i=t.createButton(e);t.buttonElements.push(i);r.appendChild(i)});t.element.appendChild(r)})};l.createGroup=function(){var e=document.createElement("div");e.className="modebar-group";return e};l.createButton=function(e){var t=this,r=document.createElement("a");r.setAttribute("rel","tooltip");r.className="modebar-btn";var i=e.title;if(i===undefined)i=e.name;else if(typeof i==="function")i=i(this.graphInfo);if(i||i===0)r.setAttribute("data-title",i);if(e.attr!==undefined)r.setAttribute("data-attr",e.attr);var a=e.val;if(a!==undefined){if(typeof a==="function")a=a(this.graphInfo);r.setAttribute("data-val",a)}var s=e.click;if(typeof s!=="function"){throw new Error("must provide button 'click' function in button config")}else{r.addEventListener("click",function(r){e.click(t.graphInfo,r);t.updateActiveButton(r.currentTarget)})}r.setAttribute("data-toggle",e.toggle||false);if(e.toggle)n.select(r).classed("active",true);var l=e.icon;if(typeof l==="function"){r.appendChild(l())}else{r.appendChild(this.createIcon(l||o.question))}r.setAttribute("data-gravity",e.gravity||"n");return r};l.createIcon=function(e){var t=i(e.height)?Number(e.height):e.ascent-e.descent,r="http://www.w3.org/2000/svg",n=document.createElementNS(r,"svg"),a=document.createElementNS(r,"path");n.setAttribute("height","1em");n.setAttribute("width",e.width/t+"em");n.setAttribute("viewBox",[0,0,e.width,t].join(" "));a.setAttribute("d",e.path);if(e.transform){a.setAttribute("transform",e.transform)}else if(e.ascent!==undefined){a.setAttribute("transform","matrix(1 0 0 -1 0 "+e.ascent+")")}n.appendChild(a);return n};l.updateActiveButton=function(e){var t=this.graphInfo._fullLayout,r=e!==undefined?e.getAttribute("data-attr"):null;this.buttonElements.forEach(function(e){var i=e.getAttribute("data-val")||true,o=e.getAttribute("data-attr"),s=e.getAttribute("data-toggle")==="true",l=n.select(e);if(s){if(o===r){l.classed("active",!l.classed("active"))}}else{var u=o===null?o:a.nestedProperty(t,o).get();l.classed("active",u===i)}})};l.hasButtons=function(e){var t=this.buttons;if(!t)return false;if(e.length!==t.length)return false;for(var r=0;r<e.length;++r){if(e[r].length!==t[r].length)return false;for(var n=0;n<e[r].length;n++){if(e[r][n].name!==t[r][n].name)return false}}return true};l.getLogo=function(){var e=this.createGroup(),t=document.createElement("a");t.href="https://plot.ly/";t.target="_blank";t.setAttribute("data-title",a._(this.graphInfo,"Produced with Plotly"));t.className="modebar-btn plotlyjsicon modebar-btn--logo";t.appendChild(this.createIcon(o.plotlylogo));e.appendChild(t);return e};l.removeAllButtons=function(){while(this.element.firstChild){this.element.removeChild(this.element.firstChild)}this.hasLogo=false};l.destroy=function(){a.removeElement(this.container.querySelector(".modebar"))};function u(e,t){var r=e._fullLayout;var i=new s({graphInfo:e,container:r._paperdiv.node(),buttons:t});if(r._privateplot){n.select(i.element).append("span").classed("badge-private float--left",true).text("PRIVATE")}return i}t.exports=u},{"../../../build/ploticon":2,"../../lib":483,d3:81,"fast-isnumeric":91}],427:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var i=e("../color/attributes");var a=e("../../plot_api/plot_template").templatedArray;var o=a("button",{visible:{valType:"boolean",dflt:true,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});t.exports={visible:{valType:"boolean",editType:"plot"},buttons:o,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:n({editType:"plot"}),bgcolor:{valType:"color",dflt:i.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:i.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":519,"../../plots/font_attributes":555,"../color/attributes":360}],428:[function(e,t,r){"use strict";t.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],429:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../color");var a=e("../../plot_api/plot_template");var o=e("../../plots/array_container_defaults");var s=e("./attributes");var l=e("./constants");t.exports=function e(t,r,c,h,v){var d=t.rangeselector||{};var p=a.newContainer(r,"rangeselector");function g(e,t){return n.coerce(d,p,s,e,t)}var m=o(d,p,{name:"buttons",handleItemDefaults:u,calendar:v});var y=g("visible",m.length>0);if(y){var b=f(r,c,h);g("x",b[0]);g("y",b[1]);n.noneOrAll(t,r,["x","y"]);g("xanchor");g("yanchor");n.coerceFont(g,"font",c.font);var x=g("bgcolor");g("activecolor",i.contrast(x,l.lightAmount,l.darkAmount));g("bordercolor");g("borderwidth")}};function u(e,t,r,i){var a=i.calendar;function o(r,i){return n.coerce(e,t,s.buttons,r,i)}var l=o("visible");if(l){var u=o("step");if(u!=="all"){if(a&&a!=="gregorian"&&(u==="month"||u==="year")){t.stepmode="backward"}else{o("stepmode")}o("count")}o("label")}}function f(e,t,r){var n=r.filter(function(r){return t[r].anchor===e._id});var i=0;for(var a=0;a<n.length;a++){var o=t[n[a]].domain;if(o)i=Math.max(o[1],i)}return[e.domain[0],i+l.yPad]}},{"../../lib":483,"../../plot_api/plot_template":519,"../../plots/array_container_defaults":525,"../color":361,"./attributes":427,"./constants":428}],430:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../plots/plots");var o=e("../color");var s=e("../drawing");var l=e("../../lib");var u=e("../../lib/svg_text_utils");var f=e("../../plots/cartesian/axis_ids");var c=e("../legend/anchor_utils");var h=e("../../constants/alignment");var v=h.LINE_SPACING;var d=h.FROM_TL;var p=h.FROM_BR;var g=e("./constants");var m=e("./get_update_object");t.exports=function e(t){var r=t._fullLayout;var a=r._infolayer.selectAll(".rangeselector").data(y(t),b);a.enter().append("g").classed("rangeselector",true);a.exit().remove();a.style({cursor:"pointer","pointer-events":"all"});a.each(function(e){var r=n.select(this),a=e,o=a.rangeselector;var s=r.selectAll("g.button").data(l.filterVisible(o.buttons));s.enter().append("g").classed("button",true);s.exit().remove();s.each(function(e){var r=n.select(this);var s=m(a,e);e._isActive=x(a,e,s);r.call(_,o,e);r.call(M,o,e,t);r.on("click",function(){if(t._dragged)return;i.call("relayout",t,s)});r.on("mouseover",function(){e._isHovered=true;r.call(_,o,e)});r.on("mouseout",function(){e._isHovered=false;r.call(_,o,e)})});T(t,s,o,a._name,r)})};function y(e){var t=f.list(e,"x",true);var r=[];for(var n=0;n<t.length;n++){var i=t[n];if(i.rangeselector&&i.rangeselector.visible){r.push(i)}}return r}function b(e){return e._id}function x(e,t,r){if(t.step==="all"){return e.autorange===true}else{var n=Object.keys(r);return e.range[0]===r[n[0]]&&e.range[1]===r[n[1]]}}function _(e,t,r){var n=l.ensureSingle(e,"rect","selector-rect",function(e){e.attr("shape-rendering","crispEdges")});n.attr({rx:g.rx,ry:g.ry});n.call(o.stroke,t.bordercolor).call(o.fill,w(t,r)).style("stroke-width",t.borderwidth+"px")}function w(e,t){return t._isActive||t._isHovered?e.activecolor:e.bgcolor}function M(e,t,r,n){function i(e){u.convertToTspans(e,n)}var a=l.ensureSingle(e,"text","selector-text",function(e){e.classed("user-select-none",true).attr("text-anchor","middle")});a.call(s.font,t.font).text(A(r)).call(i)}function A(e){if(e.label)return e.label;if(e.step==="all")return"all";return e.count+e.step.charAt(0)}function T(e,t,r,i,o){var l=0;var f=0;var h=r.borderwidth;t.each(function(){var e=n.select(this);var t=e.select(".selector-text");var i=r.font.size*v;var a=Math.max(i*u.lineCount(t),16)+3;f=Math.max(f,a)});t.each(function(){var e=n.select(this);var t=e.select(".selector-rect");var i=e.select(".selector-text");var a=i.node()&&s.bBox(i.node()).width;var o=r.font.size*v;var c=u.lineCount(i);var d=Math.max(a+10,g.minButtonWidth);e.attr("transform","translate("+(h+l)+","+h+")");t.attr({x:0,y:0,width:d,height:f});u.positionText(i,d/2,f/2-(c-1)*o/2+3);l+=d+5});var m=e._fullLayout._size;var y=m.l+m.w*r.x;var b=m.t+m.h*(1-r.y);var x="left";if(c.isRightAnchor(r)){y-=l;x="right"}if(c.isCenterAnchor(r)){y-=l/2;x="center"}var _="top";if(c.isBottomAnchor(r)){b-=f;_="bottom"}if(c.isMiddleAnchor(r)){b-=f/2;_="middle"}l=Math.ceil(l);f=Math.ceil(f);y=Math.round(y);b=Math.round(b);a.autoMargin(e,i+"-range-selector",{x:r.x,y:r.y,l:l*d[x],r:l*p[x],b:f*p[_],t:f*d[_]});o.attr("transform","translate("+y+","+b+")")}},{"../../constants/alignment":459,"../../lib":483,"../../lib/svg_text_utils":506,"../../plots/cartesian/axis_ids":532,"../../plots/plots":573,"../../registry":582,"../color":361,"../drawing":386,"../legend/anchor_utils":413,"./constants":428,"./get_update_object":431,d3:81}],431:[function(e,t,r){"use strict";var n=e("d3");t.exports=function e(t,r){var n=t._name;var a={};if(r.step==="all"){a[n+".autorange"]=true}else{var o=i(t,r);a[n+".range[0]"]=o[0];a[n+".range[1]"]=o[1]}return a};function i(e,t){var r=e.range;var i=new Date(e.r2l(r[1]));var a=t.step,o=t.count;var s;switch(t.stepmode){case"backward":s=e.l2r(+n.time[a].utc.offset(i,-o));break;case"todate":var l=n.time[a].utc.offset(i,-o);s=e.l2r(+n.time[a].utc.ceil(l));break}var u=r[1];return[s,u]}},{d3:81}],432:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":427,"./defaults":429,"./draw":430}],433:[function(e,t,r){"use strict";var n=e("../color/attributes");t.exports={bgcolor:{valType:"color",dflt:n.background,editType:"plot"},bordercolor:{valType:"color",dflt:n.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:true,editType:"calc",impliedEdits:{"range[0]":undefined,"range[1]":undefined}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":false}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":false}}],editType:"calc",impliedEdits:{autorange:false}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:true,editType:"calc"},editType:"calc"}},{"../color/attributes":360}],434:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axis_ids").list;var i=e("../../plots/cartesian/autorange").getAutoRange;var a=e("./constants");t.exports=function e(t){var r=n(t,"x",true);for(var o=0;o<r.length;o++){var s=r[o],l=s[a.name];if(l&&l.visible&&l.autorange&&s._min.length&&s._max.length){l._input.autorange=true;l._input.range=l.range=i(s)}}}},{"../../plots/cartesian/autorange":528,"../../plots/cartesian/axis_ids":532,"./constants":435}],435:[function(e,t,r){"use strict";t.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],436:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plot_api/plot_template");var a=e("../../plots/cartesian/axis_ids");var o=e("./attributes");var s=e("./oppaxis_attributes");t.exports=function e(t,r,l){var u=t[l];var f=r[l];if(!(u.rangeslider||r._requestRangeslider[f._id]))return;if(!n.isPlainObject(u.rangeslider)){u.rangeslider={}}var c=u.rangeslider;var h=i.newContainer(f,"rangeslider");function v(e,t){return n.coerce(c,h,o,e,t)}var d,p;function g(e,t){return n.coerce(d,p,s,e,t)}var m=v("visible");if(!m)return;v("bgcolor",r.plot_bgcolor);v("bordercolor");v("borderwidth");v("thickness");f._rangesliderAutorange=v("autorange",!f.isValidRange(c.range));v("range");var y=r._subplots;if(y){var b=y.cartesian.filter(function(e){return e.substr(0,e.indexOf("y"))===a.name2id(l)}).map(function(e){return e.substr(e.indexOf("y"),e.length)});var x=n.simpleMap(b,a.id2name);for(var _=0;_<x.length;_++){var w=x[_];d=c[w]||{};p=i.newContainer(h,w,"yaxis");var M=r[w];var A;if(d.range&&M.isValidRange(d.range)){A="fixed"}var T=g("rangemode",A);if(T!=="match"){g("range",M.range.slice())}M._rangesliderAutorange=T==="auto"}}h._input=c}},{"../../lib":483,"../../plot_api/plot_template":519,"../../plots/cartesian/axis_ids":532,"./attributes":433,"./oppaxis_attributes":439}],437:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../plots/plots");var o=e("../../lib");var s=e("../drawing");var l=e("../color");var u=e("../titles");var f=e("../../plots/cartesian");var c=e("../../plots/cartesian/axes");var h=e("../dragelement");var v=e("../../lib/setcursor");var d=e("./constants");t.exports=function(e){var t=e._fullLayout,r=p(t);function i(e){return e._name}var o=t._infolayer.selectAll("g."+d.containerClassName).data(r,i);o.enter().append("g").classed(d.containerClassName,true).attr("pointer-events","all");o.exit().each(function(e){var r=e[d.name];t._topdefs.select("#"+r._clipId).remove()}).remove();if(r.length===0)return;o.each(function(r){var i=n.select(this),o=r[d.name],s=t[c.id2name(r.anchor)],l=o[c.id2name(r.anchor)];if(o.range){var f=o.range;var h=r.range;f[0]=r.l2r(Math.min(r.r2l(f[0]),r.r2l(h[0])));f[1]=r.l2r(Math.max(r.r2l(f[1]),r.r2l(h[1])));o._input.range=f.slice()}r.cleanRange("rangeslider.range");var v=t.margin;var p=t._size;var m=r.domain;var w=(r._boundingBox||{}).height||0;var k=Infinity;var E=c.getSubplots(e,r);for(var S=0;S<E.length;S++){var L=c.getFromId(e,E[S].substr(E[S].indexOf("y")));k=Math.min(k,L.domain[0])}o._id=d.name+r._id;o._clipId=o._id+"-"+t._uid;o._width=p.w*(m[1]-m[0]);o._height=(t.height-v.b-v.t)*o.thickness;o._offsetShift=Math.floor(o.borderwidth/2);var C=Math.round(v.l+p.w*m[0]);var I=Math.round(p.t+p.h*(1-k)+w+o._offsetShift+d.extraPad);i.attr("transform","translate("+C+","+I+")");var P=r.r2l(o.range[0]),O=r.r2l(o.range[1]),R=O-P;o.p2d=function(e){return e/o._width*R+P};o.d2p=function(e){return(e-P)/R*o._width};o._rl=[P,O];if(l.rangemode!=="match"){var N=s.r2l(l.range[0]),z=s.r2l(l.range[1]),D=z-N;o.d2pOppAxis=function(e){return(e-N)/D*o._height}}i.call(b,e,r,o).call(x,e,r,o).call(_,e,r,o).call(M,e,r,o,l).call(A,e,r,o).call(T,e,r,o);g(i,e,r,o);y(i,e,r,o,s,l);if(r.side==="bottom"){u.draw(e,r._id+"title",{propContainer:r,propName:r._name+".title",placeholder:t._dfltTitle.x,attributes:{x:r._offset+r._length/2,y:I+o._height+o._offsetShift+10+1.5*r.titlefont.size,"text-anchor":"middle"}})}a.autoMargin(e,o._id,{x:m[0],y:k,l:0,r:0,t:0,b:o._height+v.b+w,pad:d.extraPad+o._offsetShift*2})})};function p(e){var t=c.list({_fullLayout:e},"x",true),r=d.name,n=[];if(e._has("gl2d"))return n;for(var i=0;i<t.length;i++){var a=t[i];if(a[r]&&a[r].visible)n.push(a)}return n}function g(e,t,r,i){var a=e.select("rect."+d.slideBoxClassName).node(),s=e.select("rect."+d.grabAreaMinClassName).node(),l=e.select("rect."+d.grabAreaMaxClassName).node();e.on("mousedown",function(){var u=n.event,f=u.target,c=u.clientX,d=c-e.node().getBoundingClientRect().left,p=i.d2p(r._rl[0]),g=i.d2p(r._rl[1]);var y=h.coverSlip();y.addEventListener("mousemove",b);y.addEventListener("mouseup",x);function b(o){var u=+o.clientX-c;var h,b,x;switch(f){case a:x="ew-resize";h=p+u;b=g+u;break;case s:x="col-resize";h=p+u;b=g;break;case l:x="col-resize";h=p;b=g+u;break;default:x="ew-resize";h=d;b=d+u;break}if(b<h){var _=b;b=h;h=_}i._pixelMin=h;i._pixelMax=b;v(n.select(y),x);m(e,t,r,i)}function x(){y.removeEventListener("mousemove",b);y.removeEventListener("mouseup",x);o.removeElement(y)}})}function m(e,t,r,n){function a(e){return r.l2r(o.constrain(e,n._rl[0],n._rl[1]))}var s=a(n.p2d(n._pixelMin)),l=a(n.p2d(n._pixelMax));window.requestAnimationFrame(function(){i.call("relayout",t,r._name+".range",[s,l])})}function y(e,t,r,n,i,a){var s=d.handleWidth/2;function l(e){return o.constrain(e,0,n._width)}function u(e){return o.constrain(e,0,n._height)}function f(e){return o.constrain(e,-s,n._width+s)}var c=l(n.d2p(r._rl[0])),h=l(n.d2p(r._rl[1]));e.select("rect."+d.slideBoxClassName).attr("x",c).attr("width",h-c);e.select("rect."+d.maskMinClassName).attr("width",c);e.select("rect."+d.maskMaxClassName).attr("x",h).attr("width",n._width-h);if(a.rangemode!=="match"){var v=n._height-u(n.d2pOppAxis(i._rl[1])),p=n._height-u(n.d2pOppAxis(i._rl[0]));e.select("rect."+d.maskMinOppAxisClassName).attr("x",c).attr("height",v).attr("width",h-c);e.select("rect."+d.maskMaxOppAxisClassName).attr("x",c).attr("y",p).attr("height",n._height-p).attr("width",h-c);e.select("rect."+d.slideBoxClassName).attr("y",v).attr("height",p-v)}var g=.5;var m=Math.round(f(c-s))-g,y=Math.round(f(h-s))+g;e.select("g."+d.grabberMinClassName).attr("transform","translate("+m+","+g+")");e.select("g."+d.grabberMaxClassName).attr("transform","translate("+y+","+g+")")}function b(e,t,r,n){var i=o.ensureSingle(e,"rect",d.bgClassName,function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})});var a=n.borderwidth%2===0?n.borderwidth:n.borderwidth-1;var l=-n._offsetShift;var u=s.crispRound(t,n.borderwidth);i.attr({width:n._width+a,height:n._height+a,transform:"translate("+l+","+l+")",fill:n.bgcolor,stroke:n.bordercolor,"stroke-width":u})}function x(e,t,r,n){var i=t._fullLayout;var a=o.ensureSingleById(i._topdefs,"clipPath",n._clipId,function(e){e.append("rect").attr({x:0,y:0})});a.select("rect").attr({width:n._width,height:n._height})}function _(e,t,r,i){var l=c.getSubplots(t,r),u=t.calcdata;var h=e.selectAll("g."+d.rangePlotClassName).data(l,o.identity);h.enter().append("g").attr("class",function(e){return d.rangePlotClassName+" "+e}).call(s.setClipUrl,i._clipId);h.order();h.exit().remove();var v;h.each(function(e,o){var s=n.select(this),l=o===0;var h=c.getFromId(t,e,"y"),d=h._name,p=i[d];var g={data:[],layout:{xaxis:{type:r.type,domain:[0,1],range:i.range.slice(),calendar:r.calendar},width:i._width,height:i._height,margin:{t:0,b:0,l:0,r:0}},_context:t._context};g.layout[d]={type:h.type,domain:[0,1],range:p.rangemode!=="match"?p.range.slice():h.range.slice(),calendar:h.calendar};a.supplyDefaults(g);var m=g._fullLayout.xaxis;var y=g._fullLayout[d];var b={id:e,plotgroup:s,xaxis:m,yaxis:y,isRangePlot:true};if(l)v=b;else{b.mainplot="xy";b.mainplotinfo=v}f.rangePlot(t,b,w(u,e))})}function w(e,t){var r=[];for(var n=0;n<e.length;n++){var i=e[n],a=i[0].trace;if(a.xaxis+a.yaxis===t){r.push(i)}}return r}function M(e,t,r,n,i){var a=o.ensureSingle(e,"rect",d.maskMinClassName,function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})});a.attr("height",n._height).call(l.fill,d.maskColor);var s=o.ensureSingle(e,"rect",d.maskMaxClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});s.attr("height",n._height).call(l.fill,d.maskColor);if(i.rangemode!=="match"){var u=o.ensureSingle(e,"rect",d.maskMinOppAxisClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});u.attr("width",n._width).call(l.fill,d.maskOppAxisColor);var f=o.ensureSingle(e,"rect",d.maskMaxOppAxisClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});f.attr("width",n._width).style("border-top",d.maskOppBorder).call(l.fill,d.maskOppAxisColor)}}function A(e,t,r,n){if(t._context.staticPlot)return;var i=o.ensureSingle(e,"rect",d.slideBoxClassName,function(e){e.attr({y:0,cursor:d.slideBoxCursor,"shape-rendering":"crispEdges"})});i.attr({height:n._height,fill:d.slideBoxFill})}function T(e,t,r,n){var i=o.ensureSingle(e,"g",d.grabberMinClassName);var a=o.ensureSingle(e,"g",d.grabberMaxClassName);var s={x:0,width:d.handleWidth,rx:d.handleRadius,fill:l.background,stroke:l.defaultLine,"stroke-width":d.handleStrokeWidth,"shape-rendering":"crispEdges"};var u={y:Math.round(n._height/4),height:Math.round(n._height/2)};var f=o.ensureSingle(i,"rect",d.handleMinClassName,function(e){e.attr(s)});f.attr(u);var c=o.ensureSingle(a,"rect",d.handleMaxClassName,function(e){e.attr(s)});c.attr(u);if(t._context.staticPlot)return;var h={width:d.grabAreaWidth,x:0,y:0,fill:d.grabAreaFill,cursor:d.grabAreaCursor};var v=o.ensureSingle(i,"rect",d.grabAreaMinClassName,function(e){e.attr(h)});v.attr("height",n._height);var p=o.ensureSingle(a,"rect",d.grabAreaMaxClassName,function(e){e.attr(h)});p.attr("height",n._height)}},{"../../lib":483,"../../lib/setcursor":502,"../../plots/cartesian":540,"../../plots/cartesian/axes":529,"../../plots/plots":573,"../../registry":582,"../color":361,"../dragelement":383,"../drawing":386,"../titles":452,"./constants":435,d3:81}],438:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./attributes");var a=e("./oppaxis_attributes");t.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:n.extendFlat({},i,{yaxis:a})}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),calcAutorange:e("./calc_autorange"),draw:e("./draw")}},{"../../lib":483,"./attributes":433,"./calc_autorange":434,"./defaults":436,"./draw":437,"./oppaxis_attributes":439}],439:[function(e,t,r){"use strict";t.exports={_isSubplotObj:true,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],440:[function(e,t,r){"use strict";var n=e("../annotations/attributes");var i=e("../../traces/scatter/attributes").line;var a=e("../drawing/attributes").dash;var o=e("../../lib/extend").extendFlat;var s=e("../../plot_api/plot_template").templatedArray;t.exports=s("shape",{visible:{valType:"boolean",dflt:true,editType:"calcIfAutorange+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calcIfAutorange+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:o({},n.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calcIfAutorange+arraydraw"},xanchor:{valType:"any",editType:"calcIfAutorange+arraydraw"},x0:{valType:"any",editType:"calcIfAutorange+arraydraw"},x1:{valType:"any",editType:"calcIfAutorange+arraydraw"},yref:o({},n.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calcIfAutorange+arraydraw"},yanchor:{valType:"any",editType:"calcIfAutorange+arraydraw"},y0:{valType:"any",editType:"calcIfAutorange+arraydraw"},y1:{valType:"any",editType:"calcIfAutorange+arraydraw"},path:{valType:"string",editType:"calcIfAutorange+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:o({},i.color,{editType:"arraydraw"}),width:o({},i.width,{editType:"calcIfAutorange+arraydraw"}),dash:o({},a,{editType:"arraydraw"}),editType:"calcIfAutorange+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},editType:"arraydraw"})},{"../../lib/extend":475,"../../plot_api/plot_template":519,"../../traces/scatter/attributes":604,"../annotations/attributes":346,"../drawing/attributes":385}],441:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");var a=e("./constants");var o=e("./helpers");t.exports=function e(t){var r=t._fullLayout,o=n.filterVisible(r.shapes);if(!o.length||!t._fullData.length)return;for(var u=0;u<o.length;u++){var c=o[u];var h,v;if(c.xref!=="paper"){var d=c.xsizemode==="pixel"?c.xanchor:c.x0,p=c.xsizemode==="pixel"?c.xanchor:c.x1;h=i.getFromId(t,c.xref);v=f(h,d,p,c.path,a.paramIsX);if(v)i.expand(h,v,s(c))}if(c.yref!=="paper"){var g=c.ysizemode==="pixel"?c.yanchor:c.y0,m=c.ysizemode==="pixel"?c.yanchor:c.y1;h=i.getFromId(t,c.yref);v=f(h,g,m,c.path,a.paramIsY);if(v)i.expand(h,v,l(c))}}};function s(e){return u(e.line.width,e.xsizemode,e.x0,e.x1,e.path,false)}function l(e){return u(e.line.width,e.ysizemode,e.y0,e.y1,e.path,true)}function u(e,t,r,i,s,l){var u=e/2,f=l;if(t==="pixel"){var c=s?o.extractPathCoords(s,l?a.paramIsY:a.paramIsX):[r,i];var h=n.aggNums(Math.max,null,c),v=n.aggNums(Math.min,null,c),d=v<0?Math.abs(v)+u:u,p=h>0?h+u:u;return{ppad:u,ppadplus:f?d:p,ppadminus:f?p:d}}else{return{ppad:u}}}function f(e,t,r,n,i){var s=e.type==="category"?e.r2c:e.d2c;if(t!==undefined)return[s(t),s(r)];if(!n)return;var l=Infinity,u=-Infinity,f=n.match(a.segmentRE),c,h,v,d,p;if(e.type==="date")s=o.decodeDate(s);for(c=0;c<f.length;c++){h=f[c];v=i[h.charAt(0)].drawn;if(v===undefined)continue;d=f[c].substr(1).match(a.paramRE);if(!d||d.length<v)continue;p=s(d[v]);if(p<l)l=p;if(p>u)u=p}if(u>=l)return[l,u]}},{"../../lib":483,"../../plots/cartesian/axes":529,"./constants":442,"./helpers":445}],442:[function(e,t,r){"use strict";t.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:true,drawn:0},L:{0:true,drawn:0},H:{0:true,drawn:0},V:{},Q:{0:true,2:true,drawn:2},C:{0:true,2:true,4:true,drawn:4},T:{0:true,drawn:0},S:{0:true,2:true,drawn:2},Z:{}},paramIsY:{M:{1:true,drawn:1},L:{1:true,drawn:1},H:{},V:{0:true,drawn:0},Q:{1:true,3:true,drawn:3},C:{1:true,3:true,5:true,drawn:5},T:{1:true,drawn:1},S:{1:true,3:true,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],443:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");var a=e("../../plots/array_container_defaults");var o=e("./attributes");var s=e("./helpers");t.exports=function e(t,r){a(t,r,{name:"shapes",handleItemDefaults:l})};function l(e,t,r){function a(r,i){return n.coerce(e,t,o,r,i)}var l=a("visible");if(!l)return;a("layer");a("opacity");a("fillcolor");a("line.color");a("line.width");a("line.dash");var u=e.path?"path":"rect",f=a("type",u),c=a("xsizemode"),h=a("ysizemode");var v=["x","y"];for(var d=0;d<2;d++){var p=v[d],g=p+"anchor",m=p==="x"?c:h,y={_fullLayout:r},b,x,_;var w=i.coerceRef(e,t,y,p,"","paper");if(w!=="paper"){b=i.getFromId(y,w);_=s.rangeToShapePosition(b);x=s.shapePositionToRange(b)}else{x=_=n.identity}if(f!=="path"){var M=.25,A=.75;var T=p+"0",k=p+"1",E=e[T],S=e[k];e[T]=x(e[T],true);e[k]=x(e[k],true);if(m==="pixel"){a(T,0);a(k,10)}else{i.coercePosition(t,y,a,w,T,M);i.coercePosition(t,y,a,w,k,A)}t[T]=_(t[T]);t[k]=_(t[k]);e[T]=E;e[k]=S}if(m==="pixel"){var L=e[g];e[g]=x(e[g],true);i.coercePosition(t,y,a,w,g,.25);t[g]=_(t[g]);e[g]=L}}if(f==="path"){a("path")}else{n.noneOrAll(e,t,["x0","x1","y0","y1"])}}},{"../../lib":483,"../../plots/array_container_defaults":525,"../../plots/cartesian/axes":529,"./attributes":440,"./helpers":445}],444:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");var a=e("../../plots/cartesian/axes");var o=e("../color");var s=e("../drawing");var l=e("../../plot_api/plot_template").arrayEditor;var u=e("../dragelement");var f=e("../../lib/setcursor");var c=e("./constants");var h=e("./helpers");t.exports={draw:v,drawOne:d};function v(e){var t=e._fullLayout;t._shapeUpperLayer.selectAll("path").remove();t._shapeLowerLayer.selectAll("path").remove();for(var r in t._plots){var n=t._plots[r].shapelayer;if(n)n.selectAll("path").remove()}for(var i=0;i<t.shapes.length;i++){if(t.shapes[i].visible){d(e,i)}}}function d(e,t){e._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+t+'"]').remove();var r=e._fullLayout.shapes[t]||{};if(!r._input||r.visible===false)return;if(r.layer!=="below"){a(e._fullLayout._shapeUpperLayer)}else if(r.xref==="paper"||r.yref==="paper"){a(e._fullLayout._shapeLowerLayer)}else{var n=e._fullLayout._plots[r.xref+r.yref];if(n){var i=n.mainplotinfo||n;a(i.shapelayer)}else{a(e._fullLayout._shapeLowerLayer)}}function a(n){var i={"data-index":t,"fill-rule":"evenodd",d:m(e,r)},a=r.line.width?r.line.color:"rgba(0,0,0,0)";var l=n.append("path").attr(i).style("opacity",r.opacity).call(o.stroke,a).call(o.fill,r.fillcolor).call(s.dashLine,r.line.dash,r.line.width);p(l,e,r);if(e._context.edits.shapePosition)g(e,l,r,t,n)}}function p(e,t,r){var n=(r.xref+r.yref).replace(/paper/g,"");e.call(s.setClipUrl,n?"clip"+t._fullLayout._uid+n:null)}function g(e,t,r,o,v){var d=10;var g=10;var y=r.xsizemode==="pixel";var x=r.ysizemode==="pixel";var _=r.type==="line";var w=r.type==="path";var M=l(e.layout,"shapes",r);var A=M.modifyItem;var T,k,E,S,L,C;var I,P,O,R,N,z,D,F;var j;var B=a.getFromId(e,r.xref),U=a.getFromId(e,r.yref),V=h.getDataToPixel(e,B),H=h.getDataToPixel(e,U,true),q=h.getPixelToData(e,B),G=h.getPixelToData(e,U,true);var W=Z();var X={element:W.node(),gd:e,prepFn:J,doneFn:$,clickFn:ee},Y;u.init(X);W.node().onmousemove=K;function Z(){return _?Q():t}function Q(){var e=10,n=Math.max(r.line.width,e);var i=v.append("g").attr("data-index",o);i.append("path").attr("d",t.attr("d")).style({cursor:"move","stroke-width":n,"stroke-opacity":"0"});var a={"fill-opacity":"0"};var s=n/2>e?n/2:e;i.append("circle").attr({"data-line-point":"start-point",cx:y?V(r.xanchor)+r.x0:V(r.x0),cy:x?H(r.yanchor)-r.y0:H(r.y0),r:s}).style(a).classed("cursor-grab",true);i.append("circle").attr({"data-line-point":"end-point",cx:y?V(r.xanchor)+r.x1:V(r.x1),cy:x?H(r.yanchor)-r.y1:H(r.y1),r:s}).style(a).classed("cursor-grab",true);return i}function K(e){if(_){if(e.target.tagName==="path"){Y="move"}else{Y=e.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point"}}else{var r=X.element.getBoundingClientRect();var n=r.right-r.left,i=r.bottom-r.top,a=e.clientX-r.left,o=e.clientY-r.top,s=!w&&n>d&&i>g&&!e.shiftKey?u.getCursor(a/n,1-o/i):"move";f(t,s);Y=s.split("-")[0]}}function J(n){if(y){L=V(r.xanchor)}if(x){C=H(r.yanchor)}if(r.type==="path"){j=r.path}else{T=y?r.x0:V(r.x0);k=x?r.y0:H(r.y0);E=y?r.x1:V(r.x1);S=x?r.y1:H(r.y1)}if(T<E){O=T;D="x0";R=E;F="x1"}else{O=E;D="x1";R=T;F="x0"}if(!x&&k<S||x&&k>S){I=k;N="y0";P=S;z="y1"}else{I=S;N="y1";P=k;z="y0"}K(n);ne(v,r);ae(t,r,e);X.moveFn=Y==="move"?te:re}function $(){f(t);ie(v);p(t,e,r);n.call("relayout",e,M.getUpdateObj())}function ee(){ie(v)}function te(n,i){if(r.type==="path"){var a=function(e){return e},o=a,s=a;if(y){A("xanchor",r.xanchor=q(L+n))}else{o=function e(t){return q(V(t)+n)};if(B&&B.type==="date")o=h.encodeDate(o)}if(x){A("yanchor",r.yanchor=G(C+i))}else{s=function e(t){return G(H(t)+i)};if(U&&U.type==="date")s=h.encodeDate(s)}A("path",r.path=b(j,o,s))}else{if(y){A("xanchor",r.xanchor=q(L+n))}else{A("x0",r.x0=q(T+n));A("x1",r.x1=q(E+n))}if(x){A("yanchor",r.yanchor=G(C+i))}else{A("y0",r.y0=G(k+i));A("y1",r.y1=G(S+i))}}t.attr("d",m(e,r));ne(v,r)}function re(n,i){if(w){var a=function(e){return e},o=a,s=a;if(y){A("xanchor",r.xanchor=q(L+n))}else{o=function e(t){return q(V(t)+n)};if(B&&B.type==="date")o=h.encodeDate(o)}if(x){A("yanchor",r.yanchor=G(C+i))}else{s=function e(t){return G(H(t)+i)};if(U&&U.type==="date")s=h.encodeDate(s)}A("path",r.path=b(j,o,s))}else if(_){if(Y==="resize-over-start-point"){var l=T+n;var u=x?k-i:k+i;A("x0",r.x0=y?l:q(l));A("y0",r.y0=x?u:G(u))}else if(Y==="resize-over-end-point"){var f=E+n;var c=x?S-i:S+i;A("x1",r.x1=y?f:q(f));A("y1",r.y1=x?c:G(c))}}else{var p=~Y.indexOf("n")?I+i:I,M=~Y.indexOf("s")?P+i:P,W=~Y.indexOf("w")?O+n:O,X=~Y.indexOf("e")?R+n:R;if(~Y.indexOf("n")&&x)p=I-i;if(~Y.indexOf("s")&&x)M=P-i;if(!x&&M-p>g||x&&p-M>g){A(N,r[N]=x?p:G(p));A(z,r[z]=x?M:G(M))}if(X-W>d){A(D,r[D]=y?W:q(W));A(F,r[F]=y?X:q(X))}}t.attr("d",m(e,r));ne(v,r)}function ne(e,t){if(y||x){r()}function r(){var r=t.type!=="path";var n=e.selectAll(".visual-cue").data([0]);var a=1;n.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":a}).classed("visual-cue",true);var o=V(y?t.xanchor:i.midRange(r?[t.x0,t.x1]:h.extractPathCoords(t.path,c.paramIsX)));var s=H(x?t.yanchor:i.midRange(r?[t.y0,t.y1]:h.extractPathCoords(t.path,c.paramIsY)));o=h.roundPositionForSharpStrokeRendering(o,a);s=h.roundPositionForSharpStrokeRendering(s,a);if(y&&x){var l="M"+(o-1-a)+","+(s-1-a)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";n.attr("d",l)}else if(y){var u="M"+(o-1-a)+","+(s-9-a)+"v18 h2 v-18 Z";n.attr("d",u)}else{var f="M"+(o-9-a)+","+(s-1-a)+"h18 v2 h-18 Z";n.attr("d",f)}}}function ie(e){e.selectAll(".visual-cue").remove()}function ae(e,t,r){var n=t.xref,i=t.yref,o=a.getFromId(r,n),l=a.getFromId(r,i);var u="";if(n!=="paper"&&!o.autorange)u+=n;if(i!=="paper"&&!l.autorange)u+=i;e.call(s.setClipUrl,u?"clip"+r._fullLayout._uid+u:null)}}function m(e,t){var r=t.type,n=a.getFromId(e,t.xref),i=a.getFromId(e,t.yref),o=e._fullLayout._size,s,l,u,f,c,v,d,p;if(n){s=h.shapePositionToRange(n);l=function(e){return n._offset+n.r2p(s(e,true))}}else{l=function(e){return o.l+o.w*e}}if(i){u=h.shapePositionToRange(i);f=function(e){return i._offset+i.r2p(u(e,true))}}else{f=function(e){return o.t+o.h*(1-e)}}if(r==="path"){if(n&&n.type==="date")l=h.decodeDate(l);if(i&&i.type==="date")f=h.decodeDate(f);return y(t,l,f)}if(t.xsizemode==="pixel"){var g=l(t.xanchor);c=g+t.x0;v=g+t.x1}else{c=l(t.x0);v=l(t.x1)}if(t.ysizemode==="pixel"){var m=f(t.yanchor);d=m-t.y0;p=m-t.y1}else{d=f(t.y0);p=f(t.y1)}if(r==="line")return"M"+c+","+d+"L"+v+","+p;if(r==="rect")return"M"+c+","+d+"H"+v+"V"+p+"H"+c+"Z";var b=(c+v)/2,x=(d+p)/2,_=Math.abs(b-c),w=Math.abs(x-d),M="A"+_+","+w,A=b+_+","+x,T=b+","+(x-w);return"M"+A+M+" 0 1,1 "+T+M+" 0 0,1 "+A+"Z"}function y(e,t,r){var n=e.path,a=e.xsizemode,o=e.ysizemode,s=e.xanchor,l=e.yanchor;return n.replace(c.segmentRE,function(e){var n=0,u=e.charAt(0),f=c.paramIsX[u],h=c.paramIsY[u],v=c.numParams[u];var d=e.substr(1).replace(c.paramRE,function(e){if(f[n]){if(a==="pixel")e=t(s)+Number(e);else e=t(e)}else if(h[n]){if(o==="pixel")e=r(l)-Number(e);else e=r(e)}n++;if(n>v)e="X";return e});if(n>v){d=d.replace(/[\s,]*X.*/,"");i.log("Ignoring extra params in segment "+e)}return u+d})}function b(e,t,r){return e.replace(c.segmentRE,function(e){var n=0,i=e.charAt(0),a=c.paramIsX[i],o=c.paramIsY[i],s=c.numParams[i];var l=e.substr(1).replace(c.paramRE,function(e){if(n>=s)return e;if(a[n])e=t(e);else if(o[n])e=r(e);n++;return e});return i+l})}},{"../../lib":483,"../../lib/setcursor":502,"../../plot_api/plot_template":519,"../../plots/cartesian/axes":529,"../../registry":582,"../color":361,"../dragelement":383,"../drawing":386,"./constants":442,"./helpers":445}],445:[function(e,t,r){"use strict";var n=e("./constants");var i=e("../../lib");r.rangeToShapePosition=function(e){return e.type==="log"?e.r2d:function(e){return e}};r.shapePositionToRange=function(e){return e.type==="log"?e.d2r:function(e){return e}};r.decodeDate=function(e){return function(t){if(t.replace)t=t.replace("_"," ");return e(t)}};r.encodeDate=function(e){return function(t){return e(t).replace(" ","_")}};r.extractPathCoords=function(e,t){var r=[];var a=e.match(n.segmentRE);a.forEach(function(e){var a=t[e.charAt(0)].drawn;if(a===undefined)return;var o=e.substr(1).match(n.paramRE);if(!o||o.length<a)return;r.push(i.cleanNumber(o[a]))});return r};r.getDataToPixel=function(e,t,n){var i=e._fullLayout._size,a;if(t){var o=r.shapePositionToRange(t);a=function(e){return t._offset+t.r2p(o(e,true))};if(t.type==="date")a=r.decodeDate(a)}else if(n){a=function(e){return i.t+i.h*(1-e)}}else{a=function(e){return i.l+i.w*e}}return a};r.getPixelToData=function(e,t,n){var i=e._fullLayout._size,a;if(t){var o=r.rangeToShapePosition(t);a=function(e){return o(t.p2r(e-t._offset))}}else if(n){a=function(e){return 1-(e-i.t)/i.h}}else{a=function(e){return(e-i.l)/i.w}}return a};r.roundPositionForSharpStrokeRendering=function(e,t){var r=Math.round(t%2)===1;var n=Math.round(e);return r?n+.5:n}},{"../../lib":483,"./constants":442}],446:[function(e,t,r){"use strict";var n=e("./draw");t.exports={moduleType:"component",name:"shapes",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("shapes"),calcAutorange:e("./calc_autorange"),draw:n.draw,drawOne:n.drawOne}},{"../../plots/cartesian/include_components":539,"./attributes":440,"./calc_autorange":441,"./defaults":443,"./draw":444}],447:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var i=e("../../plots/pad_attributes");var a=e("../../lib/extend").extendDeepAll;var o=e("../../plot_api/edit_types").overrideAll;var s=e("../../plots/animation_attributes");var l=e("../../plot_api/plot_template").templatedArray;var u=e("./constants");var f=l("step",{visible:{valType:"boolean",dflt:true},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:true,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:true}});t.exports=o(l("slider",{visible:{valType:"boolean",dflt:true},active:{valType:"number",min:0,dflt:0},steps:f,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:a({},i,{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:s.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:true},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:n({})},font:n({}),activebgcolor:{valType:"color",dflt:u.gripBgActiveColor},bgcolor:{valType:"color",dflt:u.railBgColor},bordercolor:{valType:"color",dflt:u.railBorderColor},borderwidth:{valType:"number",min:0,dflt:u.railBorderWidth},ticklen:{valType:"number",min:0,dflt:u.tickLength},tickcolor:{valType:"color",dflt:u.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:u.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":475,"../../plot_api/edit_types":512,"../../plot_api/plot_template":519,"../../plots/animation_attributes":524,"../../plots/font_attributes":555,"../../plots/pad_attributes":572,"./constants":448}],448:[function(e,t,r){"use strict";t.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],449:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/array_container_defaults");var a=e("./attributes");var o=e("./constants");var s=o.name;var l=a.steps;t.exports=function e(t,r){i(t,r,{name:s,handleItemDefaults:u})};function u(e,t,r){function o(r,i){return n.coerce(e,t,a,r,i)}var s=i(e,t,{name:"steps",handleItemDefaults:f});var l=0;for(var u=0;u<s.length;u++){if(s[u].visible)l++}var c;if(l<2)c=t.visible=false;else c=o("visible");if(!c)return;t._stepCount=l;var h=t._visibleSteps=n.filterVisible(s);var v=o("active");if(!(s[v]||{}).visible)t.active=h[0]._index;o("x");o("y");n.noneOrAll(e,t,["x","y"]);o("xanchor");o("yanchor");o("len");o("lenmode");o("pad.t");o("pad.r");o("pad.b");o("pad.l");n.coerceFont(o,"font",r.font);var d=o("currentvalue.visible");if(d){o("currentvalue.xanchor");o("currentvalue.prefix");o("currentvalue.suffix");o("currentvalue.offset");n.coerceFont(o,"currentvalue.font",t.font)}o("transition.duration");o("transition.easing");o("bgcolor");o("activebgcolor");o("bordercolor");o("borderwidth");o("ticklen");o("tickwidth");o("tickcolor");o("minorticklen")}function f(e,t){function r(r,i){return n.coerce(e,t,l,r,i)}var i;if(e.method!=="skip"&&!Array.isArray(e.args)){i=t.visible=false}else i=r("visible");if(i){r("method");r("args");var a=r("label","step-"+t._index);r("value",a);r("execute")}}},{"../../lib":483,"../../plots/array_container_defaults":525,"./attributes":447,"./constants":448}],450:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../plots/plots");var a=e("../color");var o=e("../drawing");var s=e("../../lib");var l=e("../../lib/svg_text_utils");var u=e("../legend/anchor_utils");var f=e("../../plot_api/plot_template").arrayEditor;var c=e("./constants");var h=e("../../constants/alignment");var v=h.LINE_SPACING;var d=h.FROM_TL;var p=h.FROM_BR;t.exports=function e(t){var r=t._fullLayout,a=m(r,t);var o=r._infolayer.selectAll("g."+c.containerClassName).data(a.length>0?[0]:[]);o.enter().append("g").classed(c.containerClassName,true).style("cursor","ew-resize");function s(e){if(e._commandObserver){e._commandObserver.remove();delete e._commandObserver}i.autoMargin(t,g(e))}o.exit().each(function(){n.select(this).selectAll("g."+c.groupClassName).each(s)}).remove();if(a.length===0)return;var l=o.selectAll("g."+c.groupClassName).data(a,y);l.enter().append("g").classed(c.groupClassName,true);l.exit().each(s).remove();for(var u=0;u<a.length;u++){var f=a[u];b(t,f)}l.each(function(e){var r=n.select(this);L(e);i.manageCommandObserver(t,e,e._visibleSteps,function(e){var n=r.data()[0];if(n.active===e.index)return;if(n._dragging)return;k(t,r,n,e.index,false,true)});x(t,n.select(this),e)})};function g(e){return c.autoMarginIdRoot+e._index}function m(e,t){var r=e[c.name],n=[];for(var i=0;i<r.length;i++){var a=r[i];if(!a.visible)continue;a._gd=t;n.push(a)}return n}function y(e){return e._index}function b(e,t){var r=o.tester.selectAll("g."+c.labelGroupClass).data(t._visibleSteps);r.enter().append("g").classed(c.labelGroupClass,true);var a=0;var s=0;r.each(function(e){var r=n.select(this);var i=M(r,{step:e},t);var l=i.node();if(l){var u=o.bBox(l);s=Math.max(s,u.height);a=Math.max(a,u.width)}});r.remove();var f=t._dims={};f.inputAreaWidth=Math.max(c.railWidth,c.gripHeight);var h=e._fullLayout._size;f.lx=h.l+h.w*t.x;f.ly=h.t+h.h*(1-t.y);if(t.lenmode==="fraction"){f.outerLength=Math.round(h.w*t.len)}else{f.outerLength=t.len}f.inputAreaStart=0;f.inputAreaLength=Math.round(f.outerLength-t.pad.l-t.pad.r);var v=f.inputAreaLength-2*c.stepInset;var m=v/(t._stepCount-1);var y=a+c.labelPadding;f.labelStride=Math.max(1,Math.ceil(y/m));f.labelHeight=s;f.currentValueMaxWidth=0;f.currentValueHeight=0;f.currentValueTotalHeight=0;f.currentValueMaxLines=1;if(t.currentvalue.visible){var b=o.tester.append("g");r.each(function(e){var r=_(b,t,e.label);var n=r.node()&&o.bBox(r.node())||{width:0,height:0};var i=l.lineCount(r);f.currentValueMaxWidth=Math.max(f.currentValueMaxWidth,Math.ceil(n.width));f.currentValueHeight=Math.max(f.currentValueHeight,Math.ceil(n.height));f.currentValueMaxLines=Math.max(f.currentValueMaxLines,i)});f.currentValueTotalHeight=f.currentValueHeight+t.currentvalue.offset;b.remove()}f.height=f.currentValueTotalHeight+c.tickOffset+t.ticklen+c.labelOffset+f.labelHeight+t.pad.t+t.pad.b;var x="left";if(u.isRightAnchor(t)){f.lx-=f.outerLength;x="right"}if(u.isCenterAnchor(t)){f.lx-=f.outerLength/2;x="center"}var w="top";if(u.isBottomAnchor(t)){f.ly-=f.height;w="bottom"}if(u.isMiddleAnchor(t)){f.ly-=f.height/2;w="middle"}f.outerLength=Math.ceil(f.outerLength);f.height=Math.ceil(f.height);f.lx=Math.round(f.lx);f.ly=Math.round(f.ly);var A={y:t.y,b:f.height*p[w],t:f.height*d[w]};if(t.lenmode==="fraction"){A.l=0;A.xl=t.x-t.len*d[x];A.r=0;A.xr=t.x+t.len*p[x]}else{A.x=t.x;A.l=f.outerLength*d[x];A.r=f.outerLength*p[x]}i.autoMargin(e,g(t),A)}function x(e,t,r){if(!(r.steps[r.active]||{}).visible){r.active=r._visibleSteps[0]._index}t.call(_,r).call(R,r).call(A,r).call(S,r).call(O,e,r).call(w,e,r);var n=r._dims;o.setTranslate(t,n.lx+r.pad.l,n.ly+r.pad.t);t.call(C,r,false);t.call(_,r)}function _(e,t,r){if(!t.currentvalue.visible)return;var n=t._dims;var i,a;switch(t.currentvalue.xanchor){case"right":i=n.inputAreaLength-c.currentValueInset-n.currentValueMaxWidth;a="left";break;case"center":i=n.inputAreaLength*.5;a="middle";break;default:i=c.currentValueInset;a="left"}var u=s.ensureSingle(e,"text",c.labelClass,function(e){e.classed("user-select-none",true).attr({"text-anchor":a,"data-notex":1})});var f=t.currentvalue.prefix?t.currentvalue.prefix:"";if(typeof r==="string"){f+=r}else{var h=t.steps[t.active].label;f+=h}if(t.currentvalue.suffix){f+=t.currentvalue.suffix}u.call(o.font,t.currentvalue.font).text(f).call(l.convertToTspans,t._gd);var d=l.lineCount(u);var p=(n.currentValueMaxLines+1-d)*t.currentvalue.font.size*v;l.positionText(u,i,p);return u}function w(e,t,r){var n=s.ensureSingle(e,"rect",c.gripRectClass,function(n){n.call(E,t,e,r).style("pointer-events","all")});n.attr({width:c.gripWidth,height:c.gripHeight,rx:c.gripRadius,ry:c.gripRadius}).call(a.stroke,r.bordercolor).call(a.fill,r.bgcolor).style("stroke-width",r.borderwidth+"px")}function M(e,t,r){var n=s.ensureSingle(e,"text",c.labelClass,function(e){e.classed("user-select-none",true).attr({"text-anchor":"middle","data-notex":1})});n.call(o.font,r.font).text(t.step.label).call(l.convertToTspans,r._gd);return n}function A(e,t){var r=s.ensureSingle(e,"g",c.labelsClass);var i=t._dims;var a=r.selectAll("g."+c.labelGroupClass).data(i.labelSteps);a.enter().append("g").classed(c.labelGroupClass,true);a.exit().remove();a.each(function(e){var r=n.select(this);r.call(M,e,t);o.setTranslate(r,I(t,e.fraction),c.tickOffset+t.ticklen+t.font.size*v+c.labelOffset+i.currentValueTotalHeight)})}function T(e,t,r,n,i){var a=Math.round(n*(r._stepCount-1));var o=r._visibleSteps[a]._index;if(o!==r.active){k(e,t,r,o,true,i)}}function k(e,t,r,n,a,o){var s=r.active;r.active=n;f(e.layout,c.name,r).applyUpdate("active",n);var l=r.steps[r.active];t.call(C,r,o);t.call(_,r);e.emit("plotly_sliderchange",{slider:r,step:r.steps[r.active],interaction:a,previousActive:s});if(l&&l.method&&a){if(t._nextMethod){t._nextMethod.step=l;t._nextMethod.doCallback=a;t._nextMethod.doTransition=o}else{t._nextMethod={step:l,doCallback:a,doTransition:o};t._nextMethodRaf=window.requestAnimationFrame(function(){var r=t._nextMethod.step;if(!r.method)return;if(r.execute){i.executeAPICommand(e,r.method,r.args)}t._nextMethod=null;t._nextMethodRaf=null})}}}function E(e,t,r){var i=r.node();var o=n.select(t);function s(){return r.data()[0]}e.on("mousedown",function(){var e=s();t.emit("plotly_sliderstart",{slider:e});var l=r.select("."+c.gripRectClass);n.event.stopPropagation();n.event.preventDefault();l.call(a.fill,e.activebgcolor);var u=P(e,n.mouse(i)[0]);T(t,r,e,u,true);e._dragging=true;o.on("mousemove",function(){var e=s();var a=P(e,n.mouse(i)[0]);T(t,r,e,a,false)});o.on("mouseup",function(){var e=s();e._dragging=false;l.call(a.fill,e.bgcolor);o.on("mouseup",null);o.on("mousemove",null);t.emit("plotly_sliderend",{slider:e,step:e.steps[e.active]})})})}function S(e,t){var r=e.selectAll("rect."+c.tickRectClass).data(t._visibleSteps);var i=t._dims;r.enter().append("rect").classed(c.tickRectClass,true);r.exit().remove();r.attr({width:t.tickwidth+"px","shape-rendering":"crispEdges"});r.each(function(e,r){var s=r%i.labelStride===0;var l=n.select(this);l.attr({height:s?t.ticklen:t.minorticklen}).call(a.fill,s?t.tickcolor:t.tickcolor);o.setTranslate(l,I(t,r/(t._stepCount-1))-.5*t.tickwidth,(s?c.tickOffset:c.minorTickOffset)+i.currentValueTotalHeight)})}function L(e){var t=e._dims;t.labelSteps=[];var r=e._stepCount;for(var n=0;n<r;n+=t.labelStride){t.labelSteps.push({fraction:n/(r-1),step:e._visibleSteps[n]})}}function C(e,t,r){var n=e.select("rect."+c.gripRectClass);var i=0;for(var a=0;a<t._stepCount;a++){if(t._visibleSteps[a]._index===t.active){i=a;break}}var o=I(t,i/(t._stepCount-1));if(t._invokingCommand)return;var s=n;if(r&&t.transition.duration>0){s=s.transition().duration(t.transition.duration).ease(t.transition.easing)}s.attr("transform","translate("+(o-c.gripWidth*.5)+","+t._dims.currentValueTotalHeight+")")}function I(e,t){var r=e._dims;return r.inputAreaStart+c.stepInset+(r.inputAreaLength-2*c.stepInset)*Math.min(1,Math.max(0,t))}function P(e,t){var r=e._dims;return Math.min(1,Math.max(0,(t-c.stepInset-r.inputAreaStart)/(r.inputAreaLength-2*c.stepInset-2*r.inputAreaStart)))}function O(e,t,r){var n=r._dims;var i=s.ensureSingle(e,"rect",c.railTouchRectClass,function(n){n.call(E,t,e,r).style("pointer-events","all")});i.attr({width:n.inputAreaLength,height:Math.max(n.inputAreaWidth,c.tickOffset+r.ticklen+n.labelHeight)}).call(a.fill,r.bgcolor).attr("opacity",0);o.setTranslate(i,0,n.currentValueTotalHeight)}function R(e,t){var r=t._dims;var n=r.inputAreaLength-c.railInset*2;var i=s.ensureSingle(e,"rect",c.railRectClass);i.attr({width:n,height:c.railWidth,rx:c.railRadius,ry:c.railRadius,"shape-rendering":"crispEdges"}).call(a.stroke,t.bordercolor).call(a.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px");o.setTranslate(i,c.railInset,(r.inputAreaWidth-c.railWidth)*.5+r.currentValueTotalHeight)}},{"../../constants/alignment":459,"../../lib":483,"../../lib/svg_text_utils":506,"../../plot_api/plot_template":519,"../../plots/plots":573,"../color":361,"../drawing":386,"../legend/anchor_utils":413,"./constants":448,d3:81}],451:[function(e,t,r){"use strict";var n=e("./constants");t.exports={moduleType:"component",name:n.name,layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":447,"./constants":448,"./defaults":449,"./draw":450}],452:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../../plots/plots");var o=e("../../registry");var s=e("../../lib");var l=e("../drawing");var u=e("../color");var f=e("../../lib/svg_text_utils");var c=e("../../constants/interactions");t.exports={draw:v};var h=/ [XY][0-9]* /;function v(e,t,r){var v=r.propContainer;var d=r.propName;var p=r.placeholder;var g=r.traceIndex;var m=r.avoid||{};var y=r.attributes;var b=r.transform;var x=r.containerGroup;var _=e._fullLayout;var w=v.titlefont||{};var M=w.family;var A=w.size;var T=w.color;var k=1;var E=false;var S=(v.title||"").trim();var L;if(d==="title")L="titleText";else if(d.indexOf("axis")!==-1)L="axisTitleText";else if(d.indexOf("colorbar"!==-1))L="colorbarTitleText";var C=e._context.edits[L];if(S==="")k=0;else if(S.replace(h," % ")===p.replace(h," % ")){k=.2;E=true;if(!C)S=""}var I=S||C;if(!x){x=s.ensureSingle(_._infolayer,"g","g-"+t)}var P=x.selectAll("text").data(I?[0]:[]);P.enter().append("text");P.text(S).attr("class",t);P.exit().remove();if(!I)return x;function O(e){s.syncOrAsync([R,N],e)}function R(t){var r;if(b){r="";if(b.rotate){r+="rotate("+[b.rotate,y.x,y.y]+")"}if(b.offset){r+="translate(0, "+b.offset+")"}}else{r=null}t.attr("transform",r);t.style({"font-family":M,"font-size":n.round(A,2)+"px",fill:u.rgb(T),opacity:k*u.opacity(T),"font-weight":a.fontWeight}).attr(y).call(f.convertToTspans,e);return a.previousPromises(e)}function N(e){var t=n.select(e.node().parentNode);if(m&&m.selection&&m.side&&S){t.attr("transform",null);var r=0;var a={left:"right",right:"left",top:"bottom",bottom:"top"}[m.side];var o=["left","top"].indexOf(m.side)!==-1?-1:1;var u=i(m.pad)?m.pad:2;var f=l.bBox(t.node());var c={left:0,top:0,right:_.width,bottom:_.height};var h=m.maxShift||(c[m.side]-f[m.side])*(m.side==="left"||m.side==="top"?-1:1);if(h<0)r=h;else{var v=m.offsetLeft||0;var d=m.offsetTop||0;f.left-=v;f.right-=v;f.top-=d;f.bottom-=d;m.selection.each(function(){var e=l.bBox(this);if(s.bBoxIntersect(f,e,u)){r=Math.max(r,o*(e[m.side]-f[a])+u)}});r=Math.min(h,r)}if(r>0||h<0){var p={left:[-r,0],right:[r,0],top:[0,-r],bottom:[0,r]}[m.side];t.attr("transform","translate("+p+")")}}}P.call(O);function z(){k=0;E=true;P.text(p).on("mouseover.opacity",function(){n.select(this).transition().duration(c.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){n.select(this).transition().duration(c.HIDE_PLACEHOLDER).style("opacity",0)})}if(C){if(!S)z();else P.on(".opacity",null);P.call(f.makeEditable,{gd:e}).on("edit",function(t){if(g!==undefined){o.call("restyle",e,d,t,g)}else{o.call("relayout",e,d,t)}}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(O)}).on("input",function(e){this.text(e||" ").call(f.positionText,y.x,y.y)})}P.classed("js-placeholder",E);return x}},{"../../constants/interactions":462,"../../lib":483,"../../lib/svg_text_utils":506,"../../plots/plots":573,"../../registry":582,"../color":361,"../drawing":386,d3:81,"fast-isnumeric":91}],453:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var i=e("../color/attributes");var a=e("../../lib/extend").extendFlat;var o=e("../../plot_api/edit_types").overrideAll;var s=e("../../plots/pad_attributes");var l=e("../../plot_api/plot_template").templatedArray;var u=l("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:true,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:true}});t.exports=o(l("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:true},buttons:u,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:a({},s,{}),font:n({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:i.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":475,"../../plot_api/edit_types":512,"../../plot_api/plot_template":519,"../../plots/font_attributes":555,"../../plots/pad_attributes":572,"../color/attributes":360}],454:[function(e,t,r){"use strict";t.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25c4",right:"\u25ba",up:"\u25b2",down:"\u25bc"}}},{}],455:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/array_container_defaults");var a=e("./attributes");var o=e("./constants");var s=o.name;var l=a.buttons;t.exports=function e(t,r){var n={name:s,handleItemDefaults:u};i(t,r,n)};function u(e,t,r){function o(r,i){return n.coerce(e,t,a,r,i)}var s=i(e,t,{name:"buttons",handleItemDefaults:f});var l=o("visible",s.length>0);if(!l)return;o("active");o("direction");o("type");o("showactive");o("x");o("y");n.noneOrAll(e,t,["x","y"]);o("xanchor");o("yanchor");o("pad.t");o("pad.r");o("pad.b");o("pad.l");n.coerceFont(o,"font",r.font);o("bgcolor",r.paper_bgcolor);o("bordercolor");o("borderwidth")}function f(e,t){function r(r,i){return n.coerce(e,t,l,r,i)}var i=r("visible",e.method==="skip"||Array.isArray(e.args));if(i){r("method");r("args");r("label");r("execute")}}},{"../../lib":483,"../../plots/array_container_defaults":525,"./attributes":453,"./constants":454}],456:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../plots/plots");var a=e("../color");var o=e("../drawing");var s=e("../../lib");var l=e("../../lib/svg_text_utils");var u=e("../legend/anchor_utils");var f=e("../../plot_api/plot_template").arrayEditor;var c=e("../../constants/alignment").LINE_SPACING;var h=e("./constants");var v=e("./scrollbox");t.exports=function e(t){var r=t._fullLayout,a=s.filterVisible(r[h.name]);function o(e){i.autoMargin(t,L(e))}var l=r._menulayer.selectAll("g."+h.containerClassName).data(a.length>0?[0]:[]);l.enter().append("g").classed(h.containerClassName,true).style("cursor","pointer");l.exit().each(function(){n.select(this).selectAll("g."+h.headerGroupClassName).each(o)}).remove();if(a.length===0)return;var u=l.selectAll("g."+h.headerGroupClassName).data(a,d);u.enter().append("g").classed(h.headerGroupClassName,true);var f=s.ensureSingle(l,"g",h.dropdownButtonGroupClassName,function(e){e.style("pointer-events","all")});for(var c=0;c<a.length;c++){var p=a[c];S(t,p)}var x="updatemenus"+r._uid,_=new v(t,f,x);if(u.enter().size()){f.node().parentNode.appendChild(f.node());f.call(I)}u.exit().each(function(e){f.call(I);o(e)}).remove();u.each(function(e){var r=n.select(this);var a=e.type==="dropdown"?f:null;i.manageCommandObserver(t,e,e.buttons,function(n){m(t,e,e.buttons[n.index],r,a,_,n.index,true)});if(e.type==="dropdown"){y(t,r,f,_,e);if(g(f,e)){b(t,r,f,_,e)}}else{b(t,r,null,null,e)}})};function d(e){return e._index}function p(e){return+e.attr(h.menuIndexAttrName)===-1}function g(e,t){return+e.attr(h.menuIndexAttrName)===t._index}function m(e,t,r,n,i,a,o,s){t.active=o;f(e.layout,h.name,t).applyUpdate("active",o);if(t.type==="buttons"){b(e,n,null,null,t)}else if(t.type==="dropdown"){i.attr(h.menuIndexAttrName,"-1");y(e,n,i,a,t);if(!s){b(e,n,i,a,t)}}}function y(e,t,r,n,i){var a=s.ensureSingle(t,"g",h.headerClassName,function(e){e.style("pointer-events","all")});var l=i._dims;var u=i.active;var f=i.buttons[u]||h.blankHeaderOpts;var c={y:i.pad.t,yPad:0,x:i.pad.l,xPad:0,index:0};var v={width:l.headerWidth,height:l.headerHeight};a.call(w,i,f,e).call(C,i,c,v);var d=s.ensureSingle(t,"text",h.headerArrowClassName,function(e){e.classed("user-select-none",true).attr("text-anchor","end").call(o.font,i.font).text(h.arrowSymbol[i.direction])});d.attr({x:l.headerWidth-h.arrowOffsetX+i.pad.l,y:l.headerHeight/2+h.textOffsetY+i.pad.t});a.on("click",function(){r.call(I,String(g(r,i)?-1:i._index));b(e,t,r,n,i)});a.on("mouseover",function(){a.call(k)});a.on("mouseout",function(){a.call(E,i)});o.setTranslate(t,l.lx,l.ly)}function b(e,t,r,a,o){if(!r){r=t;r.attr("pointer-events","all")}var l=!p(r)||o.type==="buttons"?o.buttons:[];var u=o.type==="dropdown"?h.dropdownButtonClassName:h.buttonClassName;var f=r.selectAll("g."+u).data(s.filterVisible(l));var c=f.enter().append("g").classed(u,true);var v=f.exit();if(o.type==="dropdown"){c.attr("opacity","0").transition().attr("opacity","1");v.transition().attr("opacity","0").remove()}else{v.remove()}var d=0;var g=0;var y=o._dims;var b=["up","down"].indexOf(o.direction)!==-1;if(o.type==="dropdown"){if(b){g=y.headerHeight+h.gapButtonHeader}else{d=y.headerWidth+h.gapButtonHeader}}if(o.type==="dropdown"&&o.direction==="up"){g=-h.gapButtonHeader+h.gapButton-y.openHeight}if(o.type==="dropdown"&&o.direction==="left"){d=-h.gapButtonHeader+h.gapButton-y.openWidth}var M={x:y.lx+d+o.pad.l,y:y.ly+g+o.pad.t,yPad:h.gapButton,xPad:h.gapButton,index:0};var A={l:M.x+o.borderwidth,t:M.y+o.borderwidth};f.each(function(s,l){var u=n.select(this);u.call(w,o,s,e).call(C,o,M);u.on("click",function(){if(n.event.defaultPrevented)return;m(e,o,s,t,r,a,l);if(s.execute){i.executeAPICommand(e,s.method,s.args)}e.emit("plotly_buttonclicked",{menu:o,button:s,active:o.active})});u.on("mouseover",function(){u.call(k)});u.on("mouseout",function(){u.call(E,o);f.call(T,o)})});f.call(T,o);if(b){A.w=Math.max(y.openWidth,y.headerWidth);A.h=M.y-A.t}else{A.w=M.x-A.l;A.h=Math.max(y.openHeight,y.headerHeight)}A.direction=o.direction;if(a){if(f.size()){x(e,t,r,a,o,A)}else{_(a)}}}function x(e,t,r,n,i,a){var o=i.direction;var s=o==="up"||o==="down";var l=i._dims;var u=i.active,f,c,v;if(s){c=0;for(v=0;v<u;v++){c+=l.heights[v]+h.gapButton}}else{f=0;for(v=0;v<u;v++){f+=l.widths[v]+h.gapButton}}n.enable(a,f,c);if(n.hbar){n.hbar.attr("opacity","0").transition().attr("opacity","1")}if(n.vbar){n.vbar.attr("opacity","0").transition().attr("opacity","1")}}function _(e){var t=!!e.hbar,r=!!e.vbar;if(t){e.hbar.transition().attr("opacity","0").each("end",function(){t=false;if(!r)e.disable()})}if(r){e.vbar.transition().attr("opacity","0").each("end",function(){r=false;if(!t)e.disable()})}}function w(e,t,r,n){e.call(M,t).call(A,t,r,n)}function M(e,t){var r=s.ensureSingle(e,"rect",h.itemRectClassName,function(e){e.attr({rx:h.rx,ry:h.ry,"shape-rendering":"crispEdges"})});r.call(a.stroke,t.bordercolor).call(a.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px")}function A(e,t,r,n){var i=s.ensureSingle(e,"text",h.itemTextClassName,function(e){e.classed("user-select-none",true).attr({"text-anchor":"start","data-notex":1})});i.call(o.font,t.font).text(r.label).call(l.convertToTspans,n)}function T(e,t){var r=t.active;e.each(function(e,i){var o=n.select(this);if(i===r&&t.showactive){o.select("rect."+h.itemRectClassName).call(a.fill,h.activeColor)}})}function k(e){e.select("rect."+h.itemRectClassName).call(a.fill,h.hoverColor)}function E(e,t){e.select("rect."+h.itemRectClassName).call(a.fill,t.bgcolor)}function S(e,t){var r=t._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0};var a=o.tester.selectAll("g."+h.dropdownButtonClassName).data(s.filterVisible(t.buttons));a.enter().append("g").classed(h.dropdownButtonClassName,true);var f=["up","down"].indexOf(t.direction)!==-1;a.each(function(i,a){var s=n.select(this);s.call(w,t,i,e);var u=s.select("."+h.itemTextClassName);var v=u.node()&&o.bBox(u.node()).width;var d=Math.max(v+h.textPadX,h.minWidth);var p=t.font.size*c;var g=l.lineCount(u);var m=Math.max(p*g,h.minHeight)+h.textOffsetY;m=Math.ceil(m);d=Math.ceil(d);r.widths[a]=d;r.heights[a]=m;r.height1=Math.max(r.height1,m);r.width1=Math.max(r.width1,d);if(f){r.totalWidth=Math.max(r.totalWidth,d);r.openWidth=r.totalWidth;r.totalHeight+=m+h.gapButton;r.openHeight+=m+h.gapButton}else{r.totalWidth+=d+h.gapButton;r.openWidth+=d+h.gapButton;r.totalHeight=Math.max(r.totalHeight,m);r.openHeight=r.totalHeight}});if(f){r.totalHeight-=h.gapButton}else{r.totalWidth-=h.gapButton}r.headerWidth=r.width1+h.arrowPadX;r.headerHeight=r.height1;if(t.type==="dropdown"){if(f){r.width1+=h.arrowPadX;r.totalHeight=r.height1}else{r.totalWidth=r.width1}r.totalWidth+=h.arrowPadX}a.remove();var v=r.totalWidth+t.pad.l+t.pad.r;var d=r.totalHeight+t.pad.t+t.pad.b;var p=e._fullLayout._size;r.lx=p.l+p.w*t.x;r.ly=p.t+p.h*(1-t.y);var g="left";if(u.isRightAnchor(t)){r.lx-=v;g="right"}if(u.isCenterAnchor(t)){r.lx-=v/2;g="center"}var m="top";if(u.isBottomAnchor(t)){r.ly-=d;m="bottom"}if(u.isMiddleAnchor(t)){r.ly-=d/2;m="middle"}r.totalWidth=Math.ceil(r.totalWidth);r.totalHeight=Math.ceil(r.totalHeight);r.lx=Math.round(r.lx);r.ly=Math.round(r.ly);i.autoMargin(e,L(t),{x:t.x,y:t.y,l:v*({right:1,center:.5}[g]||0),r:v*({left:1,center:.5}[g]||0),b:d*({top:1,middle:.5}[m]||0),t:d*({bottom:1,middle:.5}[m]||0)})}function L(e){return h.autoMarginIdRoot+e._index}function C(e,t,r,n){n=n||{};var i=e.select("."+h.itemRectClassName);var a=e.select("."+h.itemTextClassName);var s=t.borderwidth;var u=r.index;var f=t._dims;o.setTranslate(e,s+r.x,s+r.y);var v=["up","down"].indexOf(t.direction)!==-1;var d=n.height||(v?f.heights[u]:f.height1);i.attr({x:0,y:0,width:n.width||(v?f.width1:f.widths[u]),height:d});var p=t.font.size*c;var g=l.lineCount(a);var m=(g-1)*p/2;l.positionText(a,h.textOffsetX,d/2-m+h.textOffsetY);if(v){r.y+=f.heights[u]+r.yPad}else{r.x+=f.widths[u]+r.xPad}r.index++}function I(e,t){e.attr(h.menuIndexAttrName,t||"-1").selectAll("g."+h.dropdownButtonClassName).remove()}},{"../../constants/alignment":459,"../../lib":483,"../../lib/svg_text_utils":506,"../../plot_api/plot_template":519,"../../plots/plots":573,"../color":361,"../drawing":386,"../legend/anchor_utils":413,"./constants":454,"./scrollbox":458,d3:81}],457:[function(e,t,r){arguments[4][451][0].apply(r,arguments)},{"./attributes":453,"./constants":454,"./defaults":455,"./draw":456,dup:451}],458:[function(e,t,r){"use strict";t.exports=s;var n=e("d3");var i=e("../color");var a=e("../drawing");var o=e("../../lib");function s(e,t,r){this.gd=e;this.container=t;this.id=r;this.position=null;this.translateX=null;this.translateY=null;this.hbar=null;this.vbar=null;this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]);this.bg.exit().on(".drag",null).on("wheel",null).remove();this.bg.enter().append("rect").classed("scrollbox-bg",true).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}s.barWidth=2;s.barLength=20;s.barRadius=2;s.barPad=1;s.barColor="#808BA4";s.prototype.enable=function e(t,r,o){var l=this.gd._fullLayout,u=l.width,f=l.height;this.position=t;var c=this.position.l,h=this.position.w,v=this.position.t,d=this.position.h,p=this.position.direction,g=p==="down",m=p==="left",y=p==="right",b=p==="up",x=h,_=d,w,M,A,T;if(!g&&!m&&!y&&!b){this.position.direction="down";g=true}var k=g||b;if(k){w=c;M=w+x;if(g){A=v;T=Math.min(A+_,f);_=T-A}else{T=v+_;A=Math.max(T-_,0);_=T-A}}else{A=v;T=A+_;if(m){M=c+x;w=Math.max(M-x,0);x=M-w}else{w=c;M=Math.min(w+x,u);x=M-w}}this._box={l:w,t:A,w:x,h:_};var E=h>x,S=s.barLength+2*s.barPad,L=s.barWidth+2*s.barPad,C=c,I=v+d;if(I+L>f)I=f-L;var P=this.container.selectAll("rect.scrollbar-horizontal").data(E?[0]:[]);P.exit().on(".drag",null).remove();P.enter().append("rect").classed("scrollbar-horizontal",true).call(i.fill,s.barColor);if(E){this.hbar=P.attr({rx:s.barRadius,ry:s.barRadius,x:C,y:I,width:S,height:L});this._hbarXMin=C+S/2;this._hbarTranslateMax=x-S}else{delete this.hbar;delete this._hbarXMin;delete this._hbarTranslateMax}var O=d>_,R=s.barWidth+2*s.barPad,N=s.barLength+2*s.barPad,z=c+h,D=v;if(z+R>u)z=u-R;var F=this.container.selectAll("rect.scrollbar-vertical").data(O?[0]:[]);F.exit().on(".drag",null).remove();F.enter().append("rect").classed("scrollbar-vertical",true).call(i.fill,s.barColor);if(O){this.vbar=F.attr({rx:s.barRadius,ry:s.barRadius,x:z,y:D,width:R,height:N});this._vbarYMin=D+N/2;this._vbarTranslateMax=_-N}else{delete this.vbar;delete this._vbarYMin;delete this._vbarTranslateMax}var j=this.id,B=w-.5,U=O?M+R+.5:M+.5,V=A-.5,H=E?T+L+.5:T+.5;var q=l._topdefs.selectAll("#"+j).data(E||O?[0]:[]);q.exit().remove();q.enter().append("clipPath").attr("id",j).append("rect");if(E||O){this._clipRect=q.select("rect").attr({x:Math.floor(B),y:Math.floor(V),width:Math.ceil(U)-Math.floor(B),height:Math.ceil(H)-Math.floor(V)});this.container.call(a.setClipUrl,j);this.bg.attr({x:c,y:v,width:h,height:d})}else{this.bg.attr({width:0,height:0});this.container.on("wheel",null).on(".drag",null).call(a.setClipUrl,null);delete this._clipRect}if(E||O){var G=n.behavior.drag().on("dragstart",function(){n.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(G);var W=n.behavior.drag().on("dragstart",function(){n.event.sourceEvent.preventDefault();n.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));if(E){this.hbar.on(".drag",null).call(W)}if(O){this.vbar.on(".drag",null).call(W)}}this.setTranslate(r,o)};s.prototype.disable=function e(){if(this.hbar||this.vbar){this.bg.attr({width:0,height:0});this.container.on("wheel",null).on(".drag",null).call(a.setClipUrl,null);delete this._clipRect}if(this.hbar){this.hbar.on(".drag",null);this.hbar.remove();delete this.hbar;delete this._hbarXMin;delete this._hbarTranslateMax}if(this.vbar){this.vbar.on(".drag",null);this.vbar.remove();delete this.vbar;delete this._vbarYMin;delete this._vbarTranslateMax}};s.prototype._onBoxDrag=function e(){var t=this.translateX,r=this.translateY;if(this.hbar){t-=n.event.dx}if(this.vbar){r-=n.event.dy}this.setTranslate(t,r)};s.prototype._onBoxWheel=function e(){var t=this.translateX,r=this.translateY;if(this.hbar){t+=n.event.deltaY}if(this.vbar){r+=n.event.deltaY}this.setTranslate(t,r)};s.prototype._onBarDrag=function e(){var t=this.translateX,r=this.translateY;if(this.hbar){var i=t+this._hbarXMin,a=i+this._hbarTranslateMax,s=o.constrain(n.event.x,i,a),l=(s-i)/(a-i);var u=this.position.w-this._box.w;t=l*u}if(this.vbar){var f=r+this._vbarYMin,c=f+this._vbarTranslateMax,h=o.constrain(n.event.y,f,c),v=(h-f)/(c-f);var d=this.position.h-this._box.h;r=v*d}this.setTranslate(t,r)};s.prototype.setTranslate=function e(t,r){var n=this.position.w-this._box.w,i=this.position.h-this._box.h;t=o.constrain(t||0,0,n);r=o.constrain(r||0,0,i);this.translateX=t;this.translateY=r;this.container.call(a.setTranslate,this._box.l-this.position.l-t,this._box.t-this.position.t-r);if(this._clipRect){this._clipRect.attr({x:Math.floor(this.position.l+t-.5),y:Math.floor(this.position.t+r-.5)})}if(this.hbar){var s=t/n;this.hbar.call(a.setTranslate,t+s*this._hbarTranslateMax,r)}if(this.vbar){var l=r/i;this.vbar.call(a.setTranslate,t,r+l*this._vbarTranslateMax)}}},{"../../lib":483,"../color":361,"../drawing":386,d3:81}],459:[function(e,t,r){"use strict";t.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],460:[function(e,t,r){"use strict";t.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],461:[function(e,t,r){"use strict";t.exports={circle:"\u25cf","circle-open":"\u25cb",square:"\u25a0","square-open":"\u25a1",diamond:"\u25c6","diamond-open":"\u25c7",cross:"+",x:"\u274c"}},{}],462:[function(e,t,r){"use strict";t.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DBLCLICKDELAY:300,DESELECTDIM:.2}},{}],463:[function(e,t,r){"use strict";t.exports={BADNUM:undefined,FP_SAFE:Number.MAX_VALUE/1e4,ONEAVGYEAR:315576e5,ONEAVGMONTH:26298e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:1-1e-6,MINUS_SIGN:"\u2212"}},{}],464:[function(e,t,r){"use strict";t.exports={entityToUnicode:{mu:"\u03bc","#956":"\u03bc",amp:"&","#28":"&",lt:"<","#60":"<",gt:">","#62":">",nbsp:"\xa0","#160":"\xa0",times:"\xd7","#215":"\xd7",plusmn:"\xb1","#177":"\xb1",deg:"\xb0","#176":"\xb0"}}},{}],465:[function(e,t,r){"use strict";r.xmlns="http://www.w3.org/2000/xmlns/";r.svg="http://www.w3.org/2000/svg";r.xlink="http://www.w3.org/1999/xlink";r.svgAttrs={xmlns:r.svg,"xmlns:xlink":r.xlink}},{}],466:[function(e,t,r){"use strict";r.version="1.39.1";e("es6-promise").polyfill();e("../build/plotcss");e("./fonts/mathjax_config");var n=e("./registry");var i=r.register=n.register;var a=e("./plot_api");var o=Object.keys(a);for(var s=0;s<o.length;s++){var l=o[s];r[l]=a[l];i({moduleType:"apiMethod",name:l,fn:a[l]})}i(e("./traces/scatter"));i([e("./components/fx"),e("./components/legend"),e("./components/annotations"),e("./components/annotations3d"),e("./components/shapes"),e("./components/images"),e("./components/updatemenus"),e("./components/sliders"),e("./components/rangeslider"),e("./components/rangeselector"),e("./components/grid"),e("./components/errorbars")]);i([e("./locale-en"),e("./locale-en-us")]);r.Icons=e("../build/ploticon");r.Plots=e("./plots/plots");r.Fx=e("./components/fx");r.Snapshot=e("./snapshot");r.PlotSchema=e("./plot_api/plot_schema");r.Queue=e("./lib/queue");r.d3=e("d3")},{"../build/plotcss":1,"../build/ploticon":2,"./components/annotations":354,"./components/annotations3d":359,"./components/errorbars":392,"./components/fx":403,"./components/grid":407,"./components/images":412,"./components/legend":421,"./components/rangeselector":432,"./components/rangeslider":438,"./components/shapes":446,"./components/sliders":451,"./components/updatemenus":457,"./fonts/mathjax_config":467,"./lib/queue":497,"./locale-en":510,"./locale-en-us":509,"./plot_api":514,"./plot_api/plot_schema":518,"./plots/plots":573,"./registry":582,"./snapshot":587,"./traces/scatter":615,d3:81,"es6-promise":88}],467:[function(e,t,r){"use strict";if(typeof MathJax!=="undefined"){r.MathJax=true;MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:true,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}});MathJax.Hub.Configured()}else{r.MathJax=false}},{}],468:[function(e,t,r){"use strict";var n=Math.PI;r.deg2rad=function(e){return e/180*n};r.rad2deg=function(e){return e/n*180};r.wrap360=function(e){var t=e%360;return t<0?t+360:t};r.wrap180=function(e){if(Math.abs(e)>180)e-=Math.round(e/360)*360;return e}},{}],469:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../constants/numerical").BADNUM;var a=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;t.exports=function e(t){if(typeof t==="string"){t=t.replace(a,"")}if(n(t))return Number(t);return i}},{"../constants/numerical":463,"fast-isnumeric":91}],470:[function(e,t,r){"use strict";t.exports=function e(t){var r=t._fullLayout;if(r._glcanvas&&r._glcanvas.size()){r._glcanvas.each(function(e){if(e.regl)e.regl.clear({color:true,depth:true})})}}},{}],471:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("tinycolor2");var a=e("../plots/attributes");var o=e("../components/colorscale/get_scale");var s=Object.keys(e("../components/colorscale/scales"));var l=e("./nested_property");var u=e("./regex").counter;var f=e("../constants/interactions").DESELECTDIM;var c=e("./angles").wrap180;var h=e("./is_array").isArrayOrTypedArray;r.valObjectMeta={data_array:{coerceFunction:function(e,t,r){if(h(e))t.set(e);else if(r!==undefined)t.set(r)}},enumerated:{coerceFunction:function(e,t,r,n){if(n.coerceNumber)e=+e;if(n.values.indexOf(e)===-1)t.set(r);else t.set(e)},validateFunction:function(e,t){if(t.coerceNumber)e=+e;var r=t.values;for(var n=0;n<r.length;n++){var i=String(r[n]);if(i.charAt(0)==="/"&&i.charAt(i.length-1)==="/"){var a=new RegExp(i.substr(1,i.length-2));if(a.test(e))return true}else if(e===r[n])return true}return false}},boolean:{coerceFunction:function(e,t,r){if(e===true||e===false)t.set(e);else t.set(r)}},number:{coerceFunction:function(e,t,r,i){if(!n(e)||i.min!==undefined&&e<i.min||i.max!==undefined&&e>i.max){t.set(r)}else t.set(+e)}},integer:{coerceFunction:function(e,t,r,i){if(e%1||!n(e)||i.min!==undefined&&e<i.min||i.max!==undefined&&e>i.max){t.set(r)}else t.set(+e)}},string:{coerceFunction:function(e,t,r,n){if(typeof e!=="string"){var i=typeof e==="number";if(n.strict===true||!i)t.set(r);else t.set(String(e))}else if(n.noBlank&&!e)t.set(r);else t.set(e)}},color:{coerceFunction:function(e,t,r){if(i(e).isValid())t.set(e);else t.set(r)}},colorlist:{coerceFunction:function(e,t,r){function n(e){return i(e).isValid()}if(!Array.isArray(e)||!e.length)t.set(r);else if(e.every(n))t.set(e);else t.set(r)}},colorscale:{coerceFunction:function(e,t,r){t.set(o(e,r))}},angle:{coerceFunction:function(e,t,r){if(e==="auto")t.set("auto");else if(!n(e))t.set(r);else t.set(c(+e))}},subplotid:{coerceFunction:function(e,t,r,n){var i=n.regex||u(r);if(typeof e==="string"&&i.test(e)){t.set(e);return}t.set(r)},validateFunction:function(e,t){var r=t.dflt;if(e===r)return true;if(typeof e!=="string")return false;if(u(r).test(e))return true;return false}},flaglist:{coerceFunction:function(e,t,r,n){if(typeof e!=="string"){t.set(r);return}if((n.extras||[]).indexOf(e)!==-1){t.set(e);return}var i=e.split("+"),a=0;while(a<i.length){var o=i[a];if(n.flags.indexOf(o)===-1||i.indexOf(o)<a){i.splice(a,1)}else a++}if(!i.length)t.set(r);else t.set(i.join("+"))}},any:{coerceFunction:function(e,t,r){if(e===undefined)t.set(r);else t.set(e)}},info_array:{coerceFunction:function(e,t,n,i){function a(e,t,n){var i;var a={set:function(e){i=e}};if(n===undefined)n=t.dflt;r.valObjectMeta[t.valType].coerceFunction(e,a,n,t);return i}var o=i.dimensions===2||i.dimensions==="1-2"&&Array.isArray(e)&&Array.isArray(e[0]);if(!Array.isArray(e)){t.set(n);return}var s=i.items;var l=[];var u=Array.isArray(s);var f=u&&o&&Array.isArray(s[0]);var c=o&&u&&!f;var h=u&&!c?s.length:e.length;var v,d,p,g,m,y;n=Array.isArray(n)?n:[];if(o){for(v=0;v<h;v++){l[v]=[];p=Array.isArray(e[v])?e[v]:[];if(c)m=s.length;else if(u)m=s[v].length;else m=p.length;for(d=0;d<m;d++){if(c)g=s[d];else if(u)g=s[v][d];else g=s;y=a(p[d],g,(n[v]||[])[d]);if(y!==undefined)l[v][d]=y}}}else{for(v=0;v<h;v++){y=a(e[v],u?s[v]:s,n[v]);if(y!==undefined)l[v]=y}}t.set(l)},validateFunction:function(e,t){if(!Array.isArray(e))return false;var r=t.items;var n=Array.isArray(r);var i=t.dimensions===2;if(!t.freeLength&&e.length!==r.length)return false;for(var a=0;a<e.length;a++){if(i){if(!Array.isArray(e[a])||!t.freeLength&&e[a].length!==r[a].length){return false}for(var o=0;o<e[a].length;o++){if(!v(e[a][o],n?r[a][o]:r)){return false}}}else if(!v(e[a],n?r[a]:r))return false}return true}}};r.coerce=function(e,t,n,i,a){var o=l(n,i).get();var s=l(e,i);var u=l(t,i);var f=s.get();var c=t._template;if(f===undefined&&c){f=l(c,i).get();c=0}if(a===undefined)a=o.dflt;if(o.arrayOk&&h(f)){u.set(f);return f}var d=r.valObjectMeta[o.valType].coerceFunction;d(f,u,a,o);var p=u.get();if(c&&p===a&&!v(f,o)){f=l(c,i).get();d(f,u,a,o);p=u.get()}return p};r.coerce2=function(e,t,n,i,a){var o=l(e,i),s=r.coerce(e,t,n,i,a),u=o.get();return u!==undefined&&u!==null?s:false};r.coerceFont=function(e,t,r){var n={};r=r||{};n.family=e(t+".family",r.family);n.size=e(t+".size",r.size);n.color=e(t+".color",r.color);return n};r.coerceHoverinfo=function(e,t,n){var i=t._module.attributes;var o=i.hoverinfo?i:a;var s=o.hoverinfo;var l;if(n._dataLength===1){var u=s.dflt==="all"?s.flags.slice():s.dflt.split("+");u.splice(u.indexOf("name"),1);l=u.join("+")}return r.coerce(e,t,o,"hoverinfo",l)};r.coerceSelectionMarkerOpacity=function(e,t){if(!e.marker)return;var r=e.marker.opacity;if(r===undefined)return;var n;var i;if(!h(r)&&!e.selected&&!e.unselected){n=r;i=f*r}t("selected.marker.opacity",n);t("unselected.marker.opacity",i)};function v(e,t){var n=r.valObjectMeta[t.valType];if(t.arrayOk&&h(e))return true;if(n.validateFunction){return n.validateFunction(e,t)}var i={},a=i,o={set:function(e){a=e}};n.coerceFunction(e,o,i,t);return a!==i}r.validate=v},{"../components/colorscale/get_scale":374,"../components/colorscale/scales":380,"../constants/interactions":462,"../plots/attributes":526,"./angles":468,"./is_array":484,"./nested_property":491,"./regex":498,"fast-isnumeric":91,tinycolor2:327}],472:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("./loggers");var o=e("./mod");var s=e("../constants/numerical");var l=s.BADNUM;var u=s.ONEDAY;var f=s.ONEHOUR;var c=s.ONEMIN;var h=s.ONESEC;var v=s.EPOCHJD;var d=e("../registry");var p=n.time.format.utc;var g=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m;var m=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m;var y=(new Date).getFullYear()-70;function b(e){return e&&d.componentsRegistry.calendars&&typeof e==="string"&&e!=="gregorian"}r.dateTick0=function(e,t){if(b(e)){return t?d.getComponentMethod("calendars","CANONICAL_SUNDAY")[e]:d.getComponentMethod("calendars","CANONICAL_TICK")[e]}else{return t?"2000-01-02":"2000-01-01"}};r.dfltRange=function(e){if(b(e)){return d.getComponentMethod("calendars","DFLTRANGE")[e]}else{return["2000-01-01","2001-01-01"]}};r.isJSDate=function(e){return typeof e==="object"&&e!==null&&typeof e.getTime==="function"};var x,_;r.dateTime2ms=function(e,t){if(r.isJSDate(e)){var n=e.getTimezoneOffset()*c;var i=(e.getUTCMinutes()-e.getMinutes())*c+(e.getUTCSeconds()-e.getSeconds())*h+(e.getUTCMilliseconds()-e.getMilliseconds());if(i){var a=3*c;n=n-a/2+o(i-n+a/2,a)}e=Number(e)-n;if(e>=x&&e<=_)return e;return l}if(typeof e!=="string"&&typeof e!=="number")return l;e=String(e);var s=b(t);var p=e.charAt(0);if(s&&(p==="G"||p==="g")){e=e.substr(1);t=""}var w=s&&t.substr(0,7)==="chinese";var M=e.match(w?m:g);if(!M)return l;var A=M[1],T=M[3]||"1",k=Number(M[5]||1),E=Number(M[7]||0),S=Number(M[9]||0),L=Number(M[11]||0);if(s){if(A.length===2)return l;A=Number(A);var C;try{var I=d.getComponentMethod("calendars","getCal")(t);if(w){var P=T.charAt(T.length-1)==="i";T=parseInt(T,10);C=I.newDate(A,I.toMonthIndex(A,T,P),k)}else{C=I.newDate(A,Number(T),k)}}catch(e){return l}if(!C)return l;return(C.toJD()-v)*u+E*f+S*c+L*h}if(A.length===2){A=(Number(A)+2e3-y)%100+y}else A=Number(A);T-=1;var O=new Date(Date.UTC(2e3,T,k,E,S));O.setUTCFullYear(A);if(O.getUTCMonth()!==T)return l;if(O.getUTCDate()!==k)return l;return O.getTime()+L*h};x=r.MIN_MS=r.dateTime2ms("-9999");_=r.MAX_MS=r.dateTime2ms("9999-12-31 23:59:59.9999");r.isDateTime=function(e,t){return r.dateTime2ms(e,t)!==l};function w(e,t){return String(e+Math.pow(10,t)).substr(1)}var M=90*u;var A=3*f;var T=5*c;r.ms2DateTime=function(e,t,r){if(typeof e!=="number"||!(e>=x&&e<=_))return l;if(!t)t=0;var n=Math.floor(o(e+.05,1)*10),i=Math.round(e-n/10),a,s,g,m,y,w;if(b(r)){var E=Math.floor(i/u)+v,S=Math.floor(o(e,u));try{a=d.getComponentMethod("calendars","getCal")(r).fromJD(E).formatDate("yyyy-mm-dd")}catch(e){a=p("G%Y-%m-%d")(new Date(i))}if(a.charAt(0)==="-"){while(a.length<11)a="-0"+a.substr(1)}else{while(a.length<10)a="0"+a}s=t<M?Math.floor(S/f):0;g=t<M?Math.floor(S%f/c):0;m=t<A?Math.floor(S%c/h):0;y=t<T?S%h*10+n:0}else{w=new Date(i);a=p("%Y-%m-%d")(w);s=t<M?w.getUTCHours():0;g=t<M?w.getUTCMinutes():0;m=t<A?w.getUTCSeconds():0;y=t<T?w.getUTCMilliseconds()*10+n:0}return k(a,s,g,m,y)};r.ms2DateTimeLocal=function(e){if(!(e>=x+u&&e<=_-u))return l;var t=Math.floor(o(e+.05,1)*10),r=new Date(Math.round(e-t/10)),i=n.time.format("%Y-%m-%d")(r),a=r.getHours(),s=r.getMinutes(),f=r.getSeconds(),c=r.getUTCMilliseconds()*10+t;return k(i,a,s,f,c)};function k(e,t,r,n,i){if(t||r||n||i){e+=" "+w(t,2)+":"+w(r,2);if(n||i){e+=":"+w(n,2);if(i){var a=4;while(i%10===0){a-=1;i/=10}e+="."+w(i,a)}}}return e}r.cleanDate=function(e,t,n){if(r.isJSDate(e)||typeof e==="number"){if(b(n)){a.error("JS Dates and milliseconds are incompatible with world calendars",e);return t}e=r.ms2DateTimeLocal(+e);if(!e&&t!==undefined)return t}else if(!r.isDateTime(e,n)){a.error("unrecognized date",e);return t}return e};var E=/%\d?f/g;function S(e,t,r,n){e=e.replace(E,function(e){var r=Math.min(+e.charAt(1)||6,6),n=(t/1e3%1+2).toFixed(r).substr(2).replace(/0+$/,"")||"0";return n});var i=new Date(Math.floor(t+.05));if(b(n)){try{e=d.getComponentMethod("calendars","worldCalFmt")(e,t,n)}catch(e){return"Invalid"}}return r(e)(i)}var L=[59,59.9,59.99,59.999,59.9999];function C(e,t){var r=o(e+.05,u);var n=w(Math.floor(r/f),2)+":"+w(o(Math.floor(r/c),60),2);if(t!=="M"){if(!i(t))t=0;var a=Math.min(o(e/h,60),L[t]);var s=(100+a).toFixed(t).substr(1);if(t>0){s=s.replace(/0+$/,"").replace(/[\.]$/,"")}n+=":"+s}return n}r.formatDate=function(e,t,r,n,i,a){i=b(i)&&i;if(!t){if(r==="y")t=a.year;else if(r==="m")t=a.month;else if(r==="d"){t=a.dayMonth+"\n"+a.year}else{return C(e,r)+"\n"+S(a.dayMonthYear,e,n,i)}}return S(t,e,n,i)};var I=3*u;r.incrementMonth=function(e,t,r){r=b(r)&&r;var n=o(e,u);e=Math.round(e-n);if(r){try{var i=Math.round(e/u)+v,s=d.getComponentMethod("calendars","getCal")(r),l=s.fromJD(i);if(t%12)s.add(l,t,"m");else s.add(l,t/12,"y");return(l.toJD()-v)*u+n}catch(t){a.error("invalid ms "+e+" in calendar "+r)}}var f=new Date(e+I);return f.setUTCMonth(f.getUTCMonth()+t)+n-I};r.findExactDates=function(e,t){var r=0,n=0,a=0,o=0,s,l;var f=b(t)&&d.getComponentMethod("calendars","getCal")(t);for(var c=0;c<e.length;c++){l=e[c];if(!i(l)){o++;continue}if(l%u)continue;if(f){try{s=f.fromJD(l/u+v);if(s.day()===1){if(s.month()===1)r++;else n++}else a++}catch(e){}}else{s=new Date(l);if(s.getUTCDate()===1){if(s.getUTCMonth()===0)r++;else n++}else a++}}n+=r;a+=n;var h=e.length-o;return{exactYears:r/h,exactMonths:n/h,exactDays:a/h}}},{"../constants/numerical":463,"../registry":582,"./loggers":488,"./mod":490,d3:81,"fast-isnumeric":91}],473:[function(e,t,r){"use strict";t.exports=function e(t,r){if(!Array.isArray(t))t=[];t.length=r;return t}},{}],474:[function(e,t,r){"use strict";var n=e("events").EventEmitter;var i={init:function(e){if(e._ev instanceof n)return e;var t=new n;var r=new n;e._ev=t;e._internalEv=r;e.on=t.on.bind(t);e.once=t.once.bind(t);e.removeListener=t.removeListener.bind(t);e.removeAllListeners=t.removeAllListeners.bind(t);e._internalOn=r.on.bind(r);e._internalOnce=r.once.bind(r);e._removeInternalListener=r.removeListener.bind(r);e._removeAllInternalListeners=r.removeAllListeners.bind(r);e.emit=function(n,i){if(typeof jQuery!=="undefined"){jQuery(e).trigger(n,i)}t.emit(n,i);r.emit(n,i)};return e},triggerHandler:function(e,t,r){var n;var i;if(typeof jQuery!=="undefined"){n=jQuery(e).triggerHandler(t,r)}var a=e._ev;if(!a)return n;var o=a._events[t];if(!o)return n;function s(e){if(e.listener){a.removeListener(t,e.listener);if(!e.fired){e.fired=true;return e.listener.apply(a,[r])}}else{return e.apply(a,[r])}}o=Array.isArray(o)?o:[o];var l;for(l=0;l<o.length-1;l++){s(o[l])}i=s(o[l]);return n!==undefined?n:i},purge:function(e){delete e._ev;delete e.on;delete e.once;delete e.removeListener;delete e.removeAllListeners;delete e.emit;delete e._ev;delete e._internalEv;delete e._internalOn;delete e._internalOnce;delete e._removeInternalListener;delete e._removeAllInternalListeners;return e}};t.exports=i},{events:89}],475:[function(e,t,r){"use strict";var n=e("./is_plain_object.js");var i=Array.isArray;function a(e,t){var r,n;for(r=0;r<e.length;r++){n=e[r];if(n!==null&&typeof n==="object"){return false}if(n!==void 0){t[r]=n}}return true}r.extendFlat=function(){return o(arguments,false,false,false)};r.extendDeep=function(){return o(arguments,true,false,false)};r.extendDeepAll=function(){return o(arguments,true,true,false)};r.extendDeepNoArrays=function(){return o(arguments,true,false,true)};function o(e,t,r,s){var l=e[0],u=e.length;var f,c,h,v,d,p,g;if(u===2&&i(l)&&i(e[1])&&l.length===0){g=a(e[1],l);if(g){return l}else{l.splice(0,l.length)}}for(var m=1;m<u;m++){f=e[m];for(c in f){h=l[c];v=f[c];if(s&&i(v)){l[c]=v}else if(t&&v&&(n(v)||(d=i(v)))){if(d){d=false;p=h&&i(h)?h:[]}else{p=h&&n(h)?h:{}}l[c]=o([p,v],t,r,s)}else if(typeof v!=="undefined"||r){l[c]=v}}}return l}},{"./is_plain_object.js":485}],476:[function(e,t,r){"use strict";t.exports=function e(t){var r={},n=[],i=0;for(var a=0;a<t.length;a++){var o=t[a];if(r[o]!==1){r[o]=1;n[i++]=o}}return n}},{}],477:[function(e,t,r){"use strict";t.exports=function e(t){var r=a(t)?i:n;var o=[];for(var s=0;s<t.length;s++){var l=t[s];if(r(l))o.push(l)}return o};function n(e){return e.visible===true}function i(e){return e[0].trace.visible===true}function a(e){return Array.isArray(e)&&Array.isArray(e[0])&&e[0][0]&&e[0][0].trace}},{}],478:[function(e,t,r){"use strict";var n=e("./mod");r.segmentsIntersect=i;function i(e,t,r,n,i,a,o,s){var l=r-e,u=i-e,f=o-i,c=n-t,h=a-t,v=s-a,d=l*v-f*c;if(d===0)return null;var p=(u*v-f*h)/d,g=(u*c-l*h)/d;if(g<0||g>1||p<0||p>1)return null;return{x:e+l*p,y:t+c*p}}r.segmentDistance=function e(t,r,n,o,s,l,u,f){if(i(t,r,n,o,s,l,u,f))return 0;var c=n-t;var h=o-r;var v=u-s;var d=f-l;var p=c*c+h*h;var g=v*v+d*d;var m=Math.min(a(c,h,p,s-t,l-r),a(c,h,p,u-t,f-r),a(v,d,g,t-s,r-l),a(v,d,g,n-s,o-l));return Math.sqrt(m)};function a(e,t,r,n,i){var a=n*e+i*t;if(a<0){return n*n+i*i}else if(a>r){var o=n-e;var s=i-t;return o*o+s*s}else{var l=n*t-i*e;return l*l/r}}var o,s,l;r.getTextLocation=function e(t,r,i,a){if(t!==s||a!==l){o={};s=t;l=a}if(o[i]){return o[i]}var u=t.getPointAtLength(n(i-a/2,r));var f=t.getPointAtLength(n(i+a/2,r));var c=Math.atan((f.y-u.y)/(f.x-u.x));var h=t.getPointAtLength(n(i,r));var v=(h.x*4+u.x+f.x)/6;var d=(h.y*4+u.y+f.y)/6;var p={x:v,y:d,theta:c};o[i]=p;return p};r.clearLocationCache=function(){s=null};r.getVisibleSegment=function e(t,r,n){var i=r.left;var a=r.right;var o=r.top;var s=r.bottom;var l=0;var u=t.getTotalLength();var f=u;var c,h;function v(e){var r=t.getPointAtLength(e);if(e===0)c=r;else if(e===u)h=r;var n=r.x<i?i-r.x:r.x>a?r.x-a:0;var l=r.y<o?o-r.y:r.y>s?r.y-s:0;return Math.sqrt(n*n+l*l)}var d=v(l);while(d){l+=d+n;if(l>f)return;d=v(l)}d=v(f);while(d){f-=d+n;if(l>f)return;d=v(f)}return{min:l,max:f,len:f-l,total:u,isClosed:l===0&&f===u&&Math.abs(c.x-h.x)<.1&&Math.abs(c.y-h.y)<.1}};r.findPointOnPath=function e(t,r,n,i){i=i||{};var a=i.pathLength||t.getTotalLength();var o=i.tolerance||.001;var s=i.iterationLimit||30;var l=t.getPointAtLength(0)[n]>t.getPointAtLength(a)[n]?-1:1;var u=0;var f=0;var c=a;var h;var v;var d;while(u<s){h=(f+c)/2;v=t.getPointAtLength(h);d=v[n]-r;if(Math.abs(d)<o){return v}else{if(l*d>0){c=h}else{f=h}u++}}return v}},{"./mod":490}],479:[function(e,t,r){"use strict";t.exports=function(e){var t;if(typeof e==="string"){t=document.getElementById(e);if(t===null){throw new Error("No DOM element with id '"+e+"' exists on the page.")}return t}else if(e===null||e===undefined){throw new Error("DOM element provided is null or undefined")}return e}},{}],480:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("tinycolor2");var a=e("color-normalize");var o=e("../components/colorscale");var s=e("../components/color/attributes").defaultLine;var l=e("./is_array").isArrayOrTypedArray;var u=a(s);var f=1;function c(e,t){var r=e;r[3]*=t;return r}function h(e){if(n(e))return u;var t=a(e);return t.length?t:u}function v(e){return n(e)?e:f}function d(e,t,r){var n=e.color;var i=l(n);var s=l(t);var d=[];var p,g,m,y,b;if(e.colorscale!==undefined){p=o.makeColorScaleFunc(o.extractScale(e.colorscale,e.cmin,e.cmax))}else{p=h}if(i){g=function(e,t){return e[t]===undefined?u:a(p(e[t]))}}else g=h;if(s){m=function(e,t){return e[t]===undefined?f:v(e[t])}}else m=v;if(i||s){for(var x=0;x<r;x++){y=g(n,x);b=m(t,x);d[x]=c(y,b)}}else d=c(a(n),t);return d}function p(e,t){if(t===undefined)t=1;return e.map(function(e){var r=e[0];var n=i(e[1]);var a=n.toRgb();return{index:r,rgb:[a.r,a.g,a.b,t]}})}t.exports={formatColor:d,parseColorScale:p}},{"../components/color/attributes":360,"../components/colorscale":376,"./is_array":484,"color-normalize":62,"fast-isnumeric":91,tinycolor2:327}],481:[function(e,t,r){"use strict";var n=e("superscript-text");var i=e("../constants/string_mappings");function a(e){var t=0;while((t=e.indexOf("<sup>",t))>=0){var r=e.indexOf("</sup>",t);if(r<t)break;e=e.slice(0,t)+n(e.slice(t+5,r))+e.slice(r+6)}return e}function o(e){return e.replace(/\<br\>/g,"\n")}function s(e){return e.replace(/\<.*\>/g,"")}function l(e){var t=i.entityToUnicode;var r=0;while((r=e.indexOf("&",r))>=0){var n=e.indexOf(";",r);if(n<r){r+=1;continue}var a=t[e.slice(r+1,n)];if(a){e=e.slice(0,r)+a+e.slice(n+1)}else{e=e.slice(0,r)+e.slice(n+1)}}return e}function u(e){return""+l(s(a(o(e))))}t.exports=u},{"../constants/string_mappings":464,"superscript-text":325}],482:[function(e,t,r){"use strict";t.exports=function e(t){return t}},{}],483:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../constants/numerical");var o=a.FP_SAFE;var s=a.BADNUM;var l=t.exports={};l.nestedProperty=e("./nested_property");l.keyedContainer=e("./keyed_container");l.relativeAttr=e("./relative_attr");l.isPlainObject=e("./is_plain_object");l.mod=e("./mod");l.toLogRange=e("./to_log_range");l.relinkPrivateKeys=e("./relink_private");l.ensureArray=e("./ensure_array");var u=e("./is_array");l.isTypedArray=u.isTypedArray;l.isArrayOrTypedArray=u.isArrayOrTypedArray;l.isArray1D=u.isArray1D;var f=e("./coerce");l.valObjectMeta=f.valObjectMeta;l.coerce=f.coerce;l.coerce2=f.coerce2;l.coerceFont=f.coerceFont;l.coerceHoverinfo=f.coerceHoverinfo;l.coerceSelectionMarkerOpacity=f.coerceSelectionMarkerOpacity;l.validate=f.validate;var c=e("./dates");l.dateTime2ms=c.dateTime2ms;l.isDateTime=c.isDateTime;l.ms2DateTime=c.ms2DateTime;l.ms2DateTimeLocal=c.ms2DateTimeLocal;l.cleanDate=c.cleanDate;l.isJSDate=c.isJSDate;l.formatDate=c.formatDate;l.incrementMonth=c.incrementMonth;l.dateTick0=c.dateTick0;l.dfltRange=c.dfltRange;l.findExactDates=c.findExactDates;l.MIN_MS=c.MIN_MS;l.MAX_MS=c.MAX_MS;var h=e("./search");l.findBin=h.findBin;l.sorterAsc=h.sorterAsc;l.sorterDes=h.sorterDes;l.distinctVals=h.distinctVals;l.roundUp=h.roundUp;var v=e("./stats");l.aggNums=v.aggNums;l.len=v.len;l.mean=v.mean;l.midRange=v.midRange;l.variance=v.variance;l.stdev=v.stdev;l.interp=v.interp;var d=e("./matrix");l.init2dArray=d.init2dArray;l.transposeRagged=d.transposeRagged;l.dot=d.dot;l.translationMatrix=d.translationMatrix;l.rotationMatrix=d.rotationMatrix;l.rotationXYMatrix=d.rotationXYMatrix;l.apply2DTransform=d.apply2DTransform;l.apply2DTransform2=d.apply2DTransform2;var p=e("./angles");l.deg2rad=p.deg2rad;l.rad2deg=p.rad2deg;l.wrap360=p.wrap360;l.wrap180=p.wrap180;var g=e("./geometry2d");l.segmentsIntersect=g.segmentsIntersect;l.segmentDistance=g.segmentDistance;l.getTextLocation=g.getTextLocation;l.clearLocationCache=g.clearLocationCache;l.getVisibleSegment=g.getVisibleSegment;l.findPointOnPath=g.findPointOnPath;var m=e("./extend");l.extendFlat=m.extendFlat;l.extendDeep=m.extendDeep;l.extendDeepAll=m.extendDeepAll;l.extendDeepNoArrays=m.extendDeepNoArrays;var y=e("./loggers");l.log=y.log;l.warn=y.warn;l.error=y.error;var b=e("./regex");l.counterRegex=b.counter;var x=e("./throttle");l.throttle=x.throttle;l.throttleDone=x.done;l.clearThrottle=x.clear;l.getGraphDiv=e("./get_graph_div");l._=e("./localize");l.notifier=e("./notifier");l.filterUnique=e("./filter_unique");l.filterVisible=e("./filter_visible");l.pushUnique=e("./push_unique");l.cleanNumber=e("./clean_number");l.ensureNumber=function e(t){if(!i(t))return s;t=Number(t);if(t<-o||t>o)return s;return i(t)?Number(t):s};l.isIndex=function(e,t){if(t!==undefined&&e>=t)return false;return i(e)&&e>=0&&e%1===0};l.noop=e("./noop");l.identity=e("./identity");l.swapAttrs=function(e,t,r,n){if(!r)r="x";if(!n)n="y";for(var i=0;i<t.length;i++){var a=t[i],o=l.nestedProperty(e,a.replace("?",r)),s=l.nestedProperty(e,a.replace("?",n)),u=o.get();o.set(s.get());s.set(u)}};l.raiseToTop=function e(t){t.parentNode.appendChild(t)};l.cancelTransition=function(e){return e.transition().duration(0)};l.constrain=function(e,t,r){if(t>r)return Math.max(r,Math.min(t,e));return Math.max(t,Math.min(r,e))};l.bBoxIntersect=function(e,t,r){r=r||0;return e.left<=t.right+r&&t.left<=e.right+r&&e.top<=t.bottom+r&&t.top<=e.bottom+r};l.simpleMap=function(e,t,r,n){var i=e.length,a=new Array(i);for(var o=0;o<i;o++)a[o]=t(e[o],r,n);return a};l.randstr=function e(t,r,n,i){if(!n)n=16;if(r===undefined)r=24;if(r<=0)return"0";var a=Math.log(Math.pow(2,r))/Math.log(n);var o="";var s,u,f;for(s=2;a===Infinity;s*=2){a=Math.log(Math.pow(2,r/s))/Math.log(n)*s}var c=a-Math.floor(a);for(s=0;s<Math.floor(a);s++){f=Math.floor(Math.random()*n).toString(n);o=f+o}if(c){u=Math.pow(n,c);f=Math.floor(Math.random()*u).toString(n);o=f+o}var h=parseInt(o,n);if(t&&t[o]||h!==Infinity&&h>=Math.pow(2,r)){if(i>10){l.warn("randstr failed uniqueness");return o}return e(t,r,n,(i||0)+1)}else return o};l.OptionControl=function(e,t){if(!e)e={};if(!t)t="opt";var r={};r.optionList=[];r._newoption=function(n){n[t]=e;r[n.name]=n;r.optionList.push(n)};r["_"+t]=e;return r};l.smooth=function(e,t){t=Math.round(t)||0;if(t<2)return e;var r=e.length,n=2*r,i=2*t-1,a=new Array(i),o=new Array(r),s,l,u,f;for(s=0;s<i;s++){a[s]=(1-Math.cos(Math.PI*(s+1)/t))/(2*t)}for(s=0;s<r;s++){f=0;for(l=0;l<i;l++){u=s+l+1-t;if(u<-r)u-=n*Math.round(u/n);else if(u>=n)u-=n*Math.floor(u/n);if(u<0)u=-1-u;else if(u>=r)u=n-1-u;f+=e[u]*a[l]}o[s]=f}return o};l.syncOrAsync=function(e,t,r){var n,i;function a(){return l.syncOrAsync(e,t,r)}while(e.length){i=e.splice(0,1)[0];n=i(t);if(n&&n.then){return n.then(a).then(undefined,l.promiseError)}}return r&&r(t)};l.stripTrailingSlash=function(e){if(e.substr(-1)==="/")return e.substr(0,e.length-1);return e};l.noneOrAll=function(e,t,r){if(!e)return;var n=false,i=true,a,o;for(a=0;a<r.length;a++){o=e[r[a]];if(o!==undefined&&o!==null)n=true;else i=false}if(n&&!i){for(a=0;a<r.length;a++){e[r[a]]=t[r[a]]}}};l.mergeArray=function(e,t,r){if(l.isArrayOrTypedArray(e)){var n=Math.min(e.length,t.length);for(var i=0;i<n;i++)t[i][r]=e[i]}};l.fillArray=function(e,t,r,n){n=n||l.identity;if(l.isArrayOrTypedArray(e)){for(var i=0;i<t.length;i++){t[i][r]=n(e[i])}}};l.castOption=function(e,t,r,n){n=n||l.identity;var i=l.nestedProperty(e,r).get();if(l.isArrayOrTypedArray(i)){if(Array.isArray(t)&&l.isArrayOrTypedArray(i[t[0]])){return n(i[t[0]][t[1]])}else{return n(i[t])}}else{return i}};l.extractOption=function(e,t,r,n){if(r in e)return e[r];var i=l.nestedProperty(t,n).get();if(!Array.isArray(i))return i};function _(e){var t={};for(var r in e){var n=e[r];for(var i=0;i<n.length;i++){t[n[i]]=+r}}return t}l.tagSelected=function(e,t,r){var n=t.selectedpoints;var i=t._indexToPoints;var a;if(i){a=_(i)}function o(t){return t!==undefined&&t<e.length}for(var s=0;s<n.length;s++){var u=n[s];if(l.isIndex(u)){var f=a?a[u]:u;var c=r?r[f]:f;if(o(c)){e[c].selected=1}}}};l.selIndices2selPoints=function(e){var t=e.selectedpoints;var r=e._indexToPoints;if(r){var n=_(r);var i=[];for(var a=0;a<t.length;a++){var o=t[a];if(l.isIndex(o)){var s=n[o];if(l.isIndex(s)){i.push(s)}}}return i}else{return t}};l.getTargetArray=function(e,t){var r=t.target;if(typeof r==="string"&&r){var n=l.nestedProperty(e,r).get();return Array.isArray(n)?n:false}else if(Array.isArray(r)){return r}return false};l.minExtend=function(e,t){var r={};if(typeof t!=="object")t={};var n=3,i=Object.keys(e),a,o,s;for(a=0;a<i.length;a++){o=i[a];s=e[o];if(o.charAt(0)==="_"||typeof s==="function")continue;else if(o==="module")r[o]=s;else if(Array.isArray(s))r[o]=s.slice(0,n);else if(s&&typeof s==="object")r[o]=l.minExtend(e[o],t[o]);else r[o]=s}i=Object.keys(t);for(a=0;a<i.length;a++){o=i[a];s=t[o];if(typeof s!=="object"||!(o in r)||typeof r[o]!=="object"){r[o]=s}}return r};l.titleCase=function(e){return e.charAt(0).toUpperCase()+e.substr(1)};l.containsAny=function(e,t){for(var r=0;r<t.length;r++){if(e.indexOf(t[r])!==-1)return true}return false};l.isPlotDiv=function(e){var t=n.select(e);return t.node()instanceof HTMLElement&&t.size()&&t.classed("js-plotly-plot")};l.removeElement=function(e){var t=e&&e.parentNode;if(t)t.removeChild(e)};l.addStyleRule=function(e,t){if(!l.styleSheet){var r=document.createElement("style");r.appendChild(document.createTextNode(""));document.head.appendChild(r);l.styleSheet=r.sheet}var n=l.styleSheet;if(n.insertRule){n.insertRule(e+"{"+t+"}",0)}else if(n.addRule){n.addRule(e,t,0)}else l.warn("addStyleRule failed")};l.isIE=function(){return typeof window.navigator.msSaveBlob!=="undefined"};l.isD3Selection=function(e){return e&&typeof e.classed==="function"};l.ensureSingle=function(e,t,r,n){var i=e.select(t+(r?"."+r:""));if(i.size())return i;var a=e.append(t).classed(r,true);if(n)a.call(n);return a};l.ensureSingleById=function(e,t,r,n){var i=e.select(t+"#"+r);if(i.size())return i;var a=e.append(t).attr("id",r);if(n)a.call(n);return a};l.objectFromPath=function(e,t){var r=e.split("."),n,i=n={};for(var a=0;a<r.length;a++){var o=r[a];var s=null;var l=r[a].match(/(.*)\[([0-9]+)\]/);if(l){o=l[1];s=l[2];n=n[o]=[];if(a===r.length-1){n[s]=t}else{n[s]={}}n=n[s]}else{if(a===r.length-1){n[o]=t}else{n[o]={}}n=n[o]}}return i};var w=/^([^\[\.]+)\.(.+)?/;var M=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;l.expandObjectPaths=function(e){var t,r,n,i,a,o,s;if(typeof e==="object"&&!Array.isArray(e)){for(r in e){if(e.hasOwnProperty(r)){if(t=r.match(w)){i=e[r];n=t[1];delete e[r];e[n]=l.extendDeepNoArrays(e[n]||{},l.objectFromPath(r,l.expandObjectPaths(i))[n])}else if(t=r.match(M)){i=e[r];n=t[1];a=parseInt(t[2]);delete e[r];e[n]=e[n]||[];if(t[3]==="."){s=t[4];o=e[n][a]=e[n][a]||{};l.extendDeepNoArrays(o,l.objectFromPath(s,l.expandObjectPaths(i)))}else{e[n][a]=l.expandObjectPaths(i)}}else{e[r]=l.expandObjectPaths(e[r])}}}}return e};l.numSeparate=function(e,t,r){if(!r)r=false;if(typeof t!=="string"||t.length===0){throw new Error("Separator string required for formatting!")}if(typeof e==="number"){e=String(e)}var n=/(\d+)(\d{3})/,i=t.charAt(0),a=t.charAt(1);var o=e.split("."),s=o[0],l=o.length>1?i+o[1]:"";if(a&&(o.length>1||s.length>4||r)){while(n.test(s)){s=s.replace(n,"$1"+a+"$2")}}return s+l};var A=/%{([^\s%{}]*)}/g;var T=/^\w*$/;l.templateString=function(e,t){var r={};return e.replace(A,function(e,n){if(T.test(n)){return t[n]||""}r[n]=r[n]||l.nestedProperty(t,n).get;return r[n]()||""})};var k=48;var E=57;l.subplotSort=function(e,t){var r=Math.min(e.length,t.length)+1;var n=0;var i=0;for(var a=0;a<r;a++){var o=e.charCodeAt(a)||0;var s=t.charCodeAt(a)||0;var l=o>=k&&o<=E;var u=s>=k&&s<=E;if(l)n=10*n+o-k;if(u)i=10*i+s-k;if(!l||!u){if(n!==i)return n-i;if(o!==s)return o-s}}return i-n};var S=2e9;l.seedPseudoRandom=function(){S=2e9};l.pseudoRandom=function(){var e=S;S=(69069*S+1)%4294967296;if(Math.abs(S-e)<429496729)return l.pseudoRandom();return S/4294967296}},{"../constants/numerical":463,"./angles":468,"./clean_number":469,"./coerce":471,"./dates":472,"./ensure_array":473,"./extend":475,"./filter_unique":476,"./filter_visible":477,"./geometry2d":478,"./get_graph_div":479,"./identity":482,"./is_array":484,"./is_plain_object":485,"./keyed_container":486,"./localize":487,"./loggers":488,"./matrix":489,"./mod":490,"./nested_property":491,"./noop":492,"./notifier":493,"./push_unique":496,"./regex":498,"./relative_attr":499,"./relink_private":500,"./search":501,"./stats":504,"./throttle":507,"./to_log_range":508,d3:81,"fast-isnumeric":91}],484:[function(e,t,r){"use strict";var n=typeof ArrayBuffer==="undefined"||!ArrayBuffer.isView?{isView:function(){return false}}:ArrayBuffer;var i=typeof DataView==="undefined"?function(){}:DataView;function a(e){return n.isView(e)&&!(e instanceof i)}function o(e){return Array.isArray(e)||a(e)}function s(e){return!o(e[0])}t.exports={isTypedArray:a,isArrayOrTypedArray:o,isArray1D:s}},{}],485:[function(e,t,r){"use strict";t.exports=function e(t){if(window&&window.process&&window.process.versions){return Object.prototype.toString.call(t)==="[object Object]"}return Object.prototype.toString.call(t)==="[object Object]"&&Object.getPrototypeOf(t)===Object.prototype}},{}],486:[function(e,t,r){"use strict";var n=e("./nested_property");var i=/^\w*$/;var a=0;var o=1;var s=2;var l=3;var u=4;t.exports=function e(t,r,f,c){f=f||"name";c=c||"value";var h,v,d;var p={};if(r&&r.length){d=n(t,r);v=d.get()}else{v=t}r=r||"";var g={};if(v){for(h=0;h<v.length;h++){g[v[h][f]]=h}}var m=i.test(c);var y={set:function(e,t){var r=t===null?u:a;if(!v){if(!d||r===u)return;v=[];d.set(v)}var i=g[e];if(i===undefined){if(r===u)return;r=r|l;i=v.length;g[e]=i}else if(t!==(m?v[i][c]:n(v[i],c).get())){r=r|s}var o=v[i]=v[i]||{};o[f]=e;if(m){o[c]=t}else{n(o,c).set(t)}if(t!==null){r=r&~u}p[i]=p[i]|r;return y},get:function(e){if(!v)return;var t=g[e];if(t===undefined){return undefined}else if(m){return v[t][c]}else{return n(v[t],c).get()}},rename:function(e,t){var r=g[e];if(r===undefined)return y;p[r]=p[r]|o;g[t]=r;delete g[e];v[r][f]=t;return y},remove:function(e){var t=g[e];if(t===undefined)return y;var r=v[t];if(Object.keys(r).length>2){p[t]=p[t]|s;return y.set(e,null)}if(m){for(h=t;h<v.length;h++){p[h]=p[h]|l}for(h=t;h<v.length;h++){g[v[h][f]]--}v.splice(t,1);delete g[e]}else{n(r,c).set(null);p[t]=p[t]|s|u}return y},constructUpdate:function(){var e,t;var i={};var a=Object.keys(p);for(var l=0;l<a.length;l++){t=a[l];e=r+"["+t+"]";if(v[t]){if(p[t]&o){i[e+"."+f]=v[t][f]}if(p[t]&s){if(m){i[e+"."+c]=p[t]&u?null:v[t][c]}else{i[e+"."+c]=p[t]&u?null:n(v[t],c).get()}}}else{i[e]=null}}return i}};return y}},{"./nested_property":491}],487:[function(e,t,r){"use strict";var n=e("../registry");t.exports=function e(t,r){var i=t._context.locale;for(var a=0;a<2;a++){var o=t._context.locales;for(var s=0;s<2;s++){var l=(o[i]||{}).dictionary;if(l){var u=l[r];if(u)return u}o=n.localeRegistry}var f=i.split("-")[0];if(f===i)break;i=f}return r}},{"../registry":582}],488:[function(e,t,r){"use strict";var n=e("../plot_api/plot_config");var i=t.exports={};i.log=function(){if(n.logging>1){var e=["LOG:"];for(var t=0;t<arguments.length;t++){e.push(arguments[t])}a(console.trace||console.log,e)}};i.warn=function(){if(n.logging>0){var e=["WARN:"];for(var t=0;t<arguments.length;t++){e.push(arguments[t])}a(console.trace||console.log,e)}};i.error=function(){if(n.logging>0){var e=["ERROR:"];for(var t=0;t<arguments.length;t++){e.push(arguments[t])}a(console.error,e)}};function a(e,t){if(e.apply){e.apply(e,t)}else{for(var r=0;r<t.length;r++){e(t[r])}}}},{"../plot_api/plot_config":517}],489:[function(e,t,r){"use strict";r.init2dArray=function(e,t){var r=new Array(e);for(var n=0;n<e;n++)r[n]=new Array(t);return r};r.transposeRagged=function(e){var t=0,r=e.length,n,i;for(n=0;n<r;n++)t=Math.max(t,e[n].length);var a=new Array(t);for(n=0;n<t;n++){a[n]=new Array(r);for(i=0;i<r;i++)a[n][i]=e[i][n]}return a};r.dot=function(e,t){if(!(e.length&&t.length)||e.length!==t.length)return null;var n=e.length,i,a;if(e[0].length){i=new Array(n);for(a=0;a<n;a++)i[a]=r.dot(e[a],t)}else if(t[0].length){var o=r.transposeRagged(t);i=new Array(o.length);for(a=0;a<o.length;a++)i[a]=r.dot(e,o[a])}else{i=0;for(a=0;a<n;a++)i+=e[a]*t[a]}return i};r.translationMatrix=function(e,t){return[[1,0,e],[0,1,t],[0,0,1]]};r.rotationMatrix=function(e){var t=e*Math.PI/180;return[[Math.cos(t),-Math.sin(t),0],[Math.sin(t),Math.cos(t),0],[0,0,1]]};r.rotationXYMatrix=function(e,t,n){return r.dot(r.dot(r.translationMatrix(t,n),r.rotationMatrix(e)),r.translationMatrix(-t,-n))};r.apply2DTransform=function(e){return function(){var t=arguments;if(t.length===3){t=t[0]}var n=arguments.length===1?t[0]:[t[0],t[1]];return r.dot(e,[n[0],n[1],1]).slice(0,2)}};r.apply2DTransform2=function(e){var t=r.apply2DTransform(e);return function(e){return t(e.slice(0,2)).concat(t(e.slice(2,4)))}}},{}],490:[function(e,t,r){"use strict";t.exports=function e(t,r){var n=t%r;return n<0?n+r:n}},{}],491:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("./is_array").isArrayOrTypedArray;t.exports=function e(t,r){if(n(r))r=String(r);else if(typeof r!=="string"||r.substr(r.length-4)==="[-1]"){throw"bad property string"}var i=0,o=r.split("."),s,u,f;while(i<o.length){s=String(o[i]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/);if(s){if(s[1])o[i]=s[1];else if(i===0)o.splice(0,1);else throw"bad property string";u=s[2].substr(1,s[2].length-2).split("][");for(f=0;f<u.length;f++){i++;o.splice(i,0,Number(u[f]))}}i++}if(typeof t!=="object"){return h(t,r,o)}return{set:l(t,o,r),get:a(t,o),astr:r,parts:o,obj:t}};function a(e,t){return function(){var r=e,n,o,s,l,u;for(l=0;l<t.length-1;l++){n=t[l];if(n===-1){o=true;s=[];for(u=0;u<r.length;u++){s[u]=a(r[u],t.slice(l+1))();if(s[u]!==s[0])o=false}return o?s[0]:s}if(typeof n==="number"&&!i(r)){return undefined}r=r[n];if(typeof r!=="object"||r===null){return undefined}}if(typeof r!=="object"||r===null)return undefined;s=r[t[l]];if(s===null)return undefined;return s}}var o=/(^|\.)args\[/;function s(e,t){return e===undefined||e===null&&!t.match(o)}function l(e,t,r){return function(n){var a=e,o="",l=[[e,o]],h=s(n,r),v,d;for(d=0;d<t.length-1;d++){v=t[d];if(typeof v==="number"&&!i(a)){throw"array index but container is not an array"}if(v===-1){h=!f(a,t.slice(d+1),n,r);if(h)break;else return}if(!c(a,v,t[d+1],h)){break}a=a[v];if(typeof a!=="object"||a===null){throw"container is not an object"}o=u(o,v);l.push([a,o])}if(h){if(d===t.length-1){delete a[t[d]];if(Array.isArray(a)&&+t[d]===a.length-1){while(a.length&&a[a.length-1]===undefined){a.pop()}}}}else a[t[d]]=n}}function u(e,t){var r=t;if(n(t))r="["+t+"]";else if(e)r="."+t;return e+r}function f(e,t,r,n){var a=i(r),o=true,u=r,f=n.replace("-1",0),h=a?false:s(r,f),v=t[0],d;for(d=0;d<e.length;d++){f=n.replace("-1",d);if(a){u=r[d%r.length];h=s(u,f)}if(h)o=false;if(!c(e,d,v,h)){continue}l(e[d],t,n.replace("-1",d))(u)}return o}function c(e,t,r,n){if(e[t]===undefined){if(n)return false;if(typeof r==="number")e[t]=[];else e[t]={}}return true}function h(e,t,r){return{set:function(){throw"bad container"},get:function(){},astr:t,parts:r,obj:e}}},{"./is_array":484,"fast-isnumeric":91}],492:[function(e,t,r){"use strict";t.exports=function e(){}},{}],493:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=[];t.exports=function(e,t){if(a.indexOf(e)!==-1)return;a.push(e);var r=1e3;if(i(t))r=t;else if(t==="long")r=3e3;var o=n.select("body").selectAll(".plotly-notifier").data([0]);o.enter().append("div").classed("plotly-notifier",true);var s=o.selectAll(".notifier-note").data(a);function l(e){e.duration(700).style("opacity",0).each("end",function(e){var t=a.indexOf(e);if(t!==-1)a.splice(t,1);n.select(this).remove()})}s.enter().append("div").classed("notifier-note",true).style("opacity",0).each(function(e){var t=n.select(this);t.append("button").classed("notifier-close",true).html("&times;").on("click",function(){t.transition().call(l)});var i=t.append("p");var a=e.split(/<br\s*\/?>/g);for(var o=0;o<a.length;o++){if(o)i.append("br");i.append("span").text(a[o])}t.transition().duration(700).style("opacity",1).transition().delay(r).call(l)})}},{d3:81,"fast-isnumeric":91}],494:[function(e,t,r){"use strict";var n=e("./setcursor");var i="data-savedcursor";var a="!!";t.exports=function e(t,r){var o=t.attr(i);if(r){if(!o){var s=(t.attr("class")||"").split(" ");for(var l=0;l<s.length;l++){var u=s[l];if(u.indexOf("cursor-")===0){t.attr(i,u.substr(7)).classed(u,false)}}if(!t.attr(i)){t.attr(i,a)}}n(t,r)}else if(o){t.attr(i,null);if(o===a)n(t);else n(t,o)}}},{"./setcursor":502}],495:[function(e,t,r){"use strict";var n=e("./matrix").dot;var i=e("../constants/numerical").BADNUM;var a=t.exports={};a.tester=function e(t){if(Array.isArray(t[0][0]))return a.multitester(t);var r=t.slice(),n=r[0][0],o=n,s=r[0][1],l=s,u;r.push(r[0]);for(u=1;u<r.length;u++){n=Math.min(n,r[u][0]);o=Math.max(o,r[u][0]);s=Math.min(s,r[u][1]);l=Math.max(l,r[u][1])}var f=false,c;if(r.length===5){if(r[0][0]===r[1][0]){if(r[2][0]===r[3][0]&&r[0][1]===r[3][1]&&r[1][1]===r[2][1]){f=true;c=function(e){return e[0]===r[0][0]}}}else if(r[0][1]===r[1][1]){if(r[2][1]===r[3][1]&&r[0][0]===r[3][0]&&r[1][0]===r[2][0]){f=true;c=function(e){return e[1]===r[0][1]}}}}function h(e,t){var r=e[0],a=e[1];if(r===i||r<n||r>o||a===i||a<s||a>l){return false}if(t&&c(e))return false;return true}function v(e,t){var a=e[0],u=e[1];if(a===i||a<n||a>o||u===i||u<s||u>l){return false}var f=r.length,c=r[0][0],h=r[0][1],v=0,d,p,g,m,y;for(d=1;d<f;d++){p=c;g=h;c=r[d][0];h=r[d][1];m=Math.min(p,c);if(a<m||a>Math.max(p,c)||u>Math.max(g,h)){continue}else if(u<Math.min(g,h)){if(a!==m)v++}else{if(c===p)y=u;else y=g+(a-p)*(h-g)/(c-p);if(u===y){if(d===1&&t)return false;return true}if(u<=y&&a!==m)v++}}return v%2===1}var d=true;var p=r[0];for(u=1;u<r.length;u++){if(p[0]!==r[u][0]||p[1]!==r[u][1]){d=false;break}}return{xmin:n,xmax:o,ymin:s,ymax:l,pts:r,contains:f?h:v,isRect:f,degenerate:d}};a.multitester=function e(t){var r=[],n=t[0][0][0],i=n,o=t[0][0][1],s=o;for(var l=0;l<t.length;l++){var u=a.tester(t[l]);u.subtract=t[l].subtract;r.push(u);n=Math.min(n,u.xmin);i=Math.max(i,u.xmax);o=Math.min(o,u.ymin);s=Math.max(s,u.ymax)}function f(e,t){var n=false;for(var i=0;i<r.length;i++){if(r[i].contains(e,t)){n=r[i].subtract===false}}return n}return{xmin:n,xmax:i,ymin:o,ymax:s,pts:[],contains:f,isRect:false,degenerate:false}};var o=a.isSegmentBent=function e(t,r,i,a){var o=t[r],s=[t[i][0]-o[0],t[i][1]-o[1]],l=n(s,s),u=Math.sqrt(l),f=[-s[1]/u,s[0]/u],c,h,v;for(c=r+1;c<i;c++){h=[t[c][0]-o[0],t[c][1]-o[1]];v=n(h,s);if(v<0||v>l||Math.abs(n(h,f))>a)return true}return false};a.filter=function e(t,r){var n=[t[0]],i=0,a=0;function s(e){t.push(e);var s=n.length,l=i;n.splice(a+1);for(var u=l+1;u<t.length;u++){if(u===t.length-1||o(t,l,u+1,r)){n.push(t[u]);if(n.length<s-2){i=u;a=n.length-1}l=u}}}if(t.length>1){var l=t.pop();s(l)}return{addPt:s,raw:t,filtered:n}}},{"../constants/numerical":463,"./matrix":489}],496:[function(e,t,r){"use strict";t.exports=function e(t,r){if(r instanceof RegExp){var n=r.toString(),i;for(i=0;i<t.length;i++){if(t[i]instanceof RegExp&&t[i].toString()===n){return t}}t.push(r)}else if((r||r===0)&&t.indexOf(r)===-1)t.push(r);return t}},{}],497:[function(e,t,r){"use strict";var n=e("../lib");var i=e("../plot_api/plot_config");function a(e,t){var r=[];var i;for(var a=0;a<t.length;a++){i=t[a];if(i===e)r[a]=i;else if(typeof i==="object"){r[a]=Array.isArray(i)?n.extendDeep([],i):n.extendDeepAll({},i)}else r[a]=i}return r}var o={};o.add=function(e,t,r,n,a){var o,s;e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:false};s=e.undoQueue.index;if(e.autoplay){if(!e.undoQueue.inSequence)e.autoplay=false;return}if(!e.undoQueue.sequence||e.undoQueue.beginSequence){o={undo:{calls:[],args:[]},redo:{calls:[],args:[]}};e.undoQueue.queue.splice(s,e.undoQueue.queue.length-s,o);e.undoQueue.index+=1}else{o=e.undoQueue.queue[s-1]}e.undoQueue.beginSequence=false;if(o){o.undo.calls.unshift(t);o.undo.args.unshift(r);o.redo.calls.push(n);o.redo.args.push(a)}if(e.undoQueue.queue.length>i.queueLength){e.undoQueue.queue.shift();e.undoQueue.index--}};o.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:false};e.undoQueue.sequence=true;e.undoQueue.beginSequence=true};o.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:false};e.undoQueue.sequence=false;e.undoQueue.beginSequence=false};o.undo=function e(t){var r,n;if(t.framework&&t.framework.isPolar){t.framework.undo();return}if(t.undoQueue===undefined||isNaN(t.undoQueue.index)||t.undoQueue.index<=0){return}t.undoQueue.index--;r=t.undoQueue.queue[t.undoQueue.index];t.undoQueue.inSequence=true;for(n=0;n<r.undo.calls.length;n++){o.plotDo(t,r.undo.calls[n],r.undo.args[n])}t.undoQueue.inSequence=false;t.autoplay=false};o.redo=function e(t){var r,n;if(t.framework&&t.framework.isPolar){t.framework.redo();return}if(t.undoQueue===undefined||isNaN(t.undoQueue.index)||t.undoQueue.index>=t.undoQueue.queue.length){return}r=t.undoQueue.queue[t.undoQueue.index];t.undoQueue.inSequence=true;for(n=0;n<r.redo.calls.length;n++){o.plotDo(t,r.redo.calls[n],r.redo.args[n])}t.undoQueue.inSequence=false;t.autoplay=false;t.undoQueue.index++};o.plotDo=function(e,t,r){e.autoplay=true;r=a(e,r);t.apply(null,r)};t.exports=o},{"../lib":483,"../plot_api/plot_config":517}],498:[function(e,t,r){"use strict";r.counter=function(e,t,r){var n=(t||"")+(r?"":"$");if(e==="xy"){return new RegExp("^x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+n)}return new RegExp("^"+e+"([2-9]|[1-9][0-9]+)?"+n)}},{}],499:[function(e,t,r){"use strict";var n=/^(.*)(\.[^\.\[\]]+|\[\d\])$/;var i=/^[^\.\[\]]+$/;t.exports=function(e,t){while(t){var r=e.match(n);if(r)e=r[1];else if(e.match(i))e="";else throw new Error("bad relativeAttr call:"+[e,t]);if(t.charAt(0)==="^")t=t.slice(1);else break}if(e&&t.charAt(0)!=="["){return e+"."+t}return e+t}},{}],500:[function(e,t,r){"use strict";var n=e("./is_array").isArrayOrTypedArray;var i=e("./is_plain_object");t.exports=function e(t,r){for(var a in r){var o=r[a];var s=t[a];if(s===o){continue}if(a.charAt(0)==="_"||typeof o==="function"){if(a in t)continue;t[a]=o}else if(n(o)&&n(s)&&i(o[0])){if(a==="customdata"||a==="ids")continue;var l=Math.min(o.length,s.length);for(var u=0;u<l;u++){if(s[u]!==o[u]&&i(o[u])&&i(s[u])){e(s[u],o[u])}}}else if(i(o)&&i(s)){e(s,o);if(!Object.keys(s).length)delete t[a]}}}},{"./is_array":484,"./is_plain_object":485}],501:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("./loggers");var a=1e-9;r.findBin=function(e,t,r){if(n(t.start)){return r?Math.ceil((e-t.start)/t.size-a)-1:Math.floor((e-t.start)/t.size+a)}else{var f=0;var c=t.length;var h=0;var v=c>1?(t[c-1]-t[0])/(c-1):1;var d,p;if(v>=0){p=r?o:s}else{p=r?u:l}e+=v*a*(r?-1:1)*(v>=0?1:-1);while(f<c&&h++<100){d=Math.floor((f+c)/2);if(p(t[d],e))f=d+1;else c=d}if(h>90)i.log("Long binary search...");return f-1}};function o(e,t){return e<t}function s(e,t){return e<=t}function l(e,t){return e>t}function u(e,t){return e>=t}r.sorterAsc=function(e,t){return e-t};r.sorterDes=function(e,t){return t-e};r.distinctVals=function(e){var t=e.slice();t.sort(r.sorterAsc);var n=t.length-1,i=t[n]-t[0]||1,a=i/(n||1)/1e4,o=[t[0]];for(var s=0;s<n;s++){if(t[s+1]>t[s]+a){i=Math.min(i,t[s+1]-t[s]);o.push(t[s+1])}}return{vals:o,minDiff:i}};r.roundUp=function(e,t,r){var n=0,i=t.length-1,a,o=0,s=r?0:1,l=r?1:0,u=r?Math.ceil:Math.floor;while(n<i&&o++<100){a=u((n+i)/2);if(t[a]<=e)n=a+s;else i=a-l}return t[n]}},{"./loggers":488,"fast-isnumeric":91}],502:[function(e,t,r){"use strict";t.exports=function e(t,r){(t.attr("class")||"").split(" ").forEach(function(e){if(e.indexOf("cursor-")===0)t.classed(e,false)});if(r)t.classed("cursor-"+r,true)}},{}],503:[function(e,t,r){"use strict";var n=e("../components/color");var i=function(){};t.exports=function e(t){for(var r in t){if(typeof t[r]==="function")t[r]=i}t.destroy=function(){t.container.parentNode.removeChild(t.container)};var a=document.createElement("div");a.className="no-webgl";a.style.cursor="pointer";a.style.fontSize="24px";a.style.color=n.defaults[0];a.style.position="absolute";a.style.left=a.style.top="0px";a.style.width=a.style.height="100%";a.style["background-color"]=n.lightLine;a.style["z-index"]=30;var o=document.createElement("p");o.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info";o.style.position="relative";o.style.top="50%";o.style.left="50%";o.style.height="30%";o.style.width="50%";o.style.margin="-15% 0 0 -25%";a.appendChild(o);t.container.appendChild(a);t.container.style.background="#FFFFFF";t.container.onclick=function(){window.open("https://get.webgl.org")};return false}},{"../components/color":361}],504:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("./is_array").isArrayOrTypedArray;r.aggNums=function(e,t,a,o){var s,l;if(!o||o>a.length)o=a.length;if(!n(t))t=false;if(i(a[0])){l=new Array(o);for(s=0;s<o;s++)l[s]=r.aggNums(e,t,a[s]);a=l}for(s=0;s<o;s++){if(!n(t))t=a[s];else if(n(a[s]))t=e(+t,+a[s])}return t};r.len=function(e){return r.aggNums(function(e){return e+1},0,e)};r.mean=function(e,t){if(!t)t=r.len(e);return r.aggNums(function(e,t){return e+t},0,e)/t};r.midRange=function(e){if(e===undefined||e.length===0)return undefined;return(r.aggNums(Math.max,null,e)+r.aggNums(Math.min,null,e))/2};r.variance=function(e,t,i){if(!t)t=r.len(e);if(!n(i))i=r.mean(e,t);return r.aggNums(function(e,t){return e+Math.pow(t-i,2)},0,e)/t};r.stdev=function(e,t,n){return Math.sqrt(r.variance(e,t,n))};r.interp=function(e,t){if(!n(t))throw"n should be a finite number";t=t*e.length-.5;if(t<0)return e[0];if(t>e.length-1)return e[e.length-1];var r=t%1;return r*e[Math.ceil(t)]+(1-r)*e[Math.floor(t)]}},{"./is_array":484,"fast-isnumeric":91}],505:[function(e,t,r){"use strict";var n=e("color-normalize");function i(e){if(!e)return[0,0,0,1];return n(e)}t.exports=i},{"color-normalize":62}],506:[function(e,t,r){"use strict";var n=e("d3");var i=e("../lib");var a=e("../constants/xmlns_namespaces");var o=e("../constants/string_mappings");var s=e("../constants/alignment").LINE_SPACING;function l(e,t){return e.node().getBoundingClientRect()[t]}var u=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;r.convertToTspans=function(e,t,i){var a=e.text();var o=!e.attr("data-notex")&&typeof MathJax!=="undefined"&&a.match(u);var s=n.select(e.node().parentNode);if(s.empty())return;var f=e.attr("class")?e.attr("class").split(" ")[0]:"text";f+="-math";s.selectAll("svg."+f).remove();s.selectAll("g."+f+"-group").remove();e.style("display",null).attr({"data-unformatted":a,"data-math":"N"});function c(){if(!s.empty()){f=e.attr("class")+"-math";s.select("svg."+f).remove()}e.text("").style("white-space","pre");var t=O(e.node(),a);if(t){e.style("pointer-events","all")}r.positionText(e);if(i)i.call(e)}if(o){(t&&t._promises||[]).push(new Promise(function(t){e.style("display","none");var r=parseInt(e.node().style.fontSize,10);var n={fontSize:r};v(o[2],n,function(n,o,u){s.selectAll("svg."+f).remove();s.selectAll("g."+f+"-group").remove();var h=n&&n.select("svg");if(!h||!h.node()){c();t();return}var v=s.append("g").classed(f+"-group",true).attr({"pointer-events":"none","data-unformatted":a,"data-math":"Y"});v.node().appendChild(h.node());if(o&&o.node()){h.node().insertBefore(o.node().cloneNode(true),h.node().firstChild)}h.attr({class:f,height:u.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var d=e.node().style.fill||"black";h.select("g").attr({fill:d,stroke:d});var p=l(h,"width"),g=l(h,"height"),m=+e.attr("x")-p*{start:0,middle:.5,end:1}[e.attr("text-anchor")||"start"],y=r||l(e,"height"),b=-y/4;if(f[0]==="y"){v.attr({transform:"rotate("+[-90,+e.attr("x"),+e.attr("y")]+") translate("+[-p/2,b-g/2]+")"});h.attr({x:+e.attr("x"),y:+e.attr("y")})}else if(f[0]==="l"){h.attr({x:e.attr("x"),y:b-g/2})}else if(f[0]==="a"){h.attr({x:0,y:b})}else{h.attr({x:m,y:+e.attr("y")+b-g/2})}if(i)i.call(e,v);t(v)})}))}else c();return e};var f=/(<|&lt;|&#60;)/g;var c=/(>|&gt;|&#62;)/g;function h(e){return e.replace(f,"\\lt ").replace(c,"\\gt ")}function v(e,t,r){var a="math-output-"+i.randstr({},64);var o=n.select("body").append("div").attr({id:a}).style({visibility:"hidden",position:"absolute"}).style({"font-size":t.fontSize+"px"}).text(h(e));MathJax.Hub.Queue(["Typeset",MathJax.Hub,o.node()],function(){var t=n.select("body").select("#MathJax_SVG_glyphs");if(o.select(".MathJax_SVG").empty()||!o.select("svg").node()){i.log("There was an error in the tex syntax.",e);r()}else{var a=o.select("svg").node().getBoundingClientRect();r(o.select(".MathJax_SVG"),t,a)}o.remove()})}var d={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"};var p={sub:"0.3em",sup:"-0.6em"};var g={sub:"-0.21em",sup:"0.42em"};var m="\u200b";var y=["http:","https:","mailto:","",undefined,":"];var b=new RegExp("</?("+Object.keys(d).join("|")+")( [^>]*)?/?>","g");var x=Object.keys(o.entityToUnicode).map(function(e){return{regExp:new RegExp("&"+e+";","g"),sub:o.entityToUnicode[e]}});var _=/(\r\n?|\n)/g;var w=/(<[^<>]*>)/;var M=/<(\/?)([^ >]*)(\s+(.*))?>/i;var A=/<br(\s+.*)?>/i;var T=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i;var k=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i;var E=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i;var S=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function L(e,t){if(!e)return null;var r=e.match(t);return r&&(r[3]||r[4])}var C=/(^|;)\s*color:/;r.plainText=function(e){return(e||"").replace(b," ")};function I(e,t){if(!e)return"";for(var r=0;r<t.length;r++){var n=t[r];e=e.replace(n.regExp,n.sub)}return e}function P(e){return I(e,x)}function O(e,t){t=P(t).replace(_," ");var r=false;var o=[];var l;var u=-1;function f(){u++;var t=document.createElementNS(a.svg,"tspan");n.select(t).attr({class:"line",dy:u*s+"em"});e.appendChild(t);l=t;var r=o;o=[{node:t}];if(r.length>1){for(var i=1;i<r.length;i++){c(r[i])}}}function c(e){var t=e.type;var r={};var i;if(t==="a"){i="a";var s=e.target;var u=e.href;var f=e.popup;if(u){r={"xlink:xlink:show":s==="_blank"||s.charAt(0)!=="_"?"new":"replace",target:s,"xlink:xlink:href":u};if(f){r.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+f+'");return false;'}}}else i="tspan";if(e.style)r.style=e.style;var c=document.createElementNS(a.svg,i);if(t==="sup"||t==="sub"){h(l,m);l.appendChild(c);var v=document.createElementNS(a.svg,"tspan");h(v,m);n.select(v).attr("dy",g[t]);r.dy=p[t];l.appendChild(c);l.appendChild(v)}else{l.appendChild(c)}n.select(c).attr(r);l=e.node=c;o.push(e)}function h(e,t){e.appendChild(document.createTextNode(t))}function v(e){if(o.length===1){i.log("Ignoring unexpected end tag </"+e+">.",t);return}var r=o.pop();if(e!==r.type){i.log("Start tag <"+r.type+"> doesnt match end tag <"+e+">. Pretending it did match.",t)}l=o[o.length-1].node}var b=A.test(t);if(b)f();else{l=e;o=[{node:e}]}var x=t.split(w);for(var I=0;I<x.length;I++){var O=x[I];var R=O.match(M);var N=R&&R[2].toLowerCase();var z=d[N];if(N==="br"){f()}else if(z===undefined){h(l,O)}else{if(R[1]){v(N)}else{var D=R[4];var F={type:N};var j=L(D,T);if(j){j=j.replace(C,"$1 fill:");if(z)j+=";"+z}else if(z)j=z;if(j)F.style=j;if(N==="a"){r=true;var B=L(D,k);if(B){var U=document.createElement("a");U.href=B;if(y.indexOf(U.protocol)!==-1){F.href=encodeURI(decodeURI(B));F.target=L(D,E)||"_blank";F.popup=L(D,S)}}}c(F)}}}return r}r.lineCount=function e(t){return t.selectAll("tspan.line").size()||1};r.positionText=function e(t,r,i){return t.each(function(){var e=n.select(this);function t(t,r){if(r===undefined){r=e.attr(t);if(r===null){e.attr(t,0);r=0}}else e.attr(t,r);return r}var a=t("x",r);var o=t("y",i);if(this.nodeName==="text"){e.selectAll("tspan.line").attr({x:a,y:o})}})};function R(e,t,r){var n=r.horizontalAlign,i=r.verticalAlign||"top",a=e.node().getBoundingClientRect(),o=t.node().getBoundingClientRect(),s,l,u;if(i==="bottom"){l=function(){return a.bottom-s.height}}else if(i==="middle"){l=function(){return a.top+(a.height-s.height)/2}}else{l=function(){return a.top}}if(n==="right"){u=function(){return a.right-s.width}}else if(n==="center"){u=function(){return a.left+(a.width-s.width)/2}}else{u=function(){return a.left}}return function(){s=this.node().getBoundingClientRect();this.style({top:l()-o.top+"px",left:u()-o.left+"px","z-index":1e3});return this}}r.makeEditable=function(e,t){var r=t.gd;var i=t.delegate;var a=n.dispatch("edit","input","cancel");var o=i||e;e.style({"pointer-events":i?"none":"all"});if(e.size()!==1)throw new Error("boo");function s(){u();e.style({opacity:0});var t=o.attr("class"),r;if(t)r="."+t.split(" ")[0]+"-math-group";else r="[class*=-math-group]";if(r){n.select(e.node().parentNode).select(r).style({opacity:0})}}function l(e){var t=e.node();var r=document.createRange();r.selectNodeContents(t);var n=window.getSelection();n.removeAllRanges();n.addRange(r);t.focus()}function u(){var i=n.select(r);var o=i.select(".svg-container");var s=o.append("div");var u=e.node().style;var f=parseFloat(u.fontSize||12);var c=t.text;if(c===undefined)c=e.attr("data-unformatted");s.classed("plugin-editable editable",true).style({position:"absolute","font-family":u.fontFamily||"Arial","font-size":f,color:t.fill||u.fill||"black",opacity:1,"background-color":t.background||"transparent",outline:"#ffffff33 1px solid",margin:[-f/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:true}).text(c).call(R(e,o,t)).on("blur",function(){r._editing=false;e.text(this.textContent).style({opacity:1});var t=n.select(this).attr("class"),i;if(t)i="."+t.split(" ")[0]+"-math-group";else i="[class*=-math-group]";if(i){n.select(e.node().parentNode).select(i).style({opacity:0})}var o=this.textContent;n.select(this).transition().duration(0).remove();n.select(document).on("mouseup",null);a.edit.call(e,o)}).on("focus",function(){var e=this;r._editing=true;n.select(document).on("mouseup",function(){if(n.event.target===e)return false;if(document.activeElement===s.node())s.node().blur()})}).on("keyup",function(){if(n.event.which===27){r._editing=false;e.style({opacity:1});n.select(this).style({opacity:0}).on("blur",function(){return false}).transition().remove();a.cancel.call(e,this.textContent)}else{a.input.call(e,this.textContent);n.select(this).call(R(e,o,t))}}).on("keydown",function(){if(n.event.which===13)this.blur()}).call(l)}if(t.immediate)s();else o.on("click",s);return n.rebind(e,a,"on")}},{"../constants/alignment":459,"../constants/string_mappings":464,"../constants/xmlns_namespaces":465,"../lib":483,d3:81}],507:[function(e,t,r){"use strict";var n={};r.throttle=function e(t,r,a){var o=n[t];var s=Date.now();if(!o){for(var l in n){if(n[l].ts<s-6e4){delete n[l]}}o=n[t]={ts:0,timer:null}}i(o);function u(){a();o.ts=Date.now();if(o.onDone){o.onDone();o.onDone=null}}if(s>o.ts+r){u();return}o.timer=setTimeout(function(){u();o.timer=null},r)};r.done=function(e){var t=n[e];if(!t||!t.timer)return Promise.resolve();return new Promise(function(e){var r=t.onDone;t.onDone=function n(){if(r)r();e();t.onDone=null}})};r.clear=function(e){if(e){i(n[e]);delete n[e]}else{for(var t in n)r.clear(t)}};function i(e){if(e&&e.timer!==null){clearTimeout(e.timer);e.timer=null}}},{}],508:[function(e,t,r){"use strict";var n=e("fast-isnumeric");t.exports=function e(t,r){if(t>0)return Math.log(t)/Math.LN10;var i=Math.log(Math.min(r[0],r[1]))/Math.LN10;if(!n(i))i=Math.log(Math.max(r[0],r[1]))/Math.LN10-6;return i}},{"fast-isnumeric":91}],509:[function(e,t,r){"use strict";t.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],510:[function(e,t,r){"use strict";t.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],511:[function(e,t,r){"use strict";var n=e("../registry");t.exports=function e(t){var r=n.layoutArrayContainers,i=n.layoutArrayRegexes,a=t.split("[")[0],o,s;for(var l=0;l<i.length;l++){s=t.match(i[l]);if(s&&s.index===0){o=s[0];break}}if(!o)o=r[r.indexOf(a)];if(!o)return false;var u=t.substr(o.length);if(!u)return{array:o,index:"",property:""};s=u.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/);if(!s)return false;return{array:o,index:Number(s[1]),property:s[3]||""}}},{"../registry":582}],512:[function(e,t,r){"use strict";var n=e("../lib");var i=n.extendFlat;var a=n.isPlainObject;var o={valType:"flaglist",extras:["none"],flags:["calc","calcIfAutorange","clearAxisTypes","plot","style","colorbars"]};var s={valType:"flaglist",extras:["none"],flags:["calc","calcIfAutorange","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw"]};var l=o.flags.slice().concat(["clearCalc","fullReplot"]);var u=s.flags.slice().concat("layoutReplot");t.exports={traces:o,layout:s,traceFlags:function(){return f(l)},layoutFlags:function(){return f(u)},update:function(e,t){var r=t.editType;if(r&&r!=="none"){var n=r.split("+");for(var i=0;i<n.length;i++){e[n[i]]=true}}},overrideAll:c};function f(e){var t={};for(var r=0;r<e.length;r++)t[e[r]]=false;return t}function c(e,t,r){var n=i({},e);for(var o in n){var s=n[o];if(a(s)){n[o]=h(s,t,r,o)}}if(r==="from-root")n.editType=t;return n}function h(e,t,r,n){if(e.valType){var a=i({},e);a.editType=t;if(Array.isArray(e.items)){a.items=new Array(e.items.length);for(var o=0;o<e.items.length;o++){a.items[o]=h(e.items[o],t,"from-root")}}return a}else{return c(e,t,n.charAt(0)==="_"?"nested":"from-root")}}},{"../lib":483}],513:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("gl-mat4/fromQuat");var a=e("../registry");var o=e("../lib");var s=e("../plots/plots");var l=e("../plots/cartesian/axis_ids");var u=l.cleanId;var f=l.getFromTrace;var c=e("../components/color");r.clearPromiseQueue=function(e){if(Array.isArray(e._promises)&&e._promises.length>0){o.log("Clearing previous rejected promises from queue.")}e._promises=[]};r.cleanLayout=function(e){var t,r;if(!e)e={};if(e.xaxis1){if(!e.xaxis)e.xaxis=e.xaxis1;delete e.xaxis1}if(e.yaxis1){if(!e.yaxis)e.yaxis=e.yaxis1;delete e.yaxis1}if(e.scene1){if(!e.scene)e.scene=e.scene1;delete e.scene1}var n=(s.subplotsRegistry.cartesian||{}).attrRegex;var a=(s.subplotsRegistry.gl3d||{}).attrRegex;var l=Object.keys(e);for(t=0;t<l.length;t++){var f=l[t];if(n&&n.test(f)){var v=e[f];if(v.anchor&&v.anchor!=="free"){v.anchor=u(v.anchor)}if(v.overlaying)v.overlaying=u(v.overlaying);if(!v.type){if(v.isdate)v.type="date";else if(v.islog)v.type="log";else if(v.isdate===false&&v.islog===false)v.type="linear"}if(v.autorange==="withzero"||v.autorange==="tozero"){v.autorange=true;v.rangemode="tozero"}delete v.islog;delete v.isdate;delete v.categories;if(g(v,"domain"))delete v.domain;if(v.autotick!==undefined){if(v.tickmode===undefined){v.tickmode=v.autotick?"auto":"linear"}delete v.autotick}}else if(a&&a.test(f)){var d=e[f];var p=d.cameraposition;if(Array.isArray(p)&&p[0].length===4){var m=p[0],y=p[1],b=p[2],x=i([],m),_=[];for(r=0;r<3;++r){_[r]=y[r]+b*x[2+4*r]}d.camera={eye:{x:_[0],y:_[1],z:_[2]},center:{x:y[0],y:y[1],z:y[2]},up:{x:x[1],y:x[5],z:x[9]}};delete d.cameraposition}}}var w=Array.isArray(e.annotations)?e.annotations.length:0;for(t=0;t<w;t++){var M=e.annotations[t];if(!o.isPlainObject(M))continue;if(M.ref){if(M.ref==="paper"){M.xref="paper";M.yref="paper"}else if(M.ref==="data"){M.xref="x";M.yref="y"}delete M.ref}h(M,"xref");h(M,"yref")}var A=Array.isArray(e.shapes)?e.shapes.length:0;for(t=0;t<A;t++){var T=e.shapes[t];if(!o.isPlainObject(T))continue;h(T,"xref");h(T,"yref")}var k=e.legend;if(k){if(k.x>3){k.x=1.02;k.xanchor="left"}else if(k.x<-2){k.x=-.02;k.xanchor="right"}if(k.y>3){k.y=1.02;k.yanchor="bottom"}else if(k.y<-2){k.y=-.02;k.yanchor="top"}}if(e.dragmode==="rotate")e.dragmode="orbit";c.clean(e);return e};function h(e,t){var r=e[t],n=t.charAt(0);if(r&&r!=="paper"){e[t]=u(r,n)}}r.cleanData=function(e){for(var t=0;t<e.length;t++){var n=e[t];var i;if(n.type==="histogramy"&&"xbins"in n&&!("ybins"in n)){n.ybins=n.xbins;delete n.xbins}if(n.error_y&&"opacity"in n.error_y){var l=c.defaults,f=n.error_y.color||(a.traceIs(n,"bar")?c.defaultLine:l[t%l.length]);n.error_y.color=c.addOpacity(c.rgb(f),c.opacity(f)*n.error_y.opacity);delete n.error_y.opacity}if("bardir"in n){if(n.bardir==="h"&&(a.traceIs(n,"bar")||n.type.substr(0,9)==="histogram")){n.orientation="h";r.swapXYData(n)}delete n.bardir}if(n.type==="histogramy")r.swapXYData(n);if(n.type==="histogramx"||n.type==="histogramy"){n.type="histogram"}if("scl"in n){n.colorscale=n.scl;delete n.scl}if("reversescl"in n){n.reversescale=n.reversescl;delete n.reversescl}if(n.xaxis)n.xaxis=u(n.xaxis,"x");if(n.yaxis)n.yaxis=u(n.yaxis,"y");if(a.traceIs(n,"gl3d")&&n.scene){n.scene=s.subplotsRegistry.gl3d.cleanId(n.scene)}if(!a.traceIs(n,"pie")&&!a.traceIs(n,"bar")){if(Array.isArray(n.textposition)){for(i=0;i<n.textposition.length;i++){n.textposition[i]=p(n.textposition[i])}}else if(n.textposition){n.textposition=p(n.textposition)}}var h=a.getModule(n);if(h&&h.colorbar){var m=h.colorbar.container;var y=m?n[m]:n;if(y&&y.colorscale){if(y.colorscale==="YIGnBu")y.colorscale="YlGnBu";if(y.colorscale==="YIOrRd")y.colorscale="YlOrRd"}}if(n.type==="surface"&&o.isPlainObject(n.contours)){var b=["x","y","z"];for(i=0;i<b.length;i++){var x=n.contours[b[i]];if(!o.isPlainObject(x))continue;if(x.highlightColor){x.highlightcolor=x.highlightColor;delete x.highlightColor}if(x.highlightWidth){x.highlightwidth=x.highlightWidth;delete x.highlightWidth}}}if(n.type==="candlestick"||n.type==="ohlc"){var _=(n.increasing||{}).showlegend!==false;var w=(n.decreasing||{}).showlegend!==false;var M=v(n.increasing);var A=v(n.decreasing);if(M!==false&&A!==false){var T=d(M,A,_,w);if(T)n.name=T}else if((M||A)&&!n.name){n.name=M||A}}if(Array.isArray(n.transforms)){var k=n.transforms;for(i=0;i<k.length;i++){var E=k[i];if(!o.isPlainObject(E))continue;switch(E.type){case"filter":if(E.filtersrc){E.target=E.filtersrc;delete E.filtersrc}if(E.calendar){if(!E.valuecalendar){E.valuecalendar=E.calendar}delete E.calendar}break;case"groupby":E.styles=E.styles||E.style;if(E.styles&&!Array.isArray(E.styles)){var S=E.styles;var L=Object.keys(S);E.styles=[];for(var C=0;C<L.length;C++){E.styles.push({target:L[C],value:S[L[C]]})}}break}}}if(g(n,"line"))delete n.line;if("marker"in n){if(g(n.marker,"line"))delete n.marker.line;if(g(n,"marker"))delete n.marker}c.clean(n)}};function v(e){if(!o.isPlainObject(e))return false;var t=e.name;delete e.name;delete e.showlegend;return(typeof t==="string"||typeof t==="number")&&String(t)}function d(e,t,r,n){if(r&&!n)return e;if(n&&!r)return t;if(!e.trim())return t;if(!t.trim())return e;var i=Math.min(e.length,t.length);var a;for(a=0;a<i;a++){if(e.charAt(a)!==t.charAt(a))break}var o=e.substr(0,a);return o.trim()}function p(e){var t="middle",r="center";if(e.indexOf("top")!==-1)t="top";else if(e.indexOf("bottom")!==-1)t="bottom";if(e.indexOf("left")!==-1)r="left";else if(e.indexOf("right")!==-1)r="right";return t+" "+r}function g(e,t){return t in e&&typeof e[t]==="object"&&Object.keys(e[t]).length===0}r.swapXYData=function(e){var t;o.swapAttrs(e,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]);if(Array.isArray(e.z)&&Array.isArray(e.z[0])){if(e.transpose)delete e.transpose;else e.transpose=true}if(e.error_x&&e.error_y){var r=e.error_y,n="copy_ystyle"in r?r.copy_ystyle:!(r.color||r.thickness||r.width);o.swapAttrs(e,["error_?.copy_ystyle"]);if(n){o.swapAttrs(e,["error_?.color","error_?.thickness","error_?.width"])}}if(typeof e.hoverinfo==="string"){var i=e.hoverinfo.split("+");for(t=0;t<i.length;t++){if(i[t]==="x")i[t]="y";else if(i[t]==="y")i[t]="x"}e.hoverinfo=i.join("+")}};r.coerceTraceIndices=function(e,t){if(n(t)){return[t]}else if(!Array.isArray(t)||!t.length){return e.data.map(function(e,t){return t})}return t};r.manageArrayContainers=function(e,t,r){var i=e.obj,a=e.parts,s=a.length,l=a[s-1];var u=n(l);if(u&&t===null){var f=a.slice(0,s-1).join("."),c=o.nestedProperty(i,f).get();c.splice(l,1)}else if(u&&e.get()===undefined){if(e.get()===undefined)r[e.astr]=null;e.set(t)}else{e.set(t)}};var m=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function y(e){var t=e.search(m);if(t>0)return e.substr(0,t)}r.hasParent=function(e,t){var r=y(t);while(r){if(r in e)return true;r=y(r)}return false};var b=["x","y","z"];r.clearAxisTypes=function(e,t,r){for(var n=0;n<t.length;n++){var i=e._fullData[n];for(var a=0;a<3;a++){var s=f(e,i,b[a]);if(s&&s.type!=="log"){var l=s._name;var u=s._id.substr(1);if(u.substr(0,5)==="scene"){if(r[u]!==undefined)continue;l=u+"."+l}var c=l+".type";if(r[l]===undefined&&r[c]===undefined){o.nestedProperty(e.layout,c).set(null)}}}}}},{"../components/color":361,"../lib":483,"../plots/cartesian/axis_ids":532,"../plots/plots":573,"../registry":582,"fast-isnumeric":91,"gl-mat4/fromQuat":122}],514:[function(e,t,r){"use strict";var n=e("./plot_api");r.plot=n.plot;r.newPlot=n.newPlot;r.restyle=n.restyle;r.relayout=n.relayout;r.redraw=n.redraw;r.update=n.update;r.react=n.react;r.extendTraces=n.extendTraces;r.prependTraces=n.prependTraces;r.addTraces=n.addTraces;r.deleteTraces=n.deleteTraces;r.moveTraces=n.moveTraces;r.purge=n.purge;r.addFrames=n.addFrames;r.deleteFrames=n.deleteFrames;r.animate=n.animate;r.setPlotConfig=n.setPlotConfig;r.toImage=e("./to_image");r.validate=e("./validate");r.downloadImage=e("../snapshot/download");var i=e("./template_api");r.makeTemplate=i.makeTemplate;r.validateTemplate=i.validateTemplate},{"../snapshot/download":584,"./plot_api":516,"./template_api":521,"./to_image":522,"./validate":523}],515:[function(e,t,r){"use strict";var n=e("../lib/nested_property");var i=e("../lib/is_plain_object");var a=e("../lib/noop");var o=e("../lib/loggers");var s=e("../lib/search").sorterAsc;var l=e("../registry");r.containerArrayMatch=e("./container_array_match");var u=r.isAddVal=function e(t){return t==="add"||i(t)};var f=r.isRemoveVal=function e(t){return t===null||t==="remove"};r.applyContainerArrayChanges=function e(t,r,i,c){var h=r.astr,v=l.getComponentMethod(h,"supplyLayoutDefaults"),d=l.getComponentMethod(h,"draw"),p=l.getComponentMethod(h,"drawOne"),g=c.replot||c.recalc||v===a||d===a,m=t.layout,y=t._fullLayout;if(i[""]){if(Object.keys(i).length>1){o.warn("Full array edits are incompatible with other edits",h)}var b=i[""][""];if(f(b))r.set(null);else if(Array.isArray(b))r.set(b);else{o.warn("Unrecognized full array edit value",h,b);return true}if(g)return false;v(m,y);d(t);return true}var x=Object.keys(i).map(Number).sort(s),_=r.get(),w=_||[],M=n(y,h).get();var A=[],T=-1,k=w.length,E,S,L,C,I,P,O;for(E=0;E<x.length;E++){L=x[E];C=i[L];I=Object.keys(C);P=C[""],O=u(P);if(L<0||L>w.length-(O?0:1)){o.warn("index out of range",h,L);continue}if(P!==undefined){if(I.length>1){o.warn("Insertion & removal are incompatible with edits to the same index.",h,L)}if(f(P)){A.push(L)}else if(O){if(P==="add")P={};w.splice(L,0,P);if(M)M.splice(L,0,{})}else{o.warn("Unrecognized full object edit value",h,L,P)}if(T===-1)T=L}else{for(S=0;S<I.length;S++){n(w[L],I[S]).set(C[I[S]])}}}for(E=A.length-1;E>=0;E--){w.splice(A[E],1);if(M)M.splice(A[E],1)}if(!w.length)r.set(null);else if(!_)r.set(w);if(g)return false;v(m,y);if(p!==a){var R;if(T===-1){R=x}else{k=Math.max(w.length,k);R=[];for(E=0;E<x.length;E++){L=x[E];if(L>=T)break;R.push(L)}for(E=T;E<k;E++){R.push(E)}}for(E=0;E<R.length;E++){p(t,R[E])}}else d(t);return true}},{"../lib/is_plain_object":485,"../lib/loggers":488,"../lib/nested_property":491,"../lib/noop":492,"../lib/search":501,"../registry":582,"./container_array_match":511}],516:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("has-hover");var o=e("../lib");var s=e("../lib/events");var l=e("../lib/queue");var u=e("../registry");var f=e("./plot_schema");var c=e("../plots/plots");var h=e("../plots/polar/legacy");var v=e("../plots/cartesian/axes");var d=e("../components/drawing");var p=e("../components/color");var g=e("../components/colorbar/connect");var m=e("../plots/cartesian/graph_interact").initInteractions;var y=e("../constants/xmlns_namespaces");var b=e("../lib/svg_text_utils");var x=e("./plot_config");var _=e("./manage_arrays");var w=e("./helpers");var M=e("./subroutines");var A=e("./edit_types");var T=e("../plots/cartesian/constants").AX_NAME_PATTERN;var k=0;var E=5;r.plot=function(e,t,i,a){var l;e=o.getGraphDiv(e);s.init(e);if(o.isPlainObject(t)){var f=t;t=f.data;i=f.layout;a=f.config;l=f.frames}var h=s.triggerHandler(e,"plotly_beforeplot",[t,i,a]);if(h===false)return Promise.reject();if(!t&&!i&&!o.isPlotDiv(e)){o.warn("Calling Plotly.plot as if redrawing "+"but this container doesn't yet have a plot.",e)}function p(){if(l){return r.addFrames(e,l)}}I(e,a);if(!i)i={};n.select(e).classed("js-plotly-plot",true);d.makeTester();delete d.baseUrl;if(!Array.isArray(e._promises))e._promises=[];var y=(e.data||[]).length===0&&Array.isArray(t);if(Array.isArray(t)){w.cleanData(t);if(y)e.data=t;else e.data.push.apply(e.data,t);e.empty=false}if(!e.layout||y)e.layout=w.cleanLayout(i);if(e._dragging&&!e._transitioning){e._replotPending=true;return Promise.reject()}else{e._replotPending=false}c.supplyDefaults(e);var b=e._fullLayout;var x=b._has("cartesian");if(!b._has("polar")&&t&&t[0]&&t[0].r){o.log("Legacy polar charts are deprecated!");return P(e,t,i)}b._replotting=true;if(y)ee(e);if(e.framework!==ee){e.framework=ee;ee(e)}d.initGradients(e);if(y)v.saveShowSpikeInitial(e);var _=!e.calcdata||e.calcdata.length!==(e._fullData||[]).length;if(_)c.doCalcdata(e);for(var A=0;A<e.calcdata.length;A++){e.calcdata[A][0].trace=e._fullData[A]}var T=JSON.stringify(b._size);function k(){var t=b._basePlotModules;for(var r=0;r<t.length;r++){if(t[r].drawFramework){t[r].drawFramework(e)}}if(!b._glcanvas&&b._has("gl")){b._glcanvas=b._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:true,pick:false},{key:"focusLayer",context:false,pick:false},{key:"pickLayer",context:false,pick:true}],function(e){return e.key});b._glcanvas.enter().append("canvas").attr("class",function(e){return"gl-canvas gl-canvas-"+e.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"visible","pointer-events":"none"})}if(b._glcanvas){b._glcanvas.attr("width",b.width).attr("height",b.height)}return c.previousPromises(e)}function E(){var t=e.calcdata;var r,n,i;c.clearAutoMarginIds(e);M.drawMarginPushers(e);v.allowAutoMargin(e);for(r=0;r<t.length;r++){n=t[r];i=n[0].trace;var a=i._module.colorbar;if(i.visible!==true||!a){c.autoMargin(e,"cb"+i.uid)}else g(e,n,a)}c.doAutoMargin(e);return c.previousPromises(e)}function L(){if(JSON.stringify(b._size)===T)return;return o.syncOrAsync([E,M.layoutStyles],e)}function C(){if(!_){O();return}var t=b._subplots.cartesian;var r=b._modules;var n=[];var i,a,s;for(s=0;s<r.length;s++){o.pushUnique(n,r[s].setPositions)}if(n.length){for(a=0;a<t.length;a++){i=b._plots[t[a]];for(s=0;s<n.length;s++){n[s](e,i)}}}u.getComponentMethod("errorbars","calc")(e);return o.syncOrAsync([u.getComponentMethod("shapes","calcAutorange"),u.getComponentMethod("annotations","calcAutorange"),O,u.getComponentMethod("rangeslider","calcAutorange")],e)}function O(){if(e._transitioning)return;M.doAutoRangeAndConstraints(e);if(y)v.saveRangeInitial(e)}function R(){return v.doTicks(e,y?"":"redraw")}var N=[c.previousPromises,p,k,E,L];if(x)N.push(C);N.push(M.layoutStyles);if(x)N.push(R);N.push(M.drawData,M.finalDraw,m,c.addLinks,c.rehover,c.doAutoMargin,c.previousPromises);var z=o.syncOrAsync(N,e);if(!z||!z.then)z=Promise.resolve();return z.then(function(){S(e);return e})};function S(e){var t=e._fullLayout;if(t._redrawFromAutoMarginCount){t._redrawFromAutoMarginCount--}else{e.emit("plotly_afterplot")}}r.setPlotConfig=function e(t){return o.extendFlat(x,t)};function L(e,t){try{e._fullLayout._paper.style("background",t)}catch(e){o.error(e)}}function C(e,t){var r=p.combine(t,"white");L(e,r)}function I(e,t){if(!e._context)e._context=o.extendDeep({},x);var r=e._context;var n,i,s;if(t){i=Object.keys(t);for(n=0;n<i.length;n++){s=i[n];if(s==="editable"||s==="edits")continue;if(s in r){if(s==="setBackground"&&t[s]==="opaque"){r[s]=C}else{r[s]=t[s]}}}if(t.plot3dPixelRatio&&!r.plotGlPixelRatio){r.plotGlPixelRatio=r.plot3dPixelRatio}var l=t.editable;if(l!==undefined){r.editable=l;i=Object.keys(r.edits);for(n=0;n<i.length;n++){r.edits[i[n]]=l}}if(t.edits){i=Object.keys(t.edits);for(n=0;n<i.length;n++){s=i[n];if(s in r.edits){r.edits[s]=t.edits[s]}}}}if(r.staticPlot){r.editable=false;r.edits={};r.autosizable=false;r.scrollZoom=false;r.doubleClick=false;r.showTips=false;r.showLink=false;r.displayModeBar=false}if(r.displayModeBar==="hover"&&!a){r.displayModeBar=true}if(r.setBackground==="transparent"||typeof r.setBackground!=="function"){r.setBackground=L}}function P(e,t,r){var i=n.select(e).selectAll(".plot-container").data([0]);i.enter().insert("div",":first-child").classed("plot-container plotly",true);var a=i.selectAll(".svg-container").data([0]);a.enter().append("div").classed("svg-container",true).style("position","relative");a.html("");if(t)e.data=t;if(r)e.layout=r;h.manager.fillLayout(e);a.style({width:e._fullLayout.width+"px",height:e._fullLayout.height+"px"});e.framework=h.manager.framework(e);e.framework({data:e.data,layout:e.layout},a.node());e.framework.setUndoPoint();var s=e.framework.svg();var l=1;var u=e._fullLayout.title;if(u===""||!u)l=0;var f=function(){this.call(b.convertToTspans,e)};var v=s.select(".title-group text").call(f);if(e._context.edits.titleText){var d=o._(e,"Click to enter Plot title");if(!u||u===d){l=.2;v.attr({"data-unformatted":d}).text(d).style({opacity:l}).on("mouseover.opacity",function(){n.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){n.select(this).transition().duration(1e3).style("opacity",0)})}var p=function(){this.call(b.makeEditable,{gd:e}).on("edit",function(t){e.framework({layout:{title:t}});this.text(t).call(f);this.call(p)}).on("cancel",function(){var e=this.attr("data-unformatted");this.text(e).call(f)})};v.call(p)}e._context.setBackground(e,e._fullLayout.paper_bgcolor);c.addLinks(e);return Promise.resolve()}r.redraw=function(e){e=o.getGraphDiv(e);if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e)}w.cleanData(e.data);w.cleanLayout(e.layout);e.calcdata=undefined;return r.plot(e).then(function(){e.emit("plotly_redraw");return e})};r.newPlot=function(e,t,n,i){e=o.getGraphDiv(e);c.cleanPlot([],{},e._fullData||[],e._fullLayout||{},e.calcdata||[]);c.purge(e);return r.plot(e,t,n,i)};function O(e,t){var r=t+1,n=[],i,a;for(i=0;i<e.length;i++){a=e[i];if(a<0){n.push(r+a)}else{n.push(a)}}return n}function R(e,t,r){var n,i;for(n=0;n<t.length;n++){i=t[n];if(i!==parseInt(i,10)){throw new Error("all values in "+r+" must be integers")}if(i>=e.data.length||i<-e.data.length){throw new Error(r+" must be valid indices for gd.data.")}if(t.indexOf(i,n+1)>-1||i>=0&&t.indexOf(-e.data.length+i)>-1||i<0&&t.indexOf(e.data.length+i)>-1){throw new Error("each index in "+r+" must be unique.")}}}function N(e,t,r){if(!Array.isArray(e.data)){throw new Error("gd.data must be an array.")}if(typeof t==="undefined"){throw new Error("currentIndices is a required argument.")}else if(!Array.isArray(t)){t=[t]}R(e,t,"currentIndices");if(typeof r!=="undefined"&&!Array.isArray(r)){r=[r]}if(typeof r!=="undefined"){R(e,r,"newIndices")}if(typeof r!=="undefined"&&t.length!==r.length){throw new Error("current and new indices must be of equal length.")}}function z(e,t,r){var n,i;if(!Array.isArray(e.data)){throw new Error("gd.data must be an array.")}if(typeof t==="undefined"){throw new Error("traces must be defined.")}if(!Array.isArray(t)){t=[t]}for(n=0;n<t.length;n++){i=t[n];if(typeof i!=="object"||(Array.isArray(i)||i===null)){throw new Error("all values in traces array must be non-array objects")}}if(typeof r!=="undefined"&&!Array.isArray(r)){r=[r]}if(typeof r!=="undefined"&&r.length!==t.length){throw new Error("if indices is specified, traces.length must equal indices.length")}}function D(e,t,r,n){var i=o.isPlainObject(n);if(!Array.isArray(e.data)){throw new Error("gd.data must be an array")}if(!o.isPlainObject(t)){throw new Error("update must be a key:value object")}if(typeof r==="undefined"){throw new Error("indices must be an integer or array of integers")}R(e,r,"indices");for(var a in t){if(!Array.isArray(t[a])||t[a].length!==r.length){throw new Error("attribute "+a+" must be an array of length equal to indices array length")}if(i&&(!(a in n)||!Array.isArray(n[a])||n[a].length!==t[a].length)){throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 "+"corrispondence with the keys and number of traces in the update object")}}}function F(e,t,r,n){var a=o.isPlainObject(n),s=[];var l,u,f,c,h;if(!Array.isArray(r))r=[r];r=O(r,e.data.length-1);for(var v in t){for(var d=0;d<r.length;d++){l=e.data[r[d]];f=o.nestedProperty(l,v);u=f.get();c=t[v][d];if(!o.isArrayOrTypedArray(c)){throw new Error("attribute: "+v+" index: "+d+" must be an array")}if(!o.isArrayOrTypedArray(u)){throw new Error("cannot extend missing or non-array attribute: "+v)}if(u.constructor!==c.constructor){throw new Error("cannot extend array with an array of a different type: "+v)}h=a?n[v][d]:n;if(!i(h))h=-1;s.push({prop:f,target:u,insert:c,maxp:Math.floor(h)})}}return s}function j(e,t,r,n,i){D(e,t,r,n);var a=F(e,t,r,n);var o={};var s={};for(var l=0;l<a.length;l++){var u=a[l].prop;var f=a[l].maxp;var c=i(a[l].target,a[l].insert,f);u.set(c[0]);if(!Array.isArray(o[u.astr]))o[u.astr]=[];o[u.astr].push(c[1]);if(!Array.isArray(s[u.astr]))s[u.astr]=[];s[u.astr].push(a[l].target.length)}return{update:o,maxPoints:s}}function B(e,t){var r=new e.constructor(e.length+t.length);r.set(e);r.set(t,e.length);return r}r.extendTraces=function e(t,n,i,a){t=o.getGraphDiv(t);function s(e,t,r){var n,i;if(o.isTypedArray(e)){if(r<0){var a=new e.constructor(0);var s=B(e,t);if(r<0){n=s;i=a}else{n=a;i=s}}else{n=new e.constructor(r);i=new e.constructor(e.length+t.length-r);if(r===t.length){n.set(t);i.set(e)}else if(r<t.length){var l=t.length-r;n.set(t.subarray(l));i.set(e);i.set(t.subarray(0,l),e.length)}else{var u=r-t.length;var f=e.length-u;n.set(e.subarray(f));n.set(t,u);i.set(e.subarray(0,f))}}}else{n=e.concat(t);i=r>=0&&r<n.length?n.splice(0,n.length-r):[]}return[n,i]}var u=j(t,n,i,a,s);var f=r.redraw(t);var c=[t,u.update,i,u.maxPoints];l.add(t,r.prependTraces,c,e,arguments);return f};r.prependTraces=function e(t,n,i,a){t=o.getGraphDiv(t);function s(e,t,r){var n,i;if(o.isTypedArray(e)){if(r<=0){var a=new e.constructor(0);var s=B(t,e);if(r<0){n=s;i=a}else{n=a;i=s}}else{n=new e.constructor(r);i=new e.constructor(e.length+t.length-r);if(r===t.length){n.set(t);i.set(e)}else if(r<t.length){var l=t.length-r;n.set(t.subarray(0,l));i.set(t.subarray(l));i.set(e,l)}else{var u=r-t.length;n.set(t);n.set(e.subarray(0,u),t.length);i.set(e.subarray(u))}}}else{n=t.concat(e);i=r>=0&&r<n.length?n.splice(r,n.length):[]}return[n,i]}var u=j(t,n,i,a,s);var f=r.redraw(t);var c=[t,u.update,i,u.maxPoints];l.add(t,r.extendTraces,c,e,arguments);return f};r.addTraces=function e(t,n,i){t=o.getGraphDiv(t);var a=[],s=r.deleteTraces,u=e,f=[t,a],c=[t,n],h,v;z(t,n,i);if(!Array.isArray(n)){n=[n]}n=n.map(function(e){return o.extendFlat({},e)});w.cleanData(n);for(h=0;h<n.length;h++){t.data.push(n[h])}for(h=0;h<n.length;h++){a.push(-n.length+h)}if(typeof i==="undefined"){v=r.redraw(t);l.add(t,s,f,u,c);return v}if(!Array.isArray(i)){i=[i]}try{N(t,a,i)}catch(e){t.data.splice(t.data.length-n.length,n.length);throw e}l.startSequence(t);l.add(t,s,f,u,c);v=r.moveTraces(t,a,i);l.stopSequence(t);return v};r.deleteTraces=function e(t,n){t=o.getGraphDiv(t);var i=[],a=r.addTraces,s=e,u=[t,i,n],f=[t,n],c,h;if(typeof n==="undefined"){throw new Error("indices must be an integer or array of integers.")}else if(!Array.isArray(n)){n=[n]}R(t,n,"indices");n=O(n,t.data.length-1);n.sort(o.sorterDes);for(c=0;c<n.length;c+=1){h=t.data.splice(n[c],1)[0];i.push(h)}var v=r.redraw(t);l.add(t,a,u,s,f);return v};r.moveTraces=function e(t,n,i){t=o.getGraphDiv(t);var a=[],s=[],u=e,f=e,c=[t,i,n],h=[t,n,i],v;N(t,n,i);n=Array.isArray(n)?n:[n];if(typeof i==="undefined"){i=[];for(v=0;v<n.length;v++){i.push(-n.length+v)}}i=Array.isArray(i)?i:[i];n=O(n,t.data.length-1);i=O(i,t.data.length-1);for(v=0;v<t.data.length;v++){if(n.indexOf(v)===-1){a.push(t.data[v])}}for(v=0;v<n.length;v++){s.push({newIndex:i[v],trace:t.data[n[v]]})}s.sort(function(e,t){return e.newIndex-t.newIndex});for(v=0;v<s.length;v+=1){a.splice(s[v].newIndex,0,s[v].trace)}t.data=a;var d=r.redraw(t);l.add(t,u,c,f,h);return d};r.restyle=function e(t,n,i,a){t=o.getGraphDiv(t);w.clearPromiseQueue(t);var s={};if(typeof n==="string")s[n]=i;else if(o.isPlainObject(n)){s=o.extendFlat({},n);if(a===undefined)a=i}else{o.warn("Restyle fail.",n,i,a);return Promise.reject()}if(Object.keys(s).length)t.changed=true;var u=w.coerceTraceIndices(t,a);var f=V(t,s,u);var h=f.flags;if(h.clearCalc)t.calcdata=undefined;if(h.clearAxisTypes)w.clearAxisTypes(t,u,{});var v=[];if(h.fullReplot){v.push(r.plot)}else{v.push(c.previousPromises);c.supplyDefaults(t);if(h.style)v.push(M.doTraceStyle);if(h.colorbars)v.push(M.doColorBars);v.push(S)}v.push(c.rehover);l.add(t,e,[t,f.undoit,f.traces],e,[t,f.redoit,f.traces]);var d=o.syncOrAsync(v,t);if(!d||!d.then)d=Promise.resolve();return d.then(function(){t.emit("plotly_restyle",f.eventData);return t})};function U(e){if(e===undefined)return null;return e}function V(e,t,r){var n=e._fullLayout,i=e._fullData,a=e.data,s;var l=A.traceFlags();var h={},d={},p;function g(){return r.map(function(){return undefined})}function m(e){var t=v.id2name(e);if(p.indexOf(t)===-1)p.push(t)}function y(e){return"LAYOUT"+e+".autorange"}function b(e){return"LAYOUT"+e+".range"}function x(n,i,s){if(Array.isArray(n)){n.forEach(function(e){x(e,i,s)});return}if(n in t||w.hasParent(t,n))return;var l;if(n.substr(0,6)==="LAYOUT"){l=o.nestedProperty(e.layout,n.replace("LAYOUT",""))}else{l=o.nestedProperty(a[r[s]],n)}if(!(n in d)){d[n]=g()}if(d[n][s]===undefined){d[n][s]=U(l.get())}if(i!==undefined){l.set(i)}}for(var _ in t){if(w.hasParent(t,_)){throw new Error("cannot set "+_+"and a parent attribute simultaneously")}var M=t[_],T,k,E,S,L,C;h[_]=M;if(_.substr(0,6)==="LAYOUT"){E=o.nestedProperty(e.layout,_.replace("LAYOUT",""));d[_]=[U(E.get())];E.set(Array.isArray(M)?M[0]:M);l.calc=true;continue}d[_]=g();for(s=0;s<r.length;s++){T=a[r[s]];k=i[r[s]];E=o.nestedProperty(T,_);S=E.get();L=Array.isArray(M)?M[s%M.length]:M;if(L===undefined)continue;var I=E.parts[E.parts.length-1];var P=_.substr(0,_.length-I.length-1);var O=P?P+".":"";var R=P?o.nestedProperty(k,P).get():k;C=f.getTraceValObject(k,E.parts);if(C&&C.impliedEdits&&L!==null){for(var N in C.impliedEdits){x(o.relativeAttr(_,N),C.impliedEdits[N],s)}}else if((I==="thicknessmode"||I==="lenmode")&&S!==L&&(L==="fraction"||L==="pixels")&&R){var z=n._size;var D=R.orient;var F=D==="top"||D==="bottom";if(I==="thicknessmode"){var j=F?z.h:z.w;x(O+"thickness",R.thickness*(L==="fraction"?1/j:j),s)}else{var B=F?z.w:z.h;x(O+"len",R.len*(L==="fraction"?1/B:B),s)}}else if(_==="type"&&L==="pie"!==(S==="pie")){var V="x",H="y";if((L==="bar"||S==="bar")&&T.orientation==="h"){V="y";H="x"}o.swapAttrs(T,["?","?src"],"labels",V);o.swapAttrs(T,["d?","?0"],"label",V);o.swapAttrs(T,["?","?src"],"values",H);if(S==="pie"){o.nestedProperty(T,"marker.color").set(o.nestedProperty(T,"marker.colors").get());n._pielayer.selectAll("g.trace").remove()}else if(u.traceIs(T,"cartesian")){o.nestedProperty(T,"marker.colors").set(o.nestedProperty(T,"marker.color").get())}}d[_][s]=U(S);var q=["swapxy","swapxyaxes","orientation","orientationaxes"];if(q.indexOf(_)!==-1){if(_==="orientation"){E.set(L);var G=T.x&&!T.y?"h":"v";if((E.get()||G)===k.orientation){continue}}else if(_==="orientationaxes"){T.orientation={v:"h",h:"v"}[k.orientation]}w.swapXYData(T);l.calc=l.clearAxisTypes=true}else if(c.dataArrayContainers.indexOf(E.parts[0])!==-1){w.manageArrayContainers(E,L,d);l.calc=true}else{if(C){if(C.arrayOk&&(o.isArrayOrTypedArray(L)||o.isArrayOrTypedArray(S))){l.calc=true}else A.update(l,C)}else{l.calc=true}E.set(L)}}if(["swapxyaxes","orientationaxes"].indexOf(_)!==-1){v.swap(e,r)}if(_==="orientationaxes"){var W=o.nestedProperty(e.layout,"hovermode");if(W.get()==="x"){W.set("y")}else if(W.get()==="y"){W.set("x")}}if(["orientation","type"].indexOf(_)!==-1){p=[];for(s=0;s<r.length;s++){var X=a[r[s]];if(u.traceIs(X,"cartesian")){m(X.xaxis||"x");m(X.yaxis||"y");if(_==="type"){x(["autobinx","autobiny"],true,s)}}}x(p.map(y),true,0);x(p.map(b),[0,1],0)}}var Y=false;var Z=v.list(e);for(s=0;s<Z.length;s++){if(Z[s].autorange){Y=true;break}}if(l.calc||l.calcIfAutorange&&Y){l.clearCalc=true}if(l.calc||l.plot||l.calcIfAutorange){l.fullReplot=true}return{flags:l,undoit:d,redoit:h,traces:r,eventData:o.extendDeepNoArrays([],[h,r])}}r.relayout=function e(t,r,n){t=o.getGraphDiv(t);w.clearPromiseQueue(t);if(t.framework&&t.framework.isPolar){return Promise.resolve(t)}var i={};if(typeof r==="string"){i[r]=n}else if(o.isPlainObject(r)){i=o.extendFlat({},r)}else{o.warn("Relayout fail.",r,n);return Promise.reject()}if(Object.keys(i).length)t.changed=true;var a=X(t,i);var s=a.flags;if(s.calc)t.calcdata=undefined;var u=[c.previousPromises];if(s.layoutReplot){u.push(M.layoutReplot)}else if(Object.keys(i).length){c.supplyDefaults(t);if(s.legend)u.push(M.doLegend);if(s.layoutstyle)u.push(M.layoutStyles);if(s.axrange){H(u,a.rangesAltered)}if(s.ticks)u.push(M.doTicksRelayout);if(s.modebar)u.push(M.doModeBar);if(s.camera)u.push(M.doCamera);u.push(S)}u.push(c.rehover);l.add(t,e,[t,a.undoit],e,[t,a.redoit]);var f=o.syncOrAsync(u,t);if(!f||!f.then)f=Promise.resolve(t);return f.then(function(){t.emit("plotly_relayout",a.eventData);return t})};function H(e,t){var r=t?function(e){return M.doTicksRelayout(e,t)}:M.doTicksRelayout;e.push(r,M.drawData,M.finalDraw)}var q=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/;var G=/^[xyz]axis[0-9]*\.autorange$/;var W=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function X(e,t){var r=e.layout,n=e._fullLayout,i=Object.keys(t),a=v.list(e),s={},l,c,h;for(c=0;c<i.length;c++){if(i[c].indexOf("allaxes")===0){for(h=0;h<a.length;h++){var d=a[h]._id.substr(1),p=d.indexOf("scene")!==-1?d+".":"",g=i[c].replace("allaxes",p+a[h]._name);if(!t[g])t[g]=t[i[c]]}delete t[i[c]]}}var m=A.layoutFlags();var y={},b={};function x(e,n){if(Array.isArray(e)){e.forEach(function(e){x(e,n)});return}if(e in t||w.hasParent(t,e))return;var i=o.nestedProperty(r,e);if(!(e in b)){b[e]=U(i.get())}if(n!==undefined)i.set(n)}var M={};var k;function E(e){var t=v.name2id(e.split(".")[0]);M[t]=1;return t}for(var S in t){if(w.hasParent(t,S)){throw new Error("cannot set "+S+"and a parent attribute simultaneously")}var L=o.nestedProperty(r,S);var C=t[S];var I=L.parts.length;var P=I-1;while(P>0&&typeof L.parts[P]!=="string")P--;var O=L.parts[P];var R=L.parts[P-1]+"."+O;var N=L.parts.slice(0,P).join(".");var z=o.nestedProperty(e.layout,N).get();var D=o.nestedProperty(n,N).get();var F=L.get();if(C===undefined)continue;y[S]=C;b[S]=O==="reverse"?C:U(F);var j=f.getLayoutValObject(n,L.parts);if(j&&j.impliedEdits&&C!==null){for(var B in j.impliedEdits){x(o.relativeAttr(S,B),j.impliedEdits[B])}}if(["width","height"].indexOf(S)!==-1&&C===null){n[S]=e._initialAutoSize[S]}else if(R.match(q)){E(R);o.nestedProperty(n,N+"._inputRange").set(null)}else if(R.match(G)){E(R);o.nestedProperty(n,N+"._inputRange").set(null);var V=o.nestedProperty(n,N).get();if(V._inputDomain){V._input.domain=V._inputDomain.slice()}}else if(R.match(W)){o.nestedProperty(n,N+"._inputDomain").set(null)}if(O==="type"){var H=z,X=D.type==="linear"&&C==="log",Q=D.type==="log"&&C==="linear";if(X||Q){if(!H||!H.range){x(N+".autorange",true)}else if(!D.autorange){var K=H.range[0],J=H.range[1];if(X){if(K<=0&&J<=0){x(N+".autorange",true)}if(K<=0)K=J/1e6;else if(J<=0)J=K/1e6;x(N+".range[0]",Math.log(K)/Math.LN10);x(N+".range[1]",Math.log(J)/Math.LN10)}else{x(N+".range[0]",Math.pow(10,K));x(N+".range[1]",Math.pow(10,J))}}else if(X){H.range=H.range[1]>H.range[0]?[1,2]:[2,1]}if(Array.isArray(n._subplots.polar)&&n._subplots.polar.length&&n[L.parts[0]]&&L.parts[1]==="radialaxis"){delete n[L.parts[0]]._subplot.viewInitial["radialaxis.range"]}u.getComponentMethod("annotations","convertCoords")(e,D,C,x);u.getComponentMethod("images","convertCoords")(e,D,C,x)}else{x(N+".autorange",true);x(N+".range",null)}o.nestedProperty(n,N+"._inputRange").set(null)}else if(O.match(T)){var $=o.nestedProperty(n,S).get(),ee=(C||{}).type;if(!ee||ee==="-")ee="linear";u.getComponentMethod("annotations","convertCoords")(e,$,ee,x);u.getComponentMethod("images","convertCoords")(e,$,ee,x)}var te=_.containerArrayMatch(S);if(te){l=te.array;c=te.index;var re=te.property;var ne=o.nestedProperty(r,l);var ie=(ne||[])[c]||{};var ae=ie;var oe=j||{editType:"calc"};var se=oe.editType.indexOf("calcIfAutorange")!==-1;if(c===""){if(se)m.calc=true;else A.update(m,oe);se=false}else if(re===""){ae=C;if(_.isAddVal(C)){b[S]=null}else if(_.isRemoveVal(C)){b[S]=ie;ae=ie}else o.warn("unrecognized full object value",t)}if(se&&(Z(e,ae,"x")||Z(e,ae,"y"))){m.calc=true}else{A.update(m,oe)}if(!s[l])s[l]={};var le=s[l][c];if(!le)le=s[l][c]={};le[re]=C;delete t[S]}else if(O==="reverse"){if(z.range)z.range.reverse();else{x(N+".autorange",true);z.range=[1,0]}if(D.autorange)m.calc=true;else m.plot=true}else{if(n._has("scatter-like")&&n._has("regl")&&(S==="dragmode"&&(C==="lasso"||C==="select")&&!(F==="lasso"||F==="select"))){m.plot=true}else if(j)A.update(m,j);else m.calc=true;L.set(C)}}for(l in s){var ue=_.applyContainerArrayChanges(e,o.nestedProperty(r,l),s[l],m);if(!ue)m.plot=true}var fe=n._axisConstraintGroups||[];for(k in M){for(c=0;c<fe.length;c++){var ce=fe[c];if(ce[k]){m.calc=true;for(var he in ce){if(!M[he]){v.getFromId(e,he)._constraintShrinkable=true}}}}}if(Y(e)||t.height||t.width)m.plot=true;if(m.plot||m.calc){m.layoutReplot=true}return{flags:m,rangesAltered:M,undoit:b,redoit:y,eventData:o.extendDeep({},y)}}function Y(e){var t=e._fullLayout;var r=t.width;var n=t.height;if(e.layout.autosize)c.plotAutoSize(e,e.layout,t);return t.width!==r||t.height!==n}function Z(e,t,r){if(!o.isPlainObject(t))return false;var n=t[r+"ref"]||r,i=v.getFromId(e,n);if(!i&&n.charAt(0)===r){i=v.getFromId(e,r)}return(i||{}).autorange}r.update=function e(t,n,i,a){t=o.getGraphDiv(t);w.clearPromiseQueue(t);if(t.framework&&t.framework.isPolar){return Promise.resolve(t)}if(!o.isPlainObject(n))n={};if(!o.isPlainObject(i))i={};if(Object.keys(n).length)t.changed=true;if(Object.keys(i).length)t.changed=true;var s=w.coerceTraceIndices(t,a);var u=V(t,o.extendFlat({},n),s);var f=u.flags;var h=X(t,o.extendFlat({},i));var v=h.flags;if(f.clearCalc||v.calc)t.calcdata=undefined;if(f.clearAxisTypes)w.clearAxisTypes(t,s,i);var d=[];if(f.fullReplot&&v.layoutReplot){var p=t.data,g=t.layout;t.data=undefined;t.layout=undefined;d.push(function(){return r.plot(t,p,g)})}else if(f.fullReplot){d.push(r.plot)}else if(v.layoutReplot){d.push(M.layoutReplot)}else{d.push(c.previousPromises);c.supplyDefaults(t);if(f.style)d.push(M.doTraceStyle);if(f.colorbars)d.push(M.doColorBars);if(v.legend)d.push(M.doLegend);if(v.layoutstyle)d.push(M.layoutStyles);if(v.axrange){H(d,h.rangesAltered)}if(v.ticks)d.push(M.doTicksRelayout);if(v.modebar)d.push(M.doModeBar);if(v.camera)d.push(M.doCamera);d.push(S)}d.push(c.rehover);l.add(t,e,[t,u.undoit,h.undoit,u.traces],e,[t,u.redoit,h.redoit,u.traces]);var m=o.syncOrAsync(d,t);if(!m||!m.then)m=Promise.resolve(t);return m.then(function(){t.emit("plotly_update",{data:u.eventData,layout:h.eventData});return t})};r.react=function(e,t,n,i){var a,s;function l(){return r.addFrames(e,a)}e=o.getGraphDiv(e);var f=e._fullData;var h=e._fullLayout;if(!o.isPlotDiv(e)||!f||!h){s=r.newPlot(e,t,n,i)}else{if(o.isPlainObject(t)){var v=t;t=v.data;n=v.layout;i=v.config;a=v.frames}var d=false;if(i){var p=o.extendDeep({},e._context);e._context=undefined;I(e,i);d=$(p,e._context)}e.data=t||[];w.cleanData(e.data);e.layout=n||{};w.cleanLayout(e.layout);c.supplyDefaults(e,{skipUpdateCalc:true});var g=e._fullData;var m=e._fullLayout;var y=m.datarevision===undefined;var b=Q(e,f,g,y);var x=K(e,h,m,y);if(Y(e))x.layoutReplot=true;if(b.calc||x.calc)e.calcdata=undefined;else c.supplyDefaultsUpdateCalc(e.calcdata,g);var _=[];if(a){e._transitionData={};c.createTransitionData(e);_.push(l)}if(b.fullReplot||x.layoutReplot||d){e._fullLayout._skipDefaults=true;_.push(r.plot)}else{for(var A in x.arrays){var T=x.arrays[A];if(T.length){var k=u.getComponentMethod(A,"drawOne");if(k!==o.noop){for(var E=0;E<T.length;E++){k(e,T[E])}}else{var L=u.getComponentMethod(A,"draw");if(L===o.noop){throw new Error("cannot draw components: "+A)}L(e)}}}_.push(c.previousPromises);if(b.style)_.push(M.doTraceStyle);if(b.colorbars)_.push(M.doColorBars);if(x.legend)_.push(M.doLegend);if(x.layoutstyle)_.push(M.layoutStyles);if(x.axrange)H(_);if(x.ticks)_.push(M.doTicksRelayout);if(x.modebar)_.push(M.doModeBar);if(x.camera)_.push(M.doCamera);_.push(S)}_.push(c.rehover);s=o.syncOrAsync(_,e);if(!s||!s.then)s=Promise.resolve(e)}return s.then(function(){e.emit("plotly_react",{data:t,layout:n});return e})};function Q(e,t,r,n){if(t.length!==r.length){return{fullReplot:true,calc:true}}var i=A.traceFlags();i.arrays={};var a,o;function s(e){return f.getTraceValObject(o,e)}var l={getValObject:s,flags:i,immutable:n,gd:e};var u={};for(a=0;a<t.length;a++){o=r[a]._fullInput;if(u[o.uid])continue;u[o.uid]=1;l.autoranged=o.xaxis?v.getFromId(e,o.xaxis).autorange||v.getFromId(e,o.yaxis).autorange:false;J(t[a]._fullInput,o,[],l)}if(i.calc||i.plot||i.calcIfAutorange){i.fullReplot=true}return i}function K(e,t,r,n){var i=A.layoutFlags();i.arrays={};function a(e){return f.getLayoutValObject(r,e)}var o={getValObject:a,flags:i,immutable:n,gd:e};J(t,r,[],o);if(i.plot||i.calc){i.layoutReplot=true}return i}function J(e,t,r,n){var i,a;var s=n.getValObject;var l=n.flags;var u=n.immutable;var f=n.inArray;var c=n.arrayIndex;var h=n.gd;var v=n.autoranged;function d(){var e=i.editType;if(e.indexOf("calcIfAutorange")!==-1&&(v||v===undefined&&(Z(h,t,"x")||Z(h,t,"y")))){l.calc=true;return}if(f&&e.indexOf("arraydraw")!==-1){o.pushUnique(l.arrays[f],c);return}A.update(l,i)}function p(e){return e.valType==="data_array"||e.arrayOk}for(a in e){if(l.calc)return;var g=e[a];var m=t[a];if(a.charAt(0)==="_"||typeof g==="function"||g===m)continue;if(a==="tick0"||a==="dtick"){var y=t.tickmode;if(y==="auto"||y==="array"||!y)continue}if(a==="range"&&t.autorange)continue;if((a==="zmin"||a==="zmax")&&t.type==="contourcarpet")continue;var b=r.concat(a);i=s(b);if(!i)continue;if(i._compareAsJSON&&JSON.stringify(g)===JSON.stringify(m))continue;var x=i.valType;var _;var w=p(i);var M=Array.isArray(g);var T=Array.isArray(m);if(M&&T){var k="_input_"+a;var E=e[k];var S=t[k];if(Array.isArray(E)&&E===S)continue}if(m===undefined){if(w&&M)l.calc=true;else d()}else if(i._isLinkedToArray){var L=[];var C=false;if(!f)l.arrays[a]=L;var I=Math.min(g.length,m.length);var P=Math.max(g.length,m.length);if(I!==P){if(i.editType==="arraydraw"){C=true}else{d();continue}}for(_=0;_<I;_++){J(g[_],m[_],b.concat(_),o.extendFlat({inArray:a,arrayIndex:_},n))}if(C){for(_=I;_<P;_++){L.push(_)}}}else if(!x&&o.isPlainObject(g)){J(g,m,b,n)}else if(w){if(M&&T){if(u){l.calc=true}}else if(M!==T){l.calc=true}else d()}else if(M&&T){if(g.length!==m.length||String(g)!==String(m)){d()}}else{d()}}for(a in t){if(!(a in e||a.charAt(0)==="_"||typeof t[a]==="function")){i=s(r.concat(a));if(p(i)&&Array.isArray(t[a])){l.calc=true;return}else d()}}}function $(e,t){var r;for(r in e){var n=e[r];var i=t[r];if(n!==i){if(o.isPlainObject(n)&&o.isPlainObject(i)){if($(n,i)){return true}}else if(Array.isArray(n)&&Array.isArray(i)){if(n.length!==i.length){return true}for(var a=0;a<n.length;a++){if(n[a]!==i[a]){if(o.isPlainObject(n[a])&&o.isPlainObject(i[a])){if($(n[a],i[a])){return true}}else{return true}}}}else{return true}}}}r.animate=function(e,t,r){e=o.getGraphDiv(e);if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed "+"to create a plot before animating it. For more details, see "+"https://plot.ly/javascript/animations/")}var n=e._transitionData;if(!n._frameQueue){n._frameQueue=[]}r=c.supplyAnimationDefaults(r);var i=r.transition;var a=r.frame;if(n._frameWaitingCnt===undefined){n._frameWaitingCnt=0}function s(e){if(Array.isArray(i)){if(e>=i.length){return i[0]}else{return i[e]}}else{return i}}function l(e){if(Array.isArray(a)){if(e>=a.length){return a[0]}else{return a[e]}}else{return a}}function u(e,t){var r=0;return function(){if(e&&++r===t){return e()}}}return new Promise(function(a,f){function h(){if(n._frameQueue.length===0){return}while(n._frameQueue.length){var t=n._frameQueue.pop();if(t.onInterrupt){t.onInterrupt()}}e.emit("plotly_animationinterrupted",[])}function v(t){if(t.length===0)return;for(var i=0;i<t.length;i++){var o;if(t[i].type==="byname"){o=c.computeFrame(e,t[i].name)}else{o=t[i].data}var h=l(i);var v=s(i);v.duration=Math.min(v.duration,h.duration);var d={frame:o,name:t[i].name,frameOpts:h,transitionOpts:v};if(i===t.length-1){d.onComplete=u(a,2);d.onInterrupt=f}n._frameQueue.push(d)}if(r.mode==="immediate"){n._lastFrameAt=-Infinity}if(!n._animationRaf){g()}}function d(){e.emit("plotly_animated");window.cancelAnimationFrame(n._animationRaf);n._animationRaf=null}function p(){if(n._currentFrame&&n._currentFrame.onComplete){n._currentFrame.onComplete()}var t=n._currentFrame=n._frameQueue.shift();if(t){var r=t.name?t.name.toString():null;e._fullLayout._currentFrame=r;n._lastFrameAt=Date.now();n._timeToNext=t.frameOpts.duration;c.transition(e,t.frame.data,t.frame.layout,w.coerceTraceIndices(e,t.frame.traces),t.frameOpts,t.transitionOpts).then(function(){if(t.onComplete){t.onComplete()}});e.emit("plotly_animatingframe",{name:r,frame:t.frame,animation:{frame:t.frameOpts,transition:t.transitionOpts}})}else{d()}}function g(){e.emit("plotly_animating");n._lastFrameAt=-Infinity;n._timeToNext=0;n._runningTransitions=0;n._currentFrame=null;var t=function(){n._animationRaf=window.requestAnimationFrame(t);if(Date.now()-n._lastFrameAt>n._timeToNext){p()}};t()}var m=0;function y(e){if(Array.isArray(i)){if(m>=i.length){e.transitionOpts=i[m]}else{e.transitionOpts=i[0]}}else{e.transitionOpts=i}m++;return e}var b,x;var _=[];var M=t===undefined||t===null;var A=Array.isArray(t);var T=!M&&!A&&o.isPlainObject(t);if(T){_.push({type:"object",data:y(o.extendFlat({},t))})}else if(M||["string","number"].indexOf(typeof t)!==-1){for(b=0;b<n._frames.length;b++){x=n._frames[b];if(!x)continue;if(M||String(x.group)===String(t)){_.push({type:"byname",name:String(x.name),data:y({name:x.name})})}}}else if(A){for(b=0;b<t.length;b++){var k=t[b];if(["number","string"].indexOf(typeof k)!==-1){k=String(k);_.push({type:"byname",name:k,data:y({name:k})})}else if(o.isPlainObject(k)){_.push({type:"object",data:y(o.extendFlat({},k))})}}}for(b=0;b<_.length;b++){x=_[b];if(x.type==="byname"&&!n._frameHash[x.data.name]){o.warn('animate failure: frame not found: "'+x.data.name+'"');f();return}}if(["next","immediate"].indexOf(r.mode)!==-1){h()}if(r.direction==="reverse"){_.reverse()}var E=e._fullLayout._currentFrame;if(E&&r.fromcurrent){var S=-1;for(b=0;b<_.length;b++){x=_[b];if(x.type==="byname"&&x.name===E){S=b;break}}if(S>0&&S<_.length-1){var L=[];for(b=0;b<_.length;b++){x=_[b];if(_[b].type!=="byname"||b>S){L.push(x)}}_=L}}if(_.length>0){v(_)}else{e.emit("plotly_animated");a()}})};r.addFrames=function(e,t,r){e=o.getGraphDiv(e);if(t===null||t===undefined){return Promise.resolve()}if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed "+"to create a plot before adding frames. For more details, see "+"https://plot.ly/javascript/animations/")}var n,i,a,s;var u=e._transitionData._frames;var f=e._transitionData._frameHash;if(!Array.isArray(t)){throw new Error("addFrames failure: frameList must be an Array of frame definitions"+t)}var h=u.length+t.length*2;var v=[];var d={};for(n=t.length-1;n>=0;n--){if(!o.isPlainObject(t[n]))continue;var p=t[n].name;var g=(f[p]||d[p]||{}).name;var m=t[n].name;var y=f[g]||d[g];if(g&&m&&typeof m==="number"&&y&&k<E){k++;o.warn('addFrames: overwriting frame "'+(f[g]||d[g]).name+'" with a frame whose name of type "number" also equates to "'+g+'". This is valid but may potentially lead to unexpected '+"behavior since all plotly.js frame names are stored internally "+"as strings.");if(k===E){o.warn("addFrames: This API call has yielded too many of these warnings. "+"For the rest of this call, further warnings about numeric frame "+"names will be suppressed.")}}d[p]={name:p};v.push({frame:c.supplyFrameDefaults(t[n]),index:r&&r[n]!==undefined&&r[n]!==null?r[n]:h+n})}v.sort(function(e,t){if(e.index>t.index)return-1;if(e.index<t.index)return 1;return 0});var b=[];var x=[];var _=u.length;for(n=v.length-1;n>=0;n--){i=v[n].frame;if(typeof i.name==="number"){o.warn("Warning: addFrames accepts frames with numeric names, but the numbers are"+"implicitly cast to strings")}if(!i.name){while(f[i.name="frame "+e._transitionData._counter++]);}if(f[i.name]){for(a=0;a<u.length;a++){if((u[a]||{}).name===i.name)break}b.push({type:"replace",index:a,value:i});x.unshift({type:"replace",index:a,value:u[a]})}else{s=Math.max(0,Math.min(v[n].index,_));b.push({type:"insert",index:s,value:i});x.unshift({type:"delete",index:s});_++}}var w=c.modifyFrames,M=c.modifyFrames,A=[e,x],T=[e,b];if(l)l.add(e,w,A,M,T);return c.modifyFrames(e,b)};r.deleteFrames=function(e,t){e=o.getGraphDiv(e);if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e)}var r,n;var i=e._transitionData._frames;var a=[];var s=[];if(!t){t=[];for(r=0;r<i.length;r++){t.push(r)}}t=t.slice(0);t.sort();for(r=t.length-1;r>=0;r--){n=t[r];a.push({type:"delete",index:n});s.unshift({type:"insert",index:n,value:i[n]})}var u=c.modifyFrames,f=c.modifyFrames,h=[e,s],v=[e,a];if(l)l.add(e,u,h,f,v);return c.modifyFrames(e,a)};r.purge=function e(t){t=o.getGraphDiv(t);var r=t._fullLayout||{};var n=t._fullData||[];var i=t.calcdata||[];c.cleanPlot([],{},n,r,i);c.purge(t);s.purge(t);if(r._container)r._container.remove();delete t._context;return t};function ee(e){var t=n.select(e);var r=e._fullLayout;r._container=t.selectAll(".plot-container").data([0]);r._container.enter().insert("div",":first-child").classed("plot-container",true).classed("plotly",true);r._paperdiv=r._container.selectAll(".svg-container").data([0]);r._paperdiv.enter().append("div").classed("svg-container",true).style("position","relative");r._glcontainer=r._paperdiv.selectAll(".gl-container").data([{}]);r._glcontainer.enter().append("div").classed("gl-container",true);r._glcanvas=null;r._paperdiv.selectAll(".main-svg").remove();r._paper=r._paperdiv.insert("svg",":first-child").classed("main-svg",true);r._toppaper=r._paperdiv.append("svg").classed("main-svg",true);if(!r._uid){var i={};n.selectAll("defs").each(function(){if(this.id)i[this.id.split("-")[1]]=1});r._uid=o.randstr(i)}r._paperdiv.selectAll(".main-svg").attr(y.svgAttrs);r._defs=r._paper.append("defs").attr("id","defs-"+r._uid);r._clips=r._defs.append("g").classed("clips",true);r._topdefs=r._toppaper.append("defs").attr("id","topdefs-"+r._uid);r._topclips=r._topdefs.append("g").classed("clips",true);r._bgLayer=r._paper.append("g").classed("bglayer",true);r._draggers=r._paper.append("g").classed("draglayer",true);var a=r._paper.append("g").classed("layer-below",true);r._imageLowerLayer=a.append("g").classed("imagelayer",true);r._shapeLowerLayer=a.append("g").classed("shapelayer",true);r._cartesianlayer=r._paper.append("g").classed("cartesianlayer",true);r._polarlayer=r._paper.append("g").classed("polarlayer",true);r._ternarylayer=r._paper.append("g").classed("ternarylayer",true);r._geolayer=r._paper.append("g").classed("geolayer",true);r._pielayer=r._paper.append("g").classed("pielayer",true);r._glimages=r._paper.append("g").classed("glimages",true);var s=r._toppaper.append("g").classed("layer-above",true);r._imageUpperLayer=s.append("g").classed("imagelayer",true);r._shapeUpperLayer=s.append("g").classed("shapelayer",true);r._infolayer=r._toppaper.append("g").classed("infolayer",true);r._menulayer=r._toppaper.append("g").classed("menulayer",true);r._zoomlayer=r._toppaper.append("g").classed("zoomlayer",true);r._hoverlayer=r._toppaper.append("g").classed("hoverlayer",true);e.emit("plotly_framework")}},{"../components/color":361,"../components/colorbar/connect":363,"../components/drawing":386,"../constants/xmlns_namespaces":465,"../lib":483,"../lib/events":474,"../lib/queue":497,"../lib/svg_text_utils":506,"../plots/cartesian/axes":529,"../plots/cartesian/constants":534,"../plots/cartesian/graph_interact":538,"../plots/plots":573,"../plots/polar/legacy":576,"../registry":582,"./edit_types":512,"./helpers":513,"./manage_arrays":515,"./plot_config":517,"./plot_schema":518,"./subroutines":520,d3:81,"fast-isnumeric":91,"has-hover":236}],517:[function(e,t,r){"use strict";t.exports={staticPlot:false,plotlyServerURL:"https://plot.ly",editable:false,edits:{annotationPosition:false,annotationTail:false,annotationText:false,axisTitleText:false,colorbarPosition:false,colorbarTitleText:false,legendPosition:false,legendText:false,shapePosition:false,titleText:false},autosizable:false,queueLength:0,fillFrame:false,frameMargins:0,scrollZoom:false,doubleClick:"reset+autosize",showTips:true,showAxisDragHandles:true,showAxisRangeEntryBoxes:true,showLink:false,sendData:true,linkText:"Edit chart",showSources:false,displayModeBar:"hover",modeBarButtonsToRemove:[],modeBarButtonsToAdd:[],modeBarButtons:false,toImageButtonOptions:{},displaylogo:true,plotGlPixelRatio:2,setBackground:"transparent",topojsonURL:"https://cdn.plot.ly/",mapboxAccessToken:null,logging:1,globalTransforms:[],locale:"en-US",locales:{}}},{}],518:[function(e,t,r){"use strict";var n=e("../registry");var i=e("../lib");var a=e("../plots/attributes");var o=e("../plots/layout_attributes");var s=e("../plots/frame_attributes");var l=e("../plots/animation_attributes");var u=e("../plots/polar/legacy/area_attributes");var f=e("../plots/polar/legacy/axis_attributes");var c=e("./edit_types");var h=i.extendFlat;var v=i.extendDeepAll;var d=i.isPlainObject;var p="_isSubplotObj";var g="_isLinkedToArray";var m="_arrayAttrRegexps";var y="_deprecated";var b=[p,g,m,y];r.IS_SUBPLOT_OBJ=p;r.IS_LINKED_TO_ARRAY=g;r.DEPRECATED=y;r.UNDERSCORE_ATTRS=b;r.get=function(){var e={};n.allTypes.concat("area").forEach(function(t){e[t]=M(t)});var t={};Object.keys(n.transformsRegistry).forEach(function(e){t[e]=T(e)});return{defs:{valObjects:i.valObjectMeta,metaKeys:b.concat(["description","role","editType","impliedEdits"]),editType:{traces:c.traces,layout:c.layout},impliedEdits:{}},traces:e,layout:A(),transforms:t,frames:k(),animation:E(l)}};r.crawl=function(e,t,n,i){var a=n||0;i=i||"";Object.keys(e).forEach(function(n){var o=e[n];if(b.indexOf(n)!==-1)return;var s=(i?i+".":"")+n;t(o,n,e,a,s);if(r.isValObject(o))return;if(d(o)&&n!=="impliedEdits"){r.crawl(o,t,a+1,s)}})};r.isValObject=function(e){return e&&e.valType!==undefined};r.findArrayAttributes=function(e){var t=[];var n=[];var o=[];var s,l;function u(e,t,r,i){n=n.slice(0,i).concat([t]);o=o.slice(0,i).concat([e&&e._isLinkedToArray]);var a=e&&(e.valType==="data_array"||e.arrayOk===true)&&!(n[i-1]==="colorbar"&&(t==="ticktext"||t==="tickvals"));if(!a)return;f(s,0,"")}function f(e,r,a){var s=e[n[r]];var u=a+n[r];if(r===n.length-1){if(i.isArrayOrTypedArray(s)){t.push(l+u)}}else{if(o[r]){if(Array.isArray(s)){for(var c=0;c<s.length;c++){if(i.isPlainObject(s[c])){f(s[c],r+1,u+"["+c+"].")}}}}else if(i.isPlainObject(s)){f(s,r+1,u+".")}}}s=e;l="";r.crawl(a,u);if(e._module&&e._module.attributes){r.crawl(e._module.attributes,u)}var c=e.transforms;if(c){for(var h=0;h<c.length;h++){var v=c[h];var d=v._module;if(d){l="transforms["+h+"].";s=v;r.crawl(d.attributes,u)}}}return t};r.getTraceValObject=function(e,t){var r=t[0];var i=1;var o,s;if(r==="transforms"){if(t.length===1){return a.transforms}var l=e.transforms;if(!Array.isArray(l)||!l.length)return false;var f=t[1];if(!w(f)||f>=l.length){return false}o=(n.transformsRegistry[l[f].type]||{}).attributes;s=o&&o[t[2]];i=3}else if(e.type==="area"){s=u[r]}else{var c=e._module;if(!c)c=(n.modules[e.type||a.type.dflt]||{})._module;if(!c)return false;o=c.attributes;s=o&&o[r];if(!s){var h=c.basePlotModule;if(h&&h.attributes){s=h.attributes[r]}}if(!s)s=a[r]}return _(s,t,i)};r.getLayoutValObject=function(e,t){var r=x(e,t[0]);return _(r,t,1)};function x(e,t){var r,i,a,s;var l=e._basePlotModules;if(l){var u;for(r=0;r<l.length;r++){a=l[r];if(a.attrRegex&&a.attrRegex.test(t)){if(a.layoutAttrOverrides)return a.layoutAttrOverrides;if(!u&&a.layoutAttributes)u=a.layoutAttributes}var c=a.baseLayoutAttrOverrides;if(c&&t in c)return c[t]}if(u)return u}var h=e._modules;if(h){for(r=0;r<h.length;r++){s=h[r].layoutAttributes;if(s&&t in s){return s[t]}}}for(i in n.componentsRegistry){a=n.componentsRegistry[i];if(!a.schema&&t===a.name){return a.layoutAttributes}}if(t in o)return o[t];if(t==="radialaxis"||t==="angularaxis"){return f[t]}return f.layout[t]||false}function _(e,t,r){if(!e)return false;if(e._isLinkedToArray){if(w(t[r]))r++;else if(r<t.length)return false}for(;r<t.length;r++){var n=e[t[r]];if(d(n))e=n;else break;if(r===t.length-1)break;if(e._isLinkedToArray){r++;if(!w(t[r]))return false}else if(e.valType==="info_array"){r++;var i=t[r];if(!w(i))return false;var a=e.items;if(Array.isArray(a)){if(i>=a.length)return false;if(e.dimensions===2){r++;if(t.length===r)return e;var o=t[r];if(!w(o))return false;e=a[i][o]}else e=a[i]}else{e=a}}}return e}function w(e){return e===Math.round(e)&&e>=0}function M(e){var t,r;if(e==="area"){t={attributes:u};r={}}else{t=n.modules[e]._module,r=t.basePlotModule}var i={};i.type=null;v(i,a);v(i,t.attributes);if(r.attributes){v(i,r.attributes)}i.type=e;var o={meta:t.meta||{},attributes:E(i)};if(t.layoutAttributes){var s={};v(s,t.layoutAttributes);o.layoutAttributes=E(s)}return o}function A(){var e={};var t,r;v(e,o);for(t in n.subplotsRegistry){r=n.subplotsRegistry[t];if(!r.layoutAttributes)continue;if(Array.isArray(r.attr)){for(var i=0;i<r.attr.length;i++){P(e,r,r.attr[i])}}else{var a=r.attr==="subplot"?r.name:r.attr;P(e,r,a)}}e=I(e);for(t in n.componentsRegistry){r=n.componentsRegistry[t];var s=r.schema;if(s&&(s.subplots||s.layout)){var l=s.subplots;if(l&&l.xaxis&&!l.yaxis){for(var u in l.xaxis)delete e.yaxis[u]}}else if(r.layoutAttributes){O(e,r.layoutAttributes,r.name)}}return{layoutAttributes:E(e)}}function T(e){var t=n.transformsRegistry[e];var r=v({},t.attributes);Object.keys(n.componentsRegistry).forEach(function(t){var i=n.componentsRegistry[t];if(i.schema&&i.schema.transforms&&i.schema.transforms[e]){Object.keys(i.schema.transforms[e]).forEach(function(t){O(r,i.schema.transforms[e][t],t)})}});return{attributes:E(r)}}function k(){var e={frames:i.extendDeepAll({},s)};E(e);return e.frames}function E(e){S(e);L(e);C(e);return e}function S(e){function t(e){return{valType:"string",editType:"none"}}function n(e,n,i){if(r.isValObject(e)){if(e.valType==="data_array"){e.role="data";i[n+"src"]=t(n)}else if(e.arrayOk===true){i[n+"src"]=t(n)}}else if(d(e)){e.role="object"}}r.crawl(e,n)}function L(e){function t(e,t,r){if(!e)return;var n=e[g];if(!n)return;delete e[g];r[t]={items:{}};r[t].items[n]=e;r[t].role="object"}r.crawl(e,t)}function C(e){function t(e){for(var r in e){if(d(e[r])){t(e[r])}else if(Array.isArray(e[r])){for(var n=0;n<e[r].length;n++){t(e[r][n])}}else{if(e[r]instanceof RegExp){e[r]=e[r].toString()}}}}t(e)}function I(e){h(e,{radialaxis:f.radialaxis,angularaxis:f.angularaxis});h(e,f.layout);return e}function P(e,t,r){var n=i.nestedProperty(e,r),a=v({},t.layoutAttributes);a[p]=true;n.set(a)}function O(e,t,r){var n=i.nestedProperty(e,r);n.set(v(n.get()||{},t))}},{"../lib":483,"../plots/animation_attributes":524,"../plots/attributes":526,"../plots/frame_attributes":556,"../plots/layout_attributes":571,"../plots/polar/legacy/area_attributes":574,"../plots/polar/legacy/axis_attributes":575,"../registry":582,"./edit_types":512}],519:[function(e,t,r){"use strict";var n=e("../lib");var i=e("../plots/attributes");var a="templateitemname";var o={name:{valType:"string",editType:"none"}};o[a]={valType:"string",editType:"calc"};r.templatedArray=function(e,t){t._isLinkedToArray=e;t.name=o.name;t[a]=o[a];return t};r.traceTemplater=function(e){var t={};var r,a;for(r in e){a=e[r];if(Array.isArray(a)&&a.length){t[r]=0}}function o(o){r=n.coerce(o,{},i,"type");var s={type:r,_template:null};if(r in t){a=e[r];var l=t[r]%a.length;t[r]++;s._template=a[l]}else{}return s}return{newTrace:o}};r.newContainer=function(e,t,r){var i=e._template;var a=i&&(i[t]||r&&i[r]);if(!n.isPlainObject(a))a=null;var o=e[t]={_template:a};return o};r.arrayTemplater=function(e,t,r){var n=e._template;var i=n&&n[l(t)];var o=n&&n[t];if(!Array.isArray(o)||!o.length){o=[]}var u={};function f(e){var t={name:e.name,_input:e};var n=t[a]=e[a];if(!s(n)){t._template=i;return t}for(var l=0;l<o.length;l++){var f=o[l];if(f.name===n){u[n]=1;t._template=f;return t}}t[r]=e[r]||false;t._template=false;return t}function c(){var e=[];for(var t=0;t<o.length;t++){var r=o[t];var n=r.name;if(s(n)&&!u[n]){var i={_template:r,name:n,_input:{_templateitemname:n}};i[a]=r[a];e.push(i);u[n]=1}}return e}return{newItem:f,defaultItems:c}};function s(e){return e&&typeof e==="string"}function l(e){var t=e.length-1;if(e.charAt(t)!=="s"){n.warn("bad argument to arrayDefaultKey: "+e)}return e.substr(0,e.length-1)+"defaults"}r.arrayDefaultKey=l;r.arrayEditor=function(e,t,r){var i=(n.nestedProperty(e,t).get()||[]).length;var o=r._index;var s=o>=i&&(r._input||{})._templateitemname;if(s)o=i;var l=t+"["+o+"]";var u;function f(){u={};if(s){u[l]={};u[l][a]=s}}f();function c(e,t){u[e]=t}function h(e,t){if(s){n.nestedProperty(u[l],e).set(t)}else{u[l+"."+e]=t}}function v(){var e=u;f();return e}function d(t,r){if(t)h(t,r);var i=v();for(var a in i){n.nestedProperty(e,a).set(i[a])}}return{modifyBase:c,modifyItem:h,getUpdateObj:v,applyUpdate:d}}},{"../lib":483,"../plots/attributes":526}],520:[function(e,t,r){"use strict";var n=e("d3");var i=e("../registry");var a=e("../plots/plots");var o=e("../lib");var s=e("../lib/clear_gl_canvases");var l=e("../components/color");var u=e("../components/drawing");var f=e("../components/titles");var c=e("../components/modebar");var h=e("../plots/cartesian/axes");var v=e("../constants/alignment");var d=e("../plots/cartesian/constraints");var p=d.enforce;var g=d.clean;var m=e("../plots/cartesian/autorange").doAutoRange;r.layoutStyles=function(e){return o.syncOrAsync([a.doAutoMargin,b],e)};function y(e,t,r){for(var n=0;n<r.length;n++){var i=r[n][0],a=r[n][1];if(i[0]>=e[1]||i[1]<=e[0]){continue}if(a[0]<t[1]&&a[1]>t[0]){return true}}return false}function b(e){var t=e._fullLayout;var i=t._size;var a=i.p;var s=h.list(e,"",true);var f=t._has("cartesian");var d;function p(e,t,r){var n=e._lw/2;if(e._id.charAt(0)==="x"){if(!t)return i.t+i.h*(1-(e.position||0))+n%1;else if(r==="top")return t._offset-a-n;return t._offset+t._length+a+n}if(!t)return i.l+i.w*(e.position||0)+n%1;else if(r==="right")return t._offset+t._length+a+n;return t._offset-a-n}for(d=0;d<s.length;d++){var g=s[d];g.setScale();var m=g._anchorAxis;g._linepositions={};g._lw=u.crispRound(e,g.linewidth,1);g._mainLinePosition=p(g,m,g.side);g._mainMirrorPosition=g.mirror&&m?p(g,m,v.OPPOSITE_SIDE[g.side]):null;g._mainSubplot=x(g,t)}t._paperdiv.style({width:t.width+"px",height:t.height+"px"}).selectAll(".main-svg").call(u.setSize,t.width,t.height);e._context.setBackground(e,t.paper_bgcolor);var b=t._paper.selectAll("g.subplot");var w=[];var A=[];b.each(function(e){var r=t._plots[e];if(r.mainplot){if(r.bg){r.bg.remove()}r.bg=undefined;return}var n=r.xaxis.domain;var i=r.yaxis.domain;var a=r.plotgroup;if(y(n,i,A)){var s=a.node();var l=r.bg=o.ensureSingle(a,"rect","bg");s.insertBefore(l.node(),s.childNodes[0])}else{a.select("rect.bg").remove();w.push(e);A.push([n,i])}});var T=t._bgLayer.selectAll(".bg").data(w);T.enter().append("rect").classed("bg",true);T.exit().remove();T.each(function(e){t._plots[e].bg=n.select(this)});b.each(function(e){var r=t._plots[e];var n=r.xaxis;var i=r.yaxis;if(r.bg&&f){r.bg.call(u.setRect,n._offset-a,i._offset-a,n._length+2*a,i._length+2*a).call(l.fill,t.plot_bgcolor).style("stroke-width",0)}var c=r.clipId="clip"+t._uid+e+"plot";var h=o.ensureSingleById(t._clips,"clipPath",c,function(e){e.classed("plotclip",true).append("rect")});r.clipRect=h.select("rect").attr({width:n._length,height:i._length});u.setTranslate(r.plot,n._offset,i._offset);var v;var d;if(r._hasClipOnAxisFalse){v=null;d=c}else{v=c;d=null}u.setClipUrl(r.plot,v);r.layerClipId=d;if(!f)return;var g,m,y,b,x,w;var A,T,k,E,S,L;var C;function I(e){return"M"+g+","+e+"H"+m}function P(e){return"M"+n._offset+","+e+"h"+n._length}function O(e){return"M"+e+","+T+"V"+A}function R(e){return"M"+e+","+i._offset+"v"+i._length}function N(t,r,n){if(!t.showline||e!==t._mainSubplot)return"";if(!t._anchorAxis)return n(t._mainLinePosition);var i=r(t._mainLinePosition);if(t.mirror)i+=r(t._mainMirrorPosition);return i}var z="M0,0";if(_(n,e)){x=M(n,"left",i,s);g=n._offset-(x?a+x:0);w=M(n,"right",i,s);m=n._offset+n._length+(w?a+w:0);y=p(n,i,"bottom");b=p(n,i,"top");C=!n._anchorAxis||e!==n._mainSubplot;if(C&&n.ticks&&n.mirror==="allticks"){n._linepositions[e]=[y,b]}z=N(n,I,P);if(C&&n.showline&&(n.mirror==="all"||n.mirror==="allticks")){z+=I(y)+I(b)}r.xlines.style("stroke-width",n._lw+"px").call(l.stroke,n.showline?n.linecolor:"rgba(0,0,0,0)")}r.xlines.attr("d",z);var D="M0,0";if(_(i,e)){S=M(i,"bottom",n,s);A=i._offset+i._length+(S?a:0);L=M(i,"top",n,s);T=i._offset-(L?a:0);k=p(i,n,"left");E=p(i,n,"right");C=!i._anchorAxis||e!==n._mainSubplot;if(C&&i.ticks&&i.mirror==="allticks"){i._linepositions[e]=[k,E]}D=N(i,O,R);if(C&&i.showline&&(i.mirror==="all"||i.mirror==="allticks")){D+=O(k)+O(E)}r.ylines.style("stroke-width",i._lw+"px").call(l.stroke,i.showline?i.linecolor:"rgba(0,0,0,0)")}r.ylines.attr("d",D)});h.makeClipPaths(e);r.drawMainTitle(e);c.manage(e);return e._promises.length&&Promise.all(e._promises)}function x(e,t){var r=t._subplots;var n=r.cartesian.concat(r.gl2d||[]);var i={_fullLayout:t};var a=e._id.charAt(0)==="x";var o=e._mainAxis._anchorAxis;var s="";var l="";var u="";if(o){u=o._mainAxis._id;s=a?e._id+u:u+e._id}if(!s||!t._plots[s]){s="";for(var f=0;f<n.length;f++){var c=n[f];var v=c.indexOf("y");var d=a?c.substr(0,v):c.substr(v);var p=a?c.substr(v):c.substr(0,v);if(d===e._id){if(!l)l=c;var g=h.getFromId(i,p);if(u&&g.overlaying===u){s=c;break}}}}return s||l}function _(e,t){return(e.ticks||e.showline)&&(t===e._mainSubplot||e.mirror==="all"||e.mirror==="allticks")}function w(e,t,r){if(!r.showline||!r._lw)return false;if(r.mirror==="all"||r.mirror==="allticks")return true;var n=r._anchorAxis;if(!n)return false;var i=v.FROM_BL[t];if(r.side===t){return n.domain[i]===e.domain[i]}return r.mirror&&n.domain[1-i]===e.domain[1-i]}function M(e,t,r,n){if(w(e,t,r)){return r._lw}for(var i=0;i<n.length;i++){var a=n[i];if(a._mainAxis===r._mainAxis&&w(e,t,a)){return a._lw}}return 0}r.drawMainTitle=function(e){var t=e._fullLayout;f.draw(e,"gtitle",{propContainer:t,propName:"title",placeholder:t._dfltTitle.plot,attributes:{x:t.width/2,y:t._size.t/2,"text-anchor":"middle"}})};r.doTraceStyle=function(e){for(var t=0;t<e.calcdata.length;t++){var r=e.calcdata[t],n=((r[0]||{}).trace||{})._module||{},o=n.arraysToCalcdata;if(o)o(r,r[0].trace)}a.style(e);i.getComponentMethod("legend","draw")(e);return a.previousPromises(e)};r.doColorBars=function(e){for(var t=0;t<e.calcdata.length;t++){var r=e.calcdata[t][0];if((r.t||{}).cb){var n=r.trace,o=r.t.cb;if(i.traceIs(n,"contour")){o.line({width:n.contours.showlines!==false?n.line.width:0,dash:n.line.dash,color:n.contours.coloring==="line"?o._opts.line.color:n.line.color})}var s=n._module.colorbar;var l=s.container;var u=(l?n[l]:n).colorbar;o.options(u)()}}return a.previousPromises(e)};r.layoutReplot=function(e){var t=e.layout;e.layout=undefined;return i.call("plot",e,"",t)};r.doLegend=function(e){i.getComponentMethod("legend","draw")(e);return a.previousPromises(e)};r.doTicksRelayout=function(e,t){if(t){h.doTicks(e,Object.keys(t),true)}else{h.doTicks(e,"redraw")}if(e._fullLayout._hasOnlyLargeSploms){s(e);i.subplotsRegistry.splom.plot(e)}r.drawMainTitle(e);return a.previousPromises(e)};r.doModeBar=function(e){var t=e._fullLayout;c.manage(e);for(var r=0;r<t._basePlotModules.length;r++){var n=t._basePlotModules[r].updateFx;if(n)n(t)}return a.previousPromises(e)};r.doCamera=function(e){var t=e._fullLayout;var r=t._subplots.gl3d;for(var n=0;n<r.length;n++){var i=t[r[n]];var a=i._scene;a.setCamera(i.camera)}};r.drawData=function(e){var t=e._fullLayout;var r=e.calcdata;var n;for(n=0;n<r.length;n++){var o=r[n][0].trace;if(o.visible!==true||!o._module.colorbar){t._infolayer.select(".cb"+o.uid).remove()}}s(e);var l=t._basePlotModules;for(n=0;n<l.length;n++){l[n].plot(e)}a.style(e);i.getComponentMethod("shapes","draw")(e);i.getComponentMethod("annotations","draw")(e);t._replotting=false;return a.previousPromises(e)};r.doAutoRangeAndConstraints=function(e){var t=h.list(e,"",true);for(var r=0;r<t.length;r++){var n=t[r];g(e,n);m(n)}p(e)};r.finalDraw=function(e){i.getComponentMethod("shapes","draw")(e);i.getComponentMethod("images","draw")(e);i.getComponentMethod("annotations","draw")(e);i.getComponentMethod("rangeslider","draw")(e);i.getComponentMethod("rangeselector","draw")(e)};r.drawMarginPushers=function(e){i.getComponentMethod("legend","draw")(e);i.getComponentMethod("rangeselector","draw")(e);i.getComponentMethod("sliders","draw")(e);i.getComponentMethod("updatemenus","draw")(e)}},{"../components/color":361,"../components/drawing":386,"../components/modebar":424,"../components/titles":452,"../constants/alignment":459,"../lib":483,"../lib/clear_gl_canvases":470,"../plots/cartesian/autorange":528,"../plots/cartesian/axes":529,"../plots/cartesian/constraints":536,"../plots/plots":573,"../registry":582,d3:81}],521:[function(e,t,r){"use strict";var n=e("../lib");var i=n.isPlainObject;var a=e("./plot_schema");var o=e("../plots/plots");var s=e("../plots/attributes");var l=e("./plot_template");var u=e("./plot_config");r.makeTemplate=function(e){e=n.extendDeep({_context:u},e);o.supplyDefaults(e);var t=e.data||[];var r=e.layout||{};r._basePlotModules=e._fullLayout._basePlotModules;r._modules=e._fullLayout._modules;var a={data:{},layout:{}};t.forEach(function(e){var t={};h(e,t,d.bind(null,e));var r=n.coerce(e,{},s,"type");var i=a.data[r];if(!i)i=a.data[r]=[];i.push(t)});h(r,a.layout,v.bind(null,r));delete a.layout.template;var l=r.template;if(i(l)){var c=l.layout;var p,g,m,y,b,x;if(i(c)){f(c,a.layout)}var _=l.data;if(i(_)){for(g in a.data){m=_[g];if(Array.isArray(m)){b=a.data[g];x=b.length;y=m.length;for(p=0;p<x;p++){f(m[p%y],b[p])}for(p=x;p<y;p++){b.push(n.extendDeep({},m[p]))}}}for(g in _){if(!(g in a.data)){a.data[g]=n.extendDeep([],_[g])}}}}return a};function f(e,t){e=n.extendDeep({},e);var r=Object.keys(e).sort();var a,o;function s(t,r,n){if(i(r)&&i(t)){f(t,r)}else if(Array.isArray(r)&&Array.isArray(t)){var a=l.arrayTemplater({_template:e},n);for(o=0;o<r.length;o++){var s=r[o];var u=a.newItem(s)._template;if(u)f(u,s)}var c=a.defaultItems();for(o=0;o<c.length;o++)r.push(c[o]._template);for(o=0;o<r.length;o++)delete r[o].templateitemname}}for(a=0;a<r.length;a++){var u=r[a];var h=e[u];if(u in t){s(h,t[u],u)}else t[u]=h;if(c(u)===u){for(var v in t){var d=c(v);if(v!==d&&d===u&&!(v in e)){s(h,t[v],u)}}}}}function c(e){return e.replace(/[0-9]+$/,"")}function h(e,t,r,a,o){var s=o&&r(o);for(var u in e){var f=e[u];var v=p(e,u,a);var d=p(e,u,o);var g=r(d);if(!g){var m=c(u);if(m!==u){d=p(e,m,o);g=r(d)}}if(s&&s===g)continue;if(!g||g._noTemplating||g.valType==="data_array"||g.arrayOk&&Array.isArray(f)){continue}if(!g.valType&&i(f)){h(f,t,r,v,d)}else if(g._isLinkedToArray&&Array.isArray(f)){var y=false;var b=0;var x={};for(var _=0;_<f.length;_++){var w=f[_];if(i(w)){var M=w.name;if(M){if(!x[M]){h(w,t,r,p(f,b,v),p(f,b,d));b++;x[M]=1}}else if(!y){var A=l.arrayDefaultKey(u);var T=p(e,A,a);var k=p(f,b,v);h(w,t,r,k,p(f,b,d));var E=n.nestedProperty(t,k);var S=n.nestedProperty(t,T);S.set(E.get());E.set(null);y=true}}}}else{var L=n.nestedProperty(t,v);L.set(f)}}}function v(e,t){return a.getLayoutValObject(e,n.nestedProperty({},t).parts)}function d(e,t){return a.getTraceValObject(e,n.nestedProperty({},t).parts)}function p(e,t,r){var n;if(!r)n=t;else if(Array.isArray(e))n=r+"["+t+"]";else n=r+"."+t;return n}r.validateTemplate=function(e,t){var r=n.extendDeep({},{_context:u,data:e.data,layout:e.layout});var a=r.layout||{};if(!i(t))t=a.template||{};var s=t.layout;var l=t.data;var f=[];r.layout=a;r.layout.template=t;o.supplyDefaults(r);var h=r._fullLayout;var v=r._fullData;var d={};function y(e,t){for(var r in e){if(r.charAt(0)!=="_"&&i(e[r])){var n=c(r);var a=[];var o;for(o=0;o<t.length;o++){a.push(p(e,r,t[o]));if(n!==r)a.push(p(e,n,t[o]))}for(o=0;o<a.length;o++){d[a[o]]=1}y(e[r],a)}}}function b(e,t){for(var r in e){if(r.indexOf("defaults")===-1&&i(e[r])){var n=p(e,r,t);if(d[n]){b(e[r],n)}else{f.push({code:"unused",path:n})}}}}if(!i(s)){f.push({code:"layout"})}else{y(h,["layout"]);b(s,"layout")}if(!i(l)){f.push({code:"data"})}else{var x={};var _;for(var w=0;w<v.length;w++){var M=v[w];_=M.type;x[_]=(x[_]||0)+1;if(!M._fullInput._template){f.push({code:"missing",index:M._fullInput.index,traceType:_})}}for(_ in l){var A=l[_].length;var T=x[_]||0;if(A>T){f.push({code:"unused",traceType:_,templateCount:A,dataCount:T})}else if(T>A){f.push({code:"reused",traceType:_,templateCount:A,dataCount:T})}}}function k(e,t){for(var r in e){if(r.charAt(0)==="_")continue;var n=e[r];var a=p(e,r,t);if(i(n)){if(Array.isArray(e)&&n._template===false&&n.templateitemname){f.push({code:"missing",path:a,templateitemname:n.templateitemname})}k(n,a)}else if(Array.isArray(n)&&g(n)){k(n,a)}}}k({data:v,layout:h},"");if(f.length)return f.map(m)};function g(e){for(var t=0;t<e.length;t++){if(i(e[t]))return true}}function m(e){var t;switch(e.code){case"data":t="The template has no key data.";break;case"layout":t="The template has no key layout.";break;case"missing":if(e.path){t="There are no templates for item "+e.path+" with name "+e.templateitemname}else{t="There are no templates for trace "+e.index+", of type "+e.traceType+"."}break;case"unused":if(e.path){t="The template item at "+e.path+" was not used in constructing the plot."}else if(e.dataCount){t="Some of the templates of type "+e.traceType+" were not used. The template has "+e.templateCount+" traces, the data only has "+e.dataCount+" of this type."}else{t="The template has "+e.templateCount+" traces of type "+e.traceType+" but there are none in the data."}break;case"reused":t="Some of the templates of type "+e.traceType+" were used more than once. The template has "+e.templateCount+" traces, the data has "+e.dataCount+" of this type.";break}e.msg=t;return e}},{"../lib":483,"../plots/attributes":526,"../plots/plots":573,"./plot_config":517,"./plot_schema":518,"./plot_template":519}],522:[function(e,t,r){"use strict";var n=e("./plot_api");var i=e("../lib");var a=e("../snapshot/helpers");var o=e("../snapshot/tosvg");var s=e("../snapshot/svgtoimg");var l={format:{valType:"enumerated",values:["png","jpeg","webp","svg"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:false},imageDataOnly:{valType:"boolean",dflt:false}};var u=/^data:image\/\w+;base64,/;function f(e,t){t=t||{};var r;var f;var c;if(i.isPlainObject(e)){r=e.data||[];f=e.layout||{};c=e.config||{}}else{e=i.getGraphDiv(e);r=i.extendDeep([],e.data);f=i.extendDeep({},e.layout);c=e._context}function h(e){return!(e in t)||i.validate(t[e],l[e])}if(!h("width")||!h("height")){throw new Error("Height and width should be pixel values.")}if(!h("format")){throw new Error("Image format is not jpeg, png, svg or webp.")}var v={};function d(e,r){return i.coerce(t,v,l,e,r)}var p=d("format");var g=d("width");var m=d("height");var y=d("scale");var b=d("setBackground");var x=d("imageDataOnly");var _=document.createElement("div");_.style.position="absolute";_.style.left="-5000px";document.body.appendChild(_);var w=i.extendFlat({},f);if(g)w.width=g;if(m)w.height=m;var M=i.extendFlat({},c,{staticPlot:true,setBackground:b});var A=a.getRedrawFunc(_);function T(){return new Promise(function(e){setTimeout(e,a.getDelay(_._fullLayout))})}function k(){return new Promise(function(e,t){var r=o(_,p,y);var a=_._fullLayout.width;var l=_._fullLayout.height;n.purge(_);document.body.removeChild(_);if(p==="svg"){if(x){return e(r)}else{return e("data:image/svg+xml,"+encodeURIComponent(r))}}var u=document.createElement("canvas");u.id=i.randstr();s({format:p,width:a,height:l,scale:y,canvas:u,svg:r,promise:true}).then(e).catch(t)})}function E(e){if(x){return e.replace(u,"")}else{return e}}return new Promise(function(e,t){n.plot(_,r,w,M).then(A).then(T).then(k).then(function(t){e(E(t))}).catch(function(e){t(e)})})}t.exports=f},{"../lib":483,"../snapshot/helpers":586,"../snapshot/svgtoimg":588,"../snapshot/tosvg":590,"./plot_api":516}],523:[function(e,t,r){"use strict";var n=e("../lib");var i=e("../plots/plots");var a=e("./plot_schema");var o=e("./plot_config");var s=n.isPlainObject;var l=Array.isArray;var u=n.isArrayOrTypedArray;t.exports=function e(t,r){var u=a.get();var h=[];var v={_context:n.extendFlat({},o)};var p,g;if(l(t)){v.data=n.extendDeep([],t);p=t}else{v.data=[];p=[];h.push(d("array","data"))}if(s(r)){v.layout=n.extendDeep({},r);g=r}else{v.layout={};g={};if(arguments.length>1){h.push(d("object","layout"))}}i.supplyDefaults(v);var m=v._fullData,y=p.length;for(var b=0;b<y;b++){var x=p[b],_=["data",b];if(!s(x)){h.push(d("object",_));continue}var w=m[b],M=w.type,A=u.traces[M].attributes;A.type={valType:"enumerated",values:[M]};if(w.visible===false&&x.visible!==false){h.push(d("invisible",_))}f(x,w,A,h,_);var T=x.transforms,k=w.transforms;if(T){if(!l(T)){h.push(d("array",_,["transforms"]))}_.push("transforms");for(var E=0;E<T.length;E++){var S=["transforms",E],L=T[E].type;if(!s(T[E])){h.push(d("object",_,S));continue}var C=u.transforms[L]?u.transforms[L].attributes:{};C.type={valType:"enumerated",values:Object.keys(u.transforms)};f(T[E],k[E],C,h,_,S)}}}var I=v._fullLayout,P=c(u,m);f(g,I,P,h,"layout");return h.length===0?void 0:h};function f(e,t,r,i,a,o){o=o||[];var c=Object.keys(e);for(var h=0;h<c.length;h++){var v=c[h];if(v==="transforms")continue;var m=o.slice();m.push(v);var y=e[v],b=t[v];var x=g(r,v);var _=(x||{}).valType==="info_array";var w=(x||{}).valType==="colorscale";var M=(x||{}).items;if(!p(r,v)){i.push(d("schema",a,m))}else if(s(y)&&s(b)){f(y,b,x,i,a,m)}else if(_&&l(y)){if(y.length>b.length){i.push(d("unused",a,m.concat(b.length)))}var A=b.length;var T=Array.isArray(M);if(T)A=Math.min(A,M.length);var k,E,S,L,C;if(x.dimensions===2){for(E=0;E<A;E++){if(l(y[E])){if(y[E].length>b[E].length){i.push(d("unused",a,m.concat(E,b[E].length)))}var I=b[E].length;for(k=0;k<(T?Math.min(I,M[E].length):I);k++){S=T?M[E][k]:M;L=y[E][k];C=b[E][k];if(!n.validate(L,S)){i.push(d("value",a,m.concat(E,k),L))}else if(C!==L&&C!==+L){i.push(d("dynamic",a,m.concat(E,k),L,C))}}}else{i.push(d("array",a,m.concat(E),y[E]))}}}else{for(E=0;E<A;E++){S=T?M[E]:M;L=y[E];C=b[E];if(!n.validate(L,S)){i.push(d("value",a,m.concat(E),L))}else if(C!==L&&C!==+L){i.push(d("dynamic",a,m.concat(E),L,C))}}}}else if(x.items&&!_&&l(y)){var P=M[Object.keys(M)[0]],O=[];var R,N;for(R=0;R<b.length;R++){var z=b[R]._index||R;N=m.slice();N.push(z);if(s(y[z])&&s(b[R])){O.push(z);var D=y[z];var F=b[R];if(s(D)&&D.visible!==false&&F.visible===false){i.push(d("invisible",a,N))}else f(D,F,P,i,a,N)}}for(R=0;R<y.length;R++){N=m.slice();N.push(R);if(!s(y[R])){i.push(d("object",a,N,y[R]))}else if(O.indexOf(R)===-1){i.push(d("unused",a,N))}}}else if(!s(y)&&s(b)){i.push(d("object",a,m,y))}else if(!u(y)&&u(b)&&!_&&!w){i.push(d("array",a,m,y))}else if(!(v in t)){i.push(d("unused",a,m,y))}else if(!n.validate(y,x)){i.push(d("value",a,m,y))}else if(x.valType==="enumerated"&&(x.coerceNumber&&y!==+b||y!==b)){i.push(d("dynamic",a,m,y,b))}}return i}function c(e,t){for(var r=0;r<t.length;r++){var i=t[r].type,a=e.traces[i].layoutAttributes;if(a){n.extendFlat(e.layout.layoutAttributes,a)}}return e.layout.layoutAttributes}var h={object:function(e,t){var r;if(e==="layout"&&t==="")r="The layout argument";else if(e[0]==="data"&&t===""){r="Trace "+e[1]+" in the data argument"}else r=v(e)+"key "+t;return r+" must be linked to an object container"},array:function(e,t){var r;if(e==="data")r="The data argument";else r=v(e)+"key "+t;return r+" must be linked to an array container"},schema:function(e,t){return v(e)+"key "+t+" is not part of the schema"},unused:function(e,t,r){var n=s(r)?"container":"key";return v(e)+n+" "+t+" did not get coerced"},dynamic:function(e,t,r,n){return[v(e)+"key",t,"(set to '"+r+"')","got reset to","'"+n+"'","during defaults."].join(" ")},invisible:function(e,t){return(t?v(e)+"item "+t:"Trace "+e[1])+" got defaulted to be not visible"},value:function(e,t,r){return[v(e)+"key "+t,"is set to an invalid value ("+r+")"].join(" ")}};function v(e){if(l(e))return"In data trace "+e[1]+", ";return"In "+e+", "}function d(e,t,r,i,a){r=r||"";var o,s;if(l(t)){o=t[0];s=t[1]}else{o=t;s=null}var u=b(r);var f=h[e](t,u,i,a);n.log(f);return{code:e,container:o,trace:s,path:r,astr:u,msg:f}}function p(e,t){var r=y(t),n=r.keyMinusId,i=r.id;if(n in e&&e[n]._isSubplotObj&&i){return true}return t in e}function g(e,t){if(t in e)return e[t];var r=y(t);return e[r.keyMinusId]}var m=n.counterRegex("([a-z]+)");function y(e){var t=e.match(m);return{keyMinusId:t&&t[1],id:t&&t[2]}}function b(e){if(!l(e))return String(e);var t="";for(var r=0;r<e.length;r++){var n=e[r];if(typeof n==="number"){t=t.substr(0,t.length-1)+"["+n+"]"}else{t+=n}if(r<e.length-1)t+="."}return t}},{"../lib":483,"../plots/plots":573,"./plot_config":517,"./plot_schema":518}],524:[function(e,t,r){"use strict";t.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:false},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:true}},transition:{duration:{valType:"number",min:0,dflt:500},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"]}}}},{}],525:[function(e,t,r){"use strict";var n=e("../lib");var i=e("../plot_api/plot_template");t.exports=function e(t,r,a){var o=a.name;var s=a.inclusionAttr||"visible";var l=r[o];var u=n.isArrayOrTypedArray(t[o])?t[o]:[];var f=r[o]=[];var c=i.arrayTemplater(r,o,s);var h,v;for(h=0;h<u.length;h++){var d=u[h];if(!n.isPlainObject(d)){v=c.newItem({});v[s]=false}else{v=c.newItem(d)}v._index=h;if(v[s]!==false){a.handleItemDefaults(d,v,r,a)}f.push(v)}var p=c.defaultItems();for(h=0;h<p.length;h++){v=p[h];v._index=f.length;a.handleItemDefaults({},v,r,a,{});f.push(v)}if(n.isArrayOrTypedArray(l)){var g=Math.min(l.length,f.length);for(h=0;h<g;h++){n.relinkPrivateKeys(f[h],l[h])}}return f}},{"../lib":483,"../plot_api/plot_template":519}],526:[function(e,t,r){"use strict";var n=e("../components/fx/attributes");t.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:true},visible:{valType:"enumerated",values:[true,false,"legendonly"],dflt:true,editType:"calc"},showlegend:{valType:"boolean",dflt:true,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot"},ids:{valType:"data_array",editType:"calc"},customdata:{valType:"data_array",editType:"calc"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:true,dflt:"all",editType:"none"},hoverlabel:n.hoverlabel,stream:{token:{valType:"string",noBlank:true,strict:true,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"}}},{"../components/fx/attributes":395}],527:[function(e,t,r){"use strict";t.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],528:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");var a=e("../../constants/numerical").FP_SAFE;t.exports={getAutoRange:o,makePadFn:s,doAutoRange:l,expand:f};function o(e){var t=[];var r=e._min[0].val;var n=e._max[0].val;var a=0;var o=false;var l=s(e);var u,f,c,h,v,d,p,g;for(u=1;u<e._min.length;u++){if(r!==n)break;r=Math.min(r,e._min[u].val)}for(u=1;u<e._max.length;u++){if(r!==n)break;n=Math.max(n,e._max[u].val)}if(e.range){var m=i.simpleMap(e.range,e.r2l);o=m[1]<m[0]}if(e.autorange==="reversed"){o=true;e.autorange=true}for(u=0;u<e._min.length;u++){c=e._min[u];for(f=0;f<e._max.length;f++){h=e._max[f];g=h.val-c.val;p=e._length-l(c)-l(h);if(g>0&&p>0&&g/p>a){v=c;d=h;a=g/p}}}if(r===n){var y=r-1;var b=r+1;if(e.rangemode==="tozero"){t=r<0?[y,0]:[0,b]}else if(e.rangemode==="nonnegative"){t=[Math.max(0,y),Math.max(0,b)]}else{t=[y,b]}}else if(a){if(e.type==="linear"||e.type==="-"){if(e.rangemode==="tozero"){if(v.val>=0){v={val:0,pad:0}}if(d.val<=0){d={val:0,pad:0}}}else if(e.rangemode==="nonnegative"){if(v.val-a*l(v)<0){v={val:0,pad:0}}if(d.val<0){d={val:1,pad:0}}}a=(d.val-v.val)/(e._length-l(v)-l(d))}t=[v.val-a*l(v),d.val+a*l(d)]}if(t[0]===t[1]){if(e.rangemode==="tozero"){if(t[0]<0){t=[t[0],0]}else if(t[0]>0){t=[0,t[0]]}else{t=[0,1]}}else{t=[t[0]-1,t[0]+1];if(e.rangemode==="nonnegative"){t[0]=Math.max(0,t[0])}}}if(o)t.reverse();return i.simpleMap(t,e.l2r||Number)}function s(e){var t=e._length/20;if(e.constrain==="domain"&&e._inputDomain){t*=(e._inputDomain[1]-e._inputDomain[0])/(e.domain[1]-e.domain[0])}return function e(r){return r.pad+(r.extrapad?t:0)}}function l(e){if(!e._length)e.setScale();var t=e._min&&e._max&&e._min.length&&e._max.length;var r;if(e.autorange&&t){e.range=o(e);e._r=e.range.slice();e._rl=i.simpleMap(e._r,e.r2l);r=e._input;r.range=e.range.slice();r.autorange=e.autorange}if(e._anchorAxis&&e._anchorAxis.rangeslider){var n=e._anchorAxis.rangeslider[e._name];if(n){if(n.rangemode==="auto"){if(t){n.range=o(e)}else{n.range=e._rangeInitial?e._rangeInitial.slice():e.range.slice()}}}r=e._anchorAxis._input;r.rangeslider[e._name]=i.extendFlat({},n)}}function u(e){return e.autorange||e._rangesliderAutorange}function f(e,t,r){if(!u(e)||!t)return;if(!e._min)e._min=[];if(!e._max)e._max=[];if(!r)r={};if(!e._m)e.setScale();var i=t.length;var o=r.padded||false;var s=r.tozero&&(e.type==="linear"||e.type==="-");var l=e.type==="log";var f,d,p,g,m,y,b,x,_,w,M,A;var T=false;function k(e){if(Array.isArray(e)){T=true;return function(t){return Math.max(Number(e[t]||0),0)}}else{var t=Math.max(Number(e||0),0);return function(){return t}}}var E=k((e._m>0?r.ppadplus:r.ppadminus)||r.ppad||0);var S=k((e._m>0?r.ppadminus:r.ppadplus)||r.ppad||0);var L=k(r.vpadplus||r.vpad);var C=k(r.vpadminus||r.vpad);if(!T){M=Infinity;A=-Infinity;if(l){for(f=0;f<i;f++){g=t[f];if(g<M&&g>0)M=g;if(g>A&&g<a)A=g}}else{for(f=0;f<i;f++){g=t[f];if(g<M&&g>-a)M=g;if(g>A&&g<a)A=g}}t=[M,A];i=2}function I(r){m=t[r];if(!n(m))return;x=E(r);_=S(r);M=m-C(r);A=m+L(r);if(l&&M<A/10)M=A/10;y=e.c2l(M);b=e.c2l(A);if(s){y=Math.min(0,y);b=Math.max(0,b)}for(p=0;p<2;p++){var i=p?b:y;if(c(i)){var a=p?e._max:e._min;var u=p?x:_;var f=p?v:h;w=true;for(d=0;d<a.length&&w;d++){g=a[d];if(f(g.val,i)&&g.pad>=u&&(g.extrapad||!o)){w=false;break}else if(f(i,g.val)&&g.pad<=u&&(o||!g.extrapad)){a.splice(d,1);d--}}if(w){var T=s&&i===0;a.push({val:i,pad:T?0:u,extrapad:T?false:o})}}}}var P=Math.min(6,i);for(f=0;f<P;f++)I(f);for(f=i-1;f>=P;f--)I(f)}function c(e){return n(e)&&Math.abs(e)<a}function h(e,t){return e<=t}function v(e,t){return e>=t}},{"../../constants/numerical":463,"../../lib":483,"fast-isnumeric":91}],529:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../../plots/plots");var o=e("../../registry");var s=e("../../lib");var l=e("../../lib/svg_text_utils");var u=e("../../components/titles");var f=e("../../components/color");var c=e("../../components/drawing");var h=e("../../constants/numerical");var v=h.ONEAVGYEAR;var d=h.ONEAVGMONTH;var p=h.ONEDAY;var g=h.ONEHOUR;var m=h.ONEMIN;var y=h.ONESEC;var b=h.MINUS_SIGN;var x=h.BADNUM;var _=e("../../constants/alignment").MID_SHIFT;var w=e("../../constants/alignment").LINE_SPACING;var M=t.exports={};M.setConvert=e("./set_convert");var A=e("./axis_autotype");var T=e("./axis_ids");M.id2name=T.id2name;M.name2id=T.name2id;M.cleanId=T.cleanId;M.list=T.list;M.listIds=T.listIds;M.getFromId=T.getFromId;M.getFromTrace=T.getFromTrace;var k=e("./autorange");M.expand=k.expand;M.getAutoRange=k.getAutoRange;M.coerceRef=function(e,t,r,n,i,a){var o=n.charAt(n.length-1);var l=r._fullLayout._subplots[o+"axis"];var u=n+"ref";var f={};if(!i)i=l[0]||a;if(!a)a=i;f[u]={valType:"enumerated",values:l.concat(a?[a]:[]),dflt:i};return s.coerce(e,t,f,u)};M.coercePosition=function(e,t,r,n,i,a){var o,l;if(n==="paper"||n==="pixel"){o=s.ensureNumber;l=r(i,a)}else{var u=M.getFromId(t,n);a=u.fraction2r(a);l=r(i,a);o=u.cleanPos}e[i]=o(l)};M.cleanPosition=function(e,t,r){var n=r==="paper"||r==="pixel"?s.ensureNumber:M.getFromId(t,r).cleanPos;return n(e)};var E=M.getDataConversions=function(e,t,r,n){var i;var a=r==="x"||r==="y"||r==="z"?r:n;if(Array.isArray(a)){i={type:A(n),_categories:[]};M.setConvert(i);if(i.type==="category"){for(var o=0;o<n.length;o++){i.d2c(n[o])}}}else{i=M.getFromTrace(e,t,a)}if(i)return{d2c:i.d2c,c2d:i.c2d};if(a==="ids")return{d2c:L,c2d:L};return{d2c:S,c2d:S}};function S(e){return+e}function L(e){return String(e)}M.getDataToCoordFunc=function(e,t,r,n){return E(e,t,r,n).d2c};M.counterLetter=function(e){var t=e.charAt(0);if(t==="x")return"y";if(t==="y")return"x"};M.minDtick=function(e,t,r,n){if(["log","category"].indexOf(e.type)!==-1||!n){e._minDtick=0}else if(e._minDtick===undefined){e._minDtick=t;e._forceTick0=r}else if(e._minDtick){if((e._minDtick/t+1e-6)%1<2e-6&&((r-e._forceTick0)/t%1+1.000001)%1<2e-6){e._minDtick=t;e._forceTick0=r}else if((t/e._minDtick+1e-6)%1>2e-6||((r-e._forceTick0)/e._minDtick%1+1.000001)%1>2e-6){e._minDtick=0}}};M.saveRangeInitial=function(e,t){var r=M.list(e,"",true),n=false;for(var i=0;i<r.length;i++){var a=r[i];var o=a._rangeInitial===undefined;var s=o||!(a.range[0]===a._rangeInitial[0]&&a.range[1]===a._rangeInitial[1]);if(o&&a.autorange===false||t&&s){a._rangeInitial=a.range.slice();n=true}}return n};M.saveShowSpikeInitial=function(e,t){var r=M.list(e,"",true),n=false,i="on";for(var a=0;a<r.length;a++){var o=r[a];var s=o._showSpikeInitial===undefined;var l=s||!(o.showspikes===o._showspikes);if(s||t&&l){o._showSpikeInitial=o.showspikes;n=true}if(i==="on"&&!o.showspikes){i="off"}}e._fullLayout._cartesianSpikesEnabled=i;return n};M.autoBin=function(e,t,r,n,a){var o=s.aggNums(Math.min,null,e),l=s.aggNums(Math.max,null,e);if(!a)a=t.calendar;if(t.type==="category"){return{start:o-.5,end:l+.5,size:1,_dataSpan:l-o}}var u;if(r)u=(l-o)/r;else{var f=s.distinctVals(e),c=Math.pow(10,Math.floor(Math.log(f.minDiff)/Math.LN10)),h=c*s.roundUp(f.minDiff/c,[.9,1.9,4.9,9.9],true);u=Math.max(h,2*s.stdev(e)/Math.pow(e.length,n?.25:.4));if(!i(u))u=1}var v;if(t.type==="log"){v={type:"linear",range:[o,l]}}else{v={type:t.type,range:s.simpleMap([o,l],t.c2r,0,a),calendar:a}}M.setConvert(v);M.autoTicks(v,u);var d=M.tickIncrement(M.tickFirst(v),v.dtick,"reverse",a);var p,g;if(typeof v.dtick==="number"){d=C(d,e,v,o,l);g=1+Math.floor((l-d)/v.dtick);p=d+g*v.dtick}else{if(v.dtick.charAt(0)==="M"){d=I(d,e,v.dtick,o,a)}p=d;g=0;while(p<=l){p=M.tickIncrement(p,v.dtick,false,a);g++}}return{start:t.c2r(d,0,a),end:t.c2r(p,0,a),size:v.dtick,_dataSpan:l-o}};function C(e,t,r,n,a){var o=0,s=0,l=0,u=0;function f(t){return(1+(t-e)*100/r.dtick)%100<2}for(var c=0;c<t.length;c++){if(t[c]%1===0)l++;else if(!i(t[c]))u++;if(f(t[c]))o++;if(f(t[c]+r.dtick/2))s++}var h=t.length-u;if(l===h&&r.type!=="date"){if(r.dtick<1){e=n-.5*r.dtick}else{e-=.5;if(e+r.dtick<n)e+=r.dtick}}else if(s<h*.1){if(o>h*.3||f(n)||f(a)){var v=r.dtick/2;e+=e+v<n?v:-v}}return e}function I(e,t,r,n,i){var a=s.findExactDates(t,i);var o=.8;if(a.exactDays>o){var l=Number(r.substr(1));if(a.exactYears>o&&l%12===0){e=M.tickIncrement(e,"M6","reverse")+p*1.5}else if(a.exactMonths>o){e=M.tickIncrement(e,"M1","reverse")+p*15.5}else{e-=p/2}var u=M.tickIncrement(e,r);if(u<=n)return u}return e}M.prepTicks=function(e){var t=s.simpleMap(e.range,e.r2l);if(e.tickmode==="auto"||!e.dtick){var r=e.nticks,n;if(!r){if(e.type==="category"){n=e.tickfont?(e.tickfont.size||12)*1.2:15;r=e._length/n}else{n=e._id.charAt(0)==="y"?40:80;r=s.constrain(e._length/n,4,9)+1}if(e._name==="radialaxis")r*=2}if(e.tickmode==="array")r*=100;M.autoTicks(e,Math.abs(t[1]-t[0])/r);if(e._minDtick>0&&e.dtick<e._minDtick*2){e.dtick=e._minDtick;e.tick0=e.l2r(e._forceTick0)}}if(!e.tick0){e.tick0=e.type==="date"?"2000-01-01":0}U(e)};M.calcTicks=function e(t){M.prepTicks(t);var r=s.simpleMap(t.range,t.r2l);if(t.tickmode==="array")return P(t);t._tmin=M.tickFirst(t);var n=r[0]*1.0001-r[1]*1e-4;var i=r[1]*1.0001-r[0]*1e-4;var a=r[1]<r[0];if(t._tmin<n!==a)return[];var o=[];if(t.type==="category"){i=a?Math.max(-.5,i):Math.min(t._categories.length-.5,i)}var l=null;var u=Math.max(1e3,t._length||0);for(var f=t._tmin;a?f>=i:f<=i;f=M.tickIncrement(f,t.dtick,a,t.calendar)){if(o.length>u||f===l)break;l=f;o.push(f)}if(t._id==="angular"&&Math.abs(r[1]-r[0])===360){o.pop()}t._tmax=o[o.length-1];t._prevDateHead="";t._inCalcTicks=true;var c=new Array(o.length);for(var h=0;h<o.length;h++)c[h]=M.tickText(t,o[h]);t._inCalcTicks=false;return c};function P(e){var t=e.tickvals,r=e.ticktext,n=new Array(t.length),i=s.simpleMap(e.range,e.r2l),a=i[0]*1.0001-i[1]*1e-4,o=i[1]*1.0001-i[0]*1e-4,l=Math.min(a,o),u=Math.max(a,o),f,c,h=0;if(!Array.isArray(r))r=[];var v=e.type==="category"?e.d2l_noadd:e.d2l;if(e.type==="log"&&String(e.dtick).charAt(0)!=="L"){e.dtick="L"+Math.pow(10,Math.floor(Math.min(e.range[0],e.range[1]))-1)}for(c=0;c<t.length;c++){f=v(t[c]);if(f>l&&f<u){if(r[c]===undefined)n[h]=M.tickText(e,f);else n[h]=V(e,f,String(r[c]));h++}}if(h<t.length)n.splice(h,t.length-h);return n}var O=[2,5,10],R=[1,2,3,6,12],N=[1,2,5,10,15,30],z=[1,2,3,7,14],D=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],F=[-.301,0,.301,.699,1],j=[15,30,45,90,180];function B(e,t,r){return t*s.roundUp(e/t,r)}M.autoTicks=function(e,t){var r;function n(e){return Math.pow(e,Math.floor(Math.log(t)/Math.LN10))}if(e.type==="date"){e.tick0=s.dateTick0(e.calendar);var a=2*t;if(a>v){t/=v;r=n(10);e.dtick="M"+12*B(t,r,O)}else if(a>d){t/=d;e.dtick="M"+B(t,1,R)}else if(a>p){e.dtick=B(t,p,z);e.tick0=s.dateTick0(e.calendar,true)}else if(a>g){e.dtick=B(t,g,R)}else if(a>m){e.dtick=B(t,m,N)}else if(a>y){e.dtick=B(t,y,N)}else{r=n(10);e.dtick=B(t,r,O)}}else if(e.type==="log"){e.tick0=0;var o=s.simpleMap(e.range,e.r2l);if(t>.7){e.dtick=Math.ceil(t)}else if(Math.abs(o[1]-o[0])<1){var l=1.5*Math.abs((o[1]-o[0])/t);t=Math.abs(Math.pow(10,o[1])-Math.pow(10,o[0]))/l;r=n(10);e.dtick="L"+B(t,r,O)}else{e.dtick=t>.3?"D2":"D1"}}else if(e.type==="category"){e.tick0=0;e.dtick=Math.ceil(Math.max(t,1))}else if(e._id==="angular"){e.tick0=0;r=1;e.dtick=B(t,r,j)}else{e.tick0=0;r=n(10);e.dtick=B(t,r,O)}if(e.dtick===0)e.dtick=1;if(!i(e.dtick)&&typeof e.dtick!=="string"){var u=e.dtick;e.dtick=1;throw"ax.dtick error: "+String(u)}};function U(e){var t=e.dtick;e._tickexponent=0;if(!i(t)&&typeof t!=="string"){t=1}if(e.type==="category"){e._tickround=null}if(e.type==="date"){var r=e.r2l(e.tick0),n=e.l2r(r).replace(/(^-|i)/g,""),a=n.length;if(String(t).charAt(0)==="M"){if(a>10||n.substr(5)!=="01-01")e._tickround="d";else e._tickround=+t.substr(1)%12===0?"y":"m"}else if(t>=p&&a<=10||t>=p*15)e._tickround="d";else if(t>=m&&a<=16||t>=g)e._tickround="M";else if(t>=y&&a<=19||t>=m)e._tickround="S";else{var o=e.l2r(r+t).replace(/^-/,"").length;e._tickround=Math.max(a,o)-20}}else if(i(t)||t.charAt(0)==="L"){var s=e.range.map(e.r2d||Number);if(!i(t))t=Number(t.substr(1));e._tickround=2-Math.floor(Math.log(t)/Math.LN10+.01);var l=Math.max(Math.abs(s[0]),Math.abs(s[1]));var u=Math.floor(Math.log(l)/Math.LN10+.01);if(Math.abs(u)>3){if(Q(e.exponentformat)&&!K(u)){e._tickexponent=3*Math.round((u-1)/3)}else e._tickexponent=u}}else e._tickround=null}M.tickIncrement=function(e,t,r,a){var o=r?-1:1;if(i(t))return e+o*t;var l=t.charAt(0),u=o*Number(t.substr(1));if(l==="M")return s.incrementMonth(e,u,a);else if(l==="L")return Math.log(Math.pow(10,e)+u)/Math.LN10;else if(l==="D"){var f=t==="D2"?F:D,c=e+o*.01,h=s.roundUp(s.mod(c,1),f,r);return Math.floor(c)+Math.log(n.round(Math.pow(10,h),1))/Math.LN10}else throw"unrecognized dtick "+String(t)};M.tickFirst=function(e){var t=e.r2l||Number,r=s.simpleMap(e.range,t),a=r[1]<r[0],o=a?Math.floor:Math.ceil,l=r[0]*1.0001-r[1]*1e-4,u=e.dtick,f=t(e.tick0);if(i(u)){var c=o((l-f)/u)*u+f;if(e.type==="category"){c=s.constrain(c,0,e._categories.length-1)}return c}var h=u.charAt(0),v=Number(u.substr(1));if(h==="M"){var d=0,p=f,g,m,y;while(d<10){g=M.tickIncrement(p,u,a,e.calendar);if((g-l)*(p-l)<=0){if(a)return Math.min(p,g);return Math.max(p,g)}m=(l-(p+g)/2)/(g-p);y=h+(Math.abs(Math.round(m))||1)*v;p=M.tickIncrement(p,y,m<0?!a:a,e.calendar);d++}s.error("tickFirst did not converge",e);return p}else if(h==="L"){return Math.log(o((Math.pow(10,l)-f)/v)*v+f)/Math.LN10}else if(h==="D"){var b=u==="D2"?F:D,x=s.roundUp(s.mod(l,1),b,a);return Math.floor(l)+Math.log(n.round(Math.pow(10,x),1))/Math.LN10}else throw"unrecognized dtick "+String(u)};M.tickText=function(e,t,r){var n=V(e,t),i,a=e.tickmode==="array",o=r||a,l,u=e.type==="category"?e.d2l_noadd:e.d2l;if(a&&Array.isArray(e.ticktext)){var f=s.simpleMap(e.range,e.r2l),c=Math.abs(f[1]-f[0])/1e4;for(l=0;l<e.ticktext.length;l++){if(Math.abs(t-u(e.tickvals[l]))<c)break}if(l<e.ticktext.length){n.text=String(e.ticktext[l]);return n}}function h(n){var i;if(n===undefined)return true;if(r)return n==="none";i={first:e._tmin,last:e._tmax}[n];return n!=="all"&&t!==i}if(r){i="never"}else{i=e.exponentformat!=="none"&&h(e.showexponent)?"hide":""}if(e.type==="date")H(e,n,r,o);else if(e.type==="log")q(e,n,r,o,i);else if(e.type==="category")G(e,n);else if(e._id==="angular")X(e,n,r,o,i);else W(e,n,r,o,i);if(e.tickprefix&&!h(e.showtickprefix))n.text=e.tickprefix+n.text;if(e.ticksuffix&&!h(e.showticksuffix))n.text+=e.ticksuffix;return n};M.hoverLabelText=function(e,t,r){if(r!==x&&r!==t){return M.hoverLabelText(e,t)+" - "+M.hoverLabelText(e,r)}var n=e.type==="log"&&t<=0;var i=M.tickText(e,e.c2l(n?-t:t),"hover").text;if(n){return t===0?"0":b+i}return i};function V(e,t,r){var n=e.tickfont||{};return{x:t,dx:0,dy:0,text:r||"",fontSize:n.size,font:n.family,fontColor:n.color}}function H(e,t,r,n){var a=e._tickround,o=r&&e.hoverformat||M.getTickFormat(e);if(n){if(i(a))a=4;else a={y:"m",m:"d",d:"M",M:"S",S:4}[a]}var l=s.formatDate(t.x,o,a,e._dateFormat,e.calendar,e._extraFormat),u;var f=l.indexOf("\n");if(f!==-1){u=l.substr(f+1);l=l.substr(0,f)}if(n){if(l==="00:00:00"||l==="00:00"){l=u;u=""}else if(l.length===8){l=l.replace(/:00$/,"")}}if(u){if(r){if(a==="d")l+=", "+u;else l=u+(l?", "+l:"")}else if(!e._inCalcTicks||u!==e._prevDateHead){l+="<br>"+u;e._prevDateHead=u}}t.text=l}function q(e,t,r,n,a){var o=e.dtick,l=t.x,u=e.tickformat;if(a==="never"){a=""}if(n&&(typeof o!=="string"||o.charAt(0)!=="L"))o="L3";if(u||typeof o==="string"&&o.charAt(0)==="L"){t.text=J(Math.pow(10,l),e,a,n)}else if(i(o)||o.charAt(0)==="D"&&s.mod(l+.01,1)<.1){var f=Math.round(l);if(["e","E","power"].indexOf(e.exponentformat)!==-1||Q(e.exponentformat)&&K(f)){if(f===0)t.text=1;else if(f===1)t.text="10";else if(f>1)t.text="10<sup>"+f+"</sup>";else t.text="10<sup>"+b+-f+"</sup>";t.fontSize*=1.25}else{t.text=J(Math.pow(10,l),e,"","fakehover");if(o==="D1"&&e._id.charAt(0)==="y"){t.dy-=t.fontSize/6}}}else if(o.charAt(0)==="D"){t.text=String(Math.round(Math.pow(10,s.mod(l,1))));t.fontSize*=.75}else throw"unrecognized dtick "+String(o);if(e.dtick==="D1"){var c=String(t.text).charAt(0);if(c==="0"||c==="1"){if(e._id.charAt(0)==="y"){t.dx-=t.fontSize/4}else{t.dy+=t.fontSize/2;t.dx+=(e.range[1]>e.range[0]?1:-1)*t.fontSize*(l<0?.5:.25)}}}}function G(e,t){var r=e._categories[Math.round(t.x)];if(r===undefined)r="";t.text=String(r)}function W(e,t,r,n,i){if(i==="never"){i=""}else if(e.showexponent==="all"&&Math.abs(t.x/e.dtick)<1e-6){i="hide"}t.text=J(t.x,e,i,n)}function X(e,t,r,n,i){if(e.thetaunit==="radians"&&!r){var a=t.x/180;if(a===0){t.text="0"}else{var o=Y(a);if(o[1]>=100){t.text=J(s.deg2rad(t.x),e,i,n)}else{var l=t.x<0;if(o[1]===1){if(o[0]===1)t.text="\u03c0";else t.text=o[0]+"\u03c0"}else{t.text=["<sup>",o[0],"</sup>","\u2044","<sub>",o[1],"</sub>","\u03c0"].join("")}if(l)t.text=b+t.text}}}else{t.text=J(t.x,e,i,n)}}function Y(e){function t(e,t){return Math.abs(e-t)<=1e-6}function r(e,n){return t(n,0)?e:r(n,e%n)}function n(e){var r=1;while(!t(Math.round(e*r)/r,e)){r*=10}return r}var i=n(e);var a=e*i;var o=Math.abs(r(a,i));return[Math.round(a/o),Math.round(i/o)]}var Z=["f","p","n","\u03bc","m","","k","M","G","T"];function Q(e){return e==="SI"||e==="B"}function K(e){return e>14||e<-15}function J(e,t,r,n){var a=e<0,o=t._tickround,l=r||t.exponentformat||"B",u=t._tickexponent,f=M.getTickFormat(t),c=t.separatethousands;if(n){var h={exponentformat:l,dtick:t.showexponent==="none"?t.dtick:i(e)?Math.abs(e)||1:1,range:t.showexponent==="none"?t.range.map(t.r2d):[0,e||1]};U(h);o=(Number(h._tickround)||0)+4;u=h._tickexponent;if(t.hoverformat)f=t.hoverformat}if(f)return t._numFormat(f)(e).replace(/-/g,b);var v=Math.pow(10,-o)/2;if(l==="none")u=0;e=Math.abs(e);if(e<v){e="0";a=false}else{e+=v;if(u){e*=Math.pow(10,-u);o+=u}if(o===0)e=String(Math.floor(e));else if(o<0){e=String(Math.round(e));e=e.substr(0,e.length+o);for(var d=o;d<0;d++)e+="0"}else{e=String(e);var p=e.indexOf(".")+1;if(p)e=e.substr(0,p+o).replace(/\.?0+$/,"")}e=s.numSeparate(e,t._separators,c)}if(u&&l!=="hide"){if(Q(l)&&K(u))l="power";var g;if(u<0)g=b+-u;else if(l!=="power")g="+"+u;else g=String(u);if(l==="e"){e+="e"+g}else if(l==="E"){e+="E"+g}else if(l==="power"){e+="\xd710<sup>"+g+"</sup>"}else if(l==="B"&&u===9){e+="B"}else if(Q(l)){e+=Z[u/3+5]}}if(a)return b+e;return e}M.getTickFormat=function(e){var t;function r(e){return typeof e!=="string"?e:Number(e.replace("M",""))*d}function n(e,t){var r=["L","D"];if(typeof e===typeof t){if(typeof e==="number"){return e-t}else{var n=r.indexOf(e.charAt(0));var i=r.indexOf(t.charAt(0));if(n===i){return Number(e.replace(/(L|D)/g,""))-Number(t.replace(/(L|D)/g,""))}else{return n-i}}}else{return typeof e==="number"?1:-1}}function i(e,t,r){var n=r||function(e){return e};var i=t[0];var a=t[1];return(!i&&typeof i!=="number"||n(i)<=n(e))&&(!a&&typeof a!=="number"||n(a)>=n(e))}function a(e,t){var r=t[0]===null;var i=t[1]===null;var a=n(e,t[0])>=0;var o=n(e,t[1])<=0;return(r||a)&&(i||o)}var o,s;if(e.tickformatstops&&e.tickformatstops.length>0){switch(e.type){case"date":case"linear":{for(t=0;t<e.tickformatstops.length;t++){s=e.tickformatstops[t];if(s.enabled&&i(e.dtick,s.dtickrange,r)){o=s;break}}break}case"log":{for(t=0;t<e.tickformatstops.length;t++){s=e.tickformatstops[t];if(s.enabled&&a(e.dtick,s.dtickrange)){o=s;break}}break}default:}}return o?o.value:e.tickformat};M.getSubplots=function(e,t){var r=e._fullLayout._subplots;var n=r.cartesian.concat(r.gl2d||[]);var i=t?M.findSubplotsWithAxis(n,t):n;i.sort(function(e,t){var r=e.substr(1).split("y");var n=t.substr(1).split("y");if(r[0]===n[0])return+r[1]-+n[1];return+r[0]-+n[0]});return i};M.findSubplotsWithAxis=function(e,t){var r=new RegExp(t._id.charAt(0)==="x"?"^"+t._id+"y":t._id+"$");var n=[];for(var i=0;i<e.length;i++){var a=e[i];if(r.test(a))n.push(a)}return n};M.makeClipPaths=function(e){var t=e._fullLayout;if(t._hasOnlyLargeSploms)return;var r={_offset:0,_length:t.width,_id:""};var i={_offset:0,_length:t.height,_id:""};var a=M.list(e,"x",true);var o=M.list(e,"y",true);var s=[];var l,u;for(l=0;l<a.length;l++){s.push({x:a[l],y:i});for(u=0;u<o.length;u++){if(l===0)s.push({x:r,y:o[u]});s.push({x:a[l],y:o[u]})}}var f=t._clips.selectAll(".axesclip").data(s,function(e){return e.x._id+e.y._id});f.enter().append("clipPath").classed("axesclip",true).attr("id",function(e){return"clip"+t._uid+e.x._id+e.y._id}).append("rect");f.exit().remove();f.each(function(e){n.select(this).select("rect").attr({x:e.x._offset||0,y:e.y._offset||0,width:e.x._length||1,height:e.y._length||1})})};M.doTicks=function(e,t,r){var n=e._fullLayout;if(t==="redraw"){n._paper.selectAll("g.subplot").each(function(e){var t=n._plots[e];var r=t.xaxis;var i=t.yaxis;t.xaxislayer.selectAll("."+r._id+"tick").remove();t.yaxislayer.selectAll("."+i._id+"tick").remove();if(t.gridlayer)t.gridlayer.selectAll("path").remove();if(t.zerolinelayer)t.zerolinelayer.selectAll("path").remove();n._infolayer.select(".g-"+r._id+"title").remove();n._infolayer.select(".g-"+i._id+"title").remove()})}var i=!t||t==="redraw"?M.listIds(e):t;s.syncOrAsync(i.map(function(t){return function(){if(!t)return;var n=M.doTicksSingle(e,t,r);var i=M.getFromId(e,t);i._r=i.range.slice();i._rl=s.simpleMap(i._r,i.r2l);return n}}))};M.doTicksSingle=function(e,t,r){var h=e._fullLayout;var v=false;var d;if(s.isPlainObject(t)){d=t;v=true}else{d=M.getFromId(e,t)}d.setScale();var p=d._id;var g=p.charAt(0);var m=M.counterLetter(p);var y=d._vals=M.calcTicks(d);var b=function(e){return[e.text,e.x,d.mirror,e.font,e.fontSize,e.fontColor].join("_")};var x=p+"tick";var A=p+"grid";var k=p+"zl";var E=(d.linewidth||1)/2;var S=d.ticks==="outside"?d.ticklen:0;var L=0;var C=c.crispRound(e,d.gridwidth,1);var I=c.crispRound(e,d.zerolinewidth,C);var P=c.crispRound(e,d.tickwidth,1);var O,R,N,z;var D;var F;if(d._counterangle&&d.ticks==="outside"){var j=d._counterangle*Math.PI/180;S=d.ticklen*Math.cos(j)+1;L=d.ticklen*Math.sin(j)}if(d.showticklabels&&(d.ticks==="outside"||d.showline)){S+=.2*d.tickfont.size}if(g==="x"){O=["bottom","top"];R=d._transfn||function(e){return"translate("+(d._offset+d.l2p(e.x))+",0)"};N=function(e,t){if(d._counterangle){var r=d._counterangle*Math.PI/180;return"M0,"+e+"l"+Math.sin(r)*t+","+Math.cos(r)*t}else return"M0,"+e+"v"+t}}else if(g==="y"){O=["left","right"];R=d._transfn||function(e){return"translate(0,"+(d._offset+d.l2p(e.x))+")"};N=function(e,t){if(d._counterangle){var r=d._counterangle*Math.PI/180;return"M"+e+",0l"+Math.cos(r)*t+","+-Math.sin(r)*t}else return"M"+e+",0h"+t}}else if(p==="angular"){O=["left","right"];R=d._transfn;N=function(e,t){return"M"+e+",0h"+t}}else{s.warn("Unrecognized doTicks axis:",p);return}var B=d.side||O[0];var U=[-1,1,B===O[1]?1:-1];if(d.ticks!=="inside"===(g==="x")){U=U.map(function(e){return-e})}if(!d.visible)return;if(d._tickFilter){y=y.filter(d._tickFilter)}function V(e){var t=d.l2p(e.x);return t>1&&t<d._length-1}var H=y.filter(V);if(d._id==="angular"){H=y}function q(e,t){var r=e.selectAll("path."+x).data(d.ticks==="inside"?H:y,b);if(t&&d.ticks){r.enter().append("path").classed(x,1).classed("ticks",1).classed("crisp",1).call(f.stroke,d.tickcolor).style("stroke-width",P+"px").attr("d",t);r.attr("transform",R);r.exit().remove()}else r.remove()}function G(t,r){D=t.selectAll("g."+x).data(y,b);if(!i(r)){D.remove();W();return}if(!d.showticklabels){D.remove();W();O();return}var o,u,f,v,m;if(g==="x"){m=B==="bottom"?1:-1;o=function(e){return e.dx+L*m};v=r+(S+E)*m;u=function(e){return e.dy+v+e.fontSize*(B==="bottom"?1:-.2)};f=function(e){if(!i(e)||e===0||e===180){return"middle"}return e*m<0?"end":"start"}}else if(g==="y"){m=B==="right"?1:-1;u=function(e){return e.dy+e.fontSize*_-L*m};o=function(e){return e.dx+r+(S+E+(Math.abs(d.tickangle)===90?e.fontSize/2:0))*m};f=function(e){if(i(e)&&Math.abs(e)===90){return"middle"}return B==="right"?"start":"end"}}else if(p==="angular"){d._labelShift=L;d._labelStandoff=S;d._pad=E;o=d._labelx;u=d._labely;f=d._labelanchor}var M=0,A=0,T=[];D.enter().append("g").classed(x,1).append("text").attr("text-anchor","middle").each(function(t){var r=n.select(this),i=e._promises.length;r.call(l.positionText,o(t),u(t)).call(c.font,t.font,t.fontSize,t.fontColor).text(t.text).call(l.convertToTspans,e);i=e._promises[i];if(i){T.push(e._promises.pop().then(function(){C(r,d.tickangle)}))}else{C(r,d.tickangle)}});D.exit().remove();D.each(function(e){M=Math.max(M,e.fontSize)});if(p==="angular"){D.each(function(e){n.select(this).select("text").call(l.positionText,o(e),u(e))})}function k(e,t,r){var n=(e-1)*t;if(g==="x"){if(r<-60||60<r){return-.5*n}else if(B==="top"){return-n}}else{r*=B==="left"?1:-1;if(r<-30){return-n}else if(r<30){return-.5*n}}return 0}function C(e,t){e.each(function(e){var r=f(t,e);var a=n.select(this),s=a.select(".text-math-group"),h=R.call(a.node(),e)+(i(t)&&+t!==0?" rotate("+t+","+o(e)+","+(u(e)-e.fontSize/2)+")":"");var v=k(l.lineCount(a),w*e.fontSize,i(t)?+t:0);if(v){h+=" translate(0, "+v+")"}if(s.empty()){a.select("text").attr({transform:h,"text-anchor":r})}else{var d=c.bBox(s.node()).width*{end:-.5,start:.5}[r];s.attr("transform",h+(d?"translate("+d+",0)":""))}})}C(D,d._lastangle||d.tickangle);function I(){return T.length&&Promise.all(T)}function P(){C(D,d.tickangle);if(g==="x"&&!i(d.tickangle)&&(d.type!=="log"||String(d.dtick).charAt(0)!=="D")){var e=[];D.each(function(t){var r=n.select(this),i=r.select(".text-math-group"),a=d.l2p(t.x);if(i.empty())i=r.select("text");var o=c.bBox(i.node());e.push({top:0,bottom:10,height:10,left:a-o.width/2,right:a+o.width/2+2,width:o.width+2})});for(F=0;F<e.length-1;F++){if(s.bBoxIntersect(e[F],e[F+1])){A=30;break}}if(A){var t=Math.abs((y[y.length-1].x-y[0].x)*d._m)/(y.length-1);if(t<M*2.5){A=90}C(D,A)}d._lastangle=A}W();return p+" done"}function O(){if(d.showticklabels){var r=e.getBoundingClientRect();var n=t.node().getBoundingClientRect();d._boundingBox={width:n.width,height:n.height,left:n.left-r.left,right:n.right-r.left,top:n.top-r.top,bottom:n.bottom-r.top}}else{var i=h._size;var a;if(g==="x"){a=d.anchor==="free"?i.t+i.h*(1-d.position):i.t+i.h*(1-d._anchorAxis.domain[{bottom:0,top:1}[d.side]]);d._boundingBox={top:a,bottom:a,left:d._offset,right:d._offset+d._length,width:d._length,height:0}}else{a=d.anchor==="free"?i.l+i.w*d.position:i.l+i.w*d._anchorAxis.domain[{left:0,right:1}[d.side]];d._boundingBox={left:a,right:a,bottom:d._offset+d._length,top:d._offset,height:d._length,width:0}}}if(z){var o=d._counterSpan=[Infinity,-Infinity];for(F=0;F<z.length;F++){var s=h._plots[z[F]];var l=s[g==="x"?"yaxis":"xaxis"];u(o,[l._offset,l._offset+l._length])}if(d.anchor==="free"){u(o,g==="x"?[d._boundingBox.bottom,d._boundingBox.top]:[d._boundingBox.right,d._boundingBox.left])}}function u(e,t){e[0]=Math.min(e[0],t[0]);e[1]=Math.max(e[1],t[1])}}function N(){var t=d._name+".automargin";if(g!=="x"&&g!=="y"){return}if(!d.automargin){a.autoMargin(e,t);return}var r=d.side[0];var n={x:0,y:0,r:0,l:0,t:0,b:0};if(g==="x"){n.y=d.anchor==="free"?d.position:d._anchorAxis.domain[r==="t"?1:0];n[r]+=d._boundingBox.height}else{n.x=d.anchor==="free"?d.position:d._anchorAxis.domain[r==="r"?1:0];n[r]+=d._boundingBox.width}if(d.title!==h._dfltTitle[g]){n[r]+=d.titlefont.size}a.autoMargin(e,t,n)}var j=s.syncOrAsync([I,P,O,N]);if(j&&j.then)e._promises.push(j);return j}function W(){if(r)return;if(d.rangeslider&&d.rangeslider.visible&&d._boundingBox&&d.side==="bottom")return;var t={selection:D,side:d.side};var n=p.charAt(0);var i=e._fullLayout._size;var a=1.5;var o=d.titlefont.size;var s,l,f,v;if(D.size()){var g=c.getTranslate(D.node().parentNode);t.offsetLeft=g.x;t.offsetTop=g.y}var m=10+o*a+(d.linewidth?d.linewidth-1:0);if(n==="x"){l=d.anchor==="free"?{_offset:i.t+(1-(d.position||0))*i.h,_length:0}:T.getFromId(e,d.anchor);f=d._offset+d._length/2;if(d.side==="top"){v=-m-o*(d.showticklabels?1:0)}else{v=l._length+m+o*(d.showticklabels?1.5:.5)}v+=l._offset;if(!t.side)t.side="bottom"}else{l=d.anchor==="free"?{_offset:i.l+(d.position||0)*i.w,_length:0}:T.getFromId(e,d.anchor);v=d._offset+d._length/2;if(d.side==="right"){f=l._length+m+o*(d.showticklabels?1:.5)}else{f=-m-o*(d.showticklabels?.5:0)}f+=l._offset;s={rotate:"-90",offset:0};if(!t.side)t.side="left"}u.draw(e,p+"title",{propContainer:d,propName:d._name+".title",placeholder:h._dfltTitle[n],avoid:t,transform:s,attributes:{x:f,y:v,"text-anchor":"middle"}})}function X(e,t){if(e.visible!==true||e.xaxis+e.yaxis!==t)return false;if(o.traceIs(e,"bar")&&e.orientation==={x:"h",y:"v"}[g])return true;return e.fill&&e.fill.charAt(e.fill.length-1)===g}function Y(t,r,i){if(h._hasOnlyLargeSploms)return;var a=t.gridlayer.selectAll("."+p);var o=t.zerolinelayer;var l=t["hidegrid"+g]?[]:H;var u=d._gridpath||(g==="x"?"M0,"+r._offset+"v":"M"+r._offset+",0h")+r._length;var c=a.selectAll("path."+A).data(d.showgrid===false?[]:l,b);c.enter().append("path").classed(A,1).classed("crisp",1).attr("d",u).each(function(e){if(d.zeroline&&(d.type==="linear"||d.type==="-")&&Math.abs(e.x)<d.dtick/100){n.select(this).remove()}});c.attr("transform",R).call(f.stroke,d.gridcolor||"#ddd").style("stroke-width",C+"px");if(typeof u==="function")c.attr("d",u);c.exit().remove();if(o){var v=false;for(var m=0;m<e._fullData.length;m++){if(X(e._fullData[m],i)){v=true;break}}var y=s.simpleMap(d.range,d.r2l),x=y[0]*y[1]<=0&&d.zeroline&&(d.type==="linear"||d.type==="-")&&l.length&&(v||V({x:0})||!d.showline);var _=o.selectAll("path."+k).data(x?[{x:0,id:p}]:[]);_.enter().append("path").classed(k,1).classed("zl",1).classed("crisp",1).attr("d",u).each(function(){o.selectAll("path").sort(function(e,t){return T.idSort(e.id,t.id)})});_.attr("transform",R).call(f.stroke,d.zerolinecolor||f.defaultLine).style("stroke-width",I+"px");_.exit().remove()}}if(v){q(d._axislayer,N(d._pos+E*U[2],U[2]*d.ticklen));if(d._counteraxis){var Z={gridlayer:d._gridlayer,zerolinelayer:d._zerolinelayer};Y(Z,d._counteraxis)}return G(d._axislayer,d._pos)}else if(h._has("cartesian")){z=M.getSubplots(e,d);var Q={};z.map(function(e){var t=h._plots[e];var r=t[m+"axis"];var n=r._mainAxis._id;if(Q[n])return;Q[n]=1;Y(t,r,e)});var K=d._mainSubplot;var J=h._plots[K];var $=[];if(d.ticks){var ee=U[2];var te=N(d._mainLinePosition+E*ee,ee*d.ticklen);if(d._anchorAxis&&d.mirror&&d.mirror!==true){te+=N(d._mainMirrorPosition-E*ee,-ee*d.ticklen)}q(J[g+"axislayer"],te);$=Object.keys(d._linepositions||{})}$.map(function(e){var t=h._plots[e];var r=t[g+"axislayer"];var n=d._linepositions[e]||[];function i(e){var t=U[e];return N(n[e]+E*t,t*d.ticklen)}q(r,i(0)+i(1))});var re=J[g+"axislayer"];return G(re,d._mainLinePosition)}};M.allowAutoMargin=function(e){var t=M.list(e,"",true);for(var r=0;r<t.length;r++){var n=t[r];if(n.automargin){a.allowAutoMargin(e,n._name+".automargin")}if(n.rangeslider&&n.rangeslider.visible){a.allowAutoMargin(e,"rangeslider"+n._id)}}};M.swap=function(e,t){var r=$(e,t);for(var n=0;n<r.length;n++){te(e,r[n].x,r[n].y)}};function $(e,t){var r=[],n,i;for(n=0;n<t.length;n++){var a=[],o=e._fullData[t[n]].xaxis,s=e._fullData[t[n]].yaxis;if(!o||!s)continue;for(i=0;i<r.length;i++){if(r[i].x.indexOf(o)!==-1||r[i].y.indexOf(s)!==-1){a.push(i)}}if(!a.length){r.push({x:[o],y:[s]});continue}var l=r[a[0]],u;if(a.length>1){for(i=1;i<a.length;i++){u=r[a[i]];ee(l.x,u.x);ee(l.y,u.y)}}ee(l.x,[o]);ee(l.y,[s])}return r}function ee(e,t){for(var r=0;r<t.length;r++){if(e.indexOf(t[r])===-1)e.push(t[r])}}function te(e,t,r){var n,i,a=[],o=[],l=e.layout;for(n=0;n<t.length;n++)a.push(M.getFromId(e,t[n]));for(n=0;n<r.length;n++)o.push(M.getFromId(e,r[n]));var u=Object.keys(a[0]),f=["anchor","domain","overlaying","position","side","tickangle"],c=["linear","log"];for(n=0;n<u.length;n++){var h=u[n],v=a[0][h],d=o[0][h],p=true,g=false,m=false;if(h.charAt(0)==="_"||typeof v==="function"||f.indexOf(h)!==-1){continue}for(i=1;i<a.length&&p;i++){var y=a[i][h];if(h==="type"&&c.indexOf(v)!==-1&&c.indexOf(y)!==-1&&v!==y){g=true}else if(y!==v)p=false}for(i=1;i<o.length&&p;i++){var b=o[i][h];if(h==="type"&&c.indexOf(d)!==-1&&c.indexOf(b)!==-1&&d!==b){m=true}else if(o[i][h]!==d)p=false}if(p){if(g)l[a[0]._name].type="linear";if(m)l[o[0]._name].type="linear";re(l,h,a,o,e._fullLayout._dfltTitle)}}for(n=0;n<e._fullLayout.annotations.length;n++){var x=e._fullLayout.annotations[n];if(t.indexOf(x.xref)!==-1&&r.indexOf(x.yref)!==-1){s.swapAttrs(l.annotations[n],["?"])}}}function re(e,t,r,n,i){var a=s.nestedProperty,o=a(e[r[0]._name],t).get(),l=a(e[n[0]._name],t).get(),u;if(t==="title"){if(o===i.x){o=i.y}if(l===i.y){l=i.x}}for(u=0;u<r.length;u++){a(e,r[u]._name+"."+t).set(l)}for(u=0;u<n.length;u++){a(e,n[u]._name+"."+t).set(o)}}},{"../../components/color":361,"../../components/drawing":386,"../../components/titles":452,"../../constants/alignment":459,"../../constants/numerical":463,"../../lib":483,"../../lib/svg_text_utils":506,"../../plots/plots":573,"../../registry":582,"./autorange":528,"./axis_autotype":530,"./axis_ids":532,"./set_convert":547,d3:81,"fast-isnumeric":91}],530:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");var a=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){if(s(t,r))return"date";if(l(t))return"category";if(o(t))return"linear";else return"-"};function o(e){if(!e)return false;for(var t=0;t<e.length;t++){if(n(e[t]))return true}return false}function s(e,t){var r=0,a=0,o=Math.max(1,(e.length-1)/1e3),s;for(var l=0;l<e.length;l+=o){s=e[Math.round(l)];if(i.isDateTime(s,t))r+=1;if(n(s))a+=1}return r>a*2}function l(e){var t=Math.max(1,(e.length-1)/1e3),r=0,n=0,o;for(var s=0;s<e.length;s+=t){o=e[Math.round(s)];if(i.cleanNumber(o)!==a)r++;else if(typeof o==="string"&&o!==""&&o!=="None")n++}return n>r*2}},{"../../constants/numerical":463,"../../lib":483,"fast-isnumeric":91}],531:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");var a=e("./layout_attributes");var o=e("./tick_value_defaults");var s=e("./tick_mark_defaults");var l=e("./tick_label_defaults");var u=e("./category_order_defaults");var f=e("./line_grid_defaults");var c=e("./set_convert");t.exports=function e(t,r,h,v,d){var p=v.letter;var g=r._id;var m=v.font||{};var y=h("visible",!v.cheateronly);var b=r.type;if(b==="date"){var x=n.getComponentMethod("calendars","handleDefaults");x(t,r,"calendar",v.calendar)}c(r,d);var _=h("autorange",!r.isValidRange(t.range));r._rangesliderAutorange=false;if(_)h("rangemode");h("range");r.cleanRange();u(t,r,h,v);if(b!=="category"&&!v.noHover)h("hoverformat");if(!y)return r;var w=h("color");var M=w!==a.color.dflt?w:m.color;var A=((d._splomAxes||{})[p]||{})[g]||d._dfltTitle[p];h("title",A);i.coerceFont(h,"titlefont",{family:m.family,size:Math.round(m.size*1.2),color:M});o(t,r,h,b);l(t,r,h,b,v);s(t,r,h,v);f(t,r,h,{dfltColor:w,bgColor:v.bgColor,showGrid:v.showGrid,attributes:a});if(r.showline||r.ticks)h("mirror");if(v.automargin)h("automargin");return r}},{"../../lib":483,"../../registry":582,"./category_order_defaults":533,"./layout_attributes":541,"./line_grid_defaults":543,"./set_convert":547,"./tick_label_defaults":548,"./tick_mark_defaults":549,"./tick_value_defaults":550}],532:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("./constants");r.id2name=function e(t){if(typeof t!=="string"||!t.match(i.AX_ID_PATTERN))return;var r=t.substr(1);if(r==="1")r="";return t.charAt(0)+"axis"+r};r.name2id=function e(t){if(!t.match(i.AX_NAME_PATTERN))return;var r=t.substr(5);if(r==="1")r="";return t.charAt(0)+r};r.cleanId=function e(t,r){if(!t.match(i.AX_ID_PATTERN))return;if(r&&t.charAt(0)!==r)return;var n=t.substr(1).replace(/^0+/,"");if(n==="1")n="";return t.charAt(0)+n};r.list=function(e,t,n){var i=e._fullLayout;if(!i)return[];var a=r.listIds(e,t);var o=new Array(a.length);var s;for(s=0;s<a.length;s++){var l=a[s];o[s]=i[l.charAt(0)+"axis"+l.substr(1)]}if(!n){var u=i._subplots.gl3d||[];for(s=0;s<u.length;s++){var f=i[u[s]];if(t)o.push(f[t+"axis"]);else o.push(f.xaxis,f.yaxis,f.zaxis)}}return o};r.listIds=function(e,t){var r=e._fullLayout;if(!r)return[];var n=r._subplots;if(t)return n[t+"axis"];return n.xaxis.concat(n.yaxis)};r.getFromId=function(e,t,n){var i=e._fullLayout;if(n==="x")t=t.replace(/y[0-9]*/,"");else if(n==="y")t=t.replace(/x[0-9]*/,"");return i[r.id2name(t)]};r.getFromTrace=function(e,t,i){var a=e._fullLayout;var o=null;if(n.traceIs(t,"gl3d")){var s=t.scene;if(s.substr(0,5)==="scene"){o=a[s][i+"axis"]}}else{o=r.getFromId(e,t[i+"axis"]||i)}return o};r.idSort=function(e,t){var r=e.charAt(0);var n=t.charAt(0);if(r!==n)return r>n?1:-1;return+(e.substr(1)||1)-+(t.substr(1)||1)}},{"../../registry":582,"./constants":534}],533:[function(e,t,r){"use strict";function n(e,t){var r=t.dataAttr||e._id.charAt(0);var n={};var i;var a,o;if(t.axData){i=t.axData}else{i=[];for(a=0;a<t.data.length;a++){var s=t.data[a];if(s[r+"axis"]===e._id){i.push(s)}}}for(a=0;a<i.length;a++){var l=i[a][r];for(o=0;o<l.length;o++){var u=l[o];if(u!==null&&u!==undefined){n[u]=1}}}return Object.keys(n)}t.exports=function e(t,r,i,a){if(r.type!=="category")return;var o=t.categoryarray;var s=Array.isArray(o)&&o.length>0;var l;if(s)l="array";var u=i("categoryorder",l);var f;if(u==="array"){f=i("categoryarray")}if(!s&&u==="array"){u=r.categoryorder="trace"}if(u==="trace"){r._initialCategories=[]}else if(u==="array"){r._initialCategories=f.slice()}else{f=n(r,a).sort();if(u==="category ascending"){r._initialCategories=f}else if(u==="category descending"){r._initialCategories=f.reverse()}}}},{}],534:[function(e,t,r){"use strict";var n=e("../../lib/regex").counter;t.exports={idRegex:{x:n("x"),y:n("y")},attrRegex:n("[xy]axis"),xAxisMatch:n("xaxis"),yAxisMatch:n("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["heatmaplayer","contourcarpetlayer","contourlayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":498}],535:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./axis_ids").id2name;t.exports=function e(t,r,i,s,l){var u=l._axisConstraintGroups;var f=r._id;var c=f.charAt(0);if(r.fixedrange)return;i("constrain");n.coerce(t,r,{constraintoward:{valType:"enumerated",values:c==="x"?["left","center","right"]:["bottom","middle","top"],dflt:c==="x"?"center":"middle"}},"constraintoward");if(!t.scaleanchor)return;var h=a(u,f,s,l);var v=n.coerce(t,r,{scaleanchor:{valType:"enumerated",values:h.linkableAxes}},"scaleanchor");if(v){var d=i("scaleratio");if(!d)d=r.scaleratio=1;o(u,h.thisGroup,f,v,d)}else if(s.indexOf(t.scaleanchor)!==-1){n.warn("ignored "+r._name+'.scaleanchor: "'+t.scaleanchor+'" to avoid either an infinite loop '+"and possibly inconsistent scaleratios, or because the target"+"axis has fixed range.")}};function a(e,t,r,n){var a=n[i(t)].type;var o,s,l,u;var f=[];for(s=0;s<r.length;s++){l=r[s];if(l===t)continue;u=n[i(l)];if(u.type===a&&!u.fixedrange)f.push(l)}for(o=0;o<e.length;o++){if(e[o][t]){var c=e[o];var h=[];for(s=0;s<f.length;s++){l=f[s];if(!c[l])h.push(l)}return{linkableAxes:h,thisGroup:c}}}return{linkableAxes:f,thisGroup:null}}function o(e,t,r,n,i){var a,o,s,l,u;if(t===null){t={};t[r]=1;u=e.length;e.push(t)}else{u=e.indexOf(t)}var f=Object.keys(t);for(a=0;a<e.length;a++){s=e[a];if(a!==u&&s[n]){var c=s[n];for(o=0;o<f.length;o++){l=f[o];s[l]=c*i*t[l]}e.splice(u,1);return}}if(i!==1){for(o=0;o<f.length;o++){t[f[o]]*=i}}t[n]=1}},{"../../lib":483,"./axis_ids":532}],536:[function(e,t,r){"use strict";var n=e("./axis_ids").id2name;var i=e("./scale_zoom");var a=e("./autorange").makePadFn;var o=e("../../constants/numerical").ALMOST_EQUAL;var s=e("../../constants/alignment").FROM_BL;r.enforce=function e(t){var r=t._fullLayout;var s=r._axisConstraintGroups||[];var u,f,c,h,v,d,p;for(u=0;u<s.length;u++){var g=s[u];var m=Object.keys(g);var y=Infinity;var b=0;var x=Infinity;var _={};var w={};var M=false;for(f=0;f<m.length;f++){c=m[f];w[c]=h=r[n(c)];if(h._inputDomain)h.domain=h._inputDomain.slice();else h._inputDomain=h.domain.slice();if(!h._inputRange)h._inputRange=h.range.slice();h.setScale();_[c]=v=Math.abs(h._m)/g[c];y=Math.min(y,v);if(h.constrain==="domain"||!h._constraintShrinkable){x=Math.min(x,v)}delete h._constraintShrinkable;b=Math.max(b,v);if(h.constrain==="domain")M=true}if(y>o*b&&!M)continue;for(f=0;f<m.length;f++){c=m[f];v=_[c];h=w[c];d=h.constrain;if(v!==x||d==="domain"){p=v/x;if(d==="range"){i(h,p)}else{var A=h._inputDomain;var T=(h.domain[1]-h.domain[0])/(A[1]-A[0]);var k=(h.r2l(h.range[1])-h.r2l(h.range[0]))/(h.r2l(h._inputRange[1])-h.r2l(h._inputRange[0]));p/=T;if(p*k<1){h.domain=h._input.domain=A.slice();i(h,p);continue}if(k<1){h.range=h._input.range=h._inputRange.slice();p*=k}if(h.autorange&&h._min.length&&h._max.length){var E=h.r2l(h.range[0]);var S=h.r2l(h.range[1]);var L=(E+S)/2;var C=L;var I=L;var P=Math.abs(S-L);var O=L-P*p*1.0001;var R=L+P*p*1.0001;var N=a(h);l(h,p);h.setScale();var z=Math.abs(h._m);var D;var F;for(F=0;F<h._min.length;F++){D=h._min[F].val-N(h._min[F])/z;if(D>O&&D<C){C=D}}for(F=0;F<h._max.length;F++){D=h._max[F].val+N(h._max[F])/z;if(D<R&&D>I){I=D}}var j=(I-C)/(2*P);p/=j;C=h.l2r(C);I=h.l2r(I);h.range=h._input.range=E<S?[C,I]:[I,C]}l(h,p)}}}}};r.clean=function e(t,r){if(r._inputDomain){var n=false;var i=r._id;var a=t._fullLayout._axisConstraintGroups;for(var o=0;o<a.length;o++){if(a[o][i]){n=true;break}}if(!n||r.constrain!=="domain"){r._input.domain=r.domain=r._inputDomain;delete r._inputDomain}}};function l(e,t){var r=e._inputDomain;var n=s[e.constraintoward];var i=r[0]+(r[1]-r[0])*n;e.domain=e._input.domain=[i+(r[0]-i)/t,i+(r[1]-i)/t]}},{"../../constants/alignment":459,"../../constants/numerical":463,"./autorange":528,"./axis_ids":532,"./scale_zoom":545}],537:[function(e,t,r){"use strict";var n=e("d3");var i=e("tinycolor2");var a=e("has-passive-events");var o=e("../../registry");var s=e("../../lib");var l=e("../../lib/svg_text_utils");var u=e("../../lib/clear_gl_canvases");var f=e("../../components/color");var c=e("../../components/drawing");var h=e("../../components/fx");var v=e("../../lib/setcursor");var d=e("../../components/dragelement");var p=e("../../constants/alignment").FROM_TL;var g=e("../plots");var m=e("./axes").doTicksSingle;var y=e("./axis_ids").getFromId;var b=e("./select").prepSelect;var x=e("./select").clearSelect;var _=e("./scale_zoom");var w=e("./constants");var M=w.MINDRAG;var A=w.MINZOOM;var T=true;function k(e,t,r,a,f,v,T,k){var E=e._fullLayout._zoomlayer;var F=T+k==="nsew";var Y=(T+k).length===1;var Z,Q;var K,J;var $,ee;var te,re;var ne,ie;var ae;var oe,se;var le;var ue;var fe,ce;var he,ve,de,pe;function ge(){Z=t.xaxis;Q=t.yaxis;ne=Z._length;ie=Q._length;te=Z._offset;re=Q._offset;K={};K[Z._id]=Z;J={};J[Q._id]=Q;if(T&&k){var r=t.overlays;for(var n=0;n<r.length;n++){var i=r[n].xaxis;K[i._id]=i;var a=r[n].yaxis;J[a._id]=a}}$=X(K);ee=X(J);oe=L($,k);se=L(ee,T);le=!se&&!oe;ae=G(e,K,J);ue=ae.isSubplotConstrained;fe=k||ue;ce=T||ue;var o=e._fullLayout;he=o._has("scattergl");ve=o._hasOnlyLargeSploms;de=ve||o._has("splom");pe=o._has("svg")}ge();var me=R(se+oe,e._fullLayout.dragmode,F);var ye=S(t,T+k+"drag",me,r,a,f,v);if(le&&!F){ye.onmousedown=null;ye.style.pointerEvents="none";return ye}var be={element:ye,gd:e,plotinfo:t};be.prepFn=function(t,r,n){var i=e._fullLayout.dragmode;ge();if(!le){if(F){if(t.shiftKey){if(i==="pan")i="zoom";else if(!U(i))i="pan"}else if(t.ctrlKey){i="pan"}}else i="pan"}if(i==="lasso")be.minDrag=1;else be.minDrag=undefined;if(U(i)){be.xaxes=$;be.yaxes=ee;b(t,r,n,be,i)}else{be.clickFn=_e;xe();if(!le){if(i==="zoom"){be.moveFn=Re;be.doneFn=Ne;be.minDrag=1;Oe(t,r,n)}else if(i==="pan"){be.moveFn=Ue;be.doneFn=qe}}}};function xe(){be.plotinfo.selection=false;x(E)}function _e(r,i){j(e);if(r===2&&!Y)He();if(F){h.click(e,i,t.id)}else if(r===1&&Y){var a=T?Q:Z,s=T==="s"||k==="w"?0:1,u=a._name+".range["+s+"]",f=C(a,s),c="left",v="middle";if(a.fixedrange)return;if(T){v=T==="n"?"top":"bottom";if(a.side==="right")c="right"}else if(k==="e")c="right";if(e._context.showAxisRangeEntryBoxes){n.select(ye).call(l.makeEditable,{gd:e,immediate:true,background:e._fullLayout.paper_bgcolor,text:String(f),fill:a.tickfont?a.tickfont.color:"#444",horizontalAlign:c,verticalAlign:v}).on("edit",function(t){var r=a.d2r(t);if(r!==undefined){o.call("relayout",e,u,r)}})}}}d.init(be);var we,Me,Ae,Te,ke,Ee,Se,Le,Ce;var Ie;var Pe={};function Oe(t,r,n){var a=ye.getBoundingClientRect();we=r-a.left;Me=n-a.top;Ae={l:we,r:we,w:0,t:Me,b:Me,h:0};Te=e._hmpixcount?e._hmlumcount/e._hmpixcount:i(e._fullLayout.plot_bgcolor).getLuminance();ke="M0,0H"+ne+"V"+ie+"H0V0";Ee=false;Se="xy";Ie=false;Le=N(E,Te,te,re,ke);Ce=z(E,te,re)}function Re(t,r){if(e._transitioningWithDuration){return false}var n=Math.max(0,Math.min(ne,t+we)),i=Math.max(0,Math.min(ie,r+Me)),a=Math.abs(n-we),o=Math.abs(i-Me);Ae.l=Math.min(we,n);Ae.r=Math.max(we,n);Ae.t=Math.min(Me,i);Ae.b=Math.max(Me,i);function s(){Se="";Ae.r=Ae.l;Ae.t=Ae.b;Ce.attr("d","M0,0Z")}if(ue){if(a>A||o>A){Se="xy";if(a/ne>o/ie){o=a*ie/ne;if(Me>i)Ae.t=Me-o;else Ae.b=Me+o}else{a=o*ne/ie;if(we>n)Ae.l=we-a;else Ae.r=we+a}Ce.attr("d",q(Ae))}else{s()}}else if(!se||o<Math.min(Math.max(a*.6,M),A)){if(a<M||!oe){s()}else{Ae.t=0;Ae.b=ie;Se="x";Ce.attr("d",V(Ae,Me))}}else if(!oe||a<Math.min(o*.6,A)){Ae.l=0;Ae.r=ne;Se="y";Ce.attr("d",H(Ae,we))}else{Se="xy";Ce.attr("d",q(Ae))}Ae.w=Ae.r-Ae.l;Ae.h=Ae.b-Ae.t;if(Se)Ie=true;e._dragged=Ie;D(Le,Ce,Ae,ke,Ee,Te);Ee=true}function Ne(){if(Math.min(Ae.h,Ae.w)<M*2){return j(e)}if(Se==="xy"||Se==="x"){I($,Ae.l/ne,Ae.r/ne,Pe,ae.xaxes)}if(Se==="xy"||Se==="y"){I(ee,(ie-Ae.b)/ie,(ie-Ae.t)/ie,Pe,ae.yaxes)}j(e);qe();B(e)}var ze=[0,0,ne,ie];var De=null;var Fe=w.REDRAWDELAY;var je=t.mainplot?e._fullLayout._plots[t.mainplot]:t;function Be(t){if(!e._context.scrollZoom&&!e._fullLayout._enablescrollzoom){return}xe();if(e._transitioningWithDuration){t.preventDefault();t.stopPropagation();return}var r=e.querySelector(".plotly");ge();if(r.scrollHeight-r.clientHeight>10||r.scrollWidth-r.clientWidth>10){return}clearTimeout(De);var n=-t.deltaY;if(!isFinite(n))n=t.wheelDelta/10;if(!isFinite(n)){s.log("Did not find wheel motion attributes: ",t);return}var i=Math.exp(-Math.min(Math.max(n,-20),20)/200),a=je.draglayer.select(".nsewdrag").node().getBoundingClientRect(),o=(t.clientX-a.left)/a.width,l=(a.bottom-t.clientY)/a.height,u;function f(e,t,r){if(e.fixedrange)return;var n=s.simpleMap(e.range,e.r2l),i=n[0]+(n[1]-n[0])*t;function a(t){return e.l2r(i+(t-i)*r)}e.range=n.map(a)}if(fe){if(!k)o=.5;for(u=0;u<$.length;u++){f($[u],o,i)}ze[2]*=i;ze[0]+=ze[2]*o*(1/i-1)}if(ce){if(!T)l=.5;for(u=0;u<ee.length;u++){f(ee[u],l,i)}ze[3]*=i;ze[1]+=ze[3]*(1-l)*(1/i-1)}Xe(ze);Ve(T,k);De=setTimeout(function(){ze=[0,0,ne,ie];qe()},Fe);t.preventDefault();return}if(T.length*k.length!==1){W(ye,Be)}function Ue(t,r){if(e._transitioningWithDuration){return}if(oe==="ew"||se==="ns"){if(oe)P($,t);if(se)P(ee,r);Xe([oe?-t:0,se?-r:0,ne,ie]);Ve(se,oe);return}function n(e,t,r){var n=1-t,i,a;for(var o=0;o<e.length;o++){var s=e[o];if(s.fixedrange)continue;i=s;a=s._rl[n]+(s._rl[t]-s._rl[n])/O(r/s._length);var l=s.l2r(a);if(l!==false&&l!==undefined)s.range[t]=l}return i._length*(i._rl[t]-a)/(i._rl[t]-i._rl[n])}if(ue&&oe&&se){var i=oe==="w"===(se==="n")?1:-1;var a=(t/ne+i*r/ie)/2;t=a*ne;r=i*a*ie}if(oe==="w")t=n($,0,t);else if(oe==="e")t=n($,1,-t);else if(!oe)t=0;if(se==="n")r=n(ee,1,r);else if(se==="s")r=n(ee,0,-r);else if(!se)r=0;var o=oe==="w"?t:0;var s=se==="n"?r:0;if(ue){var l;if(!oe&&se.length===1){for(l=0;l<$.length;l++){$[l].range=$[l]._r.slice();_($[l],1-r/ie)}t=r*ne/ie;o=t/2}if(!se&&oe.length===1){for(l=0;l<ee.length;l++){ee[l].range=ee[l]._r.slice();_(ee[l],1-t/ne)}r=t*ie/ne;s=r/2}}Xe([o,s,ne-t,ie-r]);Ve(se,oe)}function Ve(t,r){var n=[],i;function a(e){for(i=0;i<e.length;i++){if(!e[i].fixedrange)n.push(e[i]._id)}}if(fe){a($);a(ae.xaxes)}if(ce){a(ee);a(ae.yaxes)}Pe={};for(i=0;i<n.length;i++){var s=n[i];m(e,s,true);var l=y(e,s);Pe[l._name+".range[0]"]=l.range[0];Pe[l._name+".range[1]"]=l.range[1]}function u(a,o,s){for(i=0;i<a.length;i++){var l=a[i];if(r&&n.indexOf(l.xref)!==-1||t&&n.indexOf(l.yref)!==-1){o(e,i);if(s)return}}}u(e._fullLayout.annotations||[],o.getComponentMethod("annotations","drawOne"));u(e._fullLayout.shapes||[],o.getComponentMethod("shapes","drawOne"));u(e._fullLayout.images||[],o.getComponentMethod("images","draw"),true)}function He(){if(e._transitioningWithDuration)return;var t=e._context.doubleClick,r=(oe?$:[]).concat(se?ee:[]),n={};var i,a,s;if(t==="reset+autosize"){t="autosize";for(a=0;a<r.length;a++){i=r[a];if(i._rangeInitial&&(i.range[0]!==i._rangeInitial[0]||i.range[1]!==i._rangeInitial[1])||!i._rangeInitial&&!i.autorange){t="reset";break}}}if(t==="autosize"){for(a=0;a<r.length;a++){i=r[a];if(!i.fixedrange)n[i._name+".autorange"]=true}}else if(t==="reset"){if(oe||ue)r=r.concat(ae.xaxes);if(se&&!ue)r=r.concat(ae.yaxes);if(ue){if(!oe)r=r.concat($);else if(!se)r=r.concat(ee)}for(a=0;a<r.length;a++){i=r[a];if(!i._rangeInitial){n[i._name+".autorange"]=true}else{s=i._rangeInitial;n[i._name+".range[0]"]=s[0];n[i._name+".range[1]"]=s[1]}}}e.emit("plotly_doubleclick",null);o.call("relayout",e,n)}function qe(){Xe([0,0,ne,ie]);s.syncOrAsync([g.previousPromises,function(){o.call("relayout",e,Pe)}],e)}var Ge,We;function Xe(t){var r=e._fullLayout;var n=r._plots;var i=r._subplots.cartesian;var a,l,f,h;if(de||he){u(e)}if(de){o.subplotsRegistry.splom.drag(e);if(ve)return}if(he){for(a=0;a<i.length;a++){l=n[i[a]];f=l.xaxis;h=l.yaxis;var v=l._scene;if(v){var d=s.simpleMap(f.range,f.r2l);var p=s.simpleMap(h.range,h.r2l);v.update({range:[d[0],p[0],d[1],p[1]]})}}}if(pe){var g=t[2]/Z._length;var m=t[3]/Q._length;for(a=0;a<i.length;a++){l=n[i[a]];f=l.xaxis;h=l.yaxis;var y=fe&&!f.fixedrange&&K[f._id];var b=ce&&!h.fixedrange&&J[h._id];var x,_;var w,M;if(y){x=g;w=k?t[0]:Qe(f,x)}else{x=Ye(f,g,m);w=Ze(f,x)}if(b){_=m;M=T?t[1]:Qe(h,_)}else{_=Ye(h,g,m);M=Ze(h,_)}if(!x&&!_){continue}if(!x)x=1;if(!_)_=1;var A=f._offset-w/x;var E=h._offset-M/_;l.clipRect.call(c.setTranslate,w,M).call(c.setScale,x,_);l.plot.call(c.setTranslate,A,E).call(c.setScale,1/x,1/_);if(x!==Ge||_!==We){c.setPointGroupScale(l.zoomScalePts,x,_);c.setTextPointsScale(l.zoomScaleTxt,x,_)}c.hideOutsideRangePoints(l.clipOnAxisFalseTraces,l);Ge=x;We=_}}}function Ye(e,t,r){if(e.fixedrange)return 0;if(fe&&ae.xaHash[e._id]){return t}if(ce&&(ue?ae.xaHash:ae.yaHash)[e._id]){return r}return 0}function Ze(e,t){if(t){e.range=e._r.slice();_(e,t);return Qe(e,t)}return 0}function Qe(e,t){return e._length*(1-t)*p[e.constraintoward||"middle"]}return ye}function E(e,t,r,n){var i=s.ensureSingle(e.draglayer,t,r,function(t){t.classed("drag",true).style({fill:"transparent","stroke-width":0}).attr("data-subplot",e.id)});i.call(v,n);return i.node()}function S(e,t,r,i,a,o,s){var l=E(e,"rect",t,r);n.select(l).call(c.setRect,i,a,o,s);return l}function L(e,t){for(var r=0;r<e.length;r++){if(!e[r].fixedrange)return t}return""}function C(e,t){var r=e.range[t],i=Math.abs(r-e.range[1-t]),a;if(e.type==="date"){return r}else if(e.type==="log"){a=Math.ceil(Math.max(0,-Math.log(i)/Math.LN10))+3;return n.format("."+a+"g")(Math.pow(10,r))}else{a=Math.floor(Math.log(Math.abs(r))/Math.LN10)-Math.floor(Math.log(i)/Math.LN10)+4;return n.format("."+String(a)+"g")(r)}}function I(e,t,r,n,i){var a,o,s,l;for(a=0;a<e.length;a++){o=e[a];if(o.fixedrange)continue;s=o._rl[0];l=o._rl[1]-s;o.range=[o.l2r(s+l*t),o.l2r(s+l*r)];n[o._name+".range[0]"]=o.range[0];n[o._name+".range[1]"]=o.range[1]}if(i&&i.length){var u=(t+(1-r))/2;I(i,u,1-u,n)}}function P(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!n.fixedrange){n.range=[n.l2r(n._rl[0]-t/n._m),n.l2r(n._rl[1]-t/n._m)]}}}function O(e){return 1-(e>=0?Math.min(e,.9):1/(1/Math.max(e,-.3)+3.222))}function R(e,t,r){if(!e)return"pointer";if(e==="nsew"){if(r)return"";if(t==="pan")return"move";return"crosshair"}return e.toLowerCase()+"-resize"}function N(e,t,r,n,i){return e.append("path").attr("class","zoombox").style({fill:t>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform","translate("+r+", "+n+")").attr("d",i+"Z")}function z(e,t,r){return e.append("path").attr("class","zoombox-corners").style({fill:f.background,stroke:f.defaultLine,"stroke-width":1,opacity:0}).attr("transform","translate("+t+", "+r+")").attr("d","M0,0Z")}function D(e,t,r,n,i,a){e.attr("d",n+"M"+r.l+","+r.t+"v"+r.h+"h"+r.w+"v-"+r.h+"h-"+r.w+"Z");F(e,t,i,a)}function F(e,t,r,n){if(!r){e.transition().style("fill",n>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200);t.transition().style("opacity",1).duration(200)}}function j(e){n.select(e).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function B(e){if(T&&e.data&&e._context.showTips){s.notifier(s._(e,"Double-click to zoom back out"),"long");T=false}}function U(e){return e==="lasso"||e==="select"}function V(e,t){return"M"+(e.l-.5)+","+(t-A-.5)+"h-3v"+(2*A+1)+"h3ZM"+(e.r+.5)+","+(t-A-.5)+"h3v"+(2*A+1)+"h-3Z"}function H(e,t){return"M"+(t-A-.5)+","+(e.t-.5)+"v-3h"+(2*A+1)+"v3ZM"+(t-A-.5)+","+(e.b+.5)+"v3h"+(2*A+1)+"v-3Z"}function q(e){var t=Math.floor(Math.min(e.b-e.t,e.r-e.l,A)/2);return"M"+(e.l-3.5)+","+(e.t-.5+t)+"h3v"+-t+"h"+t+"v-3h-"+(t+3)+"ZM"+(e.r+3.5)+","+(e.t-.5+t)+"h-3v"+-t+"h"+-t+"v-3h"+(t+3)+"ZM"+(e.r+3.5)+","+(e.b+.5-t)+"h-3v"+t+"h"+-t+"v3h"+(t+3)+"ZM"+(e.l-3.5)+","+(e.b+.5-t)+"h3v"+t+"h"+t+"v3h-"+(t+3)+"Z"}function G(e,t,r){var n=e._fullLayout._axisConstraintGroups;var i=false;var a={};var o={};var l,u,f,c;for(var h=0;h<n.length;h++){var v=n[h];for(l in t){if(v[l]){for(f in v){if(!(f.charAt(0)==="x"?t:r)[f]){a[f]=1}}for(u in r){if(v[u])i=true}}}for(u in r){if(v[u]){for(c in v){if(!(c.charAt(0)==="x"?t:r)[c]){o[c]=1}}}}}if(i){s.extendFlat(a,o);o={}}var d={};var p=[];for(f in a){var g=y(e,f);p.push(g);d[g._id]=g}var m={};var b=[];for(c in o){var x=y(e,c);b.push(x);m[x._id]=x}return{xaHash:d,yaHash:m,xaxes:p,yaxes:b,isSubplotConstrained:i}}function W(e,t){if(!a){if(e.onwheel!==undefined)e.onwheel=t;else if(e.onmousewheel!==undefined)e.onmousewheel=t}else{var r=e.onwheel!==undefined?"wheel":"mousewheel";if(e._onwheel){e.removeEventListener(r,e._onwheel)}e._onwheel=t;e.addEventListener(r,t,{passive:false})}}function X(e){var t=[];for(var r in e)t.push(e[r]);return t}t.exports={makeDragBox:k,makeDragger:E,makeRectDragger:S,makeZoombox:N,makeCorners:z,updateZoombox:D,xyCorners:q,transitionZoombox:F,removeZoombox:j,showDoubleClickNotifier:B,attachWheelEventHandler:W}},{"../../components/color":361,"../../components/dragelement":383,"../../components/drawing":386,"../../components/fx":403,"../../constants/alignment":459,"../../lib":483,"../../lib/clear_gl_canvases":470,"../../lib/setcursor":502,"../../lib/svg_text_utils":506,"../../registry":582,"../plots":573,"./axes":529,"./axis_ids":532,"./constants":534,"./scale_zoom":545,"./select":546,d3:81,"has-passive-events":237,tinycolor2:327}],538:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../components/fx");var a=e("../../components/dragelement");var o=e("../../lib/setcursor");var s=e("./dragbox").makeDragBox;var l=e("./constants").DRAGGERSIZE;r.initInteractions=function e(t){var o=t._fullLayout;if(t._context.staticPlot){n.select(t).selectAll(".drag").remove();return}if(!o._has("cartesian")&&!o._has("gl2d")&&!o._has("splom"))return;var u=Object.keys(o._plots||{}).sort(function(e,t){if((o._plots[e].mainplot&&true)===(o._plots[t].mainplot&&true)){var r=e.split("y"),n=t.split("y");return r[0]===n[0]?Number(r[1]||1)-Number(n[1]||1):Number(r[0]||1)-Number(n[0]||1)}return o._plots[e].mainplot?1:-1});u.forEach(function(e){var r=o._plots[e];var n=r.xaxis;var u=r.yaxis;if(!r.mainplot){var f=s(t,r,n._offset,u._offset,n._length,u._length,"ns","ew");f.onmousemove=function(r){t._fullLayout._rehover=function(){if(t._fullLayout._hoversubplot===e){i.hover(t,r,e)}};i.hover(t,r,e);t._fullLayout._lasthover=f;t._fullLayout._hoversubplot=e};f.onmouseout=function(e){if(t._dragging)return;t._fullLayout._hoversubplot=null;a.unhover(t,e)};if(t._context.showAxisDragHandles){s(t,r,n._offset-l,u._offset-l,l,l,"n","w");s(t,r,n._offset+n._length,u._offset-l,l,l,"n","e");s(t,r,n._offset-l,u._offset+u._length,l,l,"s","w");s(t,r,n._offset+n._length,u._offset+u._length,l,l,"s","e")}}if(t._context.showAxisDragHandles){if(e===n._mainSubplot){var c=n._mainLinePosition;if(n.side==="top")c-=l;s(t,r,n._offset+n._length*.1,c,n._length*.8,l,"","ew");s(t,r,n._offset,c,n._length*.1,l,"","w");s(t,r,n._offset+n._length*.9,c,n._length*.1,l,"","e")}if(e===u._mainSubplot){var h=u._mainLinePosition;if(u.side!=="right")h-=l;s(t,r,h,u._offset+u._length*.1,l,u._length*.8,"ns","");s(t,r,h,u._offset+u._length*.9,l,u._length*.1,"s","");s(t,r,h,u._offset,l,u._length*.1,"n","")}}});var f=o._hoverlayer.node();f.onmousemove=function(e){e.target=t._fullLayout._lasthover;i.hover(t,e,o._hoversubplot)};f.onclick=function(e){e.target=t._fullLayout._lasthover;i.click(t,e)};f.onmousedown=function(e){t._fullLayout._lasthover.onmousedown(e)};r.updateFx(o)};r.updateFx=function(e){var t=e.dragmode==="pan"?"move":"crosshair";o(e._draggers,t)}},{"../../components/dragelement":383,"../../components/fx":403,"../../lib/setcursor":502,"./constants":534,"./dragbox":537,d3:81}],539:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");t.exports=function e(t){return function e(r,a){var o=r[t];if(!Array.isArray(o))return;var s=n.subplotsRegistry.cartesian;var l=s.idRegex;var u=a._subplots;var f=u.xaxis;var c=u.yaxis;var h=u.cartesian;var v=a._has("cartesian")||a._has("gl2d");for(var d=0;d<o.length;d++){var p=o[d];if(!i.isPlainObject(p))continue;var g=p.xref;var m=p.yref;var y=l.x.test(g);var b=l.y.test(m);if(y||b){if(!v)i.pushUnique(a._basePlotModules,s);var x=false;if(y&&f.indexOf(g)===-1){f.push(g);x=true}if(b&&c.indexOf(m)===-1){c.push(m);x=true}if(x&&y&&b){h.push(g+m)}}}}}},{"../../lib":483,"../../registry":582}],540:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../lib");var o=e("../plots");var s=e("../../components/drawing");var l=e("../get_data").getModuleCalcData;var u=e("./axis_ids");var f=e("./constants");var c=e("../../constants/xmlns_namespaces");var h=a.ensureSingle;function v(e,t,r){return a.ensureSingle(e,t,r,function(e){e.datum(r)})}r.name="cartesian";r.attr=["xaxis","yaxis"];r.idRoot=["x","y"];r.idRegex=f.idRegex;r.attrRegex=f.attrRegex;r.attributes=e("./attributes");r.layoutAttributes=e("./layout_attributes");r.supplyLayoutDefaults=e("./layout_defaults");r.transitionAxes=e("./transition_axes");r.finalizeSubplots=function(e,t){var r=t._subplots;var n=r.xaxis;var i=r.yaxis;var o=r.cartesian;var s=o.concat(r.gl2d||[]);var l={};var c={};var h,v,d;for(h=0;h<s.length;h++){var p=s[h].split("y");l[p[0]]=1;c["y"+p[1]]=1}for(h=0;h<n.length;h++){v=n[h];if(!l[v]){d=(e[u.id2name(v)]||{}).anchor;if(!f.idRegex.y.test(d))d="y";o.push(v+d);s.push(v+d);if(!c[d]){c[d]=1;a.pushUnique(i,d)}}}for(h=0;h<i.length;h++){d=i[h];if(!c[d]){v=(e[u.id2name(d)]||{}).anchor;if(!f.idRegex.x.test(v))v="x";o.push(v+d);s.push(v+d);if(!l[v]){l[v]=1;a.pushUnique(n,v)}}}if(!s.length){v="";d="";for(var g in e){if(f.attrRegex.test(g)){var m=g.charAt(0);if(m==="x"){if(!v||+g.substr(5)<+v.substr(5)){v=g}}else if(!d||+g.substr(5)<+d.substr(5)){d=g}}}v=v?u.name2id(v):"x";d=d?u.name2id(d):"y";n.push(v);i.push(d);o.push(v+d)}};r.plot=function(e,t,r,n){var i=e._fullLayout;var a=i._subplots.cartesian;var o=e.calcdata;var s;if(!Array.isArray(t)){t=[];for(s=0;s<o.length;s++)t.push(s)}for(s=0;s<a.length;s++){var l=a[s];var u=i._plots[l];var f=[];var c;for(var h=0;h<o.length;h++){var v=o[h];var p=v[0].trace;if(p.xaxis+p.yaxis===l){if(t.indexOf(p.index)!==-1||p.carpet){if(c&&c[0].trace.xaxis+c[0].trace.yaxis===l&&["tonextx","tonexty","tonext"].indexOf(p.fill)!==-1&&f.indexOf(c)===-1){f.push(c)}f.push(v)}c=v}}d(e,u,f,r,n)}};function d(e,t,r,a,o){var u=f.traceLayerClasses;var c=e._fullLayout;var h=c._modules;var v,d,p;var g=[];var m=[];for(var y=0;y<h.length;y++){v=h[y];var b=v.name;var x=i.modules[b].categories;if(x.svg){var _=v.layerName||b+"layer";var w=v.plot;d=l(r,w);p=d[0];r=d[1];if(p.length){g.push({i:u.indexOf(_),className:_,plotMethod:w,cdModule:p})}if(x.zoomScale){m.push("."+_)}}}g.sort(function(e,t){return e.i-t.i});var M=t.plot.selectAll("g.mlayer").data(g,function(e){return e.className});M.enter().append("g").attr("class",function(e){return e.className}).classed("mlayer",true);M.exit().remove();M.order();M.each(function(r){var i=n.select(this);var l=r.className;r.plotMethod(e,t,r.cdModule,i,a,o);if(l!=="scatterlayer"&&l!=="barlayer"){s.setClipUrl(i,t.layerClipId)}});if(c._has("scattergl")){v=i.getModule("scattergl");p=l(r,v)[0];v.plot(e,t,p)}if(!e._context.staticPlot){if(t._hasClipOnAxisFalse){t.clipOnAxisFalseTraces=t.plot.selectAll(".scatterlayer, .barlayer").selectAll(".trace")}if(m.length){var A=t.plot.selectAll(m.join(",")).selectAll(".trace");t.zoomScalePts=A.selectAll("path.point");t.zoomScaleTxt=A.selectAll(".textpoint")}}}r.clean=function(e,t,r,n){var i=n._plots||{};var a=t._plots||{};var o=n._subplots||{};var s;var l,f;if(n._hasOnlyLargeSploms&&!t._hasOnlyLargeSploms){for(f in i){s=i[f];if(s.plotgroup)s.plotgroup.remove()}}var c=n._has&&n._has("gl");var h=t._has&&t._has("gl");if(c&&!h){for(f in i){s=i[f];if(s._scene)s._scene.destroy()}}if(o.xaxis&&o.yaxis){var v=u.listIds({_fullLayout:n});for(l=0;l<v.length;l++){var d=v[l];if(!t[u.id2name(d)]){n._infolayer.selectAll(".g-"+d+"title").remove()}}}var p=n._has&&n._has("cartesian");var g=t._has&&t._has("cartesian");if(p&&!g){m(n._cartesianlayer.selectAll(".subplot"),n);n._defs.selectAll(".axesclip").remove();delete n._axisConstraintGroups}else if(o.cartesian){for(l=0;l<o.cartesian.length;l++){var b=o.cartesian[l];if(!a[b]){var x="."+b+",."+b+"-x,."+b+"-y";n._cartesianlayer.selectAll(x).remove();y(b,n)}}}};r.drawFramework=function(e){var t=e._fullLayout;var r=p(e);var i=t._cartesianlayer.selectAll(".subplot").data(r,a.identity);i.enter().append("g").attr("class",function(e){return"subplot "+e});i.order();i.exit().call(m,t);i.each(function(r){var i=t._plots[r];i.plotgroup=n.select(this);i.overlays=[];g(e,i);if(i.mainplot){var a=t._plots[i.mainplot];a.overlays.push(i)}i.draglayer=h(t._draggers,"g",r)})};r.rangePlot=function(e,t,r){g(e,t);d(e,t,r);o.style(e)};function p(e){var t=e._fullLayout;var r=[];var n=[];for(var i in t._plots){var a=t._plots[i];var o=a.xaxis._mainAxis;var s=a.yaxis._mainAxis;var l=o._id+s._id;if(l!==i&&t._plots[l]){a.mainplot=l;a.mainplotinfo=t._plots[l];n.push(i)}else{r.push(i);a.mainplot=undefined}}r=r.concat(n);return r}function g(e,t){var r=t.plotgroup;var n=t.id;var i=f.layerValue2layerClass[t.xaxis.layer];var a=f.layerValue2layerClass[t.yaxis.layer];var o=e._fullLayout._hasOnlyLargeSploms;if(!t.mainplot){if(o){t.plot=h(r,"g","plot");t.xlines=h(r,"path","xlines-above");t.ylines=h(r,"path","ylines-above");t.xaxislayer=h(r,"g","xaxislayer-above");t.yaxislayer=h(r,"g","yaxislayer-above")}else{var s=h(r,"g","layer-subplot");t.shapelayer=h(s,"g","shapelayer");t.imagelayer=h(s,"g","imagelayer");t.gridlayer=h(r,"g","gridlayer");t.zerolinelayer=h(r,"g","zerolinelayer");h(r,"path","xlines-below");h(r,"path","ylines-below");t.overlinesBelow=h(r,"g","overlines-below");h(r,"g","xaxislayer-below");h(r,"g","yaxislayer-below");t.overaxesBelow=h(r,"g","overaxes-below");t.plot=h(r,"g","plot");t.overplot=h(r,"g","overplot");t.xlines=h(r,"path","xlines-above");t.ylines=h(r,"path","ylines-above");t.overlinesAbove=h(r,"g","overlines-above");h(r,"g","xaxislayer-above");h(r,"g","yaxislayer-above");t.overaxesAbove=h(r,"g","overaxes-above");t.xlines=r.select(".xlines-"+i);t.ylines=r.select(".ylines-"+a);t.xaxislayer=r.select(".xaxislayer-"+i);t.yaxislayer=r.select(".yaxislayer-"+a)}}else{var l=t.mainplotinfo;var c=l.plotgroup;var d=n+"-x";var p=n+"-y";t.gridlayer=l.gridlayer;t.zerolinelayer=l.zerolinelayer;h(l.overlinesBelow,"path",d);h(l.overlinesBelow,"path",p);h(l.overaxesBelow,"g",d);h(l.overaxesBelow,"g",p);t.plot=h(l.overplot,"g",n);h(l.overlinesAbove,"path",d);h(l.overlinesAbove,"path",p);h(l.overaxesAbove,"g",d);h(l.overaxesAbove,"g",p);t.xlines=c.select(".overlines-"+i).select("."+d);t.ylines=c.select(".overlines-"+a).select("."+p);t.xaxislayer=c.select(".overaxes-"+i).select("."+d);t.yaxislayer=c.select(".overaxes-"+a).select("."+p)}if(!o){v(t.gridlayer,"g",t.xaxis._id);v(t.gridlayer,"g",t.yaxis._id);t.gridlayer.selectAll("g").sort(u.idSort)}t.xlines.style("fill","none").classed("crisp",true);t.ylines.style("fill","none").classed("crisp",true)}function m(e,t){if(!e)return;var r={};e.each(function(e){var i=n.select(this);i.remove();y(e,t);r[e]=true});for(var i in t._plots){var a=t._plots[i];var o=a.overlays||[];for(var s=0;s<o.length;s++){var l=o[s];if(r[l.id]){l.plot.selectAll(".trace").remove()}}}}function y(e,t){t._draggers.selectAll("g."+e).remove();t._defs.select("#clip"+t._uid+e+"plot").remove()}r.toSVG=function(e){var t=e._fullLayout._glimages;var r=n.select(e).selectAll(".svg-container");var i=r.filter(function(e,t){return t===r.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function a(){var e=this;var r=e.toDataURL("image/png");var n=t.append("svg:image");n.attr({xmlns:c.svg,"xlink:href":r,preserveAspectRatio:"none",x:0,y:0,width:e.width,height:e.height})}i.each(a)};r.updateFx=e("./graph_interact").updateFx},{"../../components/drawing":386,"../../constants/xmlns_namespaces":465,"../../lib":483,"../../registry":582,"../get_data":557,"../plots":573,"./attributes":527,"./axis_ids":532,"./constants":534,"./graph_interact":538,"./layout_attributes":541,"./layout_defaults":542,"./transition_axes":551,d3:81}],541:[function(e,t,r){"use strict";var n=e("../font_attributes");var i=e("../../components/color/attributes");var a=e("../../components/drawing/attributes").dash;var o=e("../../lib/extend").extendFlat;var s=e("../../plot_api/plot_template").templatedArray;var l=e("./constants");t.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:i.defaultLine,editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:n({editType:"ticks"}),type:{valType:"enumerated",values:["-","linear","log","date","category"],dflt:"-",editType:"calc",_noTemplating:true},autorange:{valType:"enumerated",values:[true,false,"reversed"],dflt:true,editType:"calc",impliedEdits:{"range[0]":undefined,"range[1]":undefined}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":false}},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":false}}],editType:"axrange",impliedEdits:{autorange:false}},fixedrange:{valType:"boolean",dflt:false,editType:"calc"},scaleanchor:{valType:"enumerated",values:[l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],dflt:"range",editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:undefined,dtick:undefined}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},mirror:{valType:"enumerated",values:[true,"ticks",false,"all","allticks"],dflt:false,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:i.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:true,editType:"ticks"},automargin:{valType:"boolean",dflt:false,editType:"ticks"},showspikes:{valType:"boolean",dflt:false,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:o({},a,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor"],dflt:"data",editType:"none"},tickfont:n({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},separatethousands:{valType:"boolean",dflt:false,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks"},tickformatstops:s("tickformatstop",{enabled:{valType:"boolean",dflt:true,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none"},showline:{valType:"boolean",dflt:false,editType:"layoutstyle"},linecolor:{valType:"color",dflt:i.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:i.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:i.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"}}}},{"../../components/color/attributes":360,"../../components/drawing/attributes":385,"../../lib/extend":475,"../../plot_api/plot_template":519,"../font_attributes":555,"./constants":534}],542:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");var a=e("../../components/color");var o=e("../../plot_api/plot_template");var s=e("../layout_attributes");var l=e("./layout_attributes");var u=e("./type_defaults");var f=e("./axis_defaults");var c=e("./constraint_defaults");var h=e("./position_defaults");var v=e("./axis_ids");t.exports=function e(t,r,d){var p={};var g={};var m={};var y={};var b;for(b=0;b<d.length;b++){var x=d[b];if(!n.traceIs(x,"cartesian")&&!n.traceIs(x,"gl2d")){continue}var _=v.id2name(x.xaxis);var w=v.id2name(x.yaxis);if(!n.traceIs(x,"carpet")||x.type==="carpet"&&!x._cheater){if(_)g[_]=1}if(x.type==="carpet"&&x._cheater){if(_)p[_]=1}if(n.traceIs(x,"2dMap")){m[_]=true;m[w]=true}if(n.traceIs(x,"oriented")){var M=x.orientation==="h"?w:_;y[M]=true}}var A=r._subplots;var T=A.xaxis;var k=A.yaxis;var E=i.simpleMap(T,v.id2name);var S=i.simpleMap(k,v.id2name);var L=E.concat(S);var C=a.background;if(T.length&&k.length){C=i.coerce(t,r,s,"plot_bgcolor")}var I=a.combine(C,r.paper_bgcolor);var P,O,R,N;function z(e,t){return i.coerce(R,N,l,e,t)}function D(e,t){return i.coerce2(R,N,l,e,t)}function F(e){return e==="x"?k:T}var j={x:F("x"),y:F("y")};function B(e,r){var n=e==="x"?E:S;var i=[];for(var a=0;a<n.length;a++){var o=n[a];if(o!==r&&!(t[o]||{}).overlaying){i.push(v.name2id(o))}}return i}for(b=0;b<L.length;b++){P=L[b];O=P.charAt(0);if(!i.isPlainObject(t[P])){t[P]={}}R=t[P];N=o.newContainer(r,P,O+"axis");u(R,N,z,d,P);var U=B(O,P);var V={letter:O,font:r.font,outerTicks:m[P],showGrid:!y[P],data:d,bgColor:I,calendar:r.calendar,automargin:true,cheateronly:O==="x"&&p[P]&&!g[P]};f(R,N,z,V,r);var H=D("spikecolor"),q=D("spikethickness"),G=D("spikedash"),W=D("spikemode"),X=D("spikesnap"),Y=z("showspikes",!!H||!!q||!!G||!!W||!!X);if(!Y){delete N.spikecolor;delete N.spikethickness;delete N.spikedash;delete N.spikemode;delete N.spikesnap}var Z={letter:O,counterAxes:j[O],overlayableAxes:U,grid:r.grid};h(R,N,z,Z);N._input=R}var Q=n.getComponentMethod("rangeslider","handleDefaults");var K=n.getComponentMethod("rangeselector","handleDefaults");for(b=0;b<E.length;b++){P=E[b];R=t[P];N=r[P];Q(t,r,P);if(N.type==="date"){K(R,N,r,S,N.calendar)}z("fixedrange")}for(b=0;b<S.length;b++){P=S[b];R=t[P];N=r[P];var J=r[v.id2name(N.anchor)];var $=J&&J.rangeslider&&J.rangeslider.visible;z("fixedrange",$)}r._axisConstraintGroups=[];var ee=j.x.concat(j.y);for(b=0;b<L.length;b++){P=L[b];O=P.charAt(0);R=t[P];N=r[P];c(R,N,z,ee,r)}}},{"../../components/color":361,"../../lib":483,"../../plot_api/plot_template":519,"../../registry":582,"../layout_attributes":571,"./axis_defaults":531,"./axis_ids":532,"./constraint_defaults":535,"./layout_attributes":541,"./position_defaults":544,"./type_defaults":552}],543:[function(e,t,r){"use strict";var n=e("tinycolor2").mix;var i=e("../../components/color/attributes").lightFraction;var a=e("../../lib");t.exports=function e(t,r,o,s){s=s||{};var l=s.dfltColor;function u(e,n){return a.coerce2(t,r,s.attributes,e,n)}var f=u("linecolor",l);var c=u("linewidth");var h=o("showline",s.showLine||!!f||!!c);if(!h){delete r.linecolor;delete r.linewidth}var v=n(l,s.bgColor,s.blend||i).toRgbString();var d=u("gridcolor",v);var p=u("gridwidth");var g=o("showgrid",s.showGrid||!!d||!!p);if(!g){delete r.gridcolor;delete r.gridwidth}if(!s.noZeroLine){var m=u("zerolinecolor",l);var y=u("zerolinewidth");var b=o("zeroline",s.showGrid||!!m||!!y);if(!b){delete r.zerolinecolor;delete r.zerolinewidth}}}},{"../../components/color/attributes":360,"../../lib":483,tinycolor2:327}],544:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");t.exports=function e(t,r,a,o){var s=o.counterAxes||[];var l=o.overlayableAxes||[];var u=o.letter;var f=o.grid;var c,h,v,d;if(f){h=f._domains[u][f._axisMap[r._id]];c=f._anchors[r._id];if(h){v=f[u+"side"].split(" ")[0];d=f.domain[u][v==="right"||v==="top"?1:0]}}h=h||[0,1];c=c||(n(t.position)?"free":s[0]||"free");v=v||(u==="x"?"bottom":"left");d=d||0;var p=i.coerce(t,r,{anchor:{valType:"enumerated",values:["free"].concat(s),dflt:c}},"anchor");if(p==="free")a("position",d);i.coerce(t,r,{side:{valType:"enumerated",values:u==="x"?["bottom","top"]:["left","right"],dflt:v}},"side");var g=false;if(l.length){g=i.coerce(t,r,{overlaying:{valType:"enumerated",values:[false].concat(l),dflt:false}},"overlaying")}if(!g){var m=a("domain",h);if(m[0]>m[1]-.01)r.domain=h;i.noneOrAll(t.domain,r.domain,h)}a("layer");return r}},{"../../lib":483,"fast-isnumeric":91}],545:[function(e,t,r){"use strict";var n=e("../../constants/alignment").FROM_BL;t.exports=function e(t,r,i){if(i===undefined){i=n[t.constraintoward||"center"]}var a=[t.r2l(t.range[0]),t.r2l(t.range[1])];var o=a[0]+(a[1]-a[0])*i;t.range=t._input.range=[t.l2r(o+(a[0]-o)*r),t.l2r(o+(a[1]-o)*r)]}},{"../../constants/alignment":459}],546:[function(e,t,r){"use strict";var n=e("polybooljs");var i=e("../../registry");var a=e("../../components/color");var o=e("../../components/fx");var s=e("../../lib/polygon");var l=e("../../lib/throttle");var u=e("../../components/fx/helpers").makeEventData;var f=e("./axis_ids").getFromId;var c=e("../sort_modules").sortModules;var h=e("./constants");var v=h.MINSELECT;var d=s.filter;var p=s.tester;var g=s.multitester;function m(e){return e._id}function y(e,t,r,n,i){var s=n.gd;var u=s._fullLayout;var c=u._zoomlayer;var y=n.element.getBoundingClientRect();var M=n.plotinfo;var A=M.xaxis._offset;var T=M.yaxis._offset;var k=t-y.left;var E=r-y.top;var S=k;var L=E;var C="M"+k+","+E;var I=n.xaxes[0]._length;var P=n.yaxes[0]._length;var O=n.xaxes.map(m);var R=n.yaxes.map(m);var N=n.xaxes.concat(n.yaxes);var z=e.altKey;var D,F,j,B;var U,V,H,q,G;var W=u._lastSelectedSubplot&&u._lastSelectedSubplot===M.id;if(W&&(e.shiftKey||e.altKey)&&(M.selection&&M.selection.polygons)&&!n.polygons){n.polygons=M.selection.polygons;n.mergedPolygons=M.selection.mergedPolygons}else if(!e.shiftKey&&!e.altKey||(e.shiftKey||e.altKey)&&!M.selection){M.selection={};M.selection.polygons=n.polygons=[];M.selection.mergedPolygons=n.mergedPolygons=[]}if(!W){w(c);u._lastSelectedSubplot=M.id}if(i==="lasso"){D=d([[k,E]],h.BENDPX)}var X=c.selectAll("path.select-outline-"+M.id).data([1,2]);X.enter().append("path").attr("class",function(e){return"select-outline select-outline-"+e+" select-outline-"+M.id}).attr("transform","translate("+A+", "+T+")").attr("d",C+"Z");var Y=c.append("path").attr("class","zoombox-corners").style({fill:a.background,stroke:a.defaultLine,"stroke-width":1}).attr("transform","translate("+A+", "+T+")").attr("d","M0,0Z");var Z=[];var Q=u._uid+h.SELECTID;var K=[];for(U=0;U<s.calcdata.length;U++){V=s.calcdata[U];H=V[0].trace;if(H.visible!==true||!H._module||!H._module.selectPoints)continue;if(n.subplot){if(H.subplot===n.subplot||H.geo===n.subplot){Z.push({_module:H._module,cd:V,xaxis:n.xaxes[0],yaxis:n.yaxes[0]})}}else if(H.type==="splom"&&H._xaxes[O[0]]&&H._yaxes[R[0]]){Z.push({_module:H._module,cd:V,xaxis:n.xaxes[0],yaxis:n.yaxes[0]})}else{if(O.indexOf(H.xaxis)===-1)continue;if(R.indexOf(H.yaxis)===-1)continue;Z.push({_module:H._module,cd:V,xaxis:f(s,H.xaxis),yaxis:f(s,H.yaxis)})}}function J(e){var t=e._id.charAt(0)==="y"?1:0;return function(r){return e.p2d(r[t])}}function $(e,t){return e-t}var ee;if(M.fillRangeItems){ee=M.fillRangeItems}else{if(i==="select"){ee=function(e,t){var r=e.range={};for(U=0;U<N.length;U++){var n=N[U];var i=n._id.charAt(0);r[n._id]=[n.p2d(t[i+"min"]),n.p2d(t[i+"max"])].sort($)}}}else{ee=function(e,t,r){var n=e.lassoPoints={};for(U=0;U<N.length;U++){var i=N[U];n[i._id]=r.filtered.map(J(i))}}}}n.moveFn=function(e,t){S=Math.max(0,Math.min(I,e+k));L=Math.max(0,Math.min(P,t+E));var r=Math.abs(S-k),a=Math.abs(L-E);if(i==="select"){var o=u.selectdirection;if(u.selectdirection==="any"){if(a<Math.min(r*.6,v))o="h";else if(r<Math.min(a*.6,v))o="v";else o="d"}else{o=u.selectdirection}if(o==="h"){B=[[k,0],[k,P],[S,P],[S,0]];B.xmin=Math.min(k,S);B.xmax=Math.max(k,S);B.ymin=Math.min(0,P);B.ymax=Math.max(0,P);Y.attr("d","M"+B.xmin+","+(E-v)+"h-4v"+2*v+"h4Z"+"M"+(B.xmax-1)+","+(E-v)+"h4v"+2*v+"h-4Z")}else if(o==="v"){B=[[0,E],[0,L],[I,L],[I,E]];B.xmin=Math.min(0,I);B.xmax=Math.max(0,I);B.ymin=Math.min(E,L);B.ymax=Math.max(E,L);Y.attr("d","M"+(k-v)+","+B.ymin+"v-4h"+2*v+"v4Z"+"M"+(k-v)+","+(B.ymax-1)+"v4h"+2*v+"v-4Z")}else if(o==="d"){B=[[k,E],[k,L],[S,L],[S,E]];B.xmin=Math.min(k,S);B.xmax=Math.max(k,S);B.ymin=Math.min(E,L);B.ymax=Math.max(E,L);Y.attr("d","M0,0Z")}}else if(i==="lasso"){D.addPt([S,L]);B=D.filtered}if(n.polygons&&n.polygons.length){j=x(n.mergedPolygons,B,z);B.subtract=z;F=g(n.polygons.concat([B]))}else{j=[B];F=p(B)}var f=[];for(U=0;U<j.length;U++){var c=j[U];f.push(c.join("L")+"L"+c[0])}X.attr("d","M"+f.join("M")+"Z");l.throttle(Q,h.SELECTDELAY,function(){K=[];var e,t=[],r;for(U=0;U<Z.length;U++){q=Z[U];r=q._module.selectPoints(q,F);t.push(r);e=_(r,q);if(K.length){for(var i=0;i<e.length;i++){K.push(e[i])}}else K=e}G={points:K};b(s,Z,G);ee(G,B,D);n.gd.emit("plotly_selecting",G)})};n.clickFn=function(e,t){Y.remove();l.done(Q).then(function(){l.clear(Q);if(e===2){X.remove();for(U=0;U<Z.length;U++){q=Z[U];q._module.selectPoints(q,false)}b(s,Z);s.emit("plotly_deselect",null)}else{s.emit("plotly_selected",undefined)}o.click(s,t)})};n.doneFn=function(){Y.remove();l.done(Q).then(function(){l.clear(Q);n.gd.emit("plotly_selected",G);if(B&&n.polygons){B.subtract=z;n.polygons.push(B);n.mergedPolygons.length=0;[].push.apply(n.mergedPolygons,j)}})}}function b(e,t,r){var n,a,o,s;if(r){var l=r.points||[];for(n=0;n<t.length;n++){s=t[n].cd[0].trace;s.selectedpoints=[];s._input.selectedpoints=[]}for(n=0;n<l.length;n++){var u=l[n];var f=u.data;var h=u.fullData;if(u.pointIndices){[].push.apply(f.selectedpoints,u.pointIndices);[].push.apply(h.selectedpoints,u.pointIndices)}else{f.selectedpoints.push(u.pointIndex);h.selectedpoints.push(u.pointIndex)}}}else{for(n=0;n<t.length;n++){s=t[n].cd[0].trace;delete s.selectedpoints;delete s._input.selectedpoints}}var v={};for(n=0;n<t.length;n++){o=t[n];var d=o._module.name;if(v[d]){v[d].push(o)}else{v[d]=[o]}}var p=Object.keys(v).sort(c);for(n=0;n<p.length;n++){var g=v[p[n]];var m=g.length;var y=g[0];var b=y.cd[0].trace;var x=y._module;var _=x.styleOnSelect||x.style;if(i.traceIs(b,"regl")){var w=new Array(m);for(a=0;a<m;a++){w[a]=g[a].cd}_(e,w)}else{for(a=0;a<m;a++){_(e,g[a].cd)}}}}function x(e,t,r){var i;if(r){i=n.difference({regions:e,inverted:false},{regions:[t],inverted:false});return i.regions}i=n.union({regions:e,inverted:false},{regions:[t],inverted:false});return i.regions}function _(e,t){if(Array.isArray(e)){var r=t.cd;var n=t.cd[0].trace;for(var i=0;i<e.length;i++){e[i]=u(e[i],n,r)}}return e}function w(e){e.selectAll(".select-outline").remove()}t.exports={prepSelect:y,clearSelect:w}},{"../../components/color":361,"../../components/fx":403,"../../components/fx/helpers":400,"../../lib/polygon":495,"../../lib/throttle":507,"../../registry":582,"../sort_modules":580,"./axis_ids":532,"./constants":534,polybooljs:283}],547:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../../lib");var o=a.cleanNumber;var s=a.ms2DateTime;var l=a.dateTime2ms;var u=a.ensureNumber;var f=e("../../constants/numerical");var c=f.FP_SAFE;var h=f.BADNUM;var v=e("./constants");var d=e("./axis_ids");function p(e){return Math.pow(10,e)}t.exports=function e(t,r){r=r||{};var f=(t._id||"x").charAt(0);var g=10;function m(e,r){if(e>0)return Math.log(e)/Math.LN10;else if(e<=0&&r&&t.range&&t.range.length===2){var n=t.range[0],i=t.range[1];return.5*(n+i-3*g*Math.abs(n-i))}else return h}function y(e,r,n){var a=l(e,n||t.calendar);if(a===h){if(i(e))a=l(new Date(+e));else return h}return a}function b(e,r,n){return s(e,r,n||t.calendar)}function x(e){return t._categories[Math.round(e)]}function _(e){if(e!==null&&e!==undefined){if(t._categoriesMap===undefined){t._categoriesMap={}}if(t._categoriesMap[e]!==undefined){return t._categoriesMap[e]}else{t._categories.push(e);var r=t._categories.length-1;t._categoriesMap[e]=r;return r}}return h}function w(e){if(t._categoriesMap){var r=t._categoriesMap[e];if(r!==undefined)return r}if(i(e))return+e}function M(e){if(!i(e))return h;return n.round(t._b+t._m*e,2)}function A(e){return(e-t._b)/t._m}t.c2l=t.type==="log"?m:u;t.l2c=t.type==="log"?p:u;t.l2p=M;t.p2l=A;t.c2p=t.type==="log"?function(e,t){return M(m(e,t))}:M;t.p2c=t.type==="log"?function(e){return p(A(e))}:A;if(["linear","-"].indexOf(t.type)!==-1){t.d2r=t.r2d=t.d2c=t.r2c=t.d2l=t.r2l=o;t.c2d=t.c2r=t.l2d=t.l2r=u;t.d2p=t.r2p=function(e){return t.l2p(o(e))};t.p2d=t.p2r=A;t.cleanPos=u}else if(t.type==="log"){t.d2r=t.d2l=function(e,t){return m(o(e),t)};t.r2d=t.r2c=function(e){return p(o(e))};t.d2c=t.r2l=o;t.c2d=t.l2r=u;t.c2r=m;t.l2d=p;t.d2p=function(e,r){return t.l2p(t.d2r(e,r))};t.p2d=function(e){return p(A(e))};t.r2p=function(e){return t.l2p(o(e))};t.p2r=A;t.cleanPos=u}else if(t.type==="date"){t.d2r=t.r2d=a.identity;t.d2c=t.r2c=t.d2l=t.r2l=y;t.c2d=t.c2r=t.l2d=t.l2r=b;t.d2p=t.r2p=function(e,r,n){return t.l2p(y(e,0,n))};t.p2d=t.p2r=function(e,t,r){return b(A(e),t,r)};t.cleanPos=function(e){return a.cleanDate(e,h,t.calendar)}}else if(t.type==="category"){t.d2c=t.d2l=_;t.r2d=t.c2d=t.l2d=x;t.d2r=t.d2l_noadd=w;t.r2c=function(e){var r=w(e);return r!==undefined?r:t.fraction2r(.5)};t.l2r=t.c2r=u;t.r2l=w;t.d2p=function(e){return t.l2p(t.r2c(e))};t.p2d=function(e){return x(A(e))};t.r2p=t.d2p;t.p2r=A;t.cleanPos=function(e){if(typeof e==="string"&&e!=="")return e;return u(e)}}t.fraction2r=function(e){var r=t.r2l(t.range[0]),n=t.r2l(t.range[1]);return t.l2r(r+e*(n-r))};t.r2fraction=function(e){var r=t.r2l(t.range[0]),n=t.r2l(t.range[1]);return(t.r2l(e)-r)/(n-r)};t.cleanRange=function(e,r){if(!r)r={};if(!e)e="range";var n=a.nestedProperty(t,e).get();var o,s;if(t.type==="date")s=a.dfltRange(t.calendar);else if(f==="y")s=v.DFLTRANGEY;else s=r.dfltRange||v.DFLTRANGEX;s=s.slice();if(!n||n.length!==2){a.nestedProperty(t,e).set(s);return}if(t.type==="date"){n[0]=a.cleanDate(n[0],h,t.calendar);n[1]=a.cleanDate(n[1],h,t.calendar)}for(o=0;o<2;o++){if(t.type==="date"){if(!a.isDateTime(n[o],t.calendar)){t[e]=s;break}if(t.r2l(n[0])===t.r2l(n[1])){var l=a.constrain(t.r2l(n[0]),a.MIN_MS+1e3,a.MAX_MS-1e3);n[0]=t.l2r(l-1e3);n[1]=t.l2r(l+1e3);break}}else{if(!i(n[o])){if(i(n[1-o])){n[o]=n[1-o]*(o?10:.1)}else{t[e]=s;break}}if(n[o]<-c)n[o]=-c;else if(n[o]>c)n[o]=c;if(n[0]===n[1]){var u=Math.max(1,Math.abs(n[0]*1e-6));n[0]-=u;n[1]+=u}}}};t.setScale=function(e){var n=r._size;if(!t._categories)t._categories=[];if(!t._categoriesMap)t._categoriesMap={};if(t.overlaying){var i=d.getFromId({_fullLayout:r},t.overlaying);t.domain=i.domain}var a=e&&t._r?"_r":"range",o=t.calendar;t.cleanRange(a);var s=t.r2l(t[a][0],o),l=t.r2l(t[a][1],o);if(f==="y"){t._offset=n.t+(1-t.domain[1])*n.h;t._length=n.h*(t.domain[1]-t.domain[0]);t._m=t._length/(s-l);t._b=-t._m*l}else{t._offset=n.l+t.domain[0]*n.w;t._length=n.w*(t.domain[1]-t.domain[0]);t._m=t._length/(l-s);t._b=-t._m*s}if(!isFinite(t._m)||!isFinite(t._b)){r._replotting=false;throw new Error("Something went wrong with axis scaling")}};t.makeCalcdata=function(e,r){var n,i,o,s;var l=t.type;var u=l==="date"&&e[r+"calendar"];if(r in e){n=e[r];s=e._length||n.length;if(a.isTypedArray(n)&&(l==="linear"||l==="log")){if(s===n.length){return n}else if(n.subarray){return n.subarray(0,s)}}i=new Array(s);for(o=0;o<s;o++){i[o]=t.d2c(n[o],0,u)}}else{var f=r+"0"in e?t.d2c(e[r+"0"],0,u):0;var c=e["d"+r]?Number(e["d"+r]):1;n=e[{x:"y",y:"x"}[r]];s=e._length||n.length;i=new Array(s);for(o=0;o<s;o++){i[o]=f+o*c}}return i};t.isValidRange=function(e){return Array.isArray(e)&&e.length===2&&i(t.r2l(e[0]))&&i(t.r2l(e[1]))};t.isPtWithinRange=function(e,r){var n=t.c2l(e[f],null,r);var i=t.r2l(t.range[0]);var a=t.r2l(t.range[1]);if(i<a){return i<=n&&n<=a}else{return a<=n&&n<=i}};t.clearCalc=function(){t._min=[];t._max=[];t._categories=(t._initialCategories||[]).slice();t._categoriesMap={};for(var e=0;e<t._categories.length;e++){t._categoriesMap[t._categories[e]]=e}};var T=r._d3locale;if(t.type==="date"){t._dateFormat=T?T.timeFormat.utc:n.time.format.utc;t._extraFormat=r._extraFormat}t._separators=r.separators;t._numFormat=T?T.numberFormat:n.format;delete t._minDtick;delete t._forceTick0}},{"../../constants/numerical":463,"../../lib":483,"./axis_ids":532,"./constants":534,d3:81,"fast-isnumeric":91}],548:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./layout_attributes");var a=e("../array_container_defaults");t.exports=function e(t,r,l,u,f){var c=o(t);var h=l("tickprefix");if(h)l("showtickprefix",c);var v=l("ticksuffix",f.tickSuffixDflt);if(v)l("showticksuffix",c);var d=l("showticklabels");if(d){var p=f.font||{};var g=r.color!==i.color.dflt?r.color:p.color;n.coerceFont(l,"tickfont",{family:p.family,size:p.size,color:g});l("tickangle");if(u!=="category"){var m=l("tickformat");var y=t.tickformatstops;if(Array.isArray(y)&&y.length){a(t,r,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:s})}if(!m&&u!=="date"){l("showexponent",c);l("exponentformat");l("separatethousands")}}}};function o(e){var t=["showexponent","showtickprefix","showticksuffix"],r=t.filter(function(t){return e[t]!==undefined}),n=function(t){return e[t]===e[r[0]]};if(r.every(n)||r.length===1){return e[r[0]]}}function s(e,t){function r(r,a){return n.coerce(e,t,i.tickformatstops,r,a)}var a=r("enabled");if(a){r("dtickrange");r("value")}}},{"../../lib":483,"../array_container_defaults":525,"./layout_attributes":541}],549:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./layout_attributes");t.exports=function e(t,r,a,o){var s=n.coerce2(t,r,i,"ticklen"),l=n.coerce2(t,r,i,"tickwidth"),u=n.coerce2(t,r,i,"tickcolor",r.color),f=a("ticks",o.outerTicks||s||l||u?"outside":"");if(!f){delete r.ticklen;delete r.tickwidth;delete r.tickcolor}}},{"../../lib":483,"./layout_attributes":541}],550:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");var a=e("../../constants/numerical").ONEDAY;t.exports=function e(t,r,o,s){var l;if(t.tickmode==="array"&&(s==="log"||s==="date")){l=r.tickmode="auto"}else{var u=Array.isArray(t.tickvals)?"array":t.dtick?"linear":"auto";l=o("tickmode",u)}if(l==="auto")o("nticks");else if(l==="linear"){var f=s==="date"?a:1;var c=o("dtick",f);if(n(c)){r.dtick=c>0?Number(c):f}else if(typeof c!=="string"){r.dtick=f}else{var h=c.charAt(0),v=c.substr(1);v=n(v)?Number(v):0;if(v<=0||!(s==="date"&&h==="M"&&v===Math.round(v)||s==="log"&&h==="L"||s==="log"&&h==="D"&&(v===1||v===2))){r.dtick=f}}var d=s==="date"?i.dateTick0(r.calendar):0;var p=o("tick0",d);if(s==="date"){r.tick0=i.cleanDate(p,d)}else if(n(p)&&c!=="D1"&&c!=="D2"){r.tick0=Number(p)}else{r.tick0=d}}else{var g=o("tickvals");if(g===undefined)r.tickmode="auto";else o("ticktext")}}},{"../../constants/numerical":463,"../../lib":483,"fast-isnumeric":91}],551:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../components/drawing");var o=e("./axes");var s=e("./constants").attrRegex;t.exports=function e(t,r,l,u){var f=t._fullLayout;var c=[];function h(e){var t,r,n,i,a;var o={};for(t in e){r=t.split(".");n=r[0].match(s);if(n){var l=t.charAt(0);var u=r[0];i=f[u];a={};if(Array.isArray(e[t])){a.to=e[t].slice(0)}else{if(Array.isArray(e[t].range)){a.to=e[t].range.slice(0)}}if(!a.to)continue;a.axisName=u;a.length=i._length;c.push(l);o[l]=a}}return o}function v(e,t,r){var n;var i=e._plots;var a=[];var o,s;for(n in i){var l=i[n];if(a.indexOf(l)!==-1)continue;var u=l.xaxis._id;var f=l.yaxis._id;var c=l.xaxis.range;var h=l.yaxis.range;l.xaxis._r=l.xaxis.range.slice();l.yaxis._r=l.yaxis.range.slice();if(r[u]){o=r[u].to}else{o=c}if(r[f]){s=r[f].to}else{s=h}if(c[0]===o[0]&&c[1]===o[1]&&h[0]===s[0]&&h[1]===s[1])continue;if(t.indexOf(u)!==-1||t.indexOf(f)!==-1){a.push(l)}}return a}var d=h(r);var p=Object.keys(d);var g=v(f,p,d);function m(){function e(e,r,n){for(var i=0;i<e.length;i++){r(t,i);if(n)return}}e(f.annotations||[],i.getComponentMethod("annotations","drawOne"));e(f.shapes||[],i.getComponentMethod("shapes","drawOne"));e(f.images||[],i.getComponentMethod("images","draw"),true)}if(!g.length){m();return false}function y(e,r){var n=[],a;n=[e._id,r._id];for(a=0;a<n.length;a++){o.doTicksSingle(t,n[a],true)}function s(e,r,i){for(a=0;a<e.length;a++){var o=e[a];if(n.indexOf(o.xref)!==-1||n.indexOf(o.yref)!==-1){r(t,a)}if(i)return}}s(f.annotations||[],i.getComponentMethod("annotations","drawOne"));s(f.shapes||[],i.getComponentMethod("shapes","drawOne"));s(f.images||[],i.getComponentMethod("images","draw"),true)}function b(e){var t=e.xaxis;var r=e.yaxis;f._defs.select("#"+e.clipId+"> rect").call(a.setTranslate,0,0).call(a.setScale,1,1);e.plot.call(a.setTranslate,t._offset,r._offset).call(a.setScale,1,1);var n=e.plot.selectAll(".scatterlayer .trace");n.selectAll(".point").call(a.setPointGroupScale,1,1);n.selectAll(".textpoint").call(a.setTextPointsScale,1,1);n.call(a.hideOutsideRangePoints,e)}function x(e,r){var n,i,o;var s=d[e.xaxis._id];var l=d[e.yaxis._id];var u=[];if(s){n=t._fullLayout[s.axisName];i=n._r;o=s.to;u[0]=(i[0]*(1-r)+r*o[0]-i[0])/(i[1]-i[0])*e.xaxis._length;var f=i[1]-i[0];var c=o[1]-o[0];n.range[0]=i[0]*(1-r)+r*o[0];n.range[1]=i[1]*(1-r)+r*o[1];u[2]=e.xaxis._length*(1-r+r*c/f)}else{u[0]=0;u[2]=e.xaxis._length}if(l){n=t._fullLayout[l.axisName];i=n._r;o=l.to;u[1]=(i[1]*(1-r)+r*o[1]-i[1])/(i[0]-i[1])*e.yaxis._length;var h=i[1]-i[0];var v=o[1]-o[0];n.range[0]=i[0]*(1-r)+r*o[0];n.range[1]=i[1]*(1-r)+r*o[1];u[3]=e.yaxis._length*(1-r+r*v/h)}else{u[1]=0;u[3]=e.yaxis._length}y(e.xaxis,e.yaxis);var p=e.xaxis;var g=e.yaxis;var m=!!s;var b=!!l;var x=m?p._length/u[2]:1,_=b?g._length/u[3]:1;var w=m?u[0]:0,M=b?u[1]:0;var A=m?u[0]/u[2]*p._length:0,T=b?u[1]/u[3]*g._length:0;var k=p._offset-A,E=g._offset-T;e.clipRect.call(a.setTranslate,w,M).call(a.setScale,1/x,1/_);e.plot.call(a.setTranslate,k,E).call(a.setScale,x,_);a.setPointGroupScale(e.zoomScalePts,1/x,1/_);a.setTextPointsScale(e.zoomScaleTxt,1/x,1/_)}var _;if(u){_=u()}function w(){var e={};for(var r=0;r<p.length;r++){var n=t._fullLayout[d[p[r]].axisName];var a=d[p[r]].to;e[n._name+".range[0]"]=a[0];e[n._name+".range[1]"]=a[1];n.range=a.slice()}_&&_();return i.call("relayout",t,e).then(function(){for(var e=0;e<g.length;e++){b(g[e])}})}function M(){var e={};for(var r=0;r<p.length;r++){var n=t._fullLayout[p[r]+"axis"];e[n._name+".range[0]"]=n.range[0];e[n._name+".range[1]"]=n.range[1];n.range=n._r.slice()}return i.call("relayout",t,e).then(function(){for(var e=0;e<g.length;e++){b(g[e])}})}var A,T,k;var E=n.ease(l.easing);t._transitionData._interruptCallbacks.push(function(){window.cancelAnimationFrame(k);k=null;return M()});function S(){T=Date.now();var e=Math.min(1,(T-A)/l.duration);var t=E(e);for(var r=0;r<g.length;r++){x(g[r],t)}if(T-A>l.duration){w();k=window.cancelAnimationFrame(S)}else{k=window.requestAnimationFrame(S)}}A=Date.now();k=window.requestAnimationFrame(S);return Promise.resolve()}},{"../../components/drawing":386,"../../registry":582,"./axes":529,"./constants":534,d3:81}],552:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("./axis_autotype");var a=e("./axis_ids").name2id;t.exports=function e(t,r,n,i,s){if(s){r._name=s;r._id=a(s)}var l=n("type");if(l==="-"){o(r,i);if(r.type==="-"){r.type="linear"}else{t.type=r.type}}};function o(e,t){if(e.type!=="-")return;var r=e._id;var a=r.charAt(0);if(r.indexOf("scene")!==-1)r=a;var o=s(t,r,a);if(!o)return;if(o.type==="histogram"&&a==={v:"y",h:"x"}[o.orientation||"v"]){e.type="linear";return}var f=a+"calendar";var c=o[f];var h;if(u(o,a)){var v=l(o);var d=[];for(h=0;h<t.length;h++){var p=t[h];if(!n.traceIs(p,"box-violin")||(p[a+"axis"]||a)!==r)continue;if(p[v]!==undefined)d.push(p[v][0]);else if(p.name!==undefined)d.push(p.name);else d.push("text");if(p[f]!==c)c=undefined}e.type=i(d,c)}else if(o.type==="splom"){var g=o.dimensions;for(h=0;h<g.length;h++){var m=g[h];if(m.visible){e.type=i(m.values,c);break}}}else{e.type=i(o[a]||[o[a+"0"]],c)}}function s(e,t,r){for(var n=0;n<e.length;n++){var i=e[n];if(i.type==="splom"&&i._length>0&&i["_"+r+"axes"][t]){return i}if((i[r+"axis"]||r)===t){if(u(i,r)){return i}else if((i[r]||[]).length||i[r+"0"]){return i}}}}function l(e){return{v:"x",h:"y"}[e.orientation||"v"]}function u(e,t){var r=l(e),i=n.traceIs(e,"box-violin"),a=n.traceIs(e._fullInput||{},"candlestick");return i&&!a&&t===r&&e[r]===undefined&&e[r+"0"]===undefined}},{"../../registry":582,"./axis_autotype":530,"./axis_ids":532}],553:[function(e,t,r){"use strict";var n=e("../registry");var i=e("../lib");r.manageCommandObserver=function(e,t,n,o){var s={};var l=true;if(t&&t._commandObserver){s=t._commandObserver}if(!s.cache){s.cache={}}s.lookupTable={};var u=r.hasSimpleAPICommandBindings(e,n,s.lookupTable);if(t&&t._commandObserver){if(!u){if(t._commandObserver.remove){t._commandObserver.remove();t._commandObserver=null;return s}}else{return s}}if(u){a(e,u,s.cache);s.check=function t(){if(!l)return;var r=a(e,u,s.cache);if(r.changed&&o){if(s.lookupTable[r.value]!==undefined){s.disable();Promise.resolve(o({value:r.value,type:u.type,prop:u.prop,traces:u.traces,index:s.lookupTable[r.value]})).then(s.enable,s.enable)}}return r.changed};var f=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"];for(var c=0;c<f.length;c++){e._internalOn(f[c],s.check)}s.remove=function(){for(var t=0;t<f.length;t++){e._removeInternalListener(f[t],s.check)}}}else{i.log("Unable to automatically bind plot updates to API command");s.lookupTable={};s.remove=function(){}}s.disable=function e(){l=false};s.enable=function e(){l=true};if(t){t._commandObserver=s}return s};r.hasSimpleAPICommandBindings=function(e,t,n){var i;var a=t.length;var o;for(i=0;i<a;i++){var s;var l=t[i];var u=l.method;var f=l.args;if(!Array.isArray(f))f=[];if(!u){return false}var c=r.computeAPICommandBindings(e,u,f);if(c.length!==1){return false}if(!o){o=c[0];if(Array.isArray(o.traces)){o.traces.sort()}}else{s=c[0];if(s.type!==o.type){return false}if(s.prop!==o.prop){return false}if(Array.isArray(o.traces)){if(Array.isArray(s.traces)){s.traces.sort();for(var h=0;h<o.traces.length;h++){if(o.traces[h]!==s.traces[h]){return false}}}else{return false}}else{if(s.prop!==o.prop){return false}}}s=c[0];var v=s.value;if(Array.isArray(v)){if(v.length===1){v=v[0]}else{return false}}if(n){n[v]=i}}return o};function a(e,t,r){var n,a,o;var s=false;if(t.type==="data"){n=e._fullData[t.traces!==null?t.traces[0]:0]}else if(t.type==="layout"){n=e._fullLayout}else{return false}a=i.nestedProperty(n,t.prop).get();o=r[t.type]=r[t.type]||{};if(o.hasOwnProperty(t.prop)){if(o[t.prop]!==a){s=true}}o[t.prop]=a;return{changed:s,value:a}}r.executeAPICommand=function(e,t,r){if(t==="skip")return Promise.resolve();var a=n.apiMethodRegistry[t];var o=[e];if(!Array.isArray(r))r=[];for(var s=0;s<r.length;s++){o.push(r[s])}return a.apply(null,o).catch(function(e){i.warn("API call to Plotly."+t+" rejected.",e);return Promise.reject(e)})};r.computeAPICommandBindings=function(e,t,r){var n;if(!Array.isArray(r))r=[];switch(t){case"restyle":n=l(e,r);break;case"relayout":n=s(e,r);break;case"update":n=l(e,[r[0],r[2]]).concat(s(e,[r[1]]));break;case"animate":n=o(e,r);break;default:n=[]}return n};function o(e,t){if(Array.isArray(t[0])&&t[0].length===1&&["string","number"].indexOf(typeof t[0][0])!==-1){return[{type:"layout",prop:"_currentFrame",value:t[0][0].toString()}]}else{return[]}}function s(e,t){var r=[];var n=t[0];var a={};if(typeof n==="string"){a[n]=t[1]}else if(i.isPlainObject(n)){a=n}else{return r}u(a,function(e,t,n){r.push({type:"layout",prop:e,value:n})},"",0);return r}function l(e,t){var r,n,a,o;var s=[];n=t[0];a=t[1];r=t[2];o={};if(typeof n==="string"){o[n]=a}else if(i.isPlainObject(n)){o=n;if(r===undefined){r=a}}else{return s}if(r===undefined){r=null}u(o,function(t,n,i){var a;if(Array.isArray(i)){var o=Math.min(i.length,e.data.length);if(r){o=Math.min(o,r.length)}a=[];for(var l=0;l<o;l++){a[l]=r?r[l]:l}}else{a=r?r.slice(0):null}if(a===null){if(Array.isArray(i)){i=i[0]}}else if(Array.isArray(a)){if(!Array.isArray(i)){var u=i;i=[];for(var f=0;f<a.length;f++){i[f]=u}}i.length=Math.min(a.length,i.length)}s.push({type:"data",prop:t,traces:a,value:i})},"",0);return s}function u(e,t,r,n){Object.keys(e).forEach(function(a){var o=e[a];if(a[0]==="_")return;var s=r+(n>0?".":"")+a;if(i.isPlainObject(o)){u(o,t,s,n+1)}else{t(s,a,o)}})}},{"../lib":483,"../registry":582}],554:[function(e,t,r){"use strict";var n=e("../lib/extend").extendFlat;r.attributes=function(e,t){e=e||{};t=t||{};var r={valType:"info_array",editType:e.editType,items:[{valType:"number",min:0,max:1,editType:e.editType},{valType:"number",min:0,max:1,editType:e.editType}],dflt:[0,1]};var i=e.name?e.name+" ":"";var a=e.trace?"trace ":"subplot ";var o=t.description?" "+t.description:"";var s={x:n({},r,{}),y:n({},r,{}),editType:e.editType};if(!e.noGridCell){s.row={valType:"integer",min:0,dflt:0,editType:e.editType};s.column={valType:"integer",min:0,dflt:0,editType:e.editType}}return s};r.defaults=function(e,t,r,n){var i=n&&n.x||[0,1];var a=n&&n.y||[0,1];var o=t.grid;if(o){var s=r("domain.column");if(s!==undefined){if(s<o.columns)i=o._domains.x[s];else delete e.domain.column}var l=r("domain.row");if(l!==undefined){if(l<o.rows)a=o._domains.y[l];else delete e.domain.row}}r("domain.x",i);r("domain.y",a)}},{"../lib/extend":475}],555:[function(e,t,r){"use strict";t.exports=function(e){var t=e.editType;var r=e.colorEditType;if(r===undefined)r=t;var n={family:{valType:"string",noBlank:true,strict:true,editType:t},size:{valType:"number",min:1,editType:t},color:{valType:"color",editType:r},editType:t};if(e.arrayOk){n.family.arrayOk=true;n.size.arrayOk=true;n.color.arrayOk=true}return n}},{}],556:[function(e,t,r){"use strict";t.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],557:[function(e,t,r){"use strict";var n=e("../registry");var i=e("./cartesian/constants").SUBPLOT_PATTERN;r.getSubplotCalcData=function(e,t,r){var i=n.subplotsRegistry[t];if(!i)return[];var a=i.attr;var o=[];for(var s=0;s<e.length;s++){var l=e[s];var u=l[0].trace;if(u[a]===r)o.push(l)}return o};r.getModuleCalcData=function(e,t){var r=[];var i=[];var a;if(typeof t==="string"){a=n.getModule(t).plot}else if(typeof t==="function"){a=t}else{a=t.plot}if(!a){return[r,e]}for(var o=0;o<e.length;o++){var s=e[o];var l=s[0].trace;if(l.visible!==true)continue;if(l._module.plot===a){r.push(s)}else{i.push(s)}}return[r,i]};r.getSubplotData=function e(t,r,a){if(!n.subplotsRegistry[r])return[];var o=n.subplotsRegistry[r].attr;var s=[];var l,u,f;if(r==="gl2d"){var c=a.match(i);u="x"+c[1];f="y"+c[2]}for(var h=0;h<t.length;h++){l=t[h];if(r==="gl2d"&&n.traceIs(l,"gl2d")){if(l[o[0]]===u&&l[o[1]]===f){s.push(l)}}else{if(l[o]===a)s.push(l)}}return s};r.getUidsFromCalcData=function(e){var t={};for(var r=0;r<e.length;r++){var n=e[r][0].trace;t[n.uid]=1}return t}},{"../registry":582,"./cartesian/constants":534}],558:[function(e,t,r){"use strict";t.exports=u;var n=e("right-now");var i=e("3d-view");var a=e("mouse-change");var o=e("mouse-wheel");var s=e("mouse-event-offset");var l=e("has-passive-events");function u(e,t){e=e||document.body;t=t||{};var r=[.01,Infinity];if("distanceLimits"in t){r[0]=t.distanceLimits[0];r[1]=t.distanceLimits[1]}if("zoomMin"in t){r[0]=t.zoomMin}if("zoomMax"in t){r[1]=t.zoomMax}var u=i({center:t.center||[0,0,0],up:t.up||[0,1,0],eye:t.eye||[0,0,10],mode:t.mode||"orbit",distanceLimits:r});var f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var c=0;var h=e.clientWidth;var v=e.clientHeight;var d={keyBindingMode:"rotate",view:u,element:e,delay:t.delay||16,rotateSpeed:t.rotateSpeed||1,zoomSpeed:t.zoomSpeed||1,translateSpeed:t.translateSpeed||1,flipX:!!t.flipX,flipY:!!t.flipY,modes:u.modes,tick:function(){var t=n();var r=this.delay;var i=t-2*r;u.idle(t-r);u.recalcMatrix(i);u.flush(t-(100+r*2));var a=true;var o=u.computedMatrix;for(var s=0;s<16;++s){a=a&&f[s]===o[s];f[s]=o[s]}var l=e.clientWidth===h&&e.clientHeight===v;h=e.clientWidth;v=e.clientHeight;if(a)return!l;c=Math.exp(u.computedRadius[0]);return true},lookAt:function(e,t,r){u.lookAt(u.lastT(),e,t,r)},rotate:function(e,t,r){u.rotate(u.lastT(),e,t,r)},pan:function(e,t,r){u.pan(u.lastT(),e,t,r)},translate:function(e,t,r){u.translate(u.lastT(),e,t,r)}};Object.defineProperties(d,{matrix:{get:function(){return u.computedMatrix},set:function(e){u.setMatrix(u.lastT(),e);return u.computedMatrix},enumerable:true},mode:{get:function(){return u.getMode()},set:function(e){var t=u.computedUp.slice();var r=u.computedEye.slice();var i=u.computedCenter.slice();u.setMode(e);if(e==="turntable"){var a=n();u._active.lookAt(a,r,i,t);u._active.lookAt(a+500,r,i,[0,0,1]);u._active.flush(a)}return u.getMode()},enumerable:true},center:{get:function(){return u.computedCenter},set:function(e){u.lookAt(u.lastT(),null,e);return u.computedCenter},enumerable:true},eye:{get:function(){return u.computedEye},set:function(e){u.lookAt(u.lastT(),e);return u.computedEye},enumerable:true},up:{get:function(){return u.computedUp},set:function(e){u.lookAt(u.lastT(),null,null,e);return u.computedUp},enumerable:true},distance:{get:function(){return c},set:function(e){u.setDistance(u.lastT(),e);return e},enumerable:true},distanceLimits:{get:function(){return u.getDistanceLimits(r)},set:function(e){u.setDistanceLimits(e);return e},enumerable:true}});e.addEventListener("contextmenu",function(e){e.preventDefault();return false});var p=0,g=0,m={shift:false,control:false,alt:false,meta:false};d.mouseListener=a(e,y);e.addEventListener("touchstart",function(t){var r=s(t.changedTouches[0],e);y(0,r[0],r[1],m);y(1,r[0],r[1],m);t.preventDefault()},l?{passive:false}:false);e.addEventListener("touchmove",function(t){var r=s(t.changedTouches[0],e);y(1,r[0],r[1],m);t.preventDefault()},l?{passive:false}:false);e.addEventListener("touchend",function(e){y(0,p,g,m);e.preventDefault()},l?{passive:false}:false);function y(t,r,i,a){var o=d.keyBindingMode;if(o===false)return;var s=o==="rotate";var l=o==="pan";var f=o==="zoom";var h=!!a.control;var v=!!a.alt;var y=!!a.shift;var b=!!(t&1);var x=!!(t&2);var _=!!(t&4);var w=1/e.clientHeight;var M=w*(r-p);var A=w*(i-g);var T=d.flipX?1:-1;var k=d.flipY?1:-1;var E=n();var S=Math.PI*d.rotateSpeed;if(s&&b&&!h&&!v&&!y||b&&!h&&!v&&y){u.rotate(E,T*S*M,-k*S*A,0)}if(l&&b&&!h&&!v&&!y||x||b&&h&&!v&&!y){u.pan(E,-d.translateSpeed*M*c,d.translateSpeed*A*c,0)}if(f&&b&&!h&&!v&&!y||_||b&&!h&&v&&!y){var L=-d.zoomSpeed*A/window.innerHeight*(E-u.lastT())*100;u.pan(E,0,0,c*(Math.exp(L)-1))}p=r;g=i;m=a;return true}d.wheelListener=o(e,function(e,t){if(d.keyBindingMode===false)return;var r=d.flipX?1:-1;var i=d.flipY?1:-1;var a=n();if(Math.abs(e)>Math.abs(t)){u.rotate(a,0,0,-e*r*Math.PI*d.rotateSpeed/window.innerWidth)}else{var o=-d.zoomSpeed*i*t/window.innerHeight*(a-u.lastT())/20;u.pan(a,0,0,c*(Math.exp(o)-1))}},true);return d}},{"3d-view":11,"has-passive-events":237,"mouse-change":255,"mouse-event-offset":256,"mouse-wheel":258,"right-now":300}],559:[function(e,t,r){"use strict";var n=e("../../plot_api/edit_types").overrideAll;var i=e("../../components/fx/layout_attributes");var a=e("./scene");var o=e("../get_data").getSubplotData;var s=e("../../lib");var l=e("../../constants/xmlns_namespaces");var u="gl3d";var f="scene";r.name=u;r.attr=f;r.idRoot=f;r.idRegex=r.attrRegex=s.counterRegex("scene");r.attributes=e("./layout/attributes");r.layoutAttributes=e("./layout/layout_attributes");r.baseLayoutAttrOverrides=n({hoverlabel:i.hoverlabel},"plot","nested");r.supplyLayoutDefaults=e("./layout/defaults");r.plot=function e(t){var r=t._fullLayout;var n=t._fullData;var i=r._subplots[u];for(var l=0;l<i.length;l++){var f=i[l],c=o(n,u,f),h=r[f],v=h._scene;if(!v){v=new a({id:f,graphDiv:t,container:t.querySelector(".gl-container"),staticPlot:t._context.staticPlot,plotGlPixelRatio:t._context.plotGlPixelRatio},r);h._scene=v}if(!v.cameraInitial){v.cameraInitial=s.extendDeep({},h.camera)}v.plot(c,r,t.layout)}};r.clean=function(e,t,r,n){var i=n._subplots[u]||[];for(var a=0;a<i.length;a++){var o=i[a];if(!t[o]&&!!n[o]._scene){n[o]._scene.destroy();if(n._infolayer){n._infolayer.selectAll(".annotation-"+o).remove()}}}};r.toSVG=function(e){var t=e._fullLayout;var r=t._subplots[u];var n=t._size;for(var i=0;i<r.length;i++){var a=t[r[i]];var o=a.domain;var s=a._scene;var f=s.toImage("png");var c=t._glimages.append("svg:image");c.attr({xmlns:l.svg,"xlink:href":f,x:n.l+n.w*o.x[0],y:n.t+n.h*(1-o.y[1]),width:n.w*(o.x[1]-o.x[0]),height:n.h*(o.y[1]-o.y[0]),preserveAspectRatio:"none"});s.destroy()}};r.cleanId=function e(t){if(!t.match(/^scene[0-9]*$/))return;var r=t.substr(5);if(r==="1")r="";return f+r};r.updateFx=function(e){var t=e._subplots[u];for(var r=0;r<t.length;r++){var n=e[t[r]]._scene;n.updateFx(e.dragmode,e.hovermode)}}},{"../../components/fx/layout_attributes":404,"../../constants/xmlns_namespaces":465,"../../lib":483,"../../plot_api/edit_types":512,"../get_data":557,"./layout/attributes":560,"./layout/defaults":564,"./layout/layout_attributes":565,"./scene":569}],560:[function(e,t,r){"use strict";t.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],561:[function(e,t,r){"use strict";var n=e("../../../components/color");var i=e("../../cartesian/layout_attributes");var a=e("../../../lib/extend").extendFlat;var o=e("../../../plot_api/edit_types").overrideAll;t.exports=o({visible:i.visible,showspikes:{valType:"boolean",dflt:true},spikesides:{valType:"boolean",dflt:true},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:n.defaultLine},showbackground:{valType:"boolean",dflt:false},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:true},color:i.color,categoryorder:i.categoryorder,categoryarray:i.categoryarray,title:i.title,titlefont:i.titlefont,type:i.type,autorange:i.autorange,rangemode:i.rangemode,range:i.range,tickmode:i.tickmode,nticks:i.nticks,tick0:i.tick0,dtick:i.dtick,tickvals:i.tickvals,ticktext:i.ticktext,ticks:i.ticks,mirror:i.mirror,ticklen:i.ticklen,tickwidth:i.tickwidth,tickcolor:i.tickcolor,showticklabels:i.showticklabels,tickfont:i.tickfont,tickangle:i.tickangle,tickprefix:i.tickprefix,showtickprefix:i.showtickprefix,ticksuffix:i.ticksuffix,showticksuffix:i.showticksuffix,showexponent:i.showexponent,exponentformat:i.exponentformat,separatethousands:i.separatethousands,tickformat:i.tickformat,tickformatstops:i.tickformatstops,hoverformat:i.hoverformat,showline:i.showline,linecolor:i.linecolor,linewidth:i.linewidth,showgrid:i.showgrid,gridcolor:a({},i.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:i.gridwidth,zeroline:i.zeroline,zerolinecolor:i.zerolinecolor,zerolinewidth:i.zerolinewidth},"plot","from-root")},{"../../../components/color":361,"../../../lib/extend":475,"../../../plot_api/edit_types":512,"../../cartesian/layout_attributes":541}],562:[function(e,t,r){"use strict";var n=e("tinycolor2").mix;var i=e("../../../lib");var a=e("../../../plot_api/plot_template");var o=e("./axis_attributes");var s=e("../../cartesian/type_defaults");var l=e("../../cartesian/axis_defaults");var u=["xaxis","yaxis","zaxis"];var f=100*(204-68)/(255-68);t.exports=function e(t,r,c){var h,v;function d(e,t){return i.coerce(h,v,o,e,t)}for(var p=0;p<u.length;p++){var g=u[p];h=t[g]||{};v=a.newContainer(r,g);v._id=g[0]+c.scene;v._name=g;s(h,v,d,c.data);l(h,v,d,{font:c.font,letter:g[0],data:c.data,showGrid:true,bgColor:c.bgColor,calendar:c.calendar},c.fullLayout);d("gridcolor",n(v.color,c.bgColor,f).toRgbString());d("title",g[0]);v.setScale=i.noop;if(d("showspikes")){d("spikesides");d("spikethickness");d("spikecolor",v.color)}d("showaxeslabels");if(d("showbackground"))d("backgroundcolor")}}},{"../../../lib":483,"../../../plot_api/plot_template":519,"../../cartesian/axis_defaults":531,"../../cartesian/type_defaults":552,"./axis_attributes":561,tinycolor2:327}],563:[function(e,t,r){"use strict";var n=e("../../../lib/html2unicode");var i=e("../../../lib/str2rgbarray");var a=["xaxis","yaxis","zaxis"];function o(){this.bounds=[[-10,-10,-10],[10,10,10]];this.ticks=[[],[],[]];this.tickEnable=[true,true,true];this.tickFont=["sans-serif","sans-serif","sans-serif"];this.tickSize=[12,12,12];this.tickAngle=[0,0,0];this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.tickPad=[18,18,18];this.labels=["x","y","z"];this.labelEnable=[true,true,true];this.labelFont=["Open Sans","Open Sans","Open Sans"];this.labelSize=[20,20,20];this.labelAngle=[0,0,0];this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.labelPad=[30,30,30];this.lineEnable=[true,true,true];this.lineMirror=[false,false,false];this.lineWidth=[1,1,1];this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.lineTickEnable=[true,true,true];this.lineTickMirror=[false,false,false];this.lineTickLength=[10,10,10];this.lineTickWidth=[1,1,1];this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.gridEnable=[true,true,true];this.gridWidth=[1,1,1];this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroEnable=[true,true,true];this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.zeroLineWidth=[2,2,2];this.backgroundEnable=[true,true,true];this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]];this._defaultTickPad=this.tickPad.slice();this._defaultLabelPad=this.labelPad.slice();this._defaultLineTickLength=this.lineTickLength.slice()}var s=o.prototype;s.merge=function(e){var t=this;for(var r=0;r<3;++r){var o=e[a[r]];if(!o.visible){t.tickEnable[r]=false;t.labelEnable[r]=false;t.lineEnable[r]=false;t.lineTickEnable[r]=false;t.gridEnable[r]=false;t.zeroEnable[r]=false;t.backgroundEnable[r]=false;continue}t.labels[r]=n(o.title);if("titlefont"in o){if(o.titlefont.color)t.labelColor[r]=i(o.titlefont.color);if(o.titlefont.family)t.labelFont[r]=o.titlefont.family;if(o.titlefont.size)t.labelSize[r]=o.titlefont.size}if("showline"in o)t.lineEnable[r]=o.showline;if("linecolor"in o)t.lineColor[r]=i(o.linecolor);if("linewidth"in o)t.lineWidth[r]=o.linewidth;if("showgrid"in o)t.gridEnable[r]=o.showgrid;if("gridcolor"in o)t.gridColor[r]=i(o.gridcolor);if("gridwidth"in o)t.gridWidth[r]=o.gridwidth;if(o.type==="log")t.zeroEnable[r]=false;else if("zeroline"in o)t.zeroEnable[r]=o.zeroline;if("zerolinecolor"in o)t.zeroLineColor[r]=i(o.zerolinecolor);if("zerolinewidth"in o)t.zeroLineWidth[r]=o.zerolinewidth;if("ticks"in o&&!!o.ticks)t.lineTickEnable[r]=true;else t.lineTickEnable[r]=false;if("ticklen"in o){t.lineTickLength[r]=t._defaultLineTickLength[r]=o.ticklen}if("tickcolor"in o)t.lineTickColor[r]=i(o.tickcolor);if("tickwidth"in o)t.lineTickWidth[r]=o.tickwidth;if("tickangle"in o){t.tickAngle[r]=o.tickangle==="auto"?0:Math.PI*-o.tickangle/180}if("showticklabels"in o)t.tickEnable[r]=o.showticklabels;if("tickfont"in o){if(o.tickfont.color)t.tickColor[r]=i(o.tickfont.color);if(o.tickfont.family)t.tickFont[r]=o.tickfont.family;if(o.tickfont.size)t.tickSize[r]=o.tickfont.size}if("mirror"in o){if(["ticks","all","allticks"].indexOf(o.mirror)!==-1){t.lineTickMirror[r]=true;t.lineMirror[r]=true}else if(o.mirror===true){t.lineTickMirror[r]=false;t.lineMirror[r]=true}else{t.lineTickMirror[r]=false;t.lineMirror[r]=false}}else t.lineMirror[r]=false;if("showbackground"in o&&o.showbackground!==false){t.backgroundEnable[r]=true;t.backgroundColor[r]=i(o.backgroundcolor)}else t.backgroundEnable[r]=false}};function l(e){var t=new o;t.merge(e);return t}t.exports=l},{"../../../lib/html2unicode":481,"../../../lib/str2rgbarray":505}],564:[function(e,t,r){"use strict";var n=e("../../../lib");var i=e("../../../components/color");var a=e("../../../registry");var o=e("../../subplot_defaults");var s=e("./axis_defaults");var l=e("./layout_attributes");t.exports=function e(t,r,i){var a=r._basePlotModules.length>1;function s(e){if(a)return;var r=n.validate(t[e],l[e]);if(r)return t[e]}o(t,r,i,{type:"gl3d",attributes:l,handleDefaults:u,fullLayout:r,font:r.font,fullData:i,getDfltFromLayout:s,paper_bgcolor:r.paper_bgcolor,calendar:r.calendar})};function u(e,t,r,n){var o=r("bgcolor"),l=i.combine(o,n.paper_bgcolor);var u=["up","center","eye"];for(var f=0;f<u.length;f++){r("camera."+u[f]+".x");r("camera."+u[f]+".y");r("camera."+u[f]+".z")}var c=!!r("aspectratio.x")&&!!r("aspectratio.y")&&!!r("aspectratio.z");var h=c?"manual":"auto";var v=r("aspectmode",h);if(!c){e.aspectratio=t.aspectratio={x:1,y:1,z:1};if(v==="manual")t.aspectmode="auto";e.aspectmode=t.aspectmode}s(e,t,{font:n.font,scene:n.id,data:n.fullData,bgColor:l,calendar:n.calendar,fullLayout:n.fullLayout});a.getComponentMethod("annotations3d","handleDefaults")(e,t,n);r("dragmode",n.getDfltFromLayout("dragmode"));r("hovermode",n.getDfltFromLayout("hovermode"))}},{"../../../components/color":361,"../../../lib":483,"../../../registry":582,"../../subplot_defaults":581,"./axis_defaults":562,"./layout_attributes":565}],565:[function(e,t,r){"use strict";var n=e("./axis_attributes");var i=e("../../domain").attributes;var a=e("../../../lib/extend").extendFlat;var o=e("../../../lib").counterRegex;function s(e,t,r){return{x:{valType:"number",dflt:e,editType:"camera"},y:{valType:"number",dflt:t,editType:"camera"},z:{valType:"number",dflt:r,editType:"camera"},editType:"camera"}}t.exports={_arrayAttrRegexps:[o("scene",".annotations",true)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:a(s(0,0,1),{}),center:a(s(0,0,0),{}),eye:a(s(1.25,1.25,1.25),{}),editType:"camera"},domain:i({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":undefined,"aspectratio.y":undefined,"aspectratio.z":undefined}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:n,yaxis:n,zaxis:n,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",false],dflt:"turntable",editType:"plot"},hovermode:{valType:"enumerated",values:["closest",false],dflt:"closest",editType:"modebar"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":483,"../../../lib/extend":475,"../../domain":554,"./axis_attributes":561}],566:[function(e,t,r){"use strict";var n=e("../../../lib/str2rgbarray");var i=["xaxis","yaxis","zaxis"];function a(){this.enabled=[true,true,true];this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]];this.drawSides=[true,true,true];this.lineWidth=[1,1,1]}var o=a.prototype;o.merge=function(e){for(var t=0;t<3;++t){var r=e[i[t]];if(!r.visible){this.enabled[t]=false;this.drawSides[t]=false;continue}this.enabled[t]=r.showspikes;this.colors[t]=n(r.spikecolor);this.drawSides[t]=r.spikesides;this.lineWidth[t]=r.spikethickness}};function s(e){var t=new a;t.merge(e);return t}t.exports=s},{"../../../lib/str2rgbarray":505}],567:[function(e,t,r){"use strict";t.exports=u;var n=e("../../cartesian/axes");var i=e("../../../lib");var a=e("../../../lib/html2unicode");var o=["xaxis","yaxis","zaxis"];var s=[0,0,0];function l(e){var t=new Array(3);for(var r=0;r<3;++r){var n=e[r];var i=new Array(n.length);for(var a=0;a<n.length;++a){i[a]=n[a].x}t[r]=i}return t}function u(e){var t=e.axesOptions;var r=e.glplot.axesPixels;var u=e.fullSceneLayout;var f=[[],[],[]];for(var c=0;c<3;++c){var h=u[o[c]];h._length=(r[c].hi-r[c].lo)*r[c].pixelsPerDataUnit/e.dataScale[c];if(Math.abs(h._length)===Infinity){f[c]=[]}else{h._input_range=h.range.slice();h.range[0]=r[c].lo/e.dataScale[c];h.range[1]=r[c].hi/e.dataScale[c];h._m=1/(e.dataScale[c]*r[c].pixelsPerDataUnit);if(h.range[0]===h.range[1]){h.range[0]-=1;h.range[1]+=1}var v=h.tickmode;if(h.tickmode==="auto"){h.tickmode="linear";var d=h.nticks||i.constrain(h._length/40,4,9);n.autoTicks(h,Math.abs(h.range[1]-h.range[0])/d)}var p=n.calcTicks(h);for(var g=0;g<p.length;++g){p[g].x=p[g].x*e.dataScale[c];p[g].text=a(p[g].text)}f[c]=p;h.tickmode=v}}t.ticks=f;for(var c=0;c<3;++c){s[c]=.5*(e.glplot.bounds[0][c]+e.glplot.bounds[1][c]);for(var g=0;g<2;++g){t.bounds[g][c]=e.glplot.bounds[g][c]}}e.contourLevels=l(f)}},{"../../../lib":483,"../../../lib/html2unicode":481,"../../cartesian/axes":529}],568:[function(e,t,r){"use strict";function n(e,t){var r=[0,0,0,0];var n,i;for(n=0;n<4;++n){for(i=0;i<4;++i){r[i]+=e[4*n+i]*t[n]}}return r}function i(e,t){var r=n(e.projection,n(e.view,n(e.model,[t[0],t[1],t[2],1])));return r}t.exports=i},{}],569:[function(e,t,r){"use strict";var n=e("gl-plot3d");var i=e("webgl-context");var a=e("has-passive-events");var o=e("../../registry");var s=e("../../lib");var l=e("../../plots/cartesian/axes");var u=e("../../components/fx");var f=e("../../lib/str2rgbarray");var c=e("../../lib/show_no_webgl_msg");var h=e("./camera");var v=e("./project");var d=e("./layout/convert");var p=e("./layout/spikes");var g=e("./layout/tick_marks");var m,y;function b(e){var t;var r=e.svgContainer;var n=e.container.getBoundingClientRect();var i=n.width,a=n.height;r.setAttributeNS(null,"viewBox","0 0 "+i+" "+a);r.setAttributeNS(null,"width",i);r.setAttributeNS(null,"height",a);g(e);e.glplot.axes.update(e.axesOptions);var o=Object.keys(e.traces);var s=null;var f=e.glplot.selection;for(var c=0;c<o.length;++c){t=e.traces[o[c]];if(t.data.hoverinfo!=="skip"&&t.handlePick(f)){s=t}if(t.setContourLevels)t.setContourLevels()}function h(t,r){var n=e.fullSceneLayout[t];return l.tickText(n,n.d2l(r),"hover").text}var d;if(s!==null){var p=v(e.glplot.cameraParams,f.dataCoordinate);t=s.data;var m=f.index;var y=u.castHoverinfo(t,e.fullLayout,m);var b=y.split("+");var x=y==="all";var _=h("xaxis",f.traceCoordinate[0]);var w=h("yaxis",f.traceCoordinate[1]);var M=h("zaxis",f.traceCoordinate[2]);if(!x){if(b.indexOf("x")===-1)_=undefined;if(b.indexOf("y")===-1)w=undefined;if(b.indexOf("z")===-1)M=undefined;if(b.indexOf("text")===-1)f.textLabel=undefined;if(b.indexOf("name")===-1)s.name=undefined}var A;if(t.type==="cone"||t.type==="streamtube"){var T=[];if(x||b.indexOf("u")!==-1){T.push("u: "+h("xaxis",f.traceCoordinate[3]))}if(x||b.indexOf("v")!==-1){T.push("v: "+h("yaxis",f.traceCoordinate[4]))}if(x||b.indexOf("w")!==-1){T.push("w: "+h("zaxis",f.traceCoordinate[5]))}if(x||b.indexOf("norm")!==-1){T.push("norm: "+f.traceCoordinate[6].toPrecision(3))}if(t.type==="streamtube"&&(x||b.indexOf("divergence")!==-1)){T.push("divergence: "+f.traceCoordinate[7].toPrecision(3))}if(f.textLabel){T.push(f.textLabel)}A=T.join("<br>")}else{A=f.textLabel}if(e.fullSceneLayout.hovermode){u.loneHover({x:(.5+.5*p[0]/p[3])*i,y:(.5-.5*p[1]/p[3])*a,xLabel:_,yLabel:w,zLabel:M,text:A,name:s.name,color:u.castHoverOption(t,m,"bgcolor")||s.color,borderColor:u.castHoverOption(t,m,"bordercolor"),fontFamily:u.castHoverOption(t,m,"font.family"),fontSize:u.castHoverOption(t,m,"font.size"),fontColor:u.castHoverOption(t,m,"font.color")},{container:r,gd:e.graphDiv})}var k={x:f.traceCoordinate[0],y:f.traceCoordinate[1],z:f.traceCoordinate[2],data:t._input,fullData:t,curveNumber:t.index,pointNumber:m};if(t._module.eventData){k=t._module.eventData(k,f,t,{},m)}u.appendArrayPointValue(k,t,m);var E={points:[k]};if(f.buttons&&f.distance<5){e.graphDiv.emit("plotly_click",E)}else{e.graphDiv.emit("plotly_hover",E)}d=E}else{u.loneUnhover(r);e.graphDiv.emit("plotly_unhover",d)}e.drawAnnotations(e)}function x(e,t,r,o){var l={canvas:r,gl:o,container:e.container,axes:e.axesOptions,spikes:e.spikeOptions,pickRadius:10,snapToData:true,autoScale:true,autoBounds:false};if(e.staticMode){if(!y){m=document.createElement("canvas");y=i({canvas:m,preserveDrawingBuffer:true,premultipliedAlpha:true,antialias:true});if(!y){throw new Error("error creating static canvas/context for image server")}}l.pixelRatio=e.pixelRatio;l.gl=y;l.canvas=m}try{e.glplot=n(l)}catch(t){return c(e)}var u=function(e){if(e.fullSceneLayout.dragmode===false)return;var t={};t[e.id+".camera"]=k(e.camera);e.saveCamera(e.graphDiv.layout);e.graphDiv.emit("plotly_relayout",t)};e.glplot.canvas.addEventListener("mouseup",u.bind(null,e));e.glplot.canvas.addEventListener("wheel",u.bind(null,e),a?{passive:false}:false);if(!e.staticMode){e.glplot.canvas.addEventListener("webglcontextlost",function(e){s.warn("Lost WebGL context.");e.preventDefault()})}if(!e.camera){var f=e.fullSceneLayout.camera;e.camera=h(e.container,{center:[f.center.x,f.center.y,f.center.z],eye:[f.eye.x,f.eye.y,f.eye.z],up:[f.up.x,f.up.y,f.up.z],zoomMin:.1,zoomMax:100,mode:"orbit"})}e.glplot.camera=e.camera;e.glplot.oncontextloss=function(){e.recoverContext()};e.glplot.onrender=b.bind(null,e);e.traces={};return true}function _(e,t){var r=document.createElement("div");var n=e.container;this.graphDiv=e.graphDiv;var i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.style.position="absolute";i.style.top=i.style.left="0px";i.style.width=i.style.height="100%";i.style["z-index"]=20;i.style["pointer-events"]="none";r.appendChild(i);this.svgContainer=i;r.id=e.id;r.style.position="absolute";r.style.top=r.style.left="0px";r.style.width=r.style.height="100%";n.appendChild(r);this.fullLayout=t;this.id=e.id||"scene";this.fullSceneLayout=t[this.id];this.plotArgs=[[],{},{}];this.axesOptions=d(t[this.id]);this.spikeOptions=p(t[this.id]);this.container=r;this.staticMode=!!e.staticPlot;this.pixelRatio=e.plotGlPixelRatio||2;this.dataScale=[1,1,1];this.contourLevels=[[],[],[]];this.convertAnnotations=o.getComponentMethod("annotations3d","convert");this.drawAnnotations=o.getComponentMethod("annotations3d","draw");if(!x(this,t))return}var w=_.prototype;w.recoverContext=function(){var e=this;var t=this.glplot.gl;var r=this.glplot.canvas;this.glplot.dispose();function n(){if(t.isContextLost()){requestAnimationFrame(n);return}if(!x(e,e.fullLayout,r,t)){s.error("Catastrophic and unrecoverable WebGL error. Context lost.");return}e.plot.apply(e,e.plotArgs)}requestAnimationFrame(n)};var M=["xaxis","yaxis","zaxis"];function A(e,t,r){var n=e.fullSceneLayout;for(var i=0;i<3;i++){var a=M[i];var o=a.charAt(0);var l=n[a];var u=t[o];var f=t[o+"calendar"];var c=t["_"+o+"length"];if(!s.isArrayOrTypedArray(u)){r[0][i]=Math.min(r[0][i],0);r[1][i]=Math.max(r[1][i],c-1)}else{var h;for(var v=0;v<(c||u.length);v++){if(s.isArrayOrTypedArray(u[v])){for(var d=0;d<u[v].length;++d){h=l.d2l(u[v][d],0,f);if(!isNaN(h)&&isFinite(h)){r[0][i]=Math.min(r[0][i],h);r[1][i]=Math.max(r[1][i],h)}}}else{h=l.d2l(u[v],0,f);if(!isNaN(h)&&isFinite(h)){r[0][i]=Math.min(r[0][i],h);r[1][i]=Math.max(r[1][i],h)}}}}}}w.plot=function(e,t,r){this.plotArgs=[e,t,r];if(this.glplot.contextLost)return;var n,i;var a,o,s,l;var u=t[this.id];var c=r[this.id];if(u.bgcolor)this.glplot.clearColor=f(u.bgcolor);else this.glplot.clearColor=[0,0,0,0];this.glplot.snapToData=true;this.fullLayout=t;this.fullSceneLayout=u;this.glplotLayout=u;this.axesOptions.merge(u);this.spikeOptions.merge(u);this.setCamera(u.camera);this.updateFx(u.dragmode,u.hovermode);this.glplot.update({});this.setConvert(s);if(!e)e=[];else if(!Array.isArray(e))e=[e];var h=[[Infinity,Infinity,Infinity],[-Infinity,-Infinity,-Infinity]];for(a=0;a<e.length;++a){n=e[a];if(n.visible!==true)continue;A(this,n,h)}var v=[1,1,1];for(o=0;o<3;++o){if(h[0][o]>h[1][o]){v[o]=1}else{if(h[1][o]===h[0][o]){v[o]=1}else{v[o]=1/(h[1][o]-h[0][o])}}}this.dataScale=v;this.convertAnnotations(this);for(a=0;a<e.length;++a){n=e[a];if(n.visible!==true){continue}i=this.traces[n.uid];if(i){if(i.data.type===n.type){i.update(n)}else{i.dispose();i=n._module.plot(this,n);this.traces[n.uid]=i}}else{i=n._module.plot(this,n);this.traces[n.uid]=i}i.name=n.name}var d=Object.keys(this.traces);e:for(a=0;a<d.length;++a){for(o=0;o<e.length;++o){if(e[o].uid===d[a]&&e[o].visible===true){continue e}}i=this.traces[d[a]];i.dispose();delete this.traces[d[a]]}this.glplot.objects.sort(function(e,t){return e._trace.data.index-t._trace.data.index});var p=[[0,0,0],[0,0,0]],g=[],m={};for(a=0;a<3;++a){s=u[M[a]];l=s.type;if(l in m){m[l].acc*=v[a];m[l].count+=1}else{m[l]={acc:v[a],count:1}}if(s.autorange){p[0][a]=Infinity;p[1][a]=-Infinity;var y=this.glplot.objects;var b=this.fullSceneLayout.annotations||[];var x=s._name.charAt(0);for(o=0;o<y.length;o++){var _=y[o];var w=_.bounds;var T=_._trace.data._pad||0;p[0][a]=Math.min(p[0][a],w[0][a]/v[a]-T);p[1][a]=Math.max(p[1][a],w[1][a]/v[a]+T)}for(o=0;o<b.length;o++){var k=b[o];if(k.visible){var E=s.r2l(k[x]);p[0][a]=Math.min(p[0][a],E);p[1][a]=Math.max(p[1][a],E)}}if("rangemode"in s&&s.rangemode==="tozero"){p[0][a]=Math.min(p[0][a],0);p[1][a]=Math.max(p[1][a],0)}if(p[0][a]>p[1][a]){p[0][a]=-1;p[1][a]=1}else{var S=p[1][a]-p[0][a];p[0][a]-=S/32;p[1][a]+=S/32}}else{var L=s.range;p[0][a]=s.r2l(L[0]);p[1][a]=s.r2l(L[1])}if(p[0][a]===p[1][a]){p[0][a]-=1;p[1][a]+=1}g[a]=p[1][a]-p[0][a];this.glplot.bounds[0][a]=p[0][a]*v[a];this.glplot.bounds[1][a]=p[1][a]*v[a]}var C=[1,1,1];for(a=0;a<3;++a){s=u[M[a]];l=s.type;var I=m[l];C[a]=Math.pow(I.acc,1/I.count)/v[a]}var P=4;var O;if(u.aspectmode==="auto"){if(Math.max.apply(null,C)/Math.min.apply(null,C)<=P){O=C}else{O=[1,1,1]}}else if(u.aspectmode==="cube"){O=[1,1,1]}else if(u.aspectmode==="data"){O=C}else if(u.aspectmode==="manual"){var R=u.aspectratio;O=[R.x,R.y,R.z]}else{throw new Error("scene.js aspectRatio was not one of the enumerated types")}u.aspectratio.x=c.aspectratio.x=O[0];u.aspectratio.y=c.aspectratio.y=O[1];u.aspectratio.z=c.aspectratio.z=O[2];this.glplot.aspect=O;var N=u.domain||null,z=t._size||null;if(N&&z){var D=this.container.style;D.position="absolute";D.left=z.l+N.x[0]*z.w+"px";D.top=z.t+(1-N.y[1])*z.h+"px";D.width=z.w*(N.x[1]-N.x[0])+"px";D.height=z.h*(N.y[1]-N.y[0])+"px"}this.glplot.redraw()};w.destroy=function(){if(!this.glplot)return;this.camera.mouseListener.enabled=false;this.container.removeEventListener("wheel",this.camera.wheelListener);this.camera=this.glplot.camera=null;this.glplot.dispose();this.container.parentNode.removeChild(this.container);this.glplot=null};function T(e){return[[e.eye.x,e.eye.y,e.eye.z],[e.center.x,e.center.y,e.center.z],[e.up.x,e.up.y,e.up.z]]}function k(e){return{up:{x:e.up[0],y:e.up[1],z:e.up[2]},center:{x:e.center[0],y:e.center[1],z:e.center[2]},eye:{x:e.eye[0],y:e.eye[1],z:e.eye[2]}}}w.getCamera=function e(){this.glplot.camera.view.recalcMatrix(this.camera.view.lastT());return k(this.glplot.camera)};w.setCamera=function e(t){this.glplot.camera.lookAt.apply(this,T(t))};w.saveCamera=function e(t){var r=this.getCamera(),n=s.nestedProperty(t,this.id+".camera"),i=n.get(),a=false;function o(e,t,r,n){var i=["up","center","eye"],a=["x","y","z"];return t[i[r]]&&e[i[r]][a[n]]===t[i[r]][a[n]]}if(i===undefined)a=true;else{for(var l=0;l<3;l++){for(var u=0;u<3;u++){if(!o(r,i,l,u)){a=true;break}}}}if(a)n.set(r);return a};w.updateFx=function(e,t){var r=this.camera;if(r){if(e==="orbit"){r.mode="orbit";r.keyBindingMode="rotate"}else if(e==="turntable"){r.up=[0,0,1];r.mode="turntable";r.keyBindingMode="rotate"}else{r.keyBindingMode=e}}this.fullSceneLayout.hovermode=t};w.toImage=function(e){if(!e)e="png";if(this.staticMode)this.container.appendChild(m);this.glplot.redraw();var t=this.glplot.gl;var r=t.drawingBufferWidth;var n=t.drawingBufferHeight;t.bindFramebuffer(t.FRAMEBUFFER,null);var i=new Uint8Array(r*n*4);t.readPixels(0,0,r,n,t.RGBA,t.UNSIGNED_BYTE,i);for(var a=0,o=n-1;a<o;++a,--o){for(var s=0;s<r;++s){for(var l=0;l<4;++l){var u=i[4*(r*a+s)+l];i[4*(r*a+s)+l]=i[4*(r*o+s)+l];i[4*(r*o+s)+l]=u}}}var f=document.createElement("canvas");f.width=r;f.height=n;var c=f.getContext("2d");var h=c.createImageData(r,n);h.data.set(i);c.putImageData(h,0,0);var v;switch(e){case"jpeg":v=f.toDataURL("image/jpeg");break;case"webp":v=f.toDataURL("image/webp");break;default:v=f.toDataURL("image/png")}if(this.staticMode)this.container.removeChild(m);return v};w.setConvert=function(){for(var e=0;e<3;e++){var t=this.fullSceneLayout[M[e]];l.setConvert(t,this.fullLayout);t.setScale=s.noop}};t.exports=_},{"../../components/fx":403,"../../lib":483,"../../lib/show_no_webgl_msg":503,"../../lib/str2rgbarray":505,"../../plots/cartesian/axes":529,"../../registry":582,"./camera":558,"./layout/convert":563,"./layout/spikes":566,"./layout/tick_marks":567,"./project":568,"gl-plot3d":141,"has-passive-events":237,"webgl-context":342}],570:[function(e,t,r){"use strict";t.exports=function e(t,r,n,i){i=i||t.length;var a=new Array(i);for(var o=0;o<i;o++){a[o]=[t[o],r[o],n[o]]}return a}},{}],571:[function(e,t,r){"use strict";var n=e("./font_attributes");var i=e("../components/color/attributes");var a=n({editType:"calc"});a.family.dflt='"Open Sans", verdana, arial, sans-serif';a.size.dflt=12;a.color.dflt=i.defaultLine;t.exports={font:a,title:{valType:"string",editType:"layoutstyle"},titlefont:n({editType:"layoutstyle"}),autosize:{valType:"boolean",dflt:false,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},paper_bgcolor:{valType:"color",dflt:i.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:i.background,editType:"layoutstyle"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:false,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:i.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},template:{valType:"any",editType:"calc"}}},{"../components/color/attributes":360,"./font_attributes":555}],572:[function(e,t,r){"use strict";t.exports={t:{valType:"number",dflt:0,editType:"arraydraw"},r:{valType:"number",dflt:0,editType:"arraydraw"},b:{valType:"number",dflt:0,editType:"arraydraw"},l:{valType:"number",dflt:0,editType:"arraydraw"},editType:"arraydraw"}},{}],573:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../registry");var o=e("../plot_api/plot_schema");var s=e("../plot_api/plot_template");var l=e("../lib");var u=e("../components/color");var f=e("../constants/numerical").BADNUM;var c=e("../plots/cartesian/axis_ids");var h=e("./sort_modules").sortBasePlotModules;var v=e("./animation_attributes");var d=e("./frame_attributes");var p=l.relinkPrivateKeys;var g=l._;var m=t.exports={};l.extendFlat(m,a);m.attributes=e("./attributes");m.attributes.type.values=m.allTypes;m.fontAttrs=e("./font_attributes");m.layoutAttributes=e("./layout_attributes");m.fontWeight="normal";var y=m.transformsRegistry;var b=e("./command");m.executeAPICommand=b.executeAPICommand;m.computeAPICommandBindings=b.computeAPICommandBindings;m.manageCommandObserver=b.manageCommandObserver;m.hasSimpleAPICommandBindings=b.hasSimpleAPICommandBindings;m.redrawText=function(e){e=l.getGraphDiv(e);if(e.data&&e.data[0]&&e.data[0].r)return;return new Promise(function(t){setTimeout(function(){a.getComponentMethod("annotations","draw")(e);a.getComponentMethod("legend","draw")(e);(e.calcdata||[]).forEach(function(e){if(e[0]&&e[0].t&&e[0].t.cb)e[0].t.cb()});t(m.previousPromises(e))},300)})};m.resize=function(e){e=l.getGraphDiv(e);return new Promise(function(t,r){function n(e){var t=window.getComputedStyle(e).display;return!t||t==="none"}if(!e||n(e)){r(new Error("Resize must be passed a displayed plot div element."))}if(e._redrawTimer)clearTimeout(e._redrawTimer);e._redrawTimer=setTimeout(function(){if(!e.layout||e.layout.width&&e.layout.height||n(e)){t(e);return}delete e.layout.width;delete e.layout.height;var r=e.changed;e.autoplay=true;a.call("relayout",e,{autosize:true}).then(function(){e.changed=r;t(e)})},100)})};m.previousPromises=function(e){if((e._promises||[]).length){return Promise.all(e._promises).then(function(){e._promises=[]})}};m.addLinks=function(e){if(!e._context.showLink&&!e._context.showSources)return;var t=e._fullLayout;var r=l.ensureSingle(t._paper,"text","js-plot-link-container",function(e){e.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:u.defaultLine,"pointer-events":"all"}).each(function(){var e=n.select(this);e.append("tspan").classed("js-link-to-tool",true);e.append("tspan").classed("js-link-spacer",true);e.append("tspan").classed("js-sourcelinks",true)})});var i=r.node();var a={y:t._paper.attr("height")-9};if(document.body.contains(i)&&i.getComputedTextLength()>=t.width-20){a["text-anchor"]="start";a.x=5}else{a["text-anchor"]="end";a.x=t._paper.attr("width")-7}r.attr(a);var o=r.select(".js-link-to-tool"),s=r.select(".js-link-spacer"),f=r.select(".js-sourcelinks");if(e._context.showSources)e._context.showSources(e);if(e._context.showLink)x(e,o);s.text(o.text()&&f.text()?" - ":"")};function x(e,t){t.text("");var r=t.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(e._context.linkText+" "+String.fromCharCode(187));if(e._context.sendData){r.on("click",function(){m.sendDataToCloud(e)})}else{var n=window.location.pathname.split("/");var i=window.location.search;r.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+n[2].split(".")[0]+"/"+n[1]+i})}}m.sendDataToCloud=function(e){e.emit("plotly_beforeexport");var t=(window.PLOTLYENV||{}).BASE_URL||e._context.plotlyServerURL;var r=n.select(e).append("div").attr("id","hiddenform").style("display","none");var i=r.append("form").attr({action:t+"/external",method:"post",target:"_blank"});var a=i.append("input").attr({type:"text",name:"data"});a.node().value=m.graphJson(e,false,"keepdata");i.node().submit();r.remove();e.emit("plotly_afterexport");return false};var _=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"];var w=["year","month","dayMonth","dayMonthYear"];m.supplyDefaults=function(e,t){var r=t&&t.skipUpdateCalc;var n=e._fullLayout||{};if(n._skipDefaults){delete n._skipDefaults;return}var i=e._fullLayout={};var o=e.layout||{};var s=e._fullData||[];var u=e._fullData=[];var f=e.data||[];var v=e.calcdata||[];var d=e._context||{};var y;if(!e._transitionData)m.createTransitionData(e);i._dfltTitle={plot:g(e,"Click to enter Plot title"),x:g(e,"Click to enter X axis title"),y:g(e,"Click to enter Y axis title"),colorbar:g(e,"Click to enter Colorscale title"),annotation:g(e,"new text")};i._traceWord=g(e,"trace");var b=k(e,_);i._mapboxAccessToken=d.mapboxAccessToken;if(n._initialAutoSizeIsDone){var x=n.width,A=n.height;m.supplyLayoutGlobalDefaults(o,i,b);if(!o.width)i.width=x;if(!o.height)i.height=A;m.sanitizeMargins(i)}else{m.supplyLayoutGlobalDefaults(o,i,b);var S=!o.width||!o.height,L=i.autosize,C=d.autosizable,I=S&&(L||C);if(I)m.plotAutoSize(e,o,i);else if(S)m.sanitizeMargins(i);if(!L&&S){o.width=i.width;o.height=i.height}}i._d3locale=E(b,i.separators);i._extraFormat=k(e,w);i._initialAutoSizeIsDone=true;i._dataLength=f.length;i._modules=[];i._basePlotModules=[];var P=i._subplots=T();var O=i._splomAxes={x:{},y:{}};var R=i._splomSubplots={};i._splomGridDflt={};i._requestRangeslider={};i._traceUids=M(s,f);i._globalTransforms=(e._context||{}).globalTransforms;m.supplyDataDefaults(f,u,o,i);var N=Object.keys(O.x);var z=Object.keys(O.y);if(N.length>1&&z.length>1){a.getComponentMethod("grid","sizeDefaults")(o,i);for(y=0;y<N.length;y++){l.pushUnique(P.xaxis,N[y])}for(y=0;y<z.length;y++){l.pushUnique(P.yaxis,z[y])}for(var D in R){l.pushUnique(P.cartesian,D)}}i._has=m._hasPlotType.bind(i);var F=i._modules;for(y=0;y<F.length;y++){var j=F[y];if(j.cleanData)j.cleanData(u)}if(s.length===u.length){for(y=0;y<u.length;y++){p(u[y],s[y])}}m.supplyLayoutModuleDefaults(o,i,u,e._transitionData);i._hasOnlyLargeSploms=i._basePlotModules.length===1&&i._basePlotModules[0].name==="splom"&&N.length>15&&z.length>15&&i.shapes.length===0&&i.images.length===0;i._hasCartesian=i._has("cartesian");i._hasGeo=i._has("geo");i._hasGL3D=i._has("gl3d");i._hasGL2D=i._has("gl2d");i._hasTernary=i._has("ternary");i._hasPie=i._has("pie");m.linkSubplots(u,i,s,n);m.cleanPlot(u,i,s,n,v);p(i,n);m.doAutoMargin(e);var B=c.list(e);for(y=0;y<B.length;y++){var U=B[y];U.setScale()}if(!r&&v.length===u.length){m.supplyDefaultsUpdateCalc(v,u)}i._basePlotModules.sort(h)};m.supplyDefaultsUpdateCalc=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];var i=e[r][0];if(i&&i.trace){var a=i.trace;if(a._hasCalcTransform){var o=a._arrayAttrs;var s,u,f;for(s=0;s<o.length;s++){u=o[s];f=l.nestedProperty(a,u).get().slice();l.nestedProperty(n,u).set(f)}}i.trace=n}}};function M(e,t){var r=t.length;var n=[];var i,a;for(i=0;i<e.length;i++){var o=e[i]._fullInput;if(o!==a)n.push(o);a=o}var s=n.length;var u=new Array(r);var f={};function c(e,t){u[t]=e;f[e]=1}function h(e,t){if(e&&typeof e==="string"&&!f[e]){c(e,t);return true}}for(i=0;i<r;i++){if(h(t[i].uid,i))continue;if(i<s&&h(n[i].uid,i))continue;c(l.randstr(f),i)}return u}var A;function T(){var e={};var t,r;if(!A){A=[];var n=a.subplotsRegistry;for(var i in n){var o=n[i];var s=o.attr;if(s){A.push(i);if(Array.isArray(s)){for(r=0;r<s.length;r++){l.pushUnique(A,s[r])}}}}}for(t=0;t<A.length;t++){e[A[t]]=[]}return e}function k(e,t){var r=e._context.locale;if(!r)r==="en-US";var n=false;var i={};function o(e){var r=true;for(var a=0;a<t.length;a++){var o=t[a];if(!i[o]){if(e[o]){i[o]=e[o]}else r=false}}if(r)n=true}for(var s=0;s<2;s++){var l=e._context.locales;for(var u=0;u<2;u++){var f=(l[r]||{}).format;if(f){o(f);if(n)break}l=a.localeRegistry}var c=r.split("-")[0];if(n||c===r)break;r=c}if(!n)o(a.localeRegistry.en.format);return i}function E(e,t){e.decimal=t.charAt(0);e.thousands=t.charAt(1);return n.locale(e)}m.createTransitionData=function(e){if(!e._transitionData){e._transitionData={}}if(!e._transitionData._frames){e._transitionData._frames=[]}if(!e._transitionData._frameHash){e._transitionData._frameHash={}}if(!e._transitionData._counter){e._transitionData._counter=0}if(!e._transitionData._interruptCallbacks){e._transitionData._interruptCallbacks=[]}};m._hasPlotType=function(e){var t;var r=this._basePlotModules||[];for(t=0;t<r.length;t++){if(r[t].name===e)return true}var n=this._modules||[];for(t=0;t<n.length;t++){var i=n[t].name;if(i===e)return true;var o=a.modules[i];if(o&&o.categories[e])return true}return false};m.cleanPlot=function(e,t,r,n,i){var a,o;var s=n._basePlotModules||[];for(a=0;a<s.length;a++){var l=s[a];if(l.clean){l.clean(e,t,r,n,i)}}var u=n._has&&n._has("gl");var f=t._has&&t._has("gl");if(u&&!f){if(n._glcontainer!==undefined){n._glcontainer.selectAll(".gl-canvas").remove();n._glcontainer.selectAll(".no-webgl").remove();n._glcanvas=null}}var c=!!n._infolayer;e:for(a=0;a<r.length;a++){var h=r[a],v=h.uid;for(o=0;o<e.length;o++){var d=e[o];if(v===d.uid)continue e}if(c){n._infolayer.select(".cb"+v).remove()}}if(n._zoomlayer){n._zoomlayer.selectAll(".select-outline").remove()}};m.linkSubplots=function(e,t,r,n){var i=n._plots||{};var a=t._plots={};var o=t._subplots;var s={_fullData:e,_fullLayout:t};var l=o.cartesian.concat(o.gl2d||[]);var u,f,h,v;for(u=0;u<l.length;u++){h=l[u];var d=i[h];var p=c.getFromId(s,h,"x");var g=c.getFromId(s,h,"y");var m;if(d){m=a[h]=d;if(m.xaxis.layer!==p.layer){m.xlines.attr("d",null);m.xaxislayer.selectAll("*").remove()}if(m.yaxis.layer!==g.layer){m.ylines.attr("d",null);m.yaxislayer.selectAll("*").remove()}}else{m=a[h]={};m.id=h}m.xaxis=p;m.yaxis=g;m._hasClipOnAxisFalse=false;for(f=0;f<e.length;f++){var y=e[f];if(y.xaxis===m.xaxis._id&&y.yaxis===m.yaxis._id&&y.cliponaxis===false){m._hasClipOnAxisFalse=true;break}}}var b=c.list(s,null,true);for(u=0;u<b.length;u++){v=b[u];var x=null;if(v.overlaying){x=c.getFromId(s,v.overlaying);if(x&&x.overlaying){v.overlaying=false;x=null}}v._mainAxis=x||v;if(x)v.domain=x.domain.slice();v._anchorAxis=v.anchor==="free"?null:c.getFromId(s,v.anchor)}};m.clearExpandedTraceDefaultColors=function(e){var t,r,n;function i(e,n,i,a){r[a]=n;r.length=a+1;if(e.valType==="color"&&e.dflt===undefined){t.push(r.join("."))}}r=[];t=e._module._colorAttrs;if(!t){e._module._colorAttrs=t=[];o.crawl(e._module.attributes,i)}for(n=0;n<t.length;n++){var a=l.nestedProperty(e,"_input."+t[n]);if(!a.get()){l.nestedProperty(e,t[n]).set(null)}}};m.supplyDataDefaults=function(e,t,r,n){var i=n._modules;var o=n._basePlotModules;var u=0;var f=0;var c,h,v;n._transformModules=[];function d(e){t.push(e);var r=e._module;if(!r)return;if(e.visible===true)l.pushUnique(i,r);l.pushUnique(o,e._module.basePlotModule);u++;if(e._input.visible!==false)f++}var g={};var y=[];var b=(r.template||{}).data||{};var x=s.traceTemplater(b);for(c=0;c<e.length;c++){v=e[c];h=x.newTrace(v);h.uid=n._traceUids[c];m.supplyTraceDefaults(v,h,f,n,c);h.uid=n._traceUids[c];h.index=c;h._input=v;h._expandedIndex=u;if(h.transforms&&h.transforms.length){var _=L(h,t,r,n);for(var w=0;w<_.length;w++){var M=_[w];var A={_template:h._template,type:h.type,uid:h.uid+w};m.supplyTraceDefaults(M,A,u,n,c);p(A,M);A.index=c;A._input=v;A._fullInput=h;A._expandedIndex=u;A._expandedInput=M;d(A)}}else{h._fullInput=h;h._expandedInput=h;d(h)}if(a.traceIs(h,"carpetAxis")){g[h.carpet]=h}if(a.traceIs(h,"carpetDependent")){y.push(c)}}for(c=0;c<y.length;c++){h=t[y[c]];if(!h.visible)continue;var T=g[h.carpet];h._carpet=T;if(!T||!T.visible){h.visible=false;continue}h.xaxis=T.xaxis;h.yaxis=T.yaxis}};m.supplyAnimationDefaults=function(e){e=e||{};var t;var r={};function n(t,n){return l.coerce(e||{},r,v,t,n)}n("mode");n("direction");n("fromcurrent");if(Array.isArray(e.frame)){r.frame=[];for(t=0;t<e.frame.length;t++){r.frame[t]=m.supplyAnimationFrameDefaults(e.frame[t]||{})}}else{r.frame=m.supplyAnimationFrameDefaults(e.frame||{})}if(Array.isArray(e.transition)){r.transition=[];for(t=0;t<e.transition.length;t++){r.transition[t]=m.supplyAnimationTransitionDefaults(e.transition[t]||{})}}else{r.transition=m.supplyAnimationTransitionDefaults(e.transition||{})}return r};m.supplyAnimationFrameDefaults=function(e){var t={};function r(r,n){return l.coerce(e||{},t,v.frame,r,n)}r("duration");r("redraw");return t};m.supplyAnimationTransitionDefaults=function(e){var t={};function r(r,n){return l.coerce(e||{},t,v.transition,r,n)}r("duration");r("easing");return t};m.supplyFrameDefaults=function(e){var t={};function r(r,n){return l.coerce(e,t,d,r,n)}r("group");r("name");r("traces");r("baseframe");r("data");r("layout");return t};m.supplyTraceDefaults=function(e,t,r,n,i){var o=n.colorway||u.defaults;var s=o[r%o.length];var f;function c(r,n){return l.coerce(e,t,m.attributes,r,n)}var h=c("visible");c("type");c("name",n._traceWord+" "+i);var v=m.getModule(t);t._module=v;if(v){var d=v.basePlotModule;var p=d.attr;var g=d.attributes;if(p&&g){var y=n._subplots;var b="";if(d.name!=="gl2d"||h){if(Array.isArray(p)){for(f=0;f<p.length;f++){var x=p[f];var _=l.coerce(e,t,g,x);if(y[x])l.pushUnique(y[x],_);b+=_}}else{b=l.coerce(e,t,g,p)}if(y[d.name]){l.pushUnique(y[d.name],b)}}}}if(h){c("customdata");c("ids");if(a.traceIs(t,"showLegend")){c("showlegend");c("legendgroup")}a.getComponentMethod("fx","supplyDefaults")(e,t,s,n);if(v){v.supplyDefaults(e,t,s,n);l.coerceHoverinfo(e,t,n)}if(!a.traceIs(t,"noOpacity"))c("opacity");if(a.traceIs(t,"notLegendIsolatable")){t.visible=!!t.visible}if(v&&v.selectPoints){c("selectedpoints")}m.supplyTransformDefaults(e,t,n)}return t};function S(e){var t=e.transforms;if(Array.isArray(t)&&t.length){for(var r=0;r<t.length;r++){var n=y[t[r].type];if(n&&n.makesData)return true}}return false}m.supplyTransformDefaults=function(e,t,r){if(!(t._length||S(e)))return;var n=r._globalTransforms||[];var i=r._transformModules||[];if(!Array.isArray(e.transforms)&&n.length===0)return;var a=e.transforms||[],o=n.concat(a),s=t.transforms=[];for(var u=0;u<o.length;u++){var f=o[u],c=f.type,h=y[c],v;var d=!(f._module&&f._module===h),p=h&&typeof h.transform==="function";if(!h)l.warn("Unrecognized transform type "+c+".");if(h&&h.supplyDefaults&&(d||p)){v=h.supplyDefaults(f,t,r,e);v.type=c;v._module=h;l.pushUnique(i,h)}else{v=l.extendFlat({},f)}s.push(v)}};function L(e,t,r,n){var i=e.transforms,a=[e];for(var o=0;o<i.length;o++){var s=i[o],l=y[s.type];if(l&&l.transform){a=l.transform(a,{transform:s,fullTrace:e,fullData:t,layout:r,fullLayout:n,transformIndex:o})}}return a}m.supplyLayoutGlobalDefaults=function(e,t,r){function n(r,n){return l.coerce(e,t,m.layoutAttributes,r,n)}var i=e.template;if(l.isPlainObject(i)){t.template=i;t._template=i.layout;t._dataTemplate=i.data}var o=l.coerceFont(n,"font");n("title",t._dfltTitle.plot);l.coerceFont(n,"titlefont",{family:o.family,size:Math.round(o.size*1.4),color:o.color});n("autosize",!(e.width&&e.height));n("width");n("height");n("margin.l");n("margin.r");n("margin.t");n("margin.b");n("margin.pad");n("margin.autoexpand");if(e.width&&e.height)m.sanitizeMargins(t);a.getComponentMethod("grid","sizeDefaults")(e,t);n("paper_bgcolor");n("separators",r.decimal+r.thousands);n("hidesources");n("colorway");n("datarevision");a.getComponentMethod("calendars","handleDefaults")(e,t,"calendar");a.getComponentMethod("fx","supplyLayoutGlobalDefaults")(e,t,n)};m.plotAutoSize=function e(t,r,n){var a=t._context||{},o=a.frameMargins,s,u;var f=l.isPlotDiv(t);if(f)t.emit("plotly_autosize");if(a.fillFrame){s=window.innerWidth;u=window.innerHeight;document.body.style.overflow="hidden"}else if(i(o)&&o>0){var c=C(t._boundingBoxMargins),h=c.left+c.right,v=c.bottom+c.top,d=1-2*o;var p=n._container&&n._container.node?n._container.node().getBoundingClientRect():{width:n.width,height:n.height};s=Math.round(d*(p.width-h));u=Math.round(d*(p.height-v))}else{var g=f?window.getComputedStyle(t):{};s=parseFloat(g.width)||n.width;u=parseFloat(g.height)||n.height}var y=m.layoutAttributes.width.min,b=m.layoutAttributes.height.min;if(s<y)s=y;if(u<b)u=b;var x=!r.width&&Math.abs(n.width-s)>1,_=!r.height&&Math.abs(n.height-u)>1;if(_||x){if(x)n.width=s;if(_)n.height=u}if(!t._initialAutoSize){t._initialAutoSize={width:s,height:u}}m.sanitizeMargins(n)};function C(e){var t={left:0,right:0,bottom:0,top:0},r;if(e){for(r in e){if(e.hasOwnProperty(r)){t.left+=e[r].left||0;t.right+=e[r].right||0;t.bottom+=e[r].bottom||0;t.top+=e[r].top||0}}}return t}m.supplyLayoutModuleDefaults=function(e,t,r,n){var i=a.componentsRegistry;var o=t._basePlotModules;var s,u,f;var c=a.subplotsRegistry.cartesian;for(s in i){f=i[s];if(f.includeBasePlot){f.includeBasePlot(e,t)}}if(!o.length){o.push(c)}if(t._has("cartesian")){a.getComponentMethod("grid","contentDefaults")(e,t);c.finalizeSubplots(e,t)}for(var h in t._subplots){t._subplots[h].sort(l.subplotSort)}for(u=0;u<o.length;u++){f=o[u];if(f.supplyLayoutDefaults){f.supplyLayoutDefaults(e,t,r)}}var v=t._modules;for(u=0;u<v.length;u++){f=v[u];if(f.supplyLayoutDefaults){f.supplyLayoutDefaults(e,t,r)}}var d=t._transformModules;for(u=0;u<d.length;u++){f=d[u];if(f.supplyLayoutDefaults){f.supplyLayoutDefaults(e,t,r,n)}}for(s in i){f=i[s];if(f.supplyLayoutDefaults){f.supplyLayoutDefaults(e,t,r)}}};m.purge=function(e){var t=e._fullLayout||{};if(t._glcontainer!==undefined){t._glcontainer.selectAll(".gl-canvas").remove();t._glcontainer.remove();t._glcanvas=null}if(t._geocontainer!==undefined)t._geocontainer.remove();if(t._modeBar)t._modeBar.destroy();if(e._transitionData){if(e._transitionData._interruptCallbacks){e._transitionData._interruptCallbacks.length=0}if(e._transitionData._animationRaf){window.cancelAnimationFrame(e._transitionData._animationRaf)}}l.clearThrottle();delete e.data;delete e.layout;delete e._fullData;delete e._fullLayout;delete e.calcdata;delete e.framework;delete e.empty;delete e.fid;delete e.undoqueue;delete e.undonum;delete e.autoplay;delete e.changed;delete e._promises;delete e._redrawTimer;delete e.firstscatter;delete e._hmlumcount;delete e._hmpixcount;delete e._transitionData;delete e._transitioning;delete e._initialAutoSize;delete e._transitioningWithDuration;delete e._dragging;delete e._dragged;delete e._hoverdata;delete e._snapshotInProgress;delete e._editing;delete e._replotPending;delete e._mouseDownTime;delete e._legendMouseDownTime;if(e.removeAllListeners)e.removeAllListeners()};m.style=function(e){var t=e._fullLayout._modules;var r=[];var n;for(n=0;n<t.length;n++){var i=t[n];if(i.style){l.pushUnique(r,i.style)}}for(n=0;n<r.length;n++){r[n](e)}};m.sanitizeMargins=function(e){if(!e||!e.margin)return;var t=e.width,r=e.height,n=e.margin,i=t-(n.l+n.r),a=r-(n.t+n.b),o;if(i<0){o=(t-1)/(n.l+n.r);n.l=Math.floor(o*n.l);n.r=Math.floor(o*n.r)}if(a<0){o=(r-1)/(n.t+n.b);n.t=Math.floor(o*n.t);n.b=Math.floor(o*n.b)}};m.clearAutoMarginIds=function(e){e._fullLayout._pushmarginIds={}};m.allowAutoMargin=function(e,t){e._fullLayout._pushmarginIds[t]=1};function I(e){if(!e._pushmargin)e._pushmargin={};if(!e._pushmarginIds)e._pushmarginIds={}}m.autoMargin=function(e,t,r){var n=e._fullLayout;I(n);var i=n._pushmargin;var a=n._pushmarginIds;if(n.margin.autoexpand!==false){if(!r){delete i[t];delete a[t]}else{var o=r.pad;if(o===undefined){var s=n.margin;o=Math.min(12,s.l,s.r,s.t,s.b)}if(r.l+r.r>n.width*.5)r.l=r.r=0;if(r.b+r.t>n.height*.5)r.b=r.t=0;var l=r.xl!==undefined?r.xl:r.x;var u=r.xr!==undefined?r.xr:r.x;var f=r.yt!==undefined?r.yt:r.y;var c=r.yb!==undefined?r.yb:r.y;i[t]={l:{val:l,size:r.l+o},r:{val:u,size:r.r+o},b:{val:c,size:r.b+o},t:{val:f,size:r.t+o}};a[t]=1}if(!n._replotting)m.doAutoMargin(e)}};m.doAutoMargin=function(e){var t=e._fullLayout;if(!t._size)t._size={};I(t);var r=t._size,n=JSON.stringify(r);var o=Math.max(t.margin.l||0,0);var s=Math.max(t.margin.r||0,0);var l=Math.max(t.margin.t||0,0);var u=Math.max(t.margin.b||0,0);var f=t._pushmargin;var c=t._pushmarginIds;if(t.margin.autoexpand!==false){for(var h in f){if(!c[h])delete f[h]}f.base={l:{val:0,size:o},r:{val:1,size:s},t:{val:1,size:l},b:{val:0,size:u}};for(var v in f){var d=f[v].l||{},p=f[v].b||{},g=d.val,m=d.size,y=p.val,b=p.size;for(var x in f){if(i(m)&&f[x].r){var _=f[x].r.val,w=f[x].r.size;if(_>g){var M=(m*_+(w-t.width)*g)/(_-g),A=(w*(1-g)+(m-t.width)*(1-_))/(_-g);if(M>=0&&A>=0&&M+A>o+s){o=M;s=A}}}if(i(b)&&f[x].t){var T=f[x].t.val,k=f[x].t.size;if(T>y){var E=(b*T+(k-t.height)*y)/(T-y),S=(k*(1-y)+(b-t.height)*(1-T))/(T-y);if(E>=0&&S>=0&&E+S>u+l){u=E;l=S}}}}}}r.l=Math.round(o);r.r=Math.round(s);r.t=Math.round(l);r.b=Math.round(u);r.p=Math.round(t.margin.pad);r.w=Math.round(t.width)-r.l-r.r;r.h=Math.round(t.height)-r.t-r.b;if(!t._replotting&&n!=="{}"&&n!==JSON.stringify(t._size)){if("_redrawFromAutoMarginCount"in t){t._redrawFromAutoMarginCount++}else{t._redrawFromAutoMarginCount=1}return a.call("plot",e)}};m.graphJson=function(e,t,r,n,i){if(i&&t&&!e._fullData||i&&!t&&!e._fullLayout){m.supplyDefaults(e)}var a=i?e._fullData:e.data,o=i?e._fullLayout:e.layout,s=(e._transitionData||{})._frames;function u(e){if(typeof e==="function"){return null}if(l.isPlainObject(e)){var t={},n,i;for(n in e){if(typeof e[n]==="function"||["_","["].indexOf(n.charAt(0))!==-1){continue}if(r==="keepdata"){if(n.substr(n.length-3)==="src"){continue}}else if(r==="keepstream"){i=e[n+"src"];if(typeof i==="string"&&i.indexOf(":")>0){if(!l.isPlainObject(e.stream)){continue}}}else if(r!=="keepall"){i=e[n+"src"];if(typeof i==="string"&&i.indexOf(":")>0){continue}}t[n]=u(e[n])}return t}if(Array.isArray(e)){return e.map(u)}if(l.isJSDate(e))return l.ms2DateTimeLocal(+e);return e}var f={data:(a||[]).map(function(e){var r=u(e);if(t){delete r.fit}return r})};if(!t){f.layout=u(o)}if(e.framework&&e.framework.isPolar)f=e.framework.getConfig();if(s)f.frames=u(s);return n==="object"?f:JSON.stringify(f)};m.modifyFrames=function(e,t){var r,n,i;var a=e._transitionData._frames;var o=e._transitionData._frameHash;for(r=0;r<t.length;r++){n=t[r];switch(n.type){case"replace":i=n.value;var s=(a[n.index]||{}).name;var l=i.name;a[n.index]=o[l]=i;if(l!==s){delete o[s];o[l]=i}break;case"insert":i=n.value;o[i.name]=i;a.splice(n.index,0,i);break;case"delete":i=a[n.index];delete o[i.name];a.splice(n.index,1);break}}return Promise.resolve()};m.computeFrame=function(e,t){var r=e._transitionData._frameHash;var n,i,a,o;if(!t){throw new Error("computeFrame must be given a string frame name")}var s=r[t.toString()];if(!s){return false}var l=[s];var u=[s.name];while(s.baseframe&&(s=r[s.baseframe.toString()])){if(u.indexOf(s.name)!==-1)break;l.push(s);u.push(s.name)}var f={};while(s=l.pop()){if(s.layout){f.layout=m.extendLayout(f.layout,s.layout)}if(s.data){if(!f.data){f.data=[]}i=s.traces;if(!i){i=[];for(n=0;n<s.data.length;n++){i[n]=n}}if(!f.traces){f.traces=[]}for(n=0;n<s.data.length;n++){a=i[n];if(a===undefined||a===null){continue}o=f.traces.indexOf(a);if(o===-1){o=f.data.length;f.traces[o]=a}f.data[o]=m.extendTrace(f.data[o],s.data[n])}}}return f};m.recomputeFrameHash=function(e){var t=e._transitionData._frameHash={};var r=e._transitionData._frames;for(var n=0;n<r.length;n++){var i=r[n];if(i&&i.name){t[i.name]=i}}};m.extendObjectWithContainers=function(e,t,r){var n,i,a,o,s,u,f,c;var h=l.extendDeepNoArrays({},t||{});var v=l.expandObjectPaths(h);var d={};if(r&&r.length){for(a=0;a<r.length;a++){n=l.nestedProperty(v,r[a]);i=n.get();if(i===undefined){l.nestedProperty(d,r[a]).set(null)}else{n.set(null);l.nestedProperty(d,r[a]).set(i)}}}e=l.extendDeepNoArrays(e||{},v);if(r&&r.length){for(a=0;a<r.length;a++){s=l.nestedProperty(d,r[a]);f=s.get();if(!f)continue;u=l.nestedProperty(e,r[a]);c=u.get();if(!Array.isArray(c)){c=[];u.set(c)}for(o=0;o<f.length;o++){var p=f[o];if(p===null)c[o]=null;else{c[o]=m.extendObjectWithContainers(c[o],p)}}u.set(c)}}return e};m.dataArrayContainers=["transforms","dimensions"];m.layoutArrayContainers=a.layoutArrayContainers;m.extendTrace=function(e,t){return m.extendObjectWithContainers(e,t,m.dataArrayContainers)};m.extendLayout=function(e,t){return m.extendObjectWithContainers(e,t,m.layoutArrayContainers)};m.transition=function(e,t,r,n,i,o){var s,u;var f=Array.isArray(t)?t.length:0;var c=n.slice(0,f);var h=[];function v(){var n;for(n=0;n<c.length;n++){var i=c[n];var o=e._fullData[i];var s=o._module;if(!s)continue;if(s.animatable){h.push(i)}e.data[c[n]]=m.extendTrace(e.data[c[n]],t[n])}var u=l.expandObjectPaths(l.extendDeepNoArrays({},r));var f=/^[xy]axis[0-9]*$/;for(var v in u){if(!f.test(v))continue;delete u[v].range}m.extendLayout(e.layout,u);delete e.calcdata;m.supplyDefaults(e);m.doCalcdata(e);a.getComponentMethod("errorbars","calc")(e);return Promise.resolve()}function d(e){var t=Promise.resolve();if(!e)return t;while(e.length){t=t.then(e.shift())}return t}function p(e){if(!e)return;while(e.length){e.shift()}}var g=false;function y(){e.emit("plotly_transitioning",[]);return new Promise(function(t){e._transitioning=true;if(o.duration>0){e._transitioningWithDuration=true}e._transitionData._interruptCallbacks.push(function(){g=true});if(i.redraw){e._transitionData._interruptCallbacks.push(function(){return a.call("redraw",e)})}e._transitionData._interruptCallbacks.push(function(){e.emit("plotly_transitioninterrupted",[])});var n=0;var s=0;function u(){n++;return function(){s++;if(!g&&s===n){b(t)}}}var f;var c;var v=e._fullLayout._basePlotModules;var d=false;if(r){for(c=0;c<v.length;c++){if(v[c].transitionAxes){var p=l.expandObjectPaths(r);d=v[c].transitionAxes(e,p,o,u)||d}}}if(d){f=l.extendFlat({},o);f.duration=0}else{f=o}for(c=0;c<v.length;c++){v[c].plot(e,h,f,u)}setTimeout(u())})}function b(t){if(!e._transitionData)return;p(e._transitionData._interruptCallbacks);return Promise.resolve().then(function(){if(i.redraw){return a.call("redraw",e)}}).then(function(){e._transitioning=false;e._transitioningWithDuration=false;e.emit("plotly_transitioned",[])}).then(t)}function x(){if(!e._transitionData)return;e._transitioning=false;return d(e._transitionData._interruptCallbacks)}for(s=0;s<c.length;s++){u=c[s];var _=e._fullData[u];var w=_._module;if(!w)continue}var M=[m.previousPromises,x,v,m.rehover,y];var A=l.syncOrAsync(M,e);if(!A||!A.then){A=Promise.resolve()}return A.then(function(){return e})};m.doCalcdata=function(e,t){var r=c.list(e),n=e._fullData,i=e._fullLayout;var s,l,u,h;var v=new Array(n.length);var d=(e.calcdata||[]).slice(0);e.calcdata=v;e.firstscatter=true;i._numBoxes=0;i._numViolins=0;i._violinScaleGroupStats={};e._hmpixcount=0;e._hmlumcount=0;i._piecolormap={};i._piecolorway=null;i._piedefaultcolorcount=0;for(u=0;u<n.length;u++){if(Array.isArray(t)&&t.indexOf(u)===-1){v[u]=d[u];continue}}for(u=0;u<n.length;u++){s=n[u];s._arrayAttrs=o.findArrayAttributes(s)}var p=i._subplots.polar||[];for(u=0;u<p.length;u++){r.push(i[p[u]].radialaxis,i[p[u]].angularaxis)}P(r);var g=false;for(u=0;u<n.length;u++){s=n[u];if(s.visible===true&&s.transforms){l=s._module;if(l&&l.calc){var m=l.calc(e,s);if(m[0]&&m[0].t&&m[0].t._scene){delete m[0].t._scene.dirty}}for(h=0;h<s.transforms.length;h++){var b=s.transforms[h];l=y[b.type];if(l&&l.calcTransform){s._hasCalcTransform=true;g=true;l.calcTransform(e,s,b)}}}}if(g)P(r);function x(t,r){s=n[t];l=s._module;if(!!l.isContainer!==r)return;var i=[];if(s.visible===true){var a=s.transforms||[];for(h=a.length-1;h>=0;h--){if(a[h].enabled){s._indexToPoints=a[h]._indexToPoints;break}}if(l&&l.calc){i=l.calc(e,s)}}if(!Array.isArray(i)||!i[0]){i=[{x:f,y:f}]}if(!i[0].t)i[0].t={};i[0].trace=s;v[t]=i}for(u=0;u<n.length;u++)x(u,true);for(u=0;u<n.length;u++)x(u,false);a.getComponentMethod("fx","calc")(e)};function P(e){for(var t=0;t<e.length;t++){e[t].clearCalc()}}m.rehover=function(e){if(e._fullLayout._rehover){e._fullLayout._rehover()}};m.generalUpdatePerTraceModule=function(e,t,r,n){var i=t.traceHash;var a={};var o;for(o=0;o<r.length;o++){var s=r[o],u=s[0].trace;if(u.visible){a[u.type]=a[u.type]||[];a[u.type].push(s)}}for(var f in i){if(!a[f]){var c=i[f][0],h=c[0].trace;h.visible=false;a[f]=[c]}}for(var v in a){var d=a[v];var p=d[0][0].trace._module;p.plot(e,t,l.filterVisible(d),n)}t.traceHash=a}},{"../components/color":361,"../constants/numerical":463,"../lib":483,"../plot_api/plot_schema":518,"../plot_api/plot_template":519,"../plots/cartesian/axis_ids":532,"../registry":582,"./animation_attributes":524,"./attributes":526,"./command":553,"./font_attributes":555,"./frame_attributes":556,"./layout_attributes":571,"./sort_modules":580,d3:81,"fast-isnumeric":91}],574:[function(e,t,r){"use strict";var n=e("../../../traces/scatter/attributes");var i=n.marker;t.exports={r:n.r,t:n.t,marker:{color:i.color,size:i.size,symbol:i.symbol,opacity:i.opacity,editType:"calc"}}},{"../../../traces/scatter/attributes":604}],575:[function(e,t,r){"use strict";var n=e("../../cartesian/layout_attributes");var i=e("../../../lib/extend").extendFlat;var a=e("../../../plot_api/edit_types").overrideAll;var o=i({},n.domain,{});function s(e,t){var r={showline:{valType:"boolean"},showticklabels:{valType:"boolean"},tickorientation:{valType:"enumerated",values:["horizontal","vertical"]},ticklen:{valType:"number",min:0},tickcolor:{valType:"color"},ticksuffix:{valType:"string"},endpadding:{valType:"number"},visible:{valType:"boolean"}};return i({},t,r)}t.exports=a({radialaxis:s("radial",{range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},domain:o,orientation:{valType:"number"}}),angularaxis:s("angular",{range:{valType:"info_array",items:[{valType:"number",dflt:0},{valType:"number",dflt:360}]},domain:o}),layout:{direction:{valType:"enumerated",values:["clockwise","counterclockwise"]},orientation:{valType:"angle"}}},"plot","nested")},{"../../../lib/extend":475,"../../../plot_api/edit_types":512,"../../cartesian/layout_attributes":541}],576:[function(e,t,r){"use strict";var n=t.exports=e("./micropolar");n.manager=e("./micropolar_manager")},{"./micropolar":577,"./micropolar_manager":578}],577:[function(e,t,r){var n=e("d3");var i=e("../../../lib");var a=i.extendDeepAll;var o=e("../../../constants/alignment").MID_SHIFT;var s=t.exports={version:"0.2.2"};s.Axis=function e(){var t={data:[],layout:{}},r={},i={};var l,u,f=n.dispatch("hover"),c,h;var v={};function d(e){u=e||u;var r=t.data;var f=t.layout;if(typeof u=="string"||u.nodeName)u=n.select(u);u.datum(r).each(function(e,t){var r=e.slice();i={data:s.util.cloneJson(r),layout:s.util.cloneJson(f)};var u=0;r.forEach(function(e,t){if(!e.color){e.color=f.defaultColorRange[u];u=(u+1)%f.defaultColorRange.length}if(!e.strokeColor){e.strokeColor=e.geometry==="LinePlot"?e.color:n.rgb(e.color).darker().toString()}i.data[t].color=e.color;i.data[t].strokeColor=e.strokeColor;i.data[t].strokeDash=e.strokeDash;i.data[t].strokeSize=e.strokeSize});var v=r.filter(function(e,t){var r=e.visible;return typeof r==="undefined"||r===true});var d=false;var p=v.map(function(e,t){d=d||typeof e.groupId!=="undefined";return e});if(d){var g=n.nest().key(function(e,t){return typeof e.groupId!="undefined"?e.groupId:"unstacked"}).entries(p);var m=[];var y=g.map(function(e,t){if(e.key==="unstacked")return e.values;else{var r=e.values[0].r.map(function(e,t){return 0});e.values.forEach(function(e,t,n){e.yStack=[r];m.push(r);r=s.util.sumArrays(e.r,r)});return e.values}});v=n.merge(y)}v.forEach(function(e,t){e.t=Array.isArray(e.t[0])?e.t:[e.t];e.r=Array.isArray(e.r[0])?e.r:[e.r]});var b=Math.min(f.width-f.margin.left-f.margin.right,f.height-f.margin.top-f.margin.bottom)/2;b=Math.max(10,b);var x=[f.margin.left+b,f.margin.top+b];var _;if(d){var w=n.max(s.util.sumArrays(s.util.arrayLast(v).r[0],s.util.arrayLast(m)));_=[0,w]}else _=n.extent(s.util.flattenArray(v.map(function(e,t){return e.r})));if(f.radialAxis.domain!=s.DATAEXTENT)_[0]=0;c=n.scale.linear().domain(f.radialAxis.domain!=s.DATAEXTENT&&f.radialAxis.domain?f.radialAxis.domain:_).range([0,b]);i.layout.radialAxis.domain=c.domain();var M=s.util.flattenArray(v.map(function(e,t){return e.t}));var A=typeof M[0]==="string";var T;if(A){M=s.util.deduplicate(M);T=M.slice();M=n.range(M.length);v=v.map(function(e,t){var r=e;e.t=[M];if(d)r.yStack=e.yStack;return r})}var k=v.filter(function(e,t){return e.geometry==="LinePlot"||e.geometry==="DotPlot"}).length===v.length;var E=f.needsEndSpacing===null?A||!k:f.needsEndSpacing;var S=f.angularAxis.domain&&f.angularAxis.domain!=s.DATAEXTENT&&!A&&f.angularAxis.domain[0]>=0;var L=S?f.angularAxis.domain:n.extent(M);var C=Math.abs(M[1]-M[0]);if(k&&!A)C=0;var I=L.slice();if(E&&A)I[1]+=C;var P=f.angularAxis.ticksCount||4;if(P>8)P=P/(P/8)+P%8;if(f.angularAxis.ticksStep){P=(I[1]-I[0])/P}var O=f.angularAxis.ticksStep||(I[1]-I[0])/(P*(f.minorTicks+1));if(T)O=Math.max(Math.round(O),1);if(!I[2])I[2]=O;var R=n.range.apply(this,I);R=R.map(function(e,t){return parseFloat(e.toPrecision(12))});h=n.scale.linear().domain(I.slice(0,2)).range(f.direction==="clockwise"?[0,360]:[360,0]);i.layout.angularAxis.domain=h.domain();i.layout.angularAxis.endPadding=E?C:0;l=n.select(this).select("svg.chart-root");if(typeof l==="undefined"||l.empty()){var N="<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>";var z=(new DOMParser).parseFromString(N,"application/xml");var D=this.appendChild(this.ownerDocument.importNode(z.documentElement,true));l=n.select(D)}l.select(".guides-group").style({"pointer-events":"none"});l.select(".angular.axis-group").style({"pointer-events":"none"});l.select(".radial.axis-group").style({"pointer-events":"none"});var F=l.select(".chart-group");var j={fill:"none",stroke:f.tickColor};var B={"font-size":f.font.size,"font-family":f.font.family,fill:f.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(e,t){return" "+e+" 0 "+f.font.outlineColor}).join(",")};var U;if(f.showLegend){U=l.select(".legend-group").attr({transform:"translate("+[b,f.margin.top]+")"}).style({display:"block"});var V=v.map(function(e,t){var r=s.util.cloneJson(e);r.symbol=e.geometry==="DotPlot"?e.dotType||"circle":e.geometry!="LinePlot"?"square":"line";r.visibleInLegend=typeof e.visibleInLegend==="undefined"||e.visibleInLegend;r.color=e.geometry==="LinePlot"?e.strokeColor:e.color;return r});s.Legend().config({data:v.map(function(e,t){return e.name||"Element"+t}),legendConfig:a({},s.Legend.defaultConfig().legendConfig,{container:U,elements:V,reverseOrder:f.legend.reverseOrder})})();var H=U.node().getBBox();b=Math.min(f.width-H.width-f.margin.left-f.margin.right,f.height-f.margin.top-f.margin.bottom)/2;b=Math.max(10,b);x=[f.margin.left+b,f.margin.top+b];c.range([0,b]);i.layout.radialAxis.domain=c.domain();U.attr("transform","translate("+[x[0]+b,x[1]-b]+")")}else{U=l.select(".legend-group").style({display:"none"})}l.attr({width:f.width,height:f.height}).style({opacity:f.opacity});F.attr("transform","translate("+x+")").style({cursor:"crosshair"});var q=[(f.width-(f.margin.left+f.margin.right+b*2+(H?H.width:0)))/2,(f.height-(f.margin.top+f.margin.bottom+b*2))/2];q[0]=Math.max(0,q[0]);q[1]=Math.max(0,q[1]);l.select(".outer-group").attr("transform","translate("+q+")");if(f.title){var G=l.select("g.title-group text").style(B).text(f.title);var W=G.node().getBBox();G.attr({x:x[0]-W.width/2,y:x[1]-b-20})}var X=l.select(".radial.axis-group");if(f.radialAxis.gridLinesVisible){var Y=X.selectAll("circle.grid-circle").data(c.ticks(5));Y.enter().append("circle").attr({class:"grid-circle"}).style(j);Y.attr("r",c);Y.exit().remove()}X.select("circle.outside-circle").attr({r:b}).style(j);var Z=l.select("circle.background-circle").attr({r:b}).style({fill:f.backgroundColor,stroke:f.stroke});function Q(e,t){return h(e)%360+f.orientation}if(f.radialAxis.visible){var K=n.svg.axis().scale(c).ticks(5).tickSize(5);X.call(K).attr({transform:"rotate("+f.radialAxis.orientation+")"});X.selectAll(".domain").style(j);X.selectAll("g>text").text(function(e,t){return this.textContent+f.radialAxis.ticksSuffix}).style(B).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(e,t){if(f.radialAxis.tickOrientation==="horizontal"){return"rotate("+-f.radialAxis.orientation+") translate("+[0,B["font-size"]]+")"}else return"translate("+[0,B["font-size"]]+")"}});X.selectAll("g>line").style({stroke:"black"})}var J=l.select(".angular.axis-group").selectAll("g.angular-tick").data(R);var $=J.enter().append("g").classed("angular-tick",true);J.attr({transform:function(e,t){return"rotate("+Q(e,t)+")"}}).style({display:f.angularAxis.visible?"block":"none"});J.exit().remove();$.append("line").classed("grid-line",true).classed("major",function(e,t){return t%(f.minorTicks+1)==0}).classed("minor",function(e,t){return!(t%(f.minorTicks+1)==0)}).style(j);$.selectAll(".minor").style({stroke:f.minorTickColor});J.select("line.grid-line").attr({x1:f.tickLength?b-f.tickLength:0,x2:b}).style({display:f.angularAxis.gridLinesVisible?"block":"none"});$.append("text").classed("axis-text",true).style(B);var ee=J.select("text.axis-text").attr({x:b+f.labelOffset,dy:o+"em",transform:function(e,t){var r=Q(e,t);var n=b+f.labelOffset;var i=f.angularAxis.tickOrientation;if(i=="horizontal")return"rotate("+-r+" "+n+" 0)";else if(i=="radial")return r<270&&r>90?"rotate(180 "+n+" 0)":null;else return"rotate("+(r<=180&&r>0?-90:90)+" "+n+" 0)"}}).style({"text-anchor":"middle",display:f.angularAxis.labelsVisible?"block":"none"}).text(function(e,t){if(t%(f.minorTicks+1)!=0)return"";if(T){return T[e]+f.angularAxis.ticksSuffix}else return e+f.angularAxis.ticksSuffix}).style(B);if(f.angularAxis.rewriteTicks)ee.text(function(e,t){if(t%(f.minorTicks+1)!=0)return"";return f.angularAxis.rewriteTicks(this.textContent,t)});var te=n.max(F.selectAll(".angular-tick text")[0].map(function(e,t){return e.getCTM().e+e.getBBox().width}));U.attr({transform:"translate("+[b+te,f.margin.top]+")"});var re=l.select("g.geometry-group").selectAll("g").size()>0;var ne=l.select("g.geometry-group").selectAll("g.geometry").data(v);ne.enter().append("g").attr({class:function(e,t){return"geometry geometry"+t}});ne.exit().remove();if(v[0]||re){var ie=[];v.forEach(function(e,t){var r={};r.radialScale=c;r.angularScale=h;r.container=ne.filter(function(e,r){return r==t});r.geometry=e.geometry;r.orientation=f.orientation;r.direction=f.direction;r.index=t;ie.push({data:e,geometryConfig:r})});var ae=n.nest().key(function(e,t){return typeof e.data.groupId!="undefined"||"unstacked"}).entries(ie);var oe=[];ae.forEach(function(e,t){if(e.key==="unstacked")oe=oe.concat(e.values.map(function(e,t){return[e]}));else oe.push(e.values)});oe.forEach(function(e,t){var r;if(Array.isArray(e))r=e[0].geometryConfig.geometry;else r=e.geometryConfig.geometry;var n=e.map(function(e,t){return a(s[r].defaultConfig(),e)});s[r]().config(n)()})}var se=l.select(".guides-group");var le=l.select(".tooltips-group");var ue=s.tooltipPanel().config({container:le,fontSize:8})();var fe=s.tooltipPanel().config({container:le,fontSize:8})();var ce=s.tooltipPanel().config({container:le,hasTick:true})();var he,ve;if(!A){var de=se.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});F.on("mousemove.angular-guide",function(e,t){var r=s.util.getMousePos(Z).angle;de.attr({x2:-b,transform:"rotate("+r+")"}).style({opacity:.5});var n=(r+180+360-f.orientation)%360;he=h.invert(n);var i=s.util.convertToCartesian(b+12,r+180);ue.text(s.util.round(he)).move([i[0]+x[0],i[1]+x[1]])}).on("mouseout.angular-guide",function(e,t){se.select("line").style({opacity:0})})}var pe=se.select("circle").style({stroke:"grey",fill:"none"});F.on("mousemove.radial-guide",function(e,t){var r=s.util.getMousePos(Z).radius;pe.attr({r:r}).style({opacity:.5});ve=c.invert(s.util.getMousePos(Z).radius);var n=s.util.convertToCartesian(r,f.radialAxis.orientation);fe.text(s.util.round(ve)).move([n[0]+x[0],n[1]+x[1]])}).on("mouseout.radial-guide",function(e,t){pe.style({opacity:0});ce.hide();ue.hide();fe.hide()});l.selectAll(".geometry-group .mark").on("mouseover.tooltip",function(e,t){var r=n.select(this);var i=this.style.fill;var a="black";var o=this.style.opacity||1;r.attr({"data-opacity":o});if(i&&i!=="none"){r.attr({"data-fill":i});a=n.hsl(i).darker().toString();r.style({fill:a,opacity:1});var u={t:s.util.round(e[0]),r:s.util.round(e[1])};if(A)u.t=T[e[0]];var f="t: "+u.t+", r: "+u.r;var c=this.getBoundingClientRect();var h=l.node().getBoundingClientRect();var v=[c.left+c.width/2-q[0]-h.left,c.top+c.height/2-q[1]-h.top];ce.config({color:a}).text(f);ce.move(v)}else{i=this.style.stroke||"black";r.attr({"data-stroke":i});a=n.hsl(i).darker().toString();r.style({stroke:a,opacity:1})}}).on("mousemove.tooltip",function(e,t){if(n.event.which!=0)return false;if(n.select(this).attr("data-fill"))ce.show()}).on("mouseout.tooltip",function(e,t){ce.hide();var r=n.select(this);var i=r.attr("data-fill");if(i)r.style({fill:i,opacity:r.attr("data-opacity")});else r.style({stroke:r.attr("data-stroke"),opacity:r.attr("data-opacity")})})});return v}v.render=function(e){d(e);return this};v.config=function(e){if(!arguments.length)return t;var r=s.util.cloneJson(e);r.data.forEach(function(e,r){if(!t.data[r])t.data[r]={};a(t.data[r],s.Axis.defaultConfig().data[0]);a(t.data[r],e)});a(t.layout,s.Axis.defaultConfig().layout);a(t.layout,r.layout);return this};v.getLiveConfig=function(){return i};v.getinputConfig=function(){return r};v.radialScale=function(e){return c};v.angularScale=function(e){return h};v.svg=function(){return l};n.rebind(v,f,"on");return v};s.Axis.defaultConfig=function(e,t){var r={data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:true,opacity:1}],layout:{defaultColorRange:n.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:true,gridLinesVisible:true,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:true,gridLinesVisible:true,labelsVisible:true,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:true,legend:{reverseOrder:false},opacity:1}};return r};s.util={};s.DATAEXTENT="dataExtent";s.AREA="AreaChart";s.LINE="LinePlot";s.DOT="DotPlot";s.BAR="BarChart";s.util._override=function(e,t){for(var r in e)if(r in t)t[r]=e[r]};s.util._extend=function(e,t){for(var r in e)t[r]=e[r]};s.util._rndSnd=function(){return Math.random()*2-1+(Math.random()*2-1)+(Math.random()*2-1)};s.util.dataFromEquation2=function(e,t){var r=t||6;var i=n.range(0,360+r,r).map(function(t,r){var n=t*Math.PI/180;var i=e(n);return[t,i]});return i};s.util.dataFromEquation=function(e,t,r){var i=t||6;var a=[],o=[];n.range(0,360+i,i).forEach(function(t,r){var n=t*Math.PI/180;var i=e(n);a.push(t);o.push(i)});var s={t:a,r:o};if(r)s.name=r;return s};s.util.ensureArray=function(e,t){if(typeof e==="undefined")return null;var r=[].concat(e);return n.range(t).map(function(e,t){return r[t]||r[0]})};s.util.fillArrays=function(e,t,r){t.forEach(function(t,n){e[t]=s.util.ensureArray(e[t],r)});return e};s.util.cloneJson=function(e){return JSON.parse(JSON.stringify(e))};s.util.validateKeys=function(e,t){if(typeof t==="string")t=t.split(".");var r=t.shift();return e[r]&&(!t.length||objHasKeys(e[r],t))};s.util.sumArrays=function(e,t){return n.zip(e,t).map(function(e,t){return n.sum(e)})};s.util.arrayLast=function(e){return e[e.length-1]};s.util.arrayEqual=function(e,t){var r=Math.max(e.length,t.length,1);while(r-- >=0&&e[r]===t[r]);return r===-2};s.util.flattenArray=function(e){var t=[];while(!s.util.arrayEqual(t,e)){t=e;e=[].concat.apply([],e)}return e};s.util.deduplicate=function(e){return e.filter(function(e,t,r){return r.indexOf(e)==t})};s.util.convertToCartesian=function(e,t){var r=t*Math.PI/180;var n=e*Math.cos(r);var i=e*Math.sin(r);return[n,i]};s.util.round=function(e,t){var r=t||2;var n=Math.pow(10,r);return Math.round(e*n)/n};s.util.getMousePos=function(e){var t=n.mouse(e.node());var r=t[0];var i=t[1];var a={};a.x=r;a.y=i;a.pos=t;a.angle=(Math.atan2(i,r)+Math.PI)*180/Math.PI;a.radius=Math.sqrt(r*r+i*i);return a};s.util.duplicatesCount=function(e){var t={},r;var n={};for(var i=0,a=e.length;i<a;i++){r=e[i];if(r in t){t[r]++;n[r]=t[r]}else{t[r]=1}}return n};s.util.duplicates=function(e){return Object.keys(s.util.duplicatesCount(e))};s.util.translator=function(e,t,r,n){if(n){var i=r.slice();r=t;t=i}var a=t.reduce(function(e,t){if(typeof e!="undefined")return e[t]},e);if(typeof a==="undefined")return;t.reduce(function(e,r,n){if(typeof e=="undefined")return;if(n===t.length-1)delete e[r];return e[r]},e);r.reduce(function(e,t,n){if(typeof e[t]==="undefined")e[t]={};if(n===r.length-1)e[t]=a;return e[t]},e)};s.PolyChart=function e(){var t=[s.PolyChart.defaultConfig()];var r=n.dispatch("hover");var i={solid:"none",dash:[5,2],dot:[2,5]};var o;function l(){var e=t[0].geometryConfig;var r=e.container;if(typeof r=="string")r=n.select(r);r.datum(t).each(function(t,r){var a=!!t[0].data.yStack;var o=t.map(function(e,t){if(a)return n.zip(e.data.t[0],e.data.r[0],e.data.yStack[0]);else return n.zip(e.data.t[0],e.data.r[0])});var s=e.angularScale;var l=e.radialScale.domain()[0];var u={};u.bar=function(r,i,a){var o=t[a].data;var l=e.radialScale(r[1])-e.radialScale(0);var u=e.radialScale(r[2]||0);var f=o.barWidth;n.select(this).attr({class:"mark bar",d:"M"+[[l+u,-f/2],[l+u,f/2],[u,f/2],[u,-f/2]].join("L")+"Z",transform:function(t,r){return"rotate("+(e.orientation+s(t[0]))+")"}})};u.dot=function(e,r,i){var a=e[2]?[e[0],e[1]+e[2]]:e;var o=n.svg.symbol().size(t[i].data.dotSize).type(t[i].data.dotType)(e,r);n.select(this).attr({class:"mark dot",d:o,transform:function(e,t){var r=y(m(a));return"translate("+[r.x,r.y]+")"}})};var f=n.svg.line.radial().interpolate(t[0].data.lineInterpolation).radius(function(t){return e.radialScale(t[1])}).angle(function(t){return e.angularScale(t[0])*Math.PI/180});u.line=function(r,i,a){var s=r[2]?o[a].map(function(e,t){return[e[0],e[1]+e[2]]}):o[a];n.select(this).each(u["dot"]).style({opacity:function(e,r){return+t[a].data.dotVisible},fill:d.stroke(r,i,a)}).attr({class:"mark dot"});if(i>0)return;var l=n.select(this.parentNode).selectAll("path.line").data([0]);l.enter().insert("path");l.attr({class:"line",d:f(s),transform:function(t,r){return"rotate("+(e.orientation+90)+")"},"pointer-events":"none"}).style({fill:function(e,t){return d.fill(r,i,a)},"fill-opacity":0,stroke:function(e,t){return d.stroke(r,i,a)},"stroke-width":function(e,t){return d["stroke-width"](r,i,a)},"stroke-dasharray":function(e,t){return d["stroke-dasharray"](r,i,a)},opacity:function(e,t){return d.opacity(r,i,a)},display:function(e,t){return d.display(r,i,a)}})};var c=e.angularScale.range();var h=Math.abs(c[1]-c[0])/o[0].length*Math.PI/180;var v=n.svg.arc().startAngle(function(e){return-h/2}).endAngle(function(e){return h/2}).innerRadius(function(t){return e.radialScale(l+(t[2]||0))}).outerRadius(function(t){return e.radialScale(l+(t[2]||0))+e.radialScale(t[1])});u.arc=function(t,r,i){n.select(this).attr({class:"mark arc",d:v,transform:function(t,r){return"rotate("+(e.orientation+s(t[0])+90)+")"}})};var d={fill:function(e,r,n){return t[n].data.color},stroke:function(e,r,n){return t[n].data.strokeColor},"stroke-width":function(e,r,n){return t[n].data.strokeSize+"px"},"stroke-dasharray":function(e,r,n){return i[t[n].data.strokeDash]},opacity:function(e,r,n){return t[n].data.opacity},display:function(e,r,n){return typeof t[n].data.visible==="undefined"||t[n].data.visible?"block":"none"}};var p=n.select(this).selectAll("g.layer").data(o);p.enter().append("g").attr({class:"layer"});var g=p.selectAll("path.mark").data(function(e,t){return e});g.enter().append("path").attr({class:"mark"});g.style(d).each(u[e.geometryType]);g.exit().remove();p.exit().remove();function m(t,r){var n=e.radialScale(t[1]);var i=(e.angularScale(t[0])+e.orientation)*Math.PI/180;return{r:n,t:i}}function y(e){var t=e.r*Math.cos(e.t);var r=e.r*Math.sin(e.t);return{x:t,y:r}}})}l.config=function(e){if(!arguments.length)return t;e.forEach(function(e,r){if(!t[r])t[r]={};a(t[r],s.PolyChart.defaultConfig());a(t[r],e)});return this};l.getColorScale=function(){return o};n.rebind(l,r,"on");return l};s.PolyChart.defaultConfig=function(){var e={data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:false,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:true,visibleInLegend:true},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:n.scale.category20()}};return e};s.BarChart=function e(){return s.PolyChart()};s.BarChart.defaultConfig=function(){var e={geometryConfig:{geometryType:"bar"}};return e};s.AreaChart=function e(){return s.PolyChart()};s.AreaChart.defaultConfig=function(){var e={geometryConfig:{geometryType:"arc"}};return e};s.DotPlot=function e(){return s.PolyChart()};s.DotPlot.defaultConfig=function(){var e={geometryConfig:{geometryType:"dot",dotType:"circle"}};return e};s.LinePlot=function e(){return s.PolyChart()};s.LinePlot.defaultConfig=function(){var e={geometryConfig:{geometryType:"line"}};return e};s.Legend=function e(){var t=s.Legend.defaultConfig();var r=n.dispatch("hover");function i(){var e=t.legendConfig;var r=t.data.map(function(t,r){return[].concat(t).map(function(t,n){var i=a({},e.elements[r]);i.name=t;i.color=[].concat(e.elements[r].color)[n];return i})});var o=n.merge(r);o=o.filter(function(t,r){return e.elements[r]&&(e.elements[r].visibleInLegend||typeof e.elements[r].visibleInLegend==="undefined")});if(e.reverseOrder)o=o.reverse();var s=e.container;if(typeof s=="string"||s.nodeName)s=n.select(s);var l=o.map(function(e,t){return e.color});var u=e.fontSize;var f=e.isContinuous==null?typeof o[0]==="number":e.isContinuous;var c=f?e.height:u*o.length;var h=s.classed("legend-group",true);var v=h.selectAll("svg").data([0]);var d=v.enter().append("svg").attr({width:300,height:c+u,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});d.append("g").classed("legend-axis",true);d.append("g").classed("legend-marks",true);var p=n.range(o.length);var g=n.scale[f?"linear":"ordinal"]().domain(p).range(l);var m=n.scale[f?"linear":"ordinal"]().domain(p)[f?"range":"rangePoints"]([0,c]);var y=function(e,t){var r=t*3;if(e==="line"){return"M"+[[-t/2,-t/12],[t/2,-t/12],[t/2,t/12],[-t/2,t/12]]+"Z"}else if(n.svg.symbolTypes.indexOf(e)!=-1)return n.svg.symbol().type(e).size(r)();else return n.svg.symbol().type("square").size(r)()};if(f){var b=v.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(l);b.enter().append("stop");b.attr({offset:function(e,t){return t/(l.length-1)*100+"%"}}).style({"stop-color":function(e,t){return e}});v.append("rect").classed("legend-mark",true).attr({height:e.height,width:e.colorBandWidth,fill:"url(#grad1)"})}else{var x=v.select(".legend-marks").selectAll("path.legend-mark").data(o);x.enter().append("path").classed("legend-mark",true);x.attr({transform:function(e,t){return"translate("+[u/2,m(t)+u/2]+")"},d:function(e,t){var r=e.symbol;return y(r,u)},fill:function(e,t){return g(t)}});x.exit().remove()}var _=n.svg.axis().scale(m).orient("right");var w=v.select("g.legend-axis").attr({transform:"translate("+[f?e.colorBandWidth:u,u/2]+")"}).call(_);w.selectAll(".domain").style({fill:"none",stroke:"none"});w.selectAll("line").style({fill:"none",stroke:f?e.textColor:"none"});w.selectAll("text").style({fill:e.textColor,"font-size":e.fontSize}).text(function(e,t){return o[t].name});return i}i.config=function(e){if(!arguments.length)return t;a(t,e);return this};n.rebind(i,r,"on");return i};s.Legend.defaultConfig=function(e,t){var r={data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:false}};return r};s.tooltipPanel=function(){var e,t,r;var i={container:null,hasTick:false,fontSize:12,color:"white",padding:5};var o="tooltip-"+s.tooltipPanel.uid++;var l=10;var u=function(){e=i.container.selectAll("g."+o).data([0]);var n=e.enter().append("g").classed(o,true).style({"pointer-events":"none",display:"none"});r=n.append("path").style({fill:"white","fill-opacity":.9}).attr({d:"M0 0"});t=n.append("text").attr({dx:i.padding+l,dy:+i.fontSize*.3});return u};u.text=function(a){var o=n.hsl(i.color).l;var s=o>=.5?"#aaa":"white";var f=o>=.5?"black":"white";var c=a||"";t.style({fill:f,"font-size":i.fontSize+"px"}).text(c);var h=i.padding;var v=t.node().getBBox();var d={fill:i.color,stroke:s,"stroke-width":"2px"};var p=v.width+h*2+l;var g=v.height+h*2;r.attr({d:"M"+[[l,-g/2],[l,-g/4],[i.hasTick?0:l,0],[l,g/4],[l,g/2],[p,g/2],[p,-g/2]].join("L")+"Z"}).style(d);e.attr({transform:"translate("+[l,-g/2+h*2]+")"});e.style({display:"block"});return u};u.move=function(t){if(!e)return;e.attr({transform:"translate("+[t[0],t[1]]+")"}).style({display:"block"});return u};u.hide=function(){if(!e)return;e.style({display:"none"});return u};u.show=function(){if(!e)return;e.style({display:"block"});return u};u.config=function(e){a(i,e);return u};return u};s.tooltipPanel.uid=1;s.adapter={};s.adapter.plotly=function e(){var t={};t.convert=function(e,t){var r={};if(e.data){r.data=e.data.map(function(e,r){var n=a({},e);var i=[[n,["marker","color"],["color"]],[n,["marker","opacity"],["opacity"]],[n,["marker","line","color"],["strokeColor"]],[n,["marker","line","dash"],["strokeDash"]],[n,["marker","line","width"],["strokeSize"]],[n,["marker","symbol"],["dotType"]],[n,["marker","size"],["dotSize"]],[n,["marker","barWidth"],["barWidth"]],[n,["line","interpolation"],["lineInterpolation"]],[n,["showlegend"],["visibleInLegend"]]];i.forEach(function(e,r){s.util.translator.apply(null,e.concat(t))});if(!t)delete n.marker;if(t)delete n.groupId;if(!t){if(n.type==="scatter"){if(n.mode==="lines")n.geometry="LinePlot";else if(n.mode==="markers")n.geometry="DotPlot";else if(n.mode==="lines+markers"){n.geometry="LinePlot";n.dotVisible=true}}else if(n.type==="area")n.geometry="AreaChart";else if(n.type==="bar")n.geometry="BarChart";delete n.mode;delete n.type}else{if(n.geometry==="LinePlot"){n.type="scatter";if(n.dotVisible===true){delete n.dotVisible;n.mode="lines+markers"}else n.mode="lines"}else if(n.geometry==="DotPlot"){n.type="scatter";n.mode="markers"}else if(n.geometry==="AreaChart")n.type="area";else if(n.geometry==="BarChart")n.type="bar";delete n.geometry}return n});if(!t&&e.layout&&e.layout.barmode==="stack"){var i=s.util.duplicates(r.data.map(function(e,t){return e.geometry}));r.data.forEach(function(e,t){var n=i.indexOf(e.geometry);if(n!=-1)r.data[t].groupId=n})}}if(e.layout){var o=a({},e.layout);var l=[[o,["plot_bgcolor"],["backgroundColor"]],[o,["showlegend"],["showLegend"]],[o,["radialaxis"],["radialAxis"]],[o,["angularaxis"],["angularAxis"]],[o.angularaxis,["showline"],["gridLinesVisible"]],[o.angularaxis,["showticklabels"],["labelsVisible"]],[o.angularaxis,["nticks"],["ticksCount"]],[o.angularaxis,["tickorientation"],["tickOrientation"]],[o.angularaxis,["ticksuffix"],["ticksSuffix"]],[o.angularaxis,["range"],["domain"]],[o.angularaxis,["endpadding"],["endPadding"]],[o.radialaxis,["showline"],["gridLinesVisible"]],[o.radialaxis,["tickorientation"],["tickOrientation"]],[o.radialaxis,["ticksuffix"],["ticksSuffix"]],[o.radialaxis,["range"],["domain"]],[o.angularAxis,["showline"],["gridLinesVisible"]],[o.angularAxis,["showticklabels"],["labelsVisible"]],[o.angularAxis,["nticks"],["ticksCount"]],[o.angularAxis,["tickorientation"],["tickOrientation"]],[o.angularAxis,["ticksuffix"],["ticksSuffix"]],[o.angularAxis,["range"],["domain"]],[o.angularAxis,["endpadding"],["endPadding"]],[o.radialAxis,["showline"],["gridLinesVisible"]],[o.radialAxis,["tickorientation"],["tickOrientation"]],[o.radialAxis,["ticksuffix"],["ticksSuffix"]],[o.radialAxis,["range"],["domain"]],[o.font,["outlinecolor"],["outlineColor"]],[o.legend,["traceorder"],["reverseOrder"]],[o,["labeloffset"],["labelOffset"]],[o,["defaultcolorrange"],["defaultColorRange"]]];l.forEach(function(e,r){s.util.translator.apply(null,e.concat(t))});if(!t){if(o.angularAxis&&typeof o.angularAxis.ticklen!=="undefined")o.tickLength=o.angularAxis.ticklen;if(o.angularAxis&&typeof o.angularAxis.tickcolor!=="undefined")o.tickColor=o.angularAxis.tickcolor}else{if(typeof o.tickLength!=="undefined"){o.angularaxis.ticklen=o.tickLength;delete o.tickLength}if(o.tickColor){o.angularaxis.tickcolor=o.tickColor;delete o.tickColor}}if(o.legend&&typeof o.legend.reverseOrder!="boolean"){o.legend.reverseOrder=o.legend.reverseOrder!="normal"}if(o.legend&&typeof o.legend.traceorder=="boolean"){o.legend.traceorder=o.legend.traceorder?"reversed":"normal";delete o.legend.reverseOrder}if(o.margin&&typeof o.margin.t!="undefined"){var u=["t","r","b","l","pad"];var f=["top","right","bottom","left","pad"];var c={};n.entries(o.margin).forEach(function(e,t){c[f[u.indexOf(e.key)]]=e.value});o.margin=c}if(t){delete o.needsEndSpacing;delete o.minorTickColor;delete o.minorTicks;delete o.angularaxis.ticksCount;delete o.angularaxis.ticksCount;delete o.angularaxis.ticksStep;delete o.angularaxis.rewriteTicks;delete o.angularaxis.nticks;delete o.radialaxis.ticksCount;delete o.radialaxis.ticksCount;delete o.radialaxis.ticksStep;delete o.radialaxis.rewriteTicks;delete o.radialaxis.nticks}r.layout=o}return r};return t}},{"../../../constants/alignment":459,"../../../lib":483,d3:81}],578:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../../lib");var a=e("../../../components/color");var o=e("./micropolar");var s=e("./undo_manager");var l=i.extendDeepAll;var u=t.exports={};u.framework=function(e){var t,r,i,a,f;var c=new s;function h(r,s){if(s)f=s;n.select(n.select(f).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove();t=!t?r:l(t,r);if(!i)i=o.Axis();a=o.adapter.plotly().convert(t);i.config(a).render(f);e.data=t.data;e.layout=t.layout;u.fillLayout(e);return t}h.isPolar=true;h.svg=function(){return i.svg()};h.getConfig=function(){return t};h.getLiveConfig=function(){return o.adapter.plotly().convert(i.getLiveConfig(),true)};h.getLiveScales=function(){return{t:i.angularScale(),r:i.radialScale()}};h.setUndoPoint=function(){var e=this;var n=o.util.cloneJson(t);(function(t,r){c.add({undo:function(){if(r)e(r)},redo:function(){e(t)}})})(n,r);r=o.util.cloneJson(n)};h.undo=function(){c.undo()};h.redo=function(){c.redo()};return h};u.fillLayout=function(e){var t=n.select(e).selectAll(".plot-container"),r=t.selectAll(".svg-container"),i=e.framework&&e.framework.svg&&e.framework.svg(),o={width:800,height:600,paper_bgcolor:a.background,_container:t,_paperdiv:r,_paper:i};e._fullLayout=l(o,e.layout)}},{"../../../components/color":361,"../../../lib":483,"./micropolar":577,"./undo_manager":579,d3:81}],579:[function(e,t,r){"use strict";t.exports=function e(){var t=[],r=-1,n=false,i;function a(e,t){if(!e)return this;n=true;e[t]();n=false;return this}return{add:function(e){if(n)return this;t.splice(r+1,t.length-r);t.push(e);r=t.length-1;return this},setCallback:function(e){i=e},undo:function(){var e=t[r];if(!e)return this;a(e,"undo");r-=1;if(i)i(e.undo);return this},redo:function(){var e=t[r+1];if(!e)return this;a(e,"redo");r+=1;if(i)i(e.redo);return this},clear:function(){t=[];r=-1},hasUndo:function(){return r!==-1},hasRedo:function(){return r<t.length-1},getCommands:function(){return t},getPreviousCommand:function(){return t[r-1]},getIndex:function(){return r}}}},{}],580:[function(e,t,r){"use strict";function n(e,t){if(e==="splom")return-1;if(t==="splom")return 1;return 0}function i(e,t){return n(e.name,t.name)}t.exports={sortBasePlotModules:i,sortModules:n}},{}],581:[function(e,t,r){"use strict";var n=e("../lib");var i=e("../plot_api/plot_template");var a=e("./domain").defaults;t.exports=function e(t,r,o,s){var l=s.type;var u=s.attributes;var f=s.handleDefaults;var c=s.partition||"x";var h=r._subplots[l];var v=h.length;var d=v&&h[0].replace(/\d+$/,"");var p,g;function m(e,t){return n.coerce(p,g,u,e,t)}for(var y=0;y<v;y++){var b=h[y];if(t[b])p=t[b];else p=t[b]={};g=i.newContainer(r,b,d);var x={};x[c]=[y/v,(y+1)/v];a(g,r,m,x);s.id=b;f(p,g,m,s)}}},{"../lib":483,"../plot_api/plot_template":519,"./domain":554}],582:[function(e,t,r){"use strict";var n=e("./lib/loggers");var i=e("./lib/noop");var a=e("./lib/push_unique");var o=e("./lib/is_plain_object");var s=e("./lib/extend");var l=e("./plots/attributes");var u=e("./plots/layout_attributes");var f=s.extendFlat;var c=s.extendDeepAll;r.modules={};r.allCategories={};r.allTypes=[];r.subplotsRegistry={};r.transformsRegistry={};r.componentsRegistry={};r.layoutArrayContainers=[];r.layoutArrayRegexes=[];r.traceLayoutAttributes={};r.localeRegistry={};r.apiMethodRegistry={};r.register=function e(t){if(!t){throw new Error("No argument passed to Plotly.register.")}else if(t&&!Array.isArray(t)){t=[t]}for(var n=0;n<t.length;n++){var i=t[n];if(!i){throw new Error("Invalid module was attempted to be registered!")}switch(i.moduleType){case"trace":h(i);break;case"transform":p(i);break;case"component":d(i);break;case"locale":g(i);break;case"apiMethod":var a=i.name;r.apiMethodRegistry[a]=i.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}};r.getModule=function(e){var t=r.modules[_(e)];if(!t)return false;return t._module};r.traceIs=function(e,t){e=_(e);if(e==="various")return false;var i=r.modules[e];if(!i){if(e&&e!=="area"){n.log("Unrecognized trace type "+e+".")}i=r.modules[l.type.dflt]}return!!i.categories[t]};r.getTransformIndices=function(e,t){var r=[];var n=e.transforms||[];for(var i=0;i<n.length;i++){if(n[i].type===t){r.push(i)}}return r};r.hasTransform=function(e,t){var r=e.transforms||[];for(var n=0;n<r.length;n++){if(r[n].type===t){return true}}return false};r.getComponentMethod=function(e,t){var n=r.componentsRegistry[e];if(!n)return i;return n[t]||i};r.call=function(){var e=arguments[0];var t=[].slice.call(arguments,1);return r.apiMethodRegistry[e].apply(null,t)};function h(e){var t=e.name;var i=e.categories;var a=e.meta;if(r.modules[t]){n.log("Type "+t+" already registered");return}if(!r.subplotsRegistry[e.basePlotModule.name]){v(e.basePlotModule)}var o={};for(var s=0;s<i.length;s++){o[i[s]]=true;r.allCategories[i[s]]=true}r.modules[t]={_module:e,categories:o};if(a&&Object.keys(a).length){r.modules[t].meta=a}r.allTypes.push(t);for(var l in r.componentsRegistry){y(l,t)}if(e.layoutAttributes){f(r.traceLayoutAttributes,e.layoutAttributes)}}function v(e){var t=e.name;if(r.subplotsRegistry[t]){n.log("Plot type "+t+" already registered.");return}m(e);r.subplotsRegistry[t]=e;for(var i in r.componentsRegistry){x(i,e.name)}}function d(e){if(typeof e.name!=="string"){throw new Error("Component module *name* must be a string.")}var t=e.name;r.componentsRegistry[t]=e;if(e.layoutAttributes){if(e.layoutAttributes._isLinkedToArray){a(r.layoutArrayContainers,t)}m(e)}for(var n in r.modules){y(t,n)}for(var i in r.subplotsRegistry){x(t,i)}for(var o in r.transformsRegistry){b(t,o)}if(e.schema&&e.schema.layout){c(u,e.schema.layout)}}function p(e){if(typeof e.name!=="string"){throw new Error("Transform module *name* must be a string.")}var t="Transform module "+e.name;var i=typeof e.transform==="function";var a=typeof e.calcTransform==="function";if(!i&&!a){throw new Error(t+" is missing a *transform* or *calcTransform* method.")}if(i&&a){n.log([t+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" "))}if(!o(e.attributes)){n.log(t+" registered without an *attributes* object.")}if(typeof e.supplyDefaults!=="function"){n.log(t+" registered without a *supplyDefaults* method.")}r.transformsRegistry[e.name]=e;for(var s in r.componentsRegistry){b(s,e.name)}}function g(e){var t=e.name;var n=t.split("-")[0];var i=e.dictionary;var a=e.format;var o=i&&Object.keys(i).length;var s=a&&Object.keys(a).length;var l=r.localeRegistry;var u=l[t];if(!u)l[t]=u={};if(n!==t){var f=l[n];if(!f)l[n]=f={};if(o&&f.dictionary===u.dictionary){f.dictionary=i}if(s&&f.format===u.format){f.format=a}}if(o)u.dictionary=i;if(s)u.format=a}function m(e){if(e.layoutAttributes){var t=e.layoutAttributes._arrayAttrRegexps;if(t){for(var n=0;n<t.length;n++){a(r.layoutArrayRegexes,t[n])}}}}function y(e,t){var n=r.componentsRegistry[e].schema;if(!n||!n.traces)return;var i=n.traces[t];if(i){c(r.modules[t]._module.attributes,i)}}function b(e,t){var n=r.componentsRegistry[e].schema;if(!n||!n.transforms)return;var i=n.transforms[t];if(i){c(r.transformsRegistry[t].attributes,i)}}function x(e,t){var n=r.componentsRegistry[e].schema;if(!n||!n.subplots)return;var i=r.subplotsRegistry[t];var a=i.layoutAttributes;var o=i.attr==="subplot"?i.name:i.attr;if(Array.isArray(o))o=o[0];var s=n.subplots[o];if(a&&s){c(a,s)}}function _(e){if(typeof e==="object")e=e.type;return e}},{"./lib/extend":475,"./lib/is_plain_object":485,"./lib/loggers":488,"./lib/noop":492,"./lib/push_unique":496,"./plots/attributes":526,"./plots/layout_attributes":571}],583:[function(e,t,r){"use strict";var n=e("../lib");var i=n.extendFlat;var a=n.extendDeep;function o(e){var t;switch(e){case"themes__thumb":t={autosize:true,width:150,height:150,title:"",showlegend:false,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":t={title:"",hidesources:true,showlegend:false,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:t={}}return t}function s(e){var t=["xaxis","yaxis","zaxis"];return t.indexOf(e.slice(0,5))>-1}t.exports=function e(t,r){if(t.framework&&t.framework.isPolar){t=t.framework.getConfig()}var n;var l=t.data;var u=t.layout;var f=a([],l);var c=a({},u,o(r.tileClass));var h=t._context||{};if(r.width)c.width=r.width;if(r.height)c.height=r.height;if(r.tileClass==="thumbnail"||r.tileClass==="themes__thumb"){c.annotations=[];var v=Object.keys(c);for(n=0;n<v.length;n++){if(s(v[n])){c[v[n]].title=""}}for(n=0;n<f.length;n++){var d=f[n];d.showscale=false;if(d.marker)d.marker.showscale=false;if(d.type==="pie")d.textposition="none"}}if(Array.isArray(r.annotations)){for(n=0;n<r.annotations.length;n++){c.annotations.push(r.annotations[n])}}var p=Object.keys(c).filter(function(e){return e.match(/^scene\d*$/)});if(p.length){var g={};if(r.tileClass==="thumbnail"){g={title:"",showaxeslabels:false,showticklabels:false,linetickenable:false}}for(n=0;n<p.length;n++){var m=c[p[n]];if(!m.xaxis){m.xaxis={}}if(!m.yaxis){m.yaxis={}}if(!m.zaxis){m.zaxis={}}i(m.xaxis,g);i(m.yaxis,g);i(m.zaxis,g);m._scene=null}}var y=document.createElement("div");if(r.tileClass)y.className=r.tileClass;var b={gd:y,td:y,layout:c,data:f,config:{staticPlot:r.staticPlot===undefined?true:r.staticPlot,plotGlPixelRatio:r.plotGlPixelRatio===undefined?2:r.plotGlPixelRatio,displaylogo:r.displaylogo||false,showLink:r.showLink||false,showTips:r.showTips||false,mapboxAccessToken:h.mapboxAccessToken}};if(r.setBackground!=="transparent"){b.config.setBackground=r.setBackground||"opaque"}b.gd.defaultLayout=o(r.tileClass);return b}},{"../lib":483}],584:[function(e,t,r){"use strict";var n=e("../plot_api/to_image");var i=e("../lib");var a=e("./filesaver");function o(e,t){t=t||{};t.format=t.format||"png";return new Promise(function(r,o){if(e._snapshotInProgress){o(new Error("Snapshotting already in progress."))}if(i.isIE()&&t.format!=="svg"){o(new Error("Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."))}e._snapshotInProgress=true;var s=n(e,t);var l=t.filename||e.fn||"newplot";l+="."+t.format;s.then(function(t){e._snapshotInProgress=false;return a(t,l)}).then(function(e){r(e)}).catch(function(t){e._snapshotInProgress=false;o(t)})})}t.exports=o},{"../lib":483,"../plot_api/to_image":522,"./filesaver":585}],585:[function(e,t,r){"use strict";var n=function(e,t){var r=document.createElement("a");var n="download"in r;var i=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent);var a=new Promise(function(a,o){if(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){o(new Error("IE < 10 unsupported"))}if(i){document.location.href="data:application/octet-stream"+e.slice(e.search(/[,;]/));a(t)}if(!t){t="download"}if(n){r.href=e;r.download=t;document.body.appendChild(r);r.click();document.body.removeChild(r);a(t)}if(typeof navigator!=="undefined"&&navigator.msSaveBlob){var s=e.split(/^data:image\/svg\+xml,/)[1];var l=decodeURIComponent(s);navigator.msSaveBlob(new Blob([l]),t);a(t)}o(new Error("download error"))});return a};t.exports=n},{}],586:[function(e,t,r){"use strict";r.getDelay=function(e){if(!e._has)return 0;return e._has("gl3d")||e._has("gl2d")||e._has("mapbox")?500:0};r.getRedrawFunc=function(e){var t=e._fullLayout||{};var r=t._has&&t._has("polar");var n=!r&&e.data&&e.data[0]&&e.data[0].r;if(n)return;return function(){(e.calcdata||[]).forEach(function(e){if(e[0]&&e[0].t&&e[0].t.cb)e[0].t.cb()})}}},{}],587:[function(e,t,r){"use strict";var n=e("./helpers");var i={getDelay:n.getDelay,getRedrawFunc:n.getRedrawFunc,clone:e("./cloneplot"),toSVG:e("./tosvg"),svgToImg:e("./svgtoimg"),toImage:e("./toimage"),downloadImage:e("./download")};t.exports=i},{"./cloneplot":583,"./download":584,"./helpers":586,"./svgtoimg":588,"./toimage":589,"./tosvg":590}],588:[function(e,t,r){"use strict";var n=e("../lib");var i=e("events").EventEmitter;function a(e){var t=e.emitter||new i;var r=new Promise(function(i,a){var o=window.Image;var s=e.svg;var l=e.format||"png";if(n.isIE()&&l!=="svg"){var u=new Error("Sorry IE does not support downloading from canvas. Try {format:'svg'} instead.");a(u);if(!e.promise){return t.emit("error",u)}else{return r}}var f=e.canvas;var c=e.scale||1;var h=e.width||300;var v=e.height||150;var d=c*h;var p=c*v;var g=f.getContext("2d");var m=new o;var y="data:image/svg+xml,"+encodeURIComponent(s);f.width=d;f.height=p;m.onload=function(){var r;if(l!=="svg"){g.drawImage(m,0,0,d,p)}switch(l){case"jpeg":r=f.toDataURL("image/jpeg");break;case"png":r=f.toDataURL("image/png");break;case"webp":r=f.toDataURL("image/webp");break;case"svg":r=y;break;default:var n="Image format is not jpeg, png, svg or webp.";a(new Error(n));if(!e.promise){return t.emit("error",n)}}i(r);if(!e.promise){t.emit("success",r)}};m.onerror=function(r){a(r);if(!e.promise){return t.emit("error",r)}};m.src=y});if(e.promise){return r}return t}t.exports=a},{"../lib":483,events:89}],589:[function(e,t,r){"use strict";var n=e("events").EventEmitter;var i=e("../registry");var a=e("../lib");var o=e("./helpers");var s=e("./cloneplot");var l=e("./tosvg");var u=e("./svgtoimg");function f(e,t){var r=new n;var f=s(e,{format:"png"});var c=f.gd;c.style.position="absolute";c.style.left="-5000px";document.body.appendChild(c);function h(){var e=o.getDelay(c._fullLayout);setTimeout(function(){var e=l(c);var n=document.createElement("canvas");n.id=a.randstr();r=u({format:t.format,width:c._fullLayout.width,height:c._fullLayout.height,canvas:n,emitter:r,svg:e});r.clean=function(){if(c)document.body.removeChild(c)}},e)}var v=o.getRedrawFunc(c);i.call("plot",c,f.data,f.layout,f.config).then(v).then(h).catch(function(e){r.emit("error",e)});return r}t.exports=f},{"../lib":483,"../registry":582,"./cloneplot":583,"./helpers":586,"./svgtoimg":588,"./tosvg":590,events:89}],590:[function(e,t,r){"use strict";var n=e("d3");var i=e("../lib");var a=e("../components/drawing");var o=e("../components/color");var s=e("../constants/xmlns_namespaces");var l=/"/g;var u="TOBESTRIPPED";var f=new RegExp('("'+u+")|("+u+'")',"g");function c(e){var t=n.select("body").append("div").style({display:"none"}).html("");var r=e.replace(/(&[^;]*;)/gi,function(e){if(e==="&lt;"){return"&#60;"}if(e==="&rt;"){return"&#62;"}if(e.indexOf("<")!==-1||e.indexOf(">")!==-1){return""}return t.html(e).text()});t.remove();return r}function h(e){return e.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}t.exports=function e(t,r,v){var d=t._fullLayout;var p=d._paper;var g=d._toppaper;var m=d.width;var y=d.height;var b;p.insert("rect",":first-child").call(a.setRect,0,0,m,y).call(o.fill,d.paper_bgcolor);var x=d._basePlotModules||[];for(b=0;b<x.length;b++){var _=x[b];if(_.toSVG)_.toSVG(t)}if(g){var w=g.node().childNodes;var M=Array.prototype.slice.call(w);for(b=0;b<M.length;b++){var A=M[b];if(A.childNodes.length)p.node().appendChild(A)}}if(d._draggers){d._draggers.remove()}p.node().style.background="";p.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var e=n.select(this);if(this.style.visibility==="hidden"||this.style.display==="none"){e.remove();return}else{e.style({visibility:null,display:null})}var t=this.style.fontFamily;if(t&&t.indexOf('"')!==-1){e.style("font-family",t.replace(l,u))}});p.selectAll(".point,.scatterpts").each(function(){var e=n.select(this);var t=this.style.fill;if(t&&t.indexOf("url(")!==-1){e.style("fill",t.replace(l,u))}});if(r==="pdf"||r==="eps"){p.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0)}p.node().setAttributeNS(s.xmlns,"xmlns",s.svg);p.node().setAttributeNS(s.xmlns,"xmlns:xlink",s.xlink);if(r==="svg"&&v){p.attr("width",v*m);p.attr("height",v*y);p.attr("viewBox","0 0 "+m+" "+y)}var T=(new window.XMLSerializer).serializeToString(p.node());T=c(T);T=h(T);T=T.replace(f,"'");if(i.isIE()){T=T.replace(/"/gi,"'");T=T.replace(/(\('#)([^']*)('\))/gi,'("#$2")');T=T.replace(/(\\')/gi,'"')}return T}},{"../components/color":361,"../components/drawing":386,"../constants/xmlns_namespaces":465,"../lib":483,d3:81}],591:[function(e,t,r){"use strict";var n=e("../../components/colorscale/attributes");var i=e("../../components/colorbar/attributes");var a=e("../mesh3d/attributes");var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;var l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"}};s(l,n("",{colorAttr:"u/v/w norm",showScaleDflt:true,editTypeOverride:"calc"}),{colorbar:i});var u=["opacity","lightposition","lighting"];u.forEach(function(e){l[e]=a[e]});l.hoverinfo=s({},o.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"});t.exports=l},{"../../components/colorbar/attributes":362,"../../components/colorscale/attributes":368,"../../lib/extend":475,"../../plots/attributes":526,"../mesh3d/attributes":596}],592:[function(e,t,r){"use strict";var n=e("../../components/colorscale/calc");t.exports=function e(t,r){var i=r.u;var a=r.v;var o=r.w;var s=Math.min(r.x.length,r.y.length,r.z.length,i.length,a.length,o.length);var l=-Infinity;var u=Infinity;for(var f=0;f<s;f++){var c=i[f];var h=a[f];var v=o[f];var d=Math.sqrt(c*c+h*h+v*v);l=Math.max(l,d);u=Math.min(u,d)}r._len=s;r._normMax=l;n(r,[u,l],"","c")}},{"../../components/colorscale/calc":369}],593:[function(e,t,r){"use strict";var n=e("gl-cone3d");var i=e("gl-cone3d").createConeMesh;var a=e("../../lib").simpleMap;var o=e("../../lib/gl_format_color").parseColorScale;var s=e("../../plots/gl3d/zip3");function l(e,t){this.scene=e;this.uid=t;this.mesh=null;this.data=null}var u=l.prototype;u.handlePick=function(e){if(e.object===this.mesh){var t=e.index=e.data.index;var r=this.data.x[t];var n=this.data.y[t];var i=this.data.z[t];var a=this.data.u[t];var o=this.data.v[t];var s=this.data.w[t];e.traceCoordinate=[r,n,i,a,o,s,Math.sqrt(a*a+o*o+s*s)];var l=this.data.text;if(Array.isArray(l)&&l[t]!==undefined){e.textLabel=l[t]}else if(l){e.textLabel=l}return true}};var f={xaxis:0,yaxis:1,zaxis:2};var c={tip:1,tail:0,cm:.25,center:.5};var h={tip:1,tail:1,cm:.75,center:.5};function v(e,t){var r=e.fullSceneLayout;var i=e.dataScale;var l={};function u(e,t){var n=r[t];var o=i[f[t]];return a(e,function(e){return n.d2l(e)*o})}l.vectors=s(u(t.u,"xaxis"),u(t.v,"yaxis"),u(t.w,"zaxis"),t._len);l.positions=s(u(t.x,"xaxis"),u(t.y,"yaxis"),u(t.z,"zaxis"),t._len);l.colormap=o(t.colorscale);l.vertexIntensityBounds=[t.cmin/t._normMax,t.cmax/t._normMax];l.coneOffset=c[t.anchor];if(t.sizemode==="scaled"){l.coneSize=t.sizeref||.5}else{l.coneSize=t.sizeref&&t._normMax?t.sizeref/t._normMax:.5}var v=n(l);var d=t.lightposition;v.lightPosition=[d.x,d.y,d.z];v.ambient=t.lighting.ambient;v.diffuse=t.lighting.diffuse;v.specular=t.lighting.specular;v.roughness=t.lighting.roughness;v.fresnel=t.lighting.fresnel;v.opacity=t.opacity;t._pad=h[t.anchor]*v.vectorScale*v.coneScale*t._normMax;return v}u.update=function(e){this.data=e;var t=v(this.scene,e);this.mesh.update(t)};u.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function d(e,t){var r=e.glplot.gl;var n=v(e,t);var a=i(r,n);var o=new l(e,t.uid);o.mesh=a;o.data=t;a._trace=o;e.glplot.add(a);return o}t.exports=d},{"../../lib":483,"../../lib/gl_format_color":480,"../../plots/gl3d/zip3":570,"gl-cone3d":105}],594:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../components/colorscale/defaults");var a=e("./attributes");t.exports=function e(t,r,o,s){function l(e,i){return n.coerce(t,r,a,e,i)}var u=l("u");var f=l("v");var c=l("w");var h=l("x");var v=l("y");var d=l("z");if(!u||!u.length||!f||!f.length||!c||!c.length||!h||!h.length||!v||!v.length||!d||!d.length){r.visible=false;return}l("sizeref");l("sizemode");l("anchor");l("lighting.ambient");l("lighting.diffuse");l("lighting.specular");l("lighting.roughness");l("lighting.fresnel");l("lightposition.x");l("lightposition.y");l("lightposition.z");i(t,r,s,l,{prefix:"",cLetter:"c"});l("text");r._length=null}},{"../../components/colorscale/defaults":371,"../../lib":483,"./attributes":591}],595:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"cone",basePlotModule:e("../../plots/gl3d"),categories:["gl3d"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),meta:{}}},{"../../plots/gl3d":559,"./attributes":591,"./calc":592,"./convert":593,"./defaults":594}],596:[function(e,t,r){"use strict";var n=e("../../components/colorscale/attributes");var i=e("../../components/colorbar/attributes");var a=e("../surface/attributes");var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;t.exports=s({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"}},n("",{colorAttr:"`intensity`",showScaleDflt:true,editTypeOverride:"calc"}),{colorbar:i,opacity:a.opacity,flatshading:{valType:"boolean",dflt:false,editType:"calc"},contour:{show:s({},a.contours.x.show,{}),color:a.contours.x.color,width:a.contours.x.width,editType:"calc"},lightposition:{x:s({},a.lightposition.x,{dflt:1e5}),y:s({},a.lightposition.y,{dflt:1e5}),z:s({},a.lightposition.z,{dflt:0}),editType:"calc"},lighting:s({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},a.lighting),hoverinfo:s({},o.hoverinfo,{editType:"calc"})})},{"../../components/colorbar/attributes":362,"../../components/colorscale/attributes":368,"../../lib/extend":475,"../../plots/attributes":526,"../surface/attributes":640}],597:[function(e,t,r){"use strict";var n=e("../../components/colorscale/calc");t.exports=function e(t,r){if(r.intensity){n(r,r.intensity,"","c")}}},{"../../components/colorscale/calc":369}],598:[function(e,t,r){"use strict";var n=e("gl-mesh3d");var i=e("delaunay-triangulate");var a=e("alpha-shape");var o=e("convex-hull");var s=e("../../lib/gl_format_color").parseColorScale;var l=e("../../lib/str2rgbarray");var u=e("../../plots/gl3d/zip3");function f(e,t,r){this.scene=e;this.uid=r;this.mesh=t;this.name="";this.color="#fff";this.data=null;this.showContour=false}var c=f.prototype;c.handlePick=function(e){if(e.object===this.mesh){var t=e.index=e.data.index;e.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]];var r=this.data.text;if(Array.isArray(r)&&r[t]!==undefined){e.textLabel=r[t]}else if(r){e.textLabel=r}return true}};function h(e){return e.map(l)}c.update=function(e){var t=this.scene,r=t.fullSceneLayout;this.data=e;function n(e,t,r,n){return t.map(function(t){return e.d2l(t,0,n)*r})}var f=u(n(r.xaxis,e.x,t.dataScale[0],e.xcalendar),n(r.yaxis,e.y,t.dataScale[1],e.ycalendar),n(r.zaxis,e.z,t.dataScale[2],e.zcalendar));var c;if(e.i&&e.j&&e.k){c=u(e.i,e.j,e.k)}else if(e.alphahull===0){c=o(f)}else if(e.alphahull>0){c=a(e.alphahull,f)}else{var v=["x","y","z"].indexOf(e.delaunayaxis);c=i(f.map(function(e){return[e[(v+1)%3],e[(v+2)%3]]}))}var d={positions:f,cells:c,lightPosition:[e.lightposition.x,e.lightposition.y,e.lightposition.z],ambient:e.lighting.ambient,diffuse:e.lighting.diffuse,specular:e.lighting.specular,roughness:e.lighting.roughness,fresnel:e.lighting.fresnel,vertexNormalsEpsilon:e.lighting.vertexnormalsepsilon,faceNormalsEpsilon:e.lighting.facenormalsepsilon,opacity:e.opacity,contourEnable:e.contour.show,contourColor:l(e.contour.color).slice(0,3),contourWidth:e.contour.width,useFacetNormals:e.flatshading};if(e.intensity){this.color="#fff";d.vertexIntensity=e.intensity;d.vertexIntensityBounds=[e.cmin,e.cmax];d.colormap=s(e.colorscale)}else if(e.vertexcolor){this.color=e.vertexcolor[0];d.vertexColors=h(e.vertexcolor)}else if(e.facecolor){this.color=e.facecolor[0];d.cellColors=h(e.facecolor)}else{this.color=e.color;d.meshColor=l(e.color)}this.mesh.update(d)};c.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function v(e,t){var r=e.glplot.gl;var i=n({gl:r});var a=new f(e,i,t.uid);i._trace=a;a.update(t);e.glplot.add(i);return a}t.exports=v},{"../../lib/gl_format_color":480,"../../lib/str2rgbarray":505,"../../plots/gl3d/zip3":570,"alpha-shape":16,"convex-hull":72,"delaunay-triangulate":83,"gl-mesh3d":139}],599:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");var a=e("../../components/colorscale/defaults");var o=e("./attributes");t.exports=function e(t,r,s,l){function u(e,n){return i.coerce(t,r,o,e,n)}function f(e){var t=e.map(function(e){var t=u(e);if(t&&i.isArrayOrTypedArray(t))return t;return null});return t.every(function(e){return e&&e.length===t[0].length})&&t}var c=f(["x","y","z"]);var h=f(["i","j","k"]);if(!c){r.visible=false;return}if(h){h.forEach(function(e){for(var t=0;t<e.length;++t)e[t]|=0})}var v=n.getComponentMethod("calendars","handleTraceDefaults");v(t,r,["x","y","z"],l);["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","contour.show","contour.color","contour.width","colorscale","reversescale","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(e){u(e)});if("intensity"in t){u("intensity");a(t,r,l,u,{prefix:"",cLetter:"c"})}else{r.showscale=false;if("facecolor"in t)u("facecolor");else if("vertexcolor"in t)u("vertexcolor");else u("color",s)}u("text");r._length=null}},{"../../components/colorscale/defaults":371,"../../lib":483,"../../registry":582,"./attributes":596}],600:[function(e,t,r){"use strict";var n={};n.attributes=e("./attributes");n.supplyDefaults=e("./defaults");n.calc=e("./calc");n.colorbar={min:"cmin",max:"cmax"};n.plot=e("./convert");n.moduleType="trace";n.name="mesh3d",n.basePlotModule=e("../../plots/gl3d");n.categories=["gl3d"];n.meta={};t.exports=n},{"../../plots/gl3d":559,"./attributes":596,"./calc":597,"./convert":598,"./defaults":599}],601:[function(e,t,r){"use strict";var n=e("../../lib");r.formatPiePercent=function e(t,r){var i=(t*100).toPrecision(3);if(i.lastIndexOf(".")!==-1){i=i.replace(/[.]?0+$/,"")}return n.numSeparate(i,r)+"%"};r.formatPieValue=function e(t,r){var i=t.toPrecision(10);if(i.lastIndexOf(".")!==-1){i=i.replace(/[.]?0+$/,"")}return n.numSeparate(i,r)};r.getFirstFilled=function e(t,r){if(!Array.isArray(t))return;for(var n=0;n<r.length;n++){var i=t[r[n]];if(i||i===0)return i}};r.castOption=function e(t,n){if(Array.isArray(t))return r.getFirstFilled(t,n);else if(t)return t}},{"../../lib":483}],602:[function(e,t,r){"use strict";var n=e("../../components/color");var i=e("./helpers").castOption;t.exports=function e(t,r,a){var o=a.marker.line;var s=i(o.color,r.pts)||n.defaultLine;var l=i(o.width,r.pts)||0;t.style({"stroke-width":l}).call(n.fill,r.color).call(n.stroke,s)}},{"../../components/color":361,"./helpers":601}],603:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r){for(var i=0;i<t.length;i++)t[i].i=i;n.mergeArray(r.text,t,"tx");n.mergeArray(r.hovertext,t,"htx");n.mergeArray(r.customdata,t,"data");n.mergeArray(r.textposition,t,"tp");if(r.textfont){n.mergeArray(r.textfont.size,t,"ts");n.mergeArray(r.textfont.color,t,"tc");n.mergeArray(r.textfont.family,t,"tf")}var a=r.marker;if(a){n.mergeArray(a.size,t,"ms");n.mergeArray(a.opacity,t,"mo");n.mergeArray(a.symbol,t,"mx");n.mergeArray(a.color,t,"mc");var o=a.line;if(a.line){n.mergeArray(o.color,t,"mlc");n.mergeArray(o.width,t,"mlw")}var s=a.gradient;if(s&&s.type!=="none"){n.mergeArray(s.type,t,"mgt");n.mergeArray(s.color,t,"mgc")}}}},{"../../lib":483}],604:[function(e,t,r){"use strict";var n=e("../../components/colorscale/attributes");var i=e("../../components/colorbar/attributes");var a=e("../../plots/font_attributes");var o=e("../../components/drawing/attributes").dash;var s=e("../../components/drawing");var l=e("./constants");var u=e("../../lib/extend").extendFlat;t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:u({},o,{editType:"style"}),simplify:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:false,editType:"calc"},cliponaxis:{valType:"boolean",dflt:true,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],dflt:"none",editType:"calc"},fillcolor:{valType:"color",editType:"style"},marker:u({symbol:{valType:"enumerated",values:s.symbolList,dflt:"circle",arrayOk:true,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:true,editType:"style"},size:{valType:"number",min:0,dflt:6,arrayOk:true,editType:"calcIfAutorange"},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},colorbar:i,line:u({width:{valType:"number",min:0,arrayOk:true,editType:"style"},editType:"calc"},n("marker.line")),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:true,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:true,editType:"calc"},editType:"calc"},editType:"calc"},n("marker")),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:true,editType:"calc"},textfont:a({editType:"calc",colorEditType:"style",arrayOk:true}),r:{valType:"data_array",editType:"calc"},t:{valType:"data_array",editType:"calc"}}},{"../../components/colorbar/attributes":362,"../../components/colorscale/attributes":368,"../../components/drawing":386,"../../components/drawing/attributes":385,"../../lib/extend":475,"../../plots/font_attributes":555,"./constants":609}],605:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib").isArrayOrTypedArray;var a=e("../../plots/cartesian/axes");var o=e("../../constants/numerical").BADNUM;var s=e("./subtypes");var l=e("./colorscale_calc");var u=e("./arrays_to_calcdata");var f=e("./calc_selection");function c(e,t){var r=a.getFromId(e,t.xaxis||"x");var i=a.getFromId(e,t.yaxis||"y");var s=r.makeCalcdata(t,"x");var c=i.makeCalcdata(t,"y");var d=t._length;var p=new Array(d);var g=v(t,d);h(e,t,r,i,s,c,g);for(var m=0;m<d;m++){p[m]=n(s[m])&&n(c[m])?{x:s[m],y:c[m]}:{x:o,y:o};if(t.ids){p[m].id=String(t.ids[m])}}u(p,t);l(t);f(p,t);e.firstscatter=false;return p}function h(e,t,r,n,i,o,l){var u=t._length;r._minDtick=0;n._minDtick=0;var f={padded:true};var c={padded:true};if(l){f.ppad=c.ppad=l}if((t.fill==="tozerox"||t.fill==="tonextx"&&e.firstscatter)&&(i[0]!==i[u-1]||o[0]!==o[u-1])){f.tozero=true}else if(!(t.error_y||{}).visible&&(["tonexty","tozeroy"].indexOf(t.fill)!==-1||!s.hasMarkers(t)&&!s.hasText(t))){f.padded=false;f.ppad=0}if((t.fill==="tozeroy"||t.fill==="tonexty"&&e.firstscatter)&&(i[0]!==i[u-1]||o[0]!==o[u-1])){c.tozero=true}else if(["tonextx","tozerox"].indexOf(t.fill)!==-1){c.padded=false}a.expand(r,i,f);a.expand(n,o,c)}function v(e,t){if(!s.hasMarkers(e))return;var r=e.marker;var n=1.6*(e.marker.sizeref||1);var o;if(e.marker.sizemode==="area"){o=function(e){return Math.max(Math.sqrt((e||0)/n),3)}}else{o=function(e){return Math.max((e||0)/n,3)}}if(i(r.size)){var l={type:"linear"};a.setConvert(l);var u=l.makeCalcdata(e.marker,"size");var f=new Array(t);for(var c=0;c<t;c++){f[c]=o(u[c])}return f}else{return o(r.size)}}t.exports={calc:c,calcMarkerSize:v,calcAxisExpansion:h}},{"../../constants/numerical":463,"../../lib":483,"../../plots/cartesian/axes":529,"./arrays_to_calcdata":603,"./calc_selection":606,"./colorscale_calc":608,"./subtypes":626,"fast-isnumeric":91}],606:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r){if(n.isArrayOrTypedArray(r.selectedpoints)){n.tagSelected(t,r)}}},{"../../lib":483}],607:[function(e,t,r){"use strict";t.exports=function e(t){for(var r=0;r<t.length;r++){var n=t[r];if(n.type!=="scatter")continue;var i=n.fill;if(i==="none"||i==="toself")continue;n.opacity=undefined;if(i==="tonexty"||i==="tonextx"){for(var a=r-1;a>=0;a--){var o=t[a];if(o.type==="scatter"&&o.xaxis===n.xaxis&&o.yaxis===n.yaxis){o.opacity=undefined;break}}}}}},{}],608:[function(e,t,r){"use strict";var n=e("../../components/colorscale/has_colorscale");var i=e("../../components/colorscale/calc");var a=e("./subtypes");t.exports=function e(t){if(a.hasLines(t)&&n(t,"line")){i(t,t.line.color,"line","c")}if(a.hasMarkers(t)){if(n(t,"marker")){i(t,t.marker.color,"marker","c")}if(n(t,"marker.line")){i(t,t.marker.line.color,"marker.line","c")}}}},{"../../components/colorscale/calc":369,"../../components/colorscale/has_colorscale":375,"./subtypes":626}],609:[function(e,t,r){"use strict";t.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20}},{}],610:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../registry");var a=e("./attributes");var o=e("./constants");var s=e("./subtypes");var l=e("./xy_defaults");var u=e("./marker_defaults");var f=e("./line_defaults");var c=e("./line_shape_defaults");var h=e("./text_defaults");var v=e("./fillcolor_defaults");t.exports=function e(t,r,d,p){function g(e,i){return n.coerce(t,r,a,e,i)}var m=l(t,r,p,g),y=m<o.PTS_LINESONLY?"lines+markers":"lines";if(!m){r.visible=false;return}g("text");g("hovertext");g("mode",y);if(s.hasLines(r)){f(t,r,d,p,g);c(t,r,g);g("connectgaps");g("line.simplify")}if(s.hasMarkers(r)){u(t,r,d,p,g,{gradient:true})}if(s.hasText(r)){h(t,r,p,g)}var b=[];if(s.hasMarkers(r)||s.hasText(r)){g("cliponaxis");g("marker.maxdisplayed");b.push("points")}g("fill");if(r.fill!=="none"){v(t,r,d,g);if(!s.hasLines(r))c(t,r,g)}if(r.fill==="tonext"||r.fill==="toself"){b.push("fills")}g("hoveron",b.join("+")||"points");var x=i.getComponentMethod("errorbars","supplyDefaults");x(t,r,d,{axis:"y"});x(t,r,d,{axis:"x",inherit:"y"});n.coerceSelectionMarkerOpacity(r,g)}},{"../../lib":483,"../../registry":582,"./attributes":604,"./constants":609,"./fillcolor_defaults":612,"./line_defaults":616,"./line_shape_defaults":618,"./marker_defaults":622,"./subtypes":626,"./text_defaults":627,"./xy_defaults":628}],611:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r,a){var o=Array.isArray(a)?function(e){a.push(e)}:function(e){a.text=e};var s=n.extractOption(t,r,"htx","hovertext");if(i(s))return o(s);var l=n.extractOption(t,r,"tx","text");if(i(l))return o(l)};function i(e){return e||e===0}},{"../../lib":483}],612:[function(e,t,r){"use strict";var n=e("../../components/color");var i=e("../../lib").isArrayOrTypedArray;t.exports=function e(t,r,a,o){var s=false;if(r.marker){var l=r.marker.color,u=(r.marker.line||{}).color;if(l&&!i(l)){s=l}else if(u&&!i(u)){s=u}}o("fillcolor",n.addOpacity((r.line||{}).color||s||a,.5))}},{"../../components/color":361,"../../lib":483}],613:[function(e,t,r){"use strict";var n=e("../../components/color");var i=e("./subtypes");t.exports=function e(t,r){var a,o;if(t.mode==="lines"){a=t.line.color;return a&&n.opacity(a)?a:t.fillcolor}else if(t.mode==="none"){return t.fill?t.fillcolor:""}else{var s=r.mcc||(t.marker||{}).color,l=r.mlcc||((t.marker||{}).line||{}).color;o=s&&n.opacity(s)?s:l&&n.opacity(l)&&(r.mlw||((t.marker||{}).line||{}).width)?l:"";if(o){if(n.opacity(o)<.3){return n.addOpacity(o,.3)}else return o}else{a=(t.line||{}).color;return a&&n.opacity(a)&&i.hasLines(t)&&t.line.width?a:t.fillcolor}}}},{"../../components/color":361,"./subtypes":626}],614:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../components/fx");var a=e("../../registry");var o=e("./get_trace_color");var s=e("../../components/color");var l=e("./fill_hover_text");t.exports=function e(t,r,u,f){var c=t.cd;var h=c[0].trace;var v=t.xa;var d=t.ya;var p=v.c2p(r);var g=d.c2p(u);var m=[p,g];var y=h.hoveron||"";var b=h.mode.indexOf("markers")!==-1?3:.5;if(y.indexOf("points")!==-1){var x=function(e){var t=Math.max(3,e.mrc||0);var r=1-1/t;var n=Math.abs(v.c2p(e.x)-p);var i=n<t?r*n/t:n-t+r;return i};var _=function(e){var t=Math.max(3,e.mrc||0);var r=1-1/t;var n=Math.abs(d.c2p(e.y)-g);return n<t?r*n/t:n-t+r};var w=function(e){var t=Math.max(b,e.mrc||0);var r=v.c2p(e.x)-p;var n=d.c2p(e.y)-g;return Math.max(Math.sqrt(r*r+n*n)-t,1-b/t)};var M=i.getDistanceFunction(f,x,_,w);i.getClosest(c,M,t);if(t.index!==false){var A=c[t.index];var T=v.c2p(A.x,true);var k=d.c2p(A.y,true);var E=A.mrc||1;n.extendFlat(t,{color:o(h,A),x0:T-E,x1:T+E,xLabelVal:A.x,y0:k-E,y1:k+E,yLabelVal:A.y,spikeDistance:w(A)});l(A,h,t);a.getComponentMethod("errorbars","hoverInfo")(A,h,t);return[t]}}if(y.indexOf("fills")!==-1&&h._polygons){var S=h._polygons;var L=[];var C=false;var I=Infinity;var P=-Infinity;var O=Infinity;var R=-Infinity;var N,z,D,F,j,B,U,V,H;for(N=0;N<S.length;N++){D=S[N];if(D.contains(m)){C=!C;L.push(D);O=Math.min(O,D.ymin);R=Math.max(R,D.ymax)}}if(C){O=Math.max(O,0);R=Math.min(R,d._length);var q=(O+R)/2;for(N=0;N<L.length;N++){F=L[N].pts;for(z=1;z<F.length;z++){V=F[z-1][1];H=F[z][1];if(V>q!==H>=q){B=F[z-1][0];U=F[z][0];if(H-V){j=B+(U-B)*(q-V)/(H-V);I=Math.min(I,j);P=Math.max(P,j)}}}}I=Math.max(I,0);P=Math.min(P,v._length);var G=s.defaultLine;if(s.opacity(h.fillcolor))G=h.fillcolor;else if(s.opacity((h.line||{}).color)){G=h.line.color}n.extendFlat(t,{distance:t.maxHoverDistance,x0:I,x1:P,y0:q,y1:q,color:G});delete t.index;if(h.text&&!Array.isArray(h.text)){t.text=String(h.text)}else t.text=h.name;return[t]}}}},{"../../components/color":361,"../../components/fx":403,"../../lib":483,"../../registry":582,"./fill_hover_text":611,"./get_trace_color":613}],615:[function(e,t,r){"use strict";var n={};var i=e("./subtypes");n.hasLines=i.hasLines;n.hasMarkers=i.hasMarkers;n.hasText=i.hasText;n.isBubble=i.isBubble;n.attributes=e("./attributes");n.supplyDefaults=e("./defaults");n.cleanData=e("./clean_data");n.calc=e("./calc").calc;n.arraysToCalcdata=e("./arrays_to_calcdata");n.plot=e("./plot");n.colorbar=e("./marker_colorbar");n.style=e("./style").style;n.styleOnSelect=e("./style").styleOnSelect;n.hoverPoints=e("./hover");n.selectPoints=e("./select");n.animatable=true;n.moduleType="trace";n.name="scatter";n.basePlotModule=e("../../plots/cartesian");n.categories=["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"];n.meta={};t.exports=n},{"../../plots/cartesian":540,"./arrays_to_calcdata":603,"./attributes":604,"./calc":605,"./clean_data":607,"./defaults":610,"./hover":614,"./marker_colorbar":621,"./plot":623,"./select":624,"./style":625,"./subtypes":626}],616:[function(e,t,r){"use strict";var n=e("../../lib").isArrayOrTypedArray;var i=e("../../components/colorscale/has_colorscale");var a=e("../../components/colorscale/defaults");t.exports=function e(t,r,o,s,l,u){var f=(t.marker||{}).color;l("line.color",o);if(i(t,"line")){a(t,r,s,l,{prefix:"line.",cLetter:"c"})}else{var c=(n(f)?false:f)||o;l("line.color",c)}l("line.width");if(!(u||{}).noDash)l("line.dash")}},{"../../components/colorscale/defaults":371,"../../components/colorscale/has_colorscale":375,"../../lib":483}],617:[function(e,t,r){"use strict";var n=e("../../constants/numerical").BADNUM;var i=e("../../lib");var a=i.segmentsIntersect;var o=i.constrain;var s=e("./constants");t.exports=function e(t,r){var l=r.xaxis;var u=r.yaxis;var f=r.simplify;var c=r.connectGaps;var h=r.baseTolerance;var v=r.shape;var d=v==="linear";var p=[];var g=s.minTolerance;var m=new Array(t.length);var y=0;var b;var x,_,w,M;var A;var T;var k;var E;var S,L,C,I;var P,O,R;if(!f){h=g=-1}function N(e){var r=t[e];if(!r)return false;var i=l.c2p(r.x);var a=u.c2p(r.y);if(i===n||a===n)return r.intoCenter||false;return[i,a]}function z(e,t,r,n){var i=r-e;var a=n-t;var o=.5-e;var s=.5-t;var l=i*i+a*a;var u=i*o+a*s;if(u>0&&u<l){var f=o*a-s*i;if(f*f<l)return true}}var D,F;function j(e,t){var r=e[0]/l._length;var n=e[1]/u._length;var i=Math.max(0,-r,r-1,-n,n-1);if(i&&D!==undefined&&z(r,n,D,F)){i=0}if(i&&t&&z(r,n,t[0]/l._length,t[1]/u._length)){i=0}return(1+s.toleranceGrowth*i)*h}function B(e,t){var r=e[0]-t[0];var n=e[1]-t[1];return Math.sqrt(r*r+n*n)}var U=s.maxScreensAway;var V=-l._length*U;var H=l._length*(1+U);var q=-u._length*U;var G=u._length*(1+U);var W=[[V,q,H,q],[H,q,H,G],[H,G,V,G],[V,G,V,q]];var X,Y,Z,Q,K,J;function $(e,t){var r=[];var n=0;for(var i=0;i<4;i++){var o=W[i];var s=a(e[0],e[1],t[0],t[1],o[0],o[1],o[2],o[3]);if(s&&(!n||Math.abs(s.x-r[0][0])>1||Math.abs(s.y-r[0][1])>1)){s=[s.x,s.y];if(n&&B(s,e)<B(r[0],e))r.unshift(s);else r.push(s);n++}}return r}function ee(e){if(e[0]<V||e[0]>H||e[1]<q||e[1]>G){return[o(e[0],V,H),o(e[1],q,G)]}}function te(e,t){if(e[0]===t[0]&&(e[0]===V||e[0]===H))return true;if(e[1]===t[1]&&(e[1]===q||e[1]===G))return true}function re(e,t){var r=[];var n=ee(e);var i=ee(t);if(n&&i&&te(n,i))return r;if(n)r.push(n);if(i)r.push(i);return r}function ne(e,t,r){return function(n,a){var o=ee(n);var s=ee(a);var l=[];if(o&&s&&te(o,s))return l;if(o)l.push(o);if(s)l.push(s);var u=2*i.constrain((n[e]+a[e])/2,t,r)-((o||n)[e]+(s||a)[e]);if(u){var f;if(o&&s){f=u>0===o[e]>s[e]?o:s}else f=o||s;f[e]+=u}return l}}var ie;if(v==="linear"||v==="spline"){ie=$}else if(v==="hv"||v==="vh"){ie=re}else if(v==="hvh")ie=ne(0,V,H);else if(v==="vhv")ie=ne(1,q,G);function ae(e,t){var r=t[0]-e[0];var n=(t[1]-e[1])/r;var i=(e[1]*t[0]-t[1]*e[0])/r;if(i>0)return[n>0?V:H,G];else return[n>0?H:V,q]}function oe(e){var t=e[0];var r=e[1];var n=t===m[y-1][0];var i=r===m[y-1][1];if(n&&i)return;if(y>1){var a=t===m[y-2][0];var o=r===m[y-2][1];if(n&&(t===V||t===H)&&a){if(o)y--;else m[y-1]=e}else if(i&&(r===q||r===G)&&o){if(a)y--;else m[y-1]=e}else m[y++]=e}else m[y++]=e}function se(e){if(m[y-1][0]!==e[0]&&m[y-1][1]!==e[1]){oe([Z,Q])}oe(e);K=null;Z=Q=0}function le(e){D=e[0]/l._length;F=e[1]/u._length;X=e[0]<V?V:e[0]>H?H:0;Y=e[1]<q?q:e[1]>G?G:0;if(X||Y){if(!y){m[y++]=[X||e[0],Y||e[1]]}else if(K){var t=ie(K,e);if(t.length>1){se(t[0]);m[y++]=t[1]}}else{J=ie(m[y-1],e)[0];m[y++]=J}var r=m[y-1];if(X&&Y&&(r[0]!==X||r[1]!==Y)){if(K){if(Z!==X&&Q!==Y){if(Z&&Q){oe(ae(K,e))}else{oe([Z||X,Q||Y])}}else if(Z&&Q){oe([Z,Q])}}oe([X,Y])}else if(Z-X&&Q-Y){oe([X||Z,Y||Q])}K=e;Z=X;Q=Y}else{if(K){se(ie(K,e)[0])}m[y++]=e}}for(b=0;b<t.length;b++){x=N(b);if(!x)continue;y=0;K=null;le(x);for(b++;b<t.length;b++){w=N(b);if(!w){if(c)continue;else break}if(!d){le(w);continue}var ue=N(b+1);S=B(w,x);if(S<j(w,ue)*g)continue;k=[(w[0]-x[0])/S,(w[1]-x[1])/S];M=x;L=S;C=P=O=0;T=false;_=w;for(b++;b<t.length;b++){A=ue;ue=N(b+1);if(!A){if(c)continue;else break}E=[A[0]-x[0],A[1]-x[1]];R=E[0]*k[1]-E[1]*k[0];P=Math.min(P,R);O=Math.max(O,R);if(O-P>j(A,ue))break;_=A;I=E[0]*k[0]+E[1]*k[1];if(I>L){L=I;w=A;T=false}else if(I<C){C=I;M=A;T=true}}if(T){le(w);if(_!==M)le(M)}else{if(M!==x)le(M);if(_!==w)le(w)}le(_);if(b>=t.length||!A)break;le(A);x=A}if(K)oe([Z||K[0],Q||K[1]]);p.push(m.slice(0,y))}return p}},{"../../constants/numerical":463,"../../lib":483,"./constants":609}],618:[function(e,t,r){"use strict";t.exports=function e(t,r,n){var i=n("line.shape");if(i==="spline")n("line.smoothing")}},{}],619:[function(e,t,r){"use strict";t.exports=function e(t,r,n){var i,a;var o=null;for(a=0;a<n.length;++a){i=n[a][0].trace;if(i.visible===true){i._nexttrace=null;if(["tonextx","tonexty","tonext"].indexOf(i.fill)!==-1){i._prevtrace=o;if(o){o._nexttrace=i}}o=i}else{i._prevtrace=i._nexttrace=null}}}},{}],620:[function(e,t,r){"use strict";var n=e("fast-isnumeric");t.exports=function e(t){var r=t.marker,i=r.sizeref||1,a=r.sizemin||0;var o=r.sizemode==="area"?function(e){return Math.sqrt(e/i)}:function(e){return e/i};return function(e){var t=o(e/2);return n(t)&&t>0?Math.max(t,a):0}}},{"fast-isnumeric":91}],621:[function(e,t,r){"use strict";t.exports={container:"marker",min:"cmin",max:"cmax"}},{}],622:[function(e,t,r){"use strict";var n=e("../../components/color");var i=e("../../components/colorscale/has_colorscale");var a=e("../../components/colorscale/defaults");var o=e("./subtypes");t.exports=function e(t,r,s,l,u,f){var c=o.isBubble(t),h=(t.line||{}).color,v;f=f||{};if(h)s=h;u("marker.symbol");u("marker.opacity",c?.7:1);u("marker.size");u("marker.color",s);if(i(t,"marker")){a(t,r,l,u,{prefix:"marker.",cLetter:"c"})}if(!f.noSelect){u("selected.marker.color");u("unselected.marker.color");u("selected.marker.size");u("unselected.marker.size")}if(!f.noLine){if(h&&!Array.isArray(h)&&r.marker.color!==h){v=h}else if(c)v=n.background;else v=n.defaultLine;u("marker.line.color",v);if(i(t,"marker.line")){a(t,r,l,u,{prefix:"marker.line.",cLetter:"c"})}u("marker.line.width",c?1:0)}if(c){u("marker.sizeref");u("marker.sizemin");u("marker.sizemode")}if(f.gradient){var d=u("marker.gradient.type");if(d!=="none"){u("marker.gradient.color")}}}},{"../../components/color":361,"../../components/colorscale/defaults":371,"../../components/colorscale/has_colorscale":375,"./subtypes":626}],623:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../lib");var o=e("../../components/drawing");var s=e("./subtypes");var l=e("./line_points");var u=e("./link_traces");var f=e("../../lib/polygon").tester;t.exports=function e(t,r,i,a,o,s){var l,f,v,d;var p=!o;var g=!!o&&o.duration>0;v=a.selectAll("g.trace").data(i,function(e){return e[0].trace.uid});v.enter().append("g").attr("class",function(e){return"trace scatter trace"+e[0].trace.uid}).style("stroke-miterlimit",2);u(t,r,i);c(t,a,r);for(l=0,f={};l<i.length;l++){f[i[l][0].trace.uid]=l}a.selectAll("g.trace").sort(function(e,t){var r=f[e[0].trace.uid];var n=f[t[0].trace.uid];return r>n?1:-1});if(g){if(s){d=s()}var m=n.transition().duration(o.duration).ease(o.easing).each("end",function(){d&&d()}).each("interrupt",function(){d&&d()});m.each(function(){a.selectAll("g.trace").each(function(e,n){h(t,n,r,e,i,this,o)})})}else{a.selectAll("g.trace").each(function(e,n){h(t,n,r,e,i,this,o)})}if(p){v.exit().remove()}a.selectAll("path:not([d])").remove()};function c(e,t,r){var i;t.selectAll("g.trace").each(function(e){var t=n.select(this);i=e[0].trace;if(i._nexttrace){i._nextFill=t.select(".js-fill.js-tonext");if(!i._nextFill.size()){var a=":first-child";if(t.select(".js-fill.js-tozero").size()){a+=" + *"}i._nextFill=t.insert("path",a).attr("class","js-fill js-tonext")}}else{t.selectAll(".js-fill.js-tonext").remove();i._nextFill=null}if(i.fill&&(i.fill.substr(0,6)==="tozero"||i.fill==="toself"||i.fill.substr(0,2)==="to"&&!i._prevtrace)){i._ownFill=t.select(".js-fill.js-tozero");if(!i._ownFill.size()){i._ownFill=t.insert("path",":first-child").attr("class","js-fill js-tozero")}}else{t.selectAll(".js-fill.js-tozero").remove();i._ownFill=null}t.selectAll(".js-fill").call(o.setClipUrl,r.layerClipId)})}function h(e,t,r,u,c,h,d){var p,g;v(e,t,r,u,c);var m=!!d&&d.duration>0;function y(e){return m?e.transition():e}var b=r.xaxis,x=r.yaxis;var _=u[0].trace,w=_.line,M=n.select(h);i.getComponentMethod("errorbars","plot")(M,r,d);if(_.visible!==true)return;y(M).style("opacity",_.opacity);var A,T;var k=_.fill.charAt(_.fill.length-1);if(k!=="x"&&k!=="y")k="";if(!r.isRangePlot)u[0].node3=M;var E="";var S=[];var L=_._prevtrace;if(L){E=L._prevRevpath||"";T=L._nextFill;S=L._polygons}var C,I,P="",O="",R,N,z,D,F,j,B;var U=[],V=a.noop;A=_._ownFill;if(s.hasLines(_)||_.fill!=="none"){if(T){T.datum(u)}if(["hv","vh","hvh","vhv"].indexOf(w.shape)!==-1){R=o.steps(w.shape);N=o.steps(w.shape.split("").reverse().join(""))}else if(w.shape==="spline"){R=N=function(e){var t=e[e.length-1];if(e.length>1&&e[0][0]===t[0]&&e[0][1]===t[1]){return o.smoothclosed(e.slice(1),w.smoothing)}else{return o.smoothopen(e,w.smoothing)}}}else{R=N=function(e){return"M"+e.join("L")}}z=function(e){return N(e.reverse())};U=l(u,{xaxis:b,yaxis:x,connectGaps:_.connectgaps,baseTolerance:Math.max(w.width||1,3)/4,shape:w.shape,simplify:w.simplify});B=_._polygons=new Array(U.length);for(g=0;g<U.length;g++){_._polygons[g]=f(U[g])}if(U.length){D=U[0][0];F=U[U.length-1];j=F[F.length-1]}V=function(e){return function(t){C=R(t);I=z(t);if(!P){P=C;O=I}else if(k){P+="L"+C.substr(1);O=I+("L"+O.substr(1))}else{P+="Z"+C;O=I+"Z"+O}if(s.hasLines(_)&&t.length>1){var r=n.select(this);r.datum(u);if(e){y(r.style("opacity",0).attr("d",C).call(o.lineGroupStyle)).style("opacity",1)}else{var i=y(r);i.attr("d",C);o.singleLineStyle(u,i)}}}}}var H=M.selectAll(".js-line").data(U);y(H.exit()).style("opacity",0).remove();H.each(V(false));H.enter().append("path").classed("js-line",true).style("vector-effect","non-scaling-stroke").call(o.lineGroupStyle).each(V(true));o.setClipUrl(H,r.layerClipId);function q(e){y(e).attr("d","M0,0Z")}if(U.length){if(A){if(D&&j){if(k){if(k==="y"){D[1]=j[1]=x.c2p(0,true)}else if(k==="x"){D[0]=j[0]=b.c2p(0,true)}y(A).attr("d","M"+j+"L"+D+"L"+P.substr(1)).call(o.singleFillStyle)}else{y(A).attr("d",P+"Z").call(o.singleFillStyle)}}}else if(T){if(_.fill.substr(0,6)==="tonext"&&P&&E){if(_.fill==="tonext"){y(T).attr("d",P+"Z"+E+"Z").call(o.singleFillStyle)}else{y(T).attr("d",P+"L"+E.substr(1)+"Z").call(o.singleFillStyle)}_._polygons=_._polygons.concat(S)}else{q(T);_._polygons=null}}_._prevRevpath=O;_._prevPolygons=B}else{if(A)q(A);else if(T)q(T);_._polygons=_._prevRevpath=_._prevPolygons=null}function G(e){return e.filter(function(e){return e.vis})}function W(e){return e.id}function X(e){if(e.ids){return W}}function Y(){return false}function Z(t){var i,l,u;var f=t[0].trace;var c=n.select(this);var h=s.hasMarkers(f);var v=s.hasText(f);var d=X(f);var p=Y;var g=Y;if(h){p=f.marker.maxdisplayed||f._needsCull?G:a.identity}if(v){g=f.marker.maxdisplayed||f._needsCull?G:a.identity}l=c.selectAll("path.point");i=l.data(p,d);var _=i.enter().append("path").classed("point",true);if(m){_.call(o.pointStyle,f,e).call(o.translatePoints,b,x).style("opacity",0).transition().style("opacity",1)}i.order();var w;if(h){w=o.makePointStyleFns(f)}i.each(function(t){var i=n.select(this);var a=y(i);u=o.translatePoint(t,a,b,x);if(u){o.singlePointStyle(t,a,f,w,e);if(r.layerClipId){o.hideOutsideRangePoint(t,a,b,x,f.xcalendar,f.ycalendar)}if(f.customdata){i.classed("plotly-customdata",t.data!==null&&t.data!==undefined)}}else{a.remove()}});if(m){i.exit().transition().style("opacity",0).remove()}else{i.exit().remove()}l=c.selectAll("g");i=l.data(g,d);i.enter().append("g").classed("textpoint",true).append("text");i.order();i.each(function(e){var t=n.select(this);var i=y(t.select("text"));u=o.translatePoint(e,i,b,x);if(u){if(r.layerClipId){o.hideOutsideRangePoint(e,t,b,x,f.xcalendar,f.ycalendar)}}else{t.remove()}});i.selectAll("text").call(o.textPointStyle,f,e).each(function(e){var t=b.c2p(e.x);var r=x.c2p(e.y);n.select(this).selectAll("tspan.line").each(function(){y(n.select(this)).attr({x:t,y:r})})});i.exit().remove()}var Q=M.selectAll(".points");p=Q.data([u]);Q.each(Z);p.enter().append("g").classed("points",true).each(Z);p.exit().remove();p.each(function(e){var t=e[0].trace.cliponaxis===false;o.setClipUrl(n.select(this),t?null:r.layerClipId)})}function v(e,t,r,i,o){var l=r.xaxis,u=r.yaxis,f=n.extent(a.simpleMap(l.range,l.r2c)),c=n.extent(a.simpleMap(u.range,u.r2c));var h=i[0].trace;if(!s.hasMarkers(h))return;var v=h.marker.maxdisplayed;if(v===0)return;var d=i.filter(function(e){return e.x>=f[0]&&e.x<=f[1]&&e.y>=c[0]&&e.y<=c[1]}),p=Math.ceil(d.length/v),g=0;o.forEach(function(e,r){var n=e[0].trace;if(s.hasMarkers(n)&&n.marker.maxdisplayed>0&&r<t){g++}});var m=Math.round(g*p/3+Math.floor(g/3)*p/7.1);i.forEach(function(e){delete e.vis});d.forEach(function(e,t){if(Math.round((t+m)%p)===0)e.vis=true})}},{"../../components/drawing":386,"../../lib":483,"../../lib/polygon":495,"../../registry":582,"./line_points":617,"./link_traces":619,"./subtypes":626,d3:81}],624:[function(e,t,r){"use strict";var n=e("./subtypes");t.exports=function e(t,r){var i=t.cd,a=t.xaxis,o=t.yaxis,s=[],l=i[0].trace,u,f,c,h;var v=!n.hasMarkers(l)&&!n.hasText(l);if(v)return[];if(r===false){for(u=0;u<i.length;u++){i[u].selected=0}}else{for(u=0;u<i.length;u++){f=i[u];c=a.c2p(f.x);h=o.c2p(f.y);if(r.contains([c,h])){s.push({pointNumber:u,x:a.c2d(f.x),y:o.c2d(f.y)});f.selected=1}else{f.selected=0}}}return s}},{"./subtypes":626}],625:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../components/drawing");var a=e("../../registry");function o(e,t){var r=t?t[0].node3:n.select(e).selectAll("g.trace.scatter");r.style("opacity",function(e){return e[0].trace.opacity});r.selectAll("g.points").each(function(t){var r=n.select(this);var i=t.trace||t[0].trace;s(r,i,e)});r.selectAll("g.trace path.js-line").call(i.lineGroupStyle);r.selectAll("g.trace path.js-fill").call(i.fillGroupStyle);a.getComponentMethod("errorbars","style")(r)}function s(e,t,r){i.pointStyle(e.selectAll("path.point"),t,r);i.textPointStyle(e.selectAll("text"),t,r)}function l(e,t){var r=t[0].node3;var n=t[0].trace;if(n.selectedpoints){i.selectedPointStyle(r.selectAll("path.point"),n);i.selectedTextStyle(r.selectAll("text"),n)}else{s(r,n,e)}}t.exports={style:o,stylePoints:s,styleOnSelect:l}},{"../../components/drawing":386,"../../registry":582,d3:81}],626:[function(e,t,r){"use strict";var n=e("../../lib");t.exports={hasLines:function(e){return e.visible&&e.mode&&e.mode.indexOf("lines")!==-1},hasMarkers:function(e){return e.visible&&(e.mode&&e.mode.indexOf("markers")!==-1||e.type==="splom")},hasText:function(e){return e.visible&&e.mode&&e.mode.indexOf("text")!==-1},isBubble:function(e){return n.isPlainObject(e.marker)&&n.isArrayOrTypedArray(e.marker.size)}}},{"../../lib":483}],627:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function(e,t,r,i,a){a=a||{};i("textposition");n.coerceFont(i,"textfont",r.font);if(!a.noSelect){i("selected.textfont.color");i("unselected.textfont.color")}}},{"../../lib":483}],628:[function(e,t,r){"use strict";var n=e("../../registry");t.exports=function e(t,r,i,a){var o,s=a("x"),l=a("y");var u=n.getComponentMethod("calendars","handleTraceDefaults");u(t,r,["x","y"],i);if(s){if(l){o=Math.min(s.length,l.length)}else{o=s.length;a("y0");a("dy")}}else{if(!l)return 0;o=r.y.length;a("x0");a("dx")}r._length=o;return o}},{"../../registry":582}],629:[function(e,t,r){"use strict";var n=e("../scatter/attributes");var i=e("../../components/colorscale/attributes");var a=e("../../plots/attributes");var o=e("../../constants/gl3d_dashes");var s=e("../../constants/gl3d_markers");var l=e("../../lib/extend").extendFlat;var u=e("../../plot_api/edit_types").overrideAll;var f=n.line;var c=n.marker;var h=c.line;function v(e){return{show:{valType:"boolean",dflt:false},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var d=t.exports=u({x:n.x,y:n.y,z:{valType:"data_array"},text:l({},n.text,{}),hovertext:l({},n.hovertext,{}),mode:l({},n.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:v("x"),y:v("y"),z:v("z")},connectgaps:n.connectgaps,line:l({width:f.width,dash:{valType:"enumerated",values:Object.keys(o),dflt:"solid"}},i("line")),marker:l({symbol:{valType:"enumerated",values:Object.keys(s),dflt:"circle",arrayOk:true},size:l({},c.size,{dflt:8}),sizeref:c.sizeref,sizemin:c.sizemin,sizemode:c.sizemode,opacity:l({},c.opacity,{arrayOk:false}),colorbar:c.colorbar,line:l({width:l({},h.width,{arrayOk:false})},i("marker.line"))},i("marker")),textposition:l({},n.textposition,{dflt:"top center"}),textfont:n.textfont,hoverinfo:l({},a.hoverinfo)},"calc","nested");d.x.editType=d.y.editType=d.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":368,"../../constants/gl3d_dashes":460,"../../constants/gl3d_markers":461,"../../lib/extend":475,"../../plot_api/edit_types":512,"../../plots/attributes":526,"../scatter/attributes":604}],630:[function(e,t,r){"use strict";var n=e("../scatter/arrays_to_calcdata");var i=e("../scatter/colorscale_calc");t.exports=function e(t,r){var a=[{x:false,y:false,trace:r,t:{}}];n(a,r);i(r);return a}},{"../scatter/arrays_to_calcdata":603,"../scatter/colorscale_calc":608}],631:[function(e,t,r){"use strict";var n=e("../../registry");function i(e,t,r){if(!t||!t.visible)return null;var i=n.getComponentMethod("errorbars","makeComputeError")(t);var a=new Array(e.length);for(var o=0;o<e.length;o++){var s=i(+e[o],o);a[o]=[-s[0]*r,s[1]*r]}return a}function a(e){for(var t=0;t<e.length;t++){if(e[t])return e[t].length}return 0}function o(e,t){var r=[i(e.x,e.error_x,t[0]),i(e.y,e.error_y,t[1]),i(e.z,e.error_z,t[2])];var n=a(r);if(n===0)return null;var o=new Array(n);for(var s=0;s<n;s++){var l=[[0,0,0],[0,0,0]];for(var u=0;u<3;u++){if(r[u]){for(var f=0;f<2;f++){l[f][u]=r[u][s][f]}}}o[s]=l}return o}t.exports=o},{"../../registry":582}],632:[function(e,t,r){"use strict";var n=e("gl-line3d");var i=e("gl-scatter3d");var a=e("gl-error3d");var o=e("gl-mesh3d");var s=e("delaunay-triangulate");var l=e("../../lib");var u=e("../../lib/str2rgbarray");var f=e("../../lib/gl_format_color").formatColor;var c=e("../scatter/make_bubble_size_func");var h=e("../../constants/gl3d_dashes");var v=e("../../constants/gl3d_markers");var d=e("./calc_errors");function p(e,t){this.scene=e;this.uid=t;this.linePlot=null;this.scatterPlot=null;this.errorBars=null;this.textMarkers=null;this.delaunayMesh=null;this.color=null;this.mode="";this.dataPoints=[];this.axesBounds=[[-Infinity,-Infinity,-Infinity],[Infinity,Infinity,Infinity]];this.textLabels=null;this.data=null}var g=p.prototype;g.handlePick=function(e){if(e.object&&(e.object===this.linePlot||e.object===this.delaunayMesh||e.object===this.textMarkers||e.object===this.scatterPlot)){var t=e.index=e.data.index;if(e.object.highlight){e.object.highlight(null)}if(this.scatterPlot){e.object=this.scatterPlot;this.scatterPlot.highlight(e.data)}e.textLabel="";if(this.textLabels){if(Array.isArray(this.textLabels)){if(this.textLabels[t]||this.textLabels[t]===0){e.textLabel=this.textLabels[t]}}else{e.textLabel=this.textLabels}}e.traceCoordinate=[this.data.x[t],this.data.y[t],this.data.z[t]];return true}};function m(e,t,r){var n=(r+1)%3;var i=(r+2)%3;var a=[];var o=[];var l;for(l=0;l<e.length;++l){var u=e[l];if(isNaN(u[n])||!isFinite(u[n])||isNaN(u[i])||!isFinite(u[i])){continue}a.push([u[n],u[i]]);o.push(l)}var f=s(a);for(l=0;l<f.length;++l){var c=f[l];for(var h=0;h<c.length;++h){c[h]=o[c[h]]}}return{positions:e,cells:f,meshColor:t}}function y(e){var t=[0,0,0],r=[[0,0,0],[0,0,0],[0,0,0]],n=[0,0,0];for(var i=0;i<3;i++){var a=e[i];if(a&&a.copy_zstyle!==false)a=e[2];if(!a)continue;t[i]=a.width/2;r[i]=u(a.color);n=a.thickness}return{capSize:t,color:r,lineWidth:n}}function b(e){var t=[0,0];if(Array.isArray(e))return[0,-1];if(e.indexOf("bottom")>=0)t[1]+=1;if(e.indexOf("top")>=0)t[1]-=1;if(e.indexOf("left")>=0)t[0]-=1;if(e.indexOf("right")>=0)t[0]+=1;return t}function x(e,t){return t(e*4)}function _(e){return v[e]}function w(e,t,r,n,i){var a=null;if(l.isArrayOrTypedArray(e)){a=[];for(var o=0;o<t;o++){if(e[o]===undefined)a[o]=n;else a[o]=r(e[o],i)}}else a=r(e,l.identity);return a}function M(e,t){var r,n,i=[],a=e.fullSceneLayout,o=e.dataScale,s=a.xaxis,h=a.yaxis,v=a.zaxis,p=t.marker,g=t.line,m,M=t.x||[],A,T=t.y||[],k,E=t.z||[],S=M.length,L=t.xcalendar,C=t.ycalendar,I=t.zcalendar,P;for(n=0;n<S;n++){m=s.d2l(M[n],0,L)*o[0];A=h.d2l(T[n],0,C)*o[1];k=v.d2l(E[n],0,I)*o[2];i[n]=[m,A,k]}if(Array.isArray(t.text))P=t.text;else if(t.text!==undefined){P=new Array(S);for(n=0;n<S;n++)P[n]=t.text}r={position:i,mode:t.mode,text:P};if("line"in t){r.lineColor=f(g,1,S);r.lineWidth=g.width;r.lineDashes=g.dash}if("marker"in t){var O=c(t);r.scatterColor=f(p,1,S);r.scatterSize=w(p.size,S,x,20,O);r.scatterMarker=w(p.symbol,S,_,"\u25cf");r.scatterLineWidth=p.line.width;r.scatterLineColor=f(p.line,1,S);r.scatterAngle=0}if("textposition"in t){r.textOffset=b(t.textposition);r.textColor=f(t.textfont,1,S);r.textSize=w(t.textfont.size,S,l.identity,12);r.textFont=t.textfont.family;r.textAngle=0}var R=["x","y","z"];r.project=[false,false,false];r.projectScale=[1,1,1];r.projectOpacity=[1,1,1];for(n=0;n<3;++n){var N=t.projection[R[n]];if(r.project[n]=N.show){r.projectOpacity[n]=N.opacity;r.projectScale[n]=N.scale}}r.errorBounds=d(t,o);var z=y([t.error_x,t.error_y,t.error_z]);r.errorColor=z.color;r.errorLineWidth=z.lineWidth;r.errorCapSize=z.capSize;r.delaunayAxis=t.surfaceaxis;r.delaunayColor=u(t.surfacecolor);return r}function A(e){if(Array.isArray(e)){var t=e[0];if(Array.isArray(t))e=t;return"rgb("+e.slice(0,3).map(function(e){return Math.round(e*255)})+")"}return null}g.update=function(e){var t=this.scene.glplot.gl,r,s,l,u,f=h.solid;this.data=e;var c=M(this.scene,e);if("mode"in c){this.mode=c.mode}if("lineDashes"in c){if(c.lineDashes in h){f=h[c.lineDashes]}}this.color=A(c.scatterColor)||A(c.lineColor);this.dataPoints=c.position;r={gl:t,position:c.position,color:c.lineColor,lineWidth:c.lineWidth||1,dashes:f[0],dashScale:f[1],opacity:e.opacity,connectGaps:e.connectgaps};if(this.mode.indexOf("lines")!==-1){if(this.linePlot)this.linePlot.update(r);else{this.linePlot=n(r);this.linePlot._trace=this;this.scene.glplot.add(this.linePlot)}}else if(this.linePlot){this.scene.glplot.remove(this.linePlot);this.linePlot.dispose();this.linePlot=null}var v=e.opacity;if(e.marker&&e.marker.opacity)v*=e.marker.opacity;s={gl:t,position:c.position,color:c.scatterColor,size:c.scatterSize,glyph:c.scatterMarker,opacity:v,orthographic:true,lineWidth:c.scatterLineWidth,lineColor:c.scatterLineColor,project:c.project,projectScale:c.projectScale,projectOpacity:c.projectOpacity};if(this.mode.indexOf("markers")!==-1){if(this.scatterPlot)this.scatterPlot.update(s);else{this.scatterPlot=i(s);this.scatterPlot._trace=this;this.scatterPlot.highlightScale=1;this.scene.glplot.add(this.scatterPlot)}}else if(this.scatterPlot){this.scene.glplot.remove(this.scatterPlot);this.scatterPlot.dispose();this.scatterPlot=null}u={gl:t,position:c.position,glyph:c.text,color:c.textColor,size:c.textSize,angle:c.textAngle,alignment:c.textOffset,font:c.textFont,orthographic:true,lineWidth:0,project:false,opacity:e.opacity};this.textLabels=e.hovertext||e.text;if(this.mode.indexOf("text")!==-1){if(this.textMarkers)this.textMarkers.update(u);else{this.textMarkers=i(u);this.textMarkers._trace=this;this.textMarkers.highlightScale=1;this.scene.glplot.add(this.textMarkers)}}else if(this.textMarkers){this.scene.glplot.remove(this.textMarkers);this.textMarkers.dispose();this.textMarkers=null}l={gl:t,position:c.position,color:c.errorColor,error:c.errorBounds,lineWidth:c.errorLineWidth,capSize:c.errorCapSize,opacity:e.opacity};if(this.errorBars){if(c.errorBounds){this.errorBars.update(l)}else{this.scene.glplot.remove(this.errorBars);this.errorBars.dispose();this.errorBars=null}}else if(c.errorBounds){this.errorBars=a(l);this.errorBars._trace=this;this.scene.glplot.add(this.errorBars)}if(c.delaunayAxis>=0){var d=m(c.position,c.delaunayColor,c.delaunayAxis);d.opacity=e.opacity;if(this.delaunayMesh){this.delaunayMesh.update(d)}else{d.gl=t;this.delaunayMesh=o(d);this.delaunayMesh._trace=this;this.scene.glplot.add(this.delaunayMesh)}}else if(this.delaunayMesh){this.scene.glplot.remove(this.delaunayMesh);this.delaunayMesh.dispose();this.delaunayMesh=null}};g.dispose=function(){if(this.linePlot){this.scene.glplot.remove(this.linePlot);this.linePlot.dispose()}if(this.scatterPlot){this.scene.glplot.remove(this.scatterPlot);this.scatterPlot.dispose()}if(this.errorBars){this.scene.glplot.remove(this.errorBars);this.errorBars.dispose()}if(this.textMarkers){this.scene.glplot.remove(this.textMarkers);this.textMarkers.dispose()}if(this.delaunayMesh){this.scene.glplot.remove(this.delaunayMesh);this.delaunayMesh.dispose()}};function T(e,t){var r=new p(e,t.uid);r.update(t);return r}t.exports=T},{"../../constants/gl3d_dashes":460,"../../constants/gl3d_markers":461,"../../lib":483,"../../lib/gl_format_color":480,"../../lib/str2rgbarray":505,"../scatter/make_bubble_size_func":620,"./calc_errors":631,"delaunay-triangulate":83,"gl-error3d":111,"gl-line3d":116,"gl-mesh3d":139,"gl-scatter3d":145}],633:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");var a=e("../scatter/subtypes");var o=e("../scatter/marker_defaults");var s=e("../scatter/line_defaults");var l=e("../scatter/text_defaults");var u=e("./attributes");t.exports=function e(t,r,c,h){function v(e,n){return i.coerce(t,r,u,e,n)}var d=f(t,r,v,h);if(!d){r.visible=false;return}v("text");v("hovertext");v("mode");if(a.hasLines(r)){v("connectgaps");s(t,r,c,h,v)}if(a.hasMarkers(r)){o(t,r,c,h,v,{noSelect:true})}if(a.hasText(r)){l(t,r,h,v,{noSelect:true})}var p=(r.line||{}).color,g=(r.marker||{}).color;if(v("surfaceaxis")>=0)v("surfacecolor",p||g);var m=["x","y","z"];for(var y=0;y<3;++y){var b="projection."+m[y];if(v(b+".show")){v(b+".opacity");v(b+".scale")}}var x=n.getComponentMethod("errorbars","supplyDefaults");x(t,r,c,{axis:"z"});x(t,r,c,{axis:"y",inherit:"z"});x(t,r,c,{axis:"x",inherit:"z"})};function f(e,t,r,i){var a=0,o=r("x"),s=r("y"),l=r("z");var u=n.getComponentMethod("calendars","handleTraceDefaults");u(e,t,["x","y","z"],i);if(o&&s&&l){a=Math.min(o.length,s.length,l.length);t._length=t._xlength=t._ylength=t._zlength=a}return a}},{"../../lib":483,"../../registry":582,"../scatter/line_defaults":616,"../scatter/marker_defaults":622,"../scatter/subtypes":626,"../scatter/text_defaults":627,"./attributes":629}],634:[function(e,t,r){"use strict";var n={};n.plot=e("./convert");n.attributes=e("./attributes");n.markerSymbols=e("../../constants/gl3d_markers");n.supplyDefaults=e("./defaults");n.colorbar=e("../scatter/marker_colorbar");n.calc=e("./calc");n.moduleType="trace";n.name="scatter3d";n.basePlotModule=e("../../plots/gl3d");n.categories=["gl3d","symbols","showLegend"];n.meta={};t.exports=n},{"../../constants/gl3d_markers":461,"../../plots/gl3d":559,"../scatter/marker_colorbar":621,"./attributes":629,"./calc":630,"./convert":632,"./defaults":633}],635:[function(e,t,r){"use strict";var n=e("../../components/colorscale/attributes");var i=e("../../components/colorbar/attributes");var a=e("../mesh3d/attributes");var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;var l={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"}};s(l,n("",{colorAttr:"u/v/w norm",showScaleDflt:true,editTypeOverride:"calc"}),{colorbar:i});var u=["opacity","lightposition","lighting"];u.forEach(function(e){l[e]=a[e]});l.hoverinfo=s({},o.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"});t.exports=l},{"../../components/colorbar/attributes":362,"../../components/colorscale/attributes":368,"../../lib/extend":475,"../../plots/attributes":526,"../mesh3d/attributes":596}],636:[function(e,t,r){"use strict";var n=e("../../components/colorscale/calc");t.exports=function e(t,r){var i;var a=r.u;var o=r.v;var s=r.w;var l=r.x;var u=r.y;var f=r.z;var c=Math.min(l.length,u.length,f.length,a.length,o.length,s.length);var h=0;var v,d,p;if(r.starts){v=r.starts.x||[];d=r.starts.y||[];p=r.starts.z||[];h=Math.min(v.length,d.length,p.length)}var g=0;var m=Infinity;for(i=0;i<c;i++){var y=a[i];var b=o[i];var x=s[i];var _=Math.sqrt(y*y+b*b+x*x);g=Math.max(g,_);m=Math.min(m,_)}n(r,[m,g],"","c");var w=-Infinity;var M=Infinity;var A=-Infinity;var T=Infinity;var k=-Infinity;var E=Infinity;for(i=0;i<c;i++){var S=l[i];w=Math.max(w,S);M=Math.min(M,S);var L=u[i];A=Math.max(A,L);T=Math.min(T,L);var C=f[i];k=Math.max(k,C);E=Math.min(E,C)}for(i=0;i<h;i++){var I=v[i];w=Math.max(w,I);M=Math.min(M,I);var P=d[i];A=Math.max(A,P);T=Math.min(T,P);var O=p[i];k=Math.max(k,O);E=Math.min(E,O)}r._len=c;r._slen=h;r._normMax=g;r._xbnds=[M,w];r._ybnds=[T,A];r._zbnds=[E,k]}},{"../../components/colorscale/calc":369}],637:[function(e,t,r){"use strict";var n=e("gl-streamtube3d");var i=n.createTubeMesh;var a=e("../../lib");var o=e("../../lib/gl_format_color").parseColorScale;var s=e("../../plots/gl3d/zip3");var l={xaxis:0,yaxis:1,zaxis:2};function u(e,t){this.scene=e;this.uid=t;this.mesh=null;this.data=null}var f=u.prototype;f.handlePick=function(e){var t=this.scene.fullSceneLayout;var r=this.scene.dataScale;function n(e,n){var i=t[n];var a=r[l[n]];return i.l2c(e)/a}if(e.object===this.mesh){var i=e.data.position;var a=e.data.velocity;e.traceCoordinate=[n(i[0],"xaxis"),n(i[1],"yaxis"),n(i[2],"zaxis"),n(a[0],"xaxis"),n(a[1],"yaxis"),n(a[2],"zaxis"),e.data.intensity*this.data._normMax,e.data.divergence];e.textLabel=this.data.text;return true}};function c(e){return a.distinctVals(e).vals}function h(e){var t=e.length;var r;if(t>2){r=e.slice(1,t-1)}else if(t===2){r=[(e[0]+e[1])/2]}else{r=e}return r}function v(e){var t=e.length;if(t===1){return[.5,.5]}else{return[e[1]-e[0],e[t-1]-e[t-2]]}}function d(e,t){var r=e.fullSceneLayout;var i=e.dataScale;var u=t._len;var f={};function d(e,t){var n=r[t];var o=i[l[t]];return a.simpleMap(e,function(e){return n.d2l(e)*o})}f.vectors=s(d(t.u,"xaxis"),d(t.v,"yaxis"),d(t.w,"zaxis"),u);var p=c(t.x.slice(0,u));var g=c(t.y.slice(0,u));var m=c(t.z.slice(0,u));if(p.length*g.length*m.length>u){return{positions:[],cells:[]}}var y=d(p,"xaxis");var b=d(g,"yaxis");var x=d(m,"zaxis");f.meshgrid=[y,b,x];if(t.starts){var _=t._slen;f.startingPositions=s(d(t.starts.x.slice(0,_),"xaxis"),d(t.starts.y.slice(0,_),"yaxis"),d(t.starts.z.slice(0,_),"zaxis"))}else{var w=b[0];var M=h(y);var A=h(x);var T=new Array(M.length*A.length);var k=0;for(var E=0;E<M.length;E++){for(var S=0;S<A.length;S++){T[k++]=[M[E],w,A[S]]}}f.startingPositions=T}f.colormap=o(t.colorscale);f.tubeSize=t.sizeref;f.maxLength=t.maxdisplayed;var L=d(t._xbnds,"xaxis");var C=d(t._ybnds,"yaxis");var I=d(t._zbnds,"zaxis");var P=v(y);var O=v(b);var R=v(x);var N=[[L[0]-P[0],C[0]-O[0],I[0]-R[0]],[L[1]+P[1],C[1]+O[1],I[1]+R[1]]];var z=n(f,N);z.vertexIntensityBounds=[t.cmin/t._normMax,t.cmax/t._normMax];var D=t.lightposition;z.lightPosition=[D.x,D.y,D.z];z.ambient=t.lighting.ambient;z.diffuse=t.lighting.diffuse;z.specular=t.lighting.specular;z.roughness=t.lighting.roughness;z.fresnel=t.lighting.fresnel;z.opacity=t.opacity;t._pad=z.tubeScale*t.sizeref*2;return z}f.update=function(e){this.data=e;var t=d(this.scene,e);this.mesh.update(t)};f.dispose=function(){this.scene.glplot.remove(this.mesh);this.mesh.dispose()};function p(e,t){var r=e.glplot.gl;var n=d(e,t);var a=i(r,n);var o=new u(e,t.uid);o.mesh=a;o.data=t;a._trace=o;e.glplot.add(a);return o}t.exports=p},{"../../lib":483,"../../lib/gl_format_color":480,"../../plots/gl3d/zip3":570,"gl-streamtube3d":159}],638:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../components/colorscale/defaults");var a=e("./attributes");t.exports=function e(t,r,o,s){function l(e,i){return n.coerce(t,r,a,e,i)}var u=l("u");var f=l("v");var c=l("w");var h=l("x");var v=l("y");var d=l("z");if(!u||!u.length||!f||!f.length||!c||!c.length||!h||!h.length||!v||!v.length||!d||!d.length){r.visible=false;return}l("starts.x");l("starts.y");l("starts.z");l("maxdisplayed");l("sizeref");l("lighting.ambient");l("lighting.diffuse");l("lighting.specular");l("lighting.roughness");l("lighting.fresnel");l("lightposition.x");l("lightposition.y");l("lightposition.z");i(t,r,s,l,{prefix:"",cLetter:"c"});l("text");r._length=null}},{"../../components/colorscale/defaults":371,"../../lib":483,"./attributes":635}],639:[function(e,t,r){"use strict";t.exports={moduleType:"trace",name:"streamtube",basePlotModule:e("../../plots/gl3d"),categories:["gl3d"],attributes:e("./attributes"),supplyDefaults:e("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:e("./calc"),plot:e("./convert"),eventData:function(e,t){e.tubex=e.x;e.tubey=e.y;e.tubez=e.z;e.tubeu=t.traceCoordinate[3];e.tubev=t.traceCoordinate[4];e.tubew=t.traceCoordinate[5];e.norm=t.traceCoordinate[6];e.divergence=t.traceCoordinate[7];delete e.x;delete e.y;delete e.z;return e},meta:{}}},{"../../plots/gl3d":559,"./attributes":635,"./calc":636,"./convert":637,"./defaults":638}],640:[function(e,t,r){"use strict";var n=e("../../components/color");var i=e("../../components/colorscale/attributes");var a=e("../../components/colorbar/attributes");var o=e("../../plots/attributes");var s=e("../../lib/extend").extendFlat;var l=e("../../plot_api/edit_types").overrideAll;function u(e){return{valType:"boolean",dflt:false}}function f(e){return{show:{valType:"boolean",dflt:false},project:{x:u("x"),y:u("y"),z:u("z")},color:{valType:"color",dflt:n.defaultLine},usecolormap:{valType:"boolean",dflt:false},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:true},highlightcolor:{valType:"color",dflt:n.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var c=t.exports=l(s({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:true},surfacecolor:{valType:"data_array"}},i("",{colorAttr:"z or surfacecolor",showScaleDflt:true,autoColorDflt:false,editTypeOverride:"calc"}),{colorbar:a,contours:{x:f("x"),y:f("y"),z:f("z")},hidesurface:{valType:"boolean",dflt:false},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},_deprecated:{zauto:s({},i.zauto,{}),zmin:s({},i.zmin,{}),zmax:s({},i.zmax,{})},hoverinfo:s({},o.hoverinfo)}),"calc","nested");c.x.editType=c.y.editType=c.z.editType="calc+clearAxisTypes"},{"../../components/color":361,"../../components/colorbar/attributes":362,"../../components/colorscale/attributes":368,"../../lib/extend":475,"../../plot_api/edit_types":512,"../../plots/attributes":526}],641:[function(e,t,r){"use strict";var n=e("../../components/colorscale/calc");t.exports=function e(t,r){if(r.surfacecolor){n(r,r.surfacecolor,"","c")}else{n(r,r.z,"","c")}}},{"../../components/colorscale/calc":369}],642:[function(e,t,r){"use strict";var n=e("gl-surface3d");var i=e("ndarray");var a=e("ndarray-homography");var o=e("ndarray-fill");var s=e("ndarray-ops");var l=e("../../lib").isArrayOrTypedArray;var u=e("../../lib/gl_format_color").parseColorScale;var f=e("../../lib/str2rgbarray");var c=128;function h(e,t,r){this.scene=e;this.uid=r;this.surface=t;this.data=null;this.showContour=[false,false,false];this.dataScale=1}var v=h.prototype;v.handlePick=function(e){if(e.object===this.surface){var t=e.index=[Math.min(Math.round(e.data.index[0]/this.dataScale-1)|0,this.data.z[0].length-1),Math.min(Math.round(e.data.index[1]/this.dataScale-1)|0,this.data.z.length-1)];var r=[0,0,0];if(!l(this.data.x)){r[0]=t[0]}else if(l(this.data.x[0])){r[0]=this.data.x[t[1]][t[0]]}else{r[0]=this.data.x[t[0]]}if(!l(this.data.y)){r[1]=t[1]}else if(l(this.data.y[0])){r[1]=this.data.y[t[1]][t[0]]}else{r[1]=this.data.y[t[1]]}r[2]=this.data.z[t[1]][t[0]];e.traceCoordinate=r;var n=this.scene.fullSceneLayout;e.dataCoordinate=[n.xaxis.d2l(r[0],0,this.data.xcalendar)*this.scene.dataScale[0],n.yaxis.d2l(r[1],0,this.data.ycalendar)*this.scene.dataScale[1],n.zaxis.d2l(r[2],0,this.data.zcalendar)*this.scene.dataScale[2]];var i=this.data.text;if(Array.isArray(i)&&i[t[1]]&&i[t[1]][t[0]]!==undefined){e.textLabel=i[t[1]][t[0]]}else if(i){e.textLabel=i}else{e.textLabel=""}e.data.dataCoordinate=e.dataCoordinate.slice();this.surface.highlight(e.data);this.scene.glplot.spikes.position=e.dataCoordinate;return true}};function d(e){var t=e[0].rgb,r=e[e.length-1].rgb;return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]}function p(e){var t=e.shape;var r=[t[0]+2,t[1]+2];var n=i(new Float32Array(r[0]*r[1]),r);s.assign(n.lo(1,1).hi(t[0],t[1]),e);s.assign(n.lo(1).hi(t[0],1),e.hi(t[0],1));s.assign(n.lo(1,r[1]-1).hi(t[0],1),e.lo(0,t[1]-1).hi(t[0],1));s.assign(n.lo(0,1).hi(1,t[1]),e.hi(1));s.assign(n.lo(r[0]-1,1).hi(1,t[1]),e.lo(t[0]-1));n.set(0,0,e.get(0,0));n.set(0,r[1]-1,e.get(0,t[1]-1));n.set(r[0]-1,0,e.get(t[0]-1,0));n.set(r[0]-1,r[1]-1,e.get(t[0]-1,t[1]-1));return n}function g(e){var t=Math.max(e[0].shape[0],e[0].shape[1]);if(t<c){var r=c/t;var n=[Math.floor(e[0].shape[0]*r+1)|0,Math.floor(e[0].shape[1]*r+1)|0];var o=n[0]*n[1];for(var s=0;s<e.length;++s){var l=p(e[s]);var u=i(new Float32Array(o),n);a(u,l,[r,0,0,0,r,0,0,0,1]);e[s]=u}return r}return 1}v.setContourLevels=function(){var e=[[],[],[]];var t=false;for(var r=0;r<3;++r){if(this.showContour[r]){t=true;e[r]=this.scene.contourLevels[r]}}if(t){this.surface.update({levels:e})}};v.update=function(e){var t,r=this.scene,n=r.fullSceneLayout,a=this.surface,s=e.opacity,c=u(e.colorscale,s),h=e.z,v=e.x,p=e.y,m=n.xaxis,y=n.yaxis,b=n.zaxis,x=r.dataScale,_=h[0].length,w=e._ylength,M=[i(new Float32Array(_*w),[_,w]),i(new Float32Array(_*w),[_,w]),i(new Float32Array(_*w),[_,w])],A=M[0],T=M[1],k=r.contourLevels;this.data=e;var E=e.xcalendar,S=e.ycalendar,L=e.zcalendar;o(M[2],function(e,t){return b.d2l(h[t][e],0,L)*x[2]});if(!l(v)){o(A,function(e){return m.d2l(e,0,E)*x[0]})}else if(l(v[0])){o(A,function(e,t){return m.d2l(v[t][e],0,E)*x[0]})}else{o(A,function(e){return m.d2l(v[e],0,E)*x[0]})}if(!l(v)){o(T,function(e,t){return y.d2l(t,0,E)*x[1]})}else if(l(p[0])){o(T,function(e,t){return y.d2l(p[t][e],0,S)*x[1]})}else{o(T,function(e,t){return y.d2l(p[t],0,S)*x[1]})}var C={colormap:c,levels:[[],[],[]],showContour:[true,true,true],showSurface:!e.hidesurface,contourProject:[[false,false,false],[false,false,false],[false,false,false]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacity:e.opacity};C.intensityBounds=[e.cmin,e.cmax];if(e.surfacecolor){var I=i(new Float32Array(_*w),[_,w]);o(I,function(t,r){return e.surfacecolor[r][t]});M.push(I)}else{C.intensityBounds[0]*=x[2];C.intensityBounds[1]*=x[2]}this.dataScale=g(M);if(e.surfacecolor){C.intensity=M.pop()}var P=[true,true,true];var O=["x","y","z"];for(t=0;t<3;++t){var R=e.contours[O[t]];P[t]=R.highlight;C.showContour[t]=R.show||R.highlight;if(!C.showContour[t])continue;C.contourProject[t]=[R.project.x,R.project.y,R.project.z];if(R.show){this.showContour[t]=true;C.levels[t]=k[t];a.highlightColor[t]=C.contourColor[t]=f(R.color);if(R.usecolormap){a.highlightTint[t]=C.contourTint[t]=0}else{a.highlightTint[t]=C.contourTint[t]=1}C.contourWidth[t]=R.width}else{this.showContour[t]=false}if(R.highlight){C.dynamicColor[t]=f(R.highlightcolor);C.dynamicWidth[t]=R.highlightwidth}}if(d(c)){C.vertexColor=true}C.coords=M;a.update(C);a.visible=e.visible;a.enableDynamic=P;a.enableHighlight=P;a.snapToData=true;if("lighting"in e){a.ambientLight=e.lighting.ambient;a.diffuseLight=e.lighting.diffuse;a.specularLight=e.lighting.specular;a.roughness=e.lighting.roughness;a.fresnel=e.lighting.fresnel}if("lightposition"in e){a.lightPosition=[e.lightposition.x,e.lightposition.y,e.lightposition.z]}if(s&&s<1){a.supportsTransparency=true}};v.dispose=function(){this.scene.glplot.remove(this.surface);this.surface.dispose()};function m(e,t){var r=e.glplot.gl;var i=n({gl:r});var a=new h(e,i,t.uid);i._trace=a;a.update(t);e.glplot.add(i);return a}t.exports=m},{"../../lib":483,"../../lib/gl_format_color":480,"../../lib/str2rgbarray":505,"gl-surface3d":161,ndarray:270,"ndarray-fill":260,"ndarray-homography":262,"ndarray-ops":264}],643:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");var a=e("../../components/colorscale/defaults");var o=e("./attributes");t.exports=function e(t,r,l,u){var f,c;function h(e,n){return i.coerce(t,r,o,e,n)}var v=h("z");if(!v){r.visible=false;return}var d=h("x");h("y");r._xlength=Array.isArray(d)&&i.isArrayOrTypedArray(d[0])?v.length:v[0].length;r._ylength=v.length;var p=n.getComponentMethod("calendars","handleTraceDefaults");p(t,r,["x","y","z"],u);h("text");["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","opacity"].forEach(function(e){h(e)});var g=h("surfacecolor");h("colorscale");var m=["x","y","z"];for(f=0;f<3;++f){var y="contours."+m[f];var b=h(y+".show");var x=h(y+".highlight");if(b||x){for(c=0;c<3;++c){h(y+".project."+m[c])}}if(b){h(y+".color");h(y+".width");h(y+".usecolormap")}if(x){h(y+".highlightcolor");h(y+".highlightwidth")}}if(!g){s(t,"zmin","cmin");s(t,"zmax","cmax");s(t,"zauto","cauto")}a(t,r,u,h,{prefix:"",cLetter:"c"});r._length=null};function s(e,t,r){if(t in e&&!(r in e)){e[r]=e[t]}}},{"../../components/colorscale/defaults":371,"../../lib":483,"../../registry":582,"./attributes":640}],644:[function(e,t,r){"use strict";var n={};n.attributes=e("./attributes");n.supplyDefaults=e("./defaults");n.colorbar={min:"cmin",max:"cmax"};n.calc=e("./calc");n.plot=e("./convert");n.moduleType="trace";n.name="surface";n.basePlotModule=e("../../plots/gl3d");n.categories=["gl3d","2dMap","noOpacity"];n.meta={};t.exports=n},{"../../plots/gl3d":559,"./attributes":640,"./calc":641,"./convert":642,"./defaults":643}]},{},[5])(5)});