/**
* plotly.js (mapbox - minified) v1.39.1
* Copyright 2012-2018, Plotly, Inc.
* All rights reserved.
* Licensed under the MIT license
*/
(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.Plotly=e()}})(function(){var e,t,r;return function(){function e(t,r,n){function i(o,s){if(!r[o]){if(!t[o]){var l=typeof require=="function"&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};t[o][0].call(c.exports,function(e){var r=t[o][1][e];return i(r?r:e)},c,c.exports,e,t,r,n)}return r[o].exports}var a=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}return e}()({1:[function(e,t,r){"use strict";var n=e("../src/lib");var i={"X,X div":"font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;","X input,X button":"font-family:'Open Sans', verdana, arial, sans-serif;","X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;z-index:1001;background:rgba(255,255,255,0.7);","X .modebar--hover":"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;","X:hover .modebar--hover":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;margin-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-group:first-child":"margin-left:0px;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar-btn path":"fill:rgba(0,31,95,0.3);","X .modebar-btn.active path,X .modebar-btn:hover path":"fill:rgba(0,22,72,0.5);","X .modebar-btn.modebar-btn--logo":"padding:3px 1px;","X .modebar-btn.modebar-btn--logo path":"fill:#447adb !important;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;","X [data-title]:after":"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:white;","X .select-outline-2":"stroke:black;stroke-dasharray:2px 2px;",Y:"font-family:'Open Sans';position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;","Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var a in i){var o=a.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");n.addStyleRule(o,i[a])}},{"../src/lib":161}],2:[function(e,t,r){"use strict";t.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:1e3,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:1e3,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"}}},{}],3:[function(e,t,r){"use strict";t.exports=e("../src/core")},{"../src/core":145}],4:[function(e,t,r){"use strict";var n=e("./core");n.register([e("./scattermapbox")]);t.exports=n},{"./core":3,"./scattermapbox":5}],5:[function(e,t,r){"use strict";t.exports=e("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":297}],6:[function(t,r,n){!function(){var t={version:"3.5.17"};var n=[].slice,i=function(e){return n.call(e)};var a=this.document;function o(e){return e&&(e.ownerDocument||e.document||e).documentElement}function s(e){return e&&(e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView)}if(a){try{i(a.documentElement.childNodes)[0].nodeType}catch(e){i=function(e){var t=e.length,r=new Array(t);while(t--)r[t]=e[t];return r}}}if(!Date.now)Date.now=function(){return+new Date};if(a){try{a.createElement("DIV").style.setProperty("opacity",0,"")}catch(e){var l=this.Element.prototype,u=l.setAttribute,c=l.setAttributeNS,f=this.CSSStyleDeclaration.prototype,h=f.setProperty;l.setAttribute=function(e,t){u.call(this,e,t+"")};l.setAttributeNS=function(e,t,r){c.call(this,e,t,r+"")};f.setProperty=function(e,t,r){h.call(this,e,t+"",r)}}}t.ascending=p;function p(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}t.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN};t.min=function(e,t){var r=-1,n=e.length,i,a;if(arguments.length===1){while(++r<n)if((a=e[r])!=null&&a>=a){i=a;break}while(++r<n)if((a=e[r])!=null&&i>a)i=a}else{while(++r<n)if((a=t.call(e,e[r],r))!=null&&a>=a){i=a;break}while(++r<n)if((a=t.call(e,e[r],r))!=null&&i>a)i=a}return i};t.max=function(e,t){var r=-1,n=e.length,i,a;if(arguments.length===1){while(++r<n)if((a=e[r])!=null&&a>=a){i=a;break}while(++r<n)if((a=e[r])!=null&&a>i)i=a}else{while(++r<n)if((a=t.call(e,e[r],r))!=null&&a>=a){i=a;break}while(++r<n)if((a=t.call(e,e[r],r))!=null&&a>i)i=a}return i};t.extent=function(e,t){var r=-1,n=e.length,i,a,o;if(arguments.length===1){while(++r<n)if((a=e[r])!=null&&a>=a){i=o=a;break}while(++r<n)if((a=e[r])!=null){if(i>a)i=a;if(o<a)o=a}}else{while(++r<n)if((a=t.call(e,e[r],r))!=null&&a>=a){i=o=a;break}while(++r<n)if((a=t.call(e,e[r],r))!=null){if(i>a)i=a;if(o<a)o=a}}return[i,o]};function d(e){return e===null?NaN:+e}function v(e){return!isNaN(e)}t.sum=function(e,t){var r=0,n=e.length,i,a=-1;if(arguments.length===1){while(++a<n)if(v(i=+e[a]))r+=i}else{while(++a<n)if(v(i=+t.call(e,e[a],a)))r+=i}return r};t.mean=function(e,t){var r=0,n=e.length,i,a=-1,o=n;if(arguments.length===1){while(++a<n)if(v(i=d(e[a])))r+=i;else--o}else{while(++a<n)if(v(i=d(t.call(e,e[a],a))))r+=i;else--o}if(o)return r/o};t.quantile=function(e,t){var r=(e.length-1)*t+1,n=Math.floor(r),i=+e[n-1],a=r-n;return a?i+a*(e[n]-i):i};t.median=function(e,r){var n=[],i=e.length,a,o=-1;if(arguments.length===1){while(++o<i)if(v(a=d(e[o])))n.push(a)}else{while(++o<i)if(v(a=d(r.call(e,e[o],o))))n.push(a)}if(n.length)return t.quantile(n.sort(p),.5)};t.variance=function(e,t){var r=e.length,n=0,i,a,o=0,s=-1,l=0;if(arguments.length===1){while(++s<r){if(v(i=d(e[s]))){a=i-n;n+=a/++l;o+=a*(i-n)}}}else{while(++s<r){if(v(i=d(t.call(e,e[s],s)))){a=i-n;n+=a/++l;o+=a*(i-n)}}}if(l>1)return o/(l-1)};t.deviation=function(){var e=t.variance.apply(this,arguments);return e?Math.sqrt(e):e};function m(e){return{left:function(t,r,n,i){if(arguments.length<3)n=0;if(arguments.length<4)i=t.length;while(n<i){var a=n+i>>>1;if(e(t[a],r)<0)n=a+1;else i=a}return n},right:function(t,r,n,i){if(arguments.length<3)n=0;if(arguments.length<4)i=t.length;while(n<i){var a=n+i>>>1;if(e(t[a],r)>0)i=a;else n=a+1}return n}}}var g=m(p);t.bisectLeft=g.left;t.bisect=t.bisectRight=g.right;t.bisector=function(e){return m(e.length===1?function(t,r){return p(e(t),r)}:e)};t.shuffle=function(e,t,r){if((n=arguments.length)<3){r=e.length;if(n<2)t=0}var n=r-t,i,a;while(n){a=Math.random()*n--|0;i=e[n+t],e[n+t]=e[a+t],e[a+t]=i}return e};t.permute=function(e,t){var r=t.length,n=new Array(r);while(r--)n[r]=e[t[r]];return n};t.pairs=function(e){var t=0,r=e.length-1,n,i=e[0],a=new Array(r<0?0:r);while(t<r)a[t]=[n=i,i=e[++t]];return a};t.transpose=function(e){if(!(o=e.length))return[];for(var r=-1,n=t.min(e,y),i=new Array(n);++r<n;){for(var a=-1,o,s=i[r]=new Array(o);++a<o;){s[a]=e[a][r]}}return i};function y(e){return e.length}t.zip=function(){return t.transpose(arguments)};t.keys=function(e){var t=[];for(var r in e)t.push(r);return t};t.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t};t.entries=function(e){var t=[];for(var r in e)t.push({key:r,value:e[r]});return t};t.merge=function(e){var t=e.length,r,n=-1,i=0,a,o;while(++n<t)i+=e[n].length;a=new Array(i);while(--t>=0){o=e[t];r=o.length;while(--r>=0){a[--i]=o[r]}}return a};var _=Math.abs;t.range=function(e,t,r){if(arguments.length<3){r=1;if(arguments.length<2){t=e;e=0}}if((t-e)/r===Infinity)throw new Error("infinite range");var n=[],i=x(_(r)),a=-1,o;e*=i,t*=i,r*=i;if(r<0)while((o=e+r*++a)>t)n.push(o/i);else while((o=e+r*++a)<t)n.push(o/i);return n};function x(e){var t=1;while(e*t%1)t*=10;return t}function b(e,t){for(var r in t){Object.defineProperty(e.prototype,r,{value:t[r],enumerable:false})}}t.map=function(e,t){var r=new w;if(e instanceof w){e.forEach(function(e,t){r.set(e,t)})}else if(Array.isArray(e)){var n=-1,i=e.length,a;if(arguments.length===1)while(++n<i)r.set(n,e[n]);else while(++n<i)r.set(t.call(e,a=e[n],n),a)}else{for(var o in e)r.set(o,e[o])}return r};function w(){this._=Object.create(null)}var k="__proto__",A="\0";b(w,{has:S,get:function(e){return this._[T(e)]},set:function(e,t){return this._[T(e)]=t},remove:C,keys:z,values:function(){var e=[];for(var t in this._)e.push(this._[t]);return e},entries:function(){var e=[];for(var t in this._)e.push({key:M(t),value:this._[t]});return e},size:E,empty:L,forEach:function(e){for(var t in this._)e.call(this,M(t),this._[t])}});function T(e){return(e+="")===k||e[0]===A?A+e:e}function M(e){return(e+="")[0]===A?e.slice(1):e}function S(e){return T(e)in this._}function C(e){return(e=T(e))in this._&&delete this._[e]}function z(){var e=[];for(var t in this._)e.push(M(t));return e}function E(){var e=0;for(var t in this._)++e;return e}function L(){for(var e in this._)return false;return true}t.nest=function(){var e={},r=[],n=[],i,a;function o(t,n,s){if(s>=r.length)return a?a.call(e,n):i?n.sort(i):n;var l=-1,u=n.length,c=r[s++],f,h,p,d=new w,v;while(++l<u){if(v=d.get(f=c(h=n[l]))){v.push(h)}else{d.set(f,[h])}}if(t){h=t();p=function(e,r){h.set(e,o(t,r,s))}}else{h={};p=function(e,r){h[e]=o(t,r,s)}}d.forEach(p);return h}function s(e,t){if(t>=r.length)return e;var i=[],a=n[t++];e.forEach(function(e,r){i.push({key:e,values:s(r,t)})});return a?i.sort(function(e,t){return a(e.key,t.key)}):i}e.map=function(e,t){return o(t,e,0)};e.entries=function(e){return s(o(t.map,e,0),0)};e.key=function(t){r.push(t);return e};e.sortKeys=function(t){n[r.length-1]=t;return e};e.sortValues=function(t){i=t;return e};e.rollup=function(t){a=t;return e};return e};t.set=function(e){var t=new I;if(e)for(var r=0,n=e.length;r<n;++r)t.add(e[r]);return t};function I(){this._=Object.create(null)}b(I,{has:S,add:function(e){this._[T(e+="")]=true;return e},remove:C,values:z,size:E,empty:L,forEach:function(e){for(var t in this._)e.call(this,M(t))}});t.behavior={};function P(e){return e}t.rebind=function(e,t){var r=1,n=arguments.length,i;while(++r<n)e[i=arguments[r]]=D(e,t,t[i]);return e};function D(e,t,r){return function(){var n=r.apply(t,arguments);return n===t?e:n}}function O(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.slice(1);for(var r=0,n=R.length;r<n;++r){var i=R[r]+t;if(i in e)return i}}var R=["webkit","ms","moz","Moz","o","O"];function F(){}t.dispatch=function(){var e=new B,t=-1,r=arguments.length;while(++t<r)e[arguments[t]]=N(e);return e};function B(){}B.prototype.on=function(e,t){var r=e.indexOf("."),n="";if(r>=0){n=e.slice(r+1);e=e.slice(0,r)}if(e)return arguments.length<2?this[e].on(n):this[e].on(n,t);if(arguments.length===2){if(t==null)for(e in this){if(this.hasOwnProperty(e))this[e].on(n,null)}return this}};function N(e){var t=[],r=new w;function n(){var r=t,n=-1,i=r.length,a;while(++n<i)if(a=r[n].on)a.apply(this,arguments);return e}n.on=function(n,i){var a=r.get(n),o;if(arguments.length<2)return a&&a.on;if(a){a.on=null;t=t.slice(0,o=t.indexOf(a)).concat(t.slice(o+1));r.remove(n)}if(i)t.push(r.set(n,{on:i}));return e};return n}t.event=null;function j(){t.event.preventDefault()}function V(){var e=t.event,r;while(r=e.sourceEvent)e=r;return e}function q(e){var r=new B,n=0,i=arguments.length;while(++n<i)r[arguments[n]]=N(r);r.of=function(n,i){return function(a){try{var o=a.sourceEvent=t.event;a.target=e;t.event=a;r[a.type].apply(n,i)}finally{t.event=o}}};return r}t.requote=function(e){return e.replace(U,"\\$&")};var U=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;var Z={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)e[r]=t[r]};function H(e){Z(e,X);return e}var G=function(e,t){return t.querySelector(e)},$=function(e,t){return t.querySelectorAll(e)},W=function(e,t){var r=e.matches||e[O(e,"matchesSelector")];W=function(e,t){return r.call(e,t)};return W(e,t)};if(typeof Sizzle==="function"){G=function(e,t){return Sizzle(e,t)[0]||null};$=Sizzle;W=Sizzle.matchesSelector}t.selection=function(){return t.select(a.documentElement)};var X=t.selection.prototype=[];X.select=function(e){var t=[],r,n,i,a;e=Y(e);for(var o=-1,s=this.length;++o<s;){t.push(r=[]);r.parentNode=(i=this[o]).parentNode;for(var l=-1,u=i.length;++l<u;){if(a=i[l]){r.push(n=e.call(a,a.__data__,l,o));if(n&&"__data__"in a)n.__data__=a.__data__}else{r.push(null)}}}return H(t)};function Y(e){return typeof e==="function"?e:function(){return G(e,this)}}X.selectAll=function(e){var t=[],r,n;e=J(e);for(var a=-1,o=this.length;++a<o;){for(var s=this[a],l=-1,u=s.length;++l<u;){if(n=s[l]){t.push(r=i(e.call(n,n.__data__,l,a)));r.parentNode=n}}}return H(t)};function J(e){return typeof e==="function"?e:function(){return $(e,this)}}var K="http://www.w3.org/1999/xhtml";var Q={svg:"http://www.w3.org/2000/svg",xhtml:K,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};t.ns={prefix:Q,qualify:function(e){var t=e.indexOf(":"),r=e;if(t>=0&&(r=e.slice(0,t))!=="xmlns")e=e.slice(t+1);return Q.hasOwnProperty(r)?{space:Q[r],local:e}:e}};X.attr=function(e,r){if(arguments.length<2){if(typeof e==="string"){var n=this.node();e=t.ns.qualify(e);return e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(r in e)this.each(ee(r,e[r]));return this}return this.each(ee(e,r))};function ee(e,r){e=t.ns.qualify(e);function n(){this.removeAttribute(e)}function i(){this.removeAttributeNS(e.space,e.local)}function a(){this.setAttribute(e,r)}function o(){this.setAttributeNS(e.space,e.local,r)}function s(){var t=r.apply(this,arguments);if(t==null)this.removeAttribute(e);else this.setAttribute(e,t)}function l(){var t=r.apply(this,arguments);if(t==null)this.removeAttributeNS(e.space,e.local);else this.setAttributeNS(e.space,e.local,t)}return r==null?e.local?i:n:typeof r==="function"?e.local?l:s:e.local?o:a}function te(e){return e.trim().replace(/\s+/g," ")}X.classed=function(e,t){if(arguments.length<2){if(typeof e==="string"){var r=this.node(),n=(e=ne(e)).length,i=-1;if(t=r.classList){while(++i<n)if(!t.contains(e[i]))return false}else{t=r.getAttribute("class");while(++i<n)if(!re(e[i]).test(t))return false}return true}for(t in e)this.each(ie(t,e[t]));return this}return this.each(ie(e,t))};function re(e){return new RegExp("(?:^|\\s+)"+t.requote(e)+"(?:\\s+|$)","g")}function ne(e){return(e+"").trim().split(/^|\s+/)}function ie(e,t){e=ne(e).map(ae);var r=e.length;function n(){var n=-1;while(++n<r)e[n](this,t)}function i(){var n=-1,i=t.apply(this,arguments);while(++n<r)e[n](this,i)}return typeof t==="function"?i:n}function ae(e){var t=re(e);return function(r,n){if(i=r.classList)return n?i.add(e):i.remove(e);var i=r.getAttribute("class")||"";if(n){t.lastIndex=0;if(!t.test(i))r.setAttribute("class",te(i+" "+e))}else{r.setAttribute("class",te(i.replace(t," ")))}}}X.style=function(e,t,r){var n=arguments.length;if(n<3){if(typeof e!=="string"){if(n<2)t="";for(r in e)this.each(oe(r,e[r],t));return this}if(n<2){var i=this.node();return s(i).getComputedStyle(i,null).getPropertyValue(e)}r=""}return this.each(oe(e,t,r))};function oe(e,t,r){function n(){this.style.removeProperty(e)}function i(){this.style.setProperty(e,t,r)}function a(){var n=t.apply(this,arguments);if(n==null)this.style.removeProperty(e);else this.style.setProperty(e,n,r)}return t==null?n:typeof t==="function"?a:i}X.property=function(e,t){if(arguments.length<2){if(typeof e==="string")return this.node()[e];for(t in e)this.each(se(t,e[t]));return this}return this.each(se(e,t))};function se(e,t){function r(){delete this[e]}function n(){this[e]=t}function i(){var r=t.apply(this,arguments);if(r==null)delete this[e];else this[e]=r}return t==null?r:typeof t==="function"?i:n}X.text=function(e){return arguments.length?this.each(typeof e==="function"?function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}:e==null?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent};X.html=function(e){return arguments.length?this.each(typeof e==="function"?function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}:e==null?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML};X.append=function(e){e=le(e);return this.select(function(){return this.appendChild(e.apply(this,arguments))})};function le(e){function r(){var t=this.ownerDocument,r=this.namespaceURI;return r===K&&t.documentElement.namespaceURI===K?t.createElement(e):t.createElementNS(r,e)}function n(){return this.ownerDocument.createElementNS(e.space,e.local)}return typeof e==="function"?e:(e=t.ns.qualify(e)).local?n:r}X.insert=function(e,t){e=le(e);t=Y(t);return this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments)||null)})};X.remove=function(){return this.each(ue)};function ue(){var e=this.parentNode;if(e)e.removeChild(this)}X.data=function(e,t){var r=-1,n=this.length,i,a;if(!arguments.length){e=new Array(n=(i=this[0]).length);while(++r<n){if(a=i[r]){e[r]=a.__data__}}return e}function o(e,r){var n,i=e.length,a=r.length,o=Math.min(i,a),c=new Array(a),f=new Array(a),h=new Array(i),p,d;if(t){var v=new w,m=new Array(i),g;for(n=-1;++n<i;){if(p=e[n]){if(v.has(g=t.call(p,p.__data__,n))){h[n]=p}else{v.set(g,p)}m[n]=g}}for(n=-1;++n<a;){if(!(p=v.get(g=t.call(r,d=r[n],n)))){f[n]=ce(d)}else if(p!==true){c[n]=p;p.__data__=d}v.set(g,true)}for(n=-1;++n<i;){if(n in m&&v.get(m[n])!==true){h[n]=e[n]}}}else{for(n=-1;++n<o;){p=e[n];d=r[n];if(p){p.__data__=d;c[n]=p}else{f[n]=ce(d)}}for(;n<a;++n){f[n]=ce(r[n])}for(;n<i;++n){h[n]=e[n]}}f.update=c;f.parentNode=c.parentNode=h.parentNode=e.parentNode;s.push(f);l.push(c);u.push(h)}var s=de([]),l=H([]),u=H([]);if(typeof e==="function"){while(++r<n){o(i=this[r],e.call(i,i.parentNode.__data__,r))}}else{while(++r<n){o(i=this[r],e)}}l.enter=function(){return s};l.exit=function(){return u};return l};function ce(e){return{__data__:e}}X.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")};X.filter=function(e){var t=[],r,n,i;if(typeof e!=="function")e=fe(e);for(var a=0,o=this.length;a<o;a++){t.push(r=[]);r.parentNode=(n=this[a]).parentNode;for(var s=0,l=n.length;s<l;s++){if((i=n[s])&&e.call(i,i.__data__,s,a)){r.push(i)}}}return H(t)};function fe(e){return function(){return W(this,e)}}X.order=function(){for(var e=-1,t=this.length;++e<t;){for(var r=this[e],n=r.length-1,i=r[n],a;--n>=0;){if(a=r[n]){if(i&&i!==a.nextSibling)i.parentNode.insertBefore(a,i);i=a}}}return this};X.sort=function(e){e=he.apply(this,arguments);for(var t=-1,r=this.length;++t<r;)this[t].sort(e);return this.order()};function he(e){if(!arguments.length)e=p;return function(t,r){return t&&r?e(t.__data__,r.__data__):!t-!r}}X.each=function(e){return pe(this,function(t,r,n){e.call(t,t.__data__,r,n)})};function pe(e,t){for(var r=0,n=e.length;r<n;r++){for(var i=e[r],a=0,o=i.length,s;a<o;a++){if(s=i[a])t(s,a,r)}}return e}X.call=function(e){var t=i(arguments);e.apply(t[0]=this,t);return this};X.empty=function(){return!this.node()};X.node=function(){for(var e=0,t=this.length;e<t;e++){for(var r=this[e],n=0,i=r.length;n<i;n++){var a=r[n];if(a)return a}}return null};X.size=function(){var e=0;pe(this,function(){++e});return e};function de(e){Z(e,ve);return e}var ve=[];t.selection.enter=de;t.selection.enter.prototype=ve;ve.append=X.append;ve.empty=X.empty;ve.node=X.node;ve.call=X.call;ve.size=X.size;ve.select=function(e){var t=[],r,n,i,a,o;for(var s=-1,l=this.length;++s<l;){i=(a=this[s]).update;t.push(r=[]);r.parentNode=a.parentNode;for(var u=-1,c=a.length;++u<c;){if(o=a[u]){r.push(i[u]=n=e.call(a.parentNode,o.__data__,u,s));n.__data__=o.__data__}else{r.push(null)}}}return H(t)};ve.insert=function(e,t){if(arguments.length<2)t=me(this);return X.insert.call(this,e,t)};function me(e){var t,r;return function(n,i,a){var o=e[a].update,s=o.length,l;if(a!=r)r=a,t=0;if(i>=t)t=i+1;while(!(l=o[t])&&++t<s);return l}}t.select=function(e){var t;if(typeof e==="string"){t=[G(e,a)];t.parentNode=a.documentElement}else{t=[e];t.parentNode=o(e)}return H([t])};t.selectAll=function(e){var t;if(typeof e==="string"){t=i($(e,a));t.parentNode=a.documentElement}else{t=i(e);t.parentNode=null}return H([t])};X.on=function(e,t,r){var n=arguments.length;if(n<3){if(typeof e!=="string"){if(n<2)t=false;for(r in e)this.each(ge(r,e[r],t));return this}if(n<2)return(n=this.node()["__on"+e])&&n._;r=false}return this.each(ge(e,t,r))};function ge(e,r,n){var a="__on"+e,o=e.indexOf("."),s=_e;if(o>0)e=e.slice(0,o);var l=ye.get(e);if(l)e=l,s=xe;function u(){var t=this[a];if(t){this.removeEventListener(e,t,t.$);delete this[a]}}function c(){var t=s(r,i(arguments));u.call(this);this.addEventListener(e,this[a]=t,t.$=n);t._=r}function f(){var r=new RegExp("^__on([^.]+)"+t.requote(e)+"$"),n;for(var i in this){if(n=i.match(r)){var a=this[i];this.removeEventListener(n[1],a,a.$);delete this[i]}}}return o?r?c:u:r?F:f}var ye=t.map({mouseenter:"mouseover",mouseleave:"mouseout"});if(a){ye.forEach(function(e){if("on"+e in a)ye.remove(e)})}function _e(e,r){return function(n){var i=t.event;t.event=n;r[0]=this.__data__;try{e.apply(this,r)}finally{t.event=i}}}function xe(e,t){var r=_e(e,t);return function(e){var t=this,n=e.relatedTarget;if(!n||n!==t&&!(n.compareDocumentPosition(t)&8)){r.call(t,e)}}}var be,we=0;function ke(e){var r=".dragsuppress-"+ ++we,n="click"+r,i=t.select(s(e)).on("touchmove"+r,j).on("dragstart"+r,j).on("selectstart"+r,j);if(be==null){be="onselectstart"in e?false:O(e.style,"userSelect")}if(be){var a=o(e).style,l=a[be];a[be]="none"}return function(e){i.on(r,null);if(be)a[be]=l;if(e){var t=function(){i.on(n,null)};i.on(n,function(){j();t()},true);setTimeout(t,0)}}}t.mouse=function(e){return Te(e,V())};var Ae=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function Te(e,r){if(r.changedTouches)r=r.changedTouches[0];var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();if(Ae<0){var a=s(e);if(a.scrollX||a.scrollY){n=t.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var o=n[0][0].getScreenCTM();Ae=!(o.f||o.e);n.remove()}}if(Ae)i.x=r.pageX,i.y=r.pageY;else i.x=r.clientX,i.y=r.clientY;i=i.matrixTransform(e.getScreenCTM().inverse());return[i.x,i.y]}var l=e.getBoundingClientRect();return[r.clientX-l.left-e.clientLeft,r.clientY-l.top-e.clientTop]}t.touch=function(e,t,r){if(arguments.length<3)r=t,t=V().changedTouches;if(t)for(var n=0,i=t.length,a;n<i;++n){if((a=t[n]).identifier===r){return Te(e,a)}}};t.behavior.drag=function(){var e=q(a,"drag","dragstart","dragend"),r=null,n=o(F,t.mouse,s,"mousemove","mouseup"),i=o(Me,t.touch,P,"touchmove","touchend");function a(){this.on("mousedown.drag",n).on("touchstart.drag",i)}function o(n,i,a,o,s){return function(){var l=this,u=t.event.target.correspondingElement||t.event.target,c=l.parentNode,f=e.of(l,arguments),h=0,p=n(),d=".drag"+(p==null?"":"-"+p),v,m=t.select(a(u)).on(o+d,_).on(s+d,x),g=ke(u),y=i(c,p);if(r){v=r.apply(l,arguments);v=[v.x-y[0],v.y-y[1]]}else{v=[0,0]}f({type:"dragstart"});function _(){var e=i(c,p),t,r;if(!e)return;t=e[0]-y[0];r=e[1]-y[1];h|=t|r;y=e;f({type:"drag",x:e[0]+v[0],y:e[1]+v[1],dx:t,dy:r})}function x(){if(!i(c,p))return;m.on(o+d,null).on(s+d,null);g(h);f({type:"dragend"})}}}a.origin=function(e){if(!arguments.length)return r;r=e;return a};return t.rebind(a,e,"on")};function Me(){return t.event.changedTouches[0].identifier}t.touches=function(e,t){if(arguments.length<2)t=V().touches;return t?i(t).map(function(t){var r=Te(e,t);r.identifier=t.identifier;return r}):[]};var Se=1e-6,Ce=Se*Se,ze=Math.PI,Ee=2*ze,Le=Ee-Se,Ie=ze/2,Pe=ze/180,De=180/ze;function Oe(e){return e>0?1:e<0?-1:0}function Re(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])}function Fe(e){return e>1?0:e<-1?ze:Math.acos(e)}function Be(e){return e>1?Ie:e<-1?-Ie:Math.asin(e)}function Ne(e){return((e=Math.exp(e))-1/e)/2}function je(e){return((e=Math.exp(e))+1/e)/2}function Ve(e){return((e=Math.exp(2*e))-1)/(e+1)}function qe(e){return(e=Math.sin(e/2))*e}var Ue=Math.SQRT2,Ze=2,He=4;t.interpolateZoom=function(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],o=t[1],s=t[2],l=a-r,u=o-n,c=l*l+u*u,f,h;if(c<Ce){h=Math.log(s/i)/Ue;f=function(e){return[r+e*l,n+e*u,i*Math.exp(Ue*e*h)]}}else{var p=Math.sqrt(c),d=(s*s-i*i+He*c)/(2*i*Ze*p),v=(s*s-i*i-He*c)/(2*s*Ze*p),m=Math.log(Math.sqrt(d*d+1)-d),g=Math.log(Math.sqrt(v*v+1)-v);h=(g-m)/Ue;f=function(e){var t=e*h,a=je(m),o=i/(Ze*p)*(a*Ve(Ue*t+m)-Ne(m));return[r+o*l,n+o*u,i*a/je(Ue*t+m)]}}f.duration=h*1e3;return f};t.behavior.zoom=function(){var e={x:0,y:0,k:1},r,n,i,o=[960,500],l=Ge,u=250,c=0,f="mousedown.zoom",h="mousemove.zoom",p="mouseup.zoom",d,v="touchstart.zoom",m,g=q(w,"zoomstart","zoom","zoomend"),y,_,x,b;if(!We){We="onwheel"in a?($e=function(){return-t.event.deltaY*(t.event.deltaMode?120:1)},"wheel"):"onmousewheel"in a?($e=function(){return t.event.wheelDelta},"mousewheel"):($e=function(){return-t.event.detail},"MozMousePixelScroll")}function w(e){e.on(f,I).on(We+".zoom",D).on("dblclick.zoom",O).on(v,P)}w.event=function(r){r.each(function(){var r=g.of(this,arguments),i=e;if(Il){t.select(this).transition().each("start.zoom",function(){e=this.__chart__||{x:0,y:0,k:1};z(r)}).tween("zoom:zoom",function(){var a=o[0],s=o[1],l=n?n[0]:a/2,u=n?n[1]:s/2,c=t.interpolateZoom([(l-e.x)/e.k,(u-e.y)/e.k,a/e.k],[(l-i.x)/i.k,(u-i.y)/i.k,a/i.k]);return function(t){var n=c(t),i=a/n[2];this.__chart__=e={x:l-n[0]*i,y:u-n[1]*i,k:i};E(r)}}).each("interrupt.zoom",function(){L(r)}).each("end.zoom",function(){L(r)})}else{this.__chart__=e;z(r);E(r);L(r)}})};w.translate=function(t){if(!arguments.length)return[e.x,e.y];e={x:+t[0],y:+t[1],k:e.k};C();return w};w.scale=function(t){if(!arguments.length)return e.k;e={x:e.x,y:e.y,k:null};T(+t);C();return w};w.scaleExtent=function(e){if(!arguments.length)return l;l=e==null?Ge:[+e[0],+e[1]];return w};w.center=function(e){if(!arguments.length)return i;i=e&&[+e[0],+e[1]];return w};w.size=function(e){if(!arguments.length)return o;o=e&&[+e[0],+e[1]];return w};w.duration=function(e){if(!arguments.length)return u;u=+e;return w};w.x=function(t){if(!arguments.length)return _;_=t;y=t.copy();e={x:0,y:0,k:1};return w};w.y=function(t){if(!arguments.length)return b;b=t;x=t.copy();e={x:0,y:0,k:1};return w};function k(t){return[(t[0]-e.x)/e.k,(t[1]-e.y)/e.k]}function A(t){return[t[0]*e.k+e.x,t[1]*e.k+e.y]}function T(t){e.k=Math.max(l[0],Math.min(l[1],t))}function M(t,r){r=A(r);e.x+=t[0]-r[0];e.y+=t[1]-r[1]}function S(r,i,a,o){r.__chart__={x:e.x,y:e.y,k:e.k};T(Math.pow(2,o));M(n=i,a);r=t.select(r);if(u>0)r=r.transition().duration(u);r.call(w.event)}function C(){if(_)_.domain(y.range().map(function(t){return(t-e.x)/e.k}).map(y.invert));if(b)b.domain(x.range().map(function(t){return(t-e.y)/e.k}).map(x.invert))}function z(e){if(!c++)e({type:"zoomstart"})}function E(t){C();t({type:"zoom",scale:e.k,translate:[e.x,e.y]})}function L(e){if(!--c)e({type:"zoomend"}),n=null}function I(){var e=this,r=g.of(e,arguments),n=0,i=t.select(s(e)).on(h,l).on(p,u),a=k(t.mouse(e)),o=ke(e);Sl.call(e);z(r);function l(){n=1;M(t.mouse(e),a);E(r)}function u(){i.on(h,null).on(p,null);o(n);L(r)}}function P(){var r=this,n=g.of(r,arguments),i={},a=0,o,s=".zoom-"+t.event.changedTouches[0].identifier,l="touchmove"+s,u="touchend"+s,c=[],h=t.select(r),p=ke(r);y();z(n);h.on(f,null).on(v,y);function d(){var n=t.touches(r);o=e.k;n.forEach(function(e){if(e.identifier in i)i[e.identifier]=k(e)});return n}function y(){var n=t.event.target;t.select(n).on(l,_).on(u,x);c.push(n);var o=t.event.changedTouches;for(var s=0,f=o.length;s<f;++s){i[o[s].identifier]=null}var h=d(),p=Date.now();if(h.length===1){if(p-m<500){var v=h[0];S(r,v,i[v.identifier],Math.floor(Math.log(e.k)/Math.LN2)+1);j()}m=p}else if(h.length>1){var v=h[0],g=h[1],y=v[0]-g[0],b=v[1]-g[1];a=y*y+b*b}}function _(){var e=t.touches(r),s,l,u,c;Sl.call(r);for(var f=0,h=e.length;f<h;++f,c=null){u=e[f];if(c=i[u.identifier]){if(l)break;s=u,l=c}}if(c){var p=(p=u[0]-s[0])*p+(p=u[1]-s[1])*p,d=a&&Math.sqrt(p/a);s=[(s[0]+u[0])/2,(s[1]+u[1])/2];l=[(l[0]+c[0])/2,(l[1]+c[1])/2];T(d*o)}m=null;M(s,l);E(n)}function x(){if(t.event.touches.length){var e=t.event.changedTouches;for(var r=0,a=e.length;r<a;++r){delete i[e[r].identifier]}for(var o in i){return void d()}}t.selectAll(c).on(s,null);h.on(f,I).on(v,P);p();L(n)}}function D(){var a=g.of(this,arguments);if(d)clearTimeout(d);else Sl.call(this),r=k(n=i||t.mouse(this)),z(a);d=setTimeout(function(){d=null;L(a)},50);j();T(Math.pow(2,$e()*.002)*e.k);M(n,r);E(a)}function O(){var r=t.mouse(this),n=Math.log(e.k)/Math.LN2;S(this,r,k(r),t.event.shiftKey?Math.ceil(n)-1:Math.floor(n)+1)}return t.rebind(w,g,"on")};var Ge=[0,Infinity],$e,We;t.color=Xe;function Xe(){}Xe.prototype.toString=function(){return this.rgb()+""};t.hsl=Ye;function Ye(e,t,r){return this instanceof Ye?void(this.h=+e,this.s=+t,this.l=+r):arguments.length<2?e instanceof Ye?new Ye(e.h,e.s,e.l):yt(""+e,_t,Ye):new Ye(e,t,r)}var Je=Ye.prototype=new Xe;Je.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);return new Ye(this.h,this.s,this.l/e)};Je.darker=function(e){e=Math.pow(.7,arguments.length?e:1);return new Ye(this.h,this.s,e*this.l)};Je.rgb=function(){return Ke(this.h,this.s,this.l)};function Ke(e,t,r){var n,i;e=isNaN(e)?0:(e%=360)<0?e+360:e;t=isNaN(t)?0:t<0?0:t>1?1:t;r=r<0?0:r>1?1:r;i=r<=.5?r*(1+t):r+t-r*t;n=2*r-i;function a(e){if(e>360)e-=360;else if(e<0)e+=360;if(e<60)return n+(i-n)*e/60;if(e<180)return i;if(e<240)return n+(i-n)*(240-e)/60;return n}function o(e){return Math.round(a(e)*255)}return new pt(o(e+120),o(e),o(e-120))}t.hcl=Qe;function Qe(e,r,n){return this instanceof Qe?void(this.h=+e,this.c=+r,this.l=+n):arguments.length<2?e instanceof Qe?new Qe(e.h,e.c,e.l):e instanceof rt?ut(e.l,e.a,e.b):ut((e=xt((e=t.rgb(e)).r,e.g,e.b)).l,e.a,e.b):new Qe(e,r,n)}var et=Qe.prototype=new Xe;et.brighter=function(e){return new Qe(this.h,this.c,Math.min(100,this.l+nt*(arguments.length?e:1)))};et.darker=function(e){return new Qe(this.h,this.c,Math.max(0,this.l-nt*(arguments.length?e:1)))};et.rgb=function(){return tt(this.h,this.c,this.l).rgb()};function tt(e,t,r){if(isNaN(e))e=0;if(isNaN(t))t=0;return new rt(r,Math.cos(e*=Pe)*t,Math.sin(e)*t)}t.lab=rt;function rt(e,t,r){return this instanceof rt?void(this.l=+e,this.a=+t,this.b=+r):arguments.length<2?e instanceof rt?new rt(e.l,e.a,e.b):e instanceof Qe?tt(e.h,e.c,e.l):xt((e=pt(e)).r,e.g,e.b):new rt(e,t,r)}var nt=18;var it=.95047,at=1,ot=1.08883;var st=rt.prototype=new Xe;st.brighter=function(e){return new rt(Math.min(100,this.l+nt*(arguments.length?e:1)),this.a,this.b)};st.darker=function(e){return new rt(Math.max(0,this.l-nt*(arguments.length?e:1)),this.a,this.b)};st.rgb=function(){return lt(this.l,this.a,this.b)};function lt(e,t,r){var n=(e+16)/116,i=n+t/500,a=n-r/200;i=ct(i)*it;n=ct(n)*at;a=ct(a)*ot;return new pt(ht(3.2404542*i-1.5371385*n-.4985314*a),ht(-.969266*i+1.8760108*n+.041556*a),ht(.0556434*i-.2040259*n+1.0572252*a))}function ut(e,t,r){return e>0?new Qe(Math.atan2(r,t)*De,Math.sqrt(t*t+r*r),e):new Qe(NaN,NaN,e)}function ct(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function ft(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function ht(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}t.rgb=pt;function pt(e,t,r){return this instanceof pt?void(this.r=~~e,this.g=~~t,this.b=~~r):arguments.length<2?e instanceof pt?new pt(e.r,e.g,e.b):yt(""+e,pt,Ke):new pt(e,t,r)}function dt(e){return new pt(e>>16,e>>8&255,e&255)}function vt(e){return dt(e)+""}var mt=pt.prototype=new Xe;mt.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,r=this.g,n=this.b,i=30;if(!t&&!r&&!n)return new pt(i,i,i);if(t&&t<i)t=i;if(r&&r<i)r=i;if(n&&n<i)n=i;return new pt(Math.min(255,t/e),Math.min(255,r/e),Math.min(255,n/e))};mt.darker=function(e){e=Math.pow(.7,arguments.length?e:1);return new pt(e*this.r,e*this.g,e*this.b)};mt.hsl=function(){return _t(this.r,this.g,this.b)};mt.toString=function(){return"#"+gt(this.r)+gt(this.g)+gt(this.b)};function gt(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function yt(e,t,r){var n=0,i=0,a=0,o,s,l;o=/([a-z]+)\((.*)\)/.exec(e=e.toLowerCase());if(o){s=o[2].split(",");switch(o[1]){case"hsl":{return r(parseFloat(s[0]),parseFloat(s[1])/100,parseFloat(s[2])/100)}case"rgb":{return t(wt(s[0]),wt(s[1]),wt(s[2]))}}}if(l=kt.get(e)){return t(l.r,l.g,l.b)}if(e!=null&&e.charAt(0)==="#"&&!isNaN(l=parseInt(e.slice(1),16))){if(e.length===4){n=(l&3840)>>4;n=n>>4|n;i=l&240;i=i>>4|i;a=l&15;a=a<<4|a}else if(e.length===7){n=(l&16711680)>>16;i=(l&65280)>>8;a=l&255}}return t(n,i,a)}function _t(e,t,r){var n=Math.min(e/=255,t/=255,r/=255),i=Math.max(e,t,r),a=i-n,o,s,l=(i+n)/2;if(a){s=l<.5?a/(i+n):a/(2-i-n);if(e==i)o=(t-r)/a+(t<r?6:0);else if(t==i)o=(r-e)/a+2;else o=(e-t)/a+4;o*=60}else{o=NaN;s=l>0&&l<1?0:o}return new Ye(o,s,l)}function xt(e,t,r){e=bt(e);t=bt(t);r=bt(r);var n=ft((.4124564*e+.3575761*t+.1804375*r)/it),i=ft((.2126729*e+.7151522*t+.072175*r)/at),a=ft((.0193339*e+.119192*t+.9503041*r)/ot);return rt(116*i-16,500*(n-i),200*(i-a))}function bt(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function wt(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}var kt=t.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});kt.forEach(function(e,t){kt.set(e,dt(t))});function At(e){return typeof e==="function"?e:function(){return e}}t.functor=At;t.xhr=Tt(P);function Tt(e){return function(t,r,n){if(arguments.length===2&&typeof r==="function")n=r,r=null;return Mt(t,r,e,n)}}function Mt(e,r,n,a){var o={},s=t.dispatch("beforesend","progress","load","error"),l={},u=new XMLHttpRequest,c=null;if(this.XDomainRequest&&!("withCredentials"in u)&&/^(http(s)?:)?\/\//.test(e))u=new XDomainRequest;"onload"in u?u.onload=u.onerror=f:u.onreadystatechange=function(){u.readyState>3&&f()};function f(){var e=u.status,t;if(!e&&Ct(u)||e>=200&&e<300||e===304){try{t=n.call(o,u)}catch(e){s.error.call(o,e);return}s.load.call(o,t)}else{s.error.call(o,u)}}u.onprogress=function(e){var r=t.event;t.event=e;try{s.progress.call(o,u)}finally{t.event=r}};o.header=function(e,t){e=(e+"").toLowerCase();if(arguments.length<2)return l[e];if(t==null)delete l[e];else l[e]=t+"";return o};o.mimeType=function(e){if(!arguments.length)return r;r=e==null?null:e+"";return o};o.responseType=function(e){if(!arguments.length)return c;c=e;return o};o.response=function(e){n=e;return o};["get","post"].forEach(function(e){o[e]=function(){return o.send.apply(o,[e].concat(i(arguments)))}});o.send=function(t,n,i){if(arguments.length===2&&typeof n==="function")i=n,n=null;u.open(t,e,true);if(r!=null&&!("accept"in l))l["accept"]=r+",*/*";if(u.setRequestHeader)for(var a in l)u.setRequestHeader(a,l[a]);if(r!=null&&u.overrideMimeType)u.overrideMimeType(r);if(c!=null)u.responseType=c;if(i!=null)o.on("error",i).on("load",function(e){i(null,e)});s.beforesend.call(o,u);u.send(n==null?null:n);return o};o.abort=function(){u.abort();return o};t.rebind(o,s,"on");return a==null?o:o.get(St(a))}function St(e){return e.length===1?function(t,r){e(t==null?r:null)}:e}function Ct(e){var t=e.responseType;return t&&t!=="text"?e.response:e.responseText}t.dsv=function(e,t){var r=new RegExp('["'+e+"\n]"),n=e.charCodeAt(0);function i(e,r,n){if(arguments.length<3)n=r,r=null;var i=Mt(e,t,r==null?a:o(r),n);i.row=function(e){return arguments.length?i.response((r=e)==null?a:o(e)):r};return i}function a(e){return i.parse(e.responseText)}function o(e){return function(t){return i.parse(t.responseText,e)}}i.parse=function(e,t){var r;return i.parseRows(e,function(e,n){if(r)return r(e,n-1);var i=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");r=t?function(e,r){return t(i(e),r)}:i})};i.parseRows=function(e,t){var r={},i={},a=[],o=e.length,s=0,l=0,u,c;function f(){if(s>=o)return i;if(c)return c=false,r;var t=s;if(e.charCodeAt(t)===34){var a=t;while(a++<o){if(e.charCodeAt(a)===34){if(e.charCodeAt(a+1)!==34)break;++a}}s=a+2;var l=e.charCodeAt(a+1);if(l===13){c=true;if(e.charCodeAt(a+2)===10)++s}else if(l===10){c=true}return e.slice(t+1,a).replace(/""/g,'"')}while(s<o){var l=e.charCodeAt(s++),u=1;if(l===10)c=true;else if(l===13){c=true;if(e.charCodeAt(s)===10)++s,++u}else if(l!==n)continue;return e.slice(t,s-u)}return e.slice(t)}while((u=f())!==i){var h=[];while(u!==r&&u!==i){h.push(u);u=f()}if(t&&(h=t(h,l++))==null)continue;a.push(h)}return a};i.format=function(t){if(Array.isArray(t[0]))return i.formatRows(t);var r=new I,n=[];t.forEach(function(e){for(var t in e){if(!r.has(t)){n.push(r.add(t))}}});return[n.map(l).join(e)].concat(t.map(function(t){return n.map(function(e){return l(t[e])}).join(e)})).join("\n")};i.formatRows=function(e){return e.map(s).join("\n")};function s(t){return t.map(l).join(e)}function l(e){return r.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}return i};t.csv=t.dsv(",","text/csv");t.tsv=t.dsv("\t","text/tab-separated-values");var zt,Et,Lt,It,Pt=this[O(this,"requestAnimationFrame")]||function(e){setTimeout(e,17)};t.timer=function(){Dt.apply(this,arguments)};function Dt(e,t,r){var n=arguments.length;if(n<2)t=0;if(n<3)r=Date.now();var i=r+t,a={c:e,t:i,n:null};if(Et)Et.n=a;else zt=a;Et=a;if(!Lt){It=clearTimeout(It);Lt=1;Pt(Ot)}return a}function Ot(){var e=Rt(),t=Ft()-e;if(t>24){if(isFinite(t)){clearTimeout(It);It=setTimeout(Ot,t)}Lt=0}else{Lt=1;Pt(Ot)}}t.timer.flush=function(){Rt();Ft()};function Rt(){var e=Date.now(),t=zt;while(t){if(e>=t.t&&t.c(e-t.t))t.c=null;t=t.n}return e}function Ft(){var e,t=zt,r=Infinity;while(t){if(t.c){if(t.t<r)r=t.t;t=(e=t).n}else{t=e?e.n=t.n:zt=t.n}}Et=e;return r}function Bt(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}t.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)};var Nt=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(jt);t.formatPrefix=function(e,r){var n=0;if(e=+e){if(e<0)e*=-1;if(r)e=t.round(e,Bt(e,r));n=1+Math.floor(1e-12+Math.log(e)/Math.LN10);n=Math.max(-24,Math.min(24,Math.floor((n-1)/3)*3))}return Nt[8+n/3]};function jt(e,t){var r=Math.pow(10,_(8-t)*3);return{scale:t>8?function(e){return e/r}:function(e){return e*r},symbol:e}}function Vt(e){var r=e.decimal,n=e.thousands,i=e.grouping,a=e.currency,o=i&&n?function(e,t){var r=e.length,a=[],o=0,s=i[0],l=0;while(r>0&&s>0){if(l+s+1>t)s=Math.max(1,t-l);a.push(e.substring(r-=s,r+s));if((l+=s+1)>t)break;s=i[o=(o+1)%i.length]}return a.reverse().join(n)}:P;return function(e){var n=qt.exec(e),i=n[1]||" ",s=n[2]||">",l=n[3]||"-",u=n[4]||"",c=n[5],f=+n[6],h=n[7],p=n[8],d=n[9],v=1,m="",g="",y=false,_=true;if(p)p=+p.substring(1);if(c||i==="0"&&s==="="){c=i="0";s="="}switch(d){case"n":h=true;d="g";break;case"%":v=100;g="%";d="f";break;case"p":v=100;g="%";d="r";break;case"b":case"o":case"x":case"X":if(u==="#")m="0"+d.toLowerCase();case"c":_=false;case"d":y=true;p=0;break;case"s":v=-1;d="r";break}if(u==="$")m=a[0],g=a[1];if(d=="r"&&!p)d="g";if(p!=null){if(d=="g")p=Math.max(1,Math.min(21,p));else if(d=="e"||d=="f")p=Math.max(0,Math.min(20,p))}d=Ut.get(d)||Zt;var x=c&&h;return function(e){var n=g;if(y&&e%1)return"";var a=e<0||e===0&&1/e<0?(e=-e,"-"):l==="-"?"":l;if(v<0){var u=t.formatPrefix(e,p);e=u.scale(e);n=u.symbol+g}else{e*=v}e=d(e,p);var b=e.lastIndexOf("."),w,k;if(b<0){var A=_?e.lastIndexOf("e"):-1;if(A<0)w=e,k="";else w=e.substring(0,A),k=e.substring(A)}else{w=e.substring(0,b);k=r+e.substring(b+1)}if(!c&&h)w=o(w,Infinity);var T=m.length+w.length+k.length+(x?0:a.length),M=T<f?new Array(T=f-T+1).join(i):"";if(x)w=o(M+w,M.length?f-k.length:Infinity);a+=m;e=w+k;return(s==="<"?a+e+M:s===">"?M+a+e:s==="^"?M.substring(0,T>>=1)+a+e+M.substring(T):a+(x?e:M+e))+n}}}var qt=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;var Ut=t.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,r){return(e=t.round(e,Bt(e,r))).toFixed(Math.max(0,Math.min(20,Bt(e*(1+1e-15),r))))}});function Zt(e){return e+""}var Ht=t.time={},Gt=Date;function $t(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}$t.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Wt.setUTCDate.apply(this._,arguments)},setDay:function(){Wt.setUTCDay.apply(this._,arguments)},setFullYear:function(){Wt.setUTCFullYear.apply(this._,arguments)},setHours:function(){Wt.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Wt.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Wt.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Wt.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Wt.setUTCSeconds.apply(this._,arguments)},setTime:function(){Wt.setTime.apply(this._,arguments)}};var Wt=Date.prototype;function Xt(e,t,r){function n(t){var r=e(t),n=a(r,1);return t-r<n-t?r:n}function i(r){t(r=e(new Gt(r-1)),1);return r}function a(e,r){t(e=new Gt(+e),r);return e}function o(e,n,a){var o=i(e),s=[];if(a>1){while(o<n){if(!(r(o)%a))s.push(new Date(+o));t(o,1)}}else{while(o<n)s.push(new Date(+o)),t(o,1)}return s}function s(e,t,r){try{Gt=$t;var n=new $t;n._=e;return o(n,t,r)}finally{Gt=Date}}e.floor=e;e.round=n;e.ceil=i;e.offset=a;e.range=o;var l=e.utc=Yt(e);l.floor=l;l.round=Yt(n);l.ceil=Yt(i);l.offset=Yt(a);l.range=s;return e}function Yt(e){return function(t,r){try{Gt=$t;var n=new $t;n._=t;return e(n,r)._}finally{Gt=Date}}}Ht.year=Xt(function(e){e=Ht.day(e);e.setMonth(0,1);return e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()});Ht.years=Ht.year.range;Ht.years.utc=Ht.year.utc.range;Ht.day=Xt(function(e){var t=new Gt(2e3,0);t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate());return t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1});Ht.days=Ht.day.range;Ht.days.utc=Ht.day.utc.range;Ht.dayOfYear=function(e){var t=Ht.year(e);return Math.floor((e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/864e5)};["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(e,t){t=7-t;var r=Ht[e]=Xt(function(e){(e=Ht.day(e)).setDate(e.getDate()-(e.getDay()+t)%7);return e},function(e,t){e.setDate(e.getDate()+Math.floor(t)*7)},function(e){var r=Ht.year(e).getDay();return Math.floor((Ht.dayOfYear(e)+(r+t)%7)/7)-(r!==t)});Ht[e+"s"]=r.range;Ht[e+"s"].utc=r.utc.range;Ht[e+"OfYear"]=function(e){var r=Ht.year(e).getDay();return Math.floor((Ht.dayOfYear(e)+(r+t)%7)/7)}});Ht.week=Ht.sunday;Ht.weeks=Ht.sunday.range;Ht.weeks.utc=Ht.sunday.utc.range;Ht.weekOfYear=Ht.sundayOfYear;function Jt(e){var r=e.dateTime,n=e.date,i=e.time,a=e.periods,o=e.days,s=e.shortDays,l=e.months,u=e.shortMonths;function c(e){var t=e.length;function r(r){var n=[],i=-1,a=0,o,s,l;while(++i<t){if(e.charCodeAt(i)===37){n.push(e.slice(a,i));if((s=Kt[o=e.charAt(++i)])!=null)o=e.charAt(++i);if(l=b[o])o=l(r,s==null?o==="e"?" ":"0":s);n.push(o);a=i+1}}n.push(e.slice(a,i));return n.join("")}r.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},n=f(r,e,t,0);if(n!=t.length)return null;if("p"in r)r.H=r.H%12+r.p*12;var i=r.Z!=null&&Gt!==$t,a=new(i?$t:Gt);if("j"in r)a.setFullYear(r.y,0,r.j);else if("W"in r||"U"in r){if(!("w"in r))r.w="W"in r?1:0;a.setFullYear(r.y,0,1);a.setFullYear(r.y,0,"W"in r?(r.w+6)%7+r.W*7-(a.getDay()+5)%7:r.w+r.U*7-(a.getDay()+6)%7)}else a.setFullYear(r.y,r.m,r.d);a.setHours(r.H+(r.Z/100|0),r.M+r.Z%100,r.S,r.L);return i?a._:a};r.toString=function(){return e};return r}function f(e,t,r,n){var i,a,o,s=0,l=t.length,u=r.length;while(s<l){if(n>=u)return-1;i=t.charCodeAt(s++);if(i===37){o=t.charAt(s++);a=w[o in Kt?t.charAt(s++):o];if(!a||(n=a(e,r,n))<0)return-1}else if(i!=r.charCodeAt(n++)){return-1}}return n}c.utc=function(e){var t=c(e);function r(e){try{Gt=$t;var r=new Gt;r._=e;return t(r)}finally{Gt=Date}}r.parse=function(e){try{Gt=$t;var r=t.parse(e);return r&&r._}finally{Gt=Date}};r.toString=t.toString;return r};c.multi=c.utc.multi=xr;var h=t.map(),p=rr(o),d=nr(o),v=rr(s),m=nr(s),g=rr(l),y=nr(l),_=rr(u),x=nr(u);a.forEach(function(e,t){h.set(e.toLowerCase(),t)});var b={a:function(e){return s[e.getDay()]},A:function(e){return o[e.getDay()]},b:function(e){return u[e.getMonth()]},B:function(e){return l[e.getMonth()]},c:c(r),d:function(e,t){return tr(e.getDate(),t,2)},e:function(e,t){return tr(e.getDate(),t,2)},H:function(e,t){return tr(e.getHours(),t,2)},I:function(e,t){return tr(e.getHours()%12||12,t,2)},j:function(e,t){return tr(1+Ht.dayOfYear(e),t,3)},L:function(e,t){return tr(e.getMilliseconds(),t,3)},m:function(e,t){return tr(e.getMonth()+1,t,2)},M:function(e,t){return tr(e.getMinutes(),t,2)},p:function(e){return a[+(e.getHours()>=12)]},S:function(e,t){return tr(e.getSeconds(),t,2)},U:function(e,t){return tr(Ht.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return tr(Ht.mondayOfYear(e),t,2)},x:c(n),X:c(i),y:function(e,t){return tr(e.getFullYear()%100,t,2)},Y:function(e,t){return tr(e.getFullYear()%1e4,t,4)},Z:yr,"%":function(){return"%"}};var w={a:k,A:A,b:T,B:M,c:S,d:hr,e:hr,H:dr,I:dr,j:pr,L:gr,m:fr,M:vr,p:E,S:mr,U:ar,w:ir,W:or,x:C,X:z,y:lr,Y:sr,Z:ur,"%":_r};function k(e,t,r){v.lastIndex=0;var n=v.exec(t.slice(r));return n?(e.w=m.get(n[0].toLowerCase()),r+n[0].length):-1}function A(e,t,r){p.lastIndex=0;var n=p.exec(t.slice(r));return n?(e.w=d.get(n[0].toLowerCase()),r+n[0].length):-1}function T(e,t,r){_.lastIndex=0;var n=_.exec(t.slice(r));return n?(e.m=x.get(n[0].toLowerCase()),r+n[0].length):-1}function M(e,t,r){g.lastIndex=0;var n=g.exec(t.slice(r));return n?(e.m=y.get(n[0].toLowerCase()),r+n[0].length):-1}function S(e,t,r){return f(e,b.c.toString(),t,r)}function C(e,t,r){return f(e,b.x.toString(),t,r)}function z(e,t,r){return f(e,b.X.toString(),t,r)}function E(e,t,r){var n=h.get(t.slice(r,r+=2).toLowerCase());return n==null?-1:(e.p=n,r)}return c}var Kt={"-":"",_:" ",0:"0"},Qt=/^\s*\d+/,er=/^%/;function tr(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function rr(e){return new RegExp("^(?:"+e.map(t.requote).join("|")+")","i")}function nr(e){var t=new w,r=-1,n=e.length;while(++r<n)t.set(e[r].toLowerCase(),r);return t}function ir(e,t,r){Qt.lastIndex=0;var n=Qt.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function ar(e,t,r){Qt.lastIndex=0;var n=Qt.exec(t.slice(r));return n?(e.U=+n[0],r+n[0].length):-1}function or(e,t,r){Qt.lastIndex=0;var n=Qt.exec(t.slice(r));return n?(e.W=+n[0],r+n[0].length):-1}function sr(e,t,r){Qt.lastIndex=0;var n=Qt.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function lr(e,t,r){Qt.lastIndex=0;var n=Qt.exec(t.slice(r,r+2));return n?(e.y=cr(+n[0]),r+n[0].length):-1}function ur(e,t,r){return/^[+-]\d{4}$/.test(t=t.slice(r,r+5))?(e.Z=-t,r+5):-1}function cr(e){return e+(e>68?1900:2e3)}function fr(e,t,r){Qt.lastIndex=0;var n=Qt.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function hr(e,t,r){Qt.lastIndex=0;var n=Qt.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function pr(e,t,r){Qt.lastIndex=0;var n=Qt.exec(t.slice(r,r+3));return n?(e.j=+n[0],r+n[0].length):-1}function dr(e,t,r){Qt.lastIndex=0;var n=Qt.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function vr(e,t,r){Qt.lastIndex=0;var n=Qt.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function mr(e,t,r){Qt.lastIndex=0;var n=Qt.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function gr(e,t,r){Qt.lastIndex=0;var n=Qt.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function yr(e){var t=e.getTimezoneOffset(),r=t>0?"-":"+",n=_(t)/60|0,i=_(t)%60;return r+tr(n,"0",2)+tr(i,"0",2)}function _r(e,t,r){er.lastIndex=0;var n=er.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function xr(e){var t=e.length,r=-1;while(++r<t)e[r][0]=this(e[r][0]);return function(t){var r=0,n=e[r];while(!n[1](t))n=e[++r];return n[0](t)}}t.locale=function(e){return{numberFormat:Vt(e),timeFormat:Jt(e)}};var br=t.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});t.format=br.numberFormat;t.geo={};function wr(){}wr.prototype={s:0,t:0,add:function(e){Ar(e,this.t,kr);Ar(kr.s,this.s,this);if(this.s)this.t+=kr.t;else this.s=kr.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var kr=new wr;function Ar(e,t,r){var n=r.s=e+t,i=n-e,a=n-i;r.t=e-a+(t-i)}t.geo.stream=function(e,t){if(e&&Mr.hasOwnProperty(e.type)){Mr[e.type](e,t)}else{Tr(e,t)}};function Tr(e,t){if(e&&Sr.hasOwnProperty(e.type)){Sr[e.type](e,t)}}var Mr={Feature:function(e,t){Tr(e.geometry,t)},FeatureCollection:function(e,t){var r=e.features,n=-1,i=r.length;while(++n<i)Tr(r[n].geometry,t)}};var Sr={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates;t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){var r=e.coordinates,n=-1,i=r.length;while(++n<i)e=r[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){Cr(e.coordinates,t,0)},MultiLineString:function(e,t){var r=e.coordinates,n=-1,i=r.length;while(++n<i)Cr(r[n],t,0)},Polygon:function(e,t){zr(e.coordinates,t)},MultiPolygon:function(e,t){var r=e.coordinates,n=-1,i=r.length;while(++n<i)zr(r[n],t)},GeometryCollection:function(e,t){var r=e.geometries,n=-1,i=r.length;while(++n<i)Tr(r[n],t)}};function Cr(e,t,r){var n=-1,i=e.length-r,a;t.lineStart();while(++n<i)a=e[n],t.point(a[0],a[1],a[2]);t.lineEnd()}function zr(e,t){var r=-1,n=e.length;t.polygonStart();while(++r<n)Cr(e[r],t,1);t.polygonEnd()}t.geo.area=function(e){Er=0;t.geo.stream(e,Ir);return Er};var Er,Lr=new wr;var Ir={sphere:function(){Er+=4*ze},point:F,lineStart:F,lineEnd:F,polygonStart:function(){Lr.reset();Ir.lineStart=Pr},polygonEnd:function(){var e=2*Lr;Er+=e<0?4*ze+e:e;Ir.lineStart=Ir.lineEnd=Ir.point=F}};function Pr(){var e,t,r,n,i;Ir.point=function(o,s){Ir.point=a;r=(e=o)*Pe,n=Math.cos(s=(t=s)*Pe/2+ze/4),i=Math.sin(s)};function a(e,t){e*=Pe;t=t*Pe/2+ze/4;var a=e-r,o=a>=0?1:-1,s=o*a,l=Math.cos(t),u=Math.sin(t),c=i*u,f=n*l+c*Math.cos(s),h=c*o*Math.sin(s);Lr.add(Math.atan2(h,f));r=e,n=l,i=u}Ir.lineEnd=function(){a(e,t)}}function Dr(e){var t=e[0],r=e[1],n=Math.cos(r);return[n*Math.cos(t),n*Math.sin(t),Math.sin(r)]}function Or(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Rr(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Fr(e,t){e[0]+=t[0];e[1]+=t[1];e[2]+=t[2]}function Br(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Nr(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t;e[1]/=t;e[2]/=t}function jr(e){return[Math.atan2(e[1],e[0]),Be(e[2])]}function Vr(e,t){return _(e[0]-t[0])<Se&&_(e[1]-t[1])<Se}t.geo.bounds=function(){var e,r,n,i,a,o,s,l,u,c,f;var h={point:p,lineStart:v,lineEnd:m,polygonStart:function(){h.point=g;h.lineStart=y;h.lineEnd=x;u=0;Ir.polygonStart()},polygonEnd:function(){Ir.polygonEnd();h.point=p;h.lineStart=v;h.lineEnd=m;if(Lr<0)e=-(n=180),r=-(i=90);else if(u>Se)i=90;else if(u<-Se)r=-90;f[0]=e,f[1]=n}};function p(t,a){c.push(f=[e=t,n=t]);if(a<r)r=a;if(a>i)i=a}function d(t,o){var s=Dr([t*Pe,o*Pe]);if(l){var u=Rr(l,s),c=[u[1],-u[0],0],f=Rr(c,u);Nr(f);f=jr(f);var h=t-a,d=h>0?1:-1,v=f[0]*De*d,m=_(h)>180;if(m^(d*a<v&&v<d*t)){var g=f[1]*De;if(g>i)i=g}else if(v=(v+360)%360-180,m^(d*a<v&&v<d*t)){var g=-f[1]*De;if(g<r)r=g}else{if(o<r)r=o;if(o>i)i=o}if(m){if(t<a){if(b(e,t)>b(e,n))n=t}else{if(b(t,n)>b(e,n))e=t}}else{if(n>=e){if(t<e)e=t;if(t>n)n=t}else{if(t>a){if(b(e,t)>b(e,n))n=t}else{if(b(t,n)>b(e,n))e=t}}}}else{p(t,o)}l=s,a=t}function v(){h.point=d}function m(){f[0]=e,f[1]=n;h.point=p;l=null}function g(e,t){if(l){var r=e-a;u+=_(r)>180?r+(r>0?360:-360):r}else o=e,s=t;Ir.point(e,t);d(e,t)}function y(){Ir.lineStart()}function x(){g(o,s);Ir.lineEnd();if(_(u)>Se)e=-(n=180);f[0]=e,f[1]=n;l=null}function b(e,t){return(t-=e)<0?t+360:t}function w(e,t){return e[0]-t[0]}function k(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}return function(a){i=n=-(e=r=Infinity);c=[];t.geo.stream(a,h);var o=c.length;if(o){c.sort(w);for(var s=1,l=c[0],u,p=[l];s<o;++s){u=c[s];if(k(u[0],l)||k(u[1],l)){if(b(l[0],u[1])>b(l[0],l[1]))l[1]=u[1];if(b(u[0],l[1])>b(l[0],l[1]))l[0]=u[0]}else{p.push(l=u)}}var d=-Infinity,v;for(var o=p.length-1,s=0,l=p[o],u;s<=o;l=u,++s){u=p[s];if((v=b(l[1],u[0]))>d)d=v,e=u[0],n=l[1]}}c=f=null;return e===Infinity||r===Infinity?[[NaN,NaN],[NaN,NaN]]:[[e,r],[n,i]]}}();t.geo.centroid=function(e){qr=Ur=Zr=Hr=Gr=$r=Wr=Xr=Yr=Jr=Kr=0;t.geo.stream(e,Qr);var r=Yr,n=Jr,i=Kr,a=r*r+n*n+i*i;if(a<Ce){r=$r,n=Wr,i=Xr;if(Ur<Se)r=Zr,n=Hr,i=Gr;a=r*r+n*n+i*i;if(a<Ce)return[NaN,NaN]}return[Math.atan2(n,r)*De,Be(i/Math.sqrt(a))*De]};var qr,Ur,Zr,Hr,Gr,$r,Wr,Xr,Yr,Jr,Kr;var Qr={sphere:F,point:en,lineStart:rn,lineEnd:nn,polygonStart:function(){Qr.lineStart=an},polygonEnd:function(){Qr.lineStart=rn}};function en(e,t){e*=Pe;var r=Math.cos(t*=Pe);tn(r*Math.cos(e),r*Math.sin(e),Math.sin(t))}function tn(e,t,r){++qr;Zr+=(e-Zr)/qr;Hr+=(t-Hr)/qr;Gr+=(r-Gr)/qr}function rn(){var e,t,r;Qr.point=function(i,a){i*=Pe;var o=Math.cos(a*=Pe);e=o*Math.cos(i);t=o*Math.sin(i);r=Math.sin(a);Qr.point=n;tn(e,t,r)};function n(n,i){n*=Pe;var a=Math.cos(i*=Pe),o=a*Math.cos(n),s=a*Math.sin(n),l=Math.sin(i),u=Math.atan2(Math.sqrt((u=t*l-r*s)*u+(u=r*o-e*l)*u+(u=e*s-t*o)*u),e*o+t*s+r*l);Ur+=u;$r+=u*(e+(e=o));Wr+=u*(t+(t=s));Xr+=u*(r+(r=l));tn(e,t,r)}}function nn(){Qr.point=en}function an(){var e,t,r,n,i;Qr.point=function(o,s){e=o,t=s;Qr.point=a;o*=Pe;var l=Math.cos(s*=Pe);r=l*Math.cos(o);n=l*Math.sin(o);i=Math.sin(s);tn(r,n,i)};Qr.lineEnd=function(){a(e,t);Qr.lineEnd=nn;Qr.point=en};function a(e,t){e*=Pe;var a=Math.cos(t*=Pe),o=a*Math.cos(e),s=a*Math.sin(e),l=Math.sin(t),u=n*l-i*s,c=i*o-r*l,f=r*s-n*o,h=Math.sqrt(u*u+c*c+f*f),p=r*o+n*s+i*l,d=h&&-Fe(p)/h,v=Math.atan2(h,p);Yr+=d*u;Jr+=d*c;Kr+=d*f;Ur+=v;$r+=v*(r+(r=o));Wr+=v*(n+(n=s));Xr+=v*(i+(i=l));tn(r,n,i)}}function on(e,t){function r(r,n){return r=e(r,n),t(r[0],r[1])}if(e.invert&&t.invert)r.invert=function(r,n){return r=t.invert(r,n),r&&e.invert(r[0],r[1])};return r}function sn(){return true}function ln(e,t,r,n,i){var a=[],o=[];e.forEach(function(e){if((t=e.length-1)<=0)return;var t,r=e[0],n=e[t];if(Vr(r,n)){i.lineStart();for(var s=0;s<t;++s)i.point((r=e[s])[0],r[1]);i.lineEnd();return}var l=new cn(r,e,null,true),u=new cn(r,null,l,false);l.o=u;a.push(l);o.push(u);l=new cn(n,e,null,false);u=new cn(n,null,l,true);l.o=u;a.push(l);o.push(u)});o.sort(t);un(a);un(o);if(!a.length)return;for(var s=0,l=r,u=o.length;s<u;++s){o[s].e=l=!l}var c=a[0],f,h;while(1){var p=c,d=true;while(p.v)if((p=p.n)===c)return;f=p.z;i.lineStart();do{p.v=p.o.v=true;if(p.e){if(d){for(var s=0,u=f.length;s<u;++s)i.point((h=f[s])[0],h[1])}else{n(p.x,p.n.x,1,i)}p=p.n}else{if(d){f=p.p.z;for(var s=f.length-1;s>=0;--s)i.point((h=f[s])[0],h[1])}else{n(p.x,p.p.x,-1,i)}p=p.p}p=p.o;f=p.z;d=!d}while(!p.v);i.lineEnd()}}function un(e){if(!(t=e.length))return;var t,r=0,n=e[0],i;while(++r<t){n.n=i=e[r];i.p=n;n=i}n.n=i=e[0];i.p=n}function cn(e,t,r,n){this.x=e;this.z=t;this.o=r;this.e=n;this.v=false;this.n=this.p=null}function fn(e,r,n,i){return function(a,o){var s=r(o),l=a.invert(i[0],i[1]);var u={point:c,lineStart:h,lineEnd:p,polygonStart:function(){u.point=x;u.lineStart=b;u.lineEnd=w;d=[];y=[]},polygonEnd:function(){u.point=c;u.lineStart=h;u.lineEnd=p;d=t.merge(d);var e=_n(l,y);if(d.length){if(!g)o.polygonStart(),g=true;ln(d,dn,e,n,o)}else if(e){if(!g)o.polygonStart(),g=true;o.lineStart();n(null,null,1,o);o.lineEnd()}if(g)o.polygonEnd(),g=false;d=y=null},sphere:function(){o.polygonStart();o.lineStart();n(null,null,1,o);o.lineEnd();o.polygonEnd()}};function c(t,r){var n=a(t,r);if(e(t=n[0],r=n[1]))o.point(t,r)}function f(e,t){var r=a(e,t);s.point(r[0],r[1])}function h(){u.point=f;s.lineStart()}function p(){u.point=c;s.lineEnd()}var d;var v=pn(),m=r(v),g=false,y,_;function x(e,t){_.push([e,t]);var r=a(e,t);m.point(r[0],r[1])}function b(){m.lineStart();_=[]}function w(){x(_[0][0],_[0][1]);m.lineEnd();var e=m.clean(),t=v.buffer(),r,n=t.length;_.pop();y.push(_);_=null;if(!n)return;if(e&1){r=t[0];var n=r.length-1,i=-1,a;if(n>0){if(!g)o.polygonStart(),g=true;o.lineStart();while(++i<n)o.point((a=r[i])[0],a[1]);o.lineEnd()}return}if(n>1&&e&2)t.push(t.pop().concat(t.shift()));d.push(t.filter(hn))}return u}}function hn(e){return e.length>1}function pn(){var e=[],t;return{lineStart:function(){e.push(t=[])},point:function(e,r){t.push([e,r])},lineEnd:F,buffer:function(){var r=e;e=[];t=null;return r},rejoin:function(){if(e.length>1)e.push(e.pop().concat(e.shift()))}}}function dn(e,t){return((e=e.x)[0]<0?e[1]-Ie-Se:Ie-e[1])-((t=t.x)[0]<0?t[1]-Ie-Se:Ie-t[1])}var vn=fn(sn,mn,yn,[-ze,-ze/2]);function mn(e){var t=NaN,r=NaN,n=NaN,i;return{lineStart:function(){e.lineStart();i=1},point:function(a,o){var s=a>0?ze:-ze,l=_(a-t);if(_(l-ze)<Se){e.point(t,r=(r+o)/2>0?Ie:-Ie);e.point(n,r);e.lineEnd();e.lineStart();e.point(s,r);e.point(a,r);i=0}else if(n!==s&&l>=ze){if(_(t-n)<Se)t-=n*Se;if(_(a-s)<Se)a-=s*Se;r=gn(t,r,a,o);e.point(n,r);e.lineEnd();e.lineStart();e.point(s,r);i=0}e.point(t=a,r=o);n=s},lineEnd:function(){e.lineEnd();t=r=NaN},clean:function(){return 2-i}}}function gn(e,t,r,n){var i,a,o=Math.sin(e-r);return _(o)>Se?Math.atan((Math.sin(t)*(a=Math.cos(n))*Math.sin(r)-Math.sin(n)*(i=Math.cos(t))*Math.sin(e))/(i*a*o)):(t+n)/2}function yn(e,t,r,n){var i;if(e==null){i=r*Ie;n.point(-ze,i);n.point(0,i);n.point(ze,i);n.point(ze,0);n.point(ze,-i);n.point(0,-i);n.point(-ze,-i);n.point(-ze,0);n.point(-ze,i)}else if(_(e[0]-t[0])>Se){var a=e[0]<t[0]?ze:-ze;i=r*a/2;n.point(-a,i);n.point(0,i);n.point(a,i)}else{n.point(t[0],t[1])}}function _n(e,t){var r=e[0],n=e[1],i=[Math.sin(r),-Math.cos(r),0],a=0,o=0;Lr.reset();for(var s=0,l=t.length;s<l;++s){var u=t[s],c=u.length;if(!c)continue;var f=u[0],h=f[0],p=f[1]/2+ze/4,d=Math.sin(p),v=Math.cos(p),m=1;while(true){if(m===c)m=0;e=u[m];var g=e[0],y=e[1]/2+ze/4,_=Math.sin(y),x=Math.cos(y),b=g-h,w=b>=0?1:-1,k=w*b,A=k>ze,T=d*_;Lr.add(Math.atan2(T*w*Math.sin(k),v*x+T*Math.cos(k)));a+=A?b+w*Ee:b;if(A^h>=r^g>=r){var M=Rr(Dr(f),Dr(e));Nr(M);var S=Rr(i,M);Nr(S);var C=(A^b>=0?-1:1)*Be(S[2]);if(n>C||n===C&&(M[0]||M[1])){o+=A^b>=0?1:-1}}if(!m++)break;h=g,d=_,v=x,f=e}}return(a<-Se||a<Se&&Lr<-Se)^o&1}function xn(e){var t=Math.cos(e),r=t>0,n=_(t)>Se,i=ni(e,6*Pe);return fn(a,o,i,r?[0,-e]:[-ze,e-ze]);function a(e,r){return Math.cos(e)*Math.cos(r)>t}function o(e){var t,i,o,u,c;return{lineStart:function(){u=o=false;c=1},point:function(f,h){var p=[f,h],d,v=a(f,h),m=r?v?0:l(f,h):v?l(f+(f<0?ze:-ze),h):0;if(!t&&(u=o=v))e.lineStart();if(v!==o){d=s(t,p);if(Vr(t,d)||Vr(p,d)){p[0]+=Se;p[1]+=Se;v=a(p[0],p[1])}}if(v!==o){c=0;if(v){e.lineStart();d=s(p,t);e.point(d[0],d[1])}else{d=s(t,p);e.point(d[0],d[1]);e.lineEnd()}t=d}else if(n&&t&&r^v){var g;if(!(m&i)&&(g=s(p,t,true))){c=0;if(r){e.lineStart();e.point(g[0][0],g[0][1]);e.point(g[1][0],g[1][1]);e.lineEnd()}else{e.point(g[1][0],g[1][1]);e.lineEnd();e.lineStart();e.point(g[0][0],g[0][1])}}}if(v&&(!t||!Vr(t,p))){e.point(p[0],p[1])}t=p,o=v,i=m},lineEnd:function(){if(o)e.lineEnd();t=null},clean:function(){return c|(u&&o)<<1}}}function s(e,r,n){var i=Dr(e),a=Dr(r);var o=[1,0,0],s=Rr(i,a),l=Or(s,s),u=s[0],c=l-u*u;if(!c)return!n&&e;var f=t*l/c,h=-t*u/c,p=Rr(o,s),d=Br(o,f),v=Br(s,h);Fr(d,v);var m=p,g=Or(d,m),y=Or(m,m),x=g*g-y*(Or(d,d)-1);if(x<0)return;var b=Math.sqrt(x),w=Br(m,(-g-b)/y);Fr(w,d);w=jr(w);if(!n)return w;var k=e[0],A=r[0],T=e[1],M=r[1],S;if(A<k)S=k,k=A,A=S;var C=A-k,z=_(C-ze)<Se,E=z||C<Se;if(!z&&M<T)S=T,T=M,M=S;if(E?z?T+M>0^w[1]<(_(w[0]-k)<Se?T:M):T<=w[1]&&w[1]<=M:C>ze^(k<=w[0]&&w[0]<=A)){var L=Br(m,(-g+b)/y);Fr(L,d);return[w,jr(L)]}}function l(t,n){var i=r?e:ze-e,a=0;if(t<-i)a|=1;else if(t>i)a|=2;if(n<-i)a|=4;else if(n>i)a|=8;return a}}function bn(e,t,r,n){return function(i){var a=i.a,o=i.b,s=a.x,l=a.y,u=o.x,c=o.y,f=0,h=1,p=u-s,d=c-l,v;v=e-s;if(!p&&v>0)return;v/=p;if(p<0){if(v<f)return;if(v<h)h=v}else if(p>0){if(v>h)return;if(v>f)f=v}v=r-s;if(!p&&v<0)return;v/=p;if(p<0){if(v>h)return;if(v>f)f=v}else if(p>0){if(v<f)return;if(v<h)h=v}v=t-l;if(!d&&v>0)return;v/=d;if(d<0){if(v<f)return;if(v<h)h=v}else if(d>0){if(v>h)return;if(v>f)f=v}v=n-l;if(!d&&v<0)return;v/=d;if(d<0){if(v>h)return;if(v>f)f=v}else if(d>0){if(v<f)return;if(v<h)h=v}if(f>0)i.a={x:s+f*p,y:l+f*d};if(h<1)i.b={x:s+h*p,y:l+h*d};return i}}var wn=1e9;t.geo.clipExtent=function(){var e,t,r,n,i,a,o={stream:function(e){if(i)i.valid=false;i=a(e);i.valid=true;return i},extent:function(s){if(!arguments.length)return[[e,t],[r,n]];a=kn(e=+s[0][0],t=+s[0][1],r=+s[1][0],n=+s[1][1]);if(i)i.valid=false,i=null;return o}};return o.extent([[0,0],[960,500]])};function kn(e,r,n,i){return function(l){var u=l,c=pn(),f=bn(e,r,n,i),h,p,d;var v={point:_,lineStart:C,lineEnd:z,polygonStart:function(){l=c;h=[];p=[];S=true},polygonEnd:function(){l=u;h=t.merge(h);var r=m([e,i]),n=S&&r,a=h.length;if(n||a){l.polygonStart();if(n){l.lineStart();g(null,null,1,l);l.lineEnd()}if(a){ln(h,o,r,g,l)}l.polygonEnd()}h=p=d=null}};function m(e){var t=0,r=p.length,n=e[1];for(var i=0;i<r;++i){for(var a=1,o=p[i],s=o.length,l=o[0],u;a<s;++a){u=o[a];if(l[1]<=n){if(u[1]>n&&Re(l,u,e)>0)++t}else{if(u[1]<=n&&Re(l,u,e)<0)--t}l=u}}return t!==0}function g(t,o,l,u){var c=0,f=0;if(t==null||(c=a(t,l))!==(f=a(o,l))||s(t,o)<0^l>0){do{u.point(c===0||c===3?e:n,c>1?i:r)}while((c=(c+l+4)%4)!==f)}else{u.point(o[0],o[1])}}function y(t,a){return e<=t&&t<=n&&r<=a&&a<=i}function _(e,t){if(y(e,t))l.point(e,t)}var x,b,w,k,A,T,M,S;function C(){v.point=E;if(p)p.push(d=[]);M=true;T=false;k=A=NaN}function z(){if(h){E(x,b);if(w&&T)c.rejoin();h.push(c.buffer())}v.point=_;if(T)l.lineEnd()}function E(e,t){e=Math.max(-wn,Math.min(wn,e));t=Math.max(-wn,Math.min(wn,t));var r=y(e,t);if(p)d.push([e,t]);if(M){x=e,b=t,w=r;M=false;if(r){l.lineStart();l.point(e,t)}}else{if(r&&T)l.point(e,t);else{var n={a:{x:k,y:A},b:{x:e,y:t}};if(f(n)){if(!T){l.lineStart();l.point(n.a.x,n.a.y)}l.point(n.b.x,n.b.y);if(!r)l.lineEnd();S=false}else if(r){l.lineStart();l.point(e,t);S=false}}}k=e,A=t,T=r}return v};function a(t,i){return _(t[0]-e)<Se?i>0?0:3:_(t[0]-n)<Se?i>0?2:1:_(t[1]-r)<Se?i>0?1:0:i>0?3:2}function o(e,t){return s(e.x,t.x)}function s(e,t){var r=a(e,1),n=a(t,1);return r!==n?r-n:r===0?t[1]-e[1]:r===1?e[0]-t[0]:r===2?e[1]-t[1]:t[0]-e[0]}}function An(e){var t=0,r=ze/3,n=Xn(e),i=n(t,r);i.parallels=function(e){if(!arguments.length)return[t/ze*180,r/ze*180];return n(t=e[0]*ze/180,r=e[1]*ze/180)};return i}function Tn(e,t){var r=Math.sin(e),n=(r+Math.sin(t))/2,i=1+r*(2*n-r),a=Math.sqrt(i)/n;function o(e,t){var r=Math.sqrt(i-2*n*Math.sin(t))/n;return[r*Math.sin(e*=n),a-r*Math.cos(e)]}o.invert=function(e,t){var r=a-t;return[Math.atan2(e,r)/n,Be((i-(e*e+r*r)*n*n)/(2*n))]};return o}(t.geo.conicEqualArea=function(){return An(Tn)}).raw=Tn;t.geo.albers=function(){return t.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};t.geo.albersUsa=function(){var e=t.geo.albers();var r=t.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]);var n=t.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]);var i,a={point:function(e,t){i=[e,t]}},o,s,l;function u(e){var t=e[0],r=e[1];i=null;(o(t,r),i)||(s(t,r),i)||l(t,r);return i}u.invert=function(t){var i=e.scale(),a=e.translate(),o=(t[0]-a[0])/i,s=(t[1]-a[1])/i;return(s>=.12&&s<.234&&o>=-.425&&o<-.214?r:s>=.166&&s<.234&&o>=-.214&&o<-.115?n:e).invert(t)};u.stream=function(t){var i=e.stream(t),a=r.stream(t),o=n.stream(t);return{point:function(e,t){i.point(e,t);a.point(e,t);o.point(e,t)},sphere:function(){i.sphere();a.sphere();o.sphere()},lineStart:function(){i.lineStart();a.lineStart();o.lineStart()},lineEnd:function(){i.lineEnd();a.lineEnd();o.lineEnd()},polygonStart:function(){i.polygonStart();a.polygonStart();o.polygonStart()},polygonEnd:function(){i.polygonEnd();a.polygonEnd();o.polygonEnd()}}};u.precision=function(t){if(!arguments.length)return e.precision();e.precision(t);r.precision(t);n.precision(t);return u};u.scale=function(t){if(!arguments.length)return e.scale();e.scale(t);r.scale(t*.35);n.scale(t);return u.translate(e.translate())};u.translate=function(t){if(!arguments.length)return e.translate();var i=e.scale(),c=+t[0],f=+t[1];o=e.translate(t).clipExtent([[c-.455*i,f-.238*i],[c+.455*i,f+.238*i]]).stream(a).point;s=r.translate([c-.307*i,f+.201*i]).clipExtent([[c-.425*i+Se,f+.12*i+Se],[c-.214*i-Se,f+.234*i-Se]]).stream(a).point;l=n.translate([c-.205*i,f+.212*i]).clipExtent([[c-.214*i+Se,f+.166*i+Se],[c-.115*i-Se,f+.234*i-Se]]).stream(a).point;return u};return u.scale(1070)};var Mn,Sn,Cn={point:F,lineStart:F,lineEnd:F,polygonStart:function(){Sn=0;Cn.lineStart=zn},polygonEnd:function(){Cn.lineStart=Cn.lineEnd=Cn.point=F;Mn+=_(Sn/2)}};function zn(){var e,t,r,n;Cn.point=function(a,o){Cn.point=i;e=r=a,t=n=o};function i(e,t){Sn+=n*e-r*t;r=e,n=t}Cn.lineEnd=function(){i(e,t)}}var En,Ln,In,Pn;var Dn={point:On,lineStart:F,lineEnd:F,polygonStart:F,polygonEnd:F};function On(e,t){if(e<En)En=e;if(e>In)In=e;if(t<Ln)Ln=t;if(t>Pn)Pn=t}function Rn(){var e=Fn(4.5),t=[];var r={point:n,lineStart:function(){r.point=i},lineEnd:o,polygonStart:function(){r.lineEnd=s},polygonEnd:function(){r.lineEnd=o;r.point=n},pointRadius:function(t){e=Fn(t);return r},result:function(){if(t.length){var e=t.join("");t=[];return e}}};function n(r,n){t.push("M",r,",",n,e)}function i(e,n){t.push("M",e,",",n);r.point=a}function a(e,r){t.push("L",e,",",r)}function o(){r.point=n}function s(){t.push("Z")}return r}function Fn(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}var Bn={point:Nn,lineStart:jn,lineEnd:Vn,polygonStart:function(){Bn.lineStart=qn},polygonEnd:function(){Bn.point=Nn;Bn.lineStart=jn;Bn.lineEnd=Vn}};function Nn(e,t){Zr+=e;Hr+=t;++Gr}function jn(){var e,t;Bn.point=function(n,i){Bn.point=r;Nn(e=n,t=i)};function r(r,n){var i=r-e,a=n-t,o=Math.sqrt(i*i+a*a);$r+=o*(e+r)/2;Wr+=o*(t+n)/2;Xr+=o;Nn(e=r,t=n)}}function Vn(){Bn.point=Nn}function qn(){var e,t,r,n;Bn.point=function(a,o){Bn.point=i;Nn(e=r=a,t=n=o)};function i(e,t){var i=e-r,a=t-n,o=Math.sqrt(i*i+a*a);$r+=o*(r+e)/2;Wr+=o*(n+t)/2;Xr+=o;o=n*e-r*t;Yr+=o*(r+e);Jr+=o*(n+t);Kr+=o*3;Nn(r=e,n=t)}Bn.lineEnd=function(){i(e,t)}}function Un(e){var t=4.5;var r={point:n,lineStart:function(){r.point=i},lineEnd:o,polygonStart:function(){r.lineEnd=s},polygonEnd:function(){r.lineEnd=o;r.point=n},pointRadius:function(e){t=e;return r},result:F};function n(r,n){e.moveTo(r+t,n);e.arc(r,n,t,0,Ee)}function i(t,n){e.moveTo(t,n);r.point=a}function a(t,r){e.lineTo(t,r)}function o(){r.point=n}function s(){e.closePath()}return r}function Zn(e){var t=.5,r=Math.cos(30*Pe),n=16;function i(e){return(n?o:a)(e)}function a(t){return $n(t,function(r,n){r=e(r,n);t.point(r[0],r[1])})}function o(t){var r,i,a,o,l,u,c,f,h,p,d,v,m;var g={point:y,lineStart:_,lineEnd:b,polygonStart:function(){t.polygonStart();g.lineStart=w},polygonEnd:function(){t.polygonEnd();g.lineStart=_}};function y(r,n){r=e(r,n);t.point(r[0],r[1])}function _(){h=NaN;g.point=x;t.lineStart()}function x(r,i){var a=Dr([r,i]),o=e(r,i);s(h,p,f,d,v,m,h=o[0],p=o[1],f=r,d=a[0],v=a[1],m=a[2],n,t);t.point(h,p)}function b(){g.point=y;t.lineEnd()}function w(){_();g.point=k;g.lineEnd=A}function k(e,t){x(r=e,i=t),a=h,o=p,l=d,u=v,c=m;g.point=x}function A(){s(h,p,f,d,v,m,a,o,r,l,u,c,n,t);g.lineEnd=b;b()}return g}function s(n,i,a,o,l,u,c,f,h,p,d,v,m,g){var y=c-n,x=f-i,b=y*y+x*x;if(b>4*t&&m--){var w=o+p,k=l+d,A=u+v,T=Math.sqrt(w*w+k*k+A*A),M=Math.asin(A/=T),S=_(_(A)-1)<Se||_(a-h)<Se?(a+h)/2:Math.atan2(k,w),C=e(S,M),z=C[0],E=C[1],L=z-n,I=E-i,P=x*L-y*I;if(P*P/b>t||_((y*L+x*I)/b-.5)>.3||o*p+l*d+u*v<r){s(n,i,a,o,l,u,z,E,S,w/=T,k/=T,A,m,g);g.point(z,E);s(z,E,S,w,k,A,c,f,h,p,d,v,m,g)}}}i.precision=function(e){if(!arguments.length)return Math.sqrt(t);n=(t=e*e)>0&&16;return i};return i}t.geo.path=function(){var e=4.5,r,n,i,a,o;function s(r){if(r){if(typeof e==="function")a.pointRadius(+e.apply(this,arguments));if(!o||!o.valid)o=i(a);t.geo.stream(r,o)}return a.result()}s.area=function(e){Mn=0;t.geo.stream(e,i(Cn));return Mn};s.centroid=function(e){Zr=Hr=Gr=$r=Wr=Xr=Yr=Jr=Kr=0;t.geo.stream(e,i(Bn));return Kr?[Yr/Kr,Jr/Kr]:Xr?[$r/Xr,Wr/Xr]:Gr?[Zr/Gr,Hr/Gr]:[NaN,NaN]};s.bounds=function(e){In=Pn=-(En=Ln=Infinity);t.geo.stream(e,i(Dn));return[[En,Ln],[In,Pn]]};s.projection=function(e){if(!arguments.length)return r;i=(r=e)?e.stream||Hn(e):P;return l()};s.context=function(t){if(!arguments.length)return n;a=(n=t)==null?new Rn:new Un(t);if(typeof e!=="function")a.pointRadius(e);return l()};s.pointRadius=function(t){if(!arguments.length)return e;e=typeof t==="function"?t:(a.pointRadius(+t),+t);return s};function l(){o=null;return s}return s.projection(t.geo.albersUsa()).context(null)};function Hn(e){var t=Zn(function(t,r){return e([t*De,r*De])});return function(e){return Yn(t(e))}}t.geo.transform=function(e){return{stream:function(t){var r=new Gn(t);for(var n in e)r[n]=e[n];return r}}};function Gn(e){this.stream=e}Gn.prototype={point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function $n(e,t){return{point:t,sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}t.geo.projection=Wn;t.geo.projectionMutator=Xn;function Wn(e){return Xn(function(){return e})()}function Xn(e){var r,n,i,a=Zn(function(e,t){e=r(e,t);return[e[0]*o+d,v-e[1]*o]}),o=150,s=480,l=250,u=0,c=0,f=0,h=0,p=0,d,v,m=vn,g=P,y=null,_=null,x;function b(e){e=i(e[0]*Pe,e[1]*Pe);return[e[0]*o+d,v-e[1]*o]}function w(e){e=i.invert((e[0]-d)/o,(v-e[1])/o);return e&&[e[0]*De,e[1]*De]}b.stream=function(e){if(x)x.valid=false;x=Yn(m(n,a(g(e))));x.valid=true;return x};b.clipAngle=function(e){if(!arguments.length)return y;m=e==null?(y=e,vn):xn((y=+e)*Pe);return A()};b.clipExtent=function(e){if(!arguments.length)return _;_=e;g=e?kn(e[0][0],e[0][1],e[1][0],e[1][1]):P;return A()};b.scale=function(e){if(!arguments.length)return o;o=+e;return k()};b.translate=function(e){if(!arguments.length)return[s,l];s=+e[0];l=+e[1];return k()};b.center=function(e){if(!arguments.length)return[u*De,c*De];u=e[0]%360*Pe;c=e[1]%360*Pe;return k()};b.rotate=function(e){if(!arguments.length)return[f*De,h*De,p*De];f=e[0]%360*Pe;h=e[1]%360*Pe;p=e.length>2?e[2]%360*Pe:0;return k()};t.rebind(b,a,"precision");function k(){i=on(n=Qn(f,h,p),r);var e=r(u,c);d=s-e[0]*o;v=l+e[1]*o;return A()}function A(){if(x)x.valid=false,x=null;return b}return function(){r=e.apply(this,arguments);b.invert=r.invert&&w;return k()}}function Yn(e){return $n(e,function(t,r){e.point(t*Pe,r*Pe)})}function Jn(e,t){return[e,t]}(t.geo.equirectangular=function(){return Wn(Jn)}).raw=Jn.invert=Jn;t.geo.rotation=function(e){e=Qn(e[0]%360*Pe,e[1]*Pe,e.length>2?e[2]*Pe:0);function t(t){t=e(t[0]*Pe,t[1]*Pe);return t[0]*=De,t[1]*=De,t}t.invert=function(t){t=e.invert(t[0]*Pe,t[1]*Pe);return t[0]*=De,t[1]*=De,t};return t};function Kn(e,t){return[e>ze?e-Ee:e<-ze?e+Ee:e,t]}Kn.invert=Jn;function Qn(e,t,r){return e?t||r?on(ti(e),ri(t,r)):ti(e):t||r?ri(t,r):Kn}function ei(e){return function(t,r){return t+=e,[t>ze?t-Ee:t<-ze?t+Ee:t,r]}}function ti(e){var t=ei(e);t.invert=ei(-e);return t}function ri(e,t){var r=Math.cos(e),n=Math.sin(e),i=Math.cos(t),a=Math.sin(t);function o(e,t){var o=Math.cos(t),s=Math.cos(e)*o,l=Math.sin(e)*o,u=Math.sin(t),c=u*r+s*n;return[Math.atan2(l*i-c*a,s*r-u*n),Be(c*i+l*a)]}o.invert=function(e,t){var o=Math.cos(t),s=Math.cos(e)*o,l=Math.sin(e)*o,u=Math.sin(t),c=u*i-l*a;return[Math.atan2(l*i+u*a,s*r+c*n),Be(c*r-s*n)]};return o}t.geo.circle=function(){var e=[0,0],t,r=6,n;function i(){var t=typeof e==="function"?e.apply(this,arguments):e,r=Qn(-t[0]*Pe,-t[1]*Pe,0).invert,i=[];n(null,null,1,{point:function(e,t){i.push(e=r(e,t));e[0]*=De,e[1]*=De}});return{type:"Polygon",coordinates:[i]}}i.origin=function(t){if(!arguments.length)return e;e=t;return i};i.angle=function(e){if(!arguments.length)return t;n=ni((t=+e)*Pe,r*Pe);return i};i.precision=function(e){if(!arguments.length)return r;n=ni(t*Pe,(r=+e)*Pe);return i};return i.angle(90)};function ni(e,t){var r=Math.cos(e),n=Math.sin(e);return function(i,a,o,s){var l=o*t;if(i!=null){i=ii(r,i);a=ii(r,a);if(o>0?i<a:i>a)i+=o*Ee}else{i=e+o*Ee;a=e-.5*l}for(var u,c=i;o>0?c>a:c<a;c-=l){s.point((u=jr([r,-n*Math.cos(c),-n*Math.sin(c)]))[0],u[1])}}}function ii(e,t){var r=Dr(t);r[0]-=e;Nr(r);var n=Fe(-r[1]);return((-r[2]<0?-n:n)+2*Math.PI-Se)%(2*Math.PI)}t.geo.distance=function(e,t){var r=(t[0]-e[0])*Pe,n=e[1]*Pe,i=t[1]*Pe,a=Math.sin(r),o=Math.cos(r),s=Math.sin(n),l=Math.cos(n),u=Math.sin(i),c=Math.cos(i),f;return Math.atan2(Math.sqrt((f=c*a)*f+(f=l*u-s*c*o)*f),s*u+l*c*o)};t.geo.graticule=function(){var e,r,n,i,a,o,s,l,u=10,c=u,f=90,h=360,p,d,v,m,g=2.5;function y(){return{type:"MultiLineString",coordinates:x()}}function x(){return t.range(Math.ceil(i/f)*f,n,f).map(v).concat(t.range(Math.ceil(l/h)*h,s,h).map(m)).concat(t.range(Math.ceil(r/u)*u,e,u).filter(function(e){return _(e%f)>Se}).map(p)).concat(t.range(Math.ceil(o/c)*c,a,c).filter(function(e){return _(e%h)>Se}).map(d))}y.lines=function(){return x().map(function(e){return{type:"LineString",coordinates:e}})};y.outline=function(){return{type:"Polygon",coordinates:[v(i).concat(m(s).slice(1),v(n).reverse().slice(1),m(l).reverse().slice(1))]}};y.extent=function(e){if(!arguments.length)return y.minorExtent();return y.majorExtent(e).minorExtent(e)};y.majorExtent=function(e){if(!arguments.length)return[[i,l],[n,s]];i=+e[0][0],n=+e[1][0];l=+e[0][1],s=+e[1][1];if(i>n)e=i,i=n,n=e;if(l>s)e=l,l=s,s=e;return y.precision(g)};y.minorExtent=function(t){if(!arguments.length)return[[r,o],[e,a]];r=+t[0][0],e=+t[1][0];o=+t[0][1],a=+t[1][1];if(r>e)t=r,r=e,e=t;if(o>a)t=o,o=a,a=t;return y.precision(g)};y.step=function(e){if(!arguments.length)return y.minorStep();return y.majorStep(e).minorStep(e)};y.majorStep=function(e){if(!arguments.length)return[f,h];f=+e[0],h=+e[1];return y};y.minorStep=function(e){if(!arguments.length)return[u,c];u=+e[0],c=+e[1];return y};y.precision=function(t){if(!arguments.length)return g;g=+t;p=ai(o,a,90);d=oi(r,e,g);v=ai(l,s,90);m=oi(i,n,g);return y};return y.majorExtent([[-180,-90+Se],[180,90-Se]]).minorExtent([[-180,-80-Se],[180,80+Se]])};function ai(e,r,n){var i=t.range(e,r-Se,n).concat(r);return function(e){return i.map(function(t){return[e,t]})}}function oi(e,r,n){var i=t.range(e,r-Se,n).concat(r);return function(e){return i.map(function(t){return[t,e]})}}function si(e){return e.source}function li(e){return e.target}t.geo.greatArc=function(){var e=si,r,n=li,i;function a(){return{type:"LineString",coordinates:[r||e.apply(this,arguments),i||n.apply(this,arguments)]}}a.distance=function(){return t.geo.distance(r||e.apply(this,arguments),i||n.apply(this,arguments))};a.source=function(t){if(!arguments.length)return e;e=t,r=typeof t==="function"?null:t;return a};a.target=function(e){if(!arguments.length)return n;n=e,i=typeof e==="function"?null:e;return a};a.precision=function(){return arguments.length?a:0};return a};t.geo.interpolate=function(e,t){return ui(e[0]*Pe,e[1]*Pe,t[0]*Pe,t[1]*Pe)};function ui(e,t,r,n){var i=Math.cos(t),a=Math.sin(t),o=Math.cos(n),s=Math.sin(n),l=i*Math.cos(e),u=i*Math.sin(e),c=o*Math.cos(r),f=o*Math.sin(r),h=2*Math.asin(Math.sqrt(qe(n-t)+i*o*qe(r-e))),p=1/Math.sin(h);var d=h?function(e){var t=Math.sin(e*=h)*p,r=Math.sin(h-e)*p,n=r*l+t*c,i=r*u+t*f,o=r*a+t*s;return[Math.atan2(i,n)*De,Math.atan2(o,Math.sqrt(n*n+i*i))*De]}:function(){return[e*De,t*De]};d.distance=h;return d}t.geo.length=function(e){ci=0;t.geo.stream(e,fi);return ci};var ci;var fi={sphere:F,point:F,lineStart:hi,lineEnd:F,polygonStart:F,polygonEnd:F};function hi(){var e,t,r;fi.point=function(i,a){e=i*Pe,t=Math.sin(a*=Pe),r=Math.cos(a);fi.point=n};fi.lineEnd=function(){fi.point=fi.lineEnd=F};function n(n,i){var a=Math.sin(i*=Pe),o=Math.cos(i),s=_((n*=Pe)-e),l=Math.cos(s);ci+=Math.atan2(Math.sqrt((s=o*Math.sin(s))*s+(s=r*a-t*o*l)*s),t*a+r*o*l);e=n,t=a,r=o}}function pi(e,t){function r(t,r){var n=Math.cos(t),i=Math.cos(r),a=e(n*i);return[a*i*Math.sin(t),a*Math.sin(r)]}r.invert=function(e,r){var n=Math.sqrt(e*e+r*r),i=t(n),a=Math.sin(i),o=Math.cos(i);return[Math.atan2(e*a,n*o),Math.asin(n&&r*a/n)]};return r}var di=pi(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(t.geo.azimuthalEqualArea=function(){return Wn(di)}).raw=di;var vi=pi(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},P);(t.geo.azimuthalEquidistant=function(){return Wn(vi)}).raw=vi;function mi(e,t){var r=Math.cos(e),n=function(e){return Math.tan(ze/4+e/2)},i=e===t?Math.sin(e):Math.log(r/Math.cos(t))/Math.log(n(t)/n(e)),a=r*Math.pow(n(e),i)/i;if(!i)return _i;function o(e,t){if(a>0){if(t<-Ie+Se)t=-Ie+Se}else{if(t>Ie-Se)t=Ie-Se}var r=a/Math.pow(n(t),i);return[r*Math.sin(i*e),a-r*Math.cos(i*e)]}o.invert=function(e,t){var r=a-t,n=Oe(i)*Math.sqrt(e*e+r*r);return[Math.atan2(e,r)/i,2*Math.atan(Math.pow(a/n,1/i))-Ie]};return o}(t.geo.conicConformal=function(){return An(mi)}).raw=mi;function gi(e,t){var r=Math.cos(e),n=e===t?Math.sin(e):(r-Math.cos(t))/(t-e),i=r/n+e;if(_(n)<Se)return Jn;function a(e,t){var r=i-t;return[r*Math.sin(n*e),i-r*Math.cos(n*e)]}a.invert=function(e,t){var r=i-t;return[Math.atan2(e,r)/n,i-Oe(n)*Math.sqrt(e*e+r*r)]};return a}(t.geo.conicEquidistant=function(){return An(gi)}).raw=gi;var yi=pi(function(e){return 1/e},Math.atan);(t.geo.gnomonic=function(){return Wn(yi)}).raw=yi;function _i(e,t){return[e,Math.log(Math.tan(ze/4+t/2))]}_i.invert=function(e,t){return[e,2*Math.atan(Math.exp(t))-Ie]};function xi(e){var t=Wn(e),r=t.scale,n=t.translate,i=t.clipExtent,a;t.scale=function(){var e=r.apply(t,arguments);return e===t?a?t.clipExtent(null):t:e};t.translate=function(){var e=n.apply(t,arguments);return e===t?a?t.clipExtent(null):t:e};t.clipExtent=function(e){var o=i.apply(t,arguments);if(o===t){if(a=e==null){var s=ze*r(),l=n();i([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else if(a){o=null}return o};return t.clipExtent(null)}(t.geo.mercator=function(){return xi(_i)}).raw=_i;var bi=pi(function(){return 1},Math.asin);(t.geo.orthographic=function(){return Wn(bi)}).raw=bi;var wi=pi(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(t.geo.stereographic=function(){return Wn(wi)}).raw=wi;function ki(e,t){return[Math.log(Math.tan(ze/4+t/2)),-e]}ki.invert=function(e,t){return[-t,2*Math.atan(Math.exp(e))-Ie]};(t.geo.transverseMercator=function(){var e=xi(ki),t=e.center,r=e.rotate;e.center=function(e){return e?t([-e[1],e[0]]):(e=t(),[e[1],-e[0]])};e.rotate=function(e){return e?r([e[0],e[1],e.length>2?e[2]+90:90]):(e=r(),[e[0],e[1],e[2]-90])};return r([0,0,90])}).raw=ki;t.geom={};function Ai(e){return e[0]}function Ti(e){return e[1]}t.geom.hull=function(e){var t=Ai,r=Ti;if(arguments.length)return n(e);function n(e){if(e.length<3)return[];var n=At(t),i=At(r),a,o=e.length,s=[],l=[];for(a=0;a<o;a++){s.push([+n.call(this,e[a],a),+i.call(this,e[a],a),a])}s.sort(Si);for(a=0;a<o;a++)l.push([s[a][0],-s[a][1]]);var u=Mi(s),c=Mi(l);var f=c[0]===u[0],h=c[c.length-1]===u[u.length-1],p=[];for(a=u.length-1;a>=0;--a)p.push(e[s[u[a]][2]]);for(a=+f;a<c.length-h;++a)p.push(e[s[c[a]][2]]);return p}n.x=function(e){return arguments.length?(t=e,n):t};n.y=function(e){return arguments.length?(r=e,n):r};return n};function Mi(e){var t=e.length,r=[0,1],n=2;for(var i=2;i<t;i++){while(n>1&&Re(e[r[n-2]],e[r[n-1]],e[i])<=0)--n;r[n++]=i}return r.slice(0,n)}function Si(e,t){return e[0]-t[0]||e[1]-t[1]}t.geom.polygon=function(e){Z(e,Ci);return e};var Ci=t.geom.polygon.prototype=[];Ci.area=function(){var e=-1,t=this.length,r,n=this[t-1],i=0;while(++e<t){r=n;n=this[e];i+=r[1]*n[0]-r[0]*n[1]}return i*.5};Ci.centroid=function(e){var t=-1,r=this.length,n=0,i=0,a,o=this[r-1],s;if(!arguments.length)e=-1/(6*this.area());while(++t<r){a=o;o=this[t];s=a[0]*o[1]-o[0]*a[1];n+=(a[0]+o[0])*s;i+=(a[1]+o[1])*s}return[n*e,i*e]};Ci.clip=function(e){var t,r=Li(e),n=-1,i=this.length-Li(this),a,o,s=this[i-1],l,u,c;while(++n<i){t=e.slice();e.length=0;l=this[n];u=t[(o=t.length-r)-1];a=-1;while(++a<o){c=t[a];if(zi(c,s,l)){if(!zi(u,s,l)){e.push(Ei(u,c,s,l))}e.push(c)}else if(zi(u,s,l)){e.push(Ei(u,c,s,l))}u=c}if(r)e.push(e[0]);s=l}return e};function zi(e,t,r){return(r[0]-t[0])*(e[1]-t[1])<(r[1]-t[1])*(e[0]-t[0])}function Ei(e,t,r,n){var i=e[0],a=r[0],o=t[0]-i,s=n[0]-a,l=e[1],u=r[1],c=t[1]-l,f=n[1]-u,h=(s*(l-u)-f*(i-a))/(f*o-s*c);return[i+h*o,l+h*c]}function Li(e){var t=e[0],r=e[e.length-1];return!(t[0]-r[0]||t[1]-r[1])}var Ii,Pi,Di,Oi=[],Ri,Fi,Bi=[];function Ni(){oa(this);this.edge=this.site=this.circle=null}function ji(e){var t=Oi.pop()||new Ni;t.site=e;return t}function Vi(e){Ji(e);Di.remove(e);Oi.push(e);oa(e)}function qi(e){var t=e.circle,r=t.x,n=t.cy,i={x:r,y:n},a=e.P,o=e.N,s=[e];Vi(e);var l=a;while(l.circle&&_(r-l.circle.x)<Se&&_(n-l.circle.cy)<Se){a=l.P;s.unshift(l);Vi(l);l=a}s.unshift(l);Ji(l);var u=o;while(u.circle&&_(r-u.circle.x)<Se&&_(n-u.circle.cy)<Se){o=u.N;s.push(u);Vi(u);u=o}s.push(u);Ji(u);var c=s.length,f;for(f=1;f<c;++f){u=s[f];l=s[f-1];na(u.edge,l.site,u.site,i)}l=s[0];u=s[c-1];u.edge=ta(l.site,u.site,null,i);Yi(l);Yi(u)}function Ui(e){var t=e.x,r=e.y,n,i,a,o,s=Di._;while(s){a=Zi(s,r)-t;if(a>Se)s=s.L;else{o=t-Hi(s,r);if(o>Se){if(!s.R){n=s;break}s=s.R}else{if(a>-Se){n=s.P;i=s}else if(o>-Se){n=s;i=s.N}else{n=i=s}break}}}var l=ji(e);Di.insert(n,l);if(!n&&!i)return;if(n===i){Ji(n);i=ji(n.site);Di.insert(l,i);l.edge=i.edge=ta(n.site,l.site);Yi(n);Yi(i);return}if(!i){l.edge=ta(n.site,l.site);return}Ji(n);Ji(i);var u=n.site,c=u.x,f=u.y,h=e.x-c,p=e.y-f,d=i.site,v=d.x-c,m=d.y-f,g=2*(h*m-p*v),y=h*h+p*p,_=v*v+m*m,x={x:(m*y-p*_)/g+c,y:(h*_-v*y)/g+f};na(i.edge,u,d,x);l.edge=ta(u,e,null,x);i.edge=ta(e,d,null,x);Yi(n);Yi(i)}function Zi(e,t){var r=e.site,n=r.x,i=r.y,a=i-t;if(!a)return n;var o=e.P;if(!o)return-Infinity;r=o.site;var s=r.x,l=r.y,u=l-t;if(!u)return s;var c=s-n,f=1/a-1/u,h=c/u;if(f)return(-h+Math.sqrt(h*h-2*f*(c*c/(-2*u)-l+u/2+i-a/2)))/f+n;return(n+s)/2}function Hi(e,t){var r=e.N;if(r)return Zi(r,t);var n=e.site;return n.y===t?n.x:Infinity}function Gi(e){this.site=e;this.edges=[]}Gi.prototype.prepare=function(){var e=this.edges,t=e.length,r;while(t--){r=e[t].edge;if(!r.b||!r.a)e.splice(t,1)}e.sort(Wi);return e.length};function $i(e){var t=e[0][0],r=e[1][0],n=e[0][1],i=e[1][1],a,o,s,l,u=Pi,c=u.length,f,h,p,d,v,m;while(c--){f=u[c];if(!f||!f.prepare())continue;p=f.edges;d=p.length;h=0;while(h<d){m=p[h].end(),s=m.x,l=m.y;v=p[++h%d].start(),a=v.x,o=v.y;if(_(s-a)>Se||_(l-o)>Se){p.splice(h,0,new ia(ra(f.site,m,_(s-t)<Se&&i-l>Se?{x:t,y:_(a-t)<Se?o:i}:_(l-i)<Se&&r-s>Se?{x:_(o-i)<Se?a:r,y:i}:_(s-r)<Se&&l-n>Se?{x:r,y:_(a-r)<Se?o:n}:_(l-n)<Se&&s-t>Se?{x:_(o-n)<Se?a:t,y:n}:null),f.site,null));++d}}}}function Wi(e,t){return t.angle-e.angle}function Xi(){oa(this);this.x=this.y=this.arc=this.site=this.cy=null}function Yi(e){var t=e.P,r=e.N;if(!t||!r)return;var n=t.site,i=e.site,a=r.site;if(n===a)return;var o=i.x,s=i.y,l=n.x-o,u=n.y-s,c=a.x-o,f=a.y-s;var h=2*(l*f-u*c);if(h>=-Ce)return;var p=l*l+u*u,d=c*c+f*f,v=(f*p-u*d)/h,m=(l*d-c*p)/h,f=m+s;var g=Bi.pop()||new Xi;g.arc=e;g.site=i;g.x=v+o;g.y=f+Math.sqrt(v*v+m*m);g.cy=f;e.circle=g;var y=null,_=Fi._;while(_){if(g.y<_.y||g.y===_.y&&g.x<=_.x){if(_.L)_=_.L;else{y=_.P;break}}else{if(_.R)_=_.R;else{y=_;break}}}Fi.insert(y,g);if(!y)Ri=g}function Ji(e){var t=e.circle;if(t){if(!t.P)Ri=t.N;Fi.remove(t);Bi.push(t);oa(t);e.circle=null}}function Ki(e){var t=Ii,r=bn(e[0][0],e[0][1],e[1][0],e[1][1]),n=t.length,i;while(n--){i=t[n];if(!Qi(i,e)||!r(i)||_(i.a.x-i.b.x)<Se&&_(i.a.y-i.b.y)<Se){i.a=i.b=null;t.splice(n,1)}}}function Qi(e,t){var r=e.b;if(r)return true;var n=e.a,i=t[0][0],a=t[1][0],o=t[0][1],s=t[1][1],l=e.l,u=e.r,c=l.x,f=l.y,h=u.x,p=u.y,d=(c+h)/2,v=(f+p)/2,m,g;if(p===f){if(d<i||d>=a)return;if(c>h){if(!n)n={x:d,y:o};else if(n.y>=s)return;r={x:d,y:s}}else{if(!n)n={x:d,y:s};else if(n.y<o)return;r={x:d,y:o}}}else{m=(c-h)/(p-f);g=v-m*d;if(m<-1||m>1){if(c>h){if(!n)n={x:(o-g)/m,y:o};else if(n.y>=s)return;r={x:(s-g)/m,y:s}}else{if(!n)n={x:(s-g)/m,y:s};else if(n.y<o)return;r={x:(o-g)/m,y:o}}}else{if(f<p){if(!n)n={x:i,y:m*i+g};else if(n.x>=a)return;r={x:a,y:m*a+g}}else{if(!n)n={x:a,y:m*a+g};else if(n.x<i)return;r={x:i,y:m*i+g}}}}e.a=n;e.b=r;return true}function ea(e,t){this.l=e;this.r=t;this.a=this.b=null}function ta(e,t,r,n){var i=new ea(e,t);Ii.push(i);if(r)na(i,e,t,r);if(n)na(i,t,e,n);Pi[e.i].edges.push(new ia(i,e,t));Pi[t.i].edges.push(new ia(i,t,e));return i}function ra(e,t,r){var n=new ea(e,null);n.a=t;n.b=r;Ii.push(n);return n}function na(e,t,r,n){if(!e.a&&!e.b){e.a=n;e.l=t;e.r=r}else if(e.l===r){e.b=n}else{e.a=n}}function ia(e,t,r){var n=e.a,i=e.b;this.edge=e;this.site=t;this.angle=r?Math.atan2(r.y-t.y,r.x-t.x):e.l===t?Math.atan2(i.x-n.x,n.y-i.y):Math.atan2(n.x-i.x,i.y-n.y)}ia.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function aa(){this._=null}function oa(e){e.U=e.C=e.L=e.R=e.P=e.N=null}aa.prototype={insert:function(e,t){var r,n,i;if(e){t.P=e;t.N=e.N;if(e.N)e.N.P=t;e.N=t;if(e.R){e=e.R;while(e.L)e=e.L;e.L=t}else{e.R=t}r=e}else if(this._){e=ua(this._);t.P=null;t.N=e;e.P=e.L=t;r=e}else{t.P=t.N=null;this._=t;r=null}t.L=t.R=null;t.U=r;t.C=true;e=t;while(r&&r.C){n=r.U;if(r===n.L){i=n.R;if(i&&i.C){r.C=i.C=false;n.C=true;e=n}else{if(e===r.R){sa(this,r);e=r;r=e.U}r.C=false;n.C=true;la(this,n)}}else{i=n.L;if(i&&i.C){r.C=i.C=false;n.C=true;e=n}else{if(e===r.L){la(this,r);e=r;r=e.U}r.C=false;n.C=true;sa(this,n)}}r=e.U}this._.C=false},remove:function(e){if(e.N)e.N.P=e.P;if(e.P)e.P.N=e.N;e.N=e.P=null;var t=e.U,r,n=e.L,i=e.R,a,o;if(!n)a=i;else if(!i)a=n;else a=ua(i);if(t){if(t.L===e)t.L=a;else t.R=a}else{this._=a}if(n&&i){o=a.C;a.C=e.C;a.L=n;n.U=a;if(a!==i){t=a.U;a.U=e.U;e=a.R;t.L=e;a.R=i;i.U=a}else{a.U=t;t=a;e=a.R}}else{o=e.C;e=a}if(e)e.U=t;if(o)return;if(e&&e.C){e.C=false;return}do{if(e===this._)break;if(e===t.L){r=t.R;if(r.C){r.C=false;t.C=true;sa(this,t);r=t.R}if(r.L&&r.L.C||r.R&&r.R.C){if(!r.R||!r.R.C){r.L.C=false;r.C=true;la(this,r);r=t.R}r.C=t.C;t.C=r.R.C=false;sa(this,t);e=this._;break}}else{r=t.L;if(r.C){r.C=false;t.C=true;la(this,t);r=t.L}if(r.L&&r.L.C||r.R&&r.R.C){if(!r.L||!r.L.C){r.R.C=false;r.C=true;sa(this,r);r=t.L}r.C=t.C;t.C=r.L.C=false;la(this,t);e=this._;break}}r.C=true;e=t;t=t.U}while(!e.C);if(e)e.C=false}};function sa(e,t){var r=t,n=t.R,i=r.U;if(i){if(i.L===r)i.L=n;else i.R=n}else{e._=n}n.U=i;r.U=n;r.R=n.L;if(r.R)r.R.U=r;n.L=r}function la(e,t){var r=t,n=t.L,i=r.U;if(i){if(i.L===r)i.L=n;else i.R=n}else{e._=n}n.U=i;r.U=n;r.L=n.R;if(r.L)r.L.U=r;n.R=r}function ua(e){while(e.L)e=e.L;return e}function ca(e,t){var r=e.sort(fa).pop(),n,i,a;Ii=[];Pi=new Array(e.length);Di=new aa;Fi=new aa;while(true){a=Ri;if(r&&(!a||r.y<a.y||r.y===a.y&&r.x<a.x)){if(r.x!==n||r.y!==i){Pi[r.i]=new Gi(r);Ui(r);n=r.x,i=r.y}r=e.pop()}else if(a){qi(a.arc)}else{break}}if(t)Ki(t),$i(t);var o={cells:Pi,edges:Ii};Di=Fi=Ii=Pi=null;return o}function fa(e,t){return t.y-e.y||t.x-e.x}t.geom.voronoi=function(e){var t=Ai,r=Ti,n=t,i=r,a=ha;if(e)return o(e);function o(e){var t=new Array(e.length),r=a[0][0],n=a[0][1],i=a[1][0],o=a[1][1];ca(s(e),a).cells.forEach(function(a,s){var l=a.edges,u=a.site,c=t[s]=l.length?l.map(function(e){var t=e.start();return[t.x,t.y]}):u.x>=r&&u.x<=i&&u.y>=n&&u.y<=o?[[r,o],[i,o],[i,n],[r,n]]:[];c.point=e[s]});return t}function s(e){return e.map(function(e,t){return{x:Math.round(n(e,t)/Se)*Se,y:Math.round(i(e,t)/Se)*Se,i:t}})}o.links=function(e){return ca(s(e)).edges.filter(function(e){return e.l&&e.r}).map(function(t){return{source:e[t.l.i],target:e[t.r.i]}})};o.triangles=function(e){var t=[];ca(s(e)).cells.forEach(function(r,n){var i=r.site,a=r.edges.sort(Wi),o=-1,s=a.length,l,u,c=a[s-1].edge,f=c.l===i?c.r:c.l;while(++o<s){l=c;u=f;c=a[o].edge;f=c.l===i?c.r:c.l;if(n<u.i&&n<f.i&&pa(i,u,f)<0){t.push([e[n],e[u.i],e[f.i]])}}});return t};o.x=function(e){return arguments.length?(n=At(t=e),o):t};o.y=function(e){return arguments.length?(i=At(r=e),o):r};o.clipExtent=function(e){if(!arguments.length)return a===ha?null:a;a=e==null?ha:e;return o};o.size=function(e){if(!arguments.length)return a===ha?null:a&&a[1];return o.clipExtent(e&&[[0,0],e])};return o};var ha=[[-1e6,-1e6],[1e6,1e6]];function pa(e,t,r){return(e.x-r.x)*(t.y-e.y)-(e.x-t.x)*(r.y-e.y)}t.geom.delaunay=function(e){return t.geom.voronoi().triangles(e)};t.geom.quadtree=function(e,t,r,n,i){var a=Ai,o=Ti,s;if(s=arguments.length){a=da;o=va;if(s===3){i=r;n=t;r=t=0}return l(e)}function l(e){var l,u=At(a),c=At(o),f,h,p,d,v,m,g,y;if(t!=null){v=t,m=r,g=n,y=i}else{g=y=-(v=m=Infinity);f=[],h=[];d=e.length;if(s)for(p=0;p<d;++p){l=e[p];if(l.x<v)v=l.x;if(l.y<m)m=l.y;if(l.x>g)g=l.x;if(l.y>y)y=l.y;f.push(l.x);h.push(l.y)}else for(p=0;p<d;++p){var x=+u(l=e[p],p),b=+c(l,p);if(x<v)v=x;if(b<m)m=b;if(x>g)g=x;if(b>y)y=b;f.push(x);h.push(b)}}var w=g-v,k=y-m;if(w>k)y=m+w;else g=v+k;function A(e,t,r,n,i,a,o,s){if(isNaN(r)||isNaN(n))return;if(e.leaf){var l=e.x,u=e.y;if(l!=null){if(_(l-r)+_(u-n)<.01){T(e,t,r,n,i,a,o,s)}else{var c=e.point;e.x=e.y=e.point=null;T(e,c,l,u,i,a,o,s);T(e,t,r,n,i,a,o,s)}}else{e.x=r,e.y=n,e.point=t}}else{T(e,t,r,n,i,a,o,s)}}function T(e,t,r,n,i,a,o,s){var l=(i+o)*.5,u=(a+s)*.5,c=r>=l,f=n>=u,h=f<<1|c;e.leaf=false;e=e.nodes[h]||(e.nodes[h]=ma());if(c)i=l;else o=l;if(f)a=u;else s=u;A(e,t,r,n,i,a,o,s)}var M=ma();M.add=function(e){A(M,e,+u(e,++p),+c(e,p),v,m,g,y)};M.visit=function(e){ga(e,M,v,m,g,y)};M.find=function(e){return ya(M,e[0],e[1],v,m,g,y)};p=-1;if(t==null){while(++p<d){A(M,e[p],f[p],h[p],v,m,g,y)}--p}else e.forEach(M.add);f=h=e=l=null;return M}l.x=function(e){return arguments.length?(a=e,l):a};l.y=function(e){return arguments.length?(o=e,l):o};l.extent=function(e){if(!arguments.length)return t==null?null:[[t,r],[n,i]];if(e==null)t=r=n=i=null;else t=+e[0][0],r=+e[0][1],n=+e[1][0],i=+e[1][1];return l};l.size=function(e){if(!arguments.length)return t==null?null:[n-t,i-r];if(e==null)t=r=n=i=null;else t=r=0,n=+e[0],i=+e[1];return l};return l};function da(e){return e.x}function va(e){return e.y}function ma(){return{leaf:true,nodes:[],point:null,x:null,y:null}}function ga(e,t,r,n,i,a){if(!e(t,r,n,i,a)){var o=(r+i)*.5,s=(n+a)*.5,l=t.nodes;if(l[0])ga(e,l[0],r,n,o,s);if(l[1])ga(e,l[1],o,n,i,s);if(l[2])ga(e,l[2],r,s,o,a);if(l[3])ga(e,l[3],o,s,i,a)}}function ya(e,t,r,n,i,a,o){var s=Infinity,l;(function e(u,c,f,h,p){if(c>a||f>o||h<n||p<i)return;if(d=u.point){var d,v=t-u.x,m=r-u.y,g=v*v+m*m;if(g<s){var y=Math.sqrt(s=g);n=t-y,i=r-y;a=t+y,o=r+y;l=d}}var _=u.nodes,x=(c+h)*.5,b=(f+p)*.5,w=t>=x,k=r>=b;for(var A=k<<1|w,T=A+4;A<T;++A){if(u=_[A&3])switch(A&3){case 0:e(u,c,f,x,b);break;case 1:e(u,x,f,h,b);break;case 2:e(u,c,b,x,p);break;case 3:e(u,x,b,h,p);break}}})(e,n,i,a,o);return l}t.interpolateRgb=_a;function _a(e,r){e=t.rgb(e);r=t.rgb(r);var n=e.r,i=e.g,a=e.b,o=r.r-n,s=r.g-i,l=r.b-a;return function(e){return"#"+gt(Math.round(n+o*e))+gt(Math.round(i+s*e))+gt(Math.round(a+l*e))}}t.interpolateObject=xa;function xa(e,t){var r={},n={},i;for(i in e){if(i in t){r[i]=Ta(e[i],t[i])}else{n[i]=e[i]}}for(i in t){if(!(i in e)){n[i]=t[i]}}return function(e){for(i in r)n[i]=r[i](e);return n}}t.interpolateNumber=ba;function ba(e,t){e=+e,t=+t;return function(r){return e*(1-r)+t*r}}t.interpolateString=wa;function wa(e,t){var r=ka.lastIndex=Aa.lastIndex=0,n,i,a,o=-1,s=[],l=[];e=e+"",t=t+"";while((n=ka.exec(e))&&(i=Aa.exec(t))){if((a=i.index)>r){a=t.slice(r,a);if(s[o])s[o]+=a;else s[++o]=a}if((n=n[0])===(i=i[0])){if(s[o])s[o]+=i;else s[++o]=i}else{s[++o]=null;l.push({i:o,x:ba(n,i)})}r=Aa.lastIndex}if(r<t.length){a=t.slice(r);if(s[o])s[o]+=a;else s[++o]=a}return s.length<2?l[0]?(t=l[0].x,function(e){return t(e)+""}):function(){return t}:(t=l.length,function(e){for(var r=0,n;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})}var ka=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Aa=new RegExp(ka.source,"g");t.interpolate=Ta;function Ta(e,r){var n=t.interpolators.length,i;while(--n>=0&&!(i=t.interpolators[n](e,r)));return i}t.interpolators=[function(e,t){var r=typeof t;return(r==="string"?kt.has(t.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(t)?_a:wa:t instanceof Xe?_a:Array.isArray(t)?Ma:r==="object"&&isNaN(t)?xa:ba)(e,t)}];t.interpolateArray=Ma;function Ma(e,t){var r=[],n=[],i=e.length,a=t.length,o=Math.min(e.length,t.length),s;for(s=0;s<o;++s)r.push(Ta(e[s],t[s]));for(;s<i;++s)n[s]=e[s];for(;s<a;++s)n[s]=t[s];return function(e){for(s=0;s<o;++s)n[s]=r[s](e);return n}}var Sa=function(){return P};var Ca=t.map({linear:Sa,poly:Ra,quad:function(){return Pa},cubic:function(){return Da},sin:function(){return Fa},exp:function(){return Ba},circle:function(){return Na},elastic:ja,back:Va,bounce:function(){return qa}});var za=t.map({in:P,out:La,"in-out":Ia,"out-in":function(e){return Ia(La(e))}});t.ease=function(e){var t=e.indexOf("-"),r=t>=0?e.slice(0,t):e,i=t>=0?e.slice(t+1):"in";r=Ca.get(r)||Sa;i=za.get(i)||P;return Ea(i(r.apply(null,n.call(arguments,1))))};function Ea(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function La(e){return function(t){return 1-e(1-t)}}function Ia(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function Pa(e){return e*e}function Da(e){return e*e*e}function Oa(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function Ra(e){return function(t){return Math.pow(t,e)}}function Fa(e){return 1-Math.cos(e*Ie)}function Ba(e){return Math.pow(2,10*(e-1))}function Na(e){return 1-Math.sqrt(1-e*e)}function ja(e,t){var r;if(arguments.length<2)t=.45;if(arguments.length)r=t/Ee*Math.asin(1/e);else e=1,r=t/4;return function(n){return 1+e*Math.pow(2,-10*n)*Math.sin((n-r)*Ee/t)}}function Va(e){if(!e)e=1.70158;return function(t){return t*t*((e+1)*t-e)}}function qa(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}t.interpolateHcl=Ua;function Ua(e,r){e=t.hcl(e);r=t.hcl(r);var n=e.h,i=e.c,a=e.l,o=r.h-n,s=r.c-i,l=r.l-a;if(isNaN(s))s=0,i=isNaN(i)?r.c:i;if(isNaN(o))o=0,n=isNaN(n)?r.h:n;else if(o>180)o-=360;else if(o<-180)o+=360;return function(e){return tt(n+o*e,i+s*e,a+l*e)+""}}t.interpolateHsl=Za;function Za(e,r){e=t.hsl(e);r=t.hsl(r);var n=e.h,i=e.s,a=e.l,o=r.h-n,s=r.s-i,l=r.l-a;if(isNaN(s))s=0,i=isNaN(i)?r.s:i;if(isNaN(o))o=0,n=isNaN(n)?r.h:n;else if(o>180)o-=360;else if(o<-180)o+=360;return function(e){return Ke(n+o*e,i+s*e,a+l*e)+""}}t.interpolateLab=Ha;function Ha(e,r){e=t.lab(e);r=t.lab(r);var n=e.l,i=e.a,a=e.b,o=r.l-n,s=r.a-i,l=r.b-a;return function(e){return lt(n+o*e,i+s*e,a+l*e)+""}}t.interpolateRound=Ga;function Ga(e,t){t-=e;return function(r){return Math.round(e+t*r)}}t.transform=function(e){var r=a.createElementNS(t.ns.prefix.svg,"g");return(t.transform=function(e){if(e!=null){r.setAttribute("transform",e);var t=r.transform.baseVal.consolidate()}return new $a(t?t.matrix:Ja)})(e)};function $a(e){var t=[e.a,e.b],r=[e.c,e.d],n=Xa(t),i=Wa(t,r),a=Xa(Ya(r,t,-i))||0;if(t[0]*r[1]<r[0]*t[1]){t[0]*=-1;t[1]*=-1;n*=-1;i*=-1}this.rotate=(n?Math.atan2(t[1],t[0]):Math.atan2(-r[0],r[1]))*De;this.translate=[e.e,e.f];this.scale=[n,a];this.skew=a?Math.atan2(i,a)*De:0}$a.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function Wa(e,t){return e[0]*t[0]+e[1]*t[1]}function Xa(e){var t=Math.sqrt(Wa(e,e));if(t){e[0]/=t;e[1]/=t}return t}function Ya(e,t,r){e[0]+=r*t[0];e[1]+=r*t[1];return e}var Ja={a:1,b:0,c:0,d:1,e:0,f:0};t.interpolateTransform=no;function Ka(e){return e.length?e.pop()+",":""}function Qa(e,t,r,n){if(e[0]!==t[0]||e[1]!==t[1]){var i=r.push("translate(",null,",",null,")");n.push({i:i-4,x:ba(e[0],t[0])},{i:i-2,x:ba(e[1],t[1])})}else if(t[0]||t[1]){r.push("translate("+t+")")}}function eo(e,t,r,n){if(e!==t){if(e-t>180)t+=360;else if(t-e>180)e+=360;n.push({i:r.push(Ka(r)+"rotate(",null,")")-2,x:ba(e,t)})}else if(t){r.push(Ka(r)+"rotate("+t+")")}}function to(e,t,r,n){if(e!==t){n.push({i:r.push(Ka(r)+"skewX(",null,")")-2,x:ba(e,t)})}else if(t){r.push(Ka(r)+"skewX("+t+")")}}function ro(e,t,r,n){if(e[0]!==t[0]||e[1]!==t[1]){var i=r.push(Ka(r)+"scale(",null,",",null,")");n.push({i:i-4,x:ba(e[0],t[0])},{i:i-2,x:ba(e[1],t[1])})}else if(t[0]!==1||t[1]!==1){r.push(Ka(r)+"scale("+t+")")}}function no(e,r){var n=[],i=[];e=t.transform(e),r=t.transform(r);Qa(e.translate,r.translate,n,i);eo(e.rotate,r.rotate,n,i);to(e.skew,r.skew,n,i);ro(e.scale,r.scale,n,i);e=r=null;return function(e){var t=-1,r=i.length,a;while(++t<r)n[(a=i[t]).i]=a.x(e);return n.join("")}}function io(e,t){t=(t-=e=+e)||1/t;return function(r){return(r-e)/t}}function ao(e,t){t=(t-=e=+e)||1/t;return function(r){return Math.max(0,Math.min(1,(r-e)/t))}}t.layout={};t.layout.bundle=function(){return function(e){var t=[],r=-1,n=e.length;while(++r<n)t.push(oo(e[r]));return t}};function oo(e){var t=e.source,r=e.target,n=lo(t,r),i=[t];while(t!==n){t=t.parent;i.push(t)}var a=i.length;while(r!==n){i.splice(a,0,r);r=r.parent}return i}function so(e){var t=[],r=e.parent;while(r!=null){t.push(e);e=r;r=r.parent}t.push(e);return t}function lo(e,t){if(e===t)return e;var r=so(e),n=so(t),i=r.pop(),a=n.pop(),o=null;while(i===a){o=i;i=r.pop();a=n.pop()}return o}t.layout.chord=function(){var e={},r,n,i,a,o=0,s,l,u;function c(){var e={},c=[],h=t.range(a),p=[],d,v,m,g,y;r=[];n=[];d=0,g=-1;while(++g<a){v=0,y=-1;while(++y<a){v+=i[g][y]}c.push(v);p.push(t.range(a));d+=v}if(s){h.sort(function(e,t){return s(c[e],c[t])})}if(l){p.forEach(function(e,t){e.sort(function(e,r){return l(i[t][e],i[t][r])})})}d=(Ee-o*a)/d;v=0,g=-1;while(++g<a){m=v,y=-1;while(++y<a){var _=h[g],x=p[_][y],b=i[_][x],w=v,k=v+=b*d;e[_+"-"+x]={index:_,subindex:x,startAngle:w,endAngle:k,value:b}}n[_]={index:_,startAngle:m,endAngle:v,value:c[_]};v+=o}g=-1;while(++g<a){y=g-1;while(++y<a){var A=e[g+"-"+y],T=e[y+"-"+g];if(A.value||T.value){r.push(A.value<T.value?{source:T,target:A}:{source:A,target:T})}}}if(u)f()}function f(){r.sort(function(e,t){return u((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}e.matrix=function(t){if(!arguments.length)return i;a=(i=t)&&i.length;r=n=null;return e};e.padding=function(t){if(!arguments.length)return o;o=t;r=n=null;return e};e.sortGroups=function(t){if(!arguments.length)return s;s=t;r=n=null;return e};e.sortSubgroups=function(t){if(!arguments.length)return l;l=t;r=null;return e};e.sortChords=function(t){if(!arguments.length)return u;u=t;if(r)f();return e};e.chords=function(){if(!r)c();return r};e.groups=function(){if(!n)c();return n};return e};t.layout.force=function(){var e={},r=t.dispatch("start","tick","end"),n,i=[1,1],a,o,s=.9,l=vo,u=mo,c=-30,f=go,h=.1,p=.64,d=[],v=[],m,g,y;function _(e){return function(t,r,n,i){if(t.point!==e){var a=t.cx-e.x,o=t.cy-e.y,s=i-r,l=a*a+o*o;if(s*s/p<l){if(l<f){var u=t.charge/l;e.px-=a*u;e.py-=o*u}return true}if(t.point&&l&&l<f){var u=t.pointCharge/l;e.px-=a*u;e.py-=o*u}}return!t.charge}}e.tick=function(){if((o*=.99)<.005){n=null;r.end({type:"end",alpha:o=0});return true}var e=d.length,a=v.length,l,u,f,p,x,b,w,k,A;for(u=0;u<a;++u){f=v[u];p=f.source;x=f.target;k=x.x-p.x;A=x.y-p.y;if(b=k*k+A*A){b=o*g[u]*((b=Math.sqrt(b))-m[u])/b;k*=b;A*=b;x.x-=k*(w=p.weight+x.weight?p.weight/(p.weight+x.weight):.5);x.y-=A*w;p.x+=k*(w=1-w);p.y+=A*w}}if(w=o*h){k=i[0]/2;A=i[1]/2;u=-1;if(w)while(++u<e){f=d[u];f.x+=(k-f.x)*w;f.y+=(A-f.y)*w}}if(c){po(l=t.geom.quadtree(d),o,y);u=-1;while(++u<e){if(!(f=d[u]).fixed){l.visit(_(f))}}}u=-1;while(++u<e){f=d[u];if(f.fixed){f.x=f.px;f.y=f.py}else{f.x-=(f.px-(f.px=f.x))*s;f.y-=(f.py-(f.py=f.y))*s}}r.tick({type:"tick",alpha:o})};e.nodes=function(t){if(!arguments.length)return d;d=t;return e};e.links=function(t){if(!arguments.length)return v;v=t;return e};e.size=function(t){if(!arguments.length)return i;i=t;return e};e.linkDistance=function(t){if(!arguments.length)return l;l=typeof t==="function"?t:+t;return e};e.distance=e.linkDistance;e.linkStrength=function(t){if(!arguments.length)return u;u=typeof t==="function"?t:+t;return e};e.friction=function(t){if(!arguments.length)return s;s=+t;return e};e.charge=function(t){if(!arguments.length)return c;c=typeof t==="function"?t:+t;return e};e.chargeDistance=function(t){if(!arguments.length)return Math.sqrt(f);f=t*t;return e};e.gravity=function(t){if(!arguments.length)return h;h=+t;return e};e.theta=function(t){if(!arguments.length)return Math.sqrt(p);p=t*t;return e};e.alpha=function(t){if(!arguments.length)return o;t=+t;if(o){if(t>0){o=t}else{n.c=null,n.t=NaN,n=null;r.end({type:"end",alpha:o=0})}}else if(t>0){r.start({type:"start",alpha:o=t});n=Dt(e.tick)}return e};e.start=function(){var t,r=d.length,n=v.length,a=i[0],o=i[1],s,f;for(t=0;t<r;++t){(f=d[t]).index=t;f.weight=0}for(t=0;t<n;++t){f=v[t];if(typeof f.source=="number")f.source=d[f.source];if(typeof f.target=="number")f.target=d[f.target];++f.source.weight;++f.target.weight}for(t=0;t<r;++t){f=d[t];if(isNaN(f.x))f.x=h("x",a);if(isNaN(f.y))f.y=h("y",o);if(isNaN(f.px))f.px=f.x;if(isNaN(f.py))f.py=f.y}m=[];if(typeof l==="function")for(t=0;t<n;++t)m[t]=+l.call(this,v[t],t);else for(t=0;t<n;++t)m[t]=l;g=[];if(typeof u==="function")for(t=0;t<n;++t)g[t]=+u.call(this,v[t],t);else for(t=0;t<n;++t)g[t]=u;y=[];if(typeof c==="function")for(t=0;t<r;++t)y[t]=+c.call(this,d[t],t);else for(t=0;t<r;++t)y[t]=c;function h(e,i){if(!s){s=new Array(r);for(l=0;l<r;++l){s[l]=[]}for(l=0;l<n;++l){var a=v[l];s[a.source.index].push(a.target);s[a.target.index].push(a.source)}}var o=s[t],l=-1,u=o.length,c;while(++l<u)if(!isNaN(c=o[l][e]))return c;return Math.random()*i}return e.resume()};e.resume=function(){return e.alpha(.1)};e.stop=function(){return e.alpha(0)};e.drag=function(){if(!a)a=t.behavior.drag().origin(P).on("dragstart.force",uo).on("drag.force",x).on("dragend.force",co);if(!arguments.length)return a;this.on("mouseover.force",fo).on("mouseout.force",ho).call(a)};function x(r){r.px=t.event.x,r.py=t.event.y;e.resume()}return t.rebind(e,r,"on")};function uo(e){e.fixed|=2}function co(e){e.fixed&=~6}function fo(e){e.fixed|=4;e.px=e.x,e.py=e.y}function ho(e){e.fixed&=~4}function po(e,t,r){var n=0,i=0;e.charge=0;if(!e.leaf){var a=e.nodes,o=a.length,s=-1,l;while(++s<o){l=a[s];if(l==null)continue;po(l,t,r);e.charge+=l.charge;n+=l.charge*l.cx;i+=l.charge*l.cy}}if(e.point){if(!e.leaf){e.point.x+=Math.random()-.5;e.point.y+=Math.random()-.5}var u=t*r[e.point.index];e.charge+=e.pointCharge=u;n+=u*e.point.x;i+=u*e.point.y}e.cx=n/e.charge;e.cy=i/e.charge}var vo=20,mo=1,go=Infinity;t.layout.hierarchy=function(){var e=ko,t=bo,r=wo;function n(i){var a=[i],o=[],s;i.depth=0;while((s=a.pop())!=null){o.push(s);if((u=t.call(n,s,s.depth))&&(l=u.length)){var l,u,c;while(--l>=0){a.push(c=u[l]);c.parent=s;c.depth=s.depth+1}if(r)s.value=0;s.children=u}else{if(r)s.value=+r.call(n,s,s.depth)||0;delete s.children}}xo(i,function(t){var n,i;if(e&&(n=t.children))n.sort(e);if(r&&(i=t.parent))i.value+=t.value});return o}n.sort=function(t){if(!arguments.length)return e;e=t;return n};n.children=function(e){if(!arguments.length)return t;t=e;return n};n.value=function(e){if(!arguments.length)return r;r=e;return n};n.revalue=function(e){if(r){_o(e,function(e){if(e.children)e.value=0});xo(e,function(e){var t;if(!e.children)e.value=+r.call(n,e,e.depth)||0;if(t=e.parent)t.value+=e.value})}return e};return n};function yo(e,r){t.rebind(e,r,"sort","children","value");e.nodes=e;e.links=Ao;return e}function _o(e,t){var r=[e];while((e=r.pop())!=null){t(e);if((i=e.children)&&(n=i.length)){var n,i;while(--n>=0)r.push(i[n])}}}function xo(e,t){var r=[e],n=[];while((e=r.pop())!=null){n.push(e);if((o=e.children)&&(a=o.length)){var i=-1,a,o;while(++i<a)r.push(o[i])}}while((e=n.pop())!=null){t(e)}}function bo(e){return e.children}function wo(e){return e.value}function ko(e,t){return t.value-e.value}function Ao(e){return t.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}t.layout.partition=function(){var e=t.layout.hierarchy(),r=[1,1];function n(e,t,r,i){var a=e.children;e.x=t;e.y=e.depth*i;e.dx=r;e.dy=i;if(a&&(s=a.length)){var o=-1,s,l,u;r=e.value?r/e.value:0;while(++o<s){n(l=a[o],t,u=l.value*r,i);t+=u}}}function i(e){var t=e.children,r=0;if(t&&(a=t.length)){var n=-1,a;while(++n<a)r=Math.max(r,i(t[n]))}return 1+r}function a(t,a){var o=e.call(this,t,a);n(o[0],0,r[0],r[1]/i(o[0]));return o}a.size=function(e){if(!arguments.length)return r;r=e;return a};return yo(a,e)};t.layout.pie=function(){var e=Number,r=To,n=0,i=Ee,a=0;function o(s){var l=s.length,u=s.map(function(t,r){return+e.call(o,t,r)}),c=+(typeof n==="function"?n.apply(this,arguments):n),f=(typeof i==="function"?i.apply(this,arguments):i)-c,h=Math.min(Math.abs(f)/l,+(typeof a==="function"?a.apply(this,arguments):a)),p=h*(f<0?-1:1),d=t.sum(u),v=d?(f-l*p)/d:0,m=t.range(l),g=[],y;if(r!=null)m.sort(r===To?function(e,t){return u[t]-u[e]}:function(e,t){return r(s[e],s[t])});m.forEach(function(e){g[e]={data:s[e],value:y=u[e],startAngle:c,endAngle:c+=y*v+p,padAngle:h}});return g}o.value=function(t){if(!arguments.length)return e;e=t;return o};o.sort=function(e){if(!arguments.length)return r;r=e;return o};o.startAngle=function(e){if(!arguments.length)return n;n=e;return o};o.endAngle=function(e){if(!arguments.length)return i;i=e;return o};o.padAngle=function(e){if(!arguments.length)return a;a=e;return o};return o};var To={};t.layout.stack=function(){var e=P,r=Lo,n=Io,i=Co,a=Mo,o=So;function s(l,u){if(!(v=l.length))return l;var c=l.map(function(t,r){return e.call(s,t,r)});var f=c.map(function(e){return e.map(function(e,t){return[a.call(s,e,t),o.call(s,e,t)]})});var h=r.call(s,f,u);c=t.permute(c,h);f=t.permute(f,h);var p=n.call(s,f,u);var d=c[0].length,v,m,g,y;for(g=0;g<d;++g){i.call(s,c[0][g],y=p[g],f[0][g][1]);for(m=1;m<v;++m){i.call(s,c[m][g],y+=f[m-1][g][1],f[m][g][1])}}return l}s.values=function(t){if(!arguments.length)return e;e=t;return s};s.order=function(e){if(!arguments.length)return r;r=typeof e==="function"?e:zo.get(e)||Lo;return s};s.offset=function(e){if(!arguments.length)return n;n=typeof e==="function"?e:Eo.get(e)||Io;return s};s.x=function(e){if(!arguments.length)return a;a=e;return s};s.y=function(e){if(!arguments.length)return o;o=e;return s};s.out=function(e){if(!arguments.length)return i;i=e;return s};return s};function Mo(e){return e.x}function So(e){return e.y}function Co(e,t,r){e.y0=t;e.y=r}var zo=t.map({"inside-out":function(e){var r=e.length,n,i,a=e.map(Po),o=e.map(Do),s=t.range(r).sort(function(e,t){return a[e]-a[t]}),l=0,u=0,c=[],f=[];for(n=0;n<r;++n){i=s[n];if(l<u){l+=o[i];c.push(i)}else{u+=o[i];f.push(i)}}return f.reverse().concat(c)},reverse:function(e){return t.range(e.length).reverse()},default:Lo});var Eo=t.map({silhouette:function(e){var t=e.length,r=e[0].length,n=[],i=0,a,o,s,l=[];for(o=0;o<r;++o){for(a=0,s=0;a<t;a++)s+=e[a][o][1];if(s>i)i=s;n.push(s)}for(o=0;o<r;++o){l[o]=(i-n[o])/2}return l},wiggle:function(e){var t=e.length,r=e[0],n=r.length,i,a,o,s,l,u,c,f,h,p=[];p[0]=f=h=0;for(a=1;a<n;++a){for(i=0,s=0;i<t;++i)s+=e[i][a][1];for(i=0,l=0,c=r[a][0]-r[a-1][0];i<t;++i){for(o=0,u=(e[i][a][1]-e[i][a-1][1])/(2*c);o<i;++o){u+=(e[o][a][1]-e[o][a-1][1])/c}l+=u*e[i][a][1]}p[a]=f-=s?l/s*c:0;if(f<h)h=f}for(a=0;a<n;++a)p[a]-=h;return p},expand:function(e){var t=e.length,r=e[0].length,n=1/t,i,a,o,s=[];for(a=0;a<r;++a){for(i=0,o=0;i<t;i++)o+=e[i][a][1];if(o)for(i=0;i<t;i++)e[i][a][1]/=o;else for(i=0;i<t;i++)e[i][a][1]=n}for(a=0;a<r;++a)s[a]=0;return s},zero:Io});function Lo(e){return t.range(e.length)}function Io(e){var t=-1,r=e[0].length,n=[];while(++t<r)n[t]=0;return n}function Po(e){var t=1,r=0,n=e[0][1],i,a=e.length;for(;t<a;++t){if((i=e[t][1])>n){r=t;n=i}}return r}function Do(e){return e.reduce(Oo,0)}function Oo(e,t){return e+t[1]}t.layout.histogram=function(){var e=true,r=Number,n=Bo,i=Ro;function a(a,o){var s=[],l=a.map(r,this),u=n.call(this,l,o),c=i.call(this,u,l,o),f,o=-1,h=l.length,p=c.length-1,d=e?1:1/h,v;while(++o<p){f=s[o]=[];f.dx=c[o+1]-(f.x=c[o]);f.y=0}if(p>0){o=-1;while(++o<h){v=l[o];if(v>=u[0]&&v<=u[1]){f=s[t.bisect(c,v,1,p)-1];f.y+=d;f.push(a[o])}}}return s}a.value=function(e){if(!arguments.length)return r;r=e;return a};a.range=function(e){if(!arguments.length)return n;n=At(e);return a};a.bins=function(e){if(!arguments.length)return i;i=typeof e==="number"?function(t){return Fo(t,e)}:At(e);return a};a.frequency=function(t){if(!arguments.length)return e;e=!!t;return a};return a};function Ro(e,t){return Fo(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function Fo(e,t){var r=-1,n=+e[0],i=(e[1]-n)/t,a=[];while(++r<=t)a[r]=i*r+n;return a}function Bo(e){return[t.min(e),t.max(e)]}t.layout.pack=function(){var e=t.layout.hierarchy().sort(No),r=0,n=[1,1],i;function a(t,a){var o=e.call(this,t,a),s=o[0],l=n[0],u=n[1],c=i==null?Math.sqrt:typeof i==="function"?i:function(){return i};s.x=s.y=0;xo(s,function(e){e.r=+c(e.value)});xo(s,Uo);if(r){var f=r*(i?1:Math.max(2*s.r/l,2*s.r/u))/2;xo(s,function(e){e.r+=f});xo(s,Uo);xo(s,function(e){e.r-=f})}Go(s,l/2,u/2,i?1:1/Math.max(2*s.r/l,2*s.r/u));return o}a.size=function(e){if(!arguments.length)return n;n=e;return a};a.radius=function(e){if(!arguments.length)return i;i=e==null||typeof e==="function"?e:+e;return a};a.padding=function(e){if(!arguments.length)return r;r=+e;return a};return yo(a,e)};function No(e,t){return e.value-t.value}function jo(e,t){var r=e._pack_next;e._pack_next=t;t._pack_prev=e;t._pack_next=r;r._pack_prev=t}function Vo(e,t){e._pack_next=t;t._pack_prev=e}function qo(e,t){var r=t.x-e.x,n=t.y-e.y,i=e.r+t.r;return.999*i*i>r*r+n*n}function Uo(e){if(!(t=e.children)||!(h=t.length))return;var t,r=Infinity,n=-Infinity,i=Infinity,a=-Infinity,o,s,l,u,c,f,h;function p(e){r=Math.min(e.x-e.r,r);n=Math.max(e.x+e.r,n);i=Math.min(e.y-e.r,i);a=Math.max(e.y+e.r,a)}t.forEach(Zo);o=t[0];o.x=-o.r;o.y=0;p(o);if(h>1){s=t[1];s.x=s.r;s.y=0;p(s);if(h>2){l=t[2];$o(o,s,l);p(l);jo(o,l);o._pack_prev=l;jo(l,s);s=o._pack_next;for(u=3;u<h;u++){$o(o,s,l=t[u]);var d=0,v=1,m=1;for(c=s._pack_next;c!==s;c=c._pack_next,v++){if(qo(c,l)){d=1;break}}if(d==1){for(f=o._pack_prev;f!==c._pack_prev;f=f._pack_prev,m++){if(qo(f,l)){break}}}if(d){if(v<m||v==m&&s.r<o.r)Vo(o,s=c);else Vo(o=f,s);u--}else{jo(o,l);s=l;p(l)}}}}var g=(r+n)/2,y=(i+a)/2,_=0;for(u=0;u<h;u++){l=t[u];l.x-=g;l.y-=y;_=Math.max(_,l.r+Math.sqrt(l.x*l.x+l.y*l.y))}e.r=_;t.forEach(Ho)}function Zo(e){e._pack_next=e._pack_prev=e}function Ho(e){delete e._pack_next;delete e._pack_prev}function Go(e,t,r,n){var i=e.children;e.x=t+=n*e.x;e.y=r+=n*e.y;e.r*=n;if(i){var a=-1,o=i.length;while(++a<o)Go(i[a],t,r,n)}}function $o(e,t,r){var n=e.r+r.r,i=t.x-e.x,a=t.y-e.y;if(n&&(i||a)){var o=t.r+r.r,s=i*i+a*a;o*=o;n*=n;var l=.5+(n-o)/(2*s),u=Math.sqrt(Math.max(0,2*o*(n+s)-(n-=s)*n-o*o))/(2*s);r.x=e.x+l*i+u*a;r.y=e.y+l*a-u*i}else{r.x=e.x+n;r.y=e.y}}t.layout.tree=function(){var e=t.layout.hierarchy().sort(null).value(null),r=Wo,n=[1,1],i=null;function a(t,a){var u=e.call(this,t,a),f=u[0],h=o(f);xo(h,s),h.parent.m=-h.z;_o(h,l);if(i)_o(f,c);else{var p=f,d=f,v=f;_o(f,function(e){if(e.x<p.x)p=e;if(e.x>d.x)d=e;if(e.depth>v.depth)v=e});var m=r(p,d)/2-p.x,g=n[0]/(d.x+r(d,p)/2+m),y=n[1]/(v.depth||1);_o(f,function(e){e.x=(e.x+m)*g;e.y=e.depth*y})}return u}function o(e){var t={A:null,children:[e]},r=[t],n;while((n=r.pop())!=null){for(var i=n.children,a,o=0,s=i.length;o<s;++o){r.push((i[o]=a={_:i[o],parent:n,children:(a=i[o].children)&&a.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=a)}}return t.children[0]}function s(e){var t=e.children,n=e.parent.children,i=e.i?n[e.i-1]:null;if(t.length){Ko(e);var a=(t[0].z+t[t.length-1].z)/2;if(i){e.z=i.z+r(e._,i._);e.m=e.z-a}else{e.z=a}}else if(i){e.z=i.z+r(e._,i._)}e.parent.A=u(e,i,e.parent.A||n[0])}function l(e){e._.x=e.z+e.parent.m;e.m+=e.parent.m}function u(e,t,n){if(t){var i=e,a=e,o=t,s=i.parent.children[0],l=i.m,u=a.m,c=o.m,f=s.m,h;while(o=Yo(o),i=Xo(i),o&&i){s=Xo(s);a=Yo(a);a.a=e;h=o.z+c-i.z-l+r(o._,i._);if(h>0){Jo(Qo(o,e,n),e,h);l+=h;u+=h}c+=o.m;l+=i.m;f+=s.m;u+=a.m}if(o&&!Yo(a)){a.t=o;a.m+=c-u}if(i&&!Xo(s)){s.t=i;s.m+=l-f;n=e}}return n}function c(e){e.x*=n[0];e.y=e.depth*n[1]}a.separation=function(e){if(!arguments.length)return r;r=e;return a};a.size=function(e){if(!arguments.length)return i?null:n;i=(n=e)==null?c:null;return a};a.nodeSize=function(e){if(!arguments.length)return i?n:null;i=(n=e)==null?null:c;return a};return yo(a,e)};function Wo(e,t){return e.parent==t.parent?1:2}function Xo(e){var t=e.children;return t.length?t[0]:e.t}function Yo(e){var t=e.children,r;return(r=t.length)?t[r-1]:e.t}function Jo(e,t,r){var n=r/(t.i-e.i);t.c-=n;t.s+=r;e.c+=n;t.z+=r;t.m+=r}function Ko(e){var t=0,r=0,n=e.children,i=n.length,a;while(--i>=0){a=n[i];a.z+=t;a.m+=t;t+=a.s+(r+=a.c)}}function Qo(e,t,r){return e.a.parent===t.parent?e.a:r}t.layout.cluster=function(){var e=t.layout.hierarchy().sort(null).value(null),r=Wo,n=[1,1],i=false;function a(t,a){var o=e.call(this,t,a),s=o[0],l,u=0;xo(s,function(e){var t=e.children;if(t&&t.length){e.x=ts(t);e.y=es(t)}else{e.x=l?u+=r(e,l):0;e.y=0;l=e}});var c=rs(s),f=ns(s),h=c.x-r(c,f)/2,p=f.x+r(f,c)/2;xo(s,i?function(e){e.x=(e.x-s.x)*n[0];e.y=(s.y-e.y)*n[1]}:function(e){e.x=(e.x-h)/(p-h)*n[0];e.y=(1-(s.y?e.y/s.y:1))*n[1]});return o}a.separation=function(e){if(!arguments.length)return r;r=e;return a};a.size=function(e){if(!arguments.length)return i?null:n;i=(n=e)==null;return a};a.nodeSize=function(e){if(!arguments.length)return i?n:null;i=(n=e)!=null;return a};return yo(a,e)};function es(e){return 1+t.max(e,function(e){return e.y})}function ts(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function rs(e){var t=e.children;return t&&t.length?rs(t[0]):e}function ns(e){var t=e.children,r;return t&&(r=t.length)?ns(t[r-1]):e}t.layout.treemap=function(){var e=t.layout.hierarchy(),r=Math.round,n=[1,1],i=null,a=is,o=false,s,l="squarify",u=.5*(1+Math.sqrt(5));function c(e,t){var r=-1,n=e.length,i,a;while(++r<n){a=(i=e[r]).value*(t<0?0:t);i.area=isNaN(a)||a<=0?0:a}}function f(e){var t=e.children;if(t&&t.length){var r=a(e),n=[],i=t.slice(),o,s=Infinity,u,h=l==="slice"?r.dx:l==="dice"?r.dy:l==="slice-dice"?e.depth&1?r.dy:r.dx:Math.min(r.dx,r.dy),v;c(i,r.dx*r.dy/e.value);n.area=0;while((v=i.length)>0){n.push(o=i[v-1]);n.area+=o.area;if(l!=="squarify"||(u=p(n,h))<=s){i.pop();s=u}else{n.area-=n.pop().area;d(n,h,r,false);h=Math.min(r.dx,r.dy);n.length=n.area=0;s=Infinity}}if(n.length){d(n,h,r,true);n.length=n.area=0}t.forEach(f)}}function h(e){var t=e.children;if(t&&t.length){var r=a(e),n=t.slice(),i,o=[];c(n,r.dx*r.dy/e.value);o.area=0;while(i=n.pop()){o.push(i);o.area+=i.area;if(i.z!=null){d(o,i.z?r.dx:r.dy,r,!n.length);o.length=o.area=0}}t.forEach(h)}}function p(e,t){var r=e.area,n,i=0,a=Infinity,o=-1,s=e.length;while(++o<s){if(!(n=e[o].area))continue;if(n<a)a=n;if(n>i)i=n}r*=r;t*=t;return r?Math.max(t*i*u/r,r/(t*a*u)):Infinity}function d(e,t,n,i){var a=-1,o=e.length,s=n.x,l=n.y,u=t?r(e.area/t):0,c;if(t==n.dx){if(i||u>n.dy)u=n.dy;while(++a<o){c=e[a];c.x=s;c.y=l;c.dy=u;s+=c.dx=Math.min(n.x+n.dx-s,u?r(c.area/u):0)}c.z=true;c.dx+=n.x+n.dx-s;n.y+=u;n.dy-=u}else{if(i||u>n.dx)u=n.dx;while(++a<o){c=e[a];c.x=s;c.y=l;c.dx=u;l+=c.dy=Math.min(n.y+n.dy-l,u?r(c.area/u):0)}c.z=false;c.dy+=n.y+n.dy-l;n.x+=u;n.dx-=u}}function v(t){var r=s||e(t),i=r[0];i.x=i.y=0;if(i.value)i.dx=n[0],i.dy=n[1];else i.dx=i.dy=0;if(s)e.revalue(i);c([i],i.dx*i.dy/i.value);(s?h:f)(i);if(o)s=r;return r}v.size=function(e){if(!arguments.length)return n;n=e;return v};v.padding=function(e){if(!arguments.length)return i;function t(t){var r=e.call(v,t,t.depth);return r==null?is(t):as(t,typeof r==="number"?[r,r,r,r]:r)}function r(t){return as(t,e)}var n;a=(i=e)==null?is:(n=typeof e)==="function"?t:n==="number"?(e=[e,e,e,e],r):r;return v};v.round=function(e){if(!arguments.length)return r!=Number;r=e?Math.round:Number;return v};v.sticky=function(e){if(!arguments.length)return o;o=e;s=null;return v};v.ratio=function(e){if(!arguments.length)return u;u=e;return v};v.mode=function(e){if(!arguments.length)return l;l=e+"";return v};return yo(v,e)};function is(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function as(e,t){var r=e.x+t[3],n=e.y+t[0],i=e.dx-t[1]-t[3],a=e.dy-t[0]-t[2];if(i<0){r+=i/2;i=0}if(a<0){n+=a/2;a=0}return{x:r,y:n,dx:i,dy:a}}t.random={normal:function(e,t){var r=arguments.length;if(r<2)t=1;if(r<1)e=0;return function(){var r,n,i;do{r=Math.random()*2-1;n=Math.random()*2-1;i=r*r+n*n}while(!i||i>1);return e+t*r*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var e=t.random.normal.apply(t,arguments);return function(){return Math.exp(e())}},bates:function(e){var r=t.random.irwinHall(e);return function(){return r()/e}},irwinHall:function(e){return function(){for(var t=0,r=0;r<e;r++)t+=Math.random();return t}}};t.scale={};function os(e){var t=e[0],r=e[e.length-1];return t<r?[t,r]:[r,t]}function ss(e){return e.rangeExtent?e.rangeExtent():os(e.range())}function ls(e,t,r,n){var i=r(e[0],e[1]),a=n(t[0],t[1]);return function(e){return a(i(e))}}function us(e,t){var r=0,n=e.length-1,i=e[r],a=e[n],o;if(a<i){o=r,r=n,n=o;o=i,i=a,a=o}e[r]=t.floor(i);e[n]=t.ceil(a);return e}function cs(e){return e?{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}:fs}var fs={floor:P,ceil:P};function hs(e,r,n,i){var a=[],o=[],s=0,l=Math.min(e.length,r.length)-1;if(e[l]<e[0]){e=e.slice().reverse();r=r.slice().reverse()}while(++s<=l){a.push(n(e[s-1],e[s]));o.push(i(r[s-1],r[s]))}return function(r){var n=t.bisect(e,r,1,l)-1;return o[n](a[n](r))}}t.scale.linear=function(){return ps([0,1],[0,1],Ta,false)};function ps(e,t,r,n){var i,a;function o(){var o=Math.min(e.length,t.length)>2?hs:ls,l=n?ao:io;i=o(e,t,l,r);a=o(t,e,l,Ta);return s}function s(e){return i(e)}s.invert=function(e){return a(e)};s.domain=function(t){if(!arguments.length)return e;e=t.map(Number);return o()};s.range=function(e){if(!arguments.length)return t;t=e;return o()};s.rangeRound=function(e){return s.range(e).interpolate(Ga)};s.clamp=function(e){if(!arguments.length)return n;n=e;return o()};s.interpolate=function(e){if(!arguments.length)return r;r=e;return o()};s.ticks=function(t){return gs(e,t)};s.tickFormat=function(t,r){return ys(e,t,r)};s.nice=function(t){vs(e,t);return o()};s.copy=function(){return ps(e,t,r,n)};return o()}function ds(e,r){return t.rebind(e,r,"range","rangeRound","interpolate","clamp")}function vs(e,t){us(e,cs(ms(e,t)[2]));us(e,cs(ms(e,t)[2]));return e}function ms(e,t){if(t==null)t=10;var r=os(e),n=r[1]-r[0],i=Math.pow(10,Math.floor(Math.log(n/t)/Math.LN10)),a=t/n*i;if(a<=.15)i*=10;else if(a<=.35)i*=5;else if(a<=.75)i*=2;r[0]=Math.ceil(r[0]/i)*i;r[1]=Math.floor(r[1]/i)*i+i*.5;r[2]=i;return r}function gs(e,r){return t.range.apply(t,ms(e,r))}function ys(e,r,n){var i=ms(e,r);if(n){var a=qt.exec(n);a.shift();if(a[8]==="s"){var o=t.formatPrefix(Math.max(_(i[0]),_(i[1])));if(!a[7])a[7]="."+xs(o.scale(i[2]));a[8]="f";n=t.format(a.join(""));return function(e){return n(o.scale(e))+o.symbol}}if(!a[7])a[7]="."+bs(a[8],i);n=a.join("")}else{n=",."+xs(i[2])+"f"}return t.format(n)}var _s={s:1,g:1,p:1,r:1,e:1};function xs(e){return-Math.floor(Math.log(e)/Math.LN10+.01)}function bs(e,t){var r=xs(t[2]);return e in _s?Math.abs(r-xs(Math.max(_(t[0]),_(t[1]))))+ +(e!=="e"):r-(e==="%")*2}t.scale.log=function(){return ws(t.scale.linear().domain([0,1]),10,true,[1,10])};function ws(e,r,n,i){function a(e){return(n?Math.log(e<0?0:e):-Math.log(e>0?0:-e))/Math.log(r)}function o(e){return n?Math.pow(r,e):-Math.pow(r,-e)}function s(t){return e(a(t))}s.invert=function(t){return o(e.invert(t))};s.domain=function(t){if(!arguments.length)return i;n=t[0]>=0;e.domain((i=t.map(Number)).map(a));return s};s.base=function(t){if(!arguments.length)return r;r=+t;e.domain(i.map(a));return s};s.nice=function(){var t=us(i.map(a),n?Math:As);e.domain(t);i=t.map(o);return s};s.ticks=function(){var e=os(i),t=[],s=e[0],l=e[1],u=Math.floor(a(s)),c=Math.ceil(a(l)),f=r%1?2:r;if(isFinite(c-u)){if(n){for(;u<c;u++)for(var h=1;h<f;h++)t.push(o(u)*h);t.push(o(u))}else{t.push(o(u));for(;u++<c;)for(var h=f-1;h>0;h--)t.push(o(u)*h)}for(u=0;t[u]<s;u++){}for(c=t.length;t[c-1]>l;c--){}t=t.slice(u,c)}return t};s.tickFormat=function(e,n){if(!arguments.length)return ks;if(arguments.length<2)n=ks;else if(typeof n!=="function")n=t.format(n);var i=Math.max(1,r*e/s.ticks().length);return function(e){var t=e/o(Math.round(a(e)));if(t*r<r-.5)t*=r;return t<=i?n(e):""}};s.copy=function(){return ws(e.copy(),r,n,i)};return ds(s,e)}var ks=t.format(".0e"),As={floor:function(e){return-Math.ceil(-e)},ceil:function(e){return-Math.floor(-e)}};t.scale.pow=function(){return Ts(t.scale.linear(),1,[0,1])};function Ts(e,t,r){var n=Ms(t),i=Ms(1/t);function a(t){return e(n(t))}a.invert=function(t){return i(e.invert(t))};a.domain=function(t){if(!arguments.length)return r;e.domain((r=t.map(Number)).map(n));return a};a.ticks=function(e){return gs(r,e)};a.tickFormat=function(e,t){return ys(r,e,t)};a.nice=function(e){return a.domain(vs(r,e))};a.exponent=function(o){if(!arguments.length)return t;n=Ms(t=o);i=Ms(1/t);e.domain(r.map(n));return a};a.copy=function(){return Ts(e.copy(),t,r)};return ds(a,e)}function Ms(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}t.scale.sqrt=function(){return t.scale.pow().exponent(.5)};t.scale.ordinal=function(){return Ss([],{t:"range",a:[[]]})};function Ss(e,r){var n,i,a;function o(t){return i[((n.get(t)||(r.t==="range"?n.set(t,e.push(t)):NaN))-1)%i.length]}function s(r,n){return t.range(e.length).map(function(e){return r+n*e})}o.domain=function(t){if(!arguments.length)return e;e=[];n=new w;var i=-1,a=t.length,s;while(++i<a)if(!n.has(s=t[i]))n.set(s,e.push(s));return o[r.t].apply(o,r.a)};o.range=function(e){if(!arguments.length)return i;i=e;a=0;r={t:"range",a:arguments};return o};o.rangePoints=function(t,n){if(arguments.length<2)n=0;var l=t[0],u=t[1],c=e.length<2?(l=(l+u)/2,0):(u-l)/(e.length-1+n);i=s(l+c*n/2,c);a=0;r={t:"rangePoints",a:arguments};return o};o.rangeRoundPoints=function(t,n){if(arguments.length<2)n=0;var l=t[0],u=t[1],c=e.length<2?(l=u=Math.round((l+u)/2),0):(u-l)/(e.length-1+n)|0;i=s(l+Math.round(c*n/2+(u-l-(e.length-1+n)*c)/2),c);a=0;r={t:"rangeRoundPoints",a:arguments};return o};o.rangeBands=function(t,n,l){if(arguments.length<2)n=0;if(arguments.length<3)l=n;var u=t[1]<t[0],c=t[u-0],f=t[1-u],h=(f-c)/(e.length-n+2*l);i=s(c+h*l,h);if(u)i.reverse();a=h*(1-n);r={t:"rangeBands",a:arguments};return o};o.rangeRoundBands=function(t,n,l){if(arguments.length<2)n=0;if(arguments.length<3)l=n;var u=t[1]<t[0],c=t[u-0],f=t[1-u],h=Math.floor((f-c)/(e.length-n+2*l));i=s(c+Math.round((f-c-(e.length-n)*h)/2),h);if(u)i.reverse();a=Math.round(h*(1-n));r={t:"rangeRoundBands",a:arguments};return o};o.rangeBand=function(){return a};o.rangeExtent=function(){return os(r.a[0])};o.copy=function(){return Ss(e,r)};return o.domain(e)}t.scale.category10=function(){return t.scale.ordinal().range(Cs)};t.scale.category20=function(){return t.scale.ordinal().range(zs)};t.scale.category20b=function(){return t.scale.ordinal().range(Es)};t.scale.category20c=function(){return t.scale.ordinal().range(Ls)};var Cs=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(vt);var zs=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(vt);var Es=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(vt);var Ls=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(vt);t.scale.quantile=function(){return Is([],[])};function Is(e,r){var n;function i(){var i=0,o=r.length;n=[];while(++i<o)n[i-1]=t.quantile(e,i/o);return a}function a(e){if(!isNaN(e=+e))return r[t.bisect(n,e)]}a.domain=function(t){if(!arguments.length)return e;e=t.map(d).filter(v).sort(p);return i()};a.range=function(e){if(!arguments.length)return r;r=e;return i()};a.quantiles=function(){return n};a.invertExtent=function(t){t=r.indexOf(t);return t<0?[NaN,NaN]:[t>0?n[t-1]:e[0],t<n.length?n[t]:e[e.length-1]]};a.copy=function(){return Is(e,r)};return i()}t.scale.quantize=function(){return Ps(0,1,[0,1])};function Ps(e,t,r){var n,i;function a(t){return r[Math.max(0,Math.min(i,Math.floor(n*(t-e))))]}function o(){n=r.length/(t-e);i=r.length-1;return a}a.domain=function(r){if(!arguments.length)return[e,t];e=+r[0];t=+r[r.length-1];return o()};a.range=function(e){if(!arguments.length)return r;r=e;return o()};a.invertExtent=function(t){t=r.indexOf(t);t=t<0?NaN:t/n+e;return[t,t+1/n]};a.copy=function(){return Ps(e,t,r)};return o()}t.scale.threshold=function(){return Ds([.5],[0,1])};function Ds(e,r){function n(n){if(n<=n)return r[t.bisect(e,n)]}n.domain=function(t){if(!arguments.length)return e;e=t;return n};n.range=function(e){if(!arguments.length)return r;r=e;return n};n.invertExtent=function(t){t=r.indexOf(t);return[e[t-1],e[t]]};n.copy=function(){return Ds(e,r)};return n}t.scale.identity=function(){return Os([0,1])};function Os(e){function t(e){return+e}t.invert=t;t.domain=t.range=function(r){if(!arguments.length)return e;e=r.map(t);return t};t.ticks=function(t){return gs(e,t)};t.tickFormat=function(t,r){return ys(e,t,r)};t.copy=function(){return Os(e)};return t}t.svg={};function Rs(){return 0}t.svg.arc=function(){var e=Bs,t=Ns,r=Rs,n=Fs,i=js,a=Vs,o=qs;function s(){var s=Math.max(0,+e.apply(this,arguments)),u=Math.max(0,+t.apply(this,arguments)),c=i.apply(this,arguments)-Ie,f=a.apply(this,arguments)-Ie,h=Math.abs(f-c),p=c>f?0:1;if(u<s)d=u,u=s,s=d;if(h>=Le)return l(u,p)+(s?l(s,1-p):"")+"Z";var d,v,m,g,y=0,_=0,x,b,w,k,A,T,M,S,C=[];if(g=(+o.apply(this,arguments)||0)/2){m=n===Fs?Math.sqrt(s*s+u*u):+n.apply(this,arguments);if(!p)_*=-1;if(u)_=Be(m/u*Math.sin(g));if(s)y=Be(m/s*Math.sin(g))}if(u){x=u*Math.cos(c+_);b=u*Math.sin(c+_);w=u*Math.cos(f-_);k=u*Math.sin(f-_);var z=Math.abs(f-c-2*_)<=ze?0:1;if(_&&Us(x,b,w,k)===p^z){var E=(c+f)/2;x=u*Math.cos(E);b=u*Math.sin(E);w=k=null}}else{x=b=0}if(s){A=s*Math.cos(f-y);T=s*Math.sin(f-y);M=s*Math.cos(c+y);S=s*Math.sin(c+y);var L=Math.abs(c-f+2*y)<=ze?0:1;if(y&&Us(A,T,M,S)===1-p^L){var I=(c+f)/2;A=s*Math.cos(I);T=s*Math.sin(I);M=S=null}}else{A=T=0}if(h>Se&&(d=Math.min(Math.abs(u-s)/2,+r.apply(this,arguments)))>.001){v=s<u^p?0:1;var P=d,D=d;if(h<ze){var O=M==null?[A,T]:w==null?[x,b]:Ei([x,b],[M,S],[w,k],[A,T]),R=x-O[0],F=b-O[1],B=w-O[0],N=k-O[1],j=1/Math.sin(Math.acos((R*B+F*N)/(Math.sqrt(R*R+F*F)*Math.sqrt(B*B+N*N)))/2),V=Math.sqrt(O[0]*O[0]+O[1]*O[1]);D=Math.min(d,(s-V)/(j-1));P=Math.min(d,(u-V)/(j+1))}if(w!=null){var q=Zs(M==null?[A,T]:[M,S],[x,b],u,P,p),U=Zs([w,k],[A,T],u,P,p);if(d===P){C.push("M",q[0],"A",P,",",P," 0 0,",v," ",q[1],"A",u,",",u," 0 ",1-p^Us(q[1][0],q[1][1],U[1][0],U[1][1]),",",p," ",U[1],"A",P,",",P," 0 0,",v," ",U[0])}else{C.push("M",q[0],"A",P,",",P," 0 1,",v," ",U[0])}}else{C.push("M",x,",",b)}if(M!=null){var Z=Zs([x,b],[M,S],s,-D,p),H=Zs([A,T],w==null?[x,b]:[w,k],s,-D,p);if(d===D){C.push("L",H[0],"A",D,",",D," 0 0,",v," ",H[1],"A",s,",",s," 0 ",p^Us(H[1][0],H[1][1],Z[1][0],Z[1][1]),",",1-p," ",Z[1],"A",D,",",D," 0 0,",v," ",Z[0])}else{C.push("L",H[0],"A",D,",",D," 0 0,",v," ",Z[0])}}else{C.push("L",A,",",T)}}else{C.push("M",x,",",b);if(w!=null)C.push("A",u,",",u," 0 ",z,",",p," ",w,",",k);C.push("L",A,",",T);if(M!=null)C.push("A",s,",",s," 0 ",L,",",1-p," ",M,",",S)}C.push("Z");return C.join("")}function l(e,t){return"M0,"+e+"A"+e+","+e+" 0 1,"+t+" 0,"+-e+"A"+e+","+e+" 0 1,"+t+" 0,"+e}s.innerRadius=function(t){if(!arguments.length)return e;e=At(t);return s};s.outerRadius=function(e){if(!arguments.length)return t;t=At(e);return s};s.cornerRadius=function(e){if(!arguments.length)return r;r=At(e);return s};s.padRadius=function(e){if(!arguments.length)return n;n=e==Fs?Fs:At(e);return s};s.startAngle=function(e){if(!arguments.length)return i;i=At(e);return s};s.endAngle=function(e){if(!arguments.length)return a;a=At(e);return s};s.padAngle=function(e){if(!arguments.length)return o;o=At(e);return s};s.centroid=function(){var r=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,n=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Ie;return[Math.cos(n)*r,Math.sin(n)*r]};return s};var Fs="auto";function Bs(e){return e.innerRadius}function Ns(e){return e.outerRadius}function js(e){return e.startAngle}function Vs(e){return e.endAngle}function qs(e){return e&&e.padAngle}function Us(e,t,r,n){return(e-r)*t-(t-n)*e>0?0:1}function Zs(e,t,r,n,i){var a=e[0]-t[0],o=e[1]-t[1],s=(i?n:-n)/Math.sqrt(a*a+o*o),l=s*o,u=-s*a,c=e[0]+l,f=e[1]+u,h=t[0]+l,p=t[1]+u,d=(c+h)/2,v=(f+p)/2,m=h-c,g=p-f,y=m*m+g*g,_=r-n,x=c*p-h*f,b=(g<0?-1:1)*Math.sqrt(Math.max(0,_*_*y-x*x)),w=(x*g-m*b)/y,k=(-x*m-g*b)/y,A=(x*g+m*b)/y,T=(-x*m+g*b)/y,M=w-d,S=k-v,C=A-d,z=T-v;if(M*M+S*S>C*C+z*z)w=A,k=T;return[[w-l,k-u],[w*r/_,k*r/_]]}function Hs(e){var t=Ai,r=Ti,n=sn,i=$s,a=i.key,o=.7;function s(a){var s=[],l=[],u=-1,c=a.length,f,h=At(t),p=At(r);function d(){s.push("M",i(e(l),o))}while(++u<c){if(n.call(this,f=a[u],u)){l.push([+h.call(this,f,u),+p.call(this,f,u)])}else if(l.length){d();l=[]}}if(l.length)d();return s.length?s.join(""):null}s.x=function(e){if(!arguments.length)return t;t=e;return s};s.y=function(e){if(!arguments.length)return r;r=e;return s};s.defined=function(e){if(!arguments.length)return n;n=e;return s};s.interpolate=function(e){if(!arguments.length)return a;if(typeof e==="function")a=i=e;else a=(i=Gs.get(e)||$s).key;return s};s.tension=function(e){if(!arguments.length)return o;o=e;return s};return s}t.svg.line=function(){return Hs(P)};var Gs=t.map({linear:$s,"linear-closed":Ws,step:Xs,"step-before":Ys,"step-after":Js,basis:nl,"basis-open":il,"basis-closed":al,bundle:ol,cardinal:el,"cardinal-open":Ks,"cardinal-closed":Qs,monotone:vl});Gs.forEach(function(e,t){t.key=e;t.closed=/-closed$/.test(e)});function $s(e){return e.length>1?e.join("L"):e+"Z"}function Ws(e){return e.join("L")+"Z"}function Xs(e){var t=0,r=e.length,n=e[0],i=[n[0],",",n[1]];while(++t<r)i.push("H",(n[0]+(n=e[t])[0])/2,"V",n[1]);if(r>1)i.push("H",n[0]);return i.join("")}function Ys(e){var t=0,r=e.length,n=e[0],i=[n[0],",",n[1]];while(++t<r)i.push("V",(n=e[t])[1],"H",n[0]);return i.join("")}function Js(e){var t=0,r=e.length,n=e[0],i=[n[0],",",n[1]];while(++t<r)i.push("H",(n=e[t])[0],"V",n[1]);return i.join("")}function Ks(e,t){return e.length<4?$s(e):e[1]+tl(e.slice(1,-1),rl(e,t))}function Qs(e,t){return e.length<3?Ws(e):e[0]+tl((e.push(e[0]),e),rl([e[e.length-2]].concat(e,[e[1]]),t))}function el(e,t){return e.length<3?$s(e):e[0]+tl(e,rl(e,t))}function tl(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2){return $s(e)}var r=e.length!=t.length,n="",i=e[0],a=e[1],o=t[0],s=o,l=1;if(r){n+="Q"+(a[0]-o[0]*2/3)+","+(a[1]-o[1]*2/3)+","+a[0]+","+a[1];i=e[1];l=2}if(t.length>1){s=t[1];a=e[l];l++;n+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(a[0]-s[0])+","+(a[1]-s[1])+","+a[0]+","+a[1];for(var u=2;u<t.length;u++,l++){a=e[l];s=t[u];n+="S"+(a[0]-s[0])+","+(a[1]-s[1])+","+a[0]+","+a[1]}}if(r){var c=e[l];n+="Q"+(a[0]+s[0]*2/3)+","+(a[1]+s[1]*2/3)+","+c[0]+","+c[1]}return n}function rl(e,t){var r=[],n=(1-t)/2,i,a=e[0],o=e[1],s=1,l=e.length;while(++s<l){i=a;a=o;o=e[s];r.push([n*(o[0]-i[0]),n*(o[1]-i[1])])}return r}function nl(e){if(e.length<3)return $s(e);var t=1,r=e.length,n=e[0],i=n[0],a=n[1],o=[i,i,i,(n=e[1])[0]],s=[a,a,a,n[1]],l=[i,",",a,"L",sl(cl,o),",",sl(cl,s)];e.push(e[r-1]);while(++t<=r){n=e[t];o.shift();o.push(n[0]);s.shift();s.push(n[1]);fl(l,o,s)}e.pop();l.push("L",n);return l.join("")}function il(e){if(e.length<4)return $s(e);var t=[],r=-1,n=e.length,i,a=[0],o=[0];while(++r<3){i=e[r];a.push(i[0]);o.push(i[1])}t.push(sl(cl,a)+","+sl(cl,o));--r;while(++r<n){i=e[r];a.shift();a.push(i[0]);o.shift();o.push(i[1]);fl(t,a,o)}return t.join("")}function al(e){var t,r=-1,n=e.length,i=n+4,a,o=[],s=[];while(++r<4){a=e[r%n];o.push(a[0]);s.push(a[1])}t=[sl(cl,o),",",sl(cl,s)];--r;while(++r<i){a=e[r%n];o.shift();o.push(a[0]);s.shift();s.push(a[1]);fl(t,o,s)}return t.join("")}function ol(e,t){var r=e.length-1;if(r){var n=e[0][0],i=e[0][1],a=e[r][0]-n,o=e[r][1]-i,s=-1,l,u;while(++s<=r){l=e[s];u=s/r;l[0]=t*l[0]+(1-t)*(n+u*a);l[1]=t*l[1]+(1-t)*(i+u*o)}}return nl(e)}function sl(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}var ll=[0,2/3,1/3,0],ul=[0,1/3,2/3,0],cl=[0,1/6,2/3,1/6];function fl(e,t,r){e.push("C",sl(ll,t),",",sl(ll,r),",",sl(ul,t),",",sl(ul,r),",",sl(cl,t),",",sl(cl,r))}function hl(e,t){return(t[1]-e[1])/(t[0]-e[0])}function pl(e){var t=0,r=e.length-1,n=[],i=e[0],a=e[1],o=n[0]=hl(i,a);while(++t<r){n[t]=(o+(o=hl(i=a,a=e[t+1])))/2}n[t]=o;return n}function dl(e){var t=[],r,n,i,a,o=pl(e),s=-1,l=e.length-1;while(++s<l){r=hl(e[s],e[s+1]);if(_(r)<Se){o[s]=o[s+1]=0}else{n=o[s]/r;i=o[s+1]/r;a=n*n+i*i;if(a>9){a=r*3/Math.sqrt(a);o[s]=a*n;o[s+1]=a*i}}}s=-1;while(++s<=l){a=(e[Math.min(l,s+1)][0]-e[Math.max(0,s-1)][0])/(6*(1+o[s]*o[s]));t.push([a||0,o[s]*a||0])}return t}function vl(e){return e.length<3?$s(e):e[0]+tl(e,dl(e))}t.svg.line.radial=function(){var e=Hs(ml);e.radius=e.x,delete e.x;e.angle=e.y,delete e.y;return e};function ml(e){var t,r=-1,n=e.length,i,a;while(++r<n){t=e[r];i=t[0];a=t[1]-Ie;t[0]=i*Math.cos(a);t[1]=i*Math.sin(a)}return e}function gl(e){var t=Ai,r=Ai,n=0,i=Ti,a=sn,o=$s,s=o.key,l=o,u="L",c=.7;function f(s){var f=[],h=[],p=[],d=-1,v=s.length,m,g=At(t),y=At(n),_=t===r?function(){return b}:At(r),x=n===i?function(){return w}:At(i),b,w;function k(){f.push("M",o(e(p),c),u,l(e(h.reverse()),c),"Z")}while(++d<v){if(a.call(this,m=s[d],d)){h.push([b=+g.call(this,m,d),w=+y.call(this,m,d)]);p.push([+_.call(this,m,d),+x.call(this,m,d)])}else if(h.length){k();h=[];p=[]}}if(h.length)k();return f.length?f.join(""):null}f.x=function(e){if(!arguments.length)return r;t=r=e;return f};f.x0=function(e){if(!arguments.length)return t;t=e;return f};f.x1=function(e){if(!arguments.length)return r;r=e;return f};f.y=function(e){if(!arguments.length)return i;n=i=e;return f};f.y0=function(e){if(!arguments.length)return n;n=e;return f};f.y1=function(e){if(!arguments.length)return i;i=e;return f};f.defined=function(e){if(!arguments.length)return a;a=e;return f};f.interpolate=function(e){if(!arguments.length)return s;if(typeof e==="function")s=o=e;else s=(o=Gs.get(e)||$s).key;l=o.reverse||o;u=o.closed?"M":"L";return f};f.tension=function(e){if(!arguments.length)return c;c=e;return f};return f}Ys.reverse=Js;Js.reverse=Ys;t.svg.area=function(){return gl(P)};t.svg.area.radial=function(){var e=gl(ml);e.radius=e.x,delete e.x;e.innerRadius=e.x0,delete e.x0;e.outerRadius=e.x1,delete e.x1;e.angle=e.y,delete e.y;e.startAngle=e.y0,delete e.y0;e.endAngle=e.y1,delete e.y1;return e};t.svg.chord=function(){var e=si,t=li,r=yl,n=js,i=Vs;function a(r,n){var i=o(this,e,r,n),a=o(this,t,r,n);return"M"+i.p0+l(i.r,i.p1,i.a1-i.a0)+(s(i,a)?u(i.r,i.p1,i.r,i.p0):u(i.r,i.p1,a.r,a.p0)+l(a.r,a.p1,a.a1-a.a0)+u(a.r,a.p1,i.r,i.p0))+"Z"}function o(e,t,a,o){var s=t.call(e,a,o),l=r.call(e,s,o),u=n.call(e,s,o)-Ie,c=i.call(e,s,o)-Ie;return{r:l,a0:u,a1:c,p0:[l*Math.cos(u),l*Math.sin(u)],p1:[l*Math.cos(c),l*Math.sin(c)]}}function s(e,t){return e.a0==t.a0&&e.a1==t.a1}function l(e,t,r){return"A"+e+","+e+" 0 "+ +(r>ze)+",1 "+t}function u(e,t,r,n){return"Q 0,0 "+n}a.radius=function(e){if(!arguments.length)return r;r=At(e);return a};a.source=function(t){if(!arguments.length)return e;e=At(t);return a};a.target=function(e){if(!arguments.length)return t;t=At(e);return a};a.startAngle=function(e){if(!arguments.length)return n;n=At(e);return a};a.endAngle=function(e){if(!arguments.length)return i;i=At(e);return a};return a};function yl(e){return e.radius}t.svg.diagonal=function(){var e=si,t=li,r=_l;function n(n,i){var a=e.call(this,n,i),o=t.call(this,n,i),s=(a.y+o.y)/2,l=[a,{x:a.x,y:s},{x:o.x,y:s},o];l=l.map(r);return"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}n.source=function(t){if(!arguments.length)return e;e=At(t);return n};n.target=function(e){if(!arguments.length)return t;t=At(e);return n};n.projection=function(e){if(!arguments.length)return r;r=e;return n};return n};function _l(e){return[e.x,e.y]}t.svg.diagonal.radial=function(){var e=t.svg.diagonal(),r=_l,n=e.projection;e.projection=function(e){return arguments.length?n(xl(r=e)):r};return e};function xl(e){return function(){var t=e.apply(this,arguments),r=t[0],n=t[1]-Ie;return[r*Math.cos(n),r*Math.sin(n)]}}t.svg.symbol=function(){var e=wl,t=bl;function r(r,n){return(Al.get(e.call(this,r,n))||kl)(t.call(this,r,n))}r.type=function(t){if(!arguments.length)return e;e=At(t);return r};r.size=function(e){if(!arguments.length)return t;t=At(e);return r};return r};function bl(){return 64}function wl(){return"circle"}function kl(e){var t=Math.sqrt(e/ze);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}var Al=t.map({circle:kl,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*Ml)),r=t*Ml;return"M0,"+-t+"L"+r+",0"+" 0,"+t+" "+-r+",0"+"Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Tl),r=t*Tl/2;return"M0,"+r+"L"+t+","+-r+" "+-t+","+-r+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Tl),r=t*Tl/2;return"M0,"+-r+"L"+t+","+r+" "+-t+","+r+"Z"}});t.svg.symbolTypes=Al.keys();var Tl=Math.sqrt(3),Ml=Math.tan(30*Pe);X.transition=function(e){var t=Il||++Ll,r=Rl(e),n=[],i,a,o=Pl||{time:Date.now(),ease:Oa,delay:0,duration:250};for(var s=-1,l=this.length;++s<l;){n.push(i=[]);for(var u=this[s],c=-1,f=u.length;++c<f;){if(a=u[c])Fl(a,c,r,t,o);i.push(a)}}return zl(n,r,t)};X.interrupt=function(e){return this.each(e==null?Sl:Cl(Rl(e)))};var Sl=Cl(Rl());function Cl(e){return function(){var t,r,n;if((t=this[e])&&(n=t[r=t.active])){n.timer.c=null;n.timer.t=NaN;if(--t.count)delete t[r];else delete this[e];t.active+=.5;n.event&&n.event.interrupt.call(this,this.__data__,n.index)}}}function zl(e,t,r){Z(e,El);e.namespace=t;e.id=r;return e}var El=[],Ll=0,Il,Pl;El.call=X.call;El.empty=X.empty;El.node=X.node;El.size=X.size;t.transition=function(e,r){return e&&e.transition?Il?e.transition(r):e:t.selection().transition(e)};t.transition.prototype=El;El.select=function(e){var t=this.id,r=this.namespace,n=[],i,a,o;e=Y(e);for(var s=-1,l=this.length;++s<l;){n.push(i=[]);for(var u=this[s],c=-1,f=u.length;++c<f;){if((o=u[c])&&(a=e.call(o,o.__data__,c,s))){if("__data__"in o)a.__data__=o.__data__;Fl(a,c,r,t,o[r][t]);i.push(a)}else{i.push(null)}}}return zl(n,r,t)};El.selectAll=function(e){var t=this.id,r=this.namespace,n=[],i,a,o,s,l;e=J(e);for(var u=-1,c=this.length;++u<c;){for(var f=this[u],h=-1,p=f.length;++h<p;){if(o=f[h]){l=o[r][t];a=e.call(o,o.__data__,h,u);n.push(i=[]);for(var d=-1,v=a.length;++d<v;){if(s=a[d])Fl(s,d,r,t,l);i.push(s)}}}}return zl(n,r,t)};El.filter=function(e){var t=[],r,n,i;if(typeof e!=="function")e=fe(e);for(var a=0,o=this.length;a<o;a++){t.push(r=[]);for(var n=this[a],s=0,l=n.length;s<l;s++){if((i=n[s])&&e.call(i,i.__data__,s,a)){r.push(i)}}}return zl(t,this.namespace,this.id)};El.tween=function(e,t){var r=this.id,n=this.namespace;if(arguments.length<2)return this.node()[n][r].tween.get(e);return pe(this,t==null?function(t){t[n][r].tween.remove(e)}:function(i){i[n][r].tween.set(e,t)})};function Dl(e,t,r,n){var i=e.id,a=e.namespace;return pe(e,typeof r==="function"?function(e,o,s){e[a][i].tween.set(t,n(r.call(e,e.__data__,o,s)))}:(r=n(r),function(e){e[a][i].tween.set(t,r)}))}El.attr=function(e,r){if(arguments.length<2){for(r in e)this.attr(r,e[r]);return this}var n=e=="transform"?no:Ta,i=t.ns.qualify(e);function a(){this.removeAttribute(i)}function o(){this.removeAttributeNS(i.space,i.local)}function s(e){return e==null?a:(e+="",function(){var t=this.getAttribute(i),r;return t!==e&&(r=n(t,e),function(e){this.setAttribute(i,r(e))})})}function l(e){return e==null?o:(e+="",function(){var t=this.getAttributeNS(i.space,i.local),r;return t!==e&&(r=n(t,e),function(e){this.setAttributeNS(i.space,i.local,r(e))})})}return Dl(this,"attr."+e,r,i.local?l:s)};El.attrTween=function(e,r){var n=t.ns.qualify(e);function i(e,t){var i=r.call(this,e,t,this.getAttribute(n));return i&&function(e){this.setAttribute(n,i(e))}}function a(e,t){var i=r.call(this,e,t,this.getAttributeNS(n.space,n.local));return i&&function(e){this.setAttributeNS(n.space,n.local,i(e))}}return this.tween("attr."+e,n.local?a:i)};El.style=function(e,t,r){var n=arguments.length;if(n<3){if(typeof e!=="string"){if(n<2)t="";for(r in e)this.style(r,e[r],t);return this}r=""}function i(){this.style.removeProperty(e)}function a(t){return t==null?i:(t+="",function(){var n=s(this).getComputedStyle(this,null).getPropertyValue(e),i;return n!==t&&(i=Ta(n,t),function(t){this.style.setProperty(e,i(t),r)})})}return Dl(this,"style."+e,t,a)};El.styleTween=function(e,t,r){if(arguments.length<3)r="";function n(n,i){var a=t.call(this,n,i,s(this).getComputedStyle(this,null).getPropertyValue(e));return a&&function(t){this.style.setProperty(e,a(t),r)}}return this.tween("style."+e,n)};El.text=function(e){return Dl(this,"text",e,Ol)};function Ol(e){if(e==null)e="";return function(){this.textContent=e}}El.remove=function(){var e=this.namespace;return this.each("end.transition",function(){var t;if(this[e].count<2&&(t=this.parentNode))t.removeChild(this)})};El.ease=function(e){var r=this.id,n=this.namespace;if(arguments.length<1)return this.node()[n][r].ease;if(typeof e!=="function")e=t.ease.apply(t,arguments);return pe(this,function(t){t[n][r].ease=e})};El.delay=function(e){var t=this.id,r=this.namespace;if(arguments.length<1)return this.node()[r][t].delay;return pe(this,typeof e==="function"?function(n,i,a){n[r][t].delay=+e.call(n,n.__data__,i,a)}:(e=+e,function(n){n[r][t].delay=e}))};El.duration=function(e){var t=this.id,r=this.namespace;if(arguments.length<1)return this.node()[r][t].duration;return pe(this,typeof e==="function"?function(n,i,a){n[r][t].duration=Math.max(1,e.call(n,n.__data__,i,a))}:(e=Math.max(1,e),function(n){n[r][t].duration=e}))};El.each=function(e,r){var n=this.id,i=this.namespace;if(arguments.length<2){var a=Pl,o=Il;try{Il=n;pe(this,function(t,r,a){Pl=t[i][n];e.call(t,t.__data__,r,a)})}finally{Pl=a;Il=o}}else{pe(this,function(a){var o=a[i][n];(o.event||(o.event=t.dispatch("start","end","interrupt"))).on(e,r)})}return this};El.transition=function(){var e=this.id,t=++Ll,r=this.namespace,n=[],i,a,o,s;for(var l=0,u=this.length;l<u;l++){n.push(i=[]);for(var a=this[l],c=0,f=a.length;c<f;c++){if(o=a[c]){s=o[r][e];Fl(o,c,r,t,{time:s.time,ease:s.ease,delay:s.delay+s.duration,duration:s.duration})}i.push(o)}}return zl(n,r,t)};function Rl(e){return e==null?"__transition__":"__transition_"+e+"__"}function Fl(e,t,r,n,i){var a=e[r]||(e[r]={active:0,count:0}),o=a[n],s,l,u,c,f;function h(e){var t=o.delay;l.t=t+s;if(t<=e)return p(e-t);l.c=p}function p(r){var i=a.active,h=a[i];if(h){h.timer.c=null;h.timer.t=NaN;--a.count;delete a[i];h.event&&h.event.interrupt.call(e,e.__data__,h.index)}for(var p in a){if(+p<n){var v=a[p];v.timer.c=null;v.timer.t=NaN;--a.count;delete a[p]}}l.c=d;Dt(function(){if(l.c&&d(r||1)){l.c=null;l.t=NaN}return 1},0,s);a.active=n;o.event&&o.event.start.call(e,e.__data__,t);f=[];o.tween.forEach(function(r,n){if(n=n.call(e,e.__data__,t)){f.push(n)}});c=o.ease;u=o.duration}function d(i){var s=i/u,l=c(s),h=f.length;while(h>0){f[--h].call(e,l)}if(s>=1){o.event&&o.event.end.call(e,e.__data__,t);if(--a.count)delete a[n];else delete e[r];return 1}}if(!o){s=i.time;l=Dt(h,0,s);o=a[n]={tween:new w,time:s,timer:l,delay:i.delay,duration:i.duration,ease:i.ease,index:t};i=null;++a.count}}t.svg.axis=function(){var e=t.scale.linear(),r=Bl,n=6,a=6,o=3,s=[10],l=null,u;function c(i){i.each(function(){var i=t.select(this);var c=this.__chart__||e,f=this.__chart__=e.copy();var h=l==null?f.ticks?f.ticks.apply(f,s):f.domain():l,p=u==null?f.tickFormat?f.tickFormat.apply(f,s):P:u,d=i.selectAll(".tick").data(h,f),v=d.enter().insert("g",".domain").attr("class","tick").style("opacity",Se),m=t.transition(d.exit()).style("opacity",Se).remove(),g=t.transition(d.order()).style("opacity",1),y=Math.max(n,0)+o,_;var x=ss(f),b=i.selectAll(".domain").data([0]),w=(b.enter().append("path").attr("class","domain"),t.transition(b));v.append("line");v.append("text");var k=v.select("line"),A=g.select("line"),T=d.select("text").text(p),M=v.select("text"),S=g.select("text"),C=r==="top"||r==="left"?-1:1,z,E,L,I;if(r==="bottom"||r==="top"){_=jl,z="x",L="y",E="x2",I="y2";T.attr("dy",C<0?"0em":".71em").style("text-anchor","middle");w.attr("d","M"+x[0]+","+C*a+"V0H"+x[1]+"V"+C*a)}else{_=Vl,z="y",L="x",E="y2",I="x2";T.attr("dy",".32em").style("text-anchor",C<0?"end":"start");w.attr("d","M"+C*a+","+x[0]+"H0V"+x[1]+"H"+C*a)}k.attr(I,C*n);M.attr(L,C*y);A.attr(E,0).attr(I,C*n);S.attr(z,0).attr(L,C*y);if(f.rangeBand){var D=f,O=D.rangeBand()/2;c=f=function(e){return D(e)+O}}else if(c.rangeBand){c=f}else{m.call(_,f,c)}v.call(_,c,f);g.call(_,f,f)})}c.scale=function(t){if(!arguments.length)return e;e=t;return c};c.orient=function(e){if(!arguments.length)return r;r=e in Nl?e+"":Bl;return c};c.ticks=function(){if(!arguments.length)return s;s=i(arguments);return c};c.tickValues=function(e){if(!arguments.length)return l;l=e;return c};c.tickFormat=function(e){if(!arguments.length)return u;u=e;return c};c.tickSize=function(e){var t=arguments.length;if(!t)return n;n=+e;a=+arguments[t-1];return c};c.innerTickSize=function(e){if(!arguments.length)return n;n=+e;return c};c.outerTickSize=function(e){if(!arguments.length)return a;a=+e;return c};c.tickPadding=function(e){if(!arguments.length)return o;o=+e;return c};c.tickSubdivide=function(){return arguments.length&&c};return c};var Bl="bottom",Nl={top:1,right:1,bottom:1,left:1};function jl(e,t,r){e.attr("transform",function(e){var n=t(e);return"translate("+(isFinite(n)?n:r(e))+",0)"})}function Vl(e,t,r){e.attr("transform",function(e){var n=t(e);return"translate(0,"+(isFinite(n)?n:r(e))+")"})}t.svg.brush=function(){var e=q(h,"brushstart","brush","brushend"),r=null,n=null,i=[0,0],a=[0,0],o,l,u=true,c=true,f=Ul[0];function h(e){e.each(function(){var e=t.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",m).on("touchstart.brush",m);var i=e.selectAll(".background").data([0]);i.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");e.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=e.selectAll(".resize").data(f,P);a.exit().remove();a.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return ql[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");a.style("display",h.empty()?"none":null);var o=t.transition(e),s=t.transition(i),l;if(r){l=ss(r);s.attr("x",l[0]).attr("width",l[1]-l[0]);d(o)}if(n){l=ss(n);s.attr("y",l[0]).attr("height",l[1]-l[0]);v(o)}p(o)})}h.event=function(r){r.each(function(){var r=e.of(this,arguments),n={x:i,y:a,i:o,j:l},s=this.__chart__||n;this.__chart__=n;if(Il){t.select(this).transition().each("start.brush",function(){o=s.i;l=s.j;i=s.x;a=s.y;r({type:"brushstart"})}).tween("brush:brush",function(){var e=Ma(i,n.x),t=Ma(a,n.y);o=l=null;return function(o){i=n.x=e(o);a=n.y=t(o);r({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=n.i;l=n.j;r({type:"brush",mode:"resize"});r({type:"brushend"})})}else{r({type:"brushstart"});r({type:"brush",mode:"resize"});r({type:"brushend"})}})};function p(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+i[+/e$/.test(e)]+","+a[+/^s/.test(e)]+")"})}function d(e){e.select(".extent").attr("x",i[0]);e.selectAll(".extent,.n>rect,.s>rect").attr("width",i[1]-i[0])}function v(e){e.select(".extent").attr("y",a[0]);e.selectAll(".extent,.e>rect,.w>rect").attr("height",a[1]-a[0])}function m(){var f=this,m=t.select(t.event.target),g=e.of(f,arguments),y=t.select(f),_=m.datum(),x=!/^(n|s)$/.test(_)&&r,b=!/^(e|w)$/.test(_)&&n,w=m.classed("extent"),k=ke(f),A,T=t.mouse(f),M;var S=t.select(s(f)).on("keydown.brush",E).on("keyup.brush",L);if(t.event.changedTouches){S.on("touchmove.brush",I).on("touchend.brush",D)}else{S.on("mousemove.brush",I).on("mouseup.brush",D)}y.interrupt().selectAll("*").interrupt();if(w){T[0]=i[0]-T[0];T[1]=a[0]-T[1]}else if(_){var C=+/w$/.test(_),z=+/^n/.test(_);M=[i[1-C]-T[0],a[1-z]-T[1]];T[0]=i[C];T[1]=a[z]}else if(t.event.altKey)A=T.slice();y.style("pointer-events","none").selectAll(".resize").style("display",null);t.select("body").style("cursor",m.style("cursor"));g({type:"brushstart"});I();function E(){if(t.event.keyCode==32){if(!w){A=null;T[0]-=i[1];T[1]-=a[1];w=2}j()}}function L(){if(t.event.keyCode==32&&w==2){T[0]+=i[1];T[1]+=a[1];w=0;j()}}function I(){var e=t.mouse(f),o=false;if(M){e[0]+=M[0];e[1]+=M[1]}if(!w){if(t.event.altKey){if(!A)A=[(i[0]+i[1])/2,(a[0]+a[1])/2];T[0]=i[+(e[0]<A[0])];T[1]=a[+(e[1]<A[1])]}else A=null}if(x&&P(e,r,0)){d(y);o=true}if(b&&P(e,n,1)){v(y);o=true}if(o){p(y);g({type:"brush",mode:w?"move":"resize"})}}function P(e,t,r){var n=ss(t),s=n[0],f=n[1],h=T[r],p=r?a:i,d=p[1]-p[0],v,m;if(w){s-=h;f-=d+h}v=(r?c:u)?Math.max(s,Math.min(f,e[r])):e[r];if(w){m=(v+=h)+d}else{if(A)h=Math.max(s,Math.min(f,2*A[r]-v));if(h<v){m=v;v=h}else{m=h}}if(p[0]!=v||p[1]!=m){if(r)l=null;else o=null;p[0]=v;p[1]=m;return true}}function D(){I();y.style("pointer-events","all").selectAll(".resize").style("display",h.empty()?"none":null);t.select("body").style("cursor",null);S.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);k();g({type:"brushend"})}}h.x=function(e){if(!arguments.length)return r;r=e;f=Ul[!r<<1|!n];return h};h.y=function(e){if(!arguments.length)return n;n=e;f=Ul[!r<<1|!n];return h};h.clamp=function(e){if(!arguments.length)return r&&n?[u,c]:r?u:n?c:null;if(r&&n)u=!!e[0],c=!!e[1];else if(r)u=!!e;else if(n)c=!!e;return h};h.extent=function(e){var t,s,u,c,f;if(!arguments.length){if(r){if(o){t=o[0],s=o[1]}else{t=i[0],s=i[1];if(r.invert)t=r.invert(t),s=r.invert(s);if(s<t)f=t,t=s,s=f}}if(n){if(l){u=l[0],c=l[1]}else{u=a[0],c=a[1];if(n.invert)u=n.invert(u),c=n.invert(c);if(c<u)f=u,u=c,c=f}}return r&&n?[[t,u],[s,c]]:r?[t,s]:n&&[u,c]}if(r){t=e[0],s=e[1];if(n)t=t[0],s=s[0];o=[t,s];if(r.invert)t=r(t),s=r(s);if(s<t)f=t,t=s,s=f;if(t!=i[0]||s!=i[1])i=[t,s]}if(n){u=e[0],c=e[1];if(r)u=u[1],c=c[1];l=[u,c];if(n.invert)u=n(u),c=n(c);if(c<u)f=u,u=c,c=f;if(u!=a[0]||c!=a[1])a=[u,c]}return h};h.clear=function(){if(!h.empty()){i=[0,0],a=[0,0];o=l=null}return h};h.empty=function(){return!!r&&i[0]==i[1]||!!n&&a[0]==a[1]};return t.rebind(h,e,"on")};var ql={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};var Ul=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];var Zl=Ht.format=br.timeFormat;var Hl=Zl.utc;var Gl=Hl("%Y-%m-%dT%H:%M:%S.%LZ");Zl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?$l:Gl;function $l(e){return e.toISOString()}$l.parse=function(e){var t=new Date(e);return isNaN(t)?null:t};$l.toString=Gl.toString;Ht.second=Xt(function(e){return new Gt(Math.floor(e/1e3)*1e3)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*1e3)},function(e){return e.getSeconds()});Ht.seconds=Ht.second.range;Ht.seconds.utc=Ht.second.utc.range;Ht.minute=Xt(function(e){return new Gt(Math.floor(e/6e4)*6e4)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*6e4)},function(e){return e.getMinutes()});Ht.minutes=Ht.minute.range;Ht.minutes.utc=Ht.minute.utc.range;Ht.hour=Xt(function(e){var t=e.getTimezoneOffset()/60;return new Gt((Math.floor(e/36e5-t)+t)*36e5)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*36e5)},function(e){return e.getHours()});Ht.hours=Ht.hour.range;Ht.hours.utc=Ht.hour.utc.range;Ht.month=Xt(function(e){e=Ht.day(e);e.setDate(1);return e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()});Ht.months=Ht.month.range;Ht.months.utc=Ht.month.utc.range;function Wl(e,r,n){function i(t){return e(t)}i.invert=function(t){return Xl(e.invert(t))};i.domain=function(t){if(!arguments.length)return e.domain().map(Xl);e.domain(t);return i};function a(e,n){var i=e[1]-e[0],a=i/n,o=t.bisect(Yl,a);return o==Yl.length?[r.year,ms(e.map(function(e){return e/31536e6}),n)[2]]:!o?[Ql,ms(e,n)[2]]:r[a/Yl[o-1]<Yl[o]/a?o-1:o]}i.nice=function(e,t){var r=i.domain(),n=os(r),o=e==null?a(n,10):typeof e==="number"&&a(n,e);if(o)e=o[0],t=o[1];function s(r){return!isNaN(r)&&!e.range(r,Xl(+r+1),t).length}return i.domain(us(r,t>1?{floor:function(t){while(s(t=e.floor(t)))t=Xl(t-1);return t},ceil:function(t){while(s(t=e.ceil(t)))t=Xl(+t+1);return t}}:e))};i.ticks=function(e,t){var r=os(i.domain()),n=e==null?a(r,10):typeof e==="number"?a(r,e):!e.range&&[{range:e},t];if(n)e=n[0],t=n[1];return e.range(r[0],Xl(+r[1]+1),t<1?1:t)};i.tickFormat=function(){return n};i.copy=function(){return Wl(e.copy(),r,n)};return ds(i,e)}function Xl(e){return new Date(e)}var Yl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6];var Jl=[[Ht.second,1],[Ht.second,5],[Ht.second,15],[Ht.second,30],[Ht.minute,1],[Ht.minute,5],[Ht.minute,15],[Ht.minute,30],[Ht.hour,1],[Ht.hour,3],[Ht.hour,6],[Ht.hour,12],[Ht.day,1],[Ht.day,2],[Ht.week,1],[Ht.month,1],[Ht.month,3],[Ht.year,1]];var Kl=Zl.multi([[".%L",function(e){return e.getMilliseconds()}],[":%S",function(e){return e.getSeconds()}],["%I:%M",function(e){return e.getMinutes()}],["%I %p",function(e){return e.getHours()}],["%a %d",function(e){return e.getDay()&&e.getDate()!=1}],["%b %d",function(e){return e.getDate()!=1}],["%B",function(e){return e.getMonth()}],["%Y",sn]]);var Ql={range:function(e,r,n){return t.range(Math.ceil(e/n)*n,+r,n).map(Xl)},floor:P,ceil:P};Jl.year=Ht.year;Ht.scale=function(){return Wl(t.scale.linear(),Jl,Kl)};var eu=Jl.map(function(e){return[e[0].utc,e[1]]});var tu=Hl.multi([[".%L",function(e){return e.getUTCMilliseconds()}],[":%S",function(e){return e.getUTCSeconds()}],["%I:%M",function(e){return e.getUTCMinutes()}],["%I %p",function(e){return e.getUTCHours()}],["%a %d",function(e){return e.getUTCDay()&&e.getUTCDate()!=1}],["%b %d",function(e){return e.getUTCDate()!=1}],["%B",function(e){return e.getUTCMonth()}],["%Y",sn]]);eu.year=Ht.year.utc;Ht.scale.utc=function(){return Wl(t.scale.linear(),eu,tu)};t.text=Tt(function(e){return e.responseText});t.json=function(e,t){return Mt(e,"application/json",ru,t)};function ru(e){return JSON.parse(e.responseText)}t.html=function(e,t){return Mt(e,"text/html",nu,t)};function nu(e){var t=a.createRange();t.selectNode(a.body);return t.createContextualFragment(e.responseText)}t.xml=Tt(function(e){return e.responseXML});if(typeof e==="function"&&e.amd)this.d3=t,e(t);else if(typeof r==="object"&&r.exports)r.exports=t;else this.d3=t}()},{}],7:[function(t,r,n){(function(i,a){(function(t,i){typeof n==="object"&&typeof r!=="undefined"?r.exports=i():typeof e==="function"&&e.amd?e(i):t.ES6Promise=i()})(this,function(){"use strict";function e(e){return typeof e==="function"||typeof e==="object"&&e!==null}function r(e){return typeof e==="function"}var n=undefined;if(!Array.isArray){n=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}else{n=Array.isArray}var o=n;var s=0;var l=undefined;var u=undefined;var c=function e(t,r){k[s]=t;k[s+1]=r;s+=2;if(s===2){if(u){u(A)}else{M()}}};function f(e){u=e}function h(e){c=e}var p=typeof window!=="undefined"?window:undefined;var d=p||{};var v=d.MutationObserver||d.WebKitMutationObserver;var m=typeof self==="undefined"&&typeof i!=="undefined"&&{}.toString.call(i)==="[object process]";var g=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function y(){return function(){return i.nextTick(A)}}function _(){return function(){l(A)}}function x(){var e=0;var t=new v(A);var r=document.createTextNode("");t.observe(r,{characterData:true});return function(){r.data=e=++e%2}}function b(){var e=new MessageChannel;e.port1.onmessage=A;return function(){return e.port2.postMessage(0)}}function w(){var e=setTimeout;return function(){return e(A,1)}}var k=new Array(1e3);function A(){for(var e=0;e<s;e+=2){var t=k[e];var r=k[e+1];t(r);k[e]=undefined;k[e+1]=undefined}s=0}function T(){try{var e=t;var r=e("vertx");l=r.runOnLoop||r.runOnContext;return _()}catch(e){return w()}}var M=undefined;if(m){M=y()}else if(v){M=x()}else if(g){M=b()}else if(p===undefined&&typeof t==="function"){M=T()}else{M=w()}function S(e,t){var r=arguments;var n=this;var i=new this.constructor(E);if(i[z]===undefined){te(i)}var a=n._state;if(a){(function(){var e=r[a-1];c(function(){return J(a,i,e,n._result)})})()}else{G(n,i,e,t)}return i}function C(e){var t=this;if(e&&typeof e==="object"&&e.constructor===t){return e}var r=new t(E);q(r,e);return r}var z=Math.random().toString(36).substring(16);function E(){}var L=void 0;var I=1;var P=2;var D=new W;function O(){return new TypeError("You cannot resolve a promise with itself")}function R(){return new TypeError("A promises callback cannot return that same promise.")}function F(e){try{return e.then}catch(e){D.error=e;return D}}function B(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}function N(e,t,r){c(function(e){var n=false;var i=B(r,t,function(r){if(n){return}n=true;if(t!==r){q(e,r)}else{Z(e,r)}},function(t){if(n){return}n=true;H(e,t)},"Settle: "+(e._label||" unknown promise"));if(!n&&i){n=true;H(e,i)}},e)}function j(e,t){if(t._state===I){Z(e,t._result)}else if(t._state===P){H(e,t._result)}else{G(t,undefined,function(t){return q(e,t)},function(t){return H(e,t)})}}function V(e,t,n){if(t.constructor===e.constructor&&n===S&&t.constructor.resolve===C){j(e,t)}else{if(n===D){H(e,D.error)}else if(n===undefined){Z(e,t)}else if(r(n)){N(e,t,n)}else{Z(e,t)}}}function q(t,r){if(t===r){H(t,O())}else if(e(r)){V(t,r,F(r))}else{Z(t,r)}}function U(e){if(e._onerror){e._onerror(e._result)}$(e)}function Z(e,t){if(e._state!==L){return}e._result=t;e._state=I;if(e._subscribers.length!==0){c($,e)}}function H(e,t){if(e._state!==L){return}e._state=P;e._result=t;c(U,e)}function G(e,t,r,n){var i=e._subscribers;var a=i.length;e._onerror=null;i[a]=t;i[a+I]=r;i[a+P]=n;if(a===0&&e._state){c($,e)}}function $(e){var t=e._subscribers;var r=e._state;if(t.length===0){return}var n=undefined,i=undefined,a=e._result;for(var o=0;o<t.length;o+=3){n=t[o];i=t[o+r];if(n){J(r,n,i,a)}else{i(a)}}e._subscribers.length=0}function W(){this.error=null}var X=new W;function Y(e,t){try{return e(t)}catch(e){X.error=e;return X}}function J(e,t,n,i){var a=r(n),o=undefined,s=undefined,l=undefined,u=undefined;if(a){o=Y(n,i);if(o===X){u=true;s=o.error;o=null}else{l=true}if(t===o){H(t,R());return}}else{o=i;l=true}if(t._state!==L){}else if(a&&l){q(t,o)}else if(u){H(t,s)}else if(e===I){Z(t,o)}else if(e===P){H(t,o)}}function K(e,t){try{t(function t(r){q(e,r)},function t(r){H(e,r)})}catch(t){H(e,t)}}var Q=0;function ee(){return Q++}function te(e){e[z]=Q++;e._state=undefined;e._result=undefined;e._subscribers=[]}function re(e,t){this._instanceConstructor=e;this.promise=new e(E);if(!this.promise[z]){te(this.promise)}if(o(t)){this._input=t;this.length=t.length;this._remaining=t.length;this._result=new Array(this.length);if(this.length===0){Z(this.promise,this._result)}else{this.length=this.length||0;this._enumerate();if(this._remaining===0){Z(this.promise,this._result)}}}else{H(this.promise,ne())}}function ne(){return new Error("Array Methods must be provided an Array")}re.prototype._enumerate=function(){var e=this.length;var t=this._input;for(var r=0;this._state===L&&r<e;r++){this._eachEntry(t[r],r)}};re.prototype._eachEntry=function(e,t){var r=this._instanceConstructor;var n=r.resolve;if(n===C){var i=F(e);if(i===S&&e._state!==L){this._settledAt(e._state,t,e._result)}else if(typeof i!=="function"){this._remaining--;this._result[t]=e}else if(r===ue){var a=new r(E);V(a,e,i);this._willSettleAt(a,t)}else{this._willSettleAt(new r(function(t){return t(e)}),t)}}else{this._willSettleAt(n(e),t)}};re.prototype._settledAt=function(e,t,r){var n=this.promise;if(n._state===L){this._remaining--;if(e===P){H(n,r)}else{this._result[t]=r}}if(this._remaining===0){Z(n,this._result)}};re.prototype._willSettleAt=function(e,t){var r=this;G(e,undefined,function(e){return r._settledAt(I,t,e)},function(e){return r._settledAt(P,t,e)})};function ie(e){return new re(this,e).promise}function ae(e){var t=this;if(!o(e)){return new t(function(e,t){return t(new TypeError("You must pass an array to race."))})}else{return new t(function(r,n){var i=e.length;for(var a=0;a<i;a++){t.resolve(e[a]).then(r,n)}})}}function oe(e){var t=this;var r=new t(E);H(r,e);return r}function se(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function le(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function ue(e){this[z]=ee();this._result=this._state=undefined;this._subscribers=[];if(E!==e){typeof e!=="function"&&se();this instanceof ue?K(this,e):le()}}ue.all=ie;ue.race=ae;ue.resolve=C;ue.reject=oe;ue._setScheduler=f;ue._setAsap=h;ue._asap=c;ue.prototype={constructor:ue,then:S,catch:function e(t){return this.then(null,t)}};function ce(){var e=undefined;if(typeof a!=="undefined"){e=a}else if(typeof self!=="undefined"){e=self}else{try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if(r==="[object Promise]"&&!t.cast){return}}e.Promise=ue}ce();ue.polyfill=ce;ue.Promise=ue;return ue})}).call(this,t("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:24}],8:[function(e,t,r){function n(){this._events=this._events||{};this._maxListeners=this._maxListeners||undefined}t.exports=n;n.EventEmitter=n;n.prototype._events=undefined;n.prototype._maxListeners=undefined;n.defaultMaxListeners=10;n.prototype.setMaxListeners=function(e){if(!a(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");this._maxListeners=e;return this};n.prototype.emit=function(e){var t,r,n,a,l,u;if(!this._events)this._events={};if(e==="error"){if(!this._events.error||o(this._events.error)&&!this._events.error.length){t=arguments[1];if(t instanceof Error){throw t}else{var c=new Error('Uncaught, unspecified "error" event. ('+t+")");c.context=t;throw c}}}r=this._events[e];if(s(r))return false;if(i(r)){switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1);r.apply(this,a)}}else if(o(r)){a=Array.prototype.slice.call(arguments,1);u=r.slice();n=u.length;for(l=0;l<n;l++)u[l].apply(this,a)}return true};n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");if(!this._events)this._events={};if(this._events.newListener)this.emit("newListener",e,i(t.listener)?t.listener:t);if(!this._events[e])this._events[e]=t;else if(o(this._events[e]))this._events[e].push(t);else this._events[e]=[this._events[e],t];if(o(this._events[e])&&!this._events[e].warned){if(!s(this._maxListeners)){r=this._maxListeners}else{r=n.defaultMaxListeners}if(r&&r>0&&this._events[e].length>r){this._events[e].warned=true;console.error("(node) warning: possible EventEmitter memory "+"leak detected. %d listeners added. "+"Use emitter.setMaxListeners() to increase limit.",this._events[e].length);if(typeof console.trace==="function"){console.trace()}}}return this};n.prototype.on=n.prototype.addListener;n.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var r=false;function n(){this.removeListener(e,n);if(!r){r=true;t.apply(this,arguments)}}n.listener=t;this.on(e,n);return this};n.prototype.removeListener=function(e,t){var r,n,a,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;r=this._events[e];a=r.length;n=-1;if(r===t||i(r.listener)&&r.listener===t){delete this._events[e];if(this._events.removeListener)this.emit("removeListener",e,t)}else if(o(r)){for(s=a;s-- >0;){if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}}if(n<0)return this;if(r.length===1){r.length=0;delete this._events[e]}else{r.splice(n,1)}if(this._events.removeListener)this.emit("removeListener",e,t)}return this};n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener){if(arguments.length===0)this._events={};else if(this._events[e])delete this._events[e];return this}if(arguments.length===0){for(t in this._events){if(t==="removeListener")continue;this.removeAllListeners(t)}this.removeAllListeners("removeListener");this._events={};return this}r=this._events[e];if(i(r)){this.removeListener(e,r)}else if(r){while(r.length)this.removeListener(e,r[r.length-1])}delete this._events[e];return this};n.prototype.listeners=function(e){var t;if(!this._events||!this._events[e])t=[];else if(i(this._events[e]))t=[this._events[e]];else t=this._events[e].slice();return t};n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;else if(t)return t.length}return 0};n.listenerCount=function(e,t){return e.listenerCount(t)};function i(e){return typeof e==="function"}function a(e){return typeof e==="number"}function o(e){return typeof e==="object"&&e!==null}function s(e){return e===void 0}},{}],9:[function(e,t,r){"use strict";function n(e){var t=e.length,r;for(var n=0;n<t;n++){r=e.charCodeAt(n);if((r<9||r>13)&&r!==32&&r!==133&&r!==160&&r!==5760&&r!==6158&&(r<8192||r>8205)&&r!==8232&&r!==8233&&r!==8239&&r!==8287&&r!==8288&&r!==12288&&r!==65279){return false}}return true}t.exports=function(e){var t=typeof e;if(t==="string"){var r=e;e=+e;if(e===0&&n(r))return false}else if(t!=="number")return false;return e-e<1}},{}],10:[function(e,t,r){t.exports=n;function n(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,l=i+i,u=r*o,c=n*o,f=n*s,h=i*o,p=i*s,d=i*l,v=a*o,m=a*s,g=a*l;e[0]=1-f-d;e[1]=c+g;e[2]=h-m;e[3]=0;e[4]=c-g;e[5]=1-u-d;e[6]=p+v;e[7]=0;e[8]=h+m;e[9]=p-v;e[10]=1-u-f;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return e}},{}],11:[function(e,t,r){(function(r){"use strict";var n=e("is-browser");var i;if(typeof r.matchMedia==="function"){i=!r.matchMedia("(hover: none)").matches}else{i=n}t.exports=i}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"is-browser":13}],12:[function(e,t,r){"use strict";var n=e("is-browser");function i(){var e=false;try{var t=Object.defineProperty({},"passive",{get:function(){e=true}});window.addEventListener("test",null,t);window.removeEventListener("test",null,t)}catch(t){e=false}return e}t.exports=n&&i()},{"is-browser":13}],13:[function(e,t,r){t.exports=true},{}],14:[function(t,r,n){(function(t){(function(t,i){typeof n==="object"&&typeof r!=="undefined"?r.exports=i():typeof e==="function"&&e.amd?e(i):t.mapboxgl=i()})(this,function(){"use strict";var e,r,n;function i(t,i){if(!e){e=i}else if(!r){r=i}else{var a="var sharedChunk = {}; ("+e+")(sharedChunk); ("+r+")(sharedChunk);";var o={};e(o);n=i(o);n.workerUrl=window.URL.createObjectURL(new Blob([a],{type:"text/javascript"}))}}i(["exports"],function(e){"use strict";var r="undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{};function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function i(e,t){return e(t={exports:{}},t.exports),t.exports}var a=o;function o(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=n,this.p2x=r,this.p2y=n}o.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},o.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},o.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},o.prototype.solveCurveX=function(e,t){var r,n,i,a,o;for(void 0===t&&(t=1e-6),i=e,o=0;o<8;o++){if(a=this.sampleCurveX(i)-e,Math.abs(a)<t)return i;var s=this.sampleCurveDerivativeX(i);if(Math.abs(s)<1e-6)break;i-=a/s}if((i=e)<(r=0))return r;if(i>(n=1))return n;for(;r<n;){if(a=this.sampleCurveX(i),Math.abs(a-e)<t)return i;e>a?r=i:n=i,i=.5*(n-r)+r}return i},o.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var s=function(e,t,r){this.column=e,this.row=t,this.zoom=r};s.prototype.clone=function(){return new s(this.column,this.row,this.zoom)},s.prototype.zoomTo=function(e){return this.clone()._zoomTo(e)},s.prototype.sub=function(e){return this.clone()._sub(e)},s.prototype._zoomTo=function(e){var t=Math.pow(2,e-this.zoom);return this.column*=t,this.row*=t,this.zoom=e,this},s.prototype._sub=function(e){return e=e.zoomTo(this.zoom),this.column-=e.column,this.row-=e.row,this};var l=u;function u(e,t){this.x=e,this.y=t}function c(e,t,r,n){var i=new a(e,t,r,n);return function(e){return i.solve(e)}}u.prototype={clone:function(){return new u(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),a=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},u.convert=function(e){return e instanceof u?e:Array.isArray(e)?new u(e[0],e[1]):e};var f=c(.25,.1,.25,1);function h(e,t,r){return Math.min(r,Math.max(t,e))}function p(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var n=0,i=t;n<i.length;n+=1){var a=i[n];for(var o in a)e[o]=a[o]}return e}var d=1;function v(e,t){e.forEach(function(e){t[e]&&(t[e]=t[e].bind(t))})}function m(e,t){return-1!==e.indexOf(t,e.length-t.length)}function g(e,t,r){var n={};for(var i in e)n[i]=t.call(r||this,e[i],i,e);return n}function y(e,t,r){var n={};for(var i in e)t.call(r||this,e[i],i,e)&&(n[i]=e[i]);return n}function _(e){return Array.isArray(e)?e.map(_):"object"==typeof e&&e?g(e,_):e}var x={};function b(e){x[e]||("undefined"!=typeof console&&console.warn(e),x[e]=!0)}function w(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function k(e){for(var t=0,r=0,n=e.length,i=n-1,a=void 0,o=void 0;r<n;i=r++)a=e[r],t+=((o=e[i]).x-a.x)*(a.y+o.y);return t}var A={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(A);var T=function(e){function t(t,r,n){e.call(this,t),this.status=r,this.url=n,this.name=this.constructor.name,this.message=t}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error);function M(e){var t=new self.XMLHttpRequest;for(var r in t.open("GET",e.url,!0),e.headers)t.setRequestHeader(r,e.headers[r]);return t.withCredentials="include"===e.credentials,t}var S=function(e,t){var r=M(e);return r.responseType="arraybuffer",r.onerror=function(){t(new Error(r.statusText))},r.onload=function(){var n=r.response;if(0===n.byteLength&&200===r.status)return t(new Error("http status 200 returned without content."));r.status>=200&&r.status<300&&r.response?t(null,{data:n,cacheControl:r.getResponseHeader("Cache-Control"),expires:r.getResponseHeader("Expires")}):t(new T(r.statusText,r.status,e.url))},r.send(),r};function C(e,t,r){r[e]=r[e]||[],r[e].push(t)}function z(e,t,r){if(r&&r[e]){var n=r[e].indexOf(t);-1!==n&&r[e].splice(n,1)}}var E=function(e,t){void 0===t&&(t={}),p(this,t),this.type=e},L=function(e){function t(t,r){void 0===r&&(r={}),e.call(this,"error",p({error:t},r))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(E),I=function(){};I.prototype.on=function(e,t){return this._listeners=this._listeners||{},C(e,t,this._listeners),this},I.prototype.off=function(e,t){return z(e,t,this._listeners),z(e,t,this._oneTimeListeners),this},I.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},C(e,t,this._oneTimeListeners),this},I.prototype.fire=function(e){"string"==typeof e&&(e=new E(e,arguments[1]||{}));var t=e.type;if(this.listens(t)){e.target=this;for(var r=0,n=this._listeners&&this._listeners[t]?this._listeners[t].slice():[];r<n.length;r+=1){n[r].call(this,e)}for(var i=0,a=this._oneTimeListeners&&this._oneTimeListeners[t]?this._oneTimeListeners[t].slice():[];i<a.length;i+=1){var o=a[i];z(t,o,this._oneTimeListeners),o.call(this,e)}var s=this._eventedParent;s&&(p(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),s.fire(e))}else m(t,"error")?console.error(e&&e.error||e||"Empty error event"):m(t,"warning")&&console.warn(e&&e.warning||e||"Empty warning event");return this},I.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},I.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var P={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.0511,180,85.0511]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},lineMetrics:{type:"boolean",default:!1}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_fill:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_circle:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_line:{"line-cap":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{butt:{},round:{},square:{}},default:"butt"},"line-join":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{bevel:{},round:{},miter:{}},default:"miter"},"line-miter-limit":{type:"number",default:2,function:"interpolated","zoom-function":!0,requires:[{"line-join":"miter"}]},"line-round-limit":{type:"number",default:1.05,function:"interpolated","zoom-function":!0,requires:[{"line-join":"round"}]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_symbol:{"symbol-placement":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{point:{},line:{}},default:"point"},"symbol-spacing":{type:"number",default:250,minimum:1,function:"interpolated","zoom-function":!0,units:"pixels",requires:[{"symbol-placement":"line"}]},"symbol-avoid-edges":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1},"icon-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image"]},"icon-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image","text-field"]},"icon-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"icon-size":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,units:"factor of the original icon size",requires:["icon-image"]},"icon-text-fit":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"]},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",function:"interpolated","zoom-function":!0,requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}]},"icon-image":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,tokens:!0},"icon-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,"property-function":!0,units:"degrees",requires:["icon-image"]},"icon-padding":{type:"number",default:2,minimum:0,function:"interpolated","zoom-function":!0,units:"pixels",requires:["icon-image"]},"icon-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":"line"}]},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,"property-function":!0,requires:["icon-image"]},"icon-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"]},"icon-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"]},"text-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-rotation-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"]},"text-field":{type:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:"",tokens:!0},"text-font":{type:"array",value:"string",function:"piecewise-constant","zoom-function":!0,"property-function":!0,default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"]},"text-size":{type:"number",default:16,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-line-height":{type:"number",default:1.2,units:"ems",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-letter-spacing":{type:"number",default:0,units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-justify":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{left:{},center:{},right:{}},default:"center",requires:["text-field"]},"text-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field"]},"text-max-angle":{type:"number",default:45,units:"degrees",function:"interpolated","zoom-function":!0,requires:["text-field",{"symbol-placement":"line"}]},"text-rotate":{type:"number",default:0,period:360,units:"degrees",function:"interpolated","zoom-function":!0,"property-function":!0,requires:["text-field"]},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",function:"interpolated","zoom-function":!0,requires:["text-field"]},"text-keep-upright":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":"line"}]},"text-transform":{type:"enum",function:"piecewise-constant","zoom-function":!0,"property-function":!0,values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"]},"text-offset":{type:"array",value:"number",units:"ems",function:"interpolated","zoom-function":!0,"property-function":!0,length:2,default:[0,0],requires:["text-field"]},"text-allow-overlap":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-ignore-placement":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field"]},"text-optional":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!1,requires:["text-field","icon-image"]},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function_stop:{type:"array",minimum:0,maximum:22,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Heatmap"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},transition:!1,"zoom-function":!0,"property-function":!1,function:"piecewise-constant"},position:{type:"array",default:[1.15,210,30],length:3,value:"number",transition:!0,function:"interpolated","zoom-function":!0,"property-function":!1},color:{type:"color",default:"#ffffff",function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},intensity:{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",function:"piecewise-constant","zoom-function":!0,default:!0},"fill-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"fill-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"}]},"fill-outline-color":{type:"color",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-translate"]},"fill-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0}},paint_line:{"line-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:1,minimum:0,maximum:1,transition:!0},"line-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"line-pattern"}]},"line-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"line-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["line-translate"]},"line-width":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-gap-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-offset":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"line-dasharray":{type:"array",value:"number",function:"piecewise-constant","zoom-function":!0,minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}]},"line-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"line-gradient":{type:"color",function:"interpolated","zoom-function":!1,"property-function":!1,transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}]}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-blur":{type:"number",default:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"circle-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["circle-translate"]},"circle-pitch-scale":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map"},"circle-pitch-alignment":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"circle-stroke-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"circle-stroke-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels"},"heatmap-weight":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!1},"heatmap-intensity":{type:"number",default:1,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],function:"interpolated","zoom-function":!1,"property-function":!1,transition:!1},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!1,transition:!0}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["icon-image"]},"icon-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["icon-image"]},"icon-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"]},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:["text-field"]},"text-halo-width":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-halo-blur":{type:"number",default:0,minimum:0,function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels",requires:["text-field"]},"text-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"]}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-hue-rotate":{type:"number",default:0,period:360,function:"interpolated","zoom-function":!0,transition:!0,units:"degrees"},"raster-brightness-min":{type:"number",function:"interpolated","zoom-function":!0,default:0,minimum:0,maximum:1,transition:!0},"raster-brightness-max":{type:"number",function:"interpolated","zoom-function":!0,default:1,minimum:0,maximum:1,transition:!0},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"raster-fade-duration":{type:"number",default:300,minimum:0,function:"interpolated","zoom-function":!0,transition:!1,units:"milliseconds"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,function:"interpolated","zoom-function":!0,transition:!1},"hillshade-illumination-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"viewport"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0},"hillshade-shadow-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",function:"interpolated","zoom-function":!0,transition:!0},"hillshade-accent-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0}},paint_background:{"background-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,transition:!0,requires:[{"!":"background-pattern"}]},"background-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,function:"interpolated","zoom-function":!0,transition:!0}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible"}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!1,default:1,minimum:0,maximum:1,transition:!0},"fill-extrusion-color":{type:"color",default:"#000000",function:"interpolated","zoom-function":!0,"property-function":!0,transition:!0,requires:[{"!":"fill-extrusion-pattern"}]},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],function:"interpolated","zoom-function":!0,transition:!0,units:"pixels"},"fill-extrusion-translate-anchor":{type:"enum",function:"piecewise-constant","zoom-function":!0,values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"]},"fill-extrusion-pattern":{type:"string",function:"piecewise-constant","zoom-function":!0,transition:!0},"fill-extrusion-height":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,units:"meters",transition:!0},"fill-extrusion-base":{type:"number",function:"interpolated","zoom-function":!0,"property-function":!0,default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"]}}},D=function(e,t,r,n){this.message=(e?e+": ":"")+r,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)};function O(e){var t=e.key,r=e.value;return r?[new D(t,r,"constants have been deprecated as of v8")]:[]}function R(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var n=0,i=t;n<i.length;n+=1){var a=i[n];for(var o in a)e[o]=a[o]}return e}function F(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function B(e){return Array.isArray(e)?e.map(B):F(e)}var N=function(e){function t(t,r){e.call(this,r),this.message=r,this.key=t}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),j=function(e,t){void 0===t&&(t=[]),this.parent=e,this.bindings={};for(var r=0,n=t;r<n.length;r+=1){var i=n[r],a=i[0],o=i[1];this.bindings[a]=o}};j.prototype.concat=function(e){return new j(this,e)},j.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},j.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var V={kind:"null"},q={kind:"number"},U={kind:"string"},Z={kind:"boolean"},H={kind:"color"},G={kind:"object"},$={kind:"value"},W={kind:"collator"};function X(e,t){return{kind:"array",itemType:e,N:t}}function Y(e){if("array"===e.kind){var t=Y(e.itemType);return"number"==typeof e.N?"array<"+t+", "+e.N+">":"value"===e.itemType.kind?"array":"array<"+t+">"}return e.kind}var J=[V,q,U,Z,H,G,X($)];function K(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&!K(e.itemType,t.itemType)&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(var r=0,n=J;r<n.length;r+=1){if(!K(n[r],t))return null}}return"Expected "+Y(e)+" but found "+Y(t)+" instead."}var Q=i(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(e){return(e=Math.round(e))<0?0:e>255?255:e}function i(e){return e<0?0:e>1?1:e}function a(e){return"%"===e[e.length-1]?n(parseFloat(e)/100*255):n(parseInt(e))}function o(e){return"%"===e[e.length-1]?i(parseFloat(e)/100):i(parseFloat(e))}function s(e,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}try{t.parseCSSColor=function(e){var t,i=e.replace(/ /g,"").toLowerCase();if(i in r)return r[i].slice();if("#"===i[0])return 4===i.length?(t=parseInt(i.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===i.length&&(t=parseInt(i.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var l=i.indexOf("("),u=i.indexOf(")");if(-1!==l&&u+1===i.length){var c=i.substr(0,l),f=i.substr(l+1,u-(l+1)).split(","),h=1;switch(c){case"rgba":if(4!==f.length)return null;h=o(f.pop());case"rgb":return 3!==f.length?null:[a(f[0]),a(f[1]),a(f[2]),h];case"hsla":if(4!==f.length)return null;h=o(f.pop());case"hsl":if(3!==f.length)return null;var p=(parseFloat(f[0])%360+360)%360/360,d=o(f[1]),v=o(f[2]),m=v<=.5?v*(d+1):v+d-v*d,g=2*v-m;return[n(255*s(g,m,p+1/3)),n(255*s(g,m,p)),n(255*s(g,m,p-1/3)),h];default:return null}}return null}}catch(e){}}).parseCSSColor,ee=function(e,t,r,n){void 0===n&&(n=1),this.r=e,this.g=t,this.b=r,this.a=n};ee.parse=function(e){if(e){if(e instanceof ee)return e;if("string"==typeof e){var t=Q(e);if(t)return new ee(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},ee.prototype.toString=function(){var e=this.toArray(),t=e[0],r=e[1],n=e[2],i=e[3];return"rgba("+Math.round(t)+","+Math.round(r)+","+Math.round(n)+","+i+")"},ee.prototype.toArray=function(){var e=this.r,t=this.g,r=this.b,n=this.a;return 0===n?[0,0,0,0]:[255*e/n,255*t/n,255*r/n,n]},ee.black=new ee(0,0,0,1),ee.white=new ee(1,1,1,1),ee.transparent=new ee(0,0,0,0);var te=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};te.prototype.compare=function(e,t){return this.collator.compare(e,t)},te.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var re=function(e,t,r){this.type=W,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t};function ne(e,t,r,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:"Invalid rgba value ["+[e,t,r,n].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ie(e){if(null===e)return V;if("string"==typeof e)return U;if("boolean"==typeof e)return Z;if("number"==typeof e)return q;if(e instanceof ee)return H;if(e instanceof te)return W;if(Array.isArray(e)){for(var t,r=e.length,n=0,i=e;n<i.length;n+=1){var a=ie(i[n]);if(t){if(t===a)continue;t=$;break}t=a}return X(t||$,r)}return G}re.parse=function(e,t){if(2!==e.length)return t.error("Expected one argument.");var r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");var n=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,Z);if(!n)return null;var i=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,Z);if(!i)return null;var a=null;return r.locale&&!(a=t.parse(r.locale,1,U))?null:new re(n,i,a)},re.prototype.evaluate=function(e){return new te(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},re.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},re.prototype.possibleOutputs=function(){return[void 0]},re.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var ae=function(e,t){this.type=e,this.value=t};ae.parse=function(e,t){if(2!==e.length)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!function e(t){if(null===t)return!0;if("string"==typeof t)return!0;if("boolean"==typeof t)return!0;if("number"==typeof t)return!0;if(t instanceof ee)return!0;if(t instanceof te)return!0;if(Array.isArray(t)){for(var r=0,n=t;r<n.length;r+=1)if(!e(n[r]))return!1;return!0}if("object"==typeof t){for(var i in t)if(!e(t[i]))return!1;return!0}return!1}(e[1]))return t.error("invalid value");var r=e[1],n=ie(r),i=t.expectedType;return"array"!==n.kind||0!==n.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(n=i),new ae(n,r)},ae.prototype.evaluate=function(){return this.value},ae.prototype.eachChild=function(){},ae.prototype.possibleOutputs=function(){return[this.value]},ae.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ee?["rgba"].concat(this.value.toArray()):this.value};var oe=function(e){this.name="ExpressionEvaluationError",this.message=e};oe.prototype.toJSON=function(){return this.message};var se={string:U,number:q,boolean:Z,object:G},le=function(e,t){this.type=e,this.args=t};le.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");for(var r=e[0],n=se[r],i=[],a=1;a<e.length;a++){var o=t.parse(e[a],a,$);if(!o)return null;i.push(o)}return new le(n,i)},le.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!K(this.type,ie(r)))return r;if(t===this.args.length-1)throw new oe("Expected value to be of type "+Y(this.type)+", but found "+Y(ie(r))+" instead.")}return null},le.prototype.eachChild=function(e){this.args.forEach(e)},le.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.args.map(function(e){return e.possibleOutputs()}));var e},le.prototype.serialize=function(){return[this.type.kind].concat(this.args.map(function(e){return e.serialize()}))};var ue={string:U,number:q,boolean:Z},ce=function(e,t){this.type=e,this.input=t};ce.parse=function(e,t){if(e.length<2||e.length>4)return t.error("Expected 1, 2, or 3 arguments, but found "+(e.length-1)+" instead.");var r,n;if(e.length>2){var i=e[1];if("string"!=typeof i||!(i in ue))return t.error('The item type argument of "array" must be one of string, number, boolean',1);r=ue[i]}else r=$;if(e.length>3){if("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2]))return t.error('The length argument to "array" must be a positive integer literal',2);n=e[2]}var a=X(r,n),o=t.parse(e[e.length-1],e.length-1,$);return o?new ce(a,o):null},ce.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(K(this.type,ie(t)))throw new oe("Expected value to be of type "+Y(this.type)+", but found "+Y(ie(t))+" instead.");return t},ce.prototype.eachChild=function(e){e(this.input)},ce.prototype.possibleOutputs=function(){return this.input.possibleOutputs()},ce.prototype.serialize=function(){var e=["array"],t=this.type.itemType;if("string"===t.kind||"number"===t.kind||"boolean"===t.kind){e.push(t.kind);var r=this.type.N;"number"==typeof r&&e.push(r)}return e.push(this.input.serialize()),e};var fe={"to-number":q,"to-color":H},he=function(e,t){this.type=e,this.args=t};he.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");for(var r=e[0],n=fe[r],i=[],a=1;a<e.length;a++){var o=t.parse(e[a],a,$);if(!o)return null;i.push(o)}return new he(n,i)},he.prototype.evaluate=function(e){if("color"===this.type.kind){for(var t,r,n=0,i=this.args;n<i.length;n+=1){if(r=null,"string"==typeof(t=i[n].evaluate(e))){var a=e.parseColor(t);if(a)return a}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":ne(t[0],t[1],t[2],t[3])))return new ee(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new oe(r||"Could not parse color from value '"+("string"==typeof t?t:JSON.stringify(t))+"'")}for(var o=null,s=0,l=this.args;s<l.length;s+=1){if(null!==(o=l[s].evaluate(e))){var u=Number(o);if(!isNaN(u))return u}}throw new oe("Could not convert "+JSON.stringify(o)+" to number.")},he.prototype.eachChild=function(e){this.args.forEach(e)},he.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.args.map(function(e){return e.possibleOutputs()}));var e},he.prototype.serialize=function(){var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var pe=["Unknown","Point","LineString","Polygon"],de=function(){this._parseColorCache={}};de.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},de.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?pe[this.feature.type]:this.feature.type:null},de.prototype.properties=function(){return this.feature&&this.feature.properties||{}},de.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=ee.parse(e)),t};var ve=function(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n};function me(e){if(e instanceof ve){if("get"===e.name&&1===e.args.length)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}var t=!0;return e.eachChild(function(e){t&&!me(e)&&(t=!1)}),t}function ge(e,t){if(e instanceof ve&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(e){r&&!ge(e,t)&&(r=!1)}),r}ve.prototype.evaluate=function(e){return this._evaluate(e,this.args)},ve.prototype.eachChild=function(e){this.args.forEach(e)},ve.prototype.possibleOutputs=function(){return[void 0]},ve.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},ve.parse=function(e,t){var r=e[0],n=ve.definitions[r];if(!n)return t.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0);for(var i=Array.isArray(n)?n[0]:n.type,a=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,o=a.filter(function(t){var r=t[0];return!Array.isArray(r)||r.length===e.length-1}),s=[],l=1;l<e.length;l++){var u=e[l],c=void 0;if(1===o.length){var f=o[0][0];c=Array.isArray(f)?f[l-1]:f.type}var h=t.parse(u,1+s.length,c);if(!h)return null;s.push(h)}for(var p=null,d=0,v=o;d<v.length;d+=1){var m=v[d],g=m[0],y=m[1];if(p=new _e(t.registry,t.path,null,t.scope),Array.isArray(g)&&g.length!==s.length)p.error("Expected "+g.length+" arguments, but found "+s.length+" instead.");else{for(var _=0;_<s.length;_++){var x=Array.isArray(g)?g[_]:g.type,b=s[_];p.concat(_+1).checkSubtype(x,b.type)}if(0===p.errors.length)return new ve(r,i,y,s)}}if(1===o.length)t.errors.push.apply(t.errors,p.errors);else{var w=(o.length?o:a).map(function(e){var t,r=e[0];return t=r,Array.isArray(t)?"("+t.map(Y).join(", ")+")":"("+Y(t.type)+"...)"}).join(" | "),k=s.map(function(e){return Y(e.type)}).join(", ");t.error("Expected arguments of type "+w+", but found ("+k+") instead.")}return null},ve.register=function(e,t){for(var r in ve.definitions=t,t)e[r]=ve};var ye=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};ye.parse=function(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new ye(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},ye.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},ye.prototype.eachChild=function(){},ye.prototype.possibleOutputs=function(){return[void 0]},ye.prototype.serialize=function(){return["var",this.name]};var _e=function(e,t,r,n,i){void 0===t&&(t=[]),void 0===n&&(n=new j),void 0===i&&(i=[]),this.registry=e,this.path=t,this.key=t.map(function(e){return"["+e+"]"}).join(""),this.scope=n,this.errors=i,this.expectedType=r};function xe(e,t){for(var r,n,i=0,a=e.length-1,o=0;i<=a;){if(r=e[o=Math.floor((i+a)/2)],n=e[o+1],t===r||t>r&&t<n)return o;if(r<t)i=o+1;else{if(!(r>t))throw new oe("Input is not a number.");a=o-1}}return Math.max(o-1,0)}_e.prototype.parse=function(e,t,r,n,i){return void 0===i&&(i={}),t?this.concat(t,r,n)._parse(e,i):this._parse(e,i)},_e.prototype._parse=function(e,t){if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var r=e[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found "+typeof r+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var n=this.registry[r];if(n){var i=n.parse(e,this);if(!i)return null;if(this.expectedType){var a=this.expectedType,o=i.type;if("string"!==a.kind&&"number"!==a.kind&&"boolean"!==a.kind&&"object"!==a.kind||"value"!==o.kind)if("array"===a.kind&&"value"===o.kind)t.omitTypeAnnotations||(i=new ce(a,i));else if("color"!==a.kind||"value"!==o.kind&&"string"!==o.kind){if(this.checkSubtype(this.expectedType,i.type))return null}else t.omitTypeAnnotations||(i=new he(a,[i]));else t.omitTypeAnnotations||(i=new le(a,[i]))}if(!(i instanceof ae)&&function e(t){if(t instanceof ye)return e(t.boundExpression);if(t instanceof ve&&"error"===t.name)return!1;if(t instanceof re)return!1;var r=t instanceof he||t instanceof le||t instanceof ce;var n=!0;t.eachChild(function(t){n=r?n&&e(t):n&&t instanceof ae});if(!n)return!1;return me(t)&&ge(t,["zoom","heatmap-density","line-progress","is-supported-script"])}(i)){var s=new de;try{i=new ae(i.type,i.evaluate(s))}catch(e){return this.error(e.message),null}}return i}return this.error('Unknown expression "'+r+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===e?this.error("'undefined' value invalid. Use null instead."):"object"==typeof e?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof e+" instead.")},_e.prototype.concat=function(e,t,r){var n="number"==typeof e?this.path.concat(e):this.path,i=r?this.scope.concat(r):this.scope;return new _e(this.registry,n,t||null,i,this.errors)},_e.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var n=""+this.key+t.map(function(e){return"["+e+"]"}).join("");this.errors.push(new N(n,e))},_e.prototype.checkSubtype=function(e,t){var r=K(e,t);return r&&this.error(r),r};var be=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var n=0,i=r;n<i.length;n+=1){var a=i[n],o=a[0],s=a[1];this.labels.push(o),this.outputs.push(s)}};function we(e,t,r){return e*(1-r)+t*r}be.parse=function(e,t){var r=e[1],n=e.slice(2);if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(r=t.parse(r,1,q)))return null;var i=[],a=null;t.expectedType&&"value"!==t.expectedType.kind&&(a=t.expectedType),n.unshift(-1/0);for(var o=0;o<n.length;o+=2){var s=n[o],l=n[o+1],u=o+1,c=o+2;if("number"!=typeof s)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(i.length&&i[i.length-1][0]>=s)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var f=t.parse(l,c,a);if(!f)return null;a=a||f.type,i.push([s,f])}return new be(a,r,i)},be.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);var i=t.length;return n>=t[i-1]?r[i-1].evaluate(e):r[xe(t,n)].evaluate(e)},be.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1){e(r[t])}},be.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.outputs.map(function(e){return e.possibleOutputs()}));var e},be.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var ke=Object.freeze({number:we,color:function(e,t,r){return new ee(we(e.r,t.r,r),we(e.g,t.g,r),we(e.b,t.b,r),we(e.a,t.a,r))},array:function(e,t,r){return e.map(function(e,n){return we(e,t[n],r)})}}),Ae=function(e,t,r,n){this.type=e,this.interpolation=t,this.input=r,this.labels=[],this.outputs=[];for(var i=0,a=n;i<a.length;i+=1){var o=a[i],s=o[0],l=o[1];this.labels.push(s),this.outputs.push(l)}};function Te(e,t,r,n){var i=n-r,a=e-r;return 0===i?0:1===t?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}Ae.interpolationFactor=function(e,t,r,n){var i=0;if("exponential"===e.name)i=Te(t,e.base,r,n);else if("linear"===e.name)i=Te(t,1,r,n);else if("cubic-bezier"===e.name){var o=e.controlPoints;i=new a(o[0],o[1],o[2],o[3]).solve(Te(t,1,r,n))}return i},Ae.parse=function(e,t){var r=e[1],n=e[2],i=e.slice(3);if(!Array.isArray(r)||0===r.length)return t.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){var a=r[1];if("number"!=typeof a)return t.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:a}}else{if("cubic-bezier"!==r[0])return t.error("Unknown interpolation type "+String(r[0]),1,0);var o=r.slice(1);if(4!==o.length||o.some(function(e){return"number"!=typeof e||e<0||e>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:o}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(n=t.parse(n,2,q)))return null;var s=[],l=null;t.expectedType&&"value"!==t.expectedType.kind&&(l=t.expectedType);for(var u=0;u<i.length;u+=2){var c=i[u],f=i[u+1],h=u+3,p=u+4;if("number"!=typeof c)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',h);if(s.length&&s[s.length-1][0]>=c)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',h);var d=t.parse(f,p,l);if(!d)return null;l=l||d.type,s.push([c,d])}return"number"===l.kind||"color"===l.kind||"array"===l.kind&&"number"===l.itemType.kind&&"number"==typeof l.N?new Ae(l,r,n,s):t.error("Type "+Y(l)+" is not interpolatable.")},Ae.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);var i=t.length;if(n>=t[i-1])return r[i-1].evaluate(e);var a=xe(t,n),o=t[a],s=t[a+1],l=Ae.interpolationFactor(this.interpolation,n,o,s),u=r[a].evaluate(e),c=r[a+1].evaluate(e);return ke[this.type.kind.toLowerCase()](u,c,l)},Ae.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1){e(r[t])}},Ae.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.outputs.map(function(e){return e.possibleOutputs()}));var e},Ae.prototype.serialize=function(){for(var e=["interpolate","linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints),this.input.serialize()],t=0;t<this.labels.length;t++)e.push(this.labels[t],this.outputs[t].serialize());return e};var Me=function(e,t){this.type=e,this.args=t};Me.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,n=t.expectedType;n&&"value"!==n.kind&&(r=n);for(var i=[],a=0,o=e.slice(1);a<o.length;a+=1){var s=o[a],l=t.parse(s,1+i.length,r,void 0,{omitTypeAnnotations:!0});if(!l)return null;r=r||l.type,i.push(l)}var u=n&&i.some(function(e){return K(n,e.type)});return new Me(u?$:r,i)},Me.prototype.evaluate=function(e){for(var t=null,r=0,n=this.args;r<n.length;r+=1){if(null!==(t=n[r].evaluate(e)))break}return t},Me.prototype.eachChild=function(e){this.args.forEach(e)},Me.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.args.map(function(e){return e.possibleOutputs()}));var e},Me.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Se=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};Se.prototype.evaluate=function(e){return this.result.evaluate(e)},Se.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1){e(r[t][1])}e(this.result)},Se.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],n=1;n<e.length-1;n+=2){var i=e[n];if("string"!=typeof i)return t.error("Expected string, but found "+typeof i+" instead.",n);if(/[^a-zA-Z0-9_]/.test(i))return t.error("Variable names must contain only alphanumeric characters or '_'.",n);var a=t.parse(e[n+1],n+1);if(!a)return null;r.push([i,a])}var o=t.parse(e[e.length-1],e.length-1,void 0,r);return o?new Se(r,o):null},Se.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},Se.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var n=r[t],i=n[0],a=n[1];e.push(i,a.serialize())}return e.push(this.result.serialize()),e};var Ce=function(e,t,r){this.type=e,this.index=t,this.input=r};Ce.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,q),n=t.parse(e[2],2,X(t.expectedType||$));if(!r||!n)return null;var i=n.type;return new Ce(i.itemType,r,n)},Ce.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new oe("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new oe("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new oe("Array index must be an integer, but found "+t+" instead.");return r[t]},Ce.prototype.eachChild=function(e){e(this.index),e(this.input)},Ce.prototype.possibleOutputs=function(){return[void 0]},Ce.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var ze=function(e,t,r,n,i,a){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=i,this.otherwise=a};ze.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);for(var i={},a=[],o=2;o<e.length-1;o+=2){var s=e[o],l=e[o+1];Array.isArray(s)||(s=[s]);var u=t.concat(o);if(0===s.length)return u.error("Expected at least one branch label.");for(var c=0,f=s;c<f.length;c+=1){var h=f[c];if("number"!=typeof h&&"string"!=typeof h)return u.error("Branch labels must be numbers or strings.");if("number"==typeof h&&Math.abs(h)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof h&&Math.floor(h)!==h)return u.error("Numeric branch labels must be integer values.");if(r){if(u.checkSubtype(r,ie(h)))return null}else r=ie(h);if(void 0!==i[String(h)])return u.error("Branch labels must be unique.");i[String(h)]=a.length}var p=t.parse(l,o,n);if(!p)return null;n=n||p.type,a.push(p)}var d=t.parse(e[1],1,r);if(!d)return null;var v=t.parse(e[e.length-1],e.length-1,n);return v?new ze(r,n,d,i,a,v):null},ze.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},ze.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},ze.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.outputs.map(function(e){return e.possibleOutputs()})).concat(this.otherwise.possibleOutputs());var e},ze.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],n={},i=0,a=Object.keys(this.cases).sort();i<a.length;i+=1){var o=a[i],s=n[e.cases[o]];void 0===s?(n[e.cases[o]]=r.length,r.push([e.cases[o],[o]])):r[s][1].push(o)}for(var l=function(t){return"number"===e.input.type.kind?Number(t):t},u=0,c=r;u<c.length;u+=1){var f=c[u],h=f[0],p=f[1];1===p.length?t.push(l(p[0])):t.push(p.map(l)),t.push(e.outputs[h].serialize())}return t.push(this.otherwise.serialize()),t};var Ee=function(e,t,r){this.type=e,this.branches=t,this.otherwise=r};function Le(e){return"string"===e.kind||"number"===e.kind||"boolean"===e.kind||"null"===e.kind}function Ie(e,t){return function(){function r(e,t,r){this.type=Z,this.lhs=e,this.rhs=t,this.collator=r}return r.parse=function(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");var n=t.parse(e[1],1,$);if(!n)return null;var i=t.parse(e[2],2,$);if(!i)return null;if(!Le(n.type)&&!Le(i.type))return t.error("Expected at least one argument to be a string, number, boolean, or null, but found ("+Y(n.type)+", "+Y(i.type)+") instead.");if(n.type.kind!==i.type.kind&&"value"!==n.type.kind&&"value"!==i.type.kind)return t.error("Cannot compare "+Y(n.type)+" and "+Y(i.type)+".");var a=null;if(4===e.length){if("string"!==n.type.kind&&"string"!==i.type.kind)return t.error("Cannot use collator to compare non-string types.");if(!(a=t.parse(e[3],3,W)))return null}return new r(n,i,a)},r.prototype.evaluate=function(e){var r=this.collator?0===this.collator.evaluate(e).compare(this.lhs.evaluate(e),this.rhs.evaluate(e)):this.lhs.evaluate(e)===this.rhs.evaluate(e);return t?!r:r},r.prototype.eachChild=function(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)},r.prototype.possibleOutputs=function(){return[!0,!1]},r.prototype.serialize=function(){var t=[e];return this.eachChild(function(e){t.push(e.serialize())}),t},r}()}Ee.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(var n=[],i=1;i<e.length-1;i+=2){var a=t.parse(e[i],i,Z);if(!a)return null;var o=t.parse(e[i+1],i+1,r);if(!o)return null;n.push([a,o]),r=r||o.type}var s=t.parse(e[e.length-1],e.length-1,r);return s?new Ee(r,n,s):null},Ee.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var n=r[t],i=n[0],a=n[1];if(i.evaluate(e))return a.evaluate(e)}return this.otherwise.evaluate(e)},Ee.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var n=r[t],i=n[0],a=n[1];e(i),e(a)}e(this.otherwise)},Ee.prototype.possibleOutputs=function(){return(e=[]).concat.apply(e,this.branches.map(function(e){e[0];return e[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs());var e},Ee.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Pe=Ie("==",!1),De=Ie("!=",!0),Oe=function(e){this.type=q,this.input=e};Oe.parse=function(e,t){if(2!==e.length)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error("Expected argument of type string or array, but found "+Y(r.type)+" instead."):new Oe(r):null},Oe.prototype.evaluate=function(e){var t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new oe("Expected value to be of type string or array, but found "+Y(ie(t))+" instead.")},Oe.prototype.eachChild=function(e){e(this.input)},Oe.prototype.possibleOutputs=function(){return[void 0]},Oe.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Re={"==":Pe,"!=":De,array:ce,at:Ce,boolean:le,case:Ee,coalesce:Me,collator:re,interpolate:Ae,length:Oe,let:Se,literal:ae,match:ze,number:le,object:le,step:be,string:le,"to-color":he,"to-number":he,var:ye};function Fe(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];r=r.evaluate(e),n=n.evaluate(e),i=i.evaluate(e);var o=a?a.evaluate(e):1,s=ne(r,n,i,o);if(s)throw new oe(s);return new ee(r/255*o,n/255*o,i/255*o,o)}function Be(e,t){return e in t}function Ne(e,t){var r=t[e];return void 0===r?null:r}function je(e,t){var r=t[0],n=t[1];return r.evaluate(e)<n.evaluate(e)}function Ve(e,t){var r=t[0],n=t[1];return r.evaluate(e)>n.evaluate(e)}function qe(e,t){var r=t[0],n=t[1];return r.evaluate(e)<=n.evaluate(e)}function Ue(e,t){var r=t[0],n=t[1];return r.evaluate(e)>=n.evaluate(e)}function Ze(e){return{type:e}}function He(e){return{result:"success",value:e}}function Ge(e){return{result:"error",value:e}}ve.register(Re,{error:[{kind:"error"},[U],function(e,t){var r=t[0];throw new oe(r.evaluate(e))}],typeof:[U,[$],function(e,t){return Y(ie(t[0].evaluate(e)))}],"to-string":[U,[$],function(e,t){var r=t[0],n=typeof(r=r.evaluate(e));return null===r?"":"string"===n||"number"===n||"boolean"===n?String(r):r instanceof ee?r.toString():JSON.stringify(r)}],"to-boolean":[Z,[$],function(e,t){var r=t[0];return Boolean(r.evaluate(e))}],"to-rgba":[X(q,4),[H],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[H,[q,q,q],Fe],rgba:[H,[q,q,q,q],Fe],has:{type:Z,overloads:[[[U],function(e,t){return Be(t[0].evaluate(e),e.properties())}],[[U,G],function(e,t){var r=t[0],n=t[1];return Be(r.evaluate(e),n.evaluate(e))}]]},get:{type:$,overloads:[[[U],function(e,t){return Ne(t[0].evaluate(e),e.properties())}],[[U,G],function(e,t){var r=t[0],n=t[1];return Ne(r.evaluate(e),n.evaluate(e))}]]},properties:[G,[],function(e){return e.properties()}],"geometry-type":[U,[],function(e){return e.geometryType()}],id:[$,[],function(e){return e.id()}],zoom:[q,[],function(e){return e.globals.zoom}],"heatmap-density":[q,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[q,[],function(e){return e.globals.lineProgress||0}],"+":[q,Ze(q),function(e,t){for(var r=0,n=0,i=t;n<i.length;n+=1){r+=i[n].evaluate(e)}return r}],"*":[q,Ze(q),function(e,t){for(var r=1,n=0,i=t;n<i.length;n+=1){r*=i[n].evaluate(e)}return r}],"-":{type:q,overloads:[[[q,q],function(e,t){var r=t[0],n=t[1];return r.evaluate(e)-n.evaluate(e)}],[[q],function(e,t){return-t[0].evaluate(e)}]]},"/":[q,[q,q],function(e,t){var r=t[0],n=t[1];return r.evaluate(e)/n.evaluate(e)}],"%":[q,[q,q],function(e,t){var r=t[0],n=t[1];return r.evaluate(e)%n.evaluate(e)}],ln2:[q,[],function(){return Math.LN2}],pi:[q,[],function(){return Math.PI}],e:[q,[],function(){return Math.E}],"^":[q,[q,q],function(e,t){var r=t[0],n=t[1];return Math.pow(r.evaluate(e),n.evaluate(e))}],sqrt:[q,[q],function(e,t){var r=t[0];return Math.sqrt(r.evaluate(e))}],log10:[q,[q],function(e,t){var r=t[0];return Math.log10(r.evaluate(e))}],ln:[q,[q],function(e,t){var r=t[0];return Math.log(r.evaluate(e))}],log2:[q,[q],function(e,t){var r=t[0];return Math.log2(r.evaluate(e))}],sin:[q,[q],function(e,t){var r=t[0];return Math.sin(r.evaluate(e))}],cos:[q,[q],function(e,t){var r=t[0];return Math.cos(r.evaluate(e))}],tan:[q,[q],function(e,t){var r=t[0];return Math.tan(r.evaluate(e))}],asin:[q,[q],function(e,t){var r=t[0];return Math.asin(r.evaluate(e))}],acos:[q,[q],function(e,t){var r=t[0];return Math.acos(r.evaluate(e))}],atan:[q,[q],function(e,t){var r=t[0];return Math.atan(r.evaluate(e))}],min:[q,Ze(q),function(e,t){return Math.min.apply(Math,t.map(function(t){return t.evaluate(e)}))}],max:[q,Ze(q),function(e,t){return Math.max.apply(Math,t.map(function(t){return t.evaluate(e)}))}],abs:[q,[q],function(e,t){var r=t[0];return Math.abs(r.evaluate(e))}],round:[q,[q],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[q,[q],function(e,t){var r=t[0];return Math.floor(r.evaluate(e))}],ceil:[q,[q],function(e,t){var r=t[0];return Math.ceil(r.evaluate(e))}],"filter-==":[Z,[U,$],function(e,t){var r=t[0],n=t[1];return e.properties()[r.value]===n.value}],"filter-id-==":[Z,[$],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[Z,[U],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[Z,[U,$],function(e,t){var r=t[0],n=t[1],i=e.properties()[r.value],a=n.value;return typeof i==typeof a&&i<a}],"filter-id-<":[Z,[$],function(e,t){var r=t[0],n=e.id(),i=r.value;return typeof n==typeof i&&n<i}],"filter->":[Z,[U,$],function(e,t){var r=t[0],n=t[1],i=e.properties()[r.value],a=n.value;return typeof i==typeof a&&i>a}],"filter-id->":[Z,[$],function(e,t){var r=t[0],n=e.id(),i=r.value;return typeof n==typeof i&&n>i}],"filter-<=":[Z,[U,$],function(e,t){var r=t[0],n=t[1],i=e.properties()[r.value],a=n.value;return typeof i==typeof a&&i<=a}],"filter-id-<=":[Z,[$],function(e,t){var r=t[0],n=e.id(),i=r.value;return typeof n==typeof i&&n<=i}],"filter->=":[Z,[U,$],function(e,t){var r=t[0],n=t[1],i=e.properties()[r.value],a=n.value;return typeof i==typeof a&&i>=a}],"filter-id->=":[Z,[$],function(e,t){var r=t[0],n=e.id(),i=r.value;return typeof n==typeof i&&n>=i}],"filter-has":[Z,[$],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[Z,[],function(e){return null!==e.id()}],"filter-type-in":[Z,[X(U)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[Z,[X($)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[Z,[U,X($)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[Z,[U,X($)],function(e,t){var r=t[0],n=t[1];return function(e,t,r,n){for(;r<=n;){var i=r+n>>1;if(t[i]===e)return!0;t[i]>e?n=i-1:r=i+1}return!1}(e.properties()[r.value],n.value,0,n.value.length-1)}],">":{type:Z,overloads:[[[q,q],Ve],[[U,U],Ve],[[U,U,W],function(e,t){var r=t[0],n=t[1];return t[2].evaluate(e).compare(r.evaluate(e),n.evaluate(e))>0}]]},"<":{type:Z,overloads:[[[q,q],je],[[U,U],je],[[U,U,W],function(e,t){var r=t[0],n=t[1];return t[2].evaluate(e).compare(r.evaluate(e),n.evaluate(e))<0}]]},">=":{type:Z,overloads:[[[q,q],Ue],[[U,U],Ue],[[U,U,W],function(e,t){var r=t[0],n=t[1];return t[2].evaluate(e).compare(r.evaluate(e),n.evaluate(e))>=0}]]},"<=":{type:Z,overloads:[[[q,q],qe],[[U,U],qe],[[U,U,W],function(e,t){var r=t[0],n=t[1];return t[2].evaluate(e).compare(r.evaluate(e),n.evaluate(e))<=0}]]},all:{type:Z,overloads:[[[Z,Z],function(e,t){var r=t[0],n=t[1];return r.evaluate(e)&&n.evaluate(e)}],[Ze(Z),function(e,t){for(var r=0,n=t;r<n.length;r+=1){if(!n[r].evaluate(e))return!1}return!0}]]},any:{type:Z,overloads:[[[Z,Z],function(e,t){var r=t[0],n=t[1];return r.evaluate(e)||n.evaluate(e)}],[Ze(Z),function(e,t){for(var r=0,n=t;r<n.length;r+=1){if(n[r].evaluate(e))return!0}return!1}]]},"!":[Z,[Z],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[Z,[U],function(e,t){var r=t[0],n=e.globals&&e.globals.isSupportedScript;return!n||n(r.evaluate(e))}],upcase:[U,[U],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[U,[U],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[U,Ze(U),function(e,t){return t.map(function(t){return t.evaluate(e)}).join("")}],"resolved-locale":[U,[W],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var $e=.95047,We=1,Xe=1.08883,Ye=4/29,Je=6/29,Ke=3*Je*Je,Qe=Je*Je*Je,et=Math.PI/180,tt=180/Math.PI;function rt(e){return e>Qe?Math.pow(e,1/3):e/Ke+Ye}function nt(e){return e>Je?e*e*e:Ke*(e-Ye)}function it(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function at(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ot(e){var t=at(e.r),r=at(e.g),n=at(e.b),i=rt((.4124564*t+.3575761*r+.1804375*n)/$e),a=rt((.2126729*t+.7151522*r+.072175*n)/We);return{l:116*a-16,a:500*(i-a),b:200*(a-rt((.0193339*t+.119192*r+.9503041*n)/Xe)),alpha:e.a}}function st(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,n=isNaN(e.b)?t:t-e.b/200;return t=We*nt(t),r=$e*nt(r),n=Xe*nt(n),new ee(it(3.2404542*r-1.5371385*t-.4985314*n),it(-.969266*r+1.8760108*t+.041556*n),it(.0556434*r-.2040259*t+1.0572252*n),e.alpha)}var lt={forward:ot,reverse:st,interpolate:function(e,t,r){return{l:we(e.l,t.l,r),a:we(e.a,t.a,r),b:we(e.b,t.b,r),alpha:we(e.alpha,t.alpha,r)}}},ut={forward:function(e){var t=ot(e),r=t.l,n=t.a,i=t.b,a=Math.atan2(i,n)*tt;return{h:a<0?a+360:a,c:Math.sqrt(n*n+i*i),l:r,alpha:e.a}},reverse:function(e){var t=e.h*et,r=e.c;return st({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:function(e,t,r){var n=t-e;return e+r*(n>180||n<-180?n-360*Math.round(n/360):n)}(e.h,t.h,r),c:we(e.c,t.c,r),l:we(e.l,t.l,r),alpha:we(e.alpha,t.alpha,r)}}},ct=Object.freeze({lab:lt,hcl:ut});function ft(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function ht(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function pt(e){return e}function dt(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function vt(e,t,r,n,i){return dt(typeof r===i?n[r]:void 0,e.default,t.default)}function mt(e,t,r){if("number"!==ft(r))return dt(e.default,t.default);var n=e.stops.length;if(1===n)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];var i=_t(e.stops,r);return e.stops[i][1]}function gt(e,t,r){var n=void 0!==e.base?e.base:1;if("number"!==ft(r))return dt(e.default,t.default);var i=e.stops.length;if(1===i)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];var a=_t(e.stops,r),o=function(e,t,r,n){var i=n-r,a=e-r;return 0===i?0:1===t?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}(r,n,e.stops[a][0],e.stops[a+1][0]),s=e.stops[a][1],l=e.stops[a+1][1],u=ke[t.type]||pt;if(e.colorSpace&&"rgb"!==e.colorSpace){var c=ct[e.colorSpace];u=function(e,t){return c.reverse(c.interpolate(c.forward(e),c.forward(t),o))}}return"function"==typeof s.evaluate?{evaluate:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var r=s.evaluate.apply(void 0,e),n=l.evaluate.apply(void 0,e);if(void 0!==r&&void 0!==n)return u(r,n,o)}}:u(s,l,o)}function yt(e,t,r){return"color"===t.type?r=ee.parse(r):ft(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0),dt(r,e.default,t.default)}function _t(e,t){for(var r,n,i=0,a=e.length-1,o=0;i<=a;){if(r=e[o=Math.floor((i+a)/2)][0],n=e[o+1][0],t===r||t>r&&t<n)return o;r<t?i=o+1:r>t&&(a=o-1)}return Math.max(o-1,0)}var xt=function(e,t){var r;this.expression=e,this._warningHistory={},this._defaultValue="color"===(r=t).type&&ht(r.default)?new ee(0,0,0,0):"color"===r.type?ee.parse(r.default)||null:void 0===r.default?null:r.default,"enum"===t.type&&(this._enumValues=t.values)};function bt(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Re}function wt(e,t){var r=new _e(Re,[],function(e){var t={color:H,string:U,number:q,enum:U,boolean:Z};if("array"===e.type)return X(t[e.value]||$,e.length);return t[e.type]||null}(t)),n=r.parse(e);return n?He(new xt(n,t)):Ge(r.errors)}xt.prototype.evaluateWithoutErrorHandling=function(e,t){return this._evaluator||(this._evaluator=new de),this._evaluator.globals=e,this._evaluator.feature=t,this.expression.evaluate(this._evaluator)},xt.prototype.evaluate=function(e,t){this._evaluator||(this._evaluator=new de),this._evaluator.globals=e,this._evaluator.feature=t;try{var r=this.expression.evaluate(this._evaluator);if(null==r)return this._defaultValue;if(this._enumValues&&!(r in this._enumValues))throw new oe("Expected value to be one of "+Object.keys(this._enumValues).map(function(e){return JSON.stringify(e)}).join(", ")+", but found "+JSON.stringify(r)+" instead.");return r}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}};var kt=function(e,t){this.kind=e,this._styleExpression=t};kt.prototype.evaluateWithoutErrorHandling=function(e,t){return this._styleExpression.evaluateWithoutErrorHandling(e,t)},kt.prototype.evaluate=function(e,t){return this._styleExpression.evaluate(e,t)};var At=function(e,t,r){this.kind=e,this.zoomStops=r.labels,this._styleExpression=t,r instanceof Ae&&(this._interpolationType=r.interpolation)};function Tt(e,t){if("error"===(e=wt(e,t)).result)return e;var r=e.value.expression,n=me(r);if(!n&&!t["property-function"])return Ge([new N("","property expressions not supported")]);var i=ge(r,["zoom"]);if(!i&&!1===t["zoom-function"])return Ge([new N("","zoom expressions not supported")]);var a=function e(t){var r=null;if(t instanceof Se)r=e(t.result);else if(t instanceof Me)for(var n=0,i=t.args;n<i.length;n+=1){var a=i[n];if(r=e(a))break}else(t instanceof be||t instanceof Ae)&&t.input instanceof ve&&"zoom"===t.input.name&&(r=t);if(r instanceof N)return r;t.eachChild(function(t){var n=e(t);n instanceof N?r=n:!r&&n?r=new N("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&n&&r!==n&&(r=new N("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))});return r}(r);return a||i?a instanceof N?Ge([a]):a instanceof Ae&&"piecewise-constant"===t.function?Ge([new N("",'"interpolate" expressions cannot be used with this property')]):He(a?new At(n?"camera":"composite",e.value,a):new kt(n?"constant":"source",e.value)):Ge([new N("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}At.prototype.evaluateWithoutErrorHandling=function(e,t){return this._styleExpression.evaluateWithoutErrorHandling(e,t)},At.prototype.evaluate=function(e,t){return this._styleExpression.evaluate(e,t)},At.prototype.interpolationFactor=function(e,t,r){return this._interpolationType?Ae.interpolationFactor(this._interpolationType,e,t,r):0};var Mt=function(e,t){this._parameters=e,this._specification=t,R(this,function e(t,r){var n,i,a,o="color"===r.type,s=t.stops&&"object"==typeof t.stops[0][0],l=s||void 0!==t.property,u=s||!l,c=t.type||("interpolated"===r.function?"exponential":"interval");if(o&&((t=R({},t)).stops&&(t.stops=t.stops.map(function(e){return[e[0],ee.parse(e[1])]})),t.default?t.default=ee.parse(t.default):t.default=ee.parse(r.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!ct[t.colorSpace])throw new Error("Unknown color space: "+t.colorSpace);if("exponential"===c)n=gt;else if("interval"===c)n=mt;else if("categorical"===c){n=vt,i=Object.create(null);for(var f=0,h=t.stops;f<h.length;f+=1){var p=h[f];i[p[0]]=p[1]}a=typeof t.stops[0][0]}else{if("identity"!==c)throw new Error('Unknown function type "'+c+'"');n=yt}if(s){for(var d={},v=[],m=0;m<t.stops.length;m++){var g=t.stops[m],y=g[0].zoom;void 0===d[y]&&(d[y]={zoom:y,type:t.type,property:t.property,default:t.default,stops:[]},v.push(y)),d[y].stops.push([g[0].value,g[1]])}for(var _=[],x=0,b=v;x<b.length;x+=1){var w=b[x];_.push([d[w].zoom,e(d[w],r)])}return{kind:"composite",interpolationFactor:Ae.interpolationFactor.bind(void 0,{name:"linear"}),zoomStops:_.map(function(e){return e[0]}),evaluate:function(e,n){var i=e.zoom;return gt({stops:_,base:t.base},r,i).evaluate(i,n)}}}return u?{kind:"camera",interpolationFactor:"exponential"===c?Ae.interpolationFactor.bind(void 0,{name:"exponential",base:void 0!==t.base?t.base:1}):function(){return 0},zoomStops:t.stops.map(function(e){return e[0]}),evaluate:function(e){var o=e.zoom;return n(t,r,o,i,a)}}:{kind:"source",evaluate:function(e,o){var s=o&&o.properties?o.properties[t.property]:void 0;return void 0===s?dt(t.default,r.default):n(t,r,s,i,a)}}}(this._parameters,this._specification))};function St(e,t){if(ht(e))return new Mt(e,t);if(bt(e)){var r=Tt(e,t);if("error"===r.result)throw new Error(r.value.map(function(e){return e.key+": "+e.message}).join(", "));return r.value}var n=e;return"string"==typeof e&&"color"===t.type&&(n=ee.parse(e)),{kind:"constant",evaluate:function(){return n}}}function Ct(e){var t=e.key,r=e.value,n=e.valueSpec||{},i=e.objectElementValidators||{},a=e.style,o=e.styleSpec,s=[],l=ft(r);if("object"!==l)return[new D(t,r,"object expected, "+l+" found")];for(var u in r){var c=u.split(".")[0],f=n[c]||n["*"],h=void 0;if(i[c])h=i[c];else if(n[c])h=Kt;else if(i["*"])h=i["*"];else{if(!n["*"]){s.push(new D(t,r[u],'unknown property "'+u+'"'));continue}h=Kt}s=s.concat(h({key:(t?t+".":t)+u,value:r[u],valueSpec:f,style:a,styleSpec:o,object:r,objectKey:u},r))}for(var p in n)i[p]||n[p].required&&void 0===n[p].default&&void 0===r[p]&&s.push(new D(t,r,'missing required property "'+p+'"'));return s}function zt(e){var t=e.value,r=e.valueSpec,n=e.style,i=e.styleSpec,a=e.key,o=e.arrayElementValidator||Kt;if("array"!==ft(t))return[new D(a,t,"array expected, "+ft(t)+" found")];if(r.length&&t.length!==r.length)return[new D(a,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new D(a,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var s={type:r.value};i.$version<7&&(s.function=r.function),"object"===ft(r.value)&&(s=r.value);for(var l=[],u=0;u<t.length;u++)l=l.concat(o({array:t,arrayIndex:u,value:t[u],valueSpec:s,style:n,styleSpec:i,key:a+"["+u+"]"}));return l}function Et(e){var t=e.key,r=e.value,n=e.valueSpec,i=ft(r);return"number"!==i?[new D(t,r,"number expected, "+i+" found")]:"minimum"in n&&r<n.minimum?[new D(t,r,r+" is less than the minimum value "+n.minimum)]:"maximum"in n&&r>n.maximum?[new D(t,r,r+" is greater than the maximum value "+n.maximum)]:[]}function Lt(e){var t,r,n,i=e.valueSpec,a=F(e.value.type),o={},s="categorical"!==a&&void 0===e.value.property,l=!s,u="array"===ft(e.value.stops)&&"array"===ft(e.value.stops[0])&&"object"===ft(e.value.stops[0][0]),c=Ct({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===a)return[new D(e.key,e.value,'identity function may not have a "stops" property')];var t=[],r=e.value;t=t.concat(zt({key:e.key,value:r,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:f})),"array"===ft(r)&&0===r.length&&t.push(new D(e.key,r,"array must have at least one stop"));return t},default:function(e){return Kt({key:e.key,value:e.value,valueSpec:i,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===a&&s&&c.push(new D(e.key,e.value,'missing required property "property"')),"identity"===a||e.value.stops||c.push(new D(e.key,e.value,'missing required property "stops"')),"exponential"===a&&"piecewise-constant"===e.valueSpec.function&&c.push(new D(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!e.valueSpec["property-function"]?c.push(new D(e.key,e.value,"property functions not supported")):s&&!e.valueSpec["zoom-function"]&&"heatmap-color"!==e.objectKey&&"line-gradient"!==e.objectKey&&c.push(new D(e.key,e.value,"zoom functions not supported"))),"categorical"!==a&&!u||void 0!==e.value.property||c.push(new D(e.key,e.value,'"property" property is required')),c;function f(e){var t=[],a=e.value,s=e.key;if("array"!==ft(a))return[new D(s,a,"array expected, "+ft(a)+" found")];if(2!==a.length)return[new D(s,a,"array length 2 expected, length "+a.length+" found")];if(u){if("object"!==ft(a[0]))return[new D(s,a,"object expected, "+ft(a[0])+" found")];if(void 0===a[0].zoom)return[new D(s,a,"object stop key must have zoom")];if(void 0===a[0].value)return[new D(s,a,"object stop key must have value")];if(n&&n>F(a[0].zoom))return[new D(s,a[0].zoom,"stop zoom values must appear in ascending order")];F(a[0].zoom)!==n&&(n=F(a[0].zoom),r=void 0,o={}),t=t.concat(Ct({key:s+"[0]",value:a[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Et,value:h}}))}else t=t.concat(h({key:s+"[0]",value:a[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},a));return t.concat(Kt({key:s+"[1]",value:a[1],valueSpec:i,style:e.style,styleSpec:e.styleSpec}))}function h(e,n){var s=ft(e.value),l=F(e.value),u=null!==e.value?e.value:n;if(t){if(s!==t)return[new D(e.key,u,s+" stop domain type must match previous stop domain type "+t)]}else t=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new D(e.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==a){var c="number expected, "+s+" found";return i["property-function"]&&void 0===a&&(c+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new D(e.key,u,c)]}return"categorical"!==a||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==a&&"number"===s&&void 0!==r&&l<r?[new D(e.key,u,"stop domain values must appear in ascending order")]:(r=l,"categorical"===a&&l in o?[new D(e.key,u,"stop domain values must be unique")]:(o[l]=!0,[])):[new D(e.key,u,"integer expected, found "+l)]}}function It(e){var t=("property"===e.expressionContext?Tt:wt)(B(e.value),e.valueSpec);return"error"===t.result?t.value.map(function(t){return new D(""+e.key+t.key,e.value,t.message)}):"property"===e.expressionContext&&"text-font"===e.propertyKey&&-1!==t.value._styleExpression.expression.possibleOutputs().indexOf(void 0)?[new D(e.key,e.value,'Invalid data expression for "text-font". Output values must be contained as literals within the expression.')]:[]}function Pt(e){var t=e.key,r=e.value,n=e.valueSpec,i=[];return Array.isArray(n.values)?-1===n.values.indexOf(F(r))&&i.push(new D(t,r,"expected one of ["+n.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(n.values).indexOf(F(r))&&i.push(new D(t,r,"expected one of ["+Object.keys(n.values).join(", ")+"], "+JSON.stringify(r)+" found")),i}function Dt(e){if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3===e.length&&(Array.isArray(e[1])||Array.isArray(e[2]));case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var n=r[t];if(!Dt(n)&&"boolean"!=typeof n)return!1}return!0;default:return!0}}Mt.deserialize=function(e){return new Mt(e._parameters,e._specification)},Mt.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Ot={type:"boolean",default:!1,function:!0,"property-function":!0,"zoom-function":!0};function Rt(e){if(!e)return function(){return!0};Dt(e)||(e=Bt(e));var t=wt(e,Ot);if("error"===t.result)throw new Error(t.value.map(function(e){return e.key+": "+e.message}).join(", "));return function(e,r){return t.value.evaluate(e,r)}}function Ft(e,t){return e<t?-1:e>t?1:0}function Bt(e){if(!e)return!0;var t,r=e[0];return e.length<=1?"any"!==r:"=="===r?Nt(e[1],e[2],"=="):"!="===r?qt(Nt(e[1],e[2],"==")):"<"===r||">"===r||"<="===r||">="===r?Nt(e[1],e[2],r):"any"===r?(t=e.slice(1),["any"].concat(t.map(Bt))):"all"===r?["all"].concat(e.slice(1).map(Bt)):"none"===r?["all"].concat(e.slice(1).map(Bt).map(qt)):"in"===r?jt(e[1],e.slice(2)):"!in"===r?qt(jt(e[1],e.slice(2))):"has"===r?Vt(e[1]):"!has"!==r||qt(Vt(e[1]))}function Nt(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function jt(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(e){return typeof e!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Ft)]]:["filter-in-small",e,["literal",t]]}}function Vt(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function qt(e){return["!",e]}function Ut(e){return Dt(B(e.value))?It(R({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(t){var r=t.value;var n=t.key;if("array"!==ft(r))return[new D(n,r,"array expected, "+ft(r)+" found")];var i=t.styleSpec;var a;var o=[];if(r.length<1)return[new D(n,r,"filter array must have at least 1 element")];o=o.concat(Pt({key:n+"[0]",value:r[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec}));switch(F(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===F(r[1])&&o.push(new D(n,r,'"$type" cannot be use with operator "'+r[0]+'"'));case"==":case"!=":3!==r.length&&o.push(new D(n,r,'filter array for operator "'+r[0]+'" must have 3 elements'));case"in":case"!in":r.length>=2&&"string"!==(a=ft(r[1]))&&o.push(new D(n+"[1]",r[1],"string expected, "+a+" found"));for(var s=2;s<r.length;s++)a=ft(r[s]),"$type"===F(r[1])?o=o.concat(Pt({key:n+"["+s+"]",value:r[s],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==a&&"number"!==a&&"boolean"!==a&&o.push(new D(n+"["+s+"]",r[s],"string, number, or boolean expected, "+a+" found"));break;case"any":case"all":case"none":for(var l=1;l<r.length;l++)o=o.concat(e({key:n+"["+l+"]",value:r[l],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":a=ft(r[1]),2!==r.length?o.push(new D(n,r,'filter array for "'+r[0]+'" operator must have 2 elements')):"string"!==a&&o.push(new D(n+"[1]",r[1],"string expected, "+a+" found"))}return o}(e)}function Zt(e,t){var r=e.key,n=e.style,i=e.styleSpec,a=e.value,o=e.objectKey,s=i[t+"_"+e.layerType];if(!s)return[];var l=o.match(/^(.*)-transition$/);if("paint"===t&&l&&s[l[1]]&&s[l[1]].transition)return Kt({key:r,value:a,valueSpec:i.transition,style:n,styleSpec:i});var u,c=e.valueSpec||s[o];if(!c)return[new D(r,a,'unknown property "'+o+'"')];if("string"===ft(a)&&c["property-function"]&&!c.tokens&&(u=/^{([^}]+)}$/.exec(a)))return[new D(r,a,'"'+o+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(u[1])+" }`.")];var f=[];return"symbol"===e.layerType&&("text-field"===o&&n&&!n.glyphs&&f.push(new D(r,a,'use of "text-field" requires a style "glyphs" property')),"text-font"===o&&ht(B(a))&&"identity"===F(a.type)&&f.push(new D(r,a,'"text-font" does not support identity functions'))),f.concat(Kt({key:e.key,value:a,valueSpec:c,style:n,styleSpec:i,expressionContext:"property",propertyKey:o}))}function Ht(e){return Zt(e,"paint")}function Gt(e){return Zt(e,"layout")}function $t(e){var t=[],r=e.value,n=e.key,i=e.style,a=e.styleSpec;r.type||r.ref||t.push(new D(n,r,'either "type" or "ref" is required'));var o,s=F(r.type),l=F(r.ref);if(r.id)for(var u=F(r.id),c=0;c<e.arrayIndex;c++){var f=i.layers[c];F(f.id)===u&&t.push(new D(n,r.id,'duplicate layer id "'+r.id+'", previously used at line '+f.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(e){e in r&&t.push(new D(n,r[e],'"'+e+'" is prohibited for ref layers'))}),i.layers.forEach(function(e){F(e.id)===l&&(o=e)}),o?o.ref?t.push(new D(n,r.ref,"ref cannot reference another ref layer")):s=F(o.type):t.push(new D(n,r.ref,'ref layer "'+l+'" not found'));else if("background"!==s)if(r.source){var h=i.sources&&i.sources[r.source],p=h&&F(h.type);h?"vector"===p&&"raster"===s?t.push(new D(n,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===p&&"raster"!==s?t.push(new D(n,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==p||r["source-layer"]?"raster-dem"===p&&"hillshade"!==s?t.push(new D(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==s||!r.paint||!r.paint["line-gradient"]||"geojson"===p&&h.lineMetrics||t.push(new D(n,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new D(n,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new D(n,r.source,'source "'+r.source+'" not found'))}else t.push(new D(n,r,'missing required property "source"'));return t=t.concat(Ct({key:n,value:r,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Kt({key:n+".type",value:r.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:Ut,layout:function(e){return Ct({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return Gt(R({layerType:s},e))}}})},paint:function(e){return Ct({layer:r,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(e){return Ht(R({layerType:s},e))}}})}}}))}function Wt(e){var t=e.value,r=e.key,n=e.styleSpec,i=e.style;if(!t.type)return[new D(r,t,'"type" is required')];var a=F(t.type),o=[];switch(a){case"vector":case"raster":case"raster-dem":if(o=o.concat(Ct({key:r,value:t,valueSpec:n["source_"+a.replace("-","_")],style:e.style,styleSpec:n})),"url"in t)for(var s in t)["type","url","tileSize"].indexOf(s)<0&&o.push(new D(r+"."+s,t[s],'a source with a "url" property may not include a "'+s+'" property'));return o;case"geojson":return Ct({key:r,value:t,valueSpec:n.source_geojson,style:i,styleSpec:n});case"video":return Ct({key:r,value:t,valueSpec:n.source_video,style:i,styleSpec:n});case"image":return Ct({key:r,value:t,valueSpec:n.source_image,style:i,styleSpec:n});case"canvas":return o.push(new D(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")),o;default:return Pt({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,styleSpec:n})}}function Xt(e){var t=e.value,r=e.styleSpec,n=r.light,i=e.style,a=[],o=ft(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new D("light",t,"object expected, "+o+" found")]);for(var s in t){var l=s.match(/^(.*)-transition$/);a=l&&n[l[1]]&&n[l[1]].transition?a.concat(Kt({key:s,value:t[s],valueSpec:r.transition,style:i,styleSpec:r})):n[s]?a.concat(Kt({key:s,value:t[s],valueSpec:n[s],style:i,styleSpec:r})):a.concat([new D(s,t[s],'unknown property "'+s+'"')])}return a}function Yt(e){var t=e.value,r=e.key,n=ft(t);return"string"!==n?[new D(r,t,"string expected, "+n+" found")]:[]}var Jt={"*":function(){return[]},array:zt,boolean:function(e){var t=e.value,r=e.key,n=ft(t);return"boolean"!==n?[new D(r,t,"boolean expected, "+n+" found")]:[]},number:Et,color:function(e){var t=e.key,r=e.value,n=ft(r);return"string"!==n?[new D(t,r,"color expected, "+n+" found")]:null===Q(r)?[new D(t,r,'color expected, "'+r+'" found')]:[]},constants:O,enum:Pt,filter:Ut,function:Lt,layer:$t,object:Ct,source:Wt,light:Xt,string:Yt};function Kt(e){var t=e.value,r=e.valueSpec,n=e.styleSpec;return r.function&&ht(F(t))?Lt(e):r.function&&bt(B(t))?It(e):r.type&&Jt[r.type]?Jt[r.type](e):Ct(R({},e,{valueSpec:r.type?n[r.type]:r}))}function Qt(e){var t=e.value,r=e.key,n=Yt(e);return n.length?n:(-1===t.indexOf("{fontstack}")&&n.push(new D(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new D(r,t,'"glyphs" url must include a "{range}" token')),n)}function er(e,t){t=t||P;var r=[];return r=r.concat(Kt({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Qt,"*":function(){return[]}}})),e.constants&&(r=r.concat(O({key:"constants",value:e.constants,style:e,styleSpec:t}))),tr(r)}function tr(e){return[].concat(e).sort(function(e,t){return e.line-t.line})}function rr(e){return function(){return tr(e.apply(this,arguments))}}er.source=rr(Wt),er.light=rr(Xt),er.layer=rr($t),er.filter=rr(Ut),er.paintProperty=rr(Ht),er.layoutProperty=rr(Gt);var nr=er,ir=er.light,ar=er.paintProperty,or=er.layoutProperty;function sr(e,t){var r=!1;if(t&&t.length)for(var n=0,i=t;n<i.length;n+=1){var a=i[n];e.fire(new L(new Error(a.message))),r=!0}return r}var lr=cr,ur=3;function cr(e,t,r){var n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var i=new Int32Array(this.arrayBuffer);e=i[0],t=i[1],r=i[2],this.d=t+2*r;for(var a=0;a<this.d*this.d;a++){var o=i[ur+a],s=i[ur+a+1];n.push(o===s?null:i.subarray(o,s))}var l=i[ur+n.length],u=i[ur+n.length+1];this.keys=i.subarray(l,u),this.bboxes=i.subarray(u),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var c=0;c<this.d*this.d;c++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var f=r/t*e;this.min=-f,this.max=e+f}cr.prototype.insert=function(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)},cr.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},cr.prototype._insertCell=function(e,t,r,n,i,a){this.cells[i].push(a)},cr.prototype.query=function(e,t,r,n){var i=this.min,a=this.max;if(e<=i&&t<=i&&a<=r&&a<=n)return Array.prototype.slice.call(this.keys);var o=[];return this._forEachCell(e,t,r,n,this._queryCell,o,{}),o},cr.prototype._queryCell=function(e,t,r,n,i,a,o){var s=this.cells[i];if(null!==s)for(var l=this.keys,u=this.bboxes,c=0;c<s.length;c++){var f=s[c];if(void 0===o[f]){var h=4*f;e<=u[h+2]&&t<=u[h+3]&&r>=u[h+0]&&n>=u[h+1]?(o[f]=!0,a.push(l[f])):o[f]=!1}}},cr.prototype._forEachCell=function(e,t,r,n,i,a,o){for(var s=this._convertToCellCoord(e),l=this._convertToCellCoord(t),u=this._convertToCellCoord(r),c=this._convertToCellCoord(n),f=s;f<=u;f++)for(var h=l;h<=c;h++){var p=this.d*h+f;if(i.call(this,e,t,r,n,p,a,o))return}},cr.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},cr.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=ur+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var i=new Int32Array(t+r+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var a=t,o=0;o<e.length;o++){var s=e[o];i[ur+o]=a,i.set(s,a),a+=s.length}return i[ur+e.length]=a,i.set(this.keys,a),a+=this.keys.length,i[ur+e.length+1]=a,i.set(this.bboxes,a),a+=this.bboxes.length,i.buffer};var fr=self.ImageData,hr={};function pr(e,t,r){void 0===r&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),hr[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var dr in pr("Object",Object),lr.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),r},lr.deserialize=function(e){return new lr(e)},pr("Grid",lr),pr("Color",ee),pr("Error",Error),pr("StylePropertyFunction",Mt),pr("StyleExpression",xt,{omit:["_evaluator"]}),pr("ZoomDependentExpression",At),pr("ZoomConstantExpression",kt),pr("CompoundExpression",ve,{omit:["_evaluate"]}),Re)Re[dr]._classRegistryKey||pr("Expression_"+dr,Re[dr]);function vr(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(e instanceof ArrayBuffer)return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof fr)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var n=[],i=0,a=e;i<a.length;i+=1){var o=a[i];n.push(vr(o,t))}return n}if("object"==typeof e){var s=e.constructor,l=s._classRegistryKey;if(!l)throw new Error("can't serialize object of unregistered class");var u={};if(s.serialize)u._serialized=s.serialize(e,t);else{for(var c in e)if(e.hasOwnProperty(c)&&!(hr[l].omit.indexOf(c)>=0)){var f=e[c];u[c]=hr[l].shallow.indexOf(c)>=0?f:vr(f,t)}e instanceof Error&&(u.message=e.message)}return{name:l,properties:u}}throw new Error("can't serialize object of type "+typeof e)}function mr(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof ArrayBuffer||ArrayBuffer.isView(e)||e instanceof fr)return e;if(Array.isArray(e))return e.map(function(e){return mr(e)});if("object"==typeof e){var t=e,r=t.name,n=t.properties;if(!r)throw new Error("can't deserialize object of anonymous class");var i=hr[r].klass;if(!i)throw new Error("can't deserialize unregistered class "+r);if(i.deserialize)return i.deserialize(n._serialized);for(var a=Object.create(i.prototype),o=0,s=Object.keys(n);o<s.length;o+=1){var l=s[o];a[l]=hr[r].shallow.indexOf(l)>=0?n[l]:mr(n[l])}return a}throw new Error("can't deserialize object of type "+typeof e)}var gr=function(){this.first=!0};gr.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var yr={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function _r(e){for(var t=0,r=e;t<r.length;t+=1){if(br(r[t].charCodeAt(0)))return!0}return!1}function xr(e){return!yr.Arabic(e)&&(!yr["Arabic Supplement"](e)&&(!yr["Arabic Extended-A"](e)&&(!yr["Arabic Presentation Forms-A"](e)&&!yr["Arabic Presentation Forms-B"](e))))}function br(e){return 746===e||747===e||!(e<4352)&&(!!yr["Bopomofo Extended"](e)||(!!yr.Bopomofo(e)||(!(!yr["CJK Compatibility Forms"](e)||e>=65097&&e<=65103)||(!!yr["CJK Compatibility Ideographs"](e)||(!!yr["CJK Compatibility"](e)||(!!yr["CJK Radicals Supplement"](e)||(!!yr["CJK Strokes"](e)||(!(!yr["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||(!!yr["CJK Unified Ideographs Extension A"](e)||(!!yr["CJK Unified Ideographs"](e)||(!!yr["Enclosed CJK Letters and Months"](e)||(!!yr["Hangul Compatibility Jamo"](e)||(!!yr["Hangul Jamo Extended-A"](e)||(!!yr["Hangul Jamo Extended-B"](e)||(!!yr["Hangul Jamo"](e)||(!!yr["Hangul Syllables"](e)||(!!yr.Hiragana(e)||(!!yr["Ideographic Description Characters"](e)||(!!yr.Kanbun(e)||(!!yr["Kangxi Radicals"](e)||(!!yr["Katakana Phonetic Extensions"](e)||(!(!yr.Katakana(e)||12540===e)||(!(!yr["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||(!(!yr["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||(!!yr["Unified Canadian Aboriginal Syllabics"](e)||(!!yr["Unified Canadian Aboriginal Syllabics Extended"](e)||(!!yr["Vertical Forms"](e)||(!!yr["Yijing Hexagram Symbols"](e)||(!!yr["Yi Syllables"](e)||!!yr["Yi Radicals"](e))))))))))))))))))))))))))))))}function wr(e){return!(br(e)||function(e){return!!(yr["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||yr["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||yr["Letterlike Symbols"](e)||yr["Number Forms"](e)||yr["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||yr["Control Pictures"](e)&&9251!==e||yr["Optical Character Recognition"](e)||yr["Enclosed Alphanumerics"](e)||yr["Geometric Shapes"](e)||yr["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||yr["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||yr["CJK Symbols and Punctuation"](e)||yr.Katakana(e)||yr["Private Use Area"](e)||yr["CJK Compatibility Forms"](e)||yr["Small Form Variants"](e)||yr["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function kr(e,t){return!(!t&&(e>=1424&&e<=2303||yr["Arabic Presentation Forms-A"](e)||yr["Arabic Presentation Forms-B"](e)))&&!(e>=2304&&e<=3583||e>=3840&&e<=4255||yr.Khmer(e))}var Ar,Tr=!1,Mr=null,Sr=!1,Cr=new I,zr={applyArabicShaping:null,processBidirectionalText:null,isLoaded:function(){return Sr||null!=zr.applyArabicShaping}},Er=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new gr,this.transition={})};Er.prototype.isSupportedScript=function(e){return function(e,t){for(var r=0,n=e;r<n.length;r+=1)if(!kr(n[r].charCodeAt(0),t))return!1;return!0}(e,zr.isLoaded())},Er.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)};var Lr=function(e,t){this.property=e,this.value=t,this.expression=St(void 0===t?e.specification.default:t,e.specification)};Lr.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},Lr.prototype.possiblyEvaluate=function(e){return this.property.possiblyEvaluate(this,e)};var Ir=function(e){this.property=e,this.value=new Lr(e,void 0)};Ir.prototype.transitioned=function(e,t){return new Dr(this.property,this.value,t,p({},e.transition,this.transition),e.now)},Ir.prototype.untransitioned=function(){return new Dr(this.property,this.value,null,{},0)};var Pr=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};Pr.prototype.getValue=function(e){return _(this._values[e].value.value)},Pr.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ir(this._values[e].property)),this._values[e].value=new Lr(this._values[e].property,null===t?void 0:_(t))},Pr.prototype.getTransition=function(e){return _(this._values[e].transition)},Pr.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ir(this._values[e].property)),this._values[e].transition=_(t)||void 0},Pr.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var n=r[t],i=this.getValue(n);void 0!==i&&(e[n]=i);var a=this.getTransition(n);void 0!==a&&(e[n+"-transition"]=a)}return e},Pr.prototype.transitioned=function(e,t){for(var r=new Or(this._properties),n=0,i=Object.keys(this._values);n<i.length;n+=1){var a=i[n];r._values[a]=this._values[a].transitioned(e,t._values[a])}return r},Pr.prototype.untransitioned=function(){for(var e=new Or(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var n=r[t];e._values[n]=this._values[n].untransitioned()}return e};var Dr=function(e,t,r,n,i){this.property=e,this.value=t,this.begin=i+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)};Dr.prototype.possiblyEvaluate=function(e){var t=e.now||0,r=this.value.possiblyEvaluate(e),n=this.prior;if(n){if(t>this.end)return this.prior=null,r;if(this.value.isDataDriven())return this.prior=null,r;if(t<this.begin)return n.possiblyEvaluate(e);var i=(t-this.begin)/(this.end-this.begin);return this.property.interpolate(n.possiblyEvaluate(e),r,function(e){if(e<=0)return 0;if(e>=1)return 1;var t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}(i))}return r};var Or=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Or.prototype.possiblyEvaluate=function(e){for(var t=new Br(this._properties),r=0,n=Object.keys(this._values);r<n.length;r+=1){var i=n[r];t._values[i]=this._values[i].possiblyEvaluate(e)}return t},Or.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1){var r=t[e];if(this._values[r].prior)return!0}return!1};var Rr=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};Rr.prototype.getValue=function(e){return _(this._values[e].value)},Rr.prototype.setValue=function(e,t){this._values[e]=new Lr(this._values[e].property,null===t?void 0:_(t))},Rr.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var n=r[t],i=this.getValue(n);void 0!==i&&(e[n]=i)}return e},Rr.prototype.possiblyEvaluate=function(e){for(var t=new Br(this._properties),r=0,n=Object.keys(this._values);r<n.length;r+=1){var i=n[r];t._values[i]=this._values[i].possiblyEvaluate(e)}return t};var Fr=function(e,t,r){this.property=e,this.value=t,this.globals=r};Fr.prototype.isConstant=function(){return"constant"===this.value.kind},Fr.prototype.constantOr=function(e){return"constant"===this.value.kind?this.value.value:e},Fr.prototype.evaluate=function(e){return this.property.evaluate(this.value,this.globals,e)};var Br=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};Br.prototype.get=function(e){return this._values[e]};var Nr=function(e){this.specification=e};Nr.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Nr.prototype.interpolate=function(e,t,r){var n=ke[this.specification.type];return n?n(e,t,r):e};var jr=function(e){this.specification=e};jr.prototype.possiblyEvaluate=function(e,t){return"constant"===e.expression.kind||"camera"===e.expression.kind?new Fr(this,{kind:"constant",value:e.expression.evaluate(t)},t):new Fr(this,e.expression,t)},jr.prototype.interpolate=function(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new Fr(this,{kind:"constant",value:void 0},e.globals);var n=ke[this.specification.type];return n?new Fr(this,{kind:"constant",value:n(e.value.value,t.value.value,r)},e.globals):e},jr.prototype.evaluate=function(e,t,r){return"constant"===e.kind?e.value:e.evaluate(t,r)};var Vr=function(e){this.specification=e};Vr.prototype.possiblyEvaluate=function(e,t){if(void 0!==e.value){if("constant"===e.expression.kind){var r=e.expression.evaluate(t);return this._calculate(r,r,r,t)}return this._calculate(e.expression.evaluate(new Er(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Er(Math.floor(t.zoom),t)),e.expression.evaluate(new Er(Math.floor(t.zoom+1),t)),t)}},Vr.prototype._calculate=function(e,t,r,n){var i=n.zoom,a=i-Math.floor(i),o=n.crossFadingFactor();return i>n.zoomHistory.lastIntegerZoom?{from:e,to:t,fromScale:2,toScale:1,t:a+(1-a)*o}:{from:r,to:t,fromScale:.5,toScale:1,t:1-(1-o)*a}},Vr.prototype.interpolate=function(e){return e};var qr=function(e){this.specification=e};qr.prototype.possiblyEvaluate=function(e,t){return!!e.expression.evaluate(t)},qr.prototype.interpolate=function(){return!1};var Ur=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},e){var r=e[t],n=this.defaultPropertyValues[t]=new Lr(r,void 0),i=this.defaultTransitionablePropertyValues[t]=new Ir(r);this.defaultTransitioningPropertyValues[t]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=n.possiblyEvaluate({})}};pr("DataDrivenProperty",jr),pr("DataConstantProperty",Nr),pr("CrossFadedProperty",Vr),pr("ColorRampProperty",qr);var Zr=function(e){function t(t,r){for(var n in e.call(this),this.id=t.id,this.metadata=t.metadata,this.type=t.type,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,this.visibility="visible","background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),this._featureFilter=function(){return!0},r.layout&&(this._unevaluatedLayout=new Rr(r.layout)),this._transitionablePaint=new Pr(r.paint),t.paint)this.setPaintProperty(n,t.paint[n],{validate:!1});for(var i in t.layout)this.setLayoutProperty(i,t.layout[i],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getLayoutProperty=function(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)},t.prototype.setLayoutProperty=function(e,t,r){if(null!=t){var n="layers."+this.id+".layout."+e;if(this._validate(or,n,e,t,r))return}"visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility="none"===t?t:"visible"},t.prototype.getPaintProperty=function(e){return m(e,"-transition")?this._transitionablePaint.getTransition(e.slice(0,-"-transition".length)):this._transitionablePaint.getValue(e)},t.prototype.setPaintProperty=function(e,t,r){if(null!=t){var n="layers."+this.id+".paint."+e;if(this._validate(ar,n,e,t,r))return}m(e,"-transition")?this._transitionablePaint.setTransition(e.slice(0,-"-transition".length),t||void 0):this._transitionablePaint.setValue(e,t)},t.prototype.isHidden=function(e){return!!(this.minzoom&&e<this.minzoom)||(!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility)},t.prototype.updateTransitions=function(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(e){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e)),this.paint=this._transitioningPaint.possiblyEvaluate(e)},t.prototype.serialize=function(){var e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return"none"===this.visibility&&(e.layout=e.layout||{},e.layout.visibility="none"),y(e,function(e,t){return!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)})},t.prototype._validate=function(e,t,r,n,i){return(!i||!1!==i.validate)&&sr(this,e.call(nr,{key:t,layerType:this.type,objectKey:r,value:n,styleSpec:P,style:{glyphs:!0,sprite:!0}}))},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t}(I),Hr={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Gr=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},$r=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Wr(e,t){void 0===t&&(t=1);var r=0,n=0;return{members:e.map(function(e){var i,a=(i=e.type,Hr[i].BYTES_PER_ELEMENT),o=r=Xr(r,Math.max(t,a)),s=e.components||1;return n=Math.max(n,a),r+=a*s,{name:e.name,type:e.type,components:s,offset:o}}),size:Xr(r,Math.max(n,t)),alignment:t}}function Xr(e,t){return Math.ceil(e/t)*t}$r.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},$r.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},$r.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},$r.prototype.clear=function(){this.length=0},$r.prototype.resize=function(e){this.reserve(e),this.length=e},$r.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},$r.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var Yr=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var r=this.length;this.resize(r+1);var n=2*r;return this.int16[n+0]=e,this.int16[n+1]=t,r},t}($r);Yr.prototype.bytesPerElement=4,pr("StructArrayLayout2i4",Yr);var Jr=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n){var i=this.length;this.resize(i+1);var a=4*i;return this.int16[a+0]=e,this.int16[a+1]=t,this.int16[a+2]=r,this.int16[a+3]=n,i},t}($r);Jr.prototype.bytesPerElement=8,pr("StructArrayLayout4i8",Jr);var Kr=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,i,a){var o=this.length;this.resize(o+1);var s=6*o;return this.int16[s+0]=e,this.int16[s+1]=t,this.int16[s+2]=r,this.int16[s+3]=n,this.int16[s+4]=i,this.int16[s+5]=a,o},t}($r);Kr.prototype.bytesPerElement=12,pr("StructArrayLayout2i4i12",Kr);var Qr=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,i,a,o,s){var l=this.length;this.resize(l+1);var u=6*l,c=12*l;return this.int16[u+0]=e,this.int16[u+1]=t,this.int16[u+2]=r,this.int16[u+3]=n,this.uint8[c+8]=i,this.uint8[c+9]=a,this.uint8[c+10]=o,this.uint8[c+11]=s,l},t}($r);Qr.prototype.bytesPerElement=12,pr("StructArrayLayout4i4ub12",Qr);var en=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,i,a,o,s){var l=this.length;this.resize(l+1);var u=8*l;return this.int16[u+0]=e,this.int16[u+1]=t,this.int16[u+2]=r,this.int16[u+3]=n,this.uint16[u+4]=i,this.uint16[u+5]=a,this.uint16[u+6]=o,this.uint16[u+7]=s,l},t}($r);en.prototype.bytesPerElement=16,pr("StructArrayLayout4i4ui16",en);var tn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r){var n=this.length;this.resize(n+1);var i=3*n;return this.float32[i+0]=e,this.float32[i+1]=t,this.float32[i+2]=r,n},t}($r);tn.prototype.bytesPerElement=12,pr("StructArrayLayout3f12",tn);var rn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e){var t=this.length;this.resize(t+1);var r=1*t;return this.uint32[r+0]=e,t},t}($r);rn.prototype.bytesPerElement=4,pr("StructArrayLayout1ul4",rn);var nn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,i,a,o,s,l,u,c){var f=this.length;this.resize(f+1);var h=12*f,p=6*f;return this.int16[h+0]=e,this.int16[h+1]=t,this.int16[h+2]=r,this.int16[h+3]=n,this.int16[h+4]=i,this.int16[h+5]=a,this.uint32[p+3]=o,this.uint16[h+8]=s,this.uint16[h+9]=l,this.int16[h+10]=u,this.int16[h+11]=c,f},t}($r);nn.prototype.bytesPerElement=24,pr("StructArrayLayout6i1ul2ui2i24",nn);var an=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,i,a){var o=this.length;this.resize(o+1);var s=6*o;return this.int16[s+0]=e,this.int16[s+1]=t,this.int16[s+2]=r,this.int16[s+3]=n,this.int16[s+4]=i,this.int16[s+5]=a,o},t}($r);an.prototype.bytesPerElement=12,pr("StructArrayLayout2i2i2i12",an);var on=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var r=this.length;this.resize(r+1);var n=4*r;return this.uint8[n+0]=e,this.uint8[n+1]=t,r},t}($r);on.prototype.bytesPerElement=4,pr("StructArrayLayout2ub4",on);var sn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n,i,a,o,s,l,u,c,f,h,p){var d=this.length;this.resize(d+1);var v=20*d,m=10*d,g=40*d;return this.int16[v+0]=e,this.int16[v+1]=t,this.uint16[v+2]=r,this.uint16[v+3]=n,this.uint32[m+2]=i,this.uint32[m+3]=a,this.uint32[m+4]=o,this.uint16[v+10]=s,this.uint16[v+11]=l,this.uint16[v+12]=u,this.float32[m+7]=c,this.float32[m+8]=f,this.uint8[g+36]=h,this.uint8[g+37]=p,d},t}($r);sn.prototype.bytesPerElement=40,pr("StructArrayLayout2i2ui3ul3ui2f2ub40",sn);var ln=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e){var t=this.length;this.resize(t+1);var r=1*t;return this.float32[r+0]=e,t},t}($r);ln.prototype.bytesPerElement=4,pr("StructArrayLayout1f4",ln);var un=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r){var n=this.length;this.resize(n+1);var i=3*n;return this.int16[i+0]=e,this.int16[i+1]=t,this.int16[i+2]=r,n},t}($r);un.prototype.bytesPerElement=6,pr("StructArrayLayout3i6",un);var cn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r){var n=this.length;this.resize(n+1);var i=2*n,a=4*n;return this.uint32[i+0]=e,this.uint16[a+2]=t,this.uint16[a+3]=r,n},t}($r);cn.prototype.bytesPerElement=8,pr("StructArrayLayout1ul2ui8",cn);var fn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r){var n=this.length;this.resize(n+1);var i=3*n;return this.uint16[i+0]=e,this.uint16[i+1]=t,this.uint16[i+2]=r,n},t}($r);fn.prototype.bytesPerElement=6,pr("StructArrayLayout3ui6",fn);var hn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var r=this.length;this.resize(r+1);var n=2*r;return this.uint16[n+0]=e,this.uint16[n+1]=t,r},t}($r);hn.prototype.bytesPerElement=4,pr("StructArrayLayout2ui4",hn);var pn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t){var r=this.length;this.resize(r+1);var n=2*r;return this.float32[n+0]=e,this.float32[n+1]=t,r},t}($r);pn.prototype.bytesPerElement=8,pr("StructArrayLayout2f8",pn);var dn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(e,t,r,n){var i=this.length;this.resize(i+1);var a=4*i;return this.float32[a+0]=e,this.float32[a+1]=t,this.float32[a+2]=r,this.float32[a+3]=n,i},t}($r);dn.prototype.bytesPerElement=16,pr("StructArrayLayout4f16",dn);var vn=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},radius:{configurable:!0},signedDistanceFromAnchor:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointX.set=function(e){this._structArray.int16[this._pos2+0]=e},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.anchorPointY.set=function(e){this._structArray.int16[this._pos2+1]=e},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.x1.set=function(e){this._structArray.int16[this._pos2+2]=e},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.y1.set=function(e){this._structArray.int16[this._pos2+3]=e},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.x2.set=function(e){this._structArray.int16[this._pos2+4]=e},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.y2.set=function(e){this._structArray.int16[this._pos2+5]=e},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.featureIndex.set=function(e){this._structArray.uint32[this._pos4+3]=e},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.sourceLayerIndex.set=function(e){this._structArray.uint16[this._pos2+8]=e},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.bucketIndex.set=function(e){this._structArray.uint16[this._pos2+9]=e},r.radius.get=function(){return this._structArray.int16[this._pos2+10]},r.radius.set=function(e){this._structArray.int16[this._pos2+10]=e},r.signedDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+11]},r.signedDistanceFromAnchor.set=function(e){this._structArray.int16[this._pos2+11]=e},r.anchorPoint.get=function(){return new l(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(Gr);vn.prototype.size=24;var mn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e){return new vn(this,e)},t}(nn);pr("CollisionBoxArray",mn);var gn=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},hidden:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorX.set=function(e){this._structArray.int16[this._pos2+0]=e},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.anchorY.set=function(e){this._structArray.int16[this._pos2+1]=e},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.glyphStartIndex.set=function(e){this._structArray.uint16[this._pos2+2]=e},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.numGlyphs.set=function(e){this._structArray.uint16[this._pos2+3]=e},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.vertexStartIndex.set=function(e){this._structArray.uint32[this._pos4+2]=e},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineStartIndex.set=function(e){this._structArray.uint32[this._pos4+3]=e},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.lineLength.set=function(e){this._structArray.uint32[this._pos4+4]=e},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.segment.set=function(e){this._structArray.uint16[this._pos2+10]=e},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.lowerSize.set=function(e){this._structArray.uint16[this._pos2+11]=e},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.upperSize.set=function(e){this._structArray.uint16[this._pos2+12]=e},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetX.set=function(e){this._structArray.float32[this._pos4+7]=e},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.lineOffsetY.set=function(e){this._structArray.float32[this._pos4+8]=e},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.writingMode.set=function(e){this._structArray.uint8[this._pos1+36]=e},r.hidden.get=function(){return this._structArray.uint8[this._pos1+37]},r.hidden.set=function(e){this._structArray.uint8[this._pos1+37]=e},Object.defineProperties(t.prototype,r),t}(Gr);gn.prototype.size=40;var yn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e){return new gn(this,e)},t}(sn);pr("PlacedSymbolArray",yn);var _n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={offsetX:{configurable:!0}};return r.offsetX.get=function(){return this._structArray.float32[this._pos4+0]},r.offsetX.set=function(e){this._structArray.float32[this._pos4+0]=e},Object.defineProperties(t.prototype,r),t}(Gr);_n.prototype.size=4;var xn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getoffsetX=function(e){return this.float32[1*e+0]},t.prototype.get=function(e){return new _n(this,e)},t}(ln);pr("GlyphOffsetArray",xn);var bn=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={x:{configurable:!0},y:{configurable:!0},tileUnitDistanceFromAnchor:{configurable:!0}};return r.x.get=function(){return this._structArray.int16[this._pos2+0]},r.x.set=function(e){this._structArray.int16[this._pos2+0]=e},r.y.get=function(){return this._structArray.int16[this._pos2+1]},r.y.set=function(e){this._structArray.int16[this._pos2+1]=e},r.tileUnitDistanceFromAnchor.get=function(){return this._structArray.int16[this._pos2+2]},r.tileUnitDistanceFromAnchor.set=function(e){this._structArray.int16[this._pos2+2]=e},Object.defineProperties(t.prototype,r),t}(Gr);bn.prototype.size=6;var wn=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.getx=function(e){return this.int16[3*e+0]},t.prototype.gety=function(e){return this.int16[3*e+1]},t.prototype.gettileUnitDistanceFromAnchor=function(e){return this.int16[3*e+2]},t.prototype.get=function(e){return new bn(this,e)},t}(un);pr("SymbolLineVertexArray",wn);var kn=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.featureIndex.set=function(e){this._structArray.uint32[this._pos4+0]=e},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.sourceLayerIndex.set=function(e){this._structArray.uint16[this._pos2+2]=e},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},r.bucketIndex.set=function(e){this._structArray.uint16[this._pos2+3]=e},Object.defineProperties(t.prototype,r),t}(Gr);kn.prototype.size=8;var An=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e){return new kn(this,e)},t}(cn);pr("FeatureIndexArray",An);var Tn=Wr([{name:"a_pos",components:2,type:"Int16"}],4).members,Mn=function(e){void 0===e&&(e=[]),this.segments=e};Mn.prototype.prepareSegment=function(e,t,r){var n=this.segments[this.segments.length-1];return e>Mn.MAX_VERTEX_ARRAY_LENGTH&&b("Max vertices per segment is "+Mn.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!n||n.vertexLength+e>Mn.MAX_VERTEX_ARRAY_LENGTH)&&(n={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},this.segments.push(n)),n},Mn.prototype.get=function(){return this.segments},Mn.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var n in r.vaos)r.vaos[n].destroy()}},Mn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,pr("SegmentVector",Mn);var Sn=function(e,t){return 256*(e=h(Math.floor(e),0,255))+(t=h(Math.floor(t),0,255))};function Cn(e){return[Sn(255*e.r,255*e.g),Sn(255*e.b,255*e.a)]}var zn=function(e,t,r){this.value=e,this.name=t,this.type=r,this.statistics={max:-1/0}};zn.prototype.defines=function(){return["#define HAS_UNIFORM_u_"+this.name]},zn.prototype.populatePaintArray=function(){},zn.prototype.upload=function(){},zn.prototype.destroy=function(){},zn.prototype.setUniforms=function(e,t,r,n){var i=n.constantOr(this.value),a=e.gl;"color"===this.type?a.uniform4f(t.uniforms["u_"+this.name],i.r,i.g,i.b,i.a):a.uniform1f(t.uniforms["u_"+this.name],i)};var En=function(e,t,r){this.expression=e,this.name=t,this.type=r,this.statistics={max:-1/0};var n="color"===r?pn:ln;this.paintVertexAttributes=[{name:"a_"+t,type:"Float32",components:"color"===r?2:1,offset:0}],this.paintVertexArray=new n};En.prototype.defines=function(){return[]},En.prototype.populatePaintArray=function(e,t){var r=this.paintVertexArray,n=r.length;r.reserve(e);var i=this.expression.evaluate(new Er(0),t);if("color"===this.type)for(var a=Cn(i),o=n;o<e;o++)r.emplaceBack(a[0],a[1]);else{for(var s=n;s<e;s++)r.emplaceBack(i);this.statistics.max=Math.max(this.statistics.max,i)}},En.prototype.upload=function(e){this.paintVertexArray&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes))},En.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},En.prototype.setUniforms=function(e,t){e.gl.uniform1f(t.uniforms["a_"+this.name+"_t"],0)};var Ln=function(e,t,r,n,i){this.expression=e,this.name=t,this.type=r,this.useIntegerZoom=n,this.zoom=i,this.statistics={max:-1/0};var a="color"===r?dn:pn;this.paintVertexAttributes=[{name:"a_"+t,type:"Float32",components:"color"===r?4:2,offset:0}],this.paintVertexArray=new a};Ln.prototype.defines=function(){return[]},Ln.prototype.populatePaintArray=function(e,t){var r=this.paintVertexArray,n=r.length;r.reserve(e);var i=this.expression.evaluate(new Er(this.zoom),t),a=this.expression.evaluate(new Er(this.zoom+1),t);if("color"===this.type)for(var o=Cn(i),s=Cn(a),l=n;l<e;l++)r.emplaceBack(o[0],o[1],s[0],s[1]);else{for(var u=n;u<e;u++)r.emplaceBack(i,a);this.statistics.max=Math.max(this.statistics.max,i,a)}},Ln.prototype.upload=function(e){this.paintVertexArray&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes))},Ln.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ln.prototype.interpolationFactor=function(e){return this.useIntegerZoom?this.expression.interpolationFactor(Math.floor(e),this.zoom,this.zoom+1):this.expression.interpolationFactor(e,this.zoom,this.zoom+1)},Ln.prototype.setUniforms=function(e,t,r){e.gl.uniform1f(t.uniforms["a_"+this.name+"_t"],this.interpolationFactor(r.zoom))};var In=function(){this.binders={},this.cacheKey="",this._buffers=[]};In.createDynamic=function(e,t,r){var n=new In,i=[];for(var a in e.paint._values)if(r(a)){var o=e.paint.get(a);if(o instanceof Fr&&o.property.specification["property-function"]){var s=Dn(a,e.type),l=o.property.specification.type,u=o.property.useIntegerZoom;"constant"===o.value.kind?(n.binders[a]=new zn(o.value,s,l),i.push("/u_"+s)):"source"===o.value.kind?(n.binders[a]=new En(o.value,s,l),i.push("/a_"+s)):(n.binders[a]=new Ln(o.value,s,l,u,t),i.push("/z_"+s))}}return n.cacheKey=i.sort().join(""),n},In.prototype.populatePaintArrays=function(e,t){for(var r in this.binders)this.binders[r].populatePaintArray(e,t)},In.prototype.defines=function(){var e=[];for(var t in this.binders)e.push.apply(e,this.binders[t].defines());return e},In.prototype.setUniforms=function(e,t,r,n){for(var i in this.binders){this.binders[i].setUniforms(e,t,n,r.get(i))}},In.prototype.getPaintVertexBuffers=function(){return this._buffers},In.prototype.upload=function(e){for(var t in this.binders)this.binders[t].upload(e);var r=[];for(var n in this.binders){var i=this.binders[n];(i instanceof En||i instanceof Ln)&&i.paintVertexBuffer&&r.push(i.paintVertexBuffer)}this._buffers=r},In.prototype.destroy=function(){for(var e in this.binders)this.binders[e].destroy()};var Pn=function(e,t,r,n){void 0===n&&(n=function(){return!0}),this.programConfigurations={};for(var i=0,a=t;i<a.length;i+=1){var o=a[i];this.programConfigurations[o.id]=In.createDynamic(o,r,n),this.programConfigurations[o.id].layoutAttributes=e}};function Dn(e,t){return{"text-opacity":"opacity","icon-opacity":"opacity","text-color":"fill_color","icon-color":"fill_color","text-halo-color":"halo_color","icon-halo-color":"halo_color","text-halo-blur":"halo_blur","icon-halo-blur":"halo_blur","text-halo-width":"halo_width","icon-halo-width":"halo_width","line-gap-width":"gapwidth"}[e]||e.replace(t+"-","").replace(/-/g,"_")}Pn.prototype.populatePaintArrays=function(e,t){for(var r in this.programConfigurations)this.programConfigurations[r].populatePaintArrays(e,t)},Pn.prototype.get=function(e){return this.programConfigurations[e]},Pn.prototype.upload=function(e){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e)},Pn.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},pr("ConstantBinder",zn),pr("SourceExpressionBinder",En),pr("CompositeExpressionBinder",Ln),pr("ProgramConfiguration",In,{omit:["_buffers"]}),pr("ProgramConfigurationSet",Pn);var On=8192;var Rn,Fn=(Rn=16,{min:-1*Math.pow(2,Rn-1),max:Math.pow(2,Rn-1)-1});function Bn(e){for(var t=On/e.extent,r=e.loadGeometry(),n=0;n<r.length;n++)for(var i=r[n],a=0;a<i.length;a++){var o=i[a];o.x=Math.round(o.x*t),o.y=Math.round(o.y*t),(o.x<Fn.min||o.x>Fn.max||o.y<Fn.min||o.y>Fn.max)&&b("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Nn(e,t,r,n,i){e.emplaceBack(2*t+(n+1)/2,2*r+(i+1)/2)}var jn=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.layoutVertexArray=new Yr,this.indexArray=new fn,this.segments=new Mn,this.programConfigurations=new Pn(Tn,e.layers,e.zoom)};function Vn(e,t,r){for(var n=0;n<e.length;n++){var i=e[n];if(Yn(i,t))return!0;if($n(t,i,r))return!0}return!1}function qn(e,t){if(1===e.length&&1===e[0].length)return Xn(t,e[0][0]);for(var r=0;r<t.length;r++)for(var n=t[r],i=0;i<n.length;i++)if(Xn(e,n[i]))return!0;for(var a=0;a<e.length;a++){for(var o=e[a],s=0;s<o.length;s++)if(Xn(t,o[s]))return!0;for(var l=0;l<t.length;l++)if(Hn(o,t[l]))return!0}return!1}function Un(e,t,r){for(var n=0;n<t.length;n++)for(var i=t[n],a=0;a<e.length;a++){var o=e[a];if(o.length>=3)for(var s=0;s<i.length;s++)if(Yn(o,i[s]))return!0;if(Zn(o,i,r))return!0}return!1}function Zn(e,t,r){if(e.length>1){if(Hn(e,t))return!0;for(var n=0;n<t.length;n++)if($n(t[n],e,r))return!0}for(var i=0;i<e.length;i++)if($n(e[i],t,r))return!0;return!1}function Hn(e,t){if(0===e.length||0===t.length)return!1;for(var r=0;r<e.length-1;r++)for(var n=e[r],i=e[r+1],a=0;a<t.length-1;a++){if(Gn(n,i,t[a],t[a+1]))return!0}return!1}function Gn(e,t,r,n){return w(e,r,n)!==w(t,r,n)&&w(e,t,r)!==w(e,t,n)}function $n(e,t,r){var n=r*r;if(1===t.length)return e.distSqr(t[0])<n;for(var i=1;i<t.length;i++){if(Wn(e,t[i-1],t[i])<n)return!0}return!1}function Wn(e,t,r){var n=t.distSqr(r);if(0===n)return e.distSqr(t);var i=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return i<0?e.distSqr(t):i>1?e.distSqr(r):e.distSqr(r.sub(t)._mult(i)._add(t))}function Xn(e,t){for(var r,n,i,a=!1,o=0;o<e.length;o++)for(var s=0,l=(r=e[o]).length-1;s<r.length;l=s++)n=r[s],i=r[l],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(a=!a);return a}function Yn(e,t){for(var r=!1,n=0,i=e.length-1;n<e.length;i=n++){var a=e[n],o=e[i];a.y>t.y!=o.y>t.y&&t.x<(o.x-a.x)*(t.y-a.y)/(o.y-a.y)+a.x&&(r=!r)}return r}function Jn(e,t,r){var n=t.paint.get(e).value;return"constant"===n.kind?n.value:r.programConfigurations.get(t.id).binders[e].statistics.max}function Kn(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Qn(e,t,r,n,i){if(!t[0]&&!t[1])return e;var a=l.convert(t);"viewport"===r&&a._rotate(-n);for(var o=[],s=0;s<e.length;s++){for(var u=e[s],c=[],f=0;f<u.length;f++)c.push(u[f].sub(a._mult(i)));o.push(c)}return o}jn.prototype.populate=function(e,t){for(var r=0,n=e;r<n.length;r+=1){var i=n[r],a=i.feature,o=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Er(this.zoom),a)){var l=Bn(a);this.addFeature(a,l),t.featureIndex.insert(a,l,o,s,this.index)}}},jn.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},jn.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Tn),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.programConfigurations.upload(e)},jn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},jn.prototype.addFeature=function(e,t){for(var r=0,n=t;r<n.length;r+=1)for(var i=0,a=n[r];i<a.length;i+=1){var o=a[i],s=o.x,l=o.y;if(!(s<0||s>=On||l<0||l>=On)){var u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),c=u.vertexLength;Nn(this.layoutVertexArray,s,l,-1,-1),Nn(this.layoutVertexArray,s,l,1,-1),Nn(this.layoutVertexArray,s,l,1,1),Nn(this.layoutVertexArray,s,l,-1,1),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+3,c+2),u.vertexLength+=4,u.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e)},pr("CircleBucket",jn,{omit:["layers"]});var ei={paint:new Ur({"circle-radius":new jr(P.paint_circle["circle-radius"]),"circle-color":new jr(P.paint_circle["circle-color"]),"circle-blur":new jr(P.paint_circle["circle-blur"]),"circle-opacity":new jr(P.paint_circle["circle-opacity"]),"circle-translate":new Nr(P.paint_circle["circle-translate"]),"circle-translate-anchor":new Nr(P.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Nr(P.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Nr(P.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jr(P.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jr(P.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jr(P.paint_circle["circle-stroke-opacity"])})},ti=i(function(e,t){var r;e.exports=((r=new Float32Array(3))[0]=0,r[1]=0,r[2]=0,function(){var e=new Float32Array(4);e[0]=0,e[1]=0,e[2]=0,e[3]=0}(),{vec3:{transformMat3:function(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e}},vec4:{transformMat4:function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e}},mat2:{create:function(){var e=new Float32Array(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},rotate:function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l+a*s,e[1]=i*l+o*s,e[2]=n*-s+a*l,e[3]=i*-s+o*l,e},scale:function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],l=r[1];return e[0]=n*s,e[1]=i*s,e[2]=a*l,e[3]=o*l,e}},mat3:{create:function(){var e=new Float32Array(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},fromRotation:function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}},mat4:{create:function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},identity:function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},translate:function(e,t,r){var n,i,a,o,s,l,u,c,f,h,p,d,v=r[0],m=r[1],g=r[2];return t===e?(e[12]=t[0]*v+t[4]*m+t[8]*g+t[12],e[13]=t[1]*v+t[5]*m+t[9]*g+t[13],e[14]=t[2]*v+t[6]*m+t[10]*g+t[14],e[15]=t[3]*v+t[7]*m+t[11]*g+t[15]):(n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],f=t[8],h=t[9],p=t[10],d=t[11],e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=f,e[9]=h,e[10]=p,e[11]=d,e[12]=n*v+s*m+f*g+t[12],e[13]=i*v+l*m+h*g+t[13],e[14]=a*v+u*m+p*g+t[14],e[15]=o*v+c*m+d*g+t[15]),e},scale:function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},multiply:function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],f=t[8],h=t[9],p=t[10],d=t[11],v=t[12],m=t[13],g=t[14],y=t[15],_=r[0],x=r[1],b=r[2],w=r[3];return e[0]=_*n+x*s+b*f+w*v,e[1]=_*i+x*l+b*h+w*m,e[2]=_*a+x*u+b*p+w*g,e[3]=_*o+x*c+b*d+w*y,_=r[4],x=r[5],b=r[6],w=r[7],e[4]=_*n+x*s+b*f+w*v,e[5]=_*i+x*l+b*h+w*m,e[6]=_*a+x*u+b*p+w*g,e[7]=_*o+x*c+b*d+w*y,_=r[8],x=r[9],b=r[10],w=r[11],e[8]=_*n+x*s+b*f+w*v,e[9]=_*i+x*l+b*h+w*m,e[10]=_*a+x*u+b*p+w*g,e[11]=_*o+x*c+b*d+w*y,_=r[12],x=r[13],b=r[14],w=r[15],e[12]=_*n+x*s+b*f+w*v,e[13]=_*i+x*l+b*h+w*m,e[14]=_*a+x*u+b*p+w*g,e[15]=_*o+x*c+b*d+w*y,e},perspective:function(e,t,r,n,i){var a=1/Math.tan(t/2),o=1/(n-i);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*o,e[15]=0,e},rotateX:function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+u*n,e[5]=o*i+c*n,e[6]=s*i+f*n,e[7]=l*i+h*n,e[8]=u*i-a*n,e[9]=c*i-o*n,e[10]=f*i-s*n,e[11]=h*i-l*n,e},rotateZ:function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+u*n,e[1]=o*i+c*n,e[2]=s*i+f*n,e[3]=l*i+h*n,e[4]=u*i-a*n,e[5]=c*i-o*n,e[6]=f*i-s*n,e[7]=h*i-l*n,e},invert:function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],f=t[9],h=t[10],p=t[11],d=t[12],v=t[13],m=t[14],g=t[15],y=r*s-n*o,_=r*l-i*o,x=r*u-a*o,b=n*l-i*s,w=n*u-a*s,k=i*u-a*l,A=c*v-f*d,T=c*m-h*d,M=c*g-p*d,S=f*m-h*v,C=f*g-p*v,z=h*g-p*m,E=y*z-_*C+x*S+b*M-w*T+k*A;return E?(E=1/E,e[0]=(s*z-l*C+u*S)*E,e[1]=(i*C-n*z-a*S)*E,e[2]=(v*k-m*w+g*b)*E,e[3]=(h*w-f*k-p*b)*E,e[4]=(l*M-o*z-u*T)*E,e[5]=(r*z-i*M+a*T)*E,e[6]=(m*x-d*k-g*_)*E,e[7]=(c*k-h*x+p*_)*E,e[8]=(o*C-s*M+u*A)*E,e[9]=(n*M-r*C-a*A)*E,e[10]=(d*w-v*x+g*y)*E,e[11]=(f*x-c*w-p*y)*E,e[12]=(s*T-o*S-l*A)*E,e[13]=(r*S-n*T+i*A)*E,e[14]=(v*_-d*b-m*y)*E,e[15]=(c*b-f*_+h*y)*E,e):null},ortho:function(e,t,r,n,i,a,o){var s=1/(t-r),l=1/(n-i),u=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*l,e[14]=(o+a)*u,e[15]=1,e}}})}),ri=(ti.vec3,ti.vec4),ni=(ti.mat2,ti.mat3,ti.mat4),ii=function(e){function t(t){e.call(this,t,ei)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createBucket=function(e){return new jn(e)},t.prototype.queryRadius=function(e){var t=e;return Jn("circle-radius",this,t)+Jn("circle-stroke-width",this,t)+Kn(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(e,t,r,n,i,a,o){for(var s=Qn(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),i.angle,a),l=this.paint.get("circle-radius").evaluate(t)+this.paint.get("circle-stroke-width").evaluate(t),u="map"===this.paint.get("circle-pitch-alignment"),c=u?s:function(e,t,r){return e.map(function(e){return e.map(function(e){return ai(e,t,r)})})}(s,o,i),f=u?l*a:l,h=0,p=r;h<p.length;h+=1)for(var d=0,v=p[h];d<v.length;d+=1){var m=v[d],g=u?m:ai(m,o,i),y=f,_=ri.transformMat4([],[m.x,m.y,0,1],o);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?y*=_[3]/i.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(y*=i.cameraToCenterDistance/_[3]),Vn(c,g,y))return!0}return!1},t}(Zr);function ai(e,t,r){var n=ri.transformMat4([],[e.x,e.y,0,1],t);return new l((n[0]/n[3]+1)*r.width*.5,(n[1]/n[3]+1)*r.height*.5)}var oi=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(jn);function si(e,t,r,n){var i=t.width,a=t.height;if(n){if(n.length!==i*a*r)throw new RangeError("mismatched image size")}else n=new Uint8Array(i*a*r);return e.width=i,e.height=a,e.data=n,e}function li(e,t,r){var n=t.width,i=t.height;if(n!==e.width||i!==e.height){var a=si({},{width:n,height:i},r);ui(e,a,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,n),height:Math.min(e.height,i)},r),e.width=n,e.height=i,e.data=a.data}}function ui(e,t,r,n,i,a){if(0===i.width||0===i.height)return t;if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");for(var o=e.data,s=t.data,l=0;l<i.height;l++)for(var u=((r.y+l)*e.width+r.x)*a,c=((n.y+l)*t.width+n.x)*a,f=0;f<i.width*a;f++)s[c+f]=o[u+f];return t}pr("HeatmapBucket",oi,{omit:["layers"]});var ci=function(e,t){si(this,e,1,t)};ci.prototype.resize=function(e){li(this,e,1)},ci.prototype.clone=function(){return new ci({width:this.width,height:this.height},new Uint8Array(this.data))},ci.copy=function(e,t,r,n,i){ui(e,t,r,n,i,1)};var fi=function(e,t){si(this,e,4,t)};fi.prototype.resize=function(e){li(this,e,4)},fi.prototype.clone=function(){return new fi({width:this.width,height:this.height},new Uint8Array(this.data))},fi.copy=function(e,t,r,n,i){ui(e,t,r,n,i,4)},pr("AlphaImage",ci),pr("RGBAImage",fi);var hi={paint:new Ur({"heatmap-radius":new jr(P.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jr(P.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Nr(P.paint_heatmap["heatmap-intensity"]),"heatmap-color":new qr(P.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Nr(P.paint_heatmap["heatmap-opacity"])})};function pi(e,t){for(var r=new Uint8Array(1024),n={},i=0,a=0;i<256;i++,a+=4){n[t]=i/255;var o=e.evaluate(n);r[a+0]=Math.floor(255*o.r/o.a),r[a+1]=Math.floor(255*o.g/o.a),r[a+2]=Math.floor(255*o.b/o.a),r[a+3]=Math.floor(255*o.a)}return new fi({width:256,height:1},r)}var di=function(e){function t(t){e.call(this,t,hi),this._updateColorRamp()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createBucket=function(e){return new oi(e)},t.prototype.setPaintProperty=function(t,r,n){e.prototype.setPaintProperty.call(this,t,r,n),"heatmap-color"===t&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){var e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=pi(e,"heatmapDensity"),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},t}(Zr),vi={paint:new Ur({"hillshade-illumination-direction":new Nr(P.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Nr(P.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Nr(P.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Nr(P.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Nr(P.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Nr(P.paint_hillshade["hillshade-accent-color"])})},mi=function(e){function t(t){e.call(this,t,vi)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},t}(Zr),gi=Wr([{name:"a_pos",components:2,type:"Int16"}],4).members,yi=xi,_i=xi;function xi(e,t,r){r=r||2;var n,i,a,o,s,l,u,c=t&&t.length,f=c?t[0]*r:e.length,h=bi(e,0,f,r,!0),p=[];if(!h)return p;if(c&&(h=function(e,t,r,n){var i,a,o,s,l,u=[];for(i=0,a=t.length;i<a;i++)o=t[i]*n,s=i<a-1?t[i+1]*n:e.length,(l=bi(e,o,s,n,!1))===l.next&&(l.steiner=!0),u.push(Li(l));for(u.sort(Ci),i=0;i<u.length;i++)zi(u[i],r),r=wi(r,r.next);return r}(e,t,h,r)),e.length>80*r){n=a=e[0],i=o=e[1];for(var d=r;d<f;d+=r)(s=e[d])<n&&(n=s),(l=e[d+1])<i&&(i=l),s>a&&(a=s),l>o&&(o=l);u=0!==(u=Math.max(a-n,o-i))?1/u:0}return ki(h,p,r,n,i,u),p}function bi(e,t,r,n,i){var a,o;if(i===qi(e,t,r,n)>0)for(a=t;a<r;a+=n)o=Ni(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=Ni(a,e[a],e[a+1],o);return o&&Oi(o,o.next)&&(ji(o),o=o.next),o}function wi(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!Oi(n,n.next)&&0!==Di(n.prev,n,n.next))n=n.next;else{if(ji(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function ki(e,t,r,n,i,a,o){if(e){!o&&a&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=Ei(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,a,o,s,l,u=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ);t++);for(l=u;s>0||l>0&&n;)0!==s&&(0===l||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,u*=2}while(o>1)}(i)}(e,n,i,a);for(var s,l,u=e;e.prev!==e.next;)if(s=e.prev,l=e.next,a?Ti(e,n,i,a):Ai(e))t.push(s.i/r),t.push(e.i/r),t.push(l.i/r),ji(e),e=l.next,u=l.next;else if((e=l)===u){o?1===o?ki(e=Mi(e,t,r),t,r,n,i,a,2):2===o&&Si(e,t,r,n,i,a):ki(wi(e),t,r,n,i,a,1);break}}}function Ai(e){var t=e.prev,r=e,n=e.next;if(Di(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(Ii(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&Di(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function Ti(e,t,r,n){var i=e.prev,a=e,o=e.next;if(Di(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,l=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,u=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,c=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,f=Ei(s,l,t,r,n),h=Ei(u,c,t,r,n),p=e.prevZ,d=e.nextZ;p&&p.z>=f&&d&&d.z<=h;){if(p!==e.prev&&p!==e.next&&Ii(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Di(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,d!==e.prev&&d!==e.next&&Ii(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&Di(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;p&&p.z>=f;){if(p!==e.prev&&p!==e.next&&Ii(i.x,i.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Di(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;d&&d.z<=h;){if(d!==e.prev&&d!==e.next&&Ii(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&Di(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Mi(e,t,r){var n=e;do{var i=n.prev,a=n.next.next;!Oi(i,a)&&Ri(i,n,n.next,a)&&Fi(i,a)&&Fi(a,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(a.i/r),ji(n),ji(n.next),n=e=a),n=n.next}while(n!==e);return n}function Si(e,t,r,n,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Pi(o,s)){var l=Bi(o,s);return o=wi(o,o.next),l=wi(l,l.next),ki(o,t,r,n,i,a),void ki(l,t,r,n,i,a)}s=s.next}o=o.next}while(o!==e)}function Ci(e,t){return e.x-t.x}function zi(e,t){if(t=function(e,t){var r,n=t,i=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>o){if(o=s,s===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===o)return r.prev;var l,u=r,c=r.x,f=r.y,h=1/0;n=r.next;for(;n!==u;)i>=n.x&&n.x>=c&&i!==n.x&&Ii(a<f?i:o,a,c,f,a<f?o:i,a,n.x,n.y)&&((l=Math.abs(a-n.y)/(i-n.x))<h||l===h&&n.x>r.x)&&Fi(n,e)&&(r=n,h=l),n=n.next;return r}(e,t)){var r=Bi(t,e);wi(r,r.next)}}function Ei(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Li(e){var t=e,r=e;do{t.x<r.x&&(r=t),t=t.next}while(t!==e);return r}function Ii(e,t,r,n,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(i-o)*(n-s)>=0}function Pi(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&Ri(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&Fi(e,t)&&Fi(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function Di(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Oi(e,t){return e.x===t.x&&e.y===t.y}function Ri(e,t,r,n){return!!(Oi(e,t)&&Oi(r,n)||Oi(e,n)&&Oi(r,t))||Di(e,t,r)>0!=Di(e,t,n)>0&&Di(r,n,e)>0!=Di(r,n,t)>0}function Fi(e,t){return Di(e.prev,e,e.next)<0?Di(e,t,e.next)>=0&&Di(e,e.prev,t)>=0:Di(e,t,e.prev)<0||Di(e,e.next,t)<0}function Bi(e,t){var r=new Vi(e.i,e.x,e.y),n=new Vi(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function Ni(e,t,r,n){var i=new Vi(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function ji(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Vi(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function qi(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}xi.deviation=function(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,o=Math.abs(qi(e,0,a,r));if(i)for(var s=0,l=t.length;s<l;s++){var u=t[s]*r,c=s<l-1?t[s+1]*r:e.length;o-=Math.abs(qi(e,u,c,r))}var f=0;for(s=0;s<n.length;s+=3){var h=n[s]*r,p=n[s+1]*r,d=n[s+2]*r;f+=Math.abs((e[h]-e[d])*(e[p+1]-e[h+1])-(e[h]-e[p])*(e[d+1]-e[h+1]))}return 0===o&&0===f?0:Math.abs((f-o)/o)},xi.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var a=0;a<e[i].length;a++)for(var o=0;o<t;o++)r.vertices.push(e[i][a][o]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r},yi.default=_i;var Ui=Hi,Zi=Hi;function Hi(e,t,r,n,i){!function e(t,r,n,i,a){for(;i>n;){if(i-n>600){var o=i-n+1,s=r-n+1,l=Math.log(o),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(o-u)/o)*(s-o/2<0?-1:1),f=Math.max(n,Math.floor(r-s*u/o+c)),h=Math.min(i,Math.floor(r+(o-s)*u/o+c));e(t,r,f,h,a)}var p=t[r],d=n,v=i;for(Gi(t,n,r),a(t[i],p)>0&&Gi(t,n,i);d<v;){for(Gi(t,d,v),d++,v--;a(t[d],p)<0;)d++;for(;a(t[v],p)>0;)v--}0===a(t[n],p)?Gi(t,n,v):Gi(t,++v,i),v<=r&&(n=v+1),r<=v&&(i=v-1)}}(e,t,r||0,n||e.length-1,i||$i)}function Gi(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function $i(e,t){return e<t?-1:e>t?1:0}function Wi(e,t){var r=e.length;if(r<=1)return[e];for(var n,i,a=[],o=0;o<r;o++){var s=k(e[o]);0!==s&&(e[o].area=Math.abs(s),void 0===i&&(i=s<0),i===s<0?(n&&a.push(n),n=[e[o]]):n.push(e[o]))}if(n&&a.push(n),t>1)for(var l=0;l<a.length;l++)a[l].length<=t||(Ui(a[l],t,1,a[l].length-1,Xi),a[l]=a[l].slice(0,t));return a}function Xi(e,t){return t.area-e.area}Ui.default=Zi;var Yi=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.layoutVertexArray=new Yr,this.indexArray=new fn,this.indexArray2=new hn,this.programConfigurations=new Pn(gi,e.layers,e.zoom),this.segments=new Mn,this.segments2=new Mn};Yi.prototype.populate=function(e,t){for(var r=0,n=e;r<n.length;r+=1){var i=n[r],a=i.feature,o=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Er(this.zoom),a)){var l=Bn(a);this.addFeature(a,l),t.featureIndex.insert(a,l,o,s,this.index)}}},Yi.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Yi.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,gi),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2),this.programConfigurations.upload(e)},Yi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Yi.prototype.addFeature=function(e,t){for(var r=0,n=Wi(t,500);r<n.length;r+=1){for(var i=n[r],a=0,o=0,s=i;o<s.length;o+=1){a+=s[o].length}for(var l=this.segments.prepareSegment(a,this.layoutVertexArray,this.indexArray),u=l.vertexLength,c=[],f=[],h=0,p=i;h<p.length;h+=1){var d=p[h];if(0!==d.length){d!==i[0]&&f.push(c.length/2);var v=this.segments2.prepareSegment(d.length,this.layoutVertexArray,this.indexArray2),m=v.vertexLength;this.layoutVertexArray.emplaceBack(d[0].x,d[0].y),this.indexArray2.emplaceBack(m+d.length-1,m),c.push(d[0].x),c.push(d[0].y);for(var g=1;g<d.length;g++)this.layoutVertexArray.emplaceBack(d[g].x,d[g].y),this.indexArray2.emplaceBack(m+g-1,m+g),c.push(d[g].x),c.push(d[g].y);v.vertexLength+=d.length,v.primitiveLength+=d.length}}for(var y=yi(c,f),_=0;_<y.length;_+=3)this.indexArray.emplaceBack(u+y[_],u+y[_+1],u+y[_+2]);l.vertexLength+=a,l.primitiveLength+=y.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e)},pr("FillBucket",Yi,{omit:["layers"]});var Ji={paint:new Ur({"fill-antialias":new Nr(P.paint_fill["fill-antialias"]),"fill-opacity":new jr(P.paint_fill["fill-opacity"]),"fill-color":new jr(P.paint_fill["fill-color"]),"fill-outline-color":new jr(P.paint_fill["fill-outline-color"]),"fill-translate":new Nr(P.paint_fill["fill-translate"]),"fill-translate-anchor":new Nr(P.paint_fill["fill-translate-anchor"]),"fill-pattern":new Vr(P.paint_fill["fill-pattern"])})},Ki=function(e){function t(t){e.call(this,t,Ji)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.recalculate=function(e){this.paint=this._transitioningPaint.possiblyEvaluate(e);var t=this.paint._values["fill-outline-color"];"constant"===t.value.kind&&void 0===t.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(e){return new Yi(e)},t.prototype.queryRadius=function(){return Kn(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(e,t,r,n,i,a){return qn(Qn(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),i.angle,a),r)},t}(Zr),Qi=Wr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,ea=Math.pow(2,13);function ta(e,t,r,n,i,a,o,s){e.emplaceBack(t,r,2*Math.floor(n*ea)+o,i*ea*2,a*ea*2,Math.round(s))}var ra=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.layoutVertexArray=new Kr,this.indexArray=new fn,this.programConfigurations=new Pn(Qi,e.layers,e.zoom),this.segments=new Mn};function na(e,t){return e.x===t.x&&(e.x<0||e.x>On)||e.y===t.y&&(e.y<0||e.y>On)}function ia(e){return e.every(function(e){return e.x<0})||e.every(function(e){return e.x>On})||e.every(function(e){return e.y<0})||e.every(function(e){return e.y>On})}ra.prototype.populate=function(e,t){for(var r=0,n=e;r<n.length;r+=1){var i=n[r],a=i.feature,o=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Er(this.zoom),a)){var l=Bn(a);this.addFeature(a,l),t.featureIndex.insert(a,l,o,s,this.index)}}},ra.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ra.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Qi),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.programConfigurations.upload(e)},ra.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ra.prototype.addFeature=function(e,t){for(var r=0,n=Wi(t,500);r<n.length;r+=1){for(var i=n[r],a=0,o=0,s=i;o<s.length;o+=1){a+=s[o].length}for(var l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),u=0,c=i;u<c.length;u+=1){var f=c[u];if(0!==f.length&&!ia(f))for(var h=0,p=0;p<f.length;p++){var d=f[p];if(p>=1){var v=f[p-1];if(!na(d,v)){l.vertexLength+4>Mn.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var m=d.sub(v)._perp()._unit(),g=v.dist(d);h+g>32768&&(h=0),ta(this.layoutVertexArray,d.x,d.y,m.x,m.y,0,0,h),ta(this.layoutVertexArray,d.x,d.y,m.x,m.y,0,1,h),h+=g,ta(this.layoutVertexArray,v.x,v.y,m.x,m.y,0,0,h),ta(this.layoutVertexArray,v.x,v.y,m.x,m.y,0,1,h);var y=l.vertexLength;this.indexArray.emplaceBack(y,y+1,y+2),this.indexArray.emplaceBack(y+1,y+2,y+3),l.vertexLength+=4,l.primitiveLength+=2}}}}l.vertexLength+a>Mn.MAX_VERTEX_ARRAY_LENGTH&&(l=this.segments.prepareSegment(a,this.layoutVertexArray,this.indexArray));for(var _=[],x=[],b=l.vertexLength,w=0,k=i;w<k.length;w+=1){var A=k[w];if(0!==A.length){A!==i[0]&&x.push(_.length/2);for(var T=0;T<A.length;T++){var M=A[T];ta(this.layoutVertexArray,M.x,M.y,0,0,1,1,0),_.push(M.x),_.push(M.y)}}}for(var S=yi(_,x),C=0;C<S.length;C+=3)this.indexArray.emplaceBack(b+S[C],b+S[C+1],b+S[C+2]);l.primitiveLength+=S.length/3,l.vertexLength+=a}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e)},pr("FillExtrusionBucket",ra,{omit:["layers"]});var aa={paint:new Ur({"fill-extrusion-opacity":new Nr(P["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jr(P["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Nr(P["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Nr(P["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Vr(P["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jr(P["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jr(P["paint_fill-extrusion"]["fill-extrusion-base"])})},oa=function(e){function t(t){e.call(this,t,aa)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.createBucket=function(e){return new ra(e)},t.prototype.queryRadius=function(){return Kn(this.paint.get("fill-extrusion-translate"))},t.prototype.queryIntersectsFeature=function(e,t,r,n,i,a){return qn(Qn(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),i.angle,a),r)},t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("fill-extrusion-opacity")&&"none"!==this.visibility},t.prototype.resize=function(){this.viewportFrame&&(this.viewportFrame.destroy(),this.viewportFrame=null)},t}(Zr),sa=Wr([{name:"a_pos_normal",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,la=ua;function ua(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(ca,this,t)}function ca(e,t,r){1==e?t.id=r.readVarint():2==e?function(e,t){var r=e.readVarint()+e.pos;for(;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function fa(e){for(var t,r,n=0,i=0,a=e.length,o=a-1;i<a;o=i++)t=e[i],n+=((r=e[o]).x-t.x)*(t.y+r.y);return n}ua.types=["Unknown","Point","LineString","Polygon"],ua.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,n=1,i=0,a=0,o=0,s=[];e.pos<r;){if(i<=0){var u=e.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)a+=e.readSVarint(),o+=e.readSVarint(),1===n&&(t&&s.push(t),t=[]),t.push(new l(a,o));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&s.push(t),s},ua.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,a=0,o=1/0,s=-1/0,l=1/0,u=-1/0;e.pos<t;){if(n<=0){var c=e.readVarint();r=7&c,n=c>>3}if(n--,1===r||2===r)(i+=e.readSVarint())<o&&(o=i),i>s&&(s=i),(a+=e.readSVarint())<l&&(l=a),a>u&&(u=a);else if(7!==r)throw new Error("unknown command "+r)}return[o,l,s,u]},ua.prototype.toGeoJSON=function(e,t,r){var n,i,a=this.extent*Math.pow(2,r),o=this.extent*e,s=this.extent*t,l=this.loadGeometry(),u=ua.types[this.type];function c(e){for(var t=0;t<e.length;t++){var r=e[t],n=180-360*(r.y+s)/a;e[t]=[360*(r.x+o)/a-180,360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90]}}switch(this.type){case 1:var f=[];for(n=0;n<l.length;n++)f[n]=l[n][0];c(l=f);break;case 2:for(n=0;n<l.length;n++)c(l[n]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var r,n,i=[],a=0;a<t;a++){var o=fa(e[a]);0!==o&&(void 0===n&&(n=o<0),n===o<0?(r&&i.push(r),r=[e[a]]):r.push(e[a]))}r&&i.push(r);return i}(l),n=0;n<l.length;n++)for(i=0;i<l[n].length;i++)c(l[n][i])}1===l.length?l=l[0]:u="Multi"+u;var h={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(h.id=this.id),h};var ha=pa;function pa(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(da,this,t),this.length=this._features.length}function da(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){var t=null,r=e.readVarint()+e.pos;for(;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}function va(e,t,r){if(3===e){var n=new ha(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}pa.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new la(this._pbf,t,this.extent,this._keys,this._values)};var ma={VectorTile:function(e,t){this.layers=e.readFields(va,{},t)},VectorTileFeature:la,VectorTileLayer:ha},ga=ma.VectorTileFeature.types,ya=63,_a=Math.cos(Math.PI/180*37.5),xa=.5,ba=Math.pow(2,14)/xa;function wa(e,t,r,n,i,a,o){e.emplaceBack(t.x,t.y,n?1:0,i?1:-1,Math.round(ya*r.x)+128,Math.round(ya*r.y)+128,1+(0===a?0:a<0?-1:1)|(o*xa&63)<<2,o*xa>>6)}var ka=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.layoutVertexArray=new Qr,this.indexArray=new fn,this.programConfigurations=new Pn(sa,e.layers,e.zoom),this.segments=new Mn};function Aa(e,t){return(e/t.tileTotal*(t.end-t.start)+t.start)*(ba-1)}ka.prototype.populate=function(e,t){for(var r=0,n=e;r<n.length;r+=1){var i=n[r],a=i.feature,o=i.index,s=i.sourceLayerIndex;if(this.layers[0]._featureFilter(new Er(this.zoom),a)){var l=Bn(a);this.addFeature(a,l),t.featureIndex.insert(a,l,o,s,this.index)}}},ka.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ka.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sa),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.programConfigurations.upload(e)},ka.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ka.prototype.addFeature=function(e,t){for(var r=this.layers[0].layout,n=r.get("line-join").evaluate(e),i=r.get("line-cap"),a=r.get("line-miter-limit"),o=r.get("line-round-limit"),s=0,l=t;s<l.length;s+=1){var u=l[s];this.addLine(u,e,n,i,a,o)}},ka.prototype.addLine=function(e,t,r,n,i,a){var o=null;t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end")&&(o={start:t.properties.mapbox_clip_start,end:t.properties.mapbox_clip_end,tileTotal:void 0});for(var s="Polygon"===ga[t.type],l=e.length;l>=2&&e[l-1].equals(e[l-2]);)l--;for(var u=0;u<l-1&&e[u].equals(e[u+1]);)u++;if(!(l<(s?3:2))){o&&(o.tileTotal=function(e,t,r){for(var n,i,a=0,o=t;o<r-1;o++)n=e[o],i=e[o+1],a+=n.dist(i);return a}(e,u,l)),"bevel"===r&&(i=1.05);var c=On/(512*this.overscaling)*15,f=e[u],h=this.segments.prepareSegment(10*l,this.layoutVertexArray,this.indexArray);this.distance=0;var p,d,v,m=n,g=s?"butt":n,y=!0,_=void 0,x=void 0,b=void 0,w=void 0;this.e1=this.e2=this.e3=-1,s&&(p=e[l-2],w=f.sub(p)._unit()._perp());for(var k=u;k<l;k++)if(!(x=s&&k===l-1?e[u+1]:e[k+1])||!e[k].equals(x)){w&&(b=w),p&&(_=p),p=e[k],w=x?x.sub(p)._unit()._perp():b;var A=(b=b||w).add(w);0===A.x&&0===A.y||A._unit();var T=A.x*w.x+A.y*w.y,M=0!==T?1/T:1/0,S=T<_a&&_&&x;if(S&&k>u){var C=p.dist(_);if(C>2*c){var z=p.sub(p.sub(_)._mult(c/C)._round());this.distance+=z.dist(_),this.addCurrentVertex(z,this.distance,b.mult(1),0,0,!1,h,o),_=z}}var E=_&&x,L=E?r:x?m:g;if(E&&"round"===L&&(M<a?L="miter":M<=2&&(L="fakeround")),"miter"===L&&M>i&&(L="bevel"),"bevel"===L&&(M>2&&(L="flipbevel"),M<i&&(L="miter")),_&&(this.distance+=p.dist(_)),"miter"===L)A._mult(M),this.addCurrentVertex(p,this.distance,A,0,0,!1,h,o);else if("flipbevel"===L){if(M>100)A=w.clone().mult(-1);else{var I=b.x*w.y-b.y*w.x>0?-1:1,P=M*b.add(w).mag()/b.sub(w).mag();A._perp()._mult(P*I)}this.addCurrentVertex(p,this.distance,A,0,0,!1,h,o),this.addCurrentVertex(p,this.distance,A.mult(-1),0,0,!1,h,o)}else if("bevel"===L||"fakeround"===L){var D=b.x*w.y-b.y*w.x>0,O=-Math.sqrt(M*M-1);if(D?(v=0,d=O):(d=0,v=O),y||this.addCurrentVertex(p,this.distance,b,d,v,!1,h,o),"fakeround"===L){for(var R=Math.floor(8*(.5-(T-.5))),F=void 0,B=0;B<R;B++)F=w.mult((B+1)/(R+1))._add(b)._unit(),this.addPieSliceVertex(p,this.distance,F,D,h,o);this.addPieSliceVertex(p,this.distance,A,D,h,o);for(var N=R-1;N>=0;N--)F=b.mult((N+1)/(R+1))._add(w)._unit(),this.addPieSliceVertex(p,this.distance,F,D,h,o)}x&&this.addCurrentVertex(p,this.distance,w,-d,-v,!1,h,o)}else"butt"===L?(y||this.addCurrentVertex(p,this.distance,b,0,0,!1,h,o),x&&this.addCurrentVertex(p,this.distance,w,0,0,!1,h,o)):"square"===L?(y||(this.addCurrentVertex(p,this.distance,b,1,1,!1,h,o),this.e1=this.e2=-1),x&&this.addCurrentVertex(p,this.distance,w,-1,-1,!1,h,o)):"round"===L&&(y||(this.addCurrentVertex(p,this.distance,b,0,0,!1,h,o),this.addCurrentVertex(p,this.distance,b,1,1,!0,h,o),this.e1=this.e2=-1),x&&(this.addCurrentVertex(p,this.distance,w,-1,-1,!0,h,o),this.addCurrentVertex(p,this.distance,w,0,0,!1,h,o)));if(S&&k<l-1){var j=p.dist(x);if(j>2*c){var V=p.add(x.sub(p)._mult(c/j)._round());this.distance+=V.dist(p),this.addCurrentVertex(V,this.distance,w.mult(1),0,0,!1,h,o),p=V}}y=!1}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t)}},ka.prototype.addCurrentVertex=function(e,t,r,n,i,a,o,s){var l,u=this.layoutVertexArray,c=this.indexArray;s&&(t=Aa(t,s)),l=r.clone(),n&&l._sub(r.perp()._mult(n)),wa(u,e,l,a,!1,n,t),this.e3=o.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),o.primitiveLength++),this.e1=this.e2,this.e2=this.e3,l=r.mult(-1),i&&l._sub(r.perp()._mult(i)),wa(u,e,l,a,!0,-i,t),this.e3=o.vertexLength++,this.e1>=0&&this.e2>=0&&(c.emplaceBack(this.e1,this.e2,this.e3),o.primitiveLength++),this.e1=this.e2,this.e2=this.e3,t>ba/2&&!s&&(this.distance=0,this.addCurrentVertex(e,this.distance,r,n,i,a,o))},ka.prototype.addPieSliceVertex=function(e,t,r,n,i,a){r=r.mult(n?-1:1);var o=this.layoutVertexArray,s=this.indexArray;a&&(t=Aa(t,a)),wa(o,e,r,!1,n,0,t),this.e3=i.vertexLength++,this.e1>=0&&this.e2>=0&&(s.emplaceBack(this.e1,this.e2,this.e3),i.primitiveLength++),n?this.e2=this.e3:this.e1=this.e3},pr("LineBucket",ka,{omit:["layers"]});var Ta=new Ur({"line-cap":new Nr(P.layout_line["line-cap"]),"line-join":new jr(P.layout_line["line-join"]),"line-miter-limit":new Nr(P.layout_line["line-miter-limit"]),"line-round-limit":new Nr(P.layout_line["line-round-limit"])}),Ma={paint:new Ur({"line-opacity":new jr(P.paint_line["line-opacity"]),"line-color":new jr(P.paint_line["line-color"]),"line-translate":new Nr(P.paint_line["line-translate"]),"line-translate-anchor":new Nr(P.paint_line["line-translate-anchor"]),"line-width":new jr(P.paint_line["line-width"]),"line-gap-width":new jr(P.paint_line["line-gap-width"]),"line-offset":new jr(P.paint_line["line-offset"]),"line-blur":new jr(P.paint_line["line-blur"]),"line-dasharray":new Vr(P.paint_line["line-dasharray"]),"line-pattern":new Vr(P.paint_line["line-pattern"]),"line-gradient":new qr(P.paint_line["line-gradient"])}),layout:Ta},Sa=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.possiblyEvaluate=function(t,r){return r=new Er(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),e.prototype.possiblyEvaluate.call(this,t,r)},t.prototype.evaluate=function(t,r,n){return r=p({},r,{zoom:Math.floor(r.zoom)}),e.prototype.evaluate.call(this,t,r,n)},t}(jr))(Ma.paint.properties["line-width"].specification);Sa.useIntegerZoom=!0;var Ca=function(e){function t(t){e.call(this,t,Ma)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.setPaintProperty=function(t,r,n){e.prototype.setPaintProperty.call(this,t,r,n),"line-gradient"===t&&this._updateGradient()},t.prototype._updateGradient=function(){var e=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=pi(e,"lineProgress"),this.gradientTexture=null},t.prototype.recalculate=function(t){e.prototype.recalculate.call(this,t),this.paint._values["line-floorwidth"]=Sa.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)},t.prototype.createBucket=function(e){return new ka(e)},t.prototype.queryRadius=function(e){var t=e,r=za(Jn("line-width",this,t),Jn("line-gap-width",this,t)),n=Jn("line-offset",this,t);return r/2+Math.abs(n)+Kn(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(e,t,r,n,i,a){var o=Qn(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),i.angle,a),s=a/2*za(this.paint.get("line-width").evaluate(t),this.paint.get("line-gap-width").evaluate(t)),u=this.paint.get("line-offset").evaluate(t);return u&&(r=function(e,t){for(var r=[],n=new l(0,0),i=0;i<e.length;i++){for(var a=e[i],o=[],s=0;s<a.length;s++){var u=a[s-1],c=a[s],f=a[s+1],h=0===s?n:c.sub(u)._unit()._perp(),p=s===a.length-1?n:f.sub(c)._unit()._perp(),d=h._add(p)._unit(),v=d.x*p.x+d.y*p.y;d._mult(1/v),o.push(d._mult(t)._add(c))}r.push(o)}return r}(r,u*a)),Un(o,r,s)},t}(Zr);function za(e,t){return t>0?t+2*e:e}var Ea=Wr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"}]),La=Wr([{name:"a_projected_pos",components:3,type:"Float32"}],4),Ia=(Wr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Wr([{name:"a_placed",components:2,type:"Uint8"}],4)),Pa=(Wr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"},{type:"Int16",name:"radius"},{type:"Int16",name:"signedDistanceFromAnchor"}]),Wr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Da=Wr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4);Wr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"hidden"}]),Wr([{type:"Float32",name:"offsetX"}]),Wr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function Oa(e,t,r){var n=t.layout.get("text-transform").evaluate(r);return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),zr.applyArabicShaping&&(e=zr.applyArabicShaping(e)),e}var Ra={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var Fa=function(e){function t(t,r,n,i){e.call(this,t,r),this.angle=n,void 0!==i&&(this.segment=i)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(l);function Ba(e,t){var r=t.expression;if("constant"===r.kind)return{functionType:"constant",layoutSize:r.evaluate(new Er(e+1))};if("source"===r.kind)return{functionType:"source"};for(var n=r.zoomStops,i=0;i<n.length&&n[i]<=e;)i++;for(var a=i=Math.max(0,i-1);a<n.length&&n[a]<e+1;)a++;a=Math.min(n.length-1,a);var o={min:n[i],max:n[a]};return"composite"===r.kind?{functionType:"composite",zoomRange:o,propertyValue:t.value}:{functionType:"camera",layoutSize:r.evaluate(new Er(e+1)),zoomRange:o,sizeRange:{min:r.evaluate(new Er(o.min)),max:r.evaluate(new Er(o.max))},propertyValue:t.value}}pr("Anchor",Fa);var Na=ma.VectorTileFeature.types,ja=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Va(e,t,r,n,i,a,o,s){e.emplaceBack(t,r,Math.round(32*n),Math.round(32*i),a,o,s?s[0]:0,s?s[1]:0)}function qa(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}var Ua=function(e){this.layoutVertexArray=new en,this.indexArray=new fn,this.programConfigurations=e,this.segments=new Mn,this.dynamicLayoutVertexArray=new tn,this.opacityVertexArray=new rn,this.placedSymbolArray=new yn};Ua.prototype.upload=function(e,t){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ea.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.programConfigurations.upload(e),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,La.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ja,!0),this.opacityVertexBuffer.itemSize=1},Ua.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},pr("SymbolBuffers",Ua);var Za=function(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new Mn,this.collisionVertexArray=new on};Za.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Ia.members,!0)},Za.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},pr("CollisionBuffers",Za);var Ha=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex;var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ba(this.zoom,t["text-size"]),this.iconSizeData=Ba(this.zoom,t["icon-size"]);var r=this.layers[0].layout;this.sortFeaturesByY=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement")};Ha.prototype.createArrays=function(){this.text=new Ua(new Pn(Ea.members,this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new Ua(new Pn(Ea.members,this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.collisionBox=new Za(an,Pa.members,hn),this.collisionCircle=new Za(an,Da.members,fn),this.glyphOffsetArray=new xn,this.lineVertexArray=new wn},Ha.prototype.populate=function(e,t){var r=this.layers[0],n=r.layout,i=n.get("text-font"),a=n.get("text-field"),o=n.get("icon-image"),s=("constant"!==a.value.kind||a.value.value.length>0)&&("constant"!==i.value.kind||i.value.value.length>0),l="constant"!==o.value.kind||o.value.value&&o.value.value.length>0;if(this.features=[],s||l){for(var u=t.iconDependencies,c=t.glyphDependencies,f=new Er(this.zoom),h=0,p=e;h<p.length;h+=1){var d=p[h],v=d.feature,m=d.index,g=d.sourceLayerIndex;if(r._featureFilter(f,v)){var y=void 0;s&&(y=Oa(y=r.getValueAndResolveTokens("text-field",v),r,v));var _=void 0;if(l&&(_=r.getValueAndResolveTokens("icon-image",v)),y||_){var x={text:y,icon:_,index:m,sourceLayerIndex:g,geometry:Bn(v),properties:v.properties,type:Na[v.type]};if(void 0!==v.id&&(x.id=v.id),this.features.push(x),_&&(u[_]=!0),y)for(var b=i.evaluate(v).join(","),w=c[b]=c[b]||{},k="map"===n.get("text-rotation-alignment")&&"line"===n.get("symbol-placement"),A=_r(y),T=0;T<y.length;T++)if(w[y.charCodeAt(T)]=!0,k&&A){var M=Ra[y.charAt(T)];M&&(w[M.charCodeAt(0)]=!0)}}}}"line"===n.get("symbol-placement")&&(this.features=function(e){var t={},r={},n=[],i=0;function a(t){n.push(e[t]),i++}function o(e,t,i){var a=r[e];return delete r[e],r[t]=a,n[a].geometry[0].pop(),n[a].geometry[0]=n[a].geometry[0].concat(i[0]),a}function s(e,r,i){var a=t[r];return delete t[r],t[e]=a,n[a].geometry[0].shift(),n[a].geometry[0]=i[0].concat(n[a].geometry[0]),a}function l(e,t,r){var n=r?t[0][t[0].length-1]:t[0][0];return e+":"+n.x+":"+n.y}for(var u=0;u<e.length;u++){var c=e[u],f=c.geometry,h=c.text;if(h){var p=l(h,f),d=l(h,f,!0);if(p in r&&d in t&&r[p]!==t[d]){var v=s(p,d,f),m=o(p,d,n[v].geometry);delete t[p],delete r[d],r[l(h,n[m].geometry,!0)]=m,n[v].geometry=null}else p in r?o(p,d,f):d in t?s(p,d,f):(a(u),t[p]=i-1,r[d]=i-1)}else a(u)}return n.filter(function(e){return e.geometry})}(this.features))}},Ha.prototype.isEmpty=function(){return 0===this.symbolInstances.length},Ha.prototype.upload=function(e){this.text.upload(e,this.sortFeaturesByY),this.icon.upload(e,this.sortFeaturesByY),this.collisionBox.upload(e),this.collisionCircle.upload(e)},Ha.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.collisionBox.destroy(),this.collisionCircle.destroy()},Ha.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(void 0!==e.segment){for(var n=e.dist(t[e.segment+1]),i=e.dist(t[e.segment]),a={},o=e.segment+1;o<t.length;o++)a[o]={x:t[o].x,y:t[o].y,tileUnitDistanceFromAnchor:n},o<t.length-1&&(n+=t[o+1].dist(t[o]));for(var s=e.segment||0;s>=0;s--)a[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:i},s>0&&(i+=t[s-1].dist(t[s]));for(var l=0;l<t.length;l++){var u=a[l];this.lineVertexArray.emplaceBack(u.x,u.y,u.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},Ha.prototype.addSymbols=function(e,t,r,n,i,a,o,s,l,u){for(var c=e.indexArray,f=e.layoutVertexArray,h=e.dynamicLayoutVertexArray,p=e.segments.prepareSegment(4*t.length,e.layoutVertexArray,e.indexArray),d=this.glyphOffsetArray.length,v=p.vertexLength,m=0,g=t;m<g.length;m+=1){var y=g[m],_=y.tl,x=y.tr,b=y.bl,w=y.br,k=y.tex,A=p.vertexLength,T=y.glyphOffset[1];Va(f,s.x,s.y,_.x,T+_.y,k.x,k.y,r),Va(f,s.x,s.y,x.x,T+x.y,k.x+k.w,k.y,r),Va(f,s.x,s.y,b.x,T+b.y,k.x,k.y+k.h,r),Va(f,s.x,s.y,w.x,T+w.y,k.x+k.w,k.y+k.h,r),qa(h,s,0),c.emplaceBack(A,A+1,A+2),c.emplaceBack(A+1,A+2,A+3),p.vertexLength+=4,p.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(y.glyphOffset[0])}e.placedSymbolArray.emplaceBack(s.x,s.y,d,this.glyphOffsetArray.length-d,v,l,u,s.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],o,!1),e.programConfigurations.populatePaintArrays(e.layoutVertexArray.length,a)},Ha.prototype._addCollisionDebugVertex=function(e,t,r,n,i){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,n.x,n.y,Math.round(i.x),Math.round(i.y))},Ha.prototype.addCollisionDebugVertices=function(e,t,r,n,i,a,o,s){var u=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),c=u.vertexLength,f=i.layoutVertexArray,h=i.collisionVertexArray;if(this._addCollisionDebugVertex(f,h,a,o.anchor,new l(e,t)),this._addCollisionDebugVertex(f,h,a,o.anchor,new l(r,t)),this._addCollisionDebugVertex(f,h,a,o.anchor,new l(r,n)),this._addCollisionDebugVertex(f,h,a,o.anchor,new l(e,n)),u.vertexLength+=4,s){var p=i.indexArray;p.emplaceBack(c,c+1,c+2),p.emplaceBack(c,c+2,c+3),u.primitiveLength+=2}else{var d=i.indexArray;d.emplaceBack(c,c+1),d.emplaceBack(c+1,c+2),d.emplaceBack(c+2,c+3),d.emplaceBack(c+3,c),u.primitiveLength+=4}},Ha.prototype.generateCollisionDebugBuffers=function(){for(var e=0,t=this.symbolInstances;e<t.length;e+=1){var r=t[e];r.textCollisionFeature={boxStartIndex:r.textBoxStartIndex,boxEndIndex:r.textBoxEndIndex},r.iconCollisionFeature={boxStartIndex:r.iconBoxStartIndex,boxEndIndex:r.iconBoxEndIndex};for(var n=0;n<2;n++){var i=r[0===n?"textCollisionFeature":"iconCollisionFeature"];if(i)for(var a=i.boxStartIndex;a<i.boxEndIndex;a++){var o=this.collisionBoxArray.get(a),s=o.x1,l=o.y1,u=o.x2,c=o.y2,f=o.radius>0;this.addCollisionDebugVertices(s,l,u,c,f?this.collisionCircle:this.collisionBox,o.anchorPoint,r,f)}}}},Ha.prototype.deserializeCollisionBoxes=function(e,t,r,n,i){for(var a={},o=t;o<r;o++){var s=e.get(o);if(0===s.radius){a.textBox={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2,anchorPointX:s.anchorPointX,anchorPointY:s.anchorPointY},a.textFeatureIndex=s.featureIndex;break}a.textCircles||(a.textCircles=[],a.textFeatureIndex=s.featureIndex);a.textCircles.push(s.anchorPointX,s.anchorPointY,s.radius,s.signedDistanceFromAnchor,1)}for(var l=n;l<i;l++){var u=e.get(l);if(0===u.radius){a.iconBox={x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,anchorPointX:u.anchorPointX,anchorPointY:u.anchorPointY},a.iconFeatureIndex=u.featureIndex;break}}return a},Ha.prototype.hasTextData=function(){return this.text.segments.get().length>0},Ha.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Ha.prototype.hasCollisionBoxData=function(){return this.collisionBox.segments.get().length>0},Ha.prototype.hasCollisionCircleData=function(){return this.collisionCircle.segments.get().length>0},Ha.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&(this.sortedAngle=e,!(this.text.segments.get().length>1||this.icon.segments.get().length>1))){for(var r=[],n=0;n<this.symbolInstances.length;n++)r.push(n);var i=Math.sin(e),a=Math.cos(e);r.sort(function(e,r){var n=t.symbolInstances[e],o=t.symbolInstances[r];return(i*n.anchor.x+a*n.anchor.y|0)-(i*o.anchor.x+a*o.anchor.y|0)||o.featureIndex-n.featureIndex}),this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var o=0,s=r;o<s.length;o+=1){var l=s[o],u=t.symbolInstances[l];t.featureSortOrder.push(u.featureIndex);for(var c=0,f=u.placedTextSymbolIndices;c<f.length;c+=1)for(var h=f[c],p=t.text.placedSymbolArray.get(h),d=p.vertexStartIndex+4*p.numGlyphs,v=p.vertexStartIndex;v<d;v+=4)t.text.indexArray.emplaceBack(v,v+1,v+2),t.text.indexArray.emplaceBack(v+1,v+2,v+3);var m=t.icon.placedSymbolArray.get(l);if(m.numGlyphs){var g=m.vertexStartIndex;t.icon.indexArray.emplaceBack(g,g+1,g+2),t.icon.indexArray.emplaceBack(g+1,g+2,g+3)}}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},pr("SymbolBucket",Ha,{omit:["layers","collisionBoxArray","features","compareText"],shallow:["symbolInstances"]}),Ha.MAX_GLYPHS=65535,Ha.addDynamicAttributes=qa;var Ga=new Ur({"symbol-placement":new Nr(P.layout_symbol["symbol-placement"]),"symbol-spacing":new Nr(P.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Nr(P.layout_symbol["symbol-avoid-edges"]),"icon-allow-overlap":new Nr(P.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Nr(P.layout_symbol["icon-ignore-placement"]),"icon-optional":new Nr(P.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Nr(P.layout_symbol["icon-rotation-alignment"]),"icon-size":new jr(P.layout_symbol["icon-size"]),"icon-text-fit":new Nr(P.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Nr(P.layout_symbol["icon-text-fit-padding"]),"icon-image":new jr(P.layout_symbol["icon-image"]),"icon-rotate":new jr(P.layout_symbol["icon-rotate"]),"icon-padding":new Nr(P.layout_symbol["icon-padding"]),"icon-keep-upright":new Nr(P.layout_symbol["icon-keep-upright"]),"icon-offset":new jr(P.layout_symbol["icon-offset"]),"icon-anchor":new jr(P.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Nr(P.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Nr(P.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Nr(P.layout_symbol["text-rotation-alignment"]),"text-field":new jr(P.layout_symbol["text-field"]),"text-font":new jr(P.layout_symbol["text-font"]),"text-size":new jr(P.layout_symbol["text-size"]),"text-max-width":new jr(P.layout_symbol["text-max-width"]),"text-line-height":new Nr(P.layout_symbol["text-line-height"]),"text-letter-spacing":new jr(P.layout_symbol["text-letter-spacing"]),"text-justify":new jr(P.layout_symbol["text-justify"]),"text-anchor":new jr(P.layout_symbol["text-anchor"]),"text-max-angle":new Nr(P.layout_symbol["text-max-angle"]),"text-rotate":new jr(P.layout_symbol["text-rotate"]),"text-padding":new Nr(P.layout_symbol["text-padding"]),"text-keep-upright":new Nr(P.layout_symbol["text-keep-upright"]),"text-transform":new jr(P.layout_symbol["text-transform"]),"text-offset":new jr(P.layout_symbol["text-offset"]),"text-allow-overlap":new Nr(P.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Nr(P.layout_symbol["text-ignore-placement"]),"text-optional":new Nr(P.layout_symbol["text-optional"])}),$a={paint:new Ur({"icon-opacity":new jr(P.paint_symbol["icon-opacity"]),"icon-color":new jr(P.paint_symbol["icon-color"]),"icon-halo-color":new jr(P.paint_symbol["icon-halo-color"]),"icon-halo-width":new jr(P.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jr(P.paint_symbol["icon-halo-blur"]),"icon-translate":new Nr(P.paint_symbol["icon-translate"]),"icon-translate-anchor":new Nr(P.paint_symbol["icon-translate-anchor"]),"text-opacity":new jr(P.paint_symbol["text-opacity"]),"text-color":new jr(P.paint_symbol["text-color"]),"text-halo-color":new jr(P.paint_symbol["text-halo-color"]),"text-halo-width":new jr(P.paint_symbol["text-halo-width"]),"text-halo-blur":new jr(P.paint_symbol["text-halo-blur"]),"text-translate":new Nr(P.paint_symbol["text-translate"]),"text-translate-anchor":new Nr(P.paint_symbol["text-translate-anchor"])}),layout:Ga},Wa=function(e){function t(t){e.call(this,t,$a)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.recalculate=function(t){e.prototype.recalculate.call(this,t),"auto"===this.layout.get("icon-rotation-alignment")&&("line"===this.layout.get("symbol-placement")?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-rotation-alignment")&&("line"===this.layout.get("symbol-placement")?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"))},t.prototype.getValueAndResolveTokens=function(e,t){var r,n=this.layout.get(e).evaluate(t),i=this._unevaluatedLayout._values[e];return i.isDataDriven()||bt(i.value)?n:(r=t.properties,n.replace(/{([^{}]+)}/g,function(e,t){return t in r?String(r[t]):""}))},t.prototype.createBucket=function(e){return new Ha(e)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t}(Zr),Xa={paint:new Ur({"background-color":new Nr(P.paint_background["background-color"]),"background-pattern":new Vr(P.paint_background["background-pattern"]),"background-opacity":new Nr(P.paint_background["background-opacity"])})},Ya=function(e){function t(t){e.call(this,t,Xa)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Zr),Ja={paint:new Ur({"raster-opacity":new Nr(P.paint_raster["raster-opacity"]),"raster-hue-rotate":new Nr(P.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Nr(P.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Nr(P.paint_raster["raster-brightness-max"]),"raster-saturation":new Nr(P.paint_raster["raster-saturation"]),"raster-contrast":new Nr(P.paint_raster["raster-contrast"]),"raster-fade-duration":new Nr(P.paint_raster["raster-fade-duration"])})},Ka={circle:ii,heatmap:di,hillshade:mi,fill:Ki,"fill-extrusion":oa,line:Ca,symbol:Wa,background:Ya,raster:function(e){function t(t){e.call(this,t,Ja)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Zr)};var Qa=i(function(e,t){e.exports=function(){function e(e,t,r){r=r||{},this.w=e||64,this.h=t||64,this.autoResize=!!r.autoResize,this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0}function t(e,t,r){this.x=0,this.y=e,this.w=this.free=t,this.h=r}return e.prototype.pack=function(e,t){e=[].concat(e),t=t||{};for(var r,n,i,a,o=[],s=0;s<e.length;s++)if(r=e[s].w||e[s].width,n=e[s].h||e[s].height,i=e[s].id,r&&n){if(!(a=this.packOne(r,n,i)))continue;t.inPlace&&(e[s].x=a.x,e[s].y=a.y,e[s].id=a.id),o.push(a)}return this.shrink(),o},e.prototype.packOne=function(e,r,n){var i,a,o,s,l,u,c,f,h={freebin:-1,shelf:-1,waste:1/0},p=0;if("string"==typeof n||"number"==typeof n){if(i=this.getBin(n))return this.ref(i),i;"number"==typeof n&&(this.maxId=Math.max(n,this.maxId))}else n=++this.maxId;for(s=0;s<this.freebins.length;s++){if(r===(i=this.freebins[s]).maxh&&e===i.maxw)return this.allocFreebin(s,e,r,n);r>i.maxh||e>i.maxw||r<=i.maxh&&e<=i.maxw&&(o=i.maxw*i.maxh-e*r)<h.waste&&(h.waste=o,h.freebin=s)}for(s=0;s<this.shelves.length;s++)if(p+=(a=this.shelves[s]).h,!(e>a.free)){if(r===a.h)return this.allocShelf(s,e,r,n);r>a.h||r<a.h&&(o=(a.h-r)*e)<h.waste&&(h.freebin=-1,h.waste=o,h.shelf=s)}return-1!==h.freebin?this.allocFreebin(h.freebin,e,r,n):-1!==h.shelf?this.allocShelf(h.shelf,e,r,n):r<=this.h-p&&e<=this.w?(a=new t(p,this.w,r),this.allocShelf(this.shelves.push(a)-1,e,r,n)):this.autoResize?(l=u=this.h,((c=f=this.w)<=l||e>c)&&(f=2*Math.max(e,c)),(l<c||r>l)&&(u=2*Math.max(r,l)),this.resize(f,u),this.packOne(e,r,n)):null},e.prototype.allocFreebin=function(e,t,r,n){var i=this.freebins.splice(e,1)[0];return i.id=n,i.w=t,i.h=r,i.refcount=0,this.bins[n]=i,this.ref(i),i},e.prototype.allocShelf=function(e,t,r,n){var i=this.shelves[e].alloc(t,r,n);return this.bins[n]=i,this.ref(i),i},e.prototype.shrink=function(){if(this.shelves.length>0){for(var e=0,t=0,r=0;r<this.shelves.length;r++){var n=this.shelves[r];t+=n.h,e=Math.max(n.w-n.free,e)}this.resize(e,t)}},e.prototype.getBin=function(e){return this.bins[e]},e.prototype.ref=function(e){if(1==++e.refcount){var t=e.h;this.stats[t]=1+(0|this.stats[t])}return e.refcount},e.prototype.unref=function(e){return 0===e.refcount?0:(0==--e.refcount&&(this.stats[e.h]--,delete this.bins[e.id],this.freebins.push(e)),e.refcount)},e.prototype.clear=function(){this.shelves=[],this.freebins=[],this.stats={},this.bins={},this.maxId=0},e.prototype.resize=function(e,t){this.w=e,this.h=t;for(var r=0;r<this.shelves.length;r++)this.shelves[r].resize(e);return!0},t.prototype.alloc=function(e,t,r){if(e>this.free||t>this.h)return null;var n=this.x;return this.x+=e,this.free-=e,new function(e,t,r,n,i,a,o){this.id=e,this.x=t,this.y=r,this.w=n,this.h=i,this.maxw=a||n,this.maxh=o||i,this.refcount=0}(r,n,this.y,e,t,e,this.h)},t.prototype.resize=function(e){return this.free+=e-this.w,this.w=e,!0},e}()}),eo=function(e,t){var r=t.pixelRatio;this.paddedRect=e,this.pixelRatio=r},to={tl:{configurable:!0},br:{configurable:!0},displaySize:{configurable:!0}};to.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},to.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},to.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(eo.prototype,to);var ro=function(e){var t=new fi({width:0,height:0}),r={},n=new Qa(0,0,{autoResize:!0});for(var i in e){var a=e[i],o=n.packOne(a.data.width+2,a.data.height+2);t.resize({width:n.w,height:n.h}),fi.copy(a.data,t,{x:0,y:0},{x:o.x+1,y:o.y+1},a.data),r[i]=new eo(o,a)}n.shrink(),t.resize({width:n.w,height:n.h}),this.image=t,this.positions=r};pr("ImagePosition",eo),pr("ImageAtlas",ro);var no=function(e,t,r,n,i){var a,o,s=8*i-n-1,l=(1<<s)-1,u=l>>1,c=-7,f=r?i-1:0,h=r?-1:1,p=e[t+f];for(f+=h,a=p&(1<<-c)-1,p>>=-c,c+=s;c>0;a=256*a+e[t+f],f+=h,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=n;c>0;o=256*o+e[t+f],f+=h,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),a-=u}return(p?-1:1)*o*Math.pow(2,a-n)},io=function(e,t,r,n,i,a){var o,s,l,u=8*a-i-1,c=(1<<u)-1,f=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:a-1,d=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+f>=1?h/l:h*Math.pow(2,1-f))*l>=2&&(o++,l/=2),o+f>=c?(s=0,o=c):o+f>=1?(s=(t*l-1)*Math.pow(2,i),o+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;e[r+p]=255&s,p+=d,s/=256,i-=8);for(o=o<<i|s,u+=i;u>0;e[r+p]=255&o,p+=d,o/=256,u-=8);e[r+p-d]|=128*v},ao=oo;function oo(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}oo.Varint=0,oo.Fixed64=1,oo.Bytes=2,oo.Fixed32=5;function so(e){return e.type===oo.Bytes?e.readVarint()+e.pos:e.pos+1}function lo(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function uo(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.ceil(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function co(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function fo(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function ho(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function po(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function vo(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function mo(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function go(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function yo(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function _o(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function xo(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function bo(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function wo(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}oo.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,a=this.pos;this.type=7&n,e(i,t,this),this.pos===a&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=xo(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=wo(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=xo(this.buf,this.pos)+4294967296*xo(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=xo(this.buf,this.pos)+4294967296*wo(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=no(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=no(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:function(e,t,r){var n,i,a=r.buf;if(i=a[r.pos++],n=(112&i)>>4,i<128)return lo(e,n,t);if(i=a[r.pos++],n|=(127&i)<<3,i<128)return lo(e,n,t);if(i=a[r.pos++],n|=(127&i)<<10,i<128)return lo(e,n,t);if(i=a[r.pos++],n|=(127&i)<<17,i<128)return lo(e,n,t);if(i=a[r.pos++],n|=(127&i)<<24,i<128)return lo(e,n,t);if(i=a[r.pos++],n|=(1&i)<<31,i<128)return lo(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=function(e,t,r){var n="",i=t;for(;i<r;){var a,o,s,l=e[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>r)break;1===c?l<128&&(u=l):2===c?128==(192&(a=e[i+1]))&&(u=(31&l)<<6|63&a)<=127&&(u=null):3===c?(a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&((u=(15&l)<<12|(63&a)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&((u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,n+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),n+=String.fromCharCode(u),i+=c}return n}(this.buf,this.pos,e);return this.pos=e,t},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){var r=so(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){var t=so(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){var t=so(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){var t=so(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){var t=so(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){var t=so(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){var t=so(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){var t=so(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){var t=so(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===oo.Varint)for(;this.buf[this.pos++]>127;);else if(t===oo.Bytes)this.pos=this.readVarint()+this.pos;else if(t===oo.Fixed32)this.pos+=4;else{if(t!==oo.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),bo(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),bo(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),bo(this.buf,-1&e,this.pos),bo(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),bo(this.buf,-1&e,this.pos),bo(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var r,n;e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0));if(e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos]=127&e}(r,0,t),function(e,t){var r=(7&e)<<4;if(t.buf[t.pos++]|=r|((e>>>=3)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;if(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),!e)return;t.buf[t.pos++]=127&e}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var n,i,a=0;a<t.length;a++){if((n=t.charCodeAt(a))>55295&&n<57344){if(!i){n>56319||a+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&uo(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),io(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),io(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&uo(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,oo.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){this.writeMessage(e,co,t)},writePackedSVarint:function(e,t){this.writeMessage(e,fo,t)},writePackedBoolean:function(e,t){this.writeMessage(e,vo,t)},writePackedFloat:function(e,t){this.writeMessage(e,ho,t)},writePackedDouble:function(e,t){this.writeMessage(e,po,t)},writePackedFixed32:function(e,t){this.writeMessage(e,mo,t)},writePackedSFixed32:function(e,t){this.writeMessage(e,go,t)},writePackedFixed64:function(e,t){this.writeMessage(e,yo,t)},writePackedSFixed64:function(e,t){this.writeMessage(e,_o,t)},writeBytesField:function(e,t){this.writeTag(e,oo.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,oo.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,oo.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,oo.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,oo.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,oo.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,oo.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,oo.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,oo.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,oo.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var ko=3;function Ao(e,t,r){1===e&&r.readMessage(To,t)}function To(e,t,r){if(3===e){var n=r.readMessage(Mo,{}),i=n.id,a=n.bitmap,o=n.width,s=n.height,l=n.left,u=n.top,c=n.advance;t.push({id:i,bitmap:new ci({width:o+2*ko,height:s+2*ko},a),metrics:{width:o,height:s,left:l,top:u,advance:c}})}}function Mo(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}var So=ko,Co=function(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.callbackID=0,v(["receive"],this),this.target.addEventListener("message",this.receive,!1)};Co.prototype.send=function(e,t,r,n){var i=r?this.mapId+":"+this.callbackID++:null;r&&(this.callbacks[i]=r);var a=[];this.target.postMessage({targetMapId:n,sourceMapId:this.mapId,type:e,id:String(i),data:vr(t,a)},a)},Co.prototype.receive=function(e){var t,r=this,n=e.data,i=n.id;if(!n.targetMapId||this.mapId===n.targetMapId){var a=function(e,t){var n=[];r.target.postMessage({sourceMapId:r.mapId,type:"<response>",id:String(i),error:e?vr(e):null,data:vr(t,n)},n)};if("<response>"===n.type)t=this.callbacks[n.id],delete this.callbacks[n.id],t&&n.error?t(mr(n.error)):t&&t(null,mr(n.data));else if(void 0!==n.id&&this.parent[n.type])this.parent[n.type](n.sourceMapId,mr(n.data),a);else if(void 0!==n.id&&this.parent.getWorkerSource){var o=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,o[0],o[1])[o[2]](mr(n.data),a)}else this.parent[n.type](mr(n.data))}},Co.prototype.remove=function(){this.target.removeEventListener("message",this.receive,!1)};var zo=n(i(function(e,t){!function(e){function t(e,t,n){t=Math.pow(2,n)-t-1;var i=r(256*e,256*t,n),a=r(256*(e+1),256*(t+1),n);return i[0]+","+i[1]+","+a[0]+","+a[1]}function r(e,t,r){var n=2*Math.PI*6378137/256/Math.pow(2,r),i=e*n-2*Math.PI*6378137/2,a=t*n-2*Math.PI*6378137/2;return[i,a]}e.getURL=function(e,r,n,i,a,o){return o=o||{},e+"?"+["bbox="+t(n,i,a),"format="+(o.format||"image/png"),"service="+(o.service||"WMS"),"version="+(o.version||"1.1.1"),"request="+(o.request||"GetMap"),"srs="+(o.srs||"EPSG:3857"),"width="+(o.width||256),"height="+(o.height||256),"layers="+r].join("&")},e.getTileBBox=t,e.getMercCoords=r,Object.defineProperty(e,"__esModule",{value:!0})}(t)})),Eo=function(e,t,r){this.z=e,this.x=t,this.y=r,this.key=Po(0,e,t,r)};Eo.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Eo.prototype.url=function(e,t){var r=zo.getTileBBox(this.x,this.y,this.z),n=function(e,t,r){for(var n,i="",a=e;a>0;a--)i+=(t&(n=1<<a-1)?1:0)+(r&n?2:0);return i}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",n).replace("{bbox-epsg-3857}",r)};var Lo=function(e,t){this.wrap=e,this.canonical=t,this.key=Po(e,t.z,t.x,t.y)},Io=function(e,t,r,n,i){this.overscaledZ=e,this.wrap=t,this.canonical=new Eo(r,+n,+i),this.key=Po(t,e,n,i)};function Po(e,t,r,n){(e*=2)<0&&(e=-1*e-1);var i=1<<t;return 32*(i*i*e+i*n+r)+t}Io.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},Io.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new Io(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Io(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},Io.prototype.isChildOf=function(e){var t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},Io.prototype.children=function(e){if(this.overscaledZ>=e)return[new Io(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return[new Io(t,this.wrap,t,r,n),new Io(t,this.wrap,t,r+1,n),new Io(t,this.wrap,t,r,n+1),new Io(t,this.wrap,t,r+1,n+1)]},Io.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},Io.prototype.wrapped=function(){return new Io(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Io.prototype.unwrapTo=function(e){return new Io(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},Io.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Io.prototype.toUnwrapped=function(){return new Lo(this.wrap,this.canonical)},Io.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Io.prototype.toCoordinate=function(){return new s(this.canonical.x+Math.pow(2,this.wrap),this.canonical.y,this.canonical.z)},pr("CanonicalTileID",Eo),pr("OverscaledTileID",Io,{omit:["posMatrix"]});var Do=function(e,t,r){if(e<=0)throw new RangeError("Level must have positive dimension");this.dim=e,this.border=t,this.stride=this.dim+2*this.border,this.data=r||new Int32Array((this.dim+2*this.border)*(this.dim+2*this.border))};Do.prototype.set=function(e,t,r){this.data[this._idx(e,t)]=r+65536},Do.prototype.get=function(e,t){return this.data[this._idx(e,t)]-65536},Do.prototype._idx=function(e,t){if(e<-this.border||e>=this.dim+this.border||t<-this.border||t>=this.dim+this.border)throw new RangeError("out of range source coordinates for DEM data");return(t+this.border)*this.stride+(e+this.border)},pr("Level",Do);var Oo=function(e,t,r){this.uid=e,this.scale=t||1,this.level=r||new Do(256,512),this.loaded=!!r};Oo.prototype.loadFromImage=function(e,t){if(e.height!==e.width)throw new RangeError("DEM tiles must be square");if(t&&"mapbox"!==t&&"terrarium"!==t)return b('"'+t+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');var r=this.level=new Do(e.width,e.width/2),n=e.data;this._unpackData(r,n,t||"mapbox");for(var i=0;i<r.dim;i++)r.set(-1,i,r.get(0,i)),r.set(r.dim,i,r.get(r.dim-1,i)),r.set(i,-1,r.get(i,0)),r.set(i,r.dim,r.get(i,r.dim-1));r.set(-1,-1,r.get(0,0)),r.set(r.dim,-1,r.get(r.dim-1,0)),r.set(-1,r.dim,r.get(0,r.dim-1)),r.set(r.dim,r.dim,r.get(r.dim-1,r.dim-1)),this.loaded=!0},Oo.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},Oo.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},Oo.prototype._unpackData=function(e,t,r){for(var n={mapbox:this._unpackMapbox,terrarium:this._unpackTerrarium}[r],i=0;i<e.dim;i++)for(var a=0;a<e.dim;a++){var o=4*(i*e.dim+a);e.set(a,i,this.scale*n(t[o],t[o+1],t[o+2]))}},Oo.prototype.getPixels=function(){return new fi({width:this.level.dim+2*this.level.border,height:this.level.dim+2*this.level.border},new Uint8Array(this.level.data.buffer))},Oo.prototype.backfillBorder=function(e,t,r){var n=this.level,i=e.level;if(n.dim!==i.dim)throw new Error("level mismatch (dem dimension)");var a=t*n.dim,o=t*n.dim+n.dim,s=r*n.dim,l=r*n.dim+n.dim;switch(t){case-1:a=o-1;break;case 1:o=a+1}switch(r){case-1:s=l-1;break;case 1:l=s+1}for(var u=h(a,-n.border,n.dim+n.border),c=h(o,-n.border,n.dim+n.border),f=h(s,-n.border,n.dim+n.border),p=h(l,-n.border,n.dim+n.border),d=-t*n.dim,v=-r*n.dim,m=f;m<p;m++)for(var g=u;g<c;g++)n.set(g,m,i.get(g+d,m+v))},pr("DEMData",Oo);var Ro=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}};Ro.prototype.encode=function(e){return this._stringToNumber[e]},Ro.prototype.decode=function(e){return this._numberToString[e]};var Fo=function(e,t,r,n){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=n,this.properties=e.properties,null!=e.id&&(this.id=e.id)},Bo={geometry:{configurable:!0}};Bo.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Bo.geometry.set=function(e){this._geometry=e},Fo.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e},Object.defineProperties(Fo.prototype,Bo);var No=function(e,t,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=t||new lr(On,16,0),this.featureIndexArray=r||new An};function jo(e,t){return t-e}No.prototype.insert=function(e,t,r,n,i){var a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,i);for(var o=0;o<t.length;o++){for(var s=t[o],l=[1/0,1/0,-1/0,-1/0],u=0;u<s.length;u++){var c=s[u];l[0]=Math.min(l[0],c.x),l[1]=Math.min(l[1],c.y),l[2]=Math.max(l[2],c.x),l[3]=Math.max(l[3],c.y)}l[0]<On&&l[1]<On&&l[2]>=0&&l[3]>=0&&this.grid.insert(a,l[0],l[1],l[2],l[3])}},No.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ma.VectorTile(new ao(this.rawTileData)).layers,this.sourceLayerCoder=new Ro(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},No.prototype.query=function(e,t){var r=this;this.loadVTLayers();for(var n=e.params||{},i=On/e.tileSize/e.scale,a=Rt(n.filter),o=e.queryGeometry,s=e.queryPadding*i,l=1/0,u=1/0,c=-1/0,f=-1/0,h=0;h<o.length;h++)for(var p=o[h],d=0;d<p.length;d++){var v=p[d];l=Math.min(l,v.x),u=Math.min(u,v.y),c=Math.max(c,v.x),f=Math.max(f,v.y)}var m=this.grid.query(l-s,u-s,c+s,f+s);m.sort(jo);for(var g,y={},_=function(s){var l=m[s];if(l!==g){g=l;var u=r.featureIndexArray.get(l),c=null;r.loadMatchingFeature(y,u.bucketIndex,u.sourceLayerIndex,u.featureIndex,a,n.layers,t,function(t,n){return c||(c=Bn(t)),n.queryIntersectsFeature(o,t,c,r.z,e.transform,i,e.posMatrix)})}},x=0;x<m.length;x++)_(x);return y},No.prototype.loadMatchingFeature=function(e,t,r,n,i,a,o,s){var l=this.bucketLayerIDs[t];if(!a||function(e,t){for(var r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1}(a,l)){var u=this.sourceLayerCoder.decode(r),c=this.vtLayers[u].feature(n);if(i(new Er(this.tileID.overscaledZ),c))for(var f=0;f<l.length;f++){var h=l[f];if(!(a&&a.indexOf(h)<0)){var p=o[h];if(p&&(!s||s(c,p))){var d=new Fo(c,this.z,this.x,this.y);d.layer=p.serialize();var v=e[h];void 0===v&&(v=e[h]=[]),v.push({featureIndex:n,feature:d})}}}}},No.prototype.lookupSymbolFeatures=function(e,t,r,n,i,a){var o={};this.loadVTLayers();for(var s=Rt(n),l=0,u=e;l<u.length;l+=1){var c=u[l];this.loadMatchingFeature(o,t,r,c,s,i,a)}return o},No.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var n=0,i=r[t];n<i.length;n+=1){if(e===i[n])return!0}return!1},pr("FeatureIndex",No,{omit:["rawTileData","sourceLayerCoder"]});var Vo={horizontal:1,vertical:2,horizontalOnly:3};var qo={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Uo={};function Zo(e,t,r,n){var i=Math.pow(e-t,2);return n?e<t?i/2:2*i:i+Math.abs(r)*r}function Ho(e,t){var r=0;return 10===e&&(r-=1e4),40!==e&&65288!==e||(r+=50),41!==t&&65289!==t||(r+=50),r}function Go(e,t,r,n,i,a){for(var o=null,s=Zo(t,r,i,a),l=0,u=n;l<u.length;l+=1){var c=u[l],f=Zo(t-c.x,r,i,a)+c.badness;f<=s&&(o=c,s=f)}return{index:e,x:t,priorBreak:o,badness:s}}function $o(e,t,r,n){if(!r)return[];if(!e)return[];for(var i,a=[],o=function(e,t,r,n){for(var i=0,a=0;a<e.length;a++){var o=n[e.charCodeAt(a)];o&&(i+=o.metrics.advance+t)}return i/Math.max(1,Math.ceil(i/r))}(e,t,r,n),s=0,l=0;l<e.length;l++){var u=e.charCodeAt(l),c=n[u];c&&!qo[u]&&(s+=c.metrics.advance+t),l<e.length-1&&(Uo[u]||!((i=u)<11904)&&(yr["Bopomofo Extended"](i)||yr.Bopomofo(i)||yr["CJK Compatibility Forms"](i)||yr["CJK Compatibility Ideographs"](i)||yr["CJK Compatibility"](i)||yr["CJK Radicals Supplement"](i)||yr["CJK Strokes"](i)||yr["CJK Symbols and Punctuation"](i)||yr["CJK Unified Ideographs Extension A"](i)||yr["CJK Unified Ideographs"](i)||yr["Enclosed CJK Letters and Months"](i)||yr["Halfwidth and Fullwidth Forms"](i)||yr.Hiragana(i)||yr["Ideographic Description Characters"](i)||yr["Kangxi Radicals"](i)||yr["Katakana Phonetic Extensions"](i)||yr.Katakana(i)||yr["Vertical Forms"](i)||yr["Yi Radicals"](i)||yr["Yi Syllables"](i)))&&a.push(Go(l+1,s,o,a,Ho(u,e.charCodeAt(l+1)),!1))}return function e(t){return t?e(t.priorBreak).concat(t.index):[]}(Go(e.length,s,o,a,0,!0))}function Wo(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Xo(e,t,r,n,i){if(i){var a=t[e[n].glyph];if(a)for(var o=a.metrics.advance,s=(e[n].x+o)*i,l=r;l<=n;l++)e[l].x-=s}}Uo[10]=!0,Uo[32]=!0,Uo[38]=!0,Uo[40]=!0,Uo[41]=!0,Uo[43]=!0,Uo[45]=!0,Uo[47]=!0,Uo[173]=!0,Uo[183]=!0,Uo[8203]=!0,Uo[8208]=!0,Uo[8211]=!0,Uo[8231]=!0,e.commonjsGlobal=r,e.unwrapExports=n,e.createCommonjsModule=i,e.default=self,e.default$1=l,e.getJSON=function(e,t){var r=M(e);return r.setRequestHeader("Accept","application/json"),r.onerror=function(){t(new Error(r.statusText))},r.onload=function(){if(r.status>=200&&r.status<300&&r.response){var n;try{n=JSON.parse(r.response)}catch(e){return t(e)}t(null,n)}else 401===r.status&&e.url.match(/mapbox.com/)?t(new T(r.statusText+": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens",r.status,e.url)):t(new T(r.statusText,r.status,e.url))},r.send(),r},e.getImage=function(e,t){return S(e,function(e,r){if(e)t(e);else if(r){var n=new self.Image,i=self.URL||self.webkitURL;n.onload=function(){t(null,n),i.revokeObjectURL(n.src)};var a=new self.Blob([new Uint8Array(r.data)],{type:"image/png"});n.cacheControl=r.cacheControl,n.expires=r.expires,n.src=r.data.byteLength?i.createObjectURL(a):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},e.ResourceType=A,e.RGBAImage=fi,e.default$2=Qa,e.ImagePosition=eo,e.getArrayBuffer=S,e.default$3=function(e){return new ao(e).readFields(Ao,[])},e.default$4=yr,e.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var n=e.length,i=new Array(e.length),a=null;e.forEach(function(e,o){t(e,function(e,t){e&&(a=e),i[o]=t,0==--n&&r(a,i)})})},e.AlphaImage=ci,e.default$5=P,e.endsWith=m,e.extend=p,e.sphericalToCartesian=function(e){var t=e[0],r=e[1],n=e[2];return r+=90,r*=Math.PI/180,n*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(n),y:t*Math.sin(r)*Math.sin(n),z:t*Math.cos(n)}},e.Evented=I,e.validateStyle=nr,e.validateLight=ir,e.emitValidationErrors=sr,e.default$6=ee,e.number=we,e.Properties=Ur,e.Transitionable=Pr,e.Transitioning=Or,e.PossiblyEvaluated=Br,e.DataConstantProperty=Nr,e.warnOnce=b,e.uniqueId=function(){return d++},e.default$7=Co,e.pick=function(e,t){for(var r={},n=0;n<t.length;n++){var i=t[n];i in e&&(r[i]=e[i])}return r},e.wrap=function(e,t,r){var n=r-t,i=((e-t)%n+n)%n+t;return i===t?r:i},e.clamp=h,e.Event=E,e.ErrorEvent=L,e.OverscaledTileID=Io,e.default$8=On,e.createLayout=Wr,e.getCoordinatesCenter=function(e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,a=0;a<e.length;a++)t=Math.min(t,e[a].column),r=Math.min(r,e[a].row),n=Math.max(n,e[a].column),i=Math.max(i,e[a].row);var o=n-t,l=i-r,u=Math.max(o,l),c=Math.max(0,Math.floor(-Math.log(u)/Math.LN2));return new s((t+n)/2,(r+i)/2,0).zoomTo(c)},e.CanonicalTileID=Eo,e.RasterBoundsArray=Jr,e.getVideo=function(e,t){var r,n,i=self.document.createElement("video");i.onloadstart=function(){t(null,i)};for(var a=0;a<e.length;a++){var o=self.document.createElement("source");r=e[a],n=void 0,(n=self.document.createElement("a")).href=r,(n.protocol!==self.document.location.protocol||n.host!==self.document.location.host)&&(i.crossOrigin="Anonymous"),o.src=e[a],i.appendChild(o)}return i},e.default$9=D,e.bindAll=v,e.default$10=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==r){if("object"!=typeof r)return!1;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var i in t)if(!e(t[i],r[i]))return!1;return!0}return t===r},e.parseCacheControl=function(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(e,r,n,i){var a=n||i;return t[r]=!a||a.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t},e.default$11=No,e.default$12=Fo,e.default$13=Rt,e.default$14=Ha,e.CollisionBoxArray=mn,e.default$15=Mn,e.TriangleIndexArray=fn,e.default$16=Er,e.default$17=s,e.keysDifference=function(e,t){var r=[];for(var n in e)n in t||r.push(n);return r},e.default$18=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.mat4=ni,e.vec4=ri,e.getSizeData=Ba,e.evaluateSizeForFeature=function(e,t,r){var n=t;return"source"===e.functionType?r.lowerSize/10:"composite"===e.functionType?we(r.lowerSize/10,r.upperSize/10,n.uSizeT):n.uSize},e.evaluateSizeForZoom=function(e,t,r){if("constant"===e.functionType)return{uSizeT:0,uSize:e.layoutSize};if("source"===e.functionType)return{uSizeT:0,uSize:0};if("camera"===e.functionType){var n=e.propertyValue,i=e.zoomRange,a=e.sizeRange,o=h(St(n,r.specification).interpolationFactor(t,i.min,i.max),0,1);return{uSizeT:0,uSize:a.min+o*(a.max-a.min)}}var s=e.propertyValue,l=e.zoomRange;return{uSizeT:h(St(s,r.specification).interpolationFactor(t,l.min,l.max),0,1),uSize:0}},e.addDynamicAttributes=qa,e.default$19=$a,e.WritingMode=Vo,e.multiPolygonIntersectsBufferedPoint=Vn,e.multiPolygonIntersectsMultiPolygon=qn,e.multiPolygonIntersectsBufferedMultiLine=Un,e.polygonIntersectsPolygon=function(e,t){for(var r=0;r<e.length;r++)if(Yn(t,e[r]))return!0;for(var n=0;n<t.length;n++)if(Yn(e,t[n]))return!0;return!!Hn(e,t)},e.distToSegmentSquared=Wn,e.default$20=ti,e.default$21=Zr,e.default$22=function(e){return new Ka[e.type](e)},e.clone=_,e.filterObject=y,e.mapObject=g,e.registerForPluginAvailability=function(e){return Mr?e({pluginURL:Mr,completionCallback:Ar}):Cr.once("pluginAvailable",e),e},e.evented=Cr,e.default$23=gr,e.default$24=In,e.PosArray=Yr,e.UnwrappedTileID=Lo,e.ease=f,e.bezier=c,e.setRTLTextPlugin=function(e,t){if(Tr)throw new Error("setRTLTextPlugin cannot be called multiple times.");Tr=!0,Mr=e,Ar=function(e){e?(Tr=!1,Mr=null,t&&t(e)):Sr=!0},Cr.fire(new E("pluginAvailable",{pluginURL:Mr,completionCallback:Ar}))},e.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},e.default$25=Fa,e.register=pr,e.GLYPH_PBF_BORDER=So,e.shapeText=function(e,t,r,n,i,a,o,s,l,u){var c=e.trim();u===Vo.vertical&&(c=function(e){for(var t="",r=0;r<e.length;r++){var n=e.charCodeAt(r+1)||null,i=e.charCodeAt(r-1)||null;n&&wr(n)&&!Ra[e[r+1]]||i&&wr(i)&&!Ra[e[r-1]]||!Ra[e[r]]?t+=e[r]:t+=Ra[e[r]]}return t}(c));var f=[],h={positionedGlyphs:f,text:c,top:s[1],bottom:s[1],left:s[0],right:s[0],writingMode:u},p=zr.processBidirectionalText;return function(e,t,r,n,i,a,o,s,l){for(var u=0,c=-17,f=0,h=e.positionedGlyphs,p="right"===a?1:"left"===a?0:.5,d=0,v=r;d<v.length;d+=1){var m=v[d];if((m=m.trim()).length){for(var g=h.length,y=0;y<m.length;y++){var _=m.charCodeAt(y),x=t[_];x&&(br(_)&&o!==Vo.horizontal?(h.push({glyph:_,x:u,y:0,vertical:!0}),u+=l+s):(h.push({glyph:_,x:u,y:c,vertical:!1}),u+=x.metrics.advance+s))}if(h.length!==g){var b=u-s;f=Math.max(b,f),Xo(h,t,g,h.length-1,p)}u=0,c+=n}else c+=n}var w=Wo(i),k=w.horizontalAlign,A=w.verticalAlign;!function(e,t,r,n,i,a,o){for(var s=(t-r)*i,l=(-n*o+.5)*a,u=0;u<e.length;u++)e[u].x+=s,e[u].y+=l}(h,p,k,A,f,n,r.length);var T=r.length*n;e.top+=-A*T,e.bottom=e.top+T,e.left+=-k*f,e.right=e.left+f}(h,t,p?p(c,$o(c,o,r,t)):function(e,t){for(var r=[],n=0,i=0,a=t;i<a.length;i+=1){var o=a[i];r.push(e.substring(n,o)),n=o}return n<e.length&&r.push(e.substring(n,e.length)),r}(c,$o(c,o,r,t)),n,i,a,u,o,l),!!f.length&&h},e.shapeIcon=function(e,t,r){var n=Wo(r),i=n.horizontalAlign,a=n.verticalAlign,o=t[0],s=t[1],l=o-e.displaySize[0]*i,u=l+e.displaySize[0],c=s-e.displaySize[1]*a;return{image:e,top:c,bottom:c+e.displaySize[1],left:l,right:u}},e.allowsVerticalWritingMode=_r,e.allowsLetterSpacing=function(e){for(var t=0,r=e;t<r.length;t+=1)if(!xr(r[t].charCodeAt(0)))return!1;return!0},e.default$26=Wi,e.default$27=Ro,e.default$28=ro,e.default$29=ma,e.default$30=ao,e.default$31=Oo,e.__moduleExports=ma,e.default$32=l,e.__moduleExports$1=ao,e.plugin=zr});i(["./chunk1.js"],function(e){"use strict";function t(e){var r=typeof e;if("number"===r||"boolean"===r||"string"===r||null==e)return JSON.stringify(e);if(Array.isArray(e)){for(var n="[",i=0,a=e;i<a.length;i+=1){n+=t(a[i])+","}return n+"]"}for(var o=Object.keys(e).sort(),s="{",l=0;l<o.length;l++)s+=JSON.stringify(o[l])+":"+t(e[o[l]])+",";return s+"}"}function r(r){for(var n="",i=0,a=e.default$18;i<a.length;i+=1){n+="/"+t(r[a[i]])}return n}var n=function(e){e&&this.replace(e)};function i(e,t,r,n,i){if(void 0===t.segment)return!0;for(var a=t,o=t.segment+1,s=0;s>-r/2;){if(--o<0)return!1;s-=e[o].dist(a),a=e[o]}s+=e[o].dist(e[o+1]),o++;for(var l=[],u=0;s<r/2;){var c=e[o-1],f=e[o],h=e[o+1];if(!h)return!1;var p=c.angleTo(f)-f.angleTo(h);for(p=Math.abs((p+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:p}),u+=p;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>i)return!1;o++,s+=f.dist(h)}return!0}function a(t,r,n,a,o,s,l,u,c){var f=a?.6*s*l:0,h=Math.max(a?a.right-a.left:0,o?o.right-o.left:0),p=0===t[0].x||t[0].x===c||0===t[0].y||t[0].y===c;return r-h*l<r/4&&(r=h*l+r/4),function t(r,n,a,o,s,l,u,c,f){var h=l/2;var p=0;for(var d=0;d<r.length-1;d++)p+=r[d].dist(r[d+1]);var v=0,m=n-a;var g=[];for(var y=0;y<r.length-1;y++){for(var _=r[y],x=r[y+1],b=_.dist(x),w=x.angleTo(_);m+a<v+b;){var k=((m+=a)-v)/b,A=e.number(_.x,x.x,k),T=e.number(_.y,x.y,k);if(A>=0&&A<f&&T>=0&&T<f&&m-h>=0&&m+h<=p){var M=new e.default$25(A,T,w,y);M._round(),o&&!i(r,M,l,o,s)||g.push(M)}}v+=b}c||g.length||u||(g=t(r,v/2,a,o,s,l,u,!0,f));return g}(t,p?r/2*u%r:(h/2+2*s)*l*u%r,r,f,n,h*l,p,!1,c)}n.prototype.replace=function(e){this._layerConfigs={},this._layers={},this.update(e,[])},n.prototype.update=function(t,n){for(var i=this,a=0,o=t;a<o.length;a+=1){var s=o[a];i._layerConfigs[s.id]=s;var l=i._layers[s.id]=e.default$22(s);l._featureFilter=e.default$13(l.filter)}for(var u=0,c=n;u<c.length;u+=1){var f=c[u];delete i._layerConfigs[f],delete i._layers[f]}this.familiesBySource={};for(var h=0,p=function(e){for(var t={},n=0;n<e.length;n++){var i=r(e[n]),a=t[i];a||(a=t[i]=[]),a.push(e[n])}var o=[];for(var s in t)o.push(t[s]);return o}(e.values(this._layerConfigs));h<p.length;h+=1){var d=p[h].map(function(e){return i._layers[e.id]}),v=d[0];if("none"!==v.visibility){var m=v.source||"",g=i.familiesBySource[m];g||(g=i.familiesBySource[m]={});var y=v.sourceLayer||"_geojsonTileLayer",_=g[y];_||(_=g[y]=[]),_.push(d)}}};var o=function(){this.opacity=0,this.targetOpacity=0,this.time=0};o.prototype.clone=function(){var e=new o;return e.opacity=this.opacity,e.targetOpacity=this.targetOpacity,e.time=this.time,e},e.register("OpacityState",o);var s=function(e,t,r,n,i,a,o,s,l,u,c){var f=o.top*s-l,h=o.bottom*s+l,p=o.left*s-l,d=o.right*s+l;if(this.boxStartIndex=e.length,u){var v=h-f,m=d-p;v>0&&(v=Math.max(10*s,v),this._addLineCollisionCircles(e,t,r,r.segment,m,v,n,i,a,c))}else e.emplaceBack(r.x,r.y,p,f,d,h,n,i,a,0,0);this.boxEndIndex=e.length};s.prototype._addLineCollisionCircles=function(e,t,r,n,i,a,o,s,l,u){var c=a/2,f=Math.floor(i/c),h=1+.4*Math.log(u)/Math.LN2,p=Math.floor(f*h/2),d=-a/2,v=r,m=n+1,g=d,y=-i/2,_=y-i/4;do{if(--m<0){if(g>y)return;m=0;break}g-=t[m].dist(v),v=t[m]}while(g>_);for(var x=t[m].dist(t[m+1]),b=-p;b<f+p;b++){var w=b*c,k=y+w;if(w<0&&(k+=w),w>i&&(k+=w-i),!(k<g)){for(;g+x<k;){if(g+=x,++m+1>=t.length)return;x=t[m].dist(t[m+1])}var A=k-g,T=t[m],M=t[m+1].sub(T)._unit()._mult(A)._add(T)._round(),S=Math.abs(k-d)<c?0:.8*(k-d);e.emplaceBack(M.x,M.y,-a/2,-a/2,a/2,a/2,o,s,l,a/2,S)}}};var l=c,u=c;function c(e,t){if(!(this instanceof c))return new c(e,t);if(this.data=e||[],this.length=this.data.length,this.compare=t||f,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)}function f(e,t){return e<t?-1:e>t?1:0}function h(t,r,n){void 0===r&&(r=1),void 0===n&&(n=!1);for(var i=1/0,a=1/0,o=-1/0,s=-1/0,u=t[0],c=0;c<u.length;c++){var f=u[c];(!c||f.x<i)&&(i=f.x),(!c||f.y<a)&&(a=f.y),(!c||f.x>o)&&(o=f.x),(!c||f.y>s)&&(s=f.y)}var h=o-i,v=s-a,m=Math.min(h,v),g=m/2,y=new l(null,p);if(0===m)return new e.default$1(i,a);for(var _=i;_<o;_+=m)for(var x=a;x<s;x+=m)y.push(new d(_+g,x+g,g,t));for(var b=function(e){for(var t=0,r=0,n=0,i=e[0],a=0,o=i.length,s=o-1;a<o;s=a++){var l=i[a],u=i[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,n+=(l.y+u.y)*c,t+=3*c}return new d(r/t,n/t,0,e)}(t),w=y.length;y.length;){var k=y.pop();(k.d>b.d||!b.d)&&(b=k,n&&console.log("found best %d after %d probes",Math.round(1e4*k.d)/1e4,w)),k.max-b.d<=r||(g=k.h/2,y.push(new d(k.p.x-g,k.p.y-g,g,t)),y.push(new d(k.p.x+g,k.p.y-g,g,t)),y.push(new d(k.p.x-g,k.p.y+g,g,t)),y.push(new d(k.p.x+g,k.p.y+g,g,t)),w+=4)}return n&&(console.log("num probes: "+w),console.log("best distance: "+b.d)),b.p}function p(e,t){return t.max-e.max}function d(t,r,n,i){this.p=new e.default$1(t,r),this.h=n,this.d=function(t,r){for(var n=!1,i=1/0,a=0;a<r.length;a++)for(var o=r[a],s=0,l=o.length,u=l-1;s<l;u=s++){var c=o[s],f=o[u];c.y>t.y!=f.y>t.y&&t.x<(f.x-c.x)*(t.y-c.y)/(f.y-c.y)+c.x&&(n=!n),i=Math.min(i,e.distToSegmentSquared(t,c,f))}return(n?1:-1)*Math.sqrt(i)}(this.p,i),this.max=this.d+this.h*Math.SQRT2}function v(t,r,n,i,a,o){t.createArrays(),t.symbolInstances=[];var s=512*t.overscaling;t.tilePixelRatio=e.default$8/s,t.compareText={},t.iconsNeedLinear=!1;var l=t.layers[0].layout,u=t.layers[0]._unevaluatedLayout._values,c={};if("composite"===t.textSizeData.functionType){var f=t.textSizeData.zoomRange,h=f.min,p=f.max;c.compositeTextSizes=[u["text-size"].possiblyEvaluate(new e.default$16(h)),u["text-size"].possiblyEvaluate(new e.default$16(p))]}if("composite"===t.iconSizeData.functionType){var d=t.iconSizeData.zoomRange,v=d.min,g=d.max;c.compositeIconSizes=[u["icon-size"].possiblyEvaluate(new e.default$16(v)),u["icon-size"].possiblyEvaluate(new e.default$16(g))]}c.layoutTextSize=u["text-size"].possiblyEvaluate(new e.default$16(t.zoom+1)),c.layoutIconSize=u["icon-size"].possiblyEvaluate(new e.default$16(t.zoom+1)),c.textMaxSize=u["text-size"].possiblyEvaluate(new e.default$16(18));for(var y=24*l.get("text-line-height"),_="map"===l.get("text-rotation-alignment")&&"line"===l.get("symbol-placement"),x=l.get("text-keep-upright"),b=0,w=t.features;b<w.length;b+=1){var k=w[b],A=l.get("text-font").evaluate(k).join(","),T=r[A]||{},M=n[A]||{},S={},C=k.text;if(C){var z=l.get("text-offset").evaluate(k).map(function(e){return 24*e}),E=24*l.get("text-letter-spacing").evaluate(k),L=e.allowsLetterSpacing(C)?E:0,I=l.get("text-anchor").evaluate(k),P=l.get("text-justify").evaluate(k),D="line"!==l.get("symbol-placement")?24*l.get("text-max-width").evaluate(k):0;S.horizontal=e.shapeText(C,T,D,y,I,P,L,z,24,e.WritingMode.horizontal),e.allowsVerticalWritingMode(C)&&_&&x&&(S.vertical=e.shapeText(C,T,D,y,I,P,L,z,24,e.WritingMode.vertical))}var O=void 0;if(k.icon){var R=i[k.icon];R&&(O=e.shapeIcon(a[k.icon],l.get("icon-offset").evaluate(k),l.get("icon-anchor").evaluate(k)),void 0===t.sdfIcons?t.sdfIcons=R.sdf:t.sdfIcons!==R.sdf&&e.warnOnce("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),R.pixelRatio!==t.pixelRatio?t.iconsNeedLinear=!0:0!==l.get("icon-rotate").constantOr(1)&&(t.iconsNeedLinear=!0))}(S.horizontal||O)&&m(t,k,S,O,M,c)}o&&t.generateCollisionDebugBuffers()}function m(t,r,n,i,l,u){var c=u.layoutTextSize.evaluate(r),f=u.layoutIconSize.evaluate(r),p=u.textMaxSize.evaluate(r);void 0===p&&(p=c);var d=t.layers[0].layout,v=d.get("text-offset").evaluate(r),m=d.get("icon-offset").evaluate(r),_=c/24,x=t.tilePixelRatio*_,b=t.tilePixelRatio*p/24,w=t.tilePixelRatio*f,k=t.tilePixelRatio*d.get("symbol-spacing"),A=d.get("text-padding")*t.tilePixelRatio,T=d.get("icon-padding")*t.tilePixelRatio,M=d.get("text-max-angle")/180*Math.PI,S="map"===d.get("text-rotation-alignment")&&"line"===d.get("symbol-placement"),C="map"===d.get("icon-rotation-alignment")&&"line"===d.get("symbol-placement"),z=k/2,E=function(a,c){c.x<0||c.x>=e.default$8||c.y<0||c.y>=e.default$8||t.symbolInstances.push(function(t,r,n,i,a,l,u,c,f,h,p,d,v,m,y,_,x,b,w,k,A){var T,M,S=t.addToLineVertexArray(r,n),C=0,z=0,E=0,L=i.horizontal?i.horizontal.text:"",I=[];i.horizontal&&(T=new s(u,n,r,c,f,h,i.horizontal,p,d,v,t.overscaling),z+=g(t,r,i.horizontal,l,v,w,m,S,i.vertical?e.WritingMode.horizontal:e.WritingMode.horizontalOnly,I,k,A),i.vertical&&(E+=g(t,r,i.vertical,l,v,w,m,S,e.WritingMode.vertical,I,k,A)));var P=T?T.boxStartIndex:t.collisionBoxArray.length,D=T?T.boxEndIndex:t.collisionBoxArray.length;if(a){var O=function(t,r,n,i,a,o){var s,l,u,c,f=r.image,h=n.layout,p=r.top-1/f.pixelRatio,d=r.left-1/f.pixelRatio,v=r.bottom+1/f.pixelRatio,m=r.right+1/f.pixelRatio;if("none"!==h.get("icon-text-fit")&&a){var g=m-d,y=v-p,_=h.get("text-size").evaluate(o)/24,x=a.left*_,b=a.right*_,w=a.top*_,k=b-x,A=a.bottom*_-w,T=h.get("icon-text-fit-padding")[0],M=h.get("icon-text-fit-padding")[1],S=h.get("icon-text-fit-padding")[2],C=h.get("icon-text-fit-padding")[3],z="width"===h.get("icon-text-fit")?.5*(A-y):0,E="height"===h.get("icon-text-fit")?.5*(k-g):0,L="width"===h.get("icon-text-fit")||"both"===h.get("icon-text-fit")?k:g,I="height"===h.get("icon-text-fit")||"both"===h.get("icon-text-fit")?A:y;s=new e.default$1(x+E-C,w+z-T),l=new e.default$1(x+E+M+L,w+z-T),u=new e.default$1(x+E+M+L,w+z+S+I),c=new e.default$1(x+E-C,w+z+S+I)}else s=new e.default$1(d,p),l=new e.default$1(m,p),u=new e.default$1(m,v),c=new e.default$1(d,v);var P=n.layout.get("icon-rotate").evaluate(o)*Math.PI/180;if(P){var D=Math.sin(P),O=Math.cos(P),R=[O,-D,D,O];s._matMult(R),l._matMult(R),c._matMult(R),u._matMult(R)}return[{tl:s,tr:l,bl:c,br:u,tex:f.paddedRect,writingMode:void 0,glyphOffset:[0,0]}]}(0,a,l,0,i.horizontal,w);M=new s(u,n,r,c,f,h,a,y,_,!1,t.overscaling),C=4*O.length;var R=t.iconSizeData,F=null;"source"===R.functionType?F=[10*l.layout.get("icon-size").evaluate(w)]:"composite"===R.functionType&&(F=[10*A.compositeIconSizes[0].evaluate(w),10*A.compositeIconSizes[1].evaluate(w)]),t.addSymbols(t.icon,O,F,b,x,w,!1,r,S.lineStartIndex,S.lineLength)}var B=M?M.boxStartIndex:t.collisionBoxArray.length,N=M?M.boxEndIndex:t.collisionBoxArray.length;t.glyphOffsetArray.length>=e.default$14.MAX_GLYPHS&&e.warnOnce("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907");var j=new o,V=new o;return{key:L,textBoxStartIndex:P,textBoxEndIndex:D,iconBoxStartIndex:B,iconBoxEndIndex:N,textOffset:m,iconOffset:b,anchor:r,line:n,featureIndex:c,feature:w,numGlyphVertices:z,numVerticalGlyphVertices:E,numIconVertices:C,textOpacityState:j,iconOpacityState:V,isDuplicate:!1,placedTextSymbolIndices:I,crossTileID:0}}(t,c,a,n,i,t.layers[0],t.collisionBoxArray,r.index,r.sourceLayerIndex,t.index,x,A,S,v,w,T,C,m,r,l,u))};if("line"===d.get("symbol-placement"))for(var L=0,I=function(t,r,n,i,a){for(var o=[],s=0;s<t.length;s++)for(var l=t[s],u=void 0,c=0;c<l.length-1;c++){var f=l[c],h=l[c+1];f.x<r&&h.x<r||(f.x<r?f=new e.default$1(r,f.y+(h.y-f.y)*((r-f.x)/(h.x-f.x)))._round():h.x<r&&(h=new e.default$1(r,f.y+(h.y-f.y)*((r-f.x)/(h.x-f.x)))._round()),f.y<n&&h.y<n||(f.y<n?f=new e.default$1(f.x+(h.x-f.x)*((n-f.y)/(h.y-f.y)),n)._round():h.y<n&&(h=new e.default$1(f.x+(h.x-f.x)*((n-f.y)/(h.y-f.y)),n)._round()),f.x>=i&&h.x>=i||(f.x>=i?f=new e.default$1(i,f.y+(h.y-f.y)*((i-f.x)/(h.x-f.x)))._round():h.x>=i&&(h=new e.default$1(i,f.y+(h.y-f.y)*((i-f.x)/(h.x-f.x)))._round()),f.y>=a&&h.y>=a||(f.y>=a?f=new e.default$1(f.x+(h.x-f.x)*((a-f.y)/(h.y-f.y)),a)._round():h.y>=a&&(h=new e.default$1(f.x+(h.x-f.x)*((a-f.y)/(h.y-f.y)),a)._round()),u&&f.equals(u[u.length-1])||(u=[f],o.push(u)),u.push(h)))))}return o}(r.geometry,0,0,e.default$8,e.default$8);L<I.length;L+=1)for(var P=I[L],D=0,O=a(P,k,M,n.vertical||n.horizontal,i,24,b,t.overscaling,e.default$8);D<O.length;D+=1){var R=O[D],F=n.horizontal;F&&y(t,F.text,z,R)||E(P,R)}else if("Polygon"===r.type)for(var B=0,N=e.default$26(r.geometry,0);B<N.length;B+=1){var j=N[B],V=h(j,16);E(j[0],new e.default$25(V.x,V.y,0))}else if("LineString"===r.type)for(var q=0,U=r.geometry;q<U.length;q+=1){var Z=U[q];E(Z,new e.default$25(Z[0].x,Z[0].y,0))}else if("Point"===r.type)for(var H=0,G=r.geometry;H<G.length;H+=1)for(var $=0,W=G[H];$<W.length;$+=1){var X=W[$];E([X],new e.default$25(X.x,X.y,0))}}function g(t,r,n,i,a,o,s,l,u,c,f,h){var p=function(t,r,n,i,a,o){for(var s=n.layout.get("text-rotate").evaluate(a)*Math.PI/180,l=n.layout.get("text-offset").evaluate(a).map(function(e){return 24*e}),u=r.positionedGlyphs,c=[],f=0;f<u.length;f++){var h=u[f],p=o[h.glyph];if(p){var d=p.rect;if(d){var v=e.GLYPH_PBF_BORDER+1,m=p.metrics.advance/2,g=i?[h.x+m,h.y]:[0,0],y=i?[0,0]:[h.x+m+l[0],h.y+l[1]],_=p.metrics.left-v-m+y[0],x=-p.metrics.top-v+y[1],b=_+d.w,w=x+d.h,k=new e.default$1(_,x),A=new e.default$1(b,x),T=new e.default$1(_,w),M=new e.default$1(b,w);if(i&&h.vertical){var S=new e.default$1(-m,m),C=-Math.PI/2,z=new e.default$1(5,0);k._rotateAround(C,S)._add(z),A._rotateAround(C,S)._add(z),T._rotateAround(C,S)._add(z),M._rotateAround(C,S)._add(z)}if(s){var E=Math.sin(s),L=Math.cos(s),I=[L,-E,E,L];k._matMult(I),A._matMult(I),T._matMult(I),M._matMult(I)}c.push({tl:k,tr:A,bl:T,br:M,tex:d,writingMode:r.writingMode,glyphOffset:g})}}}return c}(0,n,i,a,o,f),d=t.textSizeData,v=null;return"source"===d.functionType?v=[10*i.layout.get("text-size").evaluate(o)]:"composite"===d.functionType&&(v=[10*h.compositeTextSizes[0].evaluate(o),10*h.compositeTextSizes[1].evaluate(o)]),t.addSymbols(t.text,p,v,s,a,o,u,r,l.lineStartIndex,l.lineLength),c.push(t.text.placedSymbolArray.length-1),4*p.length}function y(e,t,r,n){var i=e.compareText;if(t in i){for(var a=i[t],o=a.length-1;o>=0;o--)if(n.dist(a[o])<r)return!0}else i[t]=[];return i[t].push(n),!1}c.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var e=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var t=this.data,r=this.compare,n=t[e];e>0;){var i=e-1>>1,a=t[i];if(r(n,a)>=0)break;t[e]=a,e=i}t[e]=n},_down:function(e){for(var t=this.data,r=this.compare,n=this.length>>1,i=t[e];e<n;){var a=1+(e<<1),o=a+1,s=t[a];if(o<this.length&&r(t[o],s)<0&&(a=o,s=t[o]),r(s,i)>=0)break;t[e]=s,e=a}t[e]=i}},l.default=u;var _=function(t){var r=new e.AlphaImage({width:0,height:0}),n={},i=new e.default$2(0,0,{autoResize:!0});for(var a in t){var o=t[a],s=n[a]={};for(var l in o){var u=o[+l];if(u&&0!==u.bitmap.width&&0!==u.bitmap.height){var c=i.packOne(u.bitmap.width+2,u.bitmap.height+2);r.resize({width:i.w,height:i.h}),e.AlphaImage.copy(u.bitmap,r,{x:0,y:0},{x:c.x+1,y:c.y+1},u.bitmap),s[l]={rect:c,metrics:u.metrics}}}}i.shrink(),r.resize({width:i.w,height:i.h}),this.image=r,this.positions=n};e.register("GlyphAtlas",_);var x=function(t){this.tileID=new e.OverscaledTileID(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming};function b(t,r){for(var n=new e.default$16(r),i=0,a=t;i<a.length;i+=1){a[i].recalculate(n)}}x.prototype.parse=function(t,r,n,i){var a=this;this.status="parsing",this.data=t,this.collisionBoxArray=new e.CollisionBoxArray;var o=new e.default$27(Object.keys(t.layers).sort()),s=new e.default$11(this.tileID);s.bucketLayerIDs=[];var l,u,c,f={},h={featureIndex:s,iconDependencies:{},glyphDependencies:{}},p=r.familiesBySource[this.source];for(var d in p){var m=t.layers[d];if(m){1===m.version&&e.warnOnce('Vector tile source "'+a.source+'" layer "'+d+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var g=o.encode(d),y=[],x=0;x<m.length;x++){var w=m.feature(x);y.push({feature:w,index:x,sourceLayerIndex:g})}for(var k=0,A=p[d];k<A.length;k+=1){var T=A[k],M=T[0];if(!(M.minzoom&&a.zoom<Math.floor(M.minzoom)))if(!(M.maxzoom&&a.zoom>=M.maxzoom))if("none"!==M.visibility)b(T,a.zoom),(f[M.id]=M.createBucket({index:s.bucketLayerIDs.length,layers:T,zoom:a.zoom,pixelRatio:a.pixelRatio,overscaling:a.overscaling,collisionBoxArray:a.collisionBoxArray,sourceLayerIndex:g})).populate(y,h),s.bucketLayerIDs.push(T.map(function(e){return e.id}))}}}var S=e.mapObject(h.glyphDependencies,function(e){return Object.keys(e).map(Number)});Object.keys(S).length?n.send("getGlyphs",{uid:this.uid,stacks:S},function(e,t){l||(l=e,u=t,z.call(a))}):u={};var C=Object.keys(h.iconDependencies);function z(){if(l)return i(l);if(u&&c){var t=new _(u),r=new e.default$28(c);for(var n in f){var a=f[n];a instanceof e.default$14&&(b(a.layers,this.zoom),v(a,u,t.positions,c,r.positions,this.showCollisionBoxes))}this.status="done",i(null,{buckets:e.values(f).filter(function(e){return!e.isEmpty()}),featureIndex:s,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:t.image,iconAtlasImage:r.image})}}C.length?n.send("getImages",{icons:C},function(e,t){l||(l=e,c=t,z.call(a))}):c={},z.call(this)};var w=function(e){return!(!performance||!performance.getEntriesByName)&&performance.getEntriesByName(e)};function k(t,r){var n=e.getArrayBuffer(t.request,function(t,n){t?r(t):n&&r(null,{vectorTile:new e.default$29.VectorTile(new e.default$30(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires})});return function(){n.abort(),r()}}var A=function(e,t,r){this.actor=e,this.layerIndex=t,this.loadVectorData=r||k,this.loading={},this.loaded={}};A.prototype.loadTile=function(t,r){var n=this,i=t.uid;this.loading||(this.loading={});var a=this.loading[i]=new x(t);a.abort=this.loadVectorData(t,function(o,s){if(delete n.loading[i],o||!s)return r(o);var l=s.rawData,u={};s.expires&&(u.expires=s.expires),s.cacheControl&&(u.cacheControl=s.cacheControl);var c={};if(t.request&&t.request.collectResourceTiming){var f=w(t.request.url);f&&(c.resourceTiming=JSON.parse(JSON.stringify(f)))}a.vectorTile=s.vectorTile,a.parse(s.vectorTile,n.layerIndex,n.actor,function(t,n){if(t||!n)return r(t);r(null,e.extend({rawTileData:l.slice(0)},n,u,c))}),n.loaded=n.loaded||{},n.loaded[i]=a})},A.prototype.reloadTile=function(e,t){var r=this.loaded,n=e.uid,i=this;if(r&&r[n]){var a=r[n];a.showCollisionBoxes=e.showCollisionBoxes;var o=function(e,r){var n=a.reloadCallback;n&&(delete a.reloadCallback,a.parse(a.vectorTile,i.layerIndex,i.actor,n)),t(e,r)};"parsing"===a.status?a.reloadCallback=o:"done"===a.status&&a.parse(a.vectorTile,this.layerIndex,this.actor,o)}},A.prototype.abortTile=function(e,t){var r=this.loading,n=e.uid;r&&r[n]&&r[n].abort&&(r[n].abort(),delete r[n]),t()},A.prototype.removeTile=function(e,t){var r=this.loaded,n=e.uid;r&&r[n]&&delete r[n],t()};var T=function(){this.loading={},this.loaded={}};T.prototype.loadTile=function(t,r){var n=t.uid,i=t.encoding,a=new e.default$31(n);this.loading[n]=a,a.loadFromImage(t.rawImageData,i),delete this.loading[n],this.loaded=this.loaded||{},this.loaded[n]=a,r(null,a)},T.prototype.removeTile=function(e){var t=this.loaded,r=e.uid;t&&t[r]&&delete t[r]};var M={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:6356752.3142};function S(e){var t=0;if(e&&e.length>0){t+=Math.abs(C(e[0]));for(var r=1;r<e.length;r++)t-=Math.abs(C(e[r]))}return t}function C(e){var t,r,n,i,a,o,s=0,l=e.length;if(l>2){for(o=0;o<l;o++)o===l-2?(n=l-2,i=l-1,a=0):o===l-1?(n=l-1,i=0,a=1):(n=o,i=o+1,a=o+2),t=e[n],r=e[i],s+=(z(e[a][0])-z(t[0]))*Math.sin(z(r[1]));s=s*M.RADIUS*M.RADIUS/2}return s}function z(e){return e*Math.PI/180}var E={geometry:function e(t){var r,n=0;switch(t.type){case"Polygon":return S(t.coordinates);case"MultiPolygon":for(r=0;r<t.coordinates.length;r++)n+=S(t.coordinates[r]);return n;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(r=0;r<t.geometries.length;r++)n+=e(t.geometries[r]);return n}},ring:C},L=function e(t,r){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.map(I(e,r)),t;case"Feature":return t.geometry=e(t.geometry,r),t;case"Polygon":case"MultiPolygon":return function(e,t){"Polygon"===e.type?e.coordinates=P(e.coordinates,t):"MultiPolygon"===e.type&&(e.coordinates=e.coordinates.map(I(P,t)));return e}(t,r);default:return t}};function I(e,t){return function(r){return e(r,t)}}function P(e,t){t=!!t,e[0]=D(e[0],t);for(var r=1;r<e.length;r++)e[r]=D(e[r],!t);return e}function D(e,t){return function(e){return E.ring(e)>=0}(e)===t?e:e.reverse()}var O=e.default$29.VectorTileFeature.prototype.toGeoJSON,R=function(t){this._feature=t,this.extent=e.default$8,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))};R.prototype.loadGeometry=function(){if(1===this._feature.type){for(var t=[],r=0,n=this._feature.geometry;r<n.length;r+=1){var i=n[r];t.push([new e.default$1(i[0],i[1])])}return t}for(var a=[],o=0,s=this._feature.geometry;o<s.length;o+=1){for(var l=[],u=0,c=s[o];u<c.length;u+=1){var f=c[u];l.push(new e.default$1(f[0],f[1]))}a.push(l)}return a},R.prototype.toGeoJSON=function(e,t,r){return O.call(this,e,t,r)};var F=function(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.default$8,this.length=t.length,this._features=t};F.prototype.feature=function(e){return new R(this._features[e])};var B=e.__moduleExports.VectorTileFeature,N=j;function j(e,t){this.options=t||{},this.features=e,this.length=e.length}function V(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}j.prototype.feature=function(e){return new V(this.features[e],this.options.extent)},V.prototype.loadGeometry=function(){var t=this.rawGeometry;this.geometry=[];for(var r=0;r<t.length;r++){for(var n=t[r],i=[],a=0;a<n.length;a++)i.push(new e.default$32(n[a][0],n[a][1]));this.geometry.push(i)}return this.geometry},V.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,n=1/0,i=-1/0,a=0;a<e.length;a++)for(var o=e[a],s=0;s<o.length;s++){var l=o[s];t=Math.min(t,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),i=Math.max(i,l.y)}return[t,n,r,i]},V.prototype.toGeoJSON=B.prototype.toGeoJSON;var q=G,U=G,Z=function(e,t){t=t||{};var r={};for(var n in e)r[n]=new N(e[n].features,t),r[n].name=n,r[n].version=t.version,r[n].extent=t.extent;return G({layers:r})},H=N;function G(t){var r=new e.__moduleExports$1;return function(e,t){for(var r in e.layers)t.writeMessage(3,$,e.layers[r])}(t,r),r.finish()}function $(e,t){var r;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)n.feature=e.feature(r),t.writeMessage(2,W,n);var i=n.keys;for(r=0;r<i.length;r++)t.writeStringField(3,i[r]);var a=n.values;for(r=0;r<a.length;r++)t.writeMessage(4,Q,a[r])}function W(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,X,e),t.writeVarintField(3,r.type),t.writeMessage(4,K,r)}function X(e,t){var r=e.feature,n=e.keys,i=e.values,a=e.keycache,o=e.valuecache;for(var s in r.properties){var l=a[s];void 0===l&&(n.push(s),l=n.length-1,a[s]=l),t.writeVarint(l);var u=r.properties[s],c=typeof u;"string"!==c&&"boolean"!==c&&"number"!==c&&(u=JSON.stringify(u));var f=c+":"+u,h=o[f];void 0===h&&(i.push(u),h=i.length-1,o[f]=h),t.writeVarint(h)}}function Y(e,t){return(t<<3)+(7&e)}function J(e){return e<<1^e>>31}function K(e,t){for(var r=e.loadGeometry(),n=e.type,i=0,a=0,o=r.length,s=0;s<o;s++){var l=r[s],u=1;1===n&&(u=l.length),t.writeVarint(Y(1,u));for(var c=3===n?l.length-1:l.length,f=0;f<c;f++){1===f&&1!==n&&t.writeVarint(Y(2,c-1));var h=l[f].x-i,p=l[f].y-a;t.writeVarint(J(h)),t.writeVarint(J(p)),i+=h,a+=p}3===n&&t.writeVarint(Y(7,0))}}function Q(e,t){var r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}q.fromVectorTileJs=U,q.fromGeojsonVt=Z,q.GeoJSONWrapper=H;var ee=function e(t,r,n,i,a,o){if(a-i<=n)return;var s=Math.floor((i+a)/2);!function e(t,r,n,i,a,o){for(;a>i;){if(a-i>600){var s=a-i+1,l=n-i+1,u=Math.log(s),c=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*c*(s-c)/s)*(l-s/2<0?-1:1),h=Math.max(i,Math.floor(n-l*c/s+f)),p=Math.min(a,Math.floor(n+(s-l)*c/s+f));e(t,r,n,h,p,o)}var d=r[2*n+o],v=i,m=a;for(te(t,r,i,n),r[2*a+o]>d&&te(t,r,i,a);v<m;){for(te(t,r,v,m),v++,m--;r[2*v+o]<d;)v++;for(;r[2*m+o]>d;)m--}r[2*i+o]===d?te(t,r,i,m):te(t,r,++m,a),m<=n&&(i=m+1),n<=m&&(a=m-1)}}(t,r,s,i,a,o%2);e(t,r,n,i,s-1,o+1);e(t,r,n,s+1,a,o+1)};function te(e,t,r,n){re(e,r,n),re(t,2*r,2*n),re(t,2*r+1,2*n+1)}function re(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}var ne=function(e,t,r,n,i,a,o){var s,l,u=[0,e.length-1,0],c=[];for(;u.length;){var f=u.pop(),h=u.pop(),p=u.pop();if(h-p<=o)for(var d=p;d<=h;d++)s=t[2*d],l=t[2*d+1],s>=r&&s<=i&&l>=n&&l<=a&&c.push(e[d]);else{var v=Math.floor((p+h)/2);s=t[2*v],l=t[2*v+1],s>=r&&s<=i&&l>=n&&l<=a&&c.push(e[v]);var m=(f+1)%2;(0===f?r<=s:n<=l)&&(u.push(p),u.push(v-1),u.push(m)),(0===f?i>=s:a>=l)&&(u.push(v+1),u.push(h),u.push(m))}}return c};var ie=function(e,t,r,n,i,a){var o=[0,e.length-1,0],s=[],l=i*i;for(;o.length;){var u=o.pop(),c=o.pop(),f=o.pop();if(c-f<=a)for(var h=f;h<=c;h++)ae(t[2*h],t[2*h+1],r,n)<=l&&s.push(e[h]);else{var p=Math.floor((f+c)/2),d=t[2*p],v=t[2*p+1];ae(d,v,r,n)<=l&&s.push(e[p]);var m=(u+1)%2;(0===u?r-i<=d:n-i<=v)&&(o.push(f),o.push(p-1),o.push(m)),(0===u?r+i>=d:n+i>=v)&&(o.push(p+1),o.push(c),o.push(m))}}return s};function ae(e,t,r,n){var i=e-r,a=t-n;return i*i+a*a}var oe=function(e,t,r,n,i){return new se(e,t,r,n,i)};function se(e,t,r,n,i){t=t||le,r=r||ue,i=i||Array,this.nodeSize=n||64,this.points=e,this.ids=new i(e.length),this.coords=new i(2*e.length);for(var a=0;a<e.length;a++)this.ids[a]=a,this.coords[2*a]=t(e[a]),this.coords[2*a+1]=r(e[a]);ee(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function le(e){return e[0]}function ue(e){return e[1]}se.prototype={range:function(e,t,r,n){return ne(this.ids,this.coords,e,t,r,n,this.nodeSize)},within:function(e,t,r){return ie(this.ids,this.coords,e,t,r,this.nodeSize)}};var ce=function(e){return new fe(e)};function fe(e){this.options=ye(Object.create(this.options),e),this.trees=new Array(this.options.maxZoom+1)}function he(e,t,r,n,i){return{x:e,y:t,zoom:1/0,id:n,properties:i,parentId:-1,numPoints:r}}function pe(e,t){var r=e.geometry.coordinates;return{x:me(r[0]),y:ge(r[1]),zoom:1/0,id:t,parentId:-1}}function de(e){return{type:"Feature",properties:ve(e),geometry:{type:"Point",coordinates:[(n=e.x,360*(n-.5)),(t=e.y,r=(180-360*t)*Math.PI/180,360*Math.atan(Math.exp(r))/Math.PI-90)]}};var t,r,n}function ve(e){var t=e.numPoints,r=t>=1e4?Math.round(t/1e3)+"k":t>=1e3?Math.round(t/100)/10+"k":t;return ye(ye({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function me(e){return e/360+.5}function ge(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function ye(e,t){for(var r in t)e[r]=t[r];return e}function _e(e){return e.x}function xe(e){return e.y}function be(e,t,r,n,i,a){var o=i-r,s=a-n;if(0!==o||0!==s){var l=((e-r)*o+(t-n)*s)/(o*o+s*s);l>1?(r=i,n=a):l>0&&(r+=o*l,n+=s*l)}return(o=e-r)*o+(s=t-n)*s}function we(e,t,r,n){var i={id:e||null,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)ke(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<t.length;n++)ke(e,t[n]);else if("MultiPolygon"===r)for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)ke(e,t[n][i])}(i),i}function ke(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function Ae(e,t,r){if(t.geometry){var n=t.geometry.coordinates,i=t.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),o=[];if("Point"===i)Te(n,o);else if("MultiPoint"===i)for(var s=0;s<n.length;s++)Te(n[s],o);else if("LineString"===i)Me(n,o,a,!1);else if("MultiLineString"===i)if(r.lineMetrics)for(s=0;s<n.length;s++)return o=[],Me(n[s],o,a,!1),void e.push(we(t.id,"LineString",o,t.properties));else Se(n,o,a,!1);else if("Polygon"===i)Se(n,o,a,!0);else{if("MultiPolygon"!==i){if("GeometryCollection"===i){for(s=0;s<t.geometry.geometries.length;s++)Ae(e,{id:t.id,geometry:t.geometry.geometries[s],properties:t.properties},r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(s=0;s<n.length;s++){var l=[];Se(n[s],l,a,!0),o.push(l)}}e.push(we(t.id,i,o,t.properties))}}function Te(e,t){t.push(Ce(e[0])),t.push(ze(e[1])),t.push(0)}function Me(e,t,r,n){for(var i,a,o=0,s=0;s<e.length;s++){var l=Ce(e[s][0]),u=ze(e[s][1]);t.push(l),t.push(u),t.push(0),s>0&&(o+=n?(i*u-l*a)/2:Math.sqrt(Math.pow(l-i,2)+Math.pow(u-a,2))),i=l,a=u}var c=t.length-3;t[2]=1,function e(t,r,n,i){for(var a,o=i,s=t[r],l=t[r+1],u=t[n],c=t[n+1],f=r+3;f<n;f+=3){var h=be(t[f],t[f+1],s,l,u,c);h>o&&(a=f,o=h)}o>i&&(a-r>3&&e(t,r,a,i),t[a+2]=o,n-a>3&&e(t,a,n,i))}(t,0,c,r),t[c+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function Se(e,t,r,n){for(var i=0;i<e.length;i++){var a=[];Me(e[i],a,r,n),t.push(a)}}function Ce(e){return e/360+.5}function ze(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function Ee(e,t,r,n,i,a,o,s){if(n/=t,a>=(r/=t)&&o<=n)return e;if(a>n||o<r)return null;for(var l=[],u=0;u<e.length;u++){var c=e[u],f=c.geometry,h=c.type,p=0===i?c.minX:c.minY,d=0===i?c.maxX:c.maxY;if(p>=r&&d<=n)l.push(c);else if(!(p>n||d<r)){var v=[];if("Point"===h||"MultiPoint"===h)Le(f,v,r,n,i);else if("LineString"===h)Ie(f,v,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===h)De(f,v,r,n,i,!1);else if("Polygon"===h)De(f,v,r,n,i,!0);else if("MultiPolygon"===h)for(var m=0;m<f.length;m++){var g=[];De(f[m],g,r,n,i,!0),g.length&&v.push(g)}if(v.length){if(s.lineMetrics&&"LineString"===h){for(m=0;m<v.length;m++)l.push(we(c.id,h,v[m],c.tags));continue}"LineString"!==h&&"MultiLineString"!==h||(1===v.length?(h="LineString",v=v[0]):h="MultiLineString"),"Point"!==h&&"MultiPoint"!==h||(h=3===v.length?"Point":"MultiPoint"),l.push(we(c.id,h,v,c.tags))}}}return l.length?l:null}function Le(e,t,r,n,i){for(var a=0;a<e.length;a+=3){var o=e[a+i];o>=r&&o<=n&&(t.push(e[a]),t.push(e[a+1]),t.push(e[a+2]))}}function Ie(e,t,r,n,i,a,o){for(var s,l,u=Pe(e),c=0===i?Re:Fe,f=e.start,h=0;h<e.length-3;h+=3){var p=e[h],d=e[h+1],v=e[h+2],m=e[h+3],g=e[h+4],y=0===i?p:d,_=0===i?m:g,x=!1;o&&(s=Math.sqrt(Math.pow(p-m,2)+Math.pow(d-g,2))),y<r?_>=r&&(l=c(u,p,d,m,g,r),o&&(u.start=f+s*l)):y>n?_<=n&&(l=c(u,p,d,m,g,n),o&&(u.start=f+s*l)):Oe(u,p,d,v),_<r&&y>=r&&(l=c(u,p,d,m,g,r),x=!0),_>n&&y<=n&&(l=c(u,p,d,m,g,n),x=!0),!a&&x&&(o&&(u.end=f+s*l),t.push(u),u=Pe(e)),o&&(f+=s)}var b=e.length-3;p=e[b],d=e[b+1],v=e[b+2],(y=0===i?p:d)>=r&&y<=n&&Oe(u,p,d,v),b=u.length-3,a&&b>=3&&(u[b]!==u[0]||u[b+1]!==u[1])&&Oe(u,u[0],u[1],u[2]),u.length&&t.push(u)}function Pe(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function De(e,t,r,n,i,a){for(var o=0;o<e.length;o++)Ie(e[o],t,r,n,i,a,!1)}function Oe(e,t,r,n){e.push(t),e.push(r),e.push(n)}function Re(e,t,r,n,i,a){var o=(a-t)/(n-t);return e.push(a),e.push(r+(i-r)*o),e.push(1),o}function Fe(e,t,r,n,i,a){var o=(a-r)/(i-r);return e.push(t+(n-t)*o),e.push(a),e.push(1),o}function Be(e,t){for(var r=[],n=0;n<e.length;n++){var i,a=e[n],o=a.type;if("Point"===o||"MultiPoint"===o||"LineString"===o)i=Ne(a.geometry,t);else if("MultiLineString"===o||"Polygon"===o){i=[];for(var s=0;s<a.geometry.length;s++)i.push(Ne(a.geometry[s],t))}else if("MultiPolygon"===o)for(i=[],s=0;s<a.geometry.length;s++){for(var l=[],u=0;u<a.geometry[s].length;u++)l.push(Ne(a.geometry[s][u],t));i.push(l)}r.push(we(a.id,o,i,a.tags))}return r}function Ne(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function je(e,t){if(e.transformed)return e;var r,n,i,a=1<<e.z,o=e.x,s=e.y;for(r=0;r<e.features.length;r++){var l=e.features[r],u=l.geometry,c=l.type;if(l.geometry=[],1===c)for(n=0;n<u.length;n+=2)l.geometry.push(Ve(u[n],u[n+1],t,a,o,s));else for(n=0;n<u.length;n++){var f=[];for(i=0;i<u[n].length;i+=2)f.push(Ve(u[n][i],u[n][i+1],t,a,o,s));l.geometry.push(f)}}return e.transformed=!0,e}function Ve(e,t,r,n,i,a){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-a))]}function qe(e,t,r,n,i){for(var a=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){o.numFeatures++,Ue(o,e[s],a,i);var l=e[s].minX,u=e[s].minY,c=e[s].maxX,f=e[s].maxY;l<o.minX&&(o.minX=l),u<o.minY&&(o.minY=u),c>o.maxX&&(o.maxX=c),f>o.maxY&&(o.maxY=f)}return o}function Ue(e,t,r,n){var i=t.geometry,a=t.type,o=[];if("Point"===a||"MultiPoint"===a)for(var s=0;s<i.length;s+=3)o.push(i[s]),o.push(i[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===a)Ze(o,i,e,r,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(s=0;s<i.length;s++)Ze(o,i[s],e,r,"Polygon"===a,0===s);else if("MultiPolygon"===a)for(var l=0;l<i.length;l++){var u=i[l];for(s=0;s<u.length;s++)Ze(o,u[s],e,r,!0,0===s)}if(o.length){var c=t.tags||null;if("LineString"===a&&n.lineMetrics){for(var f in c={},t.tags)c[f]=t.tags[f];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var h={geometry:o,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:c};null!==t.id&&(h.id=t.id),e.features.push(h)}}function Ze(e,t,r,n,i,a){var o=n*n;if(n>0&&t.size<(i?o:n))r.numPoints+=t.length/3;else{for(var s=[],l=0;l<t.length;l+=3)(0===n||t[l+2]>o)&&(r.numSimplified++,s.push(t[l]),s.push(t[l+1])),r.numPoints++;i&&function(e,t){for(var r=0,n=0,i=e.length,a=i-2;n<i;a=n,n+=2)r+=(e[n]-e[a])*(e[n+1]+e[a+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var o=e[n],s=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=o,e[i-1-n]=s}}(s,a),e.push(s)}}function He(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");var n=function(e,t){var r=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)Ae(r,e.features[n],t);else"Feature"===e.type?Ae(r,e,t):Ae(r,{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(e,t){var r=t.buffer/t.extent,n=e,i=Ee(e,1,-1-r,r,0,-1,2,t),a=Ee(e,1,1-r,2+r,0,-1,2,t);return(i||a)&&(n=Ee(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=Be(i,1).concat(n)),a&&(n=n.concat(Be(a,-1)))),n}(n,t)).length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ge(e,t,r){return 32*((1<<e)*r+t)+e}function $e(e,t){var r=e.tileID.canonical;if(!this._geoJSONIndex)return t(null,null);var n=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!n)return t(null,null);var i=new F(n.features),a=q(i);0===a.byteOffset&&a.byteLength===a.buffer.byteLength||(a=new Uint8Array(a)),t(null,{vectorTile:i,rawData:a.buffer})}fe.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(e){return e}},load:function(e){var t=this.options.log;t&&console.time("total time");var r="prepare "+e.length+" points";t&&console.time(r),this.points=e;var n=e.map(pe);t&&console.timeEnd(r);for(var i=this.options.maxZoom;i>=this.options.minZoom;i--){var a=+Date.now();this.trees[i+1]=oe(n,_e,xe,this.options.nodeSize,Float32Array),n=this._cluster(n,i),t&&console.log("z%d: %d clusters in %dms",i,n.length,+Date.now()-a)}return this.trees[this.options.minZoom]=oe(n,_e,xe,this.options.nodeSize,Float32Array),t&&console.timeEnd("total time"),this},getClusters:function(e,t){for(var r=this.trees[this._limitZoom(t)],n=r.range(me(e[0]),ge(e[3]),me(e[2]),ge(e[1])),i=[],a=0;a<n.length;a++){var o=r.points[n[a]];i.push(o.numPoints?de(o):this.points[o.id])}return i},getChildren:function(e,t){for(var r=this.trees[t+1].points[e],n=this.options.radius/(this.options.extent*Math.pow(2,t)),i=this.trees[t+1].within(r.x,r.y,n),a=[],o=0;o<i.length;o++){var s=this.trees[t+1].points[i[o]];s.parentId===e&&a.push(s.numPoints?de(s):this.points[s.id])}return a},getLeaves:function(e,t,r,n){r=r||10,n=n||0;var i=[];return this._appendLeaves(i,e,t,r,n,0),i},getTile:function(e,t,r){var n=this.trees[this._limitZoom(e)],i=Math.pow(2,e),a=this.options.extent,o=this.options.radius/a,s=(r-o)/i,l=(r+1+o)/i,u={features:[]};return this._addTileFeatures(n.range((t-o)/i,s,(t+1+o)/i,l),n.points,t,r,i,u),0===t&&this._addTileFeatures(n.range(1-o/i,s,1,l),n.points,i,r,i,u),t===i-1&&this._addTileFeatures(n.range(0,s,o/i,l),n.points,-1,r,i,u),u.features.length?u:null},getClusterExpansionZoom:function(e,t){for(;t<this.options.maxZoom;){var r=this.getChildren(e,t);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t},_appendLeaves:function(e,t,r,n,i,a){for(var o=this.getChildren(t,r),s=0;s<o.length;s++){var l=o[s].properties;if(l.cluster?a+l.point_count<=i?a+=l.point_count:a=this._appendLeaves(e,l.cluster_id,r+1,n,i,a):a<i?a++:e.push(o[s]),e.length===n)break}return a},_addTileFeatures:function(e,t,r,n,i,a){for(var o=0;o<e.length;o++){var s=t[e[o]];a.features.push({type:1,geometry:[[Math.round(this.options.extent*(s.x*i-r)),Math.round(this.options.extent*(s.y*i-n))]],tags:s.numPoints?ve(s):this.points[s.id].properties})}},_limitZoom:function(e){return Math.max(this.options.minZoom,Math.min(e,this.options.maxZoom+1))},_cluster:function(e,t){for(var r=[],n=this.options.radius/(this.options.extent*Math.pow(2,t)),i=0;i<e.length;i++){var a=e[i];if(!(a.zoom<=t)){a.zoom=t;var o=this.trees[t+1],s=o.within(a.x,a.y,n),l=a.numPoints||1,u=a.x*l,c=a.y*l,f=null;this.options.reduce&&(f=this.options.initial(),this._accumulate(f,a));for(var h=0;h<s.length;h++){var p=o.points[s[h]];if(t<p.zoom){var d=p.numPoints||1;p.zoom=t,u+=p.x*d,c+=p.y*d,l+=d,p.parentId=i,this.options.reduce&&this._accumulate(f,p)}}1===l?r.push(a):(a.parentId=i,r.push(he(u/l,c/l,l,i,f)))}}return r},_accumulate:function(e,t){var r=t.numPoints?t.properties:this.options.map(this.points[t.id].properties);this.options.reduce(e,r)}},He.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,debug:0},He.prototype.splitTile=function(e,t,r,n,i,a,o){for(var s=[e,t,r,n],l=this.options,u=l.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,f=Ge(t,r,n),h=this.tiles[f];if(!h&&(u>1&&console.time("creation"),h=this.tiles[f]=qe(e,t,r,n,l),this.tileCoords.push({z:t,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));var p="z"+t;this.stats[p]=(this.stats[p]||0)+1,this.total++}if(h.source=e,i){if(t===l.maxZoom||t===i)continue;var d=1<<i-t;if(r!==Math.floor(a/d)||n!==Math.floor(o/d))continue}else if(t===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints)continue;if(h.source=null,0!==e.length){u>1&&console.time("clipping");var v,m,g,y,_,x,b=.5*l.buffer/l.extent,w=.5-b,k=.5+b,A=1+b;v=m=g=y=null,_=Ee(e,c,r-b,r+k,0,h.minX,h.maxX,l),x=Ee(e,c,r+w,r+A,0,h.minX,h.maxX,l),e=null,_&&(v=Ee(_,c,n-b,n+k,1,h.minY,h.maxY,l),m=Ee(_,c,n+w,n+A,1,h.minY,h.maxY,l),_=null),x&&(g=Ee(x,c,n-b,n+k,1,h.minY,h.maxY,l),y=Ee(x,c,n+w,n+A,1,h.minY,h.maxY,l),x=null),u>1&&console.timeEnd("clipping"),s.push(v||[],t+1,2*r,2*n),s.push(m||[],t+1,2*r,2*n+1),s.push(g||[],t+1,2*r+1,2*n),s.push(y||[],t+1,2*r+1,2*n+1)}}},He.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,a=n.debug;if(e<0||e>24)return null;var o=1<<e,s=Ge(e,t=(t%o+o)%o,r);if(this.tiles[s])return je(this.tiles[s],i);a>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var l,u=e,c=t,f=r;!l&&u>0;)u--,c=Math.floor(c/2),f=Math.floor(f/2),l=this.tiles[Ge(u,c,f)];return l&&l.source?(a>1&&console.log("found parent tile z%d-%d-%d",u,c,f),a>1&&console.time("drilling down"),this.splitTile(l.source,u,c,f,e,t,r),a>1&&console.timeEnd("drilling down"),this.tiles[s]?je(this.tiles[s],i):null):null};var We=function(t){function r(e,r,n){t.call(this,e,r,$e),n&&(this.loadGeoJSON=n)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.loadData=function(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=t,this._pendingLoadDataParams=e,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},r.prototype._loadData=function(){var e=this;if(this._pendingCallback&&this._pendingLoadDataParams){var t=this._pendingCallback,r=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams,this.loadGeoJSON(r,function(n,i){if(n||!i)return t(n);if("object"!=typeof i)return t(new Error("Input data is not a valid GeoJSON object."));L(i,!0);try{e._geoJSONIndex=r.cluster?ce(r.superclusterOptions).load(i.features):function(e,t){return new He(e,t)}(i,r.geojsonVtOptions)}catch(n){return t(n)}e.loaded={};var a={};if(r.request&&r.request.collectResourceTiming){var o=w(r.request.url);o&&(a.resourceTiming={},a.resourceTiming[r.source]=JSON.parse(JSON.stringify(o)))}t(null,a)})}},r.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},r.prototype.reloadTile=function(e,r){var n=this.loaded,i=e.uid;return n&&n[i]?t.prototype.reloadTile.call(this,e,r):this.loadTile(e,r)},r.prototype.loadGeoJSON=function(t,r){if(t.request)e.getJSON(t.request,r);else{if("string"!=typeof t.data)return r(new Error("Input data is not a valid GeoJSON object."));try{return r(null,JSON.parse(t.data))}catch(e){return r(new Error("Input data is not a valid GeoJSON object."))}}},r.prototype.removeSource=function(e,t){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),t()},r}(A),Xe=function(t){var r=this;this.self=t,this.actor=new e.default$7(t,this),this.layerIndexes={},this.workerSourceTypes={vector:A,geojson:We},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(e,t){if(r.workerSourceTypes[e])throw new Error('Worker source with name "'+e+'" already registered.');r.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=function(t){if(e.plugin.isLoaded())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText}};return Xe.prototype.setLayers=function(e,t,r){this.getLayerIndex(e).replace(t),r()},Xe.prototype.updateLayers=function(e,t,r){this.getLayerIndex(e).update(t.layers,t.removedIds),r()},Xe.prototype.loadTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).loadTile(t,r)},Xe.prototype.loadDEMTile=function(e,t,r){this.getDEMWorkerSource(e,t.source).loadTile(t,r)},Xe.prototype.reloadTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).reloadTile(t,r)},Xe.prototype.abortTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).abortTile(t,r)},Xe.prototype.removeTile=function(e,t,r){this.getWorkerSource(e,t.type,t.source).removeTile(t,r)},Xe.prototype.removeDEMTile=function(e,t){this.getDEMWorkerSource(e,t.source).removeTile(t)},Xe.prototype.removeSource=function(e,t,r){if(this.workerSources[e]&&this.workerSources[e][t.type]&&this.workerSources[e][t.type][t.source]){var n=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==n.removeSource?n.removeSource(t,r):r()}},Xe.prototype.loadWorkerSource=function(e,t,r){try{this.self.importScripts(t.url),r()}catch(e){r(e.toString())}},Xe.prototype.loadRTLTextPlugin=function(t,r,n){try{e.plugin.isLoaded()||(this.self.importScripts(r),n(e.plugin.isLoaded()?null:new Error("RTL Text Plugin failed to import scripts from "+r)))}catch(e){n(e.toString())}},Xe.prototype.getLayerIndex=function(e){var t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new n),t},Xe.prototype.getWorkerSource=function(e,t,r){var n=this;if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][r]){var i={send:function(t,r,i){n.actor.send(t,r,i,e)}};this.workerSources[e][t][r]=new this.workerSourceTypes[t](i,this.getLayerIndex(e))}return this.workerSources[e][t][r]},Xe.prototype.getDEMWorkerSource=function(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new T),this.demWorkerSources[e][t]},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&new Xe(self),Xe});i(["./chunk1.js"],function(e){"use strict";var t=e.createCommonjsModule(function(e){function t(e){return!!("undefined"!=typeof window&&"undefined"!=typeof document&&Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray&&Function.prototype&&Function.prototype.bind&&Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions&&"JSON"in window&&"parse"in JSON&&"stringify"in JSON&&function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,r=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(r);try{t=new Worker(n),e=!0}catch(t){e=!1}t&&t.terminate();return URL.revokeObjectURL(n),e}()&&"Uint8ClampedArray"in window&&function(e){void 0===r[e]&&(r[e]=function(e){var r=document.createElement("canvas"),n=Object.create(t.webGLContextAttributes);return n.failIfMajorPerformanceCaveat=e,r.probablySupportsContext?r.probablySupportsContext("webgl",n)||r.probablySupportsContext("experimental-webgl",n):r.supportsContext?r.supportsContext("webgl",n)||r.supportsContext("experimental-webgl",n):r.getContext("webgl",n)||r.getContext("experimental-webgl",n)}(e));return r[e]}(e&&e.failIfMajorPerformanceCaveat))}e.exports?e.exports=t:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=t);var r={};t.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),r=e.default.performance&&e.default.performance.now?e.default.performance.now.bind(e.default.performance):Date.now.bind(Date),n=e.default.requestAnimationFrame||e.default.mozRequestAnimationFrame||e.default.webkitRequestAnimationFrame||e.default.msRequestAnimationFrame,i=e.default.cancelAnimationFrame||e.default.mozCancelAnimationFrame||e.default.webkitCancelAnimationFrame||e.default.msCancelAnimationFrame,a={now:r,frame:function(e){return n(e)},cancelFrame:function(e){return i(e)},getImageData:function(t){var r=e.default.document.createElement("canvas"),n=r.getContext("2d");if(!n)throw new Error("failed to create canvas 2d context");return r.width=t.width,r.height=t.height,n.drawImage(t,0,0,t.width,t.height),n.getImageData(0,0,t.width,t.height)},hardwareConcurrency:e.default.navigator.hardwareConcurrency||4,get devicePixelRatio(){return e.default.devicePixelRatio},supportsWebp:!1};if(e.default.document){var o=e.default.document.createElement("img");o.onload=function(){a.supportsWebp=!0},o.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="}var s={create:function(t,r,n){var i=e.default.document.createElement(t);return r&&(i.className=r),n&&n.appendChild(i),i},createNS:function(t,r){return e.default.document.createElementNS(t,r)}},l=e.default.document?e.default.document.documentElement.style:null;function u(e){if(!l)return null;for(var t=0;t<e.length;t++)if(e[t]in l)return e[t];return e[0]}var c,f=u(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);s.disableDrag=function(){l&&f&&(c=l[f],l[f]="none")},s.enableDrag=function(){l&&f&&(l[f]=c)};var h=u(["transform","WebkitTransform"]);s.setTransform=function(e,t){e.style[h]=t};var p=!1;try{var d=Object.defineProperty({},"passive",{get:function(){p=!0}});e.default.addEventListener("test",d,d),e.default.removeEventListener("test",d,d)}catch(e){p=!1}s.addEventListener=function(e,t,r,n){void 0===n&&(n={}),"passive"in n&&p?e.addEventListener(t,r,n):e.addEventListener(t,r,n.capture)},s.removeEventListener=function(e,t,r,n){void 0===n&&(n={}),"passive"in n&&p?e.removeEventListener(t,r,n):e.removeEventListener(t,r,n.capture)};var v=function(t){t.preventDefault(),t.stopPropagation(),e.default.removeEventListener("click",v,!0)};s.suppressClick=function(){e.default.addEventListener("click",v,!0),e.default.setTimeout(function(){e.default.removeEventListener("click",v,!0)},0)},s.mousePos=function(t,r){var n=t.getBoundingClientRect();return r=r.touches?r.touches[0]:r,new e.default$1(r.clientX-n.left-t.clientLeft,r.clientY-n.top-t.clientTop)},s.touchPos=function(t,r){for(var n=t.getBoundingClientRect(),i=[],a="touchend"===r.type?r.changedTouches:r.touches,o=0;o<a.length;o++)i.push(new e.default$1(a[o].clientX-n.left-t.clientLeft,a[o].clientY-n.top-t.clientTop));return i},s.mouseButton=function(t){return void 0!==e.default.InstallTrigger&&2===t.button&&t.ctrlKey&&e.default.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button},s.remove=function(e){e.parentNode&&e.parentNode.removeChild(e)};var m={API_URL:"https://api.mapbox.com",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null},g="See https://www.mapbox.com/api-documentation/#access-tokens";function y(e,t){var r=M(m.API_URL);if(e.protocol=r.protocol,e.authority=r.authority,"/"!==r.path&&(e.path=""+r.path+e.path),!m.REQUIRE_ACCESS_TOKEN)return S(e);if(!(t=t||m.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+g);if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+g);return e.params.push("access_token="+t),S(e)}function _(e){return 0===e.indexOf("mapbox:")}var x=function(e,t){if(!_(e))return e;var r=M(e);return r.path="/fonts/v1"+r.path,y(r,t)},b=function(e,t){if(!_(e))return e;var r=M(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),y(r,t)},w=function(e,t,r,n){var i=M(e);return _(e)?(i.path="/styles/v1"+i.path+"/sprite"+t+r,y(i,n)):(i.path+=""+t+r,S(i))},k=/(\.(png|jpg)\d*)(?=$)/,A=function(e,t,r){if(!t||!_(t))return e;var n=M(e),i=a.devicePixelRatio>=2||512===r?"@2x":"",o=a.supportsWebp?".webp":"$1";return n.path=n.path.replace(k,""+i+o),function(e){for(var t=0;t<e.length;t++)0===e[t].indexOf("access_token=tk.")&&(e[t]="access_token="+(m.ACCESS_TOKEN||""))}(n.params),S(n)};var T=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function M(e){var t=e.match(T);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function S(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}var C=e.default.HTMLImageElement,z=e.default.HTMLCanvasElement,E=e.default.HTMLVideoElement,L=e.default.ImageData,I=function(e,t,r,n){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,n)};I.prototype.update=function(e,t){var r=e.width,n=e.height,i=!this.size||this.size[0]!==r||this.size[1]!==n,a=this.context,o=a.gl;this.useMipmap=Boolean(t&&t.useMipmap),o.bindTexture(o.TEXTURE_2D,this.texture),i?(this.size=[r,n],a.pixelStoreUnpack.set(1),this.format!==o.RGBA||t&&!1===t.premultiply||a.pixelStoreUnpackPremultiplyAlpha.set(!0),e instanceof C||e instanceof z||e instanceof E||e instanceof L?o.texImage2D(o.TEXTURE_2D,0,this.format,this.format,o.UNSIGNED_BYTE,e):o.texImage2D(o.TEXTURE_2D,0,this.format,r,n,0,this.format,o.UNSIGNED_BYTE,e.data)):e instanceof C||e instanceof z||e instanceof E||e instanceof L?o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,e):o.texSubImage2D(o.TEXTURE_2D,0,0,0,r,n,o.RGBA,o.UNSIGNED_BYTE,e.data),this.useMipmap&&this.isSizePowerOfTwo()&&o.generateMipmap(o.TEXTURE_2D)},I.prototype.bind=function(e,t,r){var n=this.context.gl;n.bindTexture(n.TEXTURE_2D,this.texture),r!==n.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=n.LINEAR),e!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t),this.wrap=t)},I.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},I.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var P=function(){this.images={},this.loaded=!1,this.requestors=[],this.shelfPack=new e.default$2(64,64,{autoResize:!0}),this.patterns={},this.atlasImage=new e.RGBAImage({width:64,height:64}),this.dirty=!0};P.prototype.isLoaded=function(){return this.loaded},P.prototype.setLoaded=function(e){if(this.loaded!==e&&(this.loaded=e,e)){for(var t=0,r=this.requestors;t<r.length;t+=1){var n=r[t],i=n.ids,a=n.callback;this._notify(i,a)}this.requestors=[]}},P.prototype.getImage=function(e){return this.images[e]},P.prototype.addImage=function(e,t){this.images[e]=t},P.prototype.removeImage=function(e){delete this.images[e];var t=this.patterns[e];t&&(this.shelfPack.unref(t.bin),delete this.patterns[e])},P.prototype.getImages=function(e,t){var r=!0;if(!this.isLoaded())for(var n=0,i=e;n<i.length;n+=1){var a=i[n];this.images[a]||(r=!1)}this.isLoaded()||r?this._notify(e,t):this.requestors.push({ids:e,callback:t})},P.prototype._notify=function(e,t){for(var r={},n=0,i=e;n<i.length;n+=1){var a=i[n],o=this.images[a];o&&(r[a]={data:o.data.clone(),pixelRatio:o.pixelRatio,sdf:o.sdf})}t(null,r)},P.prototype.getPixelSize=function(){return{width:this.shelfPack.w,height:this.shelfPack.h}},P.prototype.getPattern=function(t){var r=this.patterns[t];if(r)return r.position;var n=this.getImage(t);if(!n)return null;var i=n.data.width+2,a=n.data.height+2,o=this.shelfPack.packOne(i,a);if(!o)return null;this.atlasImage.resize(this.getPixelSize());var s=n.data,l=this.atlasImage,u=o.x+1,c=o.y+1,f=s.width,h=s.height;e.RGBAImage.copy(s,l,{x:0,y:0},{x:u,y:c},{width:f,height:h}),e.RGBAImage.copy(s,l,{x:0,y:h-1},{x:u,y:c-1},{width:f,height:1}),e.RGBAImage.copy(s,l,{x:0,y:0},{x:u,y:c+h},{width:f,height:1}),e.RGBAImage.copy(s,l,{x:f-1,y:0},{x:u-1,y:c},{width:1,height:h}),e.RGBAImage.copy(s,l,{x:0,y:0},{x:u+f,y:c},{width:1,height:h}),this.dirty=!0;var p=new e.ImagePosition(o,n);return this.patterns[t]={bin:o,position:p},p},P.prototype.bind=function(e){var t=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new I(e,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)};var D=R,O=1e20;function R(e,t,r,n,i,a){this.fontSize=e||24,this.buffer=void 0===t?3:t,this.cutoff=n||.25,this.fontFamily=i||"sans-serif",this.fontWeight=a||"normal",this.radius=r||8;var o=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(o*o),this.gridInner=new Float64Array(o*o),this.f=new Float64Array(o),this.d=new Float64Array(o),this.z=new Float64Array(o+1),this.v=new Int16Array(o),this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function F(e,t,r,n,i,a,o){for(var s=0;s<t;s++){for(var l=0;l<r;l++)n[l]=e[l*t+s];for(B(n,i,a,o,r),l=0;l<r;l++)e[l*t+s]=i[l]}for(l=0;l<r;l++){for(s=0;s<t;s++)n[s]=e[l*t+s];for(B(n,i,a,o,t),s=0;s<t;s++)e[l*t+s]=Math.sqrt(i[s])}}function B(e,t,r,n,i){r[0]=0,n[0]=-O,n[1]=+O;for(var a=1,o=0;a<i;a++){for(var s=(e[a]+a*a-(e[r[o]]+r[o]*r[o]))/(2*a-2*r[o]);s<=n[o];)o--,s=(e[a]+a*a-(e[r[o]]+r[o]*r[o]))/(2*a-2*r[o]);r[++o]=a,n[o]=s,n[o+1]=+O}for(a=0,o=0;a<i;a++){for(;n[o+1]<a;)o++;t[a]=(a-r[o])*(a-r[o])+e[r[o]]}}R.prototype.draw=function(e){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(e,this.buffer,this.middle);for(var t=this.ctx.getImageData(0,0,this.size,this.size),r=new Uint8ClampedArray(this.size*this.size),n=0;n<this.size*this.size;n++){var i=t.data[4*n+3]/255;this.gridOuter[n]=1===i?0:0===i?O:Math.pow(Math.max(0,.5-i),2),this.gridInner[n]=1===i?O:0===i?0:Math.pow(Math.max(0,i-.5),2)}for(F(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),F(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),n=0;n<this.size*this.size;n++){var a=this.gridOuter[n]-this.gridInner[n];r[n]=Math.max(0,Math.min(255,Math.round(255-255*(a/this.radius+this.cutoff))))}return r};var N=function(e,t){this.requestTransform=e,this.localIdeographFontFamily=t,this.entries={}};N.prototype.setURL=function(e){this.url=e},N.prototype.getGlyphs=function(t,r){var n=this,i=[];for(var a in t)for(var o=0,s=t[a];o<s.length;o+=1){var l=s[o];i.push({stack:a,id:l})}e.asyncAll(i,function(e,t){var r=e.stack,i=e.id,a=n.entries[r];a||(a=n.entries[r]={glyphs:{},requests:{}});var o=a.glyphs[i];if(void 0===o)if(o=n._tinySDF(a,r,i))t(null,{stack:r,id:i,glyph:o});else{var s=Math.floor(i/256);if(256*s>65535)t(new Error("glyphs > 65535 not supported"));else{var l=a.requests[s];l||(l=a.requests[s]=[],N.loadGlyphRange(r,s,n.url,n.requestTransform,function(e,t){if(t)for(var r in t)a.glyphs[+r]=t[+r];for(var n=0,i=l;n<i.length;n+=1){(0,i[n])(e,t)}delete a.requests[s]})),l.push(function(e,n){e?t(e):n&&t(null,{stack:r,id:i,glyph:n[i]||null})})}}else t(null,{stack:r,id:i,glyph:o})},function(e,t){if(e)r(e);else if(t){for(var n={},i=0,a=t;i<a.length;i+=1){var o=a[i],s=o.stack,l=o.id,u=o.glyph;(n[s]||(n[s]={}))[l]=u&&{id:u.id,bitmap:u.bitmap.clone(),metrics:u.metrics}}r(null,n)}})},N.prototype._tinySDF=function(t,r,n){var i=this.localIdeographFontFamily;if(i&&(e.default$4["CJK Unified Ideographs"](n)||e.default$4["Hangul Syllables"](n))){var a=t.tinySDF;if(!a){var o="400";/bold/i.test(r)?o="900":/medium/i.test(r)?o="500":/light/i.test(r)&&(o="200"),a=t.tinySDF=new N.TinySDF(24,3,8,.25,i,o)}return{id:n,bitmap:new e.AlphaImage({width:30,height:30},a.draw(String.fromCharCode(n))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},N.loadGlyphRange=function(t,r,n,i,a){var o=256*r,s=o+255,l=i(x(n).replace("{fontstack}",t).replace("{range}",o+"-"+s),e.ResourceType.Glyphs);e.getArrayBuffer(l,function(t,r){if(t)a(t);else if(r){for(var n={},i=0,o=e.default$3(r.data);i<o.length;i+=1){var s=o[i];n[s.id]=s}a(null,n)}})},N.TinySDF=D;var j=function(){this.specification=e.default$5.light.position};j.prototype.possiblyEvaluate=function(t,r){return e.sphericalToCartesian(t.expression.evaluate(r))},j.prototype.interpolate=function(t,r,n){return{x:e.number(t.x,r.x,n),y:e.number(t.y,r.y,n),z:e.number(t.z,r.z,n)}};var V=new e.Properties({anchor:new e.DataConstantProperty(e.default$5.light.anchor),position:new j,color:new e.DataConstantProperty(e.default$5.light.color),intensity:new e.DataConstantProperty(e.default$5.light.intensity)}),q=function(t){function r(r){t.call(this),this._transitionable=new e.Transitionable(V),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.getLight=function(){return this._transitionable.serialize()},r.prototype.setLight=function(t){if(!this._validate(e.validateLight,t))for(var r in t){var n=t[r];e.endsWith(r,"-transition")?this._transitionable.setTransition(r.slice(0,-"-transition".length),n):this._transitionable.setValue(r,n)}},r.prototype.updateTransitions=function(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)},r.prototype.hasTransition=function(){return this._transitioning.hasTransition()},r.prototype.recalculate=function(e){this.properties=this._transitioning.possiblyEvaluate(e)},r.prototype._validate=function(t,r){return e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:e.default$5})))},r}(e.Evented),U=function(e,t){this.width=e,this.height=t,this.nextRow=0,this.bytes=4,this.data=new Uint8Array(this.width*this.height*this.bytes),this.positions={}};U.prototype.getDash=function(e,t){var r=e.join(",")+String(t);return this.positions[r]||(this.positions[r]=this.addDash(e,t)),this.positions[r]},U.prototype.addDash=function(t,r){var n=r?7:0,i=2*n+1;if(this.nextRow+i>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var a=0,o=0;o<t.length;o++)a+=t[o];for(var s=this.width/a,l=s/2,u=t.length%2==1,c=-n;c<=n;c++)for(var f=this.nextRow+n+c,h=this.width*f,p=u?-t[t.length-1]:0,d=t[0],v=1,m=0;m<this.width;m++){for(;d<m/s;)p=d,d+=t[v],u&&v===t.length-1&&(d+=t[0]),v++;var g=Math.abs(m-p*s),y=Math.abs(m-d*s),_=Math.min(g,y),x=v%2==1,b=void 0;if(r){var w=n?c/n*(l+1):0;if(x){var k=l-Math.abs(w);b=Math.sqrt(_*_+k*k)}else b=l-Math.sqrt(_*_+w*w)}else b=(x?1:-1)*_;this.data[3+4*(h+m)]=Math.max(0,Math.min(255,b+128))}var A={y:(this.nextRow+n+.5)/this.height,height:2*n/this.height,width:a};return this.nextRow+=i,this.dirty=!0,A},U.prototype.bind=function(e){var t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.RGBA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,this.data))};var Z=function t(r,n){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var i=this.workerPool.acquire(this.id),a=0;a<i.length;a++){var o=i[a],s=new t.Actor(o,n,this.id);s.name="Worker "+a,this.actors.push(s)}};function H(t,r,n){var i=function(t,r){if(t)return n(t);if(r){var i=e.pick(r,["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds"]);r.vector_layers&&(i.vectorLayers=r.vector_layers,i.vectorLayerIds=i.vectorLayers.map(function(e){return e.id})),n(null,i)}};t.url?e.getJSON(r(b(t.url),e.ResourceType.Source),i):a.frame(function(){return i(null,t)})}Z.prototype.broadcast=function(t,r,n){n=n||function(){},e.asyncAll(this.actors,function(e,n){e.send(t,r,n)},n)},Z.prototype.send=function(e,t,r,n){return("number"!=typeof n||isNaN(n))&&(n=this.currentActor=(this.currentActor+1)%this.actors.length),this.actors[n].send(e,t,r),n},Z.prototype.remove=function(){this.actors.forEach(function(e){e.remove()}),this.actors=[],this.workerPool.release(this.id)},Z.Actor=e.default$7;var G=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};G.prototype.wrap=function(){return new G(e.wrap(this.lng,-180,180),this.lat)},G.prototype.toArray=function(){return[this.lng,this.lat]},G.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},G.prototype.toBounds=function(e){var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new $(new G(this.lng-r,this.lat-t),new G(this.lng+r,this.lat+t))},G.convert=function(e){if(e instanceof G)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new G(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new G(Number(e.lng),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var $=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};$.prototype.setNorthEast=function(e){return this._ne=e instanceof G?new G(e.lng,e.lat):G.convert(e),this},$.prototype.setSouthWest=function(e){return this._sw=e instanceof G?new G(e.lng,e.lat):G.convert(e),this},$.prototype.extend=function(e){var t,r,n=this._sw,i=this._ne;if(e instanceof G)t=e,r=e;else{if(!(e instanceof $))return Array.isArray(e)?e.every(Array.isArray)?this.extend($.convert(e)):this.extend(G.convert(e)):this;if(t=e._sw,r=e._ne,!t||!r)return this}return n||i?(n.lng=Math.min(t.lng,n.lng),n.lat=Math.min(t.lat,n.lat),i.lng=Math.max(r.lng,i.lng),i.lat=Math.max(r.lat,i.lat)):(this._sw=new G(t.lng,t.lat),this._ne=new G(r.lng,r.lat)),this},$.prototype.getCenter=function(){return new G((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},$.prototype.getSouthWest=function(){return this._sw},$.prototype.getNorthEast=function(){return this._ne},$.prototype.getNorthWest=function(){return new G(this.getWest(),this.getNorth())},$.prototype.getSouthEast=function(){return new G(this.getEast(),this.getSouth())},$.prototype.getWest=function(){return this._sw.lng},$.prototype.getSouth=function(){return this._sw.lat},$.prototype.getEast=function(){return this._ne.lng},$.prototype.getNorth=function(){return this._ne.lat},$.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},$.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},$.prototype.isEmpty=function(){return!(this._sw&&this._ne)},$.convert=function(e){return!e||e instanceof $?e:new $(e)};var W=function(e,t,r){this.bounds=$.convert(this.validateBounds(e)),this.minzoom=t||0,this.maxzoom=r||24};W.prototype.validateBounds=function(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]},W.prototype.contains=function(e){var t=Math.floor(this.lngX(this.bounds.getWest(),e.z)),r=Math.floor(this.latY(this.bounds.getNorth(),e.z)),n=Math.ceil(this.lngX(this.bounds.getEast(),e.z)),i=Math.ceil(this.latY(this.bounds.getSouth(),e.z));return e.x>=t&&e.x<n&&e.y>=r&&e.y<i},W.prototype.lngX=function(e,t){return(e+180)*(Math.pow(2,t)/360)},W.prototype.latY=function(t,r){var n=e.clamp(Math.sin(Math.PI/180*t),-.9999,.9999),i=Math.pow(2,r)/(2*Math.PI);return Math.pow(2,r-1)+.5*Math.log((1+n)/(1-n))*-i};var X=function(t){function r(r,n,i,a){if(t.call(this),this.id=r,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,e.extend(this,e.pick(n,["url","scheme","tileSize"])),this._options=e.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(a)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.load=function(){var t=this;this.fire(new e.Event("dataloading",{dataType:"source"})),H(this._options,this.map._transformRequest,function(r,n){r?t.fire(new e.ErrorEvent(r)):n&&(e.extend(t,n),n.bounds&&(t.tileBounds=new W(n.bounds,t.minzoom,t.maxzoom)),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},r.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},r.prototype.onAdd=function(e){this.map=e,this.load()},r.prototype.serialize=function(){return e.extend({},this._options)},r.prototype.loadTile=function(t,r){var n=A(t.tileID.canonical.url(this.tiles,this.scheme),this.url),i={request:this.map._transformRequest(n,e.ResourceType.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};function o(e,n){return t.aborted?r(null):e?r(e):(n&&n.resourceTiming&&(t.resourceTiming=n.resourceTiming),this.map._refreshExpiredTiles&&t.setExpiryData(n),t.loadVectorData(n,this.map.painter),r(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}i.request.collectResourceTiming=this._collectResourceTiming,void 0===t.workerID||"expired"===t.state?t.workerID=this.dispatcher.send("loadTile",i,o.bind(this)):"loading"===t.state?t.reloadCallback=r:this.dispatcher.send("reloadTile",i,o.bind(this),t.workerID)},r.prototype.abortTile=function(e){this.dispatcher.send("abortTile",{uid:e.uid,type:this.type,source:this.id},void 0,e.workerID)},r.prototype.unloadTile=function(e){e.unloadVectorData(),this.dispatcher.send("removeTile",{uid:e.uid,type:this.type,source:this.id},void 0,e.workerID)},r.prototype.hasTransition=function(){return!1},r}(e.Evented),Y=function(t){function r(r,n,i,a){t.call(this),this.id=r,this.dispatcher=i,this.setEventedParent(a),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({},n),e.extend(this,e.pick(n,["url","scheme","tileSize"]))}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.load=function(){var t=this;this.fire(new e.Event("dataloading",{dataType:"source"})),H(this._options,this.map._transformRequest,function(r,n){r?t.fire(new e.ErrorEvent(r)):n&&(e.extend(t,n),n.bounds&&(t.tileBounds=new W(n.bounds,t.minzoom,t.maxzoom)),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),t.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},r.prototype.onAdd=function(e){this.map=e,this.load()},r.prototype.serialize=function(){return e.extend({},this._options)},r.prototype.hasTile=function(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)},r.prototype.loadTile=function(t,r){var n=this,i=A(t.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);t.request=e.getImage(this.map._transformRequest(i,e.ResourceType.Tile),function(e,i){if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(e)t.state="errored",r(e);else if(i){n.map._refreshExpiredTiles&&t.setExpiryData(i),delete i.cacheControl,delete i.expires;var a=n.map.painter.context,o=a.gl;t.texture=n.map.painter.getTileTexture(i.width),t.texture?t.texture.update(i,{useMipmap:!0}):(t.texture=new I(a,i,o.RGBA,{useMipmap:!0}),t.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE,o.LINEAR_MIPMAP_NEAREST),a.extTextureFilterAnisotropic&&o.texParameterf(o.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax)),t.state="loaded",r(null)}})},r.prototype.abortTile=function(e,t){e.request&&(e.request.abort(),delete e.request),t()},r.prototype.unloadTile=function(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()},r.prototype.hasTransition=function(){return!1},r}(e.Evented),J=function(t){function r(r,n,i,a){t.call(this,r,n,i,a),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({},n),this.encoding=n.encoding||"mapbox"}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},r.prototype.loadTile=function(t,r){var n=A(t.tileID.canonical.url(this.tiles,this.scheme),this.url,this.tileSize);t.request=e.getImage(this.map._transformRequest(n,e.ResourceType.Tile),function(e,n){if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(e)t.state="errored",r(e);else if(n){this.map._refreshExpiredTiles&&t.setExpiryData(n),delete n.cacheControl,delete n.expires;var i=a.getImageData(n),o={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:i,encoding:this.encoding};t.workerID&&"expired"!==t.state||(t.workerID=this.dispatcher.send("loadDEMTile",o,function(e,n){e&&(t.state="errored",r(e));n&&(t.dem=n,t.needsHillshadePrepare=!0,t.state="loaded",r(null))}.bind(this)))}}.bind(this)),t.neighboringTiles=this._getNeighboringTiles(t.tileID)},r.prototype._getNeighboringTiles=function(t){var r=t.canonical,n=Math.pow(2,r.z),i=(r.x-1+n)%n,a=0===r.x?t.wrap-1:t.wrap,o=(r.x+1+n)%n,s=r.x+1===n?t.wrap+1:t.wrap,l={};return l[new e.OverscaledTileID(t.overscaledZ,a,r.z,i,r.y).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,r.z,o,r.y).key]={backfilled:!1},r.y>0&&(l[new e.OverscaledTileID(t.overscaledZ,a,r.z,i,r.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,r.z,o,r.y-1).key]={backfilled:!1}),r.y+1<n&&(l[new e.OverscaledTileID(t.overscaledZ,a,r.z,i,r.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},l[new e.OverscaledTileID(t.overscaledZ,s,r.z,o,r.y+1).key]={backfilled:!1}),l},r.prototype.unloadTile=function(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",this.dispatcher.send("removeDEMTile",{uid:e.uid,source:this.id},void 0,e.workerID)},r}(Y),K=function(t){function r(r,n,i,a){t.call(this),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this.dispatcher=i,this.setEventedParent(a),this._data=n.data,this._options=e.extend({},n),this._collectResourceTiming=n.collectResourceTiming,this._resourceTiming=[],void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type);var o=e.default$8/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*o,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*o,extent:e.default$8,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?Math.min(n.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.default$8,radius:(n.clusterRadius||50)*o,log:!1}},n.workerOptions)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.load=function(){var t=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(r){if(r)t.fire(new e.ErrorEvent(r));else{var n={dataType:"source",sourceDataType:"metadata"};t._collectResourceTiming&&t._resourceTiming&&t._resourceTiming.length>0&&(n.resourceTiming=t._resourceTiming,t._resourceTiming=[]),t.fire(new e.Event("data",n))}})},r.prototype.onAdd=function(e){this.map=e,this.load()},r.prototype.setData=function(t){var r=this;return this._data=t,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(t){if(t)return r.fire(new e.ErrorEvent(t));var n={dataType:"source",sourceDataType:"content"};r._collectResourceTiming&&r._resourceTiming&&r._resourceTiming.length>0&&(n.resourceTiming=r._resourceTiming,r._resourceTiming=[]),r.fire(new e.Event("data",n))}),this},r.prototype._updateWorkerData=function(t){var r,n,i=this,a=e.extend({},this.workerOptions),o=this._data;"string"==typeof o?(a.request=this.map._transformRequest((r=o,(n=e.default.document.createElement("a")).href=r,n.href),e.ResourceType.Source),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(o),this.workerID=this.dispatcher.send(this.type+"."+a.source+".loadData",a,function(e,r){i._removed||r&&r.abandoned||(i._loaded=!0,r&&r.resourceTiming&&r.resourceTiming[i.id]&&(i._resourceTiming=r.resourceTiming[i.id].slice(0)),i.dispatcher.send(i.type+"."+a.source+".coalesce",null,null,i.workerID),t(e))},this.workerID)},r.prototype.loadTile=function(e,t){var r=this,n=void 0===e.workerID?"loadTile":"reloadTile",i={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes};e.workerID=this.dispatcher.send(n,i,function(i,a){return e.unloadVectorData(),e.aborted?t(null):i?t(i):(e.loadVectorData(a,r.map.painter,"reloadTile"===n),t(null))},this.workerID)},r.prototype.abortTile=function(e){e.aborted=!0},r.prototype.unloadTile=function(e){e.unloadVectorData(),this.dispatcher.send("removeTile",{uid:e.uid,type:this.type,source:this.id},null,e.workerID)},r.prototype.onRemove=function(){this._removed=!0,this.dispatcher.send("removeSource",{type:this.type,source:this.id},null,this.workerID)},r.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},r.prototype.hasTransition=function(){return!1},r}(e.Evented);var Q=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ee=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};ee.prototype.bind=function(e,t,r,n,i,a,o,s){this.context=e;for(var l=this.boundPaintVertexBuffers.length!==n.length,u=0;!l&&u<n.length;u++)this.boundPaintVertexBuffers[u]!==n[u]&&(l=!0);var c=!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==r||l||this.boundIndexBuffer!==i||this.boundVertexOffset!==a||this.boundDynamicVertexBuffer!==o||this.boundDynamicVertexBuffer2!==s;!e.extVertexArrayObject||c?this.freshBind(t,r,n,i,a,o,s):(e.bindVertexArrayOES.set(this.vao),o&&o.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind())},ee.prototype.freshBind=function(e,t,r,n,i,a,o){var s,l=e.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),s=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=o;else{s=u.currentNumAttributes||0;for(var f=l;f<s;f++)c.disableVertexAttribArray(f)}t.enableAttributes(c,e);for(var h=0,p=r;h<p.length;h+=1){p[h].enableAttributes(c,e)}a&&a.enableAttributes(c,e),o&&o.enableAttributes(c,e),t.bind(),t.setVertexAttribPointers(c,e,i);for(var d=0,v=r;d<v.length;d+=1){var m=v[d];m.bind(),m.setVertexAttribPointers(c,e,i)}a&&(a.bind(),a.setVertexAttribPointers(c,e,i)),n&&n.bind(),o&&(o.bind(),o.setVertexAttribPointers(c,e,i)),u.currentNumAttributes=l},ee.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var te=function(t){function r(e,r,n,i){t.call(this),this.id=e,this.dispatcher=n,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this.setEventedParent(i),this.options=r}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.load=function(){var t=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._transformRequest(this.url,e.ResourceType.Image),function(r,n){r?t.fire(new e.ErrorEvent(r)):n&&(t.image=a.getImageData(n),t._finishLoading())})},r.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},r.prototype.onAdd=function(e){this.map=e,this.load()},r.prototype.setCoordinates=function(t){this.coordinates=t;var r=this.map,n=t.map(function(e){return r.transform.locationCoordinate(G.convert(e)).zoomTo(0)}),i=this.centerCoord=e.getCoordinatesCenter(n);i.column=Math.floor(i.column),i.row=Math.floor(i.row),this.tileID=new e.CanonicalTileID(i.zoom,i.column,i.row),this.minzoom=this.maxzoom=i.zoom;var a=n.map(function(t){var r=t.zoomTo(i.zoom);return new e.default$1(Math.round((r.column-i.column)*e.default$8),Math.round((r.row-i.row)*e.default$8))});return this._boundsArray=new e.RasterBoundsArray,this._boundsArray.emplaceBack(a[0].x,a[0].y,0,0),this._boundsArray.emplaceBack(a[1].x,a[1].y,e.default$8,0),this._boundsArray.emplaceBack(a[3].x,a[3].y,0,e.default$8),this._boundsArray.emplaceBack(a[2].x,a[2].y,e.default$8,e.default$8),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},r.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var e=this.map.painter.context,t=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,Q.members)),this.boundsVAO||(this.boundsVAO=new ee),this.texture||(this.texture=new I(e,this.image,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE)),this.tiles){var n=this.tiles[r];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture)}}},r.prototype.loadTile=function(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))},r.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},r.prototype.hasTransition=function(){return!1},r}(e.Evented),re=function(t){function r(e,r,n,i){t.call(this,e,r,n,i),this.roundZoom=!0,this.type="video",this.options=r}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.load=function(){var t=this,r=this.options;this.urls=[];for(var n=0,i=r.urls;n<i.length;n+=1){var a=i[n];t.urls.push(t.map._transformRequest(a,e.ResourceType.Source).url)}e.getVideo(this.urls,function(r,n){r?t.fire(new e.ErrorEvent(r)):n&&(t.video=n,t.video.loop=!0,t.video.addEventListener("playing",function(){t.map._rerender()}),t.map&&t.video.play(),t._finishLoading())})},r.prototype.getVideo=function(){return this.video},r.prototype.onAdd=function(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},r.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var e=this.map.painter.context,t=e.gl;for(var r in this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,Q.members)),this.boundsVAO||(this.boundsVAO=new ee),this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new I(e,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE)),this.tiles){var n=this.tiles[r];"loaded"!==n.state&&(n.state="loaded",n.texture=this.texture)}}},r.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},r.prototype.hasTransition=function(){return this.video&&!this.video.paused},r}(te),ne=function(t){function r(r,n,i,a){t.call(this,r,n,i,a),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(function(e){return!Array.isArray(e)||2!==e.length||e.some(function(e){return"number"!=typeof e})})||this.fire(new e.ErrorEvent(new e.default$9("sources."+r,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.default$9("sources."+r,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new e.ErrorEvent(new e.default$9("sources."+r,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof e.default.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.default$9("sources."+r,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.default$9("sources."+r,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.load=function(){this.canvas||(this.canvas=this.options.canvas instanceof e.default.HTMLCanvasElement?this.options.canvas:e.default.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map._rerender()},this.pause=function(){this._playing=!1},this._finishLoading())},r.prototype.getCanvas=function(){return this.canvas},r.prototype.onAdd=function(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()},r.prototype.onRemove=function(){this.pause()},r.prototype.prepare=function(){var e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var t=this.map.painter.context,r=t.gl;for(var n in this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Q.members)),this.boundsVAO||(this.boundsVAO=new ee),this.texture?e?this.texture.update(this.canvas):this._playing&&(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.canvas)):(this.texture=new I(t,this.canvas,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this.tiles){var i=this.tiles[n];"loaded"!==i.state&&(i.state="loaded",i.texture=this.texture)}}},r.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},r.prototype.hasTransition=function(){return this._playing},r.prototype._hasInvalidDimensions=function(){for(var e=0,t=[this.canvas.width,this.canvas.height];e<t.length;e+=1){var r=t[e];if(isNaN(r)||r<=0)return!0}return!1},r}(te),ie={vector:X,raster:Y,"raster-dem":J,geojson:K,video:re,image:te,canvas:ne},ae=function(t,r,n,i){var a=new ie[r.type](t,r,n,i);if(a.id!==t)throw new Error("Expected Source id to be "+t+" instead of "+a.id);return e.bindAll(["load","abort","unload","serialize","prepare"],a),a};function oe(e,t,r,n,i){var a=i.maxPitchScaleFactor(),o=e.tilesIn(r,a);o.sort(se);for(var s=[],l=0,u=o;l<u.length;l+=1){var c=u[l];s.push({wrappedTileID:c.tileID.wrapped().key,queryResults:c.tile.queryRenderedFeatures(t,c.queryGeometry,c.scale,n,i,a,e.transform.calculatePosMatrix(c.tileID.toUnwrapped()))})}return function(e){for(var t={},r={},n=0,i=e;n<i.length;n+=1){var a=i[n],o=a.queryResults,s=a.wrappedTileID,l=r[s]=r[s]||{};for(var u in o)for(var c=o[u],f=l[u]=l[u]||{},h=t[u]=t[u]||[],p=0,d=c;p<d.length;p+=1){var v=d[p];f[v.featureIndex]||(f[v.featureIndex]=!0,h.push(v.feature))}}return t}(s)}function se(e,t){var r=e.tileID,n=t.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}var le=function(t,r){this.tileID=t,this.uid=e.uniqueId(),this.uses=0,this.tileSize=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.expiredRequestCount=0,this.state="loading"};le.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<a.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},le.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},le.prototype.loadVectorData=function(t,r,n){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){if(t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(e,t){var r={};if(!t)return r;for(var n=0,i=e;n<i.length;n+=1){var a=i[n],o=a.layerIds.map(function(e){return t.getLayer(e)}).filter(Boolean);if(0!==o.length){a.layers=o;for(var s=0,l=o;s<l.length;s+=1)r[l[s].id]=a}}return r}(t.buckets,r.style),n)for(var i in this.buckets){var a=this.buckets[i];a instanceof e.default$14&&(a.justReloaded=!0)}for(var o in this.queryPadding=0,this.buckets){var s=this.buckets[o];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(s.layerIds[0]).queryRadius(s))}t.iconAtlasImage&&(this.iconAtlasImage=t.iconAtlasImage),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new e.CollisionBoxArray},le.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.iconAtlasTexture&&this.iconAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},le.prototype.unloadDEMData=function(){this.dem=null,this.neighboringTiles=null,this.state="unloaded"},le.prototype.getBucket=function(e){return this.buckets[e.id]},le.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploaded||(r.upload(e),r.uploaded=!0)}var n=e.gl;this.iconAtlasImage&&(this.iconAtlasTexture=new I(e,this.iconAtlasImage,n.RGBA),this.iconAtlasImage=null),this.glyphAtlasImage&&(this.glyphAtlasTexture=new I(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null)},le.prototype.queryRenderedFeatures=function(e,t,r,n,i,a,o){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:t,scale:r,tileSize:this.tileSize,posMatrix:o,transform:i,params:n,queryPadding:this.queryPadding*a},e):{}},le.prototype.querySourceFeatures=function(t,r){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData){var n=this.latestFeatureIndex.loadVTLayers(),i=r?r.sourceLayer:"",a=n._geojsonTileLayer||n[i];if(a)for(var o=e.default$13(r&&r.filter),s={z:this.tileID.overscaledZ,x:this.tileID.canonical.x,y:this.tileID.canonical.y},l=0;l<a.length;l++){var u=a.feature(l);if(o(new e.default$16(this.tileID.overscaledZ),u)){var c=new e.default$12(u,s.z,s.x,s.y);c.tile=s,t.push(c)}}}},le.prototype.clearMask=function(){this.segments&&(this.segments.destroy(),delete this.segments),this.maskedBoundsBuffer&&(this.maskedBoundsBuffer.destroy(),delete this.maskedBoundsBuffer),this.maskedIndexBuffer&&(this.maskedIndexBuffer.destroy(),delete this.maskedIndexBuffer)},le.prototype.setMask=function(t,r){if(!e.default$10(this.mask,t)&&(this.mask=t,this.clearMask(),!e.default$10(t,{0:!0}))){var n=new e.RasterBoundsArray,i=new e.TriangleIndexArray;this.segments=new e.default$15,this.segments.prepareSegment(0,n,i);for(var a=Object.keys(t),o=0;o<a.length;o++){var s=t[a[o]],l=e.default$8>>s.z,u=new e.default$1(s.x*l,s.y*l),c=new e.default$1(u.x+l,u.y+l),f=this.segments.prepareSegment(4,n,i);n.emplaceBack(u.x,u.y,u.x,u.y),n.emplaceBack(c.x,u.y,c.x,u.y),n.emplaceBack(u.x,c.y,u.x,c.y),n.emplaceBack(c.x,c.y,c.x,c.y);var h=f.vertexLength;i.emplaceBack(h,h+1,h+2),i.emplaceBack(h+1,h+2,h+3),f.vertexLength+=4,f.primitiveLength+=2}this.maskedBoundsBuffer=r.createVertexBuffer(n,Q.members),this.maskedIndexBuffer=r.createIndexBuffer(i)}},le.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},le.prototype.setExpiryData=function(t){var r=this.expirationTime;if(t.cacheControl){var n=e.parseCacheControl(t.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var i=Date.now(),a=!1;if(this.expirationTime>i)a=!1;else if(r)if(this.expirationTime<r)a=!0;else{var o=this.expirationTime-r;o?this.expirationTime=i+Math.max(o,3e4):a=!0}else a=!0;a?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},le.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)};var ue=function(e,t){this.max=e,this.onRemove=t,this.reset()};ue.prototype.reset=function(){for(var e in this.data)for(var t=0,r=this.data[e];t<r.length;t+=1){var n=r[t];n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value)}return this.data={},this.order=[],this},ue.prototype.add=function(e,t,r){var n=this,i=e.wrapped().key;void 0===this.data[i]&&(this.data[i]=[]);var a={value:t,timeout:void 0};if(void 0!==r&&(a.timeout=setTimeout(function(){n.remove(e,a)},r)),this.data[i].push(a),this.order.push(i),this.order.length>this.max){var o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this},ue.prototype.has=function(e){return e.wrapped().key in this.data},ue.prototype.getAndRemove=function(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null},ue.prototype._getAndRemoveByKey=function(e){var t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value},ue.prototype.get=function(e){return this.has(e)?this.data[e.wrapped().key][0].value:null},ue.prototype.remove=function(e,t){if(!this.has(e))return this;var r=e.wrapped().key,n=void 0===t?0:this.data[r].indexOf(t),i=this.data[r][n];return this.data[r].splice(n,1),i.timeout&&clearTimeout(i.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(i.value),this.order.splice(this.order.indexOf(r),1),this},ue.prototype.setMaxSize=function(e){for(this.max=e;this.order.length>this.max;){var t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this};var ce=function(e,t,r){this.context=e;var n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};ce.prototype.unbindVAO=function(){this.context.extVertexArrayObject&&this.context.bindVertexArrayOES.set(null)},ce.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},ce.prototype.updateData=function(e){var t=this.context.gl;this.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)},ce.prototype.destroy=function(){var e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)};var fe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},he=function(e,t,r,n){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;var i=e.gl;this.buffer=i.createBuffer(),e.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer};he.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},he.prototype.updateData=function(e){var t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)},he.prototype.enableAttributes=function(e,t){for(var r=0;r<this.attributes.length;r++){var n=this.attributes[r],i=t.attributes[n.name];void 0!==i&&e.enableVertexAttribArray(i)}},he.prototype.setVertexAttribPointers=function(e,t,r){for(var n=0;n<this.attributes.length;n++){var i=this.attributes[n],a=t.attributes[i.name];void 0!==a&&e.vertexAttribPointer(a,i.components,e[fe[i.type]],!1,this.itemSize,i.offset+this.itemSize*(r||0))}},he.prototype.destroy=function(){var e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)};var pe=function(t){this.context=t,this.current=e.default$6.transparent};pe.prototype.get=function(){return this.current},pe.prototype.set=function(e){var t=this.current;e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a||(this.context.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e)};var de=function(e){this.context=e,this.current=1};de.prototype.get=function(){return this.current},de.prototype.set=function(e){this.current!==e&&(this.context.gl.clearDepth(e),this.current=e)};var ve=function(e){this.context=e,this.current=0};ve.prototype.get=function(){return this.current},ve.prototype.set=function(e){this.current!==e&&(this.context.gl.clearStencil(e),this.current=e)};var me=function(e){this.context=e,this.current=[!0,!0,!0,!0]};me.prototype.get=function(){return this.current},me.prototype.set=function(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]||(this.context.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e)};var ge=function(e){this.context=e,this.current=!0};ge.prototype.get=function(){return this.current},ge.prototype.set=function(e){this.current!==e&&(this.context.gl.depthMask(e),this.current=e)};var ye=function(e){this.context=e,this.current=255};ye.prototype.get=function(){return this.current},ye.prototype.set=function(e){this.current!==e&&(this.context.gl.stencilMask(e),this.current=e)};var _e=function(e){this.context=e,this.current={func:e.gl.ALWAYS,ref:0,mask:255}};_e.prototype.get=function(){return this.current},_e.prototype.set=function(e){var t=this.current;e.func===t.func&&e.ref===t.ref&&e.mask===t.mask||(this.context.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e)};var xe=function(e){this.context=e;var t=this.context.gl;this.current=[t.KEEP,t.KEEP,t.KEEP]};xe.prototype.get=function(){return this.current},xe.prototype.set=function(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]||(this.context.gl.stencilOp(e[0],e[1],e[2]),this.current=e)};var be=function(e){this.context=e,this.current=!1};be.prototype.get=function(){return this.current},be.prototype.set=function(e){if(this.current!==e){var t=this.context.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e}};var we=function(e){this.context=e,this.current=[0,1]};we.prototype.get=function(){return this.current},we.prototype.set=function(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]||(this.context.gl.depthRange(e[0],e[1]),this.current=e)};var ke=function(e){this.context=e,this.current=!1};ke.prototype.get=function(){return this.current},ke.prototype.set=function(e){if(this.current!==e){var t=this.context.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e}};var Ae=function(e){this.context=e,this.current=e.gl.LESS};Ae.prototype.get=function(){return this.current},Ae.prototype.set=function(e){this.current!==e&&(this.context.gl.depthFunc(e),this.current=e)};var Te=function(e){this.context=e,this.current=!1};Te.prototype.get=function(){return this.current},Te.prototype.set=function(e){if(this.current!==e){var t=this.context.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e}};var Me=function(e){this.context=e;var t=this.context.gl;this.current=[t.ONE,t.ZERO]};Me.prototype.get=function(){return this.current},Me.prototype.set=function(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]||(this.context.gl.blendFunc(e[0],e[1]),this.current=e)};var Se=function(t){this.context=t,this.current=e.default$6.transparent};Se.prototype.get=function(){return this.current},Se.prototype.set=function(e){var t=this.current;e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a||(this.context.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e)};var Ce=function(e){this.context=e,this.current=null};Ce.prototype.get=function(){return this.current},Ce.prototype.set=function(e){this.current!==e&&(this.context.gl.useProgram(e),this.current=e)};var ze=function(e){this.context=e,this.current=1};ze.prototype.get=function(){return this.current},ze.prototype.set=function(t){var r=this.context.lineWidthRange,n=e.clamp(t,r[0],r[1]);this.current!==n&&(this.context.gl.lineWidth(n),this.current=t)};var Ee=function(e){this.context=e,this.current=e.gl.TEXTURE0};Ee.prototype.get=function(){return this.current},Ee.prototype.set=function(e){this.current!==e&&(this.context.gl.activeTexture(e),this.current=e)};var Le=function(e){this.context=e;var t=this.context.gl;this.current=[0,0,t.drawingBufferWidth,t.drawingBufferHeight]};Le.prototype.get=function(){return this.current},Le.prototype.set=function(e){var t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]||(this.context.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e)};var Ie=function(e){this.context=e,this.current=null};Ie.prototype.get=function(){return this.current},Ie.prototype.set=function(e){if(this.current!==e){var t=this.context.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e}};var Pe=function(e){this.context=e,this.current=null};Pe.prototype.get=function(){return this.current},Pe.prototype.set=function(e){if(this.current!==e){var t=this.context.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e}};var De=function(e){this.context=e,this.current=null};De.prototype.get=function(){return this.current},De.prototype.set=function(e){if(this.current!==e){var t=this.context.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e}};var Oe=function(e){this.context=e,this.current=null};Oe.prototype.get=function(){return this.current},Oe.prototype.set=function(e){if(this.current!==e){var t=this.context.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e}};var Re=function(e){this.context=e,this.current=null};Re.prototype.get=function(){return this.current},Re.prototype.set=function(e){var t=this.context.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e};var Fe=function(e){this.context=e,this.current=null};Fe.prototype.get=function(){return this.current},Fe.prototype.set=function(e){this.current!==e&&this.context.extVertexArrayObject&&(this.context.extVertexArrayObject.bindVertexArrayOES(e),this.current=e)};var Be=function(e){this.context=e,this.current=4};Be.prototype.get=function(){return this.current},Be.prototype.set=function(e){if(this.current!==e){var t=this.context.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e}};var Ne=function(e){this.context=e,this.current=!1};Ne.prototype.get=function(){return this.current},Ne.prototype.set=function(e){if(this.current!==e){var t=this.context.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e}};var je=function(e,t){this.context=e,this.current=null,this.parent=t};je.prototype.get=function(){return this.current};var Ve=function(e){function t(t,r){e.call(this,t,r),this.dirty=!1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.set=function(e){if(this.dirty||this.current!==e){var t=this.context.gl;this.context.bindFramebuffer.set(this.parent),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}},t.prototype.setDirty=function(){this.dirty=!0},t}(je),qe=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.set=function(e){if(this.current!==e){var t=this.context.gl;this.context.bindFramebuffer.set(this.parent),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e}},t}(je),Ue=function(e,t,r){this.context=e,this.width=t,this.height=r;var n=e.gl,i=this.framebuffer=n.createFramebuffer();this.colorAttachment=new Ve(e,i),this.depthAttachment=new qe(e,i)};Ue.prototype.destroy=function(){var e=this.context.gl,t=this.colorAttachment.get();t&&e.deleteTexture(t);var r=this.depthAttachment.get();r&&e.deleteRenderbuffer(r),e.deleteFramebuffer(this.framebuffer)};var Ze=function(e,t,r){this.func=e,this.mask=t,this.range=r};Ze.ReadOnly=!1,Ze.ReadWrite=!0,Ze.disabled=new Ze(519,Ze.ReadOnly,[0,1]);var He=function(e,t,r,n,i,a){this.test=e,this.ref=t,this.mask=r,this.fail=n,this.depthFail=i,this.pass=a};He.disabled=new He({func:519,mask:0},0,0,7680,7680,7680);var Ge=function(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r};Ge.Replace=[1,0],Ge.disabled=new Ge(Ge.Replace,e.default$6.transparent,[!1,!1,!1,!1]),Ge.unblended=new Ge(Ge.Replace,e.default$6.transparent,[!0,!0,!0,!0]),Ge.alphaBlended=new Ge([1,771],e.default$6.transparent,[!0,!0,!0,!0]);var $e=function(e){this.gl=e,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.lineWidthRange=e.getParameter(e.ALIASED_LINE_WIDTH_RANGE),this.clearColor=new pe(this),this.clearDepth=new de(this),this.clearStencil=new ve(this),this.colorMask=new me(this),this.depthMask=new ge(this),this.stencilMask=new ye(this),this.stencilFunc=new _e(this),this.stencilOp=new xe(this),this.stencilTest=new be(this),this.depthRange=new we(this),this.depthTest=new ke(this),this.depthFunc=new Ae(this),this.blend=new Te(this),this.blendFunc=new Me(this),this.blendColor=new Se(this),this.program=new Ce(this),this.lineWidth=new ze(this),this.activeTexture=new Ee(this),this.viewport=new Le(this),this.bindFramebuffer=new Ie(this),this.bindRenderbuffer=new Pe(this),this.bindTexture=new De(this),this.bindVertexBuffer=new Oe(this),this.bindElementBuffer=new Re(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Fe(this),this.pixelStoreUnpack=new Be(this),this.pixelStoreUnpackPremultiplyAlpha=new Ne(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=e.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&e.getExtension("OES_texture_half_float_linear")};$e.prototype.createIndexBuffer=function(e,t){return new ce(this,e,t)},$e.prototype.createVertexBuffer=function(e,t,r){return new he(this,e,t,r)},$e.prototype.createRenderbuffer=function(e,t,r){var n=this.gl,i=n.createRenderbuffer();return this.bindRenderbuffer.set(i),n.renderbufferStorage(n.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),i},$e.prototype.createFramebuffer=function(e,t){return new Ue(this,e,t)},$e.prototype.clear=function(e){var t=e.color,r=e.depth,n=this.gl,i=0;t&&(i|=n.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==r&&(i|=n.DEPTH_BUFFER_BIT,this.clearDepth.set(r),this.depthMask.set(!0)),n.clear(i)},$e.prototype.setDepthMode=function(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)},$e.prototype.setStencilMode=function(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)},$e.prototype.setColorMode=function(t){e.default$10(t.blendFunction,Ge.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)};var We=function(t){function r(e,r,n){var i=this;t.call(this),this.id=e,this.dispatcher=n,this.on("data",function(e){"source"===e.dataType&&"metadata"===e.sourceDataType&&(i._sourceLoaded=!0),i._sourceLoaded&&!i._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(i.reload(),i.transform&&i.update(i.transform))}),this.on("error",function(){i._sourceErrored=!0}),this._source=ae(e,r,n,this),this._tiles={},this._cache=new ue(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._isIdRenderable=this._isIdRenderable.bind(this),this._coveredTiles={}}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.onAdd=function(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(e)},r.prototype.onRemove=function(e){this._source&&this._source.onRemove&&this._source.onRemove(e)},r.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;for(var e in this._tiles){var t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0},r.prototype.getSource=function(){return this._source},r.prototype.pause=function(){this._paused=!0},r.prototype.resume=function(){if(this._paused){var e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}},r.prototype._loadTile=function(e,t){return this._source.loadTile(e,t)},r.prototype._unloadTile=function(e){if(this._source.unloadTile)return this._source.unloadTile(e,function(){})},r.prototype._abortTile=function(e){if(this._source.abortTile)return this._source.abortTile(e,function(){})},r.prototype.serialize=function(){return this._source.serialize()},r.prototype.prepare=function(e){for(var t in this._source.prepare&&this._source.prepare(),this._tiles)this._tiles[t].upload(e)},r.prototype.getIds=function(){var t=this;return Object.keys(this._tiles).map(Number).sort(function(r,n){var i=t._tiles[r].tileID,a=t._tiles[n].tileID,o=new e.default$1(i.canonical.x,i.canonical.y).rotate(t.transform.angle),s=new e.default$1(a.canonical.x,a.canonical.y).rotate(t.transform.angle);return i.overscaledZ-a.overscaledZ||s.y-o.y||s.x-o.x})},r.prototype.getRenderableIds=function(){return this.getIds().filter(this._isIdRenderable)},r.prototype.hasRenderableParent=function(e){var t=this.findLoadedParent(e,0,{});return!!t&&this._isIdRenderable(t.tileID.key)},r.prototype._isIdRenderable=function(e){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]},r.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var e in this._cache.reset(),this._tiles)this._reloadTile(e,"reloading")},r.prototype._reloadTile=function(e,t){var r=this._tiles[e];r&&("loading"!==r.state&&(r.state=t),this._loadTile(r,this._tileLoaded.bind(this,r,e,t)))},r.prototype._tileLoaded=function(t,r,n,i){if(i)return t.state="errored",void(404!==i.status?this._source.fire(new e.ErrorEvent(i,{tile:t})):this.update(this.transform));t.timeAdded=a.now(),"expired"===n&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(r,t),"raster-dem"===this.getSource().type&&t.dem&&this._backfillDEM(t),this._source.fire(new e.Event("data",{dataType:"source",tile:t,coord:t.tileID})),this.map&&(this.map.painter.tileExtentVAO.vao=null)},r.prototype._backfillDEM=function(e){for(var t=this.getRenderableIds(),r=0;r<t.length;r++){var n=t[r];if(e.neighboringTiles&&e.neighboringTiles[n]){var i=this.getTileByID(n);a(e,i),a(i,e)}}function a(e,t){e.needsHillshadePrepare=!0;var r=t.tileID.canonical.x-e.tileID.canonical.x,n=t.tileID.canonical.y-e.tileID.canonical.y,i=Math.pow(2,e.tileID.canonical.z),a=t.tileID.key;0===r&&0===n||Math.abs(n)>1||(Math.abs(r)>1&&(1===Math.abs(r+i)?r+=i:1===Math.abs(r-i)&&(r-=i)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,r,n),e.neighboringTiles&&e.neighboringTiles[a]&&(e.neighboringTiles[a].backfilled=!0)))}},r.prototype.getTile=function(e){return this.getTileByID(e.key)},r.prototype.getTileByID=function(e){return this._tiles[e]},r.prototype.getZoom=function(e){return e.zoom+e.scaleZoom(e.tileSize/this._source.tileSize)},r.prototype._findLoadedChildren=function(e,t,r){var n=!1;for(var i in this._tiles){var a=this._tiles[i];if(!(r[i]||!a.hasData()||a.tileID.overscaledZ<=e.overscaledZ||a.tileID.overscaledZ>t)){var o=Math.pow(2,a.tileID.canonical.z-e.canonical.z);if(Math.floor(a.tileID.canonical.x/o)===e.canonical.x&&Math.floor(a.tileID.canonical.y/o)===e.canonical.y)for(r[i]=a.tileID,n=!0;a&&a.tileID.overscaledZ-1>e.overscaledZ;){var s=a.tileID.scaledTo(a.tileID.overscaledZ-1);if(!s)break;(a=this._tiles[s.key])&&a.hasData()&&(delete r[i],r[s.key]=s)}}}return n},r.prototype.findLoadedParent=function(e,t,r){for(var n=e.overscaledZ-1;n>=t;n--){var i=e.scaledTo(n);if(!i)return;var a=String(i.key),o=this._tiles[a];if(o&&o.hasData())return r[a]=i,o;if(this._cache.has(i))return r[a]=i,this._cache.get(i)}},r.prototype.updateCacheSize=function(e){var t=(Math.ceil(e.width/this._source.tileSize)+1)*(Math.ceil(e.height/this._source.tileSize)+1),r=Math.floor(5*t),n="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,r):r;this._cache.setMaxSize(n)},r.prototype.handleWrapJump=function(e){var t=(e-(void 0===this._prevLng?e:this._prevLng))/360,r=Math.round(t);if(this._prevLng=e,r){var n={};for(var i in this._tiles){var a=this._tiles[i];a.tileID=a.tileID.unwrapTo(a.tileID.wrap+r),n[a.tileID.key]=a}for(var o in this._tiles=n,this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(var s in this._tiles){var l=this._tiles[s];this._setTileReloadTimer(s,l)}}},r.prototype.update=function(t){var n=this;if(this.transform=t,this._sourceLoaded&&!this._paused){var i;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?i=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(t){return new e.OverscaledTileID(t.canonical.z,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y)}):(i=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(i=i.filter(function(e){return n._source.hasTile(e)}))):i=[];var o,s=(this._source.roundZoom?Math.round:Math.floor)(this.getZoom(t)),l=Math.max(s-r.maxOverzooming,this._source.minzoom),u=Math.max(s+r.maxUnderzooming,this._source.minzoom),c=this._updateRetainedTiles(i,s),f={};if(Ye(this._source.type))for(var h=Object.keys(c),p=0;p<h.length;p++){var d=h[p],v=c[d],m=n._tiles[d];if(m&&(void 0===m.fadeEndTime||m.fadeEndTime>=a.now())){n._findLoadedChildren(v,u,c)&&(c[d]=v);var g=n.findLoadedParent(v,l,f);g&&n._addTile(g.tileID)}}for(o in f)c[o]||(n._coveredTiles[o]=!0);for(o in f)c[o]=f[o];for(var y=e.keysDifference(this._tiles,c),_=0;_<y.length;_++)n._removeTile(y[_])}},r.prototype._updateRetainedTiles=function(e,t){for(var n={},i={},a=Math.max(t-r.maxOverzooming,this._source.minzoom),o=Math.max(t+r.maxUnderzooming,this._source.minzoom),s=0;s<e.length;s++){var l=e[s],u=this._addTile(l),c=!1;if(u.hasData())n[l.key]=l;else{c=u.wasRequested(),n[l.key]=l;var f=!0;if(t+1>this._source.maxzoom){var h=l.children(this._source.maxzoom)[0],p=this.getTile(h);p&&p.hasData()?n[h.key]=h:f=!1}else{this._findLoadedChildren(l,o,n);for(var d=l.children(this._source.maxzoom),v=0;v<d.length;v++)if(!n[d[v].key]){f=!1;break}}if(!f)for(var m=l.overscaledZ-1;m>=a;--m){var g=l.scaledTo(m);if(i[g.key])break;if(i[g.key]=!0,!(u=this.getTile(g))&&c&&(u=this._addTile(g)),u&&(n[g.key]=g,c=u.wasRequested(),u.hasData()))break}}}return n},r.prototype._addTile=function(t){var r=this._tiles[t.key];if(r)return r;(r=this._cache.getAndRemove(t))&&(this._setTileReloadTimer(t.key,r),r.tileID=t);var n=Boolean(r);return n||(r=new le(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(r,this._tileLoaded.bind(this,r,t.key,r.state))),r?(r.uses++,this._tiles[t.key]=r,n||this._source.fire(new e.Event("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null},r.prototype._setTileReloadTimer=function(e,t){var r=this;e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);var n=t.getExpiryTimeout();n&&(this._timers[e]=setTimeout(function(){r._reloadTile(e,"expired"),delete r._timers[e]},n))},r.prototype._removeTile=function(e){var t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))},r.prototype.clearTiles=function(){for(var e in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(e);this._cache.reset()},r.prototype.tilesIn=function(t,r){for(var n=[],i=this.getIds(),a=1/0,o=1/0,s=-1/0,l=-1/0,u=t[0].zoom,c=0;c<t.length;c++){var f=t[c];a=Math.min(a,f.column),o=Math.min(o,f.row),s=Math.max(s,f.column),l=Math.max(l,f.row)}for(var h=0;h<i.length;h++){var p=this._tiles[i[h]],d=p.tileID,v=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),m=r*p.queryPadding*e.default$8/p.tileSize/v,g=[Xe(d,new e.default$17(a,o,u)),Xe(d,new e.default$17(s,l,u))];if(g[0].x-m<e.default$8&&g[0].y-m<e.default$8&&g[1].x+m>=0&&g[1].y+m>=0){for(var y=[],_=0;_<t.length;_++)y.push(Xe(d,t[_]));n.push({tile:p,tileID:d,queryGeometry:[y],scale:v})}}return n},r.prototype.getVisibleCoordinates=function(){for(var e=this,t=this.getRenderableIds().map(function(t){return e._tiles[t].tileID}),r=0,n=t;r<n.length;r+=1){var i=n[r];i.posMatrix=e.transform.calculatePosMatrix(i.toUnwrapped())}return t},r.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Ye(this._source.type))for(var e in this._tiles){var t=this._tiles[e];if(void 0!==t.fadeEndTime&&t.fadeEndTime>=a.now())return!0}return!1},r}(e.Evented);function Xe(t,r){var n=r.zoomTo(t.canonical.z);return new e.default$1((n.column-(t.canonical.x+t.wrap*Math.pow(2,t.canonical.z)))*e.default$8,(n.row-t.canonical.y)*e.default$8)}function Ye(e){return"raster"===e||"image"===e||"video"===e}function Je(){return new e.default.Worker(En.workerUrl)}We.maxOverzooming=10,We.maxUnderzooming=3;var Ke,Qe=function(){this.active={}};function et(t,r){var n={};for(var i in t)"ref"!==i&&(n[i]=t[i]);return e.default$18.forEach(function(e){e in r&&(n[e]=r[e])}),n}function tt(e){e=e.slice();for(var t=Object.create(null),r=0;r<e.length;r++)t[e[r].id]=e[r];for(var n=0;n<e.length;n++)"ref"in e[n]&&(e[n]=et(e[n],t[e[n].ref]));return e}Qe.prototype.acquire=function(e){if(!this.workers){var t=En.workerCount;for(this.workers=[];this.workers.length<t;)this.workers.push(new Je)}return this.active[e]=!0,this.workers.slice()},Qe.prototype.release=function(e){delete this.active[e],0===Object.keys(this.active).length&&(this.workers.forEach(function(e){e.terminate()}),this.workers=null)};var rt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function nt(e,t,r){r.push({command:rt.addSource,args:[e,t[e]]})}function it(e,t,r){t.push({command:rt.removeSource,args:[e]}),r[e]=!0}function at(e,t,r,n){it(e,r,n),nt(e,t,r)}function ot(t,r,n){var i;for(i in t[n])if(t[n].hasOwnProperty(i)&&"data"!==i&&!e.default$10(t[n][i],r[n][i]))return!1;for(i in r[n])if(r[n].hasOwnProperty(i)&&"data"!==i&&!e.default$10(t[n][i],r[n][i]))return!1;return!0}function st(t,r,n,i,a,o){var s;for(s in r=r||{},t=t||{})t.hasOwnProperty(s)&&(e.default$10(t[s],r[s])||n.push({command:o,args:[i,s,r[s],a]}));for(s in r)r.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(e.default$10(t[s],r[s])||n.push({command:o,args:[i,s,r[s],a]}))}function lt(e){return e.id}function ut(e,t){return e[t.id]=t,e}function ct(t,r){if(!t)return[{command:rt.setStyle,args:[r]}];var n=[];try{if(!e.default$10(t.version,r.version))return[{command:rt.setStyle,args:[r]}];e.default$10(t.center,r.center)||n.push({command:rt.setCenter,args:[r.center]}),e.default$10(t.zoom,r.zoom)||n.push({command:rt.setZoom,args:[r.zoom]}),e.default$10(t.bearing,r.bearing)||n.push({command:rt.setBearing,args:[r.bearing]}),e.default$10(t.pitch,r.pitch)||n.push({command:rt.setPitch,args:[r.pitch]}),e.default$10(t.sprite,r.sprite)||n.push({command:rt.setSprite,args:[r.sprite]}),e.default$10(t.glyphs,r.glyphs)||n.push({command:rt.setGlyphs,args:[r.glyphs]}),e.default$10(t.transition,r.transition)||n.push({command:rt.setTransition,args:[r.transition]}),e.default$10(t.light,r.light)||n.push({command:rt.setLight,args:[r.light]});var i={},a=[];!function(t,r,n,i){var a;for(a in r=r||{},t=t||{})t.hasOwnProperty(a)&&(r.hasOwnProperty(a)||it(a,n,i));for(a in r)r.hasOwnProperty(a)&&(t.hasOwnProperty(a)?e.default$10(t[a],r[a])||("geojson"===t[a].type&&"geojson"===r[a].type&&ot(t,r,a)?n.push({command:rt.setGeoJSONSourceData,args:[a,r[a].data]}):at(a,r,n,i)):nt(a,r,n))}(t.sources,r.sources,a,i);var o=[];t.layers&&t.layers.forEach(function(e){i[e.source]?n.push({command:rt.removeLayer,args:[e.id]}):o.push(e)}),n=n.concat(a),function(t,r,n){r=r||[];var i,a,o,s,l,u,c,f=(t=t||[]).map(lt),h=r.map(lt),p=t.reduce(ut,{}),d=r.reduce(ut,{}),v=f.slice(),m=Object.create(null);for(i=0,a=0;i<f.length;i++)o=f[i],d.hasOwnProperty(o)?a++:(n.push({command:rt.removeLayer,args:[o]}),v.splice(v.indexOf(o,a),1));for(i=0,a=0;i<h.length;i++)o=h[h.length-1-i],v[v.length-1-i]!==o&&(p.hasOwnProperty(o)?(n.push({command:rt.removeLayer,args:[o]}),v.splice(v.lastIndexOf(o,v.length-a),1)):a++,u=v[v.length-i],n.push({command:rt.addLayer,args:[d[o],u]}),v.splice(v.length-i,0,o),m[o]=!0);for(i=0;i<h.length;i++)if(s=p[o=h[i]],l=d[o],!m[o]&&!e.default$10(s,l))if(e.default$10(s.source,l.source)&&e.default$10(s["source-layer"],l["source-layer"])&&e.default$10(s.type,l.type)){for(c in st(s.layout,l.layout,n,o,null,rt.setLayoutProperty),st(s.paint,l.paint,n,o,null,rt.setPaintProperty),e.default$10(s.filter,l.filter)||n.push({command:rt.setFilter,args:[o,l.filter]}),e.default$10(s.minzoom,l.minzoom)&&e.default$10(s.maxzoom,l.maxzoom)||n.push({command:rt.setLayerZoomRange,args:[o,l.minzoom,l.maxzoom]}),s)s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?st(s[c],l[c],n,o,c.slice(6),rt.setPaintProperty):e.default$10(s[c],l[c])||n.push({command:rt.setLayerProperty,args:[o,c,l[c]]}));for(c in l)l.hasOwnProperty(c)&&!s.hasOwnProperty(c)&&"layout"!==c&&"paint"!==c&&"filter"!==c&&"metadata"!==c&&"minzoom"!==c&&"maxzoom"!==c&&(0===c.indexOf("paint.")?st(s[c],l[c],n,o,c.slice(6),rt.setPaintProperty):e.default$10(s[c],l[c])||n.push({command:rt.setLayerProperty,args:[o,c,l[c]]}))}else n.push({command:rt.removeLayer,args:[o]}),u=v[v.lastIndexOf(o)+1],n.push({command:rt.addLayer,args:[l,u]})}(o,r.layers,n)}catch(e){console.warn("Unable to compute style diff:",e),n=[{command:rt.setStyle,args:[r]}]}return n}var ft=function(e,t,r){var n=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(var a=0;a<this.xCellCount*this.yCellCount;a++)n.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0};ft.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},ft.prototype.insert=function(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)},ft.prototype.insertCircle=function(e,t,r,n){this._forEachCell(t-n,r-n,t+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(n)},ft.prototype._insertBoxCell=function(e,t,r,n,i,a){this.boxCells[i].push(a)},ft.prototype._insertCircleCell=function(e,t,r,n,i,a){this.circleCells[i].push(a)},ft.prototype._query=function(e,t,r,n,i){if(r<0||e>this.width||n<0||t>this.height)return!i&&[];var a=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(i)return!0;for(var o=0;o<this.boxKeys.length;o++)a.push({key:this.boxKeys[o],x1:this.bboxes[4*o],y1:this.bboxes[4*o+1],x2:this.bboxes[4*o+2],y2:this.bboxes[4*o+3]});for(var s=0;s<this.circleKeys.length;s++){var l=this.circles[3*s],u=this.circles[3*s+1],c=this.circles[3*s+2];a.push({key:this.circleKeys[s],x1:l-c,y1:u-c,x2:l+c,y2:u+c})}}else{var f={hitTest:i,seenUids:{box:{},circle:{}}};this._forEachCell(e,t,r,n,this._queryCell,a,f)}return i?a.length>0:a},ft.prototype._queryCircle=function(e,t,r,n){var i=e-r,a=e+r,o=t-r,s=t+r;if(a<0||i>this.width||s<0||o>this.height)return!n&&[];var l=[],u={hitTest:n,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}};return this._forEachCell(i,o,a,s,this._queryCellCircle,l,u),n?l.length>0:l},ft.prototype.query=function(e,t,r,n){return this._query(e,t,r,n,!1)},ft.prototype.hitTest=function(e,t,r,n){return this._query(e,t,r,n,!0)},ft.prototype.hitTestCircle=function(e,t,r){return this._queryCircle(e,t,r,!0)},ft.prototype._queryCell=function(e,t,r,n,i,a,o){var s=o.seenUids,l=this.boxCells[i];if(null!==l)for(var u=this.bboxes,c=0,f=l;c<f.length;c+=1){var h=f[c];if(!s.box[h]){s.box[h]=!0;var p=4*h;if(e<=u[p+2]&&t<=u[p+3]&&r>=u[p+0]&&n>=u[p+1]){if(o.hitTest)return a.push(!0),!0;a.push({key:this.boxKeys[h],x1:u[p],y1:u[p+1],x2:u[p+2],y2:u[p+3]})}}}var d=this.circleCells[i];if(null!==d)for(var v=this.circles,m=0,g=d;m<g.length;m+=1){var y=g[m];if(!s.circle[y]){s.circle[y]=!0;var _=3*y;if(this._circleAndRectCollide(v[_],v[_+1],v[_+2],e,t,r,n)){if(o.hitTest)return a.push(!0),!0;var x=v[_],b=v[_+1],w=v[_+2];a.push({key:this.circleKeys[y],x1:x-w,y1:b-w,x2:x+w,y2:b+w})}}}},ft.prototype._queryCellCircle=function(e,t,r,n,i,a,o){var s=o.circle,l=o.seenUids,u=this.boxCells[i];if(null!==u)for(var c=this.bboxes,f=0,h=u;f<h.length;f+=1){var p=h[f];if(!l.box[p]){l.box[p]=!0;var d=4*p;if(this._circleAndRectCollide(s.x,s.y,s.radius,c[d+0],c[d+1],c[d+2],c[d+3]))return a.push(!0),!0}}var v=this.circleCells[i];if(null!==v)for(var m=this.circles,g=0,y=v;g<y.length;g+=1){var _=y[g];if(!l.circle[_]){l.circle[_]=!0;var x=3*_;if(this._circlesCollide(m[x],m[x+1],m[x+2],s.x,s.y,s.radius))return a.push(!0),!0}}},ft.prototype._forEachCell=function(e,t,r,n,i,a,o){for(var s=this._convertToXCellCoord(e),l=this._convertToYCellCoord(t),u=this._convertToXCellCoord(r),c=this._convertToYCellCoord(n),f=s;f<=u;f++)for(var h=l;h<=c;h++){var p=this.xCellCount*h+f;if(i.call(this,e,t,r,n,p,a,o))return}},ft.prototype._convertToXCellCoord=function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))},ft.prototype._convertToYCellCoord=function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))},ft.prototype._circlesCollide=function(e,t,r,n,i,a){var o=n-e,s=i-t,l=r+a;return l*l>o*o+s*s},ft.prototype._circleAndRectCollide=function(e,t,r,n,i,a,o){var s=(a-n)/2,l=Math.abs(e-(n+s));if(l>s+r)return!1;var u=(o-i)/2,c=Math.abs(t-(i+u));if(c>u+r)return!1;if(l<=s||c<=u)return!0;var f=l-s,h=c-u;return f*f+h*h<=r*r};var ht=e.default$19.layout;function pt(t,r,n,i,a){var o=e.mat4.identity(new Float32Array(16));return r?(e.mat4.identity(o),e.mat4.scale(o,o,[1/a,1/a,1]),n||e.mat4.rotateZ(o,o,i.angle)):(e.mat4.scale(o,o,[i.width/2,-i.height/2,1]),e.mat4.translate(o,o,[1,-1,0]),e.mat4.multiply(o,o,t)),o}function dt(t,r,n,i,a){var o=e.mat4.identity(new Float32Array(16));return r?(e.mat4.multiply(o,o,t),e.mat4.scale(o,o,[a,a,1]),n||e.mat4.rotateZ(o,o,-i.angle)):(e.mat4.scale(o,o,[1,-1,1]),e.mat4.translate(o,o,[-1,-1,0]),e.mat4.scale(o,o,[2/i.width,2/i.height,1])),o}function vt(t,r){var n=[t.x,t.y,0,1];Tt(n,n,r);var i=n[3];return{point:new e.default$1(n[0]/i,n[1]/i),signedDistanceFromCamera:i}}function mt(e,t){var r=e[0]/e[3],n=e[1]/e[3];return r>=-t[0]&&r<=t[0]&&n>=-t[1]&&n<=t[1]}function gt(t,r,n,i,a,o,s,l){var u=i?t.textSizeData:t.iconSizeData,c=e.evaluateSizeForZoom(u,n.transform.zoom,ht.properties[i?"text-size":"icon-size"]),f=[256/n.width*2+1,256/n.height*2+1],h=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;h.clear();for(var p=t.lineVertexArray,d=i?t.text.placedSymbolArray:t.icon.placedSymbolArray,v=n.transform.width/n.transform.height,m=!1,g=0;g<d.length;g++){var y=d.get(g);if(y.hidden||y.writingMode===e.WritingMode.vertical&&!m)At(y.numGlyphs,h);else{m=!1;var _=[y.anchorX,y.anchorY,0,1];if(e.vec4.transformMat4(_,_,r),mt(_,f)){var x=.5+_[3]/n.transform.cameraToCenterDistance*.5,b=e.evaluateSizeForFeature(u,c,y),w=s?b*x:b/x,k=new e.default$1(y.anchorX,y.anchorY),A=vt(k,a).point,T={},M=xt(y,w,!1,l,r,a,o,t.glyphOffsetArray,p,h,A,k,T,v);m=M.useVertical,(M.notEnoughRoom||m||M.needsFlipping&&xt(y,w,!0,l,r,a,o,t.glyphOffsetArray,p,h,A,k,T,v).notEnoughRoom)&&At(y.numGlyphs,h)}else At(y.numGlyphs,h)}}i?t.text.dynamicLayoutVertexBuffer.updateData(h):t.icon.dynamicLayoutVertexBuffer.updateData(h)}function yt(e,t,r,n,i,a,o,s,l,u,c,f){var h=s.glyphStartIndex+s.numGlyphs,p=s.lineStartIndex,d=s.lineStartIndex+s.lineLength,v=t.getoffsetX(s.glyphStartIndex),m=t.getoffsetX(h-1),g=wt(e*v,r,n,i,a,o,s.segment,p,d,l,u,c,f);if(!g)return null;var y=wt(e*m,r,n,i,a,o,s.segment,p,d,l,u,c,f);return y?{first:g,last:y}:null}function _t(t,r,n,i){if(t===e.WritingMode.horizontal&&Math.abs(n.y-r.y)>Math.abs(n.x-r.x)*i)return{useVertical:!0};return(t===e.WritingMode.vertical?r.y<n.y:r.x>n.x)?{needsFlipping:!0}:null}function xt(t,r,n,i,a,o,s,l,u,c,f,h,p,d){var v,m=r/24,g=t.lineOffsetX*r,y=t.lineOffsetY*r;if(t.numGlyphs>1){var _=t.glyphStartIndex+t.numGlyphs,x=t.lineStartIndex,b=t.lineStartIndex+t.lineLength,w=yt(m,l,g,y,n,f,h,t,u,o,p,!1);if(!w)return{notEnoughRoom:!0};var k=vt(w.first.point,s).point,A=vt(w.last.point,s).point;if(i&&!n){var T=_t(t.writingMode,k,A,d);if(T)return T}v=[w.first];for(var M=t.glyphStartIndex+1;M<_-1;M++)v.push(wt(m*l.getoffsetX(M),g,y,n,f,h,t.segment,x,b,u,o,p,!1));v.push(w.last)}else{if(i&&!n){var S=vt(h,a).point,C=t.lineStartIndex+t.segment+1,z=new e.default$1(u.getx(C),u.gety(C)),E=vt(z,a),L=E.signedDistanceFromCamera>0?E.point:bt(h,z,S,1,a),I=_t(t.writingMode,S,L,d);if(I)return I}var P=wt(m*l.getoffsetX(t.glyphStartIndex),g,y,n,f,h,t.segment,t.lineStartIndex,t.lineStartIndex+t.lineLength,u,o,p,!1);if(!P)return{notEnoughRoom:!0};v=[P]}for(var D=0,O=v;D<O.length;D+=1){var R=O[D];e.addDynamicAttributes(c,R.point,R.angle)}return{}}function bt(e,t,r,n,i){var a=vt(e.add(e.sub(t)._unit()),i).point,o=r.sub(a);return r.add(o._mult(n/o.mag()))}function wt(t,r,n,i,a,o,s,l,u,c,f,h,p){var d=i?t-r:t+r,v=d>0?1:-1,m=0;i&&(v*=-1,m=Math.PI),v<0&&(m+=Math.PI);for(var g=v>0?l+s:l+s+1,y=g,_=a,x=a,b=0,w=0,k=Math.abs(d);b+w<=k;){if((g+=v)<l||g>=u)return null;if(x=_,void 0===(_=h[g])){var A=new e.default$1(c.getx(g),c.gety(g)),T=vt(A,f);if(T.signedDistanceFromCamera>0)_=h[g]=T.point;else{var M=g-v;_=bt(0===b?o:new e.default$1(c.getx(M),c.gety(M)),A,x,k-b+1,f)}}b+=w,w=x.dist(_)}var S=(k-b)/w,C=_.sub(x),z=C.mult(S)._add(x);return z._add(C._unit()._perp()._mult(n*v)),{point:z,angle:m+Math.atan2(_.y-x.y,_.x-x.x),tileDistance:p?{prevTileDistance:g-v===y?0:c.gettileUnitDistanceFromAnchor(g-v),lastSegmentViewportDistance:k-b}:null}}var kt=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function At(e,t){for(var r=0;r<e;r++){var n=t.length;t.resize(n+4),t.float32.set(kt,3*n)}}function Tt(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e[3]=r[3]*n+r[7]*i+r[15],e}e.default$20.mat4;var Mt=function(e,t,r){void 0===t&&(t=new ft(e.width+200,e.height+200,25)),void 0===r&&(r=new ft(e.width+200,e.height+200,25)),this.transform=e,this.grid=t,this.ignoredGrid=r,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+100,this.screenBottomBoundary=e.height+100};function St(e,t,r){e[t+4]=r?1:0}function Ct(t,r,n){return r*(e.default$8/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}Mt.prototype.placeCollisionBox=function(e,t,r,n){var i=this.projectAndGetPerspectiveRatio(n,e.anchorPointX,e.anchorPointY),a=r*i.perspectiveRatio,o=e.x1*a+i.point.x,s=e.y1*a+i.point.y,l=e.x2*a+i.point.x,u=e.y2*a+i.point.y;return!t&&this.grid.hitTest(o,s,l,u)?{box:[],offscreen:!1}:{box:[o,s,l,u],offscreen:this.isOffscreen(o,s,l,u)}},Mt.prototype.approximateTileDistance=function(e,t,r,n,i){var a=i?1:n/this.pitchfactor,o=e.lastSegmentViewportDistance*r;return e.prevTileDistance+o+(a-1)*o*Math.abs(Math.sin(t))},Mt.prototype.placeCollisionCircles=function(t,r,n,i,a,o,s,l,u,c,f,h,p){var d=[],v=this.projectAnchor(c,o.anchorX,o.anchorY),m=u/24,g=o.lineOffsetX*u,y=o.lineOffsetY*u,_=new e.default$1(o.anchorX,o.anchorY),x=yt(m,l,g,y,!1,vt(_,f).point,_,o,s,f,{},!0),b=!1,w=!0,k=v.perspectiveRatio*i,A=1/(i*n),T=0,M=0;x&&(T=this.approximateTileDistance(x.first.tileDistance,x.first.angle,A,v.cameraDistance,p),M=this.approximateTileDistance(x.last.tileDistance,x.last.angle,A,v.cameraDistance,p));for(var S=0;S<t.length;S+=5){var C=t[S],z=t[S+1],E=t[S+2],L=t[S+3];if(!x||L<-T||L>M)St(t,S,!1);else{var I=this.projectPoint(c,C,z),P=E*k;if(d.length>0){var D=I.x-d[d.length-4],O=I.y-d[d.length-3];if(P*P*2>D*D+O*O)if(S+8<t.length){var R=t[S+8];if(R>-T&&R<M){St(t,S,!1);continue}}}var F=S/5;if(d.push(I.x,I.y,P,F),St(t,S,!0),w=w&&this.isOffscreen(I.x-P,I.y-P,I.x+P,I.y+P),!r&&this.grid.hitTestCircle(I.x,I.y,P)){if(!h)return{circles:[],offscreen:!1};b=!0}}}return{circles:b?[]:d,offscreen:w}},Mt.prototype.queryRenderedSymbols=function(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var r=[],n=1/0,i=1/0,a=-1/0,o=-1/0,s=0,l=t;s<l.length;s+=1){var u=l[s],c=new e.default$1(u.x+100,u.y+100);n=Math.min(n,c.x),i=Math.min(i,c.y),a=Math.max(a,c.x),o=Math.max(o,c.y),r.push(c)}for(var f={},h={},p=0,d=this.grid.query(n,i,a,o).concat(this.ignoredGrid.query(n,i,a,o));p<d.length;p+=1){var v=d[p],m=v.key;if(void 0===f[m.bucketInstanceId]&&(f[m.bucketInstanceId]={}),!f[m.bucketInstanceId][m.featureIndex]){var g=[new e.default$1(v.x1,v.y1),new e.default$1(v.x2,v.y1),new e.default$1(v.x2,v.y2),new e.default$1(v.x1,v.y2)];e.polygonIntersectsPolygon(r,g)&&(f[m.bucketInstanceId][m.featureIndex]=!0,void 0===h[m.bucketInstanceId]&&(h[m.bucketInstanceId]=[]),h[m.bucketInstanceId].push(m.featureIndex))}}return h},Mt.prototype.insertCollisionBox=function(e,t,r,n){var i={bucketInstanceId:r,featureIndex:n};(t?this.ignoredGrid:this.grid).insert(i,e[0],e[1],e[2],e[3])},Mt.prototype.insertCollisionCircles=function(e,t,r,n){for(var i=t?this.ignoredGrid:this.grid,a={bucketInstanceId:r,featureIndex:n},o=0;o<e.length;o+=4)i.insertCircle(a,e[o],e[o+1],e[o+2])},Mt.prototype.projectAnchor=function(e,t,r){var n=[t,r,0,1];return Tt(n,n,e),{perspectiveRatio:.5+this.transform.cameraToCenterDistance/n[3]*.5,cameraDistance:n[3]}},Mt.prototype.projectPoint=function(t,r,n){var i=[r,n,0,1];return Tt(i,i,t),new e.default$1((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100)},Mt.prototype.projectAndGetPerspectiveRatio=function(t,r,n){var i=[r,n,0,1];return Tt(i,i,t),{point:new e.default$1((i[0]/i[3]+1)/2*this.transform.width+100,(-i[1]/i[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/i[3]*.5}},Mt.prototype.isOffscreen=function(e,t,r,n){return r<100||e>=this.screenRightBoundary||n<100||t>this.screenBottomBoundary};var zt=e.default$19.layout,Et=function(e,t,r,n){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):n&&r?1:0,this.placed=r};Et.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Lt=function(e,t,r,n,i){this.text=new Et(e?e.text:null,t,r,i),this.icon=new Et(e?e.icon:null,t,n,i)};Lt.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var It=function(e,t,r){this.text=e,this.icon=t,this.skipFade=r},Pt=function(e,t){this.transform=e.clone(),this.collisionIndex=new Mt(this.transform),this.placements={},this.opacities={},this.stale=!1,this.fadeDuration=t,this.retainedQueryData={}};function Dt(e,t,r){e.emplaceBack(t?1:0,r?1:0),e.emplaceBack(t?1:0,r?1:0),e.emplaceBack(t?1:0,r?1:0),e.emplaceBack(t?1:0,r?1:0)}Pt.prototype.placeLayerTile=function(t,r,n,i){var a=r.getBucket(t),o=r.latestFeatureIndex;if(a&&o&&t.id===a.layerIds[0]){var s=r.collisionBoxArray,l=a.layers[0].layout,u=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),c=r.tileSize/e.default$8,f=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),h=pt(f,"map"===l.get("text-pitch-alignment"),"map"===l.get("text-rotation-alignment"),this.transform,Ct(r,1,this.transform.zoom)),p=pt(f,"map"===l.get("icon-pitch-alignment"),"map"===l.get("icon-rotation-alignment"),this.transform,Ct(r,1,this.transform.zoom));this.retainedQueryData[a.bucketInstanceId]=new function(e,t,r,n,i){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=i}(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,r.tileID),this.placeLayerBucket(a,f,h,p,u,c,n,i,s)}},Pt.prototype.placeLayerBucket=function(t,r,n,i,a,o,s,l,u){for(var c=t.layers[0].layout,f=e.evaluateSizeForZoom(t.textSizeData,this.transform.zoom,zt.properties["text-size"]),h=!t.hasTextData()||c.get("text-optional"),p=!t.hasIconData()||c.get("icon-optional"),d=0,v=t.symbolInstances;d<v.length;d+=1){var m=v[d];if(!l[m.crossTileID]){var g=void 0!==m.feature.text,y=void 0!==m.feature.icon,_=!0,x=null,b=null,w=null,k=0,A=0;m.collisionArrays||(m.collisionArrays=t.deserializeCollisionBoxes(u,m.textBoxStartIndex,m.textBoxEndIndex,m.iconBoxStartIndex,m.iconBoxEndIndex)),m.collisionArrays.textFeatureIndex&&(k=m.collisionArrays.textFeatureIndex),m.collisionArrays.textBox&&(g=(x=this.collisionIndex.placeCollisionBox(m.collisionArrays.textBox,c.get("text-allow-overlap"),o,r)).box.length>0,_=_&&x.offscreen);var T=m.collisionArrays.textCircles;if(T){var M=t.text.placedSymbolArray.get(m.placedTextSymbolIndices[0]),S=e.evaluateSizeForFeature(t.textSizeData,f,M);b=this.collisionIndex.placeCollisionCircles(T,c.get("text-allow-overlap"),a,o,m.key,M,t.lineVertexArray,t.glyphOffsetArray,S,r,n,s,"map"===c.get("text-pitch-alignment")),g=c.get("text-allow-overlap")||b.circles.length>0,_=_&&b.offscreen}m.collisionArrays.iconFeatureIndex&&(A=m.collisionArrays.iconFeatureIndex),m.collisionArrays.iconBox&&(y=(w=this.collisionIndex.placeCollisionBox(m.collisionArrays.iconBox,c.get("icon-allow-overlap"),o,r)).box.length>0,_=_&&w.offscreen),h||p?p?h||(y=y&&g):g=y&&g:y=g=y&&g,g&&x&&this.collisionIndex.insertCollisionBox(x.box,c.get("text-ignore-placement"),t.bucketInstanceId,k),y&&w&&this.collisionIndex.insertCollisionBox(w.box,c.get("icon-ignore-placement"),t.bucketInstanceId,A),g&&b&&this.collisionIndex.insertCollisionCircles(b.circles,c.get("text-ignore-placement"),t.bucketInstanceId,k),this.placements[m.crossTileID]=new It(g,y,_||t.justReloaded),l[m.crossTileID]=!0}}t.justReloaded=!1},Pt.prototype.commit=function(e,t){this.commitTime=t;var r=!1,n=e&&0!==this.fadeDuration?(this.commitTime-e.commitTime)/this.fadeDuration:1,i=e?e.opacities:{};for(var a in this.placements){var o=this.placements[a],s=i[a];s?(this.opacities[a]=new Lt(s,n,o.text,o.icon),r=r||o.text!==s.text.placed||o.icon!==s.icon.placed):(this.opacities[a]=new Lt(null,n,o.text,o.icon,o.skipFade),r=r||o.text||o.icon)}for(var l in i){var u=i[l];if(!this.opacities[l]){var c=new Lt(u,n,!1,!1);c.isHidden()||(this.opacities[l]=c,r=r||u.text.placed||u.icon.placed)}}r?this.lastPlacementChangeTime=t:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=e?e.lastPlacementChangeTime:t)},Pt.prototype.updateLayerOpacities=function(e,t){for(var r={},n=0,i=t;n<i.length;n+=1){var a=i[n],o=a.getBucket(e);o&&a.latestFeatureIndex&&e.id===o.layerIds[0]&&this.updateBucketOpacities(o,r,a.collisionBoxArray)}},Pt.prototype.updateBucketOpacities=function(e,t,r){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasCollisionBoxData()&&e.collisionBox.collisionVertexArray.clear(),e.hasCollisionCircleData()&&e.collisionCircle.collisionVertexArray.clear();for(var n=e.layers[0].layout,i=new Lt(null,0,!1,!1,!0),a=new Lt(null,0,n.get("text-allow-overlap"),n.get("icon-allow-overlap"),!0),o=0;o<e.symbolInstances.length;o++){var s=e.symbolInstances[o],l=t[s.crossTileID],u=this.opacities[s.crossTileID];l?u=i:u||(u=a,this.opacities[s.crossTileID]=u),t[s.crossTileID]=!0;var c=s.numGlyphVertices>0||s.numVerticalGlyphVertices>0,f=s.numIconVertices>0;if(c){for(var h=qt(u.text),p=(s.numGlyphVertices+s.numVerticalGlyphVertices)/4,d=0;d<p;d++)e.text.opacityVertexArray.emplaceBack(h);for(var v=0,m=s.placedTextSymbolIndices;v<m.length;v+=1){var g=m[v];e.text.placedSymbolArray.get(g).hidden=u.text.isHidden()}}if(f){for(var y=qt(u.icon),_=0;_<s.numIconVertices/4;_++)e.icon.opacityVertexArray.emplaceBack(y);e.icon.placedSymbolArray.get(o).hidden=u.icon.isHidden()}s.collisionArrays||(s.collisionArrays=e.deserializeCollisionBoxes(r,s.textBoxStartIndex,s.textBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex));var x=s.collisionArrays;if(x){x.textBox&&e.hasCollisionBoxData()&&Dt(e.collisionBox.collisionVertexArray,u.text.placed,!1),x.iconBox&&e.hasCollisionBoxData()&&Dt(e.collisionBox.collisionVertexArray,u.icon.placed,!1);var b=x.textCircles;if(b&&e.hasCollisionCircleData())for(var w=0;w<b.length;w+=5){var k=l||0===b[w+4];Dt(e.collisionCircle.collisionVertexArray,u.text.placed,k)}}}e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasCollisionBoxData()&&e.collisionBox.collisionVertexBuffer&&e.collisionBox.collisionVertexBuffer.updateData(e.collisionBox.collisionVertexArray),e.hasCollisionCircleData()&&e.collisionCircle.collisionVertexBuffer&&e.collisionCircle.collisionVertexBuffer.updateData(e.collisionCircle.collisionVertexArray)},Pt.prototype.symbolFadeChange=function(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration},Pt.prototype.hasTransitions=function(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration},Pt.prototype.stillRecent=function(e){return"undefined"!==this.commitTime&&this.commitTime+this.fadeDuration>e},Pt.prototype.setStale=function(){this.stale=!0};var Ot=Math.pow(2,25),Rt=Math.pow(2,24),Ft=Math.pow(2,17),Bt=Math.pow(2,16),Nt=Math.pow(2,9),jt=Math.pow(2,8),Vt=Math.pow(2,1);function qt(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;var t=e.placed?1:0,r=Math.floor(127*e.opacity);return r*Ot+t*Rt+r*Ft+t*Bt+r*Nt+t*jt+r*Vt+t}var Ut=function(){this._currentTileIndex=0,this._seenCrossTileIDs={}};Ut.prototype.continuePlacement=function(e,t,r,n,i){for(;this._currentTileIndex<e.length;){var a=e[this._currentTileIndex];if(t.placeLayerTile(n,a,r,this._seenCrossTileIDs),this._currentTileIndex++,i())return!0}};var Zt=function(e,t,r,n,i){this.placement=new Pt(e,i),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=n,this._done=!1};Zt.prototype.isDone=function(){return this._done},Zt.prototype.continuePlacement=function(e,t,r){for(var n=this,i=a.now(),o=function(){var e=a.now()-i;return!n._forceFullPlacement&&e>2};this._currentPlacementIndex>=0;){var s=t[e[n._currentPlacementIndex]],l=n.placement.collisionIndex.transform.zoom;if("symbol"===s.type&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(n._inProgressLayer||(n._inProgressLayer=new Ut),n._inProgressLayer.continuePlacement(r[s.source],n.placement,n._showCollisionBoxes,s,o))return;delete n._inProgressLayer}n._currentPlacementIndex--}this._done=!0},Zt.prototype.commit=function(e,t){return this.placement.commit(e,t),this.placement};var Ht=512/e.default$8/2,Gt=function(e,t,r){this.tileID=e,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(var n=0,i=t;n<i.length;n+=1){var a=i[n],o=a.key;this.indexedSymbolInstances[o]||(this.indexedSymbolInstances[o]=[]),this.indexedSymbolInstances[o].push({crossTileID:a.crossTileID,coord:this.getScaledCoordinates(a,e)})}};Gt.prototype.getScaledCoordinates=function(t,r){var n=r.canonical.z-this.tileID.canonical.z,i=Ht/Math.pow(2,n),a=t.anchor;return{x:Math.floor((r.canonical.x*e.default$8+a.x)*i),y:Math.floor((r.canonical.y*e.default$8+a.y)*i)}},Gt.prototype.findMatches=function(e,t,r){for(var n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z),i=0,a=e;i<a.length;i+=1){var o=a[i];if(!o.crossTileID){var s=this.indexedSymbolInstances[o.key];if(s)for(var l=this.getScaledCoordinates(o,t),u=0,c=s;u<c.length;u+=1){var f=c[u];if(Math.abs(f.coord.x-l.x)<=n&&Math.abs(f.coord.y-l.y)<=n&&!r[f.crossTileID]){r[f.crossTileID]=!0,o.crossTileID=f.crossTileID;break}}}}};var $t=function(){this.maxCrossTileID=0};$t.prototype.generate=function(){return++this.maxCrossTileID};var Wt=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Wt.prototype.handleWrapJump=function(e){var t=Math.round((e-this.lng)/360);if(0!==t)for(var r in this.indexes){var n=this.indexes[r],i={};for(var a in n){var o=n[a];o.tileID=o.tileID.unwrapTo(o.tileID.wrap+t),i[o.tileID.key]=o}this.indexes[r]=i}this.lng=e},Wt.prototype.addBucket=function(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(var n=0,i=t.symbolInstances;n<i.length;n+=1){i[n].crossTileID=0}this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});var a=this.usedCrossTileIDs[e.overscaledZ];for(var o in this.indexes){var s=this.indexes[o];if(Number(o)>e.overscaledZ)for(var l in s){var u=s[l];u.tileID.isChildOf(e)&&u.findMatches(t.symbolInstances,e,a)}else{var c=s[e.scaledTo(Number(o)).key];c&&c.findMatches(t.symbolInstances,e,a)}}for(var f=0,h=t.symbolInstances;f<h.length;f+=1){var p=h[f];p.crossTileID||(p.crossTileID=r.generate(),a[p.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Gt(e,t.symbolInstances,t.bucketInstanceId),!0},Wt.prototype.removeBucketCrossTileIDs=function(e,t){for(var r in t.indexedSymbolInstances)for(var n=0,i=t.indexedSymbolInstances[r];n<i.length;n+=1){var a=i[n];delete this.usedCrossTileIDs[e][a.crossTileID]}},Wt.prototype.removeStaleBuckets=function(e){var t=!1;for(var r in this.indexes){var n=this.indexes[r];for(var i in n)e[n[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[i]),delete n[i],t=!0)}return t};var Xt=function(){this.layerIndexes={},this.crossTileIDs=new $t,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Xt.prototype.addLayer=function(e,t,r){var n=this.layerIndexes[e.id];void 0===n&&(n=this.layerIndexes[e.id]=new Wt);var i=!1,a={};n.handleWrapJump(r);for(var o=0,s=t;o<s.length;o+=1){var l=s[o],u=l.getBucket(e);u&&e.id===u.layerIds[0]&&(u.bucketInstanceId||(u.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(l.tileID,u,this.crossTileIDs)&&(i=!0),a[u.bucketInstanceId]=!0)}return n.removeStaleBuckets(a)&&(i=!0),i},Xt.prototype.pruneUnusedLayers=function(e){var t={};for(var r in e.forEach(function(e){t[e]=!0}),this.layerIndexes)t[r]||delete this.layerIndexes[r]};var Yt=function(t,r){return e.emitValidationErrors(t,r&&r.filter(function(e){return"source.canvas"!==e.identifier}))},Jt=e.pick(rt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Kt=e.pick(rt,["setCenter","setZoom","setBearing","setPitch"]),Qt=function(t){function r(n,i){var a=this;void 0===i&&(i={}),t.call(this),this.map=n,this.dispatcher=new Z((Ke||(Ke=new Qe),Ke),this),this.imageManager=new P,this.glyphManager=new N(n._transformRequest,i.localIdeographFontFamily),this.lineAtlas=new U(256,512),this.crossTileSymbolIndex=new Xt,this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.default$23,this._loaded=!1,this._resetUpdates();var o=this;this._rtlTextPluginCallback=r.registerForPluginAvailability(function(e){for(var t in o.dispatcher.broadcast("loadRTLTextPlugin",e.pluginURL,e.completionCallback),o.sourceCaches)o.sourceCaches[t].reload()}),this.on("data",function(e){if("source"===e.dataType&&"metadata"===e.sourceDataType){var t=a.sourceCaches[e.sourceId];if(t){var r=t.getSource();if(r&&r.vectorLayerIds)for(var n in a._layers){var i=a._layers[n];i.source===r.id&&a._validateLayer(i)}}}})}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.loadURL=function(t,r){var n=this;void 0===r&&(r={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var i="boolean"==typeof r.validate?r.validate:!_(t);t=function(e,t){if(!_(e))return e;var r=M(e);return r.path="/styles/v1"+r.path,y(r,t)}(t,r.accessToken);var a=this.map._transformRequest(t,e.ResourceType.Style);e.getJSON(a,function(t,r){t?n.fire(new e.ErrorEvent(t)):r&&n._load(r,i)})},r.prototype.loadJSON=function(t,r){var n=this;void 0===r&&(r={}),this.fire(new e.Event("dataloading",{dataType:"style"})),a.frame(function(){n._load(t,!1!==r.validate)})},r.prototype._load=function(t,r){var n=this;if(!r||!Yt(this,e.validateStyle(t))){for(var i in this._loaded=!0,this.stylesheet=t,t.sources)n.addSource(i,t.sources[i],{validate:!1});t.sprite?function(t,r,n){var i,o,s,l=a.devicePixelRatio>1?"@2x":"";function u(){if(s)n(s);else if(i&&o){var t=a.getImageData(o),r={};for(var l in i){var u=i[l],c=u.width,f=u.height,h=u.x,p=u.y,d=u.sdf,v=u.pixelRatio,m=new e.RGBAImage({width:c,height:f});e.RGBAImage.copy(t,m,{x:h,y:p},{x:0,y:0},{width:c,height:f}),r[l]={data:m,pixelRatio:v,sdf:d}}n(null,r)}}e.getJSON(r(w(t,l,".json"),e.ResourceType.SpriteJSON),function(e,t){s||(s=e,i=t,u())}),e.getImage(r(w(t,l,".png"),e.ResourceType.SpriteImage),function(e,t){s||(s=e,o=t,u())})}(t.sprite,this.map._transformRequest,function(t,r){if(t)n.fire(new e.ErrorEvent(t));else if(r)for(var i in r)n.imageManager.addImage(i,r[i]);n.imageManager.setLoaded(!0),n.fire(new e.Event("data",{dataType:"style"}))}):this.imageManager.setLoaded(!0),this.glyphManager.setURL(t.glyphs);var o=tt(this.stylesheet.layers);this._order=o.map(function(e){return e.id}),this._layers={};for(var s=0,l=o;s<l.length;s+=1){var u=l[s];(u=e.default$22(u)).setEventedParent(n,{layer:{id:u.id}}),n._layers[u.id]=u}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new q(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},r.prototype._validateLayer=function(t){var r=this.sourceCaches[t.source];if(r){var n=t.sourceLayer;if(n){var i=r.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(n))&&this.fire(new e.ErrorEvent(new Error('Source layer "'+n+'" does not exist on source "'+i.id+'" as specified by style layer "'+t.id+'"')))}}},r.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()},r.prototype._serializeLayers=function(e){var t=this;return e.map(function(e){return t._layers[e].serialize()})},r.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(var t in this._layers)if(this._layers[t].hasTransition())return!0;return!1},r.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},r.prototype.update=function(t){if(this._loaded){if(this._changed){var r=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);for(var i in(r.length||n.length)&&this._updateWorkerLayers(r,n),this._updatedSources){var a=this._updatedSources[i];"reload"===a?this._reloadSource(i):"clear"===a&&this._clearSource(i)}for(var o in this._updatedPaintProps)this._layers[o].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates(),this.fire(new e.Event("data",{dataType:"style"}))}for(var s in this.sourceCaches)this.sourceCaches[s].used=!1;for(var l=0,u=this._order;l<u.length;l+=1){var c=u[l],f=this._layers[c];f.recalculate(t),!f.isHidden(t.zoom)&&f.source&&(this.sourceCaches[f.source].used=!0)}this.light.recalculate(t),this.z=t.zoom}},r.prototype._updateWorkerLayers=function(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})},r.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={}},r.prototype.setState=function(t){var r=this;if(this._checkLoaded(),Yt(this,e.validateStyle(t)))return!1;(t=e.clone(t)).layers=tt(t.layers);var n=ct(this.serialize(),t).filter(function(e){return!(e.command in Kt)});if(0===n.length)return!1;var i=n.filter(function(e){return!(e.command in Jt)});if(i.length>0)throw new Error("Unimplemented: "+i.map(function(e){return e.command}).join(", ")+".");return n.forEach(function(e){"setTransition"!==e.command&&r[e.command].apply(r,e.args)}),this.stylesheet=t,!0},r.prototype.addImage=function(t,r){if(this.getImage(t))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(t,r),this.fire(new e.Event("data",{dataType:"style"}))},r.prototype.getImage=function(e){return this.imageManager.getImage(e)},r.prototype.removeImage=function(t){if(!this.getImage(t))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(t),this.fire(new e.Event("data",{dataType:"style"}))},r.prototype.addSource=function(t,r,n){var i=this;if(this._checkLoaded(),void 0!==this.sourceCaches[t])throw new Error("There is already a source with this ID");if(!r.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(r).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(r.type)>=0)||!this._validate(e.validateStyle.source,"sources."+t,r,null,n)){this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);var a=this.sourceCaches[t]=new We(t,r,this.dispatcher);a.style=this,a.setEventedParent(this,function(){return{isSourceLoaded:i.loaded(),source:a.serialize(),sourceId:t}}),a.onAdd(this.map),this._changed=!0}},r.prototype.removeSource=function(t){if(this._checkLoaded(),void 0===this.sourceCaches[t])throw new Error("There is no source with this ID");for(var r in this._layers)if(this._layers[r].source===t)return this.fire(new e.ErrorEvent(new Error('Source "'+t+'" cannot be removed while layer "'+r+'" is using it.')));var n=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],n.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),n.setEventedParent(null),n.clearTiles(),n.onRemove&&n.onRemove(this.map),this._changed=!0},r.prototype.setGeoJSONSourceData=function(e,t){this._checkLoaded(),this.sourceCaches[e].getSource().setData(t),this._changed=!0},r.prototype.getSource=function(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()},r.prototype.addLayer=function(t,r,n){this._checkLoaded();var i=t.id;if(this.getLayer(i))this.fire(new e.ErrorEvent(new Error('Layer with id "'+i+'" already exists on this map')));else if("object"==typeof t.source&&(this.addSource(i,t.source),t=e.clone(t),t=e.extend(t,{source:i})),!this._validate(e.validateStyle.layer,"layers."+i,t,{arrayIndex:-1},n)){var a=e.default$22(t);this._validateLayer(a),a.setEventedParent(this,{layer:{id:i}});var o=r?this._order.indexOf(r):this._order.length;if(r&&-1===o)this.fire(new e.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.')));else{if(this._order.splice(o,0,i),this._layerOrderChanged=!0,this._layers[i]=a,this._removedLayers[i]&&a.source){var s=this._removedLayers[i];delete this._removedLayers[i],s.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a)}}},r.prototype.moveLayer=function(t,r){if(this._checkLoaded(),this._changed=!0,this._layers[t]){if(t!==r){var n=this._order.indexOf(t);this._order.splice(n,1);var i=r?this._order.indexOf(r):this._order.length;r&&-1===i?this.fire(new e.ErrorEvent(new Error('Layer with id "'+r+'" does not exist on this map.'))):(this._order.splice(i,0,t),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be moved.")))},r.prototype.removeLayer=function(t){this._checkLoaded();var r=this._layers[t];if(r){r.setEventedParent(null);var n=this._order.indexOf(t);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=r,delete this._layers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t]}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be removed.")))},r.prototype.getLayer=function(e){return this._layers[e]},r.prototype.setLayerZoomRange=function(t,r,n){this._checkLoaded();var i=this.getLayer(t);i?i.minzoom===r&&i.maxzoom===n||(null!=r&&(i.minzoom=r),null!=n&&(i.maxzoom=n),this._updateLayer(i)):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot have zoom extent.")))},r.prototype.setFilter=function(t,r){this._checkLoaded();var n=this.getLayer(t);if(n){if(!e.default$10(n.filter,r))return null==r?(n.filter=void 0,void this._updateLayer(n)):void(this._validate(e.validateStyle.filter,"layers."+n.id+".filter",r)||(n.filter=e.clone(r),this._updateLayer(n)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be filtered.")))},r.prototype.getFilter=function(t){return e.clone(this.getLayer(t).filter)},r.prototype.setLayoutProperty=function(t,r,n){this._checkLoaded();var i=this.getLayer(t);i?e.default$10(i.getLayoutProperty(r),n)||(i.setLayoutProperty(r,n),this._updateLayer(i)):this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},r.prototype.getLayoutProperty=function(e,t){return this.getLayer(e).getLayoutProperty(t)},r.prototype.setPaintProperty=function(t,r,n){this._checkLoaded();var i=this.getLayer(t);if(i){if(!e.default$10(i.getPaintProperty(r),n)){var a=i._transitionablePaint._values[r].value.isDataDriven();i.setPaintProperty(r,n),(i._transitionablePaint._values[r].value.isDataDriven()||a)&&this._updateLayer(i),this._changed=!0,this._updatedPaintProps[t]=!0}}else this.fire(new e.ErrorEvent(new Error("The layer '"+t+"' does not exist in the map's style and cannot be styled.")))},r.prototype.getPaintProperty=function(e,t){return this.getLayer(e).getPaintProperty(t)},r.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},r.prototype.serialize=function(){var t=this;return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(e){return e.serialize()}),layers:this._order.map(function(e){return t._layers[e].serialize()})},function(e){return void 0!==e})},r.prototype._updateLayer=function(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._changed=!0},r.prototype._flattenRenderedFeatures=function(e){for(var t=[],r=this._order.length-1;r>=0;r--)for(var n=this._order[r],i=0,a=e;i<a.length;i+=1){var o=a[i][n];if(o)for(var s=0,l=o;s<l.length;s+=1){var u=l[s];t.push(u)}}return t},r.prototype.queryRenderedFeatures=function(t,r,n){r&&r.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",r.filter);var i={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var a=0,o=r.layers;a<o.length;a+=1){var s=o[a],l=this._layers[s];if(!l)return this.fire(new e.ErrorEvent(new Error("The layer '"+s+"' does not exist in the map's style and cannot be queried for features."))),[];i[l.source]=!0}}var u=[];for(var c in this.sourceCaches)r.layers&&!i[c]||u.push(oe(this.sourceCaches[c],this._layers,t.worldCoordinate,r,n));return this.placement&&u.push(function(e,t,r,n,i){for(var a={},o=n.queryRenderedSymbols(t),s=[],l=0,u=Object.keys(o).map(Number);l<u.length;l+=1){var c=u[l];s.push(i[c])}s.sort(se);for(var f=function(){var t=p[h],n=t.featureIndex.lookupSymbolFeatures(o[t.bucketInstanceId],t.bucketIndex,t.sourceLayerIndex,r.filter,r.layers,e);for(var i in n){var s=a[i]=a[i]||[],l=n[i];l.sort(function(e,r){var n=t.featureSortOrder;if(n){var i=n.indexOf(e.featureIndex);return n.indexOf(r.featureIndex)-i}return r.featureIndex-e.featureIndex});for(var u=0,c=l;u<c.length;u+=1){var f=c[u];s.push(f.feature)}}},h=0,p=s;h<p.length;h+=1)f();return a}(this._layers,t.viewport,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenRenderedFeatures(u)},r.prototype.querySourceFeatures=function(t,r){r&&r.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",r.filter);var n=this.sourceCaches[t];return n?function(e,t){for(var r=e.getRenderableIds().map(function(t){return e.getTileByID(t)}),n=[],i={},a=0;a<r.length;a++){var o=r[a],s=o.tileID.canonical.key;i[s]||(i[s]=!0,o.querySourceFeatures(n,t))}return n}(n,r):[]},r.prototype.addSourceType=function(e,t,n){return r.getSourceType(e)?n(new Error('A source type called "'+e+'" already exists.')):(r.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},n):n(null,null))},r.prototype.getLight=function(){return this.light.getLight()},r.prototype.setLight=function(t){this._checkLoaded();var r=this.light.getLight(),n=!1;for(var i in t)if(!e.default$10(t[i],r[i])){n=!0;break}if(n){var o={now:a.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t),this.light.updateTransitions(o)}},r.prototype._validate=function(t,r,n,i,a){return(!a||!1!==a.validate)&&Yt(this,t.call(e.validateStyle,e.extend({key:r,style:this.serialize(),value:n,styleSpec:e.default$5},i)))},r.prototype._remove=function(){for(var t in e.evented.off("pluginAvailable",this._rtlTextPluginCallback),this.sourceCaches)this.sourceCaches[t].clearTiles();this.dispatcher.remove()},r.prototype._clearSource=function(e){this.sourceCaches[e].clearTiles()},r.prototype._reloadSource=function(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()},r.prototype._updateSources=function(e){for(var t in this.sourceCaches)this.sourceCaches[t].update(e)},r.prototype._generateCollisionBoxes=function(){for(var e in this.sourceCaches)this._reloadSource(e)},r.prototype._updatePlacement=function(e,t,r){for(var n=!1,i=!1,o={},s=0,l=this._order;s<l.length;s+=1){var u=l[s],c=this._layers[u];if("symbol"===c.type){if(!o[c.source]){var f=this.sourceCaches[c.source];o[c.source]=f.getRenderableIds().map(function(e){return f.getTileByID(e)}).sort(function(e,t){return t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)})}var h=this.crossTileSymbolIndex.addLayer(c,o[c.source],e.center.lng);n=n||h}}this.crossTileSymbolIndex.pruneUnusedLayers(this._order);var p=this._layerOrderChanged;if((p||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.now()))&&(this.pauseablePlacement=new Zt(e,this._order,p,t,r),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,o),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(this.placement,a.now()),i=!0),n&&this.pauseablePlacement.placement.setStale()),i||n)for(var d=0,v=this._order;d<v.length;d+=1){var m=v[d],g=this._layers[m];"symbol"===g.type&&this.placement.updateLayerOpacities(g,o[g.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.now())},r.prototype.getImages=function(e,t,r){this.imageManager.getImages(t.icons,r)},r.prototype.getGlyphs=function(e,t,r){this.glyphManager.getGlyphs(t.stacks,r)},r}(e.Evented);Qt.getSourceType=function(e){return ie[e]},Qt.setSourceType=function(e,t){ie[e]=t},Qt.registerForPluginAvailability=e.registerForPluginAvailability;var er=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),tr={prelude:{fragmentSource:"#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n",vertexSource:"#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif\n\n// Unpack a pair of values that have been packed into a single float.\n// The packed values are assumed to be 8-bit unsigned integers, and are\n// packed like so:\n// packedValue = floor(input[0]) * 256 + input[1],\nvec2 unpack_float(const float packedValue) {\n    int packedIntValue = int(packedValue);\n    int v0 = packedIntValue / 256;\n    return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec2 unpack_opacity(const float packedOpacity) {\n    int intOpacity = int(packedOpacity) / 2;\n    return vec2(float(intOpacity) / 127.0, mod(packedOpacity, 2.0));\n}\n\n// To minimize the number of attributes needed, we encode a 4-component\n// color into a pair of floats (i.e. a vec2) as follows:\n// [ floor(color.r * 255) * 256 + color.g * 255,\n//   floor(color.b * 255) * 256 + color.g * 255 ]\nvec4 decode_color(const vec2 encodedColor) {\n    return vec4(\n        unpack_float(encodedColor[0]) / 255.0,\n        unpack_float(encodedColor[1]) / 255.0\n    );\n}\n\n// Unpack a pair of paint values and interpolate between them.\nfloat unpack_mix_vec2(const vec2 packedValue, const float t) {\n    return mix(packedValue[0], packedValue[1], t);\n}\n\n// Unpack a pair of paint values and interpolate between them.\nvec4 unpack_mix_vec4(const vec4 packedColors, const float t) {\n    vec4 minColor = decode_color(vec2(packedColors[0], packedColors[1]));\n    vec4 maxColor = decode_color(vec2(packedColors[2], packedColors[3]));\n    return mix(minColor, maxColor, t);\n}\n\n// The offset depends on how many pixels are between the world origin and the edge of the tile:\n// vec2 offset = mod(pixel_coord, size)\n//\n// At high zoom levels there are a ton of pixels between the world origin and the edge of the tile.\n// The glsl spec only guarantees 16 bits of precision for highp floats. We need more than that.\n//\n// The pixel_coord is passed in as two 16 bit values:\n// pixel_coord_upper = floor(pixel_coord / 2^16)\n// pixel_coord_lower = mod(pixel_coord, 2^16)\n//\n// The offset is calculated in a series of steps that should preserve this precision:\nvec2 get_pattern_pos(const vec2 pixel_coord_upper, const vec2 pixel_coord_lower,\n    const vec2 pattern_size, const float tile_units_to_pixels, const vec2 pos) {\n\n    vec2 offset = mod(mod(mod(pixel_coord_upper, pattern_size) * 256.0, pattern_size) * 256.0 + pixel_coord_lower, pattern_size);\n    return (tile_units_to_pixels * pos + offset) / pattern_size;\n}\n"},background:{fragmentSource:"uniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main() {\n    gl_FragColor = u_color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},backgroundPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\nuniform float u_opacity;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},circle:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    vec2 extrude = v_data.xy;\n    float extrude_length = length(extrude);\n\n    lowp float antialiasblur = v_data.z;\n    float antialiased_blur = -max(blur, antialiasblur);\n\n    float opacity_t = smoothstep(0.0, antialiased_blur, extrude_length - 1.0);\n\n    float color_t = stroke_width < 0.01 ? 0.0 : smoothstep(\n        antialiased_blur,\n        0.0,\n        extrude_length - radius / (radius + stroke_width)\n    );\n\n    gl_FragColor = opacity_t * mix(color * opacity, stroke_color * stroke_opacity, color_t);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform bool u_scale_with_map;\nuniform bool u_pitch_with_map;\nuniform vec2 u_extrude_scale;\nuniform highp float u_camera_to_center_distance;\n\nattribute vec2 a_pos;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\n\nvarying vec3 v_data;\n\nvoid main(void) {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize mediump float radius\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize highp vec4 stroke_color\n    #pragma mapbox: initialize mediump float stroke_width\n    #pragma mapbox: initialize lowp float stroke_opacity\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec2 circle_center = floor(a_pos * 0.5);\n    if (u_pitch_with_map) {\n        vec2 corner_position = circle_center;\n        if (u_scale_with_map) {\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale;\n        } else {\n            // Pitching the circle with the map effectively scales it with the map\n            // To counteract the effect for pitch-scale: viewport, we rescale the\n            // whole circle based on the pitch scaling effect at its central point\n            vec4 projected_center = u_matrix * vec4(circle_center, 0, 1);\n            corner_position += extrude * (radius + stroke_width) * u_extrude_scale * (projected_center.w / u_camera_to_center_distance);\n        }\n\n        gl_Position = u_matrix * vec4(corner_position, 0, 1);\n    } else {\n        gl_Position = u_matrix * vec4(circle_center, 0, 1);\n\n        if (u_scale_with_map) {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * u_camera_to_center_distance;\n        } else {\n            gl_Position.xy += extrude * (radius + stroke_width) * u_extrude_scale * gl_Position.w;\n        }\n    }\n\n    // This is a minimum blur distance that serves as a faux-antialiasing for\n    // the circle. since blur is a ratio of the circle's size and the intent is\n    // to keep the blur at roughly 1px, the two are inversely related.\n    lowp float antialiasblur = 1.0 / DEVICE_PIXEL_RATIO / (radius + stroke_width);\n\n    v_data = vec3(extrude.x, extrude.y, antialiasblur);\n}\n"},clippingMask:{fragmentSource:"void main() {\n    gl_FragColor = vec4(1.0);\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},heatmap:{fragmentSource:"#pragma mapbox: define highp float weight\n\nuniform highp float u_intensity;\nvarying vec2 v_extrude;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main() {\n    #pragma mapbox: initialize highp float weight\n\n    // Kernel density estimation with a Gaussian kernel of size 5x5\n    float d = -0.5 * 3.0 * 3.0 * dot(v_extrude, v_extrude);\n    float val = weight * u_intensity * GAUSS_COEF * exp(d);\n\n    gl_FragColor = vec4(val, 1.0, 1.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\n\nuniform mat4 u_matrix;\nuniform float u_extrude_scale;\nuniform float u_opacity;\nuniform float u_intensity;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_extrude;\n\n// Effective \"0\" in the kernel density texture to adjust the kernel size to;\n// this empirically chosen number minimizes artifacts on overlapping kernels\n// for typical heatmap cases (assuming clustered source)\nconst highp float ZERO = 1.0 / 255.0 / 16.0;\n\n// Gaussian kernel coefficient: 1 / sqrt(2 * PI)\n#define GAUSS_COEF 0.3989422804014327\n\nvoid main(void) {\n    #pragma mapbox: initialize highp float weight\n    #pragma mapbox: initialize mediump float radius\n\n    // unencode the extrusion vector that we snuck into the a_pos vector\n    vec2 unscaled_extrude = vec2(mod(a_pos, 2.0) * 2.0 - 1.0);\n\n    // This 'extrude' comes in ranging from [-1, -1], to [1, 1].  We'll use\n    // it to produce the vertices of a square mesh framing the point feature\n    // we're adding to the kernel density texture.  We'll also pass it as\n    // a varying, so that the fragment shader can determine the distance of\n    // each fragment from the point feature.\n    // Before we do so, we need to scale it up sufficiently so that the\n    // kernel falls effectively to zero at the edge of the mesh.\n    // That is, we want to know S such that\n    // weight * u_intensity * GAUSS_COEF * exp(-0.5 * 3.0^2 * S^2) == ZERO\n    // Which solves to:\n    // S = sqrt(-2.0 * log(ZERO / (weight * u_intensity * GAUSS_COEF))) / 3.0\n    float S = sqrt(-2.0 * log(ZERO / weight / u_intensity / GAUSS_COEF)) / 3.0;\n\n    // Pass the varying in units of radius\n    v_extrude = S * unscaled_extrude;\n\n    // Scale by radius and the zoom-based scale factor to produce actual\n    // mesh position\n    vec2 extrude = v_extrude * radius * u_extrude_scale;\n\n    // multiply a_pos by 0.5, since we had it * 2 in order to sneak\n    // in extrusion data\n    vec4 pos = vec4(floor(a_pos * 0.5) + extrude, 0, 1);\n\n    gl_Position = u_matrix * pos;\n}\n"},heatmapTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform sampler2D u_color_ramp;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    float t = texture2D(u_image, v_pos).r;\n    vec4 color = texture2D(u_color_ramp, vec2(t, 0.5));\n    gl_FragColor = color * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},collisionBox:{fragmentSource:"\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        gl_FragColor = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        gl_FragColor *= .1;\n    }\n}",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field boxes in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n    gl_Position.xy += a_extrude * u_extrude_scale * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n}\n"},collisionCircle:{fragmentSource:"uniform float u_overscale_factor;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    float alpha = 0.5;\n\n    // Red = collision, hide label\n    vec4 color = vec4(1.0, 0.0, 0.0, 1.0) * alpha;\n\n    // Blue = no collision, label is showing\n    if (v_placed > 0.5) {\n        color = vec4(0.0, 0.0, 1.0, 0.5) * alpha;\n    }\n\n    if (v_notUsed > 0.5) {\n        // This box not used, fade it out\n        color *= .2;\n    }\n\n    float extrude_scale_length = length(v_extrude_scale);\n    float extrude_length = length(v_extrude) * extrude_scale_length;\n    float stroke_width = 15.0 * extrude_scale_length / u_overscale_factor;\n    float radius = v_radius * extrude_scale_length;\n\n    float distance_to_edge = abs(extrude_length - radius);\n    float opacity_t = smoothstep(-stroke_width, 0.0, -distance_to_edge);\n\n    gl_FragColor = opacity_t * color;\n}\n",vertexSource:"attribute vec2 a_pos;\nattribute vec2 a_anchor_pos;\nattribute vec2 a_extrude;\nattribute vec2 a_placed;\n\nuniform mat4 u_matrix;\nuniform vec2 u_extrude_scale;\nuniform float u_camera_to_center_distance;\n\nvarying float v_placed;\nvarying float v_notUsed;\nvarying float v_radius;\n\nvarying vec2 v_extrude;\nvarying vec2 v_extrude_scale;\n\nvoid main() {\n    vec4 projectedPoint = u_matrix * vec4(a_anchor_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    highp float collision_perspective_ratio = clamp(\n        0.5 + 0.5 * (u_camera_to_center_distance / camera_to_anchor_distance),\n        0.0, // Prevents oversized near-field circles in pitched/overzoomed tiles\n        4.0);\n\n    gl_Position = u_matrix * vec4(a_pos, 0.0, 1.0);\n\n    highp float padding_factor = 1.2; // Pad the vertices slightly to make room for anti-alias blur\n    gl_Position.xy += a_extrude * u_extrude_scale * padding_factor * gl_Position.w * collision_perspective_ratio;\n\n    v_placed = a_placed.x;\n    v_notUsed = a_placed.y;\n    v_radius = abs(a_extrude.y); // We don't pitch the circles, so both units of the extrusion vector are equal in magnitude to the radius\n\n    v_extrude = a_extrude * padding_factor;\n    v_extrude_scale = u_extrude_scale * u_camera_to_center_distance * collision_perspective_ratio;\n}\n"},debug:{fragmentSource:"uniform highp vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fill:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_FragColor = color * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n}\n"},fillOutline:{fragmentSource:"#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_pos;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n    gl_FragColor = outline_color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"attribute vec2 a_pos;\n\nuniform mat4 u_matrix;\nuniform vec2 u_world;\n\nvarying vec2 v_pos;\n\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 outline_color\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillOutlinePattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    // find distance to outline for alpha interpolation\n\n    float dist = length(v_pos - gl_FragCoord.xy);\n    float alpha = 1.0 - smoothstep(0.0, 1.0, dist);\n\n\n    gl_FragColor = mix(color1, color2, u_mix) * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec2 v_pos;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n\n    v_pos = (gl_Position.xy / gl_Position.w + 1.0) / 2.0 * u_world;\n}\n"},fillPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    gl_FragColor = mix(color1, color2, u_mix) * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\n\nattribute vec2 a_pos;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\n\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, a_pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, a_pos);\n}\n"},fillExtrusion:{fragmentSource:"varying vec4 v_color;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    gl_FragColor = v_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec4 v_color;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\n#pragma mapbox: define highp vec4 color\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n    #pragma mapbox: initialize highp vec4 color\n\n    vec3 normal = a_normal_ed.xyz;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n\n    gl_Position = u_matrix * vec4(a_pos, t > 0.0 ? height : base, 1);\n\n    // Relative luminance (how dark/bright is the surface color?)\n    float colorvalue = color.r * 0.2126 + color.g * 0.7152 + color.b * 0.0722;\n\n    v_color = vec4(0.0, 0.0, 0.0, 1.0);\n\n    // Add slight ambient lighting so no extrusions are totally black\n    vec4 ambientlight = vec4(0.03, 0.03, 0.03, 1.0);\n    color += ambientlight;\n\n    // Calculate cos(theta), where theta is the angle between surface normal and diffuse light ray\n    float directional = clamp(dot(normal / 16384.0, u_lightpos), 0.0, 1.0);\n\n    // Adjust directional so that\n    // the range of values for highlight/shading is narrower\n    // with lower light intensity\n    // and with lighter/brighter surface colors\n    directional = mix((1.0 - u_lightintensity), max((1.0 - colorvalue + u_lightintensity), 1.0), directional);\n\n    // Add gradient along z axis of side surfaces\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    // Assign final color based on surface + ambient light color, diffuse light directional, and light color\n    // with lower bounds adjusted to hue of light\n    // so that shading is tinted with the complementary (opposite) color to the light color\n    v_color.r += clamp(color.r * directional * u_lightcolor.r, mix(0.0, 0.3, 1.0 - u_lightcolor.r), 1.0);\n    v_color.g += clamp(color.g * directional * u_lightcolor.g, mix(0.0, 0.3, 1.0 - u_lightcolor.g), 1.0);\n    v_color.b += clamp(color.b * directional * u_lightcolor.b, mix(0.0, 0.3, 1.0 - u_lightcolor.b), 1.0);\n}\n"},fillExtrusionPattern:{fragmentSource:"uniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_mix;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec2 imagecoord = mod(v_pos_a, 1.0);\n    vec2 pos = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, imagecoord);\n    vec4 color1 = texture2D(u_image, pos);\n\n    vec2 imagecoord_b = mod(v_pos_b, 1.0);\n    vec2 pos2 = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, imagecoord_b);\n    vec4 color2 = texture2D(u_image, pos2);\n\n    vec4 mixedColor = mix(color1, color2, u_mix);\n\n    gl_FragColor = mixedColor * v_lighting;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pixel_coord_upper;\nuniform vec2 u_pixel_coord_lower;\nuniform float u_scale_a;\nuniform float u_scale_b;\nuniform float u_tile_units_to_pixels;\nuniform float u_height_factor;\n\nuniform vec3 u_lightcolor;\nuniform lowp vec3 u_lightpos;\nuniform lowp float u_lightintensity;\n\nattribute vec2 a_pos;\nattribute vec4 a_normal_ed;\n\nvarying vec2 v_pos_a;\nvarying vec2 v_pos_b;\nvarying vec4 v_lighting;\nvarying float v_directional;\n\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n\nvoid main() {\n    #pragma mapbox: initialize lowp float base\n    #pragma mapbox: initialize lowp float height\n\n    vec3 normal = a_normal_ed.xyz;\n    float edgedistance = a_normal_ed.w;\n\n    base = max(0.0, base);\n    height = max(0.0, height);\n\n    float t = mod(normal.x, 2.0);\n    float z = t > 0.0 ? height : base;\n\n    gl_Position = u_matrix * vec4(a_pos, z, 1);\n\n    vec2 pos = normal.x == 1.0 && normal.y == 0.0 && normal.z == 16384.0\n        ? a_pos // extrusion top\n        : vec2(edgedistance, z * u_height_factor); // extrusion side\n\n    v_pos_a = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_a * u_pattern_size_a, u_tile_units_to_pixels, pos);\n    v_pos_b = get_pattern_pos(u_pixel_coord_upper, u_pixel_coord_lower, u_scale_b * u_pattern_size_b, u_tile_units_to_pixels, pos);\n\n    v_lighting = vec4(0.0, 0.0, 0.0, 1.0);\n    float directional = clamp(dot(normal / 16383.0, u_lightpos), 0.0, 1.0);\n    directional = mix((1.0 - u_lightintensity), max((0.5 + u_lightintensity), 1.0), directional);\n\n    if (normal.y != 0.0) {\n        directional *= clamp((t + base) * pow(height / 150.0, 0.5), mix(0.7, 0.98, 1.0 - u_lightintensity), 1.0);\n    }\n\n    v_lighting.rgb += clamp(directional * u_lightcolor, mix(vec3(0.0), vec3(0.3), 1.0 - u_lightcolor), vec3(1.0));\n}\n"},extrusionTexture:{fragmentSource:"uniform sampler2D u_image;\nuniform float u_opacity;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_FragColor = texture2D(u_image, v_pos) * u_opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(0.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_world;\nattribute vec2 a_pos;\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos * u_world, 0, 1);\n\n    v_pos.x = a_pos.x;\n    v_pos.y = 1.0 - a_pos.y;\n}\n"},hillshadePrepare:{fragmentSource:"#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D u_image;\nvarying vec2 v_pos;\nuniform vec2 u_dimension;\nuniform float u_zoom;\nuniform float u_maxzoom;\n\nfloat getElevation(vec2 coord, float bias) {\n    // Convert encoded elevation value to meters\n    vec4 data = texture2D(u_image, coord) * 255.0;\n    return (data.r + data.g * 256.0 + data.b * 256.0 * 256.0) / 4.0;\n}\n\nvoid main() {\n    vec2 epsilon = 1.0 / u_dimension;\n\n    // queried pixels:\n    // +-----------+\n    // |   |   |   |\n    // | a | b | c |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | d | e | f |\n    // |   |   |   |\n    // +-----------+\n    // |   |   |   |\n    // | g | h | i |\n    // |   |   |   |\n    // +-----------+\n\n    float a = getElevation(v_pos + vec2(-epsilon.x, -epsilon.y), 0.0);\n    float b = getElevation(v_pos + vec2(0, -epsilon.y), 0.0);\n    float c = getElevation(v_pos + vec2(epsilon.x, -epsilon.y), 0.0);\n    float d = getElevation(v_pos + vec2(-epsilon.x, 0), 0.0);\n    float e = getElevation(v_pos, 0.0);\n    float f = getElevation(v_pos + vec2(epsilon.x, 0), 0.0);\n    float g = getElevation(v_pos + vec2(-epsilon.x, epsilon.y), 0.0);\n    float h = getElevation(v_pos + vec2(0, epsilon.y), 0.0);\n    float i = getElevation(v_pos + vec2(epsilon.x, epsilon.y), 0.0);\n\n    // here we divide the x and y slopes by 8 * pixel size\n    // where pixel size (aka meters/pixel) is:\n    // circumference of the world / (pixels per tile * number of tiles)\n    // which is equivalent to: 8 * 40075016.6855785 / (512 * pow(2, u_zoom))\n    // which can be reduced to: pow(2, 19.25619978527 - u_zoom)\n    // we want to vertically exaggerate the hillshading though, because otherwise\n    // it is barely noticeable at low zooms. to do this, we multiply this by some\n    // scale factor pow(2, (u_zoom - u_maxzoom) * a) where a is an arbitrary value\n    // Here we use a=0.3 which works out to the expression below. see \n    // nickidlugash's awesome breakdown for more info\n    // https://github.com/mapbox/mapbox-gl-js/pull/5286#discussion_r148419556\n    float exaggeration = u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;\n\n    vec2 deriv = vec2(\n        (c + f + f + i) - (a + d + d + g),\n        (g + h + h + i) - (a + b + b + c)\n    ) /  pow(2.0, (u_zoom - u_maxzoom) * exaggeration + 19.2562 - u_zoom);\n\n    gl_FragColor = clamp(vec4(\n        deriv.x / 2.0 + 0.5,\n        deriv.y / 2.0 + 0.5,\n        1.0,\n        1.0), 0.0, 1.0);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = (a_texture_pos / 8192.0) / 2.0 + 0.25;\n}\n"},hillshade:{fragmentSource:"uniform sampler2D u_image;\nvarying vec2 v_pos;\n\nuniform vec2 u_latrange;\nuniform vec2 u_light;\nuniform vec4 u_shadow;\nuniform vec4 u_highlight;\nuniform vec4 u_accent;\n\n#define PI 3.141592653589793\n\nvoid main() {\n    vec4 pixel = texture2D(u_image, v_pos);\n\n    vec2 deriv = ((pixel.rg * 2.0) - 1.0);\n\n    // We divide the slope by a scale factor based on the cosin of the pixel's approximate latitude\n    // to account for mercator projection distortion. see #4807 for details\n    float scaleFactor = cos(radians((u_latrange[0] - u_latrange[1]) * (1.0 - v_pos.y) + u_latrange[1]));\n    // We also multiply the slope by an arbitrary z-factor of 1.25\n    float slope = atan(1.25 * length(deriv) / scaleFactor);\n    float aspect = deriv.x != 0.0 ? atan(deriv.y, -deriv.x) : PI / 2.0 * (deriv.y > 0.0 ? 1.0 : -1.0);\n\n    float intensity = u_light.x;\n    // We add PI to make this property match the global light object, which adds PI/2 to the light's azimuthal\n    // position property to account for 0deg corresponding to north/the top of the viewport in the style spec\n    // and the original shader was written to accept (-illuminationDirection - 90) as the azimuthal.\n    float azimuth = u_light.y + PI;\n\n    // We scale the slope exponentially based on intensity, using a calculation similar to\n    // the exponential interpolation function in the style spec:\n    // https://github.com/mapbox/mapbox-gl-js/blob/master/src/style-spec/expression/definitions/interpolate.js#L217-L228\n    // so that higher intensity values create more opaque hillshading.\n    float base = 1.875 - intensity * 1.75;\n    float maxValue = 0.5 * PI;\n    float scaledSlope = intensity != 0.5 ? ((pow(base, slope) - 1.0) / (pow(base, maxValue) - 1.0)) * maxValue : slope;\n\n    // The accent color is calculated with the cosine of the slope while the shade color is calculated with the sine\n    // so that the accent color's rate of change eases in while the shade color's eases out.\n    float accent = cos(scaledSlope);\n    // We multiply both the accent and shade color by a clamped intensity value\n    // so that intensities >= 0.5 do not additionally affect the color values\n    // while intensity values < 0.5 make the overall color more transparent.\n    vec4 accent_color = (1.0 - accent) * u_accent * clamp(intensity * 2.0, 0.0, 1.0);\n    float shade = abs(mod((aspect + azimuth) / PI + 0.5, 2.0) - 1.0);\n    vec4 shade_color = mix(u_shadow, u_highlight, shade) * sin(scaledSlope) * clamp(intensity * 2.0, 0.0, 1.0);\n    gl_FragColor = accent_color * (1.0 - shade_color.a) + shade_color;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    v_pos = a_texture_pos / 8192.0;\n}\n"},line:{fragmentSource:"#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_linesofar;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},lineGradient:{fragmentSource:"\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nuniform sampler2D u_image;\n\nvarying vec2 v_width2;\nvarying vec2 v_normal;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    // For gradient lines, v_lineprogress is the ratio along the entire line,\n    // scaled to [0, 2^15), and the gradient ramp is stored in a texture.\n    vec4 color = texture2D(u_image, vec2(v_lineprogress, 0.5));\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"\n// the attribute conveying progress along a line is scaled to [0, 2^15)\n#define MAX_LINE_DISTANCE 32767.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\n// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_gamma_scale;\nvarying highp float v_lineprogress;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n\n    v_lineprogress = (floor(a_data.z / 4.0) + a_data.w * 64.0) * 2.0 / MAX_LINE_DISTANCE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_width2 = vec2(outset, inset);\n}\n"},linePattern:{fragmentSource:"uniform vec2 u_pattern_size_a;\nuniform vec2 u_pattern_size_b;\nuniform vec2 u_pattern_tl_a;\nuniform vec2 u_pattern_br_a;\nuniform vec2 u_pattern_tl_b;\nuniform vec2 u_pattern_br_b;\nuniform vec2 u_texsize;\nuniform float u_fade;\n\nuniform sampler2D u_image;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float x_a = mod(v_linesofar / u_pattern_size_a.x, 1.0);\n    float x_b = mod(v_linesofar / u_pattern_size_b.x, 1.0);\n\n    // v_normal.y is 0 at the midpoint of the line, -1 at the lower edge, 1 at the upper edge\n    // we clamp the line width outset to be between 0 and half the pattern height plus padding (2.0)\n    // to ensure we don't sample outside the designated symbol on the sprite sheet.\n    // 0.5 is added to shift the component to be bounded between 0 and 1 for interpolation of\n    // the texture coordinate\n    float y_a = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (u_pattern_size_a.y + 2.0) / 2.0) / u_pattern_size_a.y);\n    float y_b = 0.5 + (v_normal.y * clamp(v_width2.s, 0.0, (u_pattern_size_b.y + 2.0) / 2.0) / u_pattern_size_b.y);\n    vec2 pos_a = mix(u_pattern_tl_a / u_texsize, u_pattern_br_a / u_texsize, vec2(x_a, y_a));\n    vec2 pos_b = mix(u_pattern_tl_b / u_texsize, u_pattern_br_b / u_texsize, vec2(x_b, y_b));\n\n    vec4 color = mix(texture2D(u_image, pos_a), texture2D(u_image, pos_b), u_fade);\n\n    gl_FragColor = color * alpha * opacity;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying float v_linesofar;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n\nvoid main() {\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize mediump float width\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist = outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_linesofar = a_linesofar;\n    v_width2 = vec2(outset, inset);\n}\n"},lineSDF:{fragmentSource:"\nuniform sampler2D u_image;\nuniform float u_sdfgamma;\nuniform float u_mix;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    // Calculate the distance of the pixel from the line in pixels.\n    float dist = length(v_normal) * v_width2.s;\n\n    // Calculate the antialiasing fade factor. This is either when fading in\n    // the line in case of an offset line (v_width2.t) or when fading out\n    // (v_width2.s)\n    float blur2 = (blur + 1.0 / DEVICE_PIXEL_RATIO) * v_gamma_scale;\n    float alpha = clamp(min(dist - (v_width2.t - blur2), v_width2.s - dist) / blur2, 0.0, 1.0);\n\n    float sdfdist_a = texture2D(u_image, v_tex_a).a;\n    float sdfdist_b = texture2D(u_image, v_tex_b).a;\n    float sdfdist = mix(sdfdist_a, sdfdist_b, u_mix);\n    alpha *= smoothstep(0.5 - u_sdfgamma / floorwidth, 0.5 + u_sdfgamma / floorwidth, sdfdist);\n\n    gl_FragColor = color * (alpha * opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"// floor(127 / 2) == 63.0\n// the maximum allowed miter limit is 2.0 at the moment. the extrude normal is\n// stored in a byte (-128..127). we scale regular normals up to length 63, but\n// there are also \"special\" normals that have a bigger length (of up to 126 in\n// this case).\n// #define scale 63.0\n#define scale 0.015873016\n\n// We scale the distance before adding it to the buffers so that we can store\n// long distances for long segments. Use this value to unscale the distance.\n#define LINE_DISTANCE_SCALE 2.0\n\n// the distance over which the line edge fades out.\n// Retina devices need a smaller distance to avoid aliasing.\n#define ANTIALIASING 1.0 / DEVICE_PIXEL_RATIO / 2.0\n\nattribute vec4 a_pos_normal;\nattribute vec4 a_data;\n\nuniform mat4 u_matrix;\nuniform mediump float u_ratio;\nuniform vec2 u_patternscale_a;\nuniform float u_tex_y_a;\nuniform vec2 u_patternscale_b;\nuniform float u_tex_y_b;\nuniform vec2 u_gl_units_to_pixels;\n\nvarying vec2 v_normal;\nvarying vec2 v_width2;\nvarying vec2 v_tex_a;\nvarying vec2 v_tex_b;\nvarying float v_gamma_scale;\n\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 color\n    #pragma mapbox: initialize lowp float blur\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize mediump float gapwidth\n    #pragma mapbox: initialize lowp float offset\n    #pragma mapbox: initialize mediump float width\n    #pragma mapbox: initialize lowp float floorwidth\n\n    vec2 a_extrude = a_data.xy - 128.0;\n    float a_direction = mod(a_data.z, 4.0) - 1.0;\n    float a_linesofar = (floor(a_data.z / 4.0) + a_data.w * 64.0) * LINE_DISTANCE_SCALE;\n\n    vec2 pos = a_pos_normal.xy;\n\n    // x is 1 if it's a round cap, 0 otherwise\n    // y is 1 if the normal points up, and -1 if it points down\n    mediump vec2 normal = a_pos_normal.zw;\n    v_normal = normal;\n\n    // these transformations used to be applied in the JS and native code bases.\n    // moved them into the shader for clarity and simplicity.\n    gapwidth = gapwidth / 2.0;\n    float halfwidth = width / 2.0;\n    offset = -1.0 * offset;\n\n    float inset = gapwidth + (gapwidth > 0.0 ? ANTIALIASING : 0.0);\n    float outset = gapwidth + halfwidth * (gapwidth > 0.0 ? 2.0 : 1.0) + ANTIALIASING;\n\n    // Scale the extrusion vector down to a normal and then up by the line width\n    // of this vertex.\n    mediump vec2 dist =outset * a_extrude * scale;\n\n    // Calculate the offset when drawing a line that is to the side of the actual line.\n    // We do this by creating a vector that points towards the extrude, but rotate\n    // it when we're drawing round end points (a_direction = -1 or 1) since their\n    // extrude vector points in another direction.\n    mediump float u = 0.5 * a_direction;\n    mediump float t = 1.0 - abs(u);\n    mediump vec2 offset2 = offset * a_extrude * scale * normal.y * mat2(t, -u, u, t);\n\n    vec4 projected_extrude = u_matrix * vec4(dist / u_ratio, 0.0, 0.0);\n    gl_Position = u_matrix * vec4(pos + offset2 / u_ratio, 0.0, 1.0) + projected_extrude;\n\n    // calculate how much the perspective view squishes or stretches the extrude\n    float extrude_length_without_perspective = length(dist);\n    float extrude_length_with_perspective = length(projected_extrude.xy / gl_Position.w * u_gl_units_to_pixels);\n    v_gamma_scale = extrude_length_without_perspective / extrude_length_with_perspective;\n\n    v_tex_a = vec2(a_linesofar * u_patternscale_a.x / floorwidth, normal.y * u_patternscale_a.y + u_tex_y_a);\n    v_tex_b = vec2(a_linesofar * u_patternscale_b.x / floorwidth, normal.y * u_patternscale_b.y + u_tex_y_b);\n\n    v_width2 = vec2(outset, inset);\n}\n"},raster:{fragmentSource:"uniform float u_fade_t;\nuniform float u_opacity;\nuniform sampler2D u_image0;\nuniform sampler2D u_image1;\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nuniform float u_brightness_low;\nuniform float u_brightness_high;\n\nuniform float u_saturation_factor;\nuniform float u_contrast_factor;\nuniform vec3 u_spin_weights;\n\nvoid main() {\n\n    // read and cross-fade colors from the main and parent tiles\n    vec4 color0 = texture2D(u_image0, v_pos0);\n    vec4 color1 = texture2D(u_image1, v_pos1);\n    if (color0.a > 0.0) {\n        color0.rgb = color0.rgb / color0.a;\n    }\n    if (color1.a > 0.0) {\n        color1.rgb = color1.rgb / color1.a;\n    }\n    vec4 color = mix(color0, color1, u_fade_t);\n    color.a *= u_opacity;\n    vec3 rgb = color.rgb;\n\n    // spin\n    rgb = vec3(\n        dot(rgb, u_spin_weights.xyz),\n        dot(rgb, u_spin_weights.zxy),\n        dot(rgb, u_spin_weights.yzx));\n\n    // saturation\n    float average = (color.r + color.g + color.b) / 3.0;\n    rgb += (average - rgb) * u_saturation_factor;\n\n    // contrast\n    rgb = (rgb - 0.5) * u_contrast_factor + 0.5;\n\n    // brightness\n    vec3 u_high_vec = vec3(u_brightness_low, u_brightness_low, u_brightness_low);\n    vec3 u_low_vec = vec3(u_brightness_high, u_brightness_high, u_brightness_high);\n\n    gl_FragColor = vec4(mix(u_high_vec, u_low_vec, rgb) * color.a, color.a);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"uniform mat4 u_matrix;\nuniform vec2 u_tl_parent;\nuniform float u_scale_parent;\nuniform float u_buffer_scale;\n\nattribute vec2 a_pos;\nattribute vec2 a_texture_pos;\n\nvarying vec2 v_pos0;\nvarying vec2 v_pos1;\n\nvoid main() {\n    gl_Position = u_matrix * vec4(a_pos, 0, 1);\n    // We are using Int16 for texture position coordinates to give us enough precision for\n    // fractional coordinates. We use 8192 to scale the texture coordinates in the buffer\n    // as an arbitrarily high number to preserve adequate precision when rendering.\n    // This is also the same value as the EXTENT we are using for our tile buffer pos coordinates,\n    // so math for modifying either is consistent.\n    v_pos0 = (((a_texture_pos / 8192.0) - 0.5) / u_buffer_scale ) + 0.5;\n    v_pos1 = (v_pos0 * u_scale_parent) + u_tl_parent;\n}\n"},symbolIcon:{fragmentSource:"uniform sampler2D u_texture;\n\n#pragma mapbox: define lowp float opacity\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    lowp float alpha = opacity * v_fade_opacity;\n    gl_FragColor = texture2D(u_texture, v_tex) * alpha;\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\nuniform highp float u_camera_to_center_distance;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform float u_fade_change;\n\n#pragma mapbox: define lowp float opacity\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_tex;\nvarying float v_fade_opacity;\n\nvoid main() {\n    #pragma mapbox: initialize lowp float opacity\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n\n    float size;\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // See comments in symbol_sdf.vertex\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n            0.5 + 0.5 * distance_ratio,\n            0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n            4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // See comments in symbol_sdf.vertex\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n\n    v_tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    v_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n}\n"},symbolSDF:{fragmentSource:"#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105/DEVICE_PIXEL_RATIO\n\nuniform bool u_is_halo;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform sampler2D u_texture;\nuniform highp float u_gamma_scale;\nuniform bool u_is_text;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 tex = v_data0.xy;\n    float gamma_scale = v_data1.x;\n    float size = v_data1.y;\n    float fade_opacity = v_data1[2];\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    lowp vec4 color = fill_color;\n    highp float gamma = EDGE_GAMMA / (fontScale * u_gamma_scale);\n    lowp float buff = (256.0 - 64.0) / 256.0;\n    if (u_is_halo) {\n        color = halo_color;\n        gamma = (halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (fontScale * u_gamma_scale);\n        buff = (6.0 - halo_width / fontScale) / SDF_PX;\n    }\n\n    lowp float dist = texture2D(u_texture, tex).a;\n    highp float gamma_scaled = gamma * gamma_scale;\n    highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n\n    gl_FragColor = color * (alpha * opacity * fade_opacity);\n\n#ifdef OVERDRAW_INSPECTOR\n    gl_FragColor = vec4(1.0);\n#endif\n}\n",vertexSource:"const float PI = 3.141592653589793;\n\nattribute vec4 a_pos_offset;\nattribute vec4 a_data;\nattribute vec3 a_projected_pos;\nattribute float a_fade_opacity;\n\n// contents of a_size vary based on the type of property value\n// used for {text,icon}-size.\n// For constants, a_size is disabled.\n// For source functions, we bind only one value per vertex: the value of {text,icon}-size evaluated for the current feature.\n// For composite functions:\n// [ text-size(lowerZoomStop, feature),\n//   text-size(upperZoomStop, feature) ]\nuniform bool u_is_size_zoom_constant;\nuniform bool u_is_size_feature_constant;\nuniform highp float u_size_t; // used to interpolate between zoom stops when size is a composite function\nuniform highp float u_size; // used when size is both zoom and feature constant\n\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n\nuniform mat4 u_matrix;\nuniform mat4 u_label_plane_matrix;\nuniform mat4 u_gl_coord_matrix;\n\nuniform bool u_is_text;\nuniform bool u_pitch_with_map;\nuniform highp float u_pitch;\nuniform bool u_rotate_symbol;\nuniform highp float u_aspect_ratio;\nuniform highp float u_camera_to_center_distance;\nuniform float u_fade_change;\n\nuniform vec2 u_texsize;\n\nvarying vec2 v_data0;\nvarying vec3 v_data1;\n\nvoid main() {\n    #pragma mapbox: initialize highp vec4 fill_color\n    #pragma mapbox: initialize highp vec4 halo_color\n    #pragma mapbox: initialize lowp float opacity\n    #pragma mapbox: initialize lowp float halo_width\n    #pragma mapbox: initialize lowp float halo_blur\n\n    vec2 a_pos = a_pos_offset.xy;\n    vec2 a_offset = a_pos_offset.zw;\n\n    vec2 a_tex = a_data.xy;\n    vec2 a_size = a_data.zw;\n\n    highp float segment_angle = -a_projected_pos[2];\n    float size;\n\n    if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = mix(a_size[0], a_size[1], u_size_t) / 10.0;\n    } else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {\n        size = a_size[0] / 10.0;\n    } else if (!u_is_size_zoom_constant && u_is_size_feature_constant) {\n        size = u_size;\n    } else {\n        size = u_size;\n    }\n\n    vec4 projectedPoint = u_matrix * vec4(a_pos, 0, 1);\n    highp float camera_to_anchor_distance = projectedPoint.w;\n    // If the label is pitched with the map, layout is done in pitched space,\n    // which makes labels in the distance smaller relative to viewport space.\n    // We counteract part of that effect by multiplying by the perspective ratio.\n    // If the label isn't pitched with the map, we do layout in viewport space,\n    // which makes labels in the distance larger relative to the features around\n    // them. We counteract part of that effect by dividing by the perspective ratio.\n    highp float distance_ratio = u_pitch_with_map ?\n        camera_to_anchor_distance / u_camera_to_center_distance :\n        u_camera_to_center_distance / camera_to_anchor_distance;\n    highp float perspective_ratio = clamp(\n        0.5 + 0.5 * distance_ratio,\n        0.0, // Prevents oversized near-field symbols in pitched/overzoomed tiles\n        4.0);\n\n    size *= perspective_ratio;\n\n    float fontScale = u_is_text ? size / 24.0 : size;\n\n    highp float symbol_rotation = 0.0;\n    if (u_rotate_symbol) {\n        // Point labels with 'rotation-alignment: map' are horizontal with respect to tile units\n        // To figure out that angle in projected space, we draw a short horizontal line in tile\n        // space, project it, and measure its angle in projected space.\n        vec4 offsetProjectedPoint = u_matrix * vec4(a_pos + vec2(1, 0), 0, 1);\n\n        vec2 a = projectedPoint.xy / projectedPoint.w;\n        vec2 b = offsetProjectedPoint.xy / offsetProjectedPoint.w;\n\n        symbol_rotation = atan((b.y - a.y) / u_aspect_ratio, b.x - a.x);\n    }\n\n    highp float angle_sin = sin(segment_angle + symbol_rotation);\n    highp float angle_cos = cos(segment_angle + symbol_rotation);\n    mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n\n    vec4 projected_pos = u_label_plane_matrix * vec4(a_projected_pos.xy, 0.0, 1.0);\n    gl_Position = u_gl_coord_matrix * vec4(projected_pos.xy / projected_pos.w + rotation_matrix * (a_offset / 32.0 * fontScale), 0.0, 1.0);\n    float gamma_scale = gl_Position.w;\n\n    vec2 tex = a_tex / u_texsize;\n    vec2 fade_opacity = unpack_opacity(a_fade_opacity);\n    float fade_change = fade_opacity[1] > 0.5 ? u_fade_change : -u_fade_change;\n    float interpolated_fade_opacity = max(0.0, min(1.0, fade_opacity[0] + fade_change));\n\n    v_data0 = vec2(tex.x, tex.y);\n    v_data1 = vec3(gamma_scale, size, interpolated_fade_opacity);\n}\n"}},rr=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,nr=function(e){var t=tr[e],r={};t.fragmentSource=t.fragmentSource.replace(rr,function(e,t,n,i,a){return r[a]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_"+a+"\nvarying "+n+" "+i+" "+a+";\n#else\nuniform "+n+" "+i+" u_"+a+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+a+"\n    "+n+" "+i+" "+a+" = u_"+a+";\n#endif\n"}),t.vertexSource=t.vertexSource.replace(rr,function(e,t,n,i,a){var o="float"===i?"vec2":"vec4";return r[a]?"define"===t?"\n#ifndef HAS_UNIFORM_u_"+a+"\nuniform lowp float a_"+a+"_t;\nattribute "+n+" "+o+" a_"+a+";\nvarying "+n+" "+i+" "+a+";\n#else\nuniform "+n+" "+i+" u_"+a+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+a+" = unpack_mix_"+o+"(a_"+a+", a_"+a+"_t);\n#else\n    "+n+" "+i+" "+a+" = u_"+a+";\n#endif\n":"define"===t?"\n#ifndef HAS_UNIFORM_u_"+a+"\nuniform lowp float a_"+a+"_t;\nattribute "+n+" "+o+" a_"+a+";\n#else\nuniform "+n+" "+i+" u_"+a+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+a+"\n    "+n+" "+i+" "+a+" = unpack_mix_"+o+"(a_"+a+", a_"+a+"_t);\n#else\n    "+n+" "+i+" "+a+" = u_"+a+";\n#endif\n"})};for(var ir in tr)nr(ir);var ar=tr,or=function(e,t,r,n){var i=e.gl;this.program=i.createProgram();var o=r.defines().concat("#define DEVICE_PIXEL_RATIO "+a.devicePixelRatio.toFixed(1));n&&o.push("#define OVERDRAW_INSPECTOR;");var s=o.concat(ar.prelude.fragmentSource,t.fragmentSource).join("\n"),l=o.concat(ar.prelude.vertexSource,t.vertexSource).join("\n"),u=i.createShader(i.FRAGMENT_SHADER);i.shaderSource(u,s),i.compileShader(u),i.attachShader(this.program,u);var c=i.createShader(i.VERTEX_SHADER);i.shaderSource(c,l),i.compileShader(c),i.attachShader(this.program,c);for(var f=r.layoutAttributes||[],h=0;h<f.length;h++)i.bindAttribLocation(this.program,h,f[h].name);i.linkProgram(this.program),this.numAttributes=i.getProgramParameter(this.program,i.ACTIVE_ATTRIBUTES),this.attributes={},this.uniforms={};for(var p=0;p<this.numAttributes;p++){var d=i.getActiveAttrib(this.program,p);d&&(this.attributes[d.name]=i.getAttribLocation(this.program,d.name))}for(var v=i.getProgramParameter(this.program,i.ACTIVE_UNIFORMS),m=0;m<v;m++){var g=i.getActiveUniform(this.program,m);g&&(this.uniforms[g.name]=i.getUniformLocation(this.program,g.name))}};function sr(t,r,n,i,a){for(var o=0;o<n.length;o++){var s=n[o];if(i.isLessThan(s.tileID))break;if(r.key===s.tileID.key)return;if(s.tileID.isChildOf(r)){for(var l=r.children(1/0),u=0;u<l.length;u++){sr(t,l[u],n.slice(o),i,a)}return}}var c=r.overscaledZ-t.overscaledZ,f=new e.CanonicalTileID(c,r.canonical.x-(t.canonical.x<<c),r.canonical.y-(t.canonical.y<<c));a[f.key]=a[f.key]||f}function lr(e,t,r,n,i){var a=e.context,o=a.gl,s=i?e.useProgram("collisionCircle"):e.useProgram("collisionBox");a.setDepthMode(Ze.disabled),a.setStencilMode(He.disabled),a.setColorMode(e.colorModeForRenderPass());for(var l=0;l<n.length;l++){var u=n[l],c=t.getTile(u),f=c.getBucket(r);if(f){var h=i?f.collisionCircle:f.collisionBox;if(h){o.uniformMatrix4fv(s.uniforms.u_matrix,!1,u.posMatrix),i||a.lineWidth.set(1),o.uniform1f(s.uniforms.u_camera_to_center_distance,e.transform.cameraToCenterDistance);var p=Ct(c,1,e.transform.zoom),d=Math.pow(2,e.transform.zoom-c.tileID.overscaledZ);o.uniform1f(s.uniforms.u_pixels_to_tile_units,p),o.uniform2f(s.uniforms.u_extrude_scale,e.transform.pixelsToGLUnits[0]/(p*d),e.transform.pixelsToGLUnits[1]/(p*d)),o.uniform1f(s.uniforms.u_overscale_factor,c.tileID.overscaleFactor()),s.draw(a,i?o.TRIANGLES:o.LINES,r.id,h.layoutVertexBuffer,h.indexBuffer,h.segments,null,h.collisionVertexBuffer,null)}}}}or.prototype.draw=function(e,t,r,n,i,a,o,s,l){for(var u,c=e.gl,f=(u={},u[c.LINES]=2,u[c.TRIANGLES]=3,u)[t],h=0,p=a.get();h<p.length;h+=1){var d=p[h],v=d.vaos||(d.vaos={});(v[r]||(v[r]=new ee)).bind(e,this,n,o?o.getPaintVertexBuffers():[],i,d.vertexOffset,s,l),c.drawElements(t,d.primitiveLength*f,c.UNSIGNED_SHORT,d.primitiveOffset*f*2)}};var ur=e.mat4.identity(new Float32Array(16)),cr=e.default$19.layout;function fr(e,t,r,n,i,a,o,s,l,u){var c,f=e.context,h=f.gl,p=e.transform,d="map"===s,v="map"===l,m=d&&"line"===r.layout.get("symbol-placement"),g=d&&!v&&!m,y=v;f.setDepthMode(y?e.depthModeForSublayer(0,Ze.ReadOnly):Ze.disabled);for(var _=0,x=n;_<x.length;_+=1){var b=x[_],w=t.getTile(b),k=w.getBucket(r);if(k){var A=i?k.text:k.icon;if(A&&A.segments.get().length){var T=A.programConfigurations.get(r.id),M=i||k.sdfIcons,S=i?k.textSizeData:k.iconSizeData;if(c||(c=e.useProgram(M?"symbolSDF":"symbolIcon",T),T.setUniforms(e.context,c,r.paint,{zoom:e.transform.zoom}),hr(c,e,r,i,g,v,S)),f.activeTexture.set(h.TEXTURE0),h.uniform1i(c.uniforms.u_texture,0),i)w.glyphAtlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.uniform2fv(c.uniforms.u_texsize,w.glyphAtlasTexture.size);else{var C=1!==r.layout.get("icon-size").constantOr(0)||k.iconsNeedLinear,z=v||0!==p.pitch;w.iconAtlasTexture.bind(M||e.options.rotating||e.options.zooming||C||z?h.LINEAR:h.NEAREST,h.CLAMP_TO_EDGE),h.uniform2fv(c.uniforms.u_texsize,w.iconAtlasTexture.size)}h.uniformMatrix4fv(c.uniforms.u_matrix,!1,e.translatePosMatrix(b.posMatrix,w,a,o));var E=Ct(w,1,e.transform.zoom),L=pt(b.posMatrix,v,d,e.transform,E),I=dt(b.posMatrix,v,d,e.transform,E);h.uniformMatrix4fv(c.uniforms.u_gl_coord_matrix,!1,e.translatePosMatrix(I,w,a,o,!0)),m?(h.uniformMatrix4fv(c.uniforms.u_label_plane_matrix,!1,ur),gt(k,b.posMatrix,e,i,L,I,v,u)):h.uniformMatrix4fv(c.uniforms.u_label_plane_matrix,!1,L),h.uniform1f(c.uniforms.u_fade_change,e.options.fadeDuration?e.symbolFadeChange:1),pr(c,T,e,r,w,A,i,M,v)}}}}function hr(t,r,n,i,a,o,s){var l=r.context.gl,u=r.transform;l.uniform1i(t.uniforms.u_pitch_with_map,o?1:0),l.uniform1f(t.uniforms.u_is_text,i?1:0),l.uniform1f(t.uniforms.u_pitch,u.pitch/360*2*Math.PI);var c="constant"===s.functionType||"source"===s.functionType,f="constant"===s.functionType||"camera"===s.functionType;l.uniform1i(t.uniforms.u_is_size_zoom_constant,c?1:0),l.uniform1i(t.uniforms.u_is_size_feature_constant,f?1:0),l.uniform1f(t.uniforms.u_camera_to_center_distance,u.cameraToCenterDistance);var h=e.evaluateSizeForZoom(s,u.zoom,cr.properties[i?"text-size":"icon-size"]);void 0!==h.uSizeT&&l.uniform1f(t.uniforms.u_size_t,h.uSizeT),void 0!==h.uSize&&l.uniform1f(t.uniforms.u_size,h.uSize),l.uniform1f(t.uniforms.u_aspect_ratio,u.width/u.height),l.uniform1i(t.uniforms.u_rotate_symbol,a?1:0)}function pr(e,t,r,n,i,a,o,s,l){var u=r.context,c=u.gl,f=r.transform;if(s){var h=0!==n.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1),p=l?Math.cos(f._pitch)*f.cameraToCenterDistance:1;c.uniform1f(e.uniforms.u_gamma_scale,p),h&&(c.uniform1f(e.uniforms.u_is_halo,1),dr(a,n,u,e)),c.uniform1f(e.uniforms.u_is_halo,0)}dr(a,n,u,e)}function dr(e,t,r,n){n.draw(r,r.gl.TRIANGLES,t.id,e.layoutVertexBuffer,e.indexBuffer,e.segments,e.programConfigurations.get(t.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function vr(e,t,r,n,i,o,s,l,u){var c,f,h,p,d=t.context,v=d.gl,m=i.paint.get("line-dasharray"),g=i.paint.get("line-pattern");if(l||u){var y=1/Ct(r,1,t.transform.tileZoom);if(m){c=t.lineAtlas.getDash(m.from,"round"===i.layout.get("line-cap")),f=t.lineAtlas.getDash(m.to,"round"===i.layout.get("line-cap"));var _=c.width*m.fromScale,x=f.width*m.toScale;v.uniform2f(e.uniforms.u_patternscale_a,y/_,-c.height/2),v.uniform2f(e.uniforms.u_patternscale_b,y/x,-f.height/2),v.uniform1f(e.uniforms.u_sdfgamma,t.lineAtlas.width/(256*Math.min(_,x)*a.devicePixelRatio)/2)}else if(g){if(h=t.imageManager.getPattern(g.from),p=t.imageManager.getPattern(g.to),!h||!p)return;v.uniform2f(e.uniforms.u_pattern_size_a,h.displaySize[0]*g.fromScale/y,h.displaySize[1]),v.uniform2f(e.uniforms.u_pattern_size_b,p.displaySize[0]*g.toScale/y,p.displaySize[1]);var b=t.imageManager.getPixelSize(),w=b.width,k=b.height;v.uniform2fv(e.uniforms.u_texsize,[w,k])}v.uniform2f(e.uniforms.u_gl_units_to_pixels,1/t.transform.pixelsToGLUnits[0],1/t.transform.pixelsToGLUnits[1])}l&&(m?(v.uniform1i(e.uniforms.u_image,0),d.activeTexture.set(v.TEXTURE0),t.lineAtlas.bind(d),v.uniform1f(e.uniforms.u_tex_y_a,c.y),v.uniform1f(e.uniforms.u_tex_y_b,f.y),v.uniform1f(e.uniforms.u_mix,m.t)):g&&(v.uniform1i(e.uniforms.u_image,0),d.activeTexture.set(v.TEXTURE0),t.imageManager.bind(d),v.uniform2fv(e.uniforms.u_pattern_tl_a,h.tl),v.uniform2fv(e.uniforms.u_pattern_br_a,h.br),v.uniform2fv(e.uniforms.u_pattern_tl_b,p.tl),v.uniform2fv(e.uniforms.u_pattern_br_b,p.br),v.uniform1f(e.uniforms.u_fade,g.t))),d.setStencilMode(t.stencilModeForClipping(o));var A=t.translatePosMatrix(o.posMatrix,r,i.paint.get("line-translate"),i.paint.get("line-translate-anchor"));if(v.uniformMatrix4fv(e.uniforms.u_matrix,!1,A),v.uniform1f(e.uniforms.u_ratio,1/Ct(r,1,t.transform.zoom)),i.paint.get("line-gradient")){d.activeTexture.set(v.TEXTURE0);var T=i.gradientTexture;if(!i.gradient)return;T||(T=i.gradientTexture=new I(d,i.gradient,v.RGBA)),T.bind(v.LINEAR,v.CLAMP_TO_EDGE),v.uniform1i(e.uniforms.u_image,0)}e.draw(d,v.TRIANGLES,i.id,n.layoutVertexBuffer,n.indexBuffer,n.segments,s)}var mr=function(e,t){if(!e)return!1;var r=t.imageManager.getPattern(e.from),n=t.imageManager.getPattern(e.to);return!r||!n},gr=function(e,t,r){var n=t.context,i=n.gl,a=t.imageManager.getPattern(e.from),o=t.imageManager.getPattern(e.to);i.uniform1i(r.uniforms.u_image,0),i.uniform2fv(r.uniforms.u_pattern_tl_a,a.tl),i.uniform2fv(r.uniforms.u_pattern_br_a,a.br),i.uniform2fv(r.uniforms.u_pattern_tl_b,o.tl),i.uniform2fv(r.uniforms.u_pattern_br_b,o.br);var s=t.imageManager.getPixelSize(),l=s.width,u=s.height;i.uniform2fv(r.uniforms.u_texsize,[l,u]),i.uniform1f(r.uniforms.u_mix,e.t),i.uniform2fv(r.uniforms.u_pattern_size_a,a.displaySize),i.uniform2fv(r.uniforms.u_pattern_size_b,o.displaySize),i.uniform1f(r.uniforms.u_scale_a,e.fromScale),i.uniform1f(r.uniforms.u_scale_b,e.toScale),n.activeTexture.set(i.TEXTURE0),t.imageManager.bind(t.context)},yr=function(e,t,r){var n=t.context.gl;n.uniform1f(r.uniforms.u_tile_units_to_pixels,1/Ct(e,1,t.transform.tileZoom));var i=Math.pow(2,e.tileID.overscaledZ),a=e.tileSize*Math.pow(2,t.transform.tileZoom)/i,o=a*(e.tileID.canonical.x+e.tileID.wrap*i),s=a*e.tileID.canonical.y;n.uniform2f(r.uniforms.u_pixel_coord_upper,o>>16,s>>16),n.uniform2f(r.uniforms.u_pixel_coord_lower,65535&o,65535&s)};function _r(e,t,r,n,i){if(!mr(r.paint.get("fill-pattern"),e))for(var a=!0,o=0,s=n;o<s.length;o+=1){var l=s[o],u=t.getTile(l),c=u.getBucket(r);c&&(e.context.setStencilMode(e.stencilModeForClipping(l)),i(e,t,r,u,l,c,a),a=!1)}}function xr(e,t,r,n,i,a,o){var s=e.context.gl,l=a.programConfigurations.get(r.id);wr("fill",r.paint.get("fill-pattern"),e,l,r,n,i,o).draw(e.context,s.TRIANGLES,r.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,l)}function br(e,t,r,n,i,a,o){var s=e.context.gl,l=a.programConfigurations.get(r.id),u=wr("fillOutline",r.getPaintProperty("fill-outline-color")?null:r.paint.get("fill-pattern"),e,l,r,n,i,o);s.uniform2f(u.uniforms.u_world,s.drawingBufferWidth,s.drawingBufferHeight),u.draw(e.context,s.LINES,r.id,a.layoutVertexBuffer,a.indexBuffer2,a.segments2,l)}function wr(e,t,r,n,i,a,o,s){var l,u=r.context.program.get();return t?(l=r.useProgram(e+"Pattern",n),(s||l.program!==u)&&(n.setUniforms(r.context,l,i.paint,{zoom:r.transform.zoom}),gr(t,r,l)),yr(a,r,l)):(l=r.useProgram(e,n),(s||l.program!==u)&&n.setUniforms(r.context,l,i.paint,{zoom:r.transform.zoom})),r.context.gl.uniformMatrix4fv(l.uniforms.u_matrix,!1,r.translatePosMatrix(o.posMatrix,a,i.paint.get("fill-translate"),i.paint.get("fill-translate-anchor"))),l}var kr=e.default$20.mat3,Ar=e.default$20.mat4,Tr=e.default$20.vec3;function Mr(e,t,r,n,i,a,o){var s=e.context,l=s.gl,u=r.paint.get("fill-extrusion-pattern"),c=e.context.program.get(),f=a.programConfigurations.get(r.id),h=e.useProgram(u?"fillExtrusionPattern":"fillExtrusion",f);if((o||h.program!==c)&&f.setUniforms(s,h,r.paint,{zoom:e.transform.zoom}),u){if(mr(u,e))return;gr(u,e,h),yr(n,e,h),l.uniform1f(h.uniforms.u_height_factor,-Math.pow(2,i.overscaledZ)/n.tileSize/8)}e.context.gl.uniformMatrix4fv(h.uniforms.u_matrix,!1,e.translatePosMatrix(i.posMatrix,n,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor"))),function(e,t){var r=t.context.gl,n=t.style.light,i=n.properties.get("position"),a=[i.x,i.y,i.z],o=kr.create();"viewport"===n.properties.get("anchor")&&kr.fromRotation(o,-t.transform.angle);Tr.transformMat3(a,a,o);var s=n.properties.get("color");r.uniform3fv(e.uniforms.u_lightpos,a),r.uniform1f(e.uniforms.u_lightintensity,n.properties.get("intensity")),r.uniform3f(e.uniforms.u_lightcolor,s.r,s.g,s.b)}(h,e),h.draw(s,l.TRIANGLES,r.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,f)}function Sr(t,r,n){var i=t.context,a=i.gl,o=r.fbo;if(o){var s=t.useProgram("hillshade"),l=t.transform.calculatePosMatrix(r.tileID.toUnwrapped(),!0);!function(e,t,r){var n=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===r.paint.get("hillshade-illumination-anchor")&&(n-=t.transform.angle),t.context.gl.uniform2f(e.uniforms.u_light,r.paint.get("hillshade-exaggeration"),n)}(s,t,n);var u=function(t,r){var n=r.toCoordinate(),i=new e.default$17(n.column,n.row+1,n.zoom);return[t.transform.coordinateLocation(n).lat,t.transform.coordinateLocation(i).lat]}(t,r.tileID);i.activeTexture.set(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,o.colorAttachment.get()),a.uniformMatrix4fv(s.uniforms.u_matrix,!1,l),a.uniform2fv(s.uniforms.u_latrange,u),a.uniform1i(s.uniforms.u_image,0);var c=n.paint.get("hillshade-shadow-color");a.uniform4f(s.uniforms.u_shadow,c.r,c.g,c.b,c.a);var f=n.paint.get("hillshade-highlight-color");a.uniform4f(s.uniforms.u_highlight,f.r,f.g,f.b,f.a);var h=n.paint.get("hillshade-accent-color");if(a.uniform4f(s.uniforms.u_accent,h.r,h.g,h.b,h.a),r.maskedBoundsBuffer&&r.maskedIndexBuffer&&r.segments)s.draw(i,a.TRIANGLES,n.id,r.maskedBoundsBuffer,r.maskedIndexBuffer,r.segments);else{var p=t.rasterBoundsBuffer;t.rasterBoundsVAO.bind(i,s,p,[]),a.drawArrays(a.TRIANGLE_STRIP,0,p.length)}}}function Cr(t,r,n){var i=t.context,a=i.gl;if(r.dem&&r.dem.level){var o=r.dem.level.dim,s=r.dem.getPixels();if(i.activeTexture.set(a.TEXTURE1),i.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||t.getTileTexture(r.tileSize),r.demTexture){var l=r.demTexture;l.update(s,{premultiply:!1}),l.bind(a.NEAREST,a.CLAMP_TO_EDGE)}else r.demTexture=new I(i,s,a.RGBA,{premultiply:!1}),r.demTexture.bind(a.NEAREST,a.CLAMP_TO_EDGE);i.activeTexture.set(a.TEXTURE0);var u=r.fbo;if(!u){var c=new I(i,{width:o,height:o,data:null},a.RGBA);c.bind(a.LINEAR,a.CLAMP_TO_EDGE),(u=r.fbo=i.createFramebuffer(o,o)).colorAttachment.set(c.texture)}i.bindFramebuffer.set(u.framebuffer),i.viewport.set([0,0,o,o]);var f=e.mat4.create();e.mat4.ortho(f,0,e.default$8,-e.default$8,0,0,1),e.mat4.translate(f,f,[0,-e.default$8,0]);var h=t.useProgram("hillshadePrepare");a.uniformMatrix4fv(h.uniforms.u_matrix,!1,f),a.uniform1f(h.uniforms.u_zoom,r.tileID.overscaledZ),a.uniform2fv(h.uniforms.u_dimension,[2*o,2*o]),a.uniform1i(h.uniforms.u_image,1),a.uniform1f(h.uniforms.u_maxzoom,n);var p=t.rasterBoundsBuffer;t.rasterBoundsVAO.bind(i,h,p,[]),a.drawArrays(a.TRIANGLE_STRIP,0,p.length),r.needsHillshadePrepare=!1}}function zr(t,r,n,i,o){var s=i.paint.get("raster-fade-duration");if(s>0){var l=a.now(),u=(l-t.timeAdded)/s,c=r?(l-r.timeAdded)/s:-1,f=n.getSource(),h=o.coveringZoomLevel({tileSize:f.tileSize,roundZoom:f.roundZoom}),p=!r||Math.abs(r.tileID.overscaledZ-h)>Math.abs(t.tileID.overscaledZ-h),d=p&&t.refreshedUponExpiration?1:e.clamp(p?u:1-c,0,1);return t.refreshedUponExpiration&&u>=1&&(t.refreshedUponExpiration=!1),r?{opacity:1,mix:1-d}:{opacity:d,mix:0}}return{opacity:1,mix:0}}function Er(t,r,n){var i=t.context,o=i.gl;i.lineWidth.set(1*a.devicePixelRatio);var s=n.posMatrix,l=t.useProgram("debug");i.setDepthMode(Ze.disabled),i.setStencilMode(He.disabled),i.setColorMode(t.colorModeForRenderPass()),o.uniformMatrix4fv(l.uniforms.u_matrix,!1,s),o.uniform4f(l.uniforms.u_color,1,0,0,1),t.debugVAO.bind(i,l,t.debugBuffer,[]),o.drawArrays(o.LINE_STRIP,0,t.debugBuffer.length);for(var u=function(e,t,r,n){n=n||1;var i,a,o,s,l,u,c,f,h=[];for(i=0,a=e.length;i<a;i++)if(l=Lr[e[i]]){for(f=null,o=0,s=l[1].length;o<s;o+=2)-1===l[1][o]&&-1===l[1][o+1]?f=null:(u=t+l[1][o]*n,c=r-l[1][o+1]*n,f&&h.push(f.x,f.y,u,c),f={x:u,y:c});t+=l[0]*n}return h}(n.toString(),50,200,5),c=new e.PosArray,f=0;f<u.length;f+=2)c.emplaceBack(u[f],u[f+1]);var h=i.createVertexBuffer(c,er.members);(new ee).bind(i,l,h,[]),o.uniform4f(l.uniforms.u_color,1,1,1,1);for(var p=r.getTile(n).tileSize,d=e.default$8/(Math.pow(2,t.transform.zoom-n.overscaledZ)*p),v=[[-1,-1],[-1,1],[1,-1],[1,1]],m=0;m<v.length;m++){var g=v[m];o.uniformMatrix4fv(l.uniforms.u_matrix,!1,e.mat4.translate([],s,[d*g[0],d*g[1],0])),o.drawArrays(o.LINES,0,h.length)}o.uniform4f(l.uniforms.u_color,0,0,0,1),o.uniformMatrix4fv(l.uniforms.u_matrix,!1,s),o.drawArrays(o.LINES,0,h.length)}var Lr={" ":[16,[]],"!":[10,[5,21,5,7,-1,-1,5,2,4,1,5,0,6,1,5,2]],'"':[16,[4,21,4,14,-1,-1,12,21,12,14]],"#":[21,[11,25,4,-7,-1,-1,17,25,10,-7,-1,-1,4,12,18,12,-1,-1,3,6,17,6]],$:[20,[8,25,8,-4,-1,-1,12,25,12,-4,-1,-1,17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],"%":[24,[21,21,3,0,-1,-1,8,21,10,19,10,17,9,15,7,14,5,14,3,16,3,18,4,20,6,21,8,21,10,20,13,19,16,19,19,20,21,21,-1,-1,17,7,15,6,14,4,14,2,16,0,18,0,20,1,21,3,21,5,19,7,17,7]],"&":[26,[23,12,23,13,22,14,21,14,20,13,19,11,17,6,15,3,13,1,11,0,7,0,5,1,4,2,3,4,3,6,4,8,5,9,12,13,13,14,14,16,14,18,13,20,11,21,9,20,8,18,8,16,9,13,11,10,16,3,18,1,20,0,22,0,23,1,23,2]],"'":[10,[5,19,4,20,5,21,6,20,6,18,5,16,4,15]],"(":[14,[11,25,9,23,7,20,5,16,4,11,4,7,5,2,7,-2,9,-5,11,-7]],")":[14,[3,25,5,23,7,20,9,16,10,11,10,7,9,2,7,-2,5,-5,3,-7]],"*":[16,[8,21,8,9,-1,-1,3,18,13,12,-1,-1,13,18,3,12]],"+":[26,[13,18,13,0,-1,-1,4,9,22,9]],",":[10,[6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"-":[26,[4,9,22,9]],".":[10,[5,2,4,1,5,0,6,1,5,2]],"/":[22,[20,25,2,-7]],0:[20,[9,21,6,20,4,17,3,12,3,9,4,4,6,1,9,0,11,0,14,1,16,4,17,9,17,12,16,17,14,20,11,21,9,21]],1:[20,[6,17,8,18,11,21,11,0]],2:[20,[4,16,4,17,5,19,6,20,8,21,12,21,14,20,15,19,16,17,16,15,15,13,13,10,3,0,17,0]],3:[20,[5,21,16,21,10,13,13,13,15,12,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],4:[20,[13,21,3,7,18,7,-1,-1,13,21,13,0]],5:[20,[15,21,5,21,4,12,5,13,8,14,11,14,14,13,16,11,17,8,17,6,16,3,14,1,11,0,8,0,5,1,4,2,3,4]],6:[20,[16,18,15,20,12,21,10,21,7,20,5,17,4,12,4,7,5,3,7,1,10,0,11,0,14,1,16,3,17,6,17,7,16,10,14,12,11,13,10,13,7,12,5,10,4,7]],7:[20,[17,21,7,0,-1,-1,3,21,17,21]],8:[20,[8,21,5,20,4,18,4,16,5,14,7,13,11,12,14,11,16,9,17,7,17,4,16,2,15,1,12,0,8,0,5,1,4,2,3,4,3,7,4,9,6,11,9,12,13,13,15,14,16,16,16,18,15,20,12,21,8,21]],9:[20,[16,14,15,11,13,9,10,8,9,8,6,9,4,11,3,14,3,15,4,18,6,20,9,21,10,21,13,20,15,18,16,14,16,9,15,4,13,1,10,0,8,0,5,1,4,3]],":":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,5,2,4,1,5,0,6,1,5,2]],";":[10,[5,14,4,13,5,12,6,13,5,14,-1,-1,6,1,5,0,4,1,5,2,6,1,6,-1,5,-3,4,-4]],"<":[24,[20,18,4,9,20,0]],"=":[26,[4,12,22,12,-1,-1,4,6,22,6]],">":[24,[4,18,20,9,4,0]],"?":[18,[3,16,3,17,4,19,5,20,7,21,11,21,13,20,14,19,15,17,15,15,14,13,13,12,9,10,9,7,-1,-1,9,2,8,1,9,0,10,1,9,2]],"@":[27,[18,13,17,15,15,16,12,16,10,15,9,14,8,11,8,8,9,6,11,5,14,5,16,6,17,8,-1,-1,12,16,10,14,9,11,9,8,10,6,11,5,-1,-1,18,16,17,8,17,6,19,5,21,5,23,7,24,10,24,12,23,15,22,17,20,19,18,20,15,21,12,21,9,20,7,19,5,17,4,15,3,12,3,9,4,6,5,4,7,2,9,1,12,0,15,0,18,1,20,2,21,3,-1,-1,19,16,18,8,18,6,19,5]],A:[18,[9,21,1,0,-1,-1,9,21,17,0,-1,-1,4,7,14,7]],B:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,-1,-1,4,11,13,11,16,10,17,9,18,7,18,4,17,2,16,1,13,0,4,0]],C:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5]],D:[21,[4,21,4,0,-1,-1,4,21,11,21,14,20,16,18,17,16,18,13,18,8,17,5,16,3,14,1,11,0,4,0]],E:[19,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11,-1,-1,4,0,17,0]],F:[18,[4,21,4,0,-1,-1,4,21,17,21,-1,-1,4,11,12,11]],G:[21,[18,16,17,18,15,20,13,21,9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,18,8,-1,-1,13,8,18,8]],H:[22,[4,21,4,0,-1,-1,18,21,18,0,-1,-1,4,11,18,11]],I:[8,[4,21,4,0]],J:[16,[12,21,12,5,11,2,10,1,8,0,6,0,4,1,3,2,2,5,2,7]],K:[21,[4,21,4,0,-1,-1,18,21,4,7,-1,-1,9,12,18,0]],L:[17,[4,21,4,0,-1,-1,4,0,16,0]],M:[24,[4,21,4,0,-1,-1,4,21,12,0,-1,-1,20,21,12,0,-1,-1,20,21,20,0]],N:[22,[4,21,4,0,-1,-1,4,21,18,0,-1,-1,18,21,18,0]],O:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21]],P:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,14,17,12,16,11,13,10,4,10]],Q:[22,[9,21,7,20,5,18,4,16,3,13,3,8,4,5,5,3,7,1,9,0,13,0,15,1,17,3,18,5,19,8,19,13,18,16,17,18,15,20,13,21,9,21,-1,-1,12,4,18,-2]],R:[21,[4,21,4,0,-1,-1,4,21,13,21,16,20,17,19,18,17,18,15,17,13,16,12,13,11,4,11,-1,-1,11,11,18,0]],S:[20,[17,18,15,20,12,21,8,21,5,20,3,18,3,16,4,14,5,13,7,12,13,10,15,9,16,8,17,6,17,3,15,1,12,0,8,0,5,1,3,3]],T:[16,[8,21,8,0,-1,-1,1,21,15,21]],U:[22,[4,21,4,6,5,3,7,1,10,0,12,0,15,1,17,3,18,6,18,21]],V:[18,[1,21,9,0,-1,-1,17,21,9,0]],W:[24,[2,21,7,0,-1,-1,12,21,7,0,-1,-1,12,21,17,0,-1,-1,22,21,17,0]],X:[20,[3,21,17,0,-1,-1,17,21,3,0]],Y:[18,[1,21,9,11,9,0,-1,-1,17,21,9,11]],Z:[20,[17,21,3,0,-1,-1,3,21,17,21,-1,-1,3,0,17,0]],"[":[14,[4,25,4,-7,-1,-1,5,25,5,-7,-1,-1,4,25,11,25,-1,-1,4,-7,11,-7]],"\\":[14,[0,21,14,-3]],"]":[14,[9,25,9,-7,-1,-1,10,25,10,-7,-1,-1,3,25,10,25,-1,-1,3,-7,10,-7]],"^":[16,[6,15,8,18,10,15,-1,-1,3,12,8,17,13,12,-1,-1,8,17,8,0]],_:[16,[0,-2,16,-2]],"`":[10,[6,21,5,20,4,18,4,16,5,15,6,16,5,17]],a:[19,[15,14,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],b:[19,[4,21,4,0,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],c:[18,[15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],d:[19,[15,21,15,0,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],e:[18,[3,8,15,8,15,10,14,12,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],f:[12,[10,21,8,21,6,20,5,17,5,0,-1,-1,2,14,9,14]],g:[19,[15,14,15,-2,14,-5,13,-6,11,-7,8,-7,6,-6,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],h:[19,[4,21,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],i:[8,[3,21,4,20,5,21,4,22,3,21,-1,-1,4,14,4,0]],j:[10,[5,21,6,20,7,21,6,22,5,21,-1,-1,6,14,6,-3,5,-6,3,-7,1,-7]],k:[17,[4,21,4,0,-1,-1,14,14,4,4,-1,-1,8,8,15,0]],l:[8,[4,21,4,0]],m:[30,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0,-1,-1,15,10,18,13,20,14,23,14,25,13,26,10,26,0]],n:[19,[4,14,4,0,-1,-1,4,10,7,13,9,14,12,14,14,13,15,10,15,0]],o:[19,[8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3,16,6,16,8,15,11,13,13,11,14,8,14]],p:[19,[4,14,4,-7,-1,-1,4,11,6,13,8,14,11,14,13,13,15,11,16,8,16,6,15,3,13,1,11,0,8,0,6,1,4,3]],q:[19,[15,14,15,-7,-1,-1,15,11,13,13,11,14,8,14,6,13,4,11,3,8,3,6,4,3,6,1,8,0,11,0,13,1,15,3]],r:[13,[4,14,4,0,-1,-1,4,8,5,11,7,13,9,14,12,14]],s:[17,[14,11,13,13,10,14,7,14,4,13,3,11,4,9,6,8,11,7,13,6,14,4,14,3,13,1,10,0,7,0,4,1,3,3]],t:[12,[5,21,5,4,6,1,8,0,10,0,-1,-1,2,14,9,14]],u:[19,[4,14,4,4,5,1,7,0,10,0,12,1,15,4,-1,-1,15,14,15,0]],v:[16,[2,14,8,0,-1,-1,14,14,8,0]],w:[22,[3,14,7,0,-1,-1,11,14,7,0,-1,-1,11,14,15,0,-1,-1,19,14,15,0]],x:[17,[3,14,14,0,-1,-1,14,14,3,0]],y:[16,[2,14,8,0,-1,-1,14,14,8,0,6,-4,4,-6,2,-7,1,-7]],z:[17,[14,14,3,0,-1,-1,3,14,14,14,-1,-1,3,0,14,0]],"{":[14,[9,25,7,24,6,23,5,21,5,19,6,17,7,16,8,14,8,12,6,10,-1,-1,7,24,6,22,6,20,7,18,8,17,9,15,9,13,8,11,4,9,8,7,9,5,9,3,8,1,7,0,6,-2,6,-4,7,-6,-1,-1,6,8,8,6,8,4,7,2,6,1,5,-1,5,-3,6,-5,7,-6,9,-7]],"|":[8,[4,25,4,-7]],"}":[14,[5,25,7,24,8,23,9,21,9,19,8,17,7,16,6,14,6,12,8,10,-1,-1,7,24,8,22,8,20,7,18,6,17,5,15,5,13,6,11,10,9,6,7,5,5,5,3,6,1,7,0,8,-2,8,-4,7,-6,-1,-1,8,8,6,6,6,4,7,2,8,1,9,-1,9,-3,8,-5,7,-6,5,-7]],"~":[24,[3,6,3,8,4,11,6,12,8,12,10,11,14,8,16,7,18,7,20,8,21,10,-1,-1,3,8,4,10,6,11,8,11,10,10,14,7,16,6,18,6,20,7,21,10,21,12]]};var Ir={symbol:function(e,t,r,n){if("translucent"===e.renderPass){var i=e.context;i.setStencilMode(He.disabled),i.setColorMode(e.colorModeForRenderPass()),0!==r.paint.get("icon-opacity").constantOr(1)&&fr(e,t,r,n,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright")),0!==r.paint.get("text-opacity").constantOr(1)&&fr(e,t,r,n,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright")),t.map.showCollisionBoxes&&function(e,t,r,n){lr(e,t,r,n,!1),lr(e,t,r,n,!0)}(e,t,r,n)}},circle:function(e,t,r,n){if("translucent"===e.renderPass){var i=r.paint.get("circle-opacity"),a=r.paint.get("circle-stroke-width"),o=r.paint.get("circle-stroke-opacity");if(0!==i.constantOr(1)||0!==a.constantOr(1)&&0!==o.constantOr(1)){var s=e.context,l=s.gl;s.setDepthMode(e.depthModeForSublayer(0,Ze.ReadOnly)),s.setStencilMode(He.disabled),s.setColorMode(e.colorModeForRenderPass());for(var u=!0,c=0;c<n.length;c++){var f=n[c],h=t.getTile(f),p=h.getBucket(r);if(p){var d=e.context.program.get(),v=p.programConfigurations.get(r.id),m=e.useProgram("circle",v);if((u||m.program!==d)&&(v.setUniforms(s,m,r.paint,{zoom:e.transform.zoom}),u=!1),l.uniform1f(m.uniforms.u_camera_to_center_distance,e.transform.cameraToCenterDistance),l.uniform1i(m.uniforms.u_scale_with_map,"map"===r.paint.get("circle-pitch-scale")?1:0),"map"===r.paint.get("circle-pitch-alignment")){l.uniform1i(m.uniforms.u_pitch_with_map,1);var g=Ct(h,1,e.transform.zoom);l.uniform2f(m.uniforms.u_extrude_scale,g,g)}else l.uniform1i(m.uniforms.u_pitch_with_map,0),l.uniform2fv(m.uniforms.u_extrude_scale,e.transform.pixelsToGLUnits);l.uniformMatrix4fv(m.uniforms.u_matrix,!1,e.translatePosMatrix(f.posMatrix,h,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor"))),m.draw(s,l.TRIANGLES,r.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,v)}}}}},heatmap:function(t,r,n,i){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){var a=t.context,o=a.gl;a.setDepthMode(t.depthModeForSublayer(0,Ze.ReadOnly)),a.setStencilMode(He.disabled),function(e,t,r){var n=e.gl;e.activeTexture.set(n.TEXTURE1),e.viewport.set([0,0,t.width/4,t.height/4]);var i=r.heatmapFbo;if(i)n.bindTexture(n.TEXTURE_2D,i.colorAttachment.get()),e.bindFramebuffer.set(i.framebuffer);else{var a=n.createTexture();n.bindTexture(n.TEXTURE_2D,a),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),i=r.heatmapFbo=e.createFramebuffer(t.width/4,t.height/4),function e(t,r,n,i){var a=t.gl;a.texImage2D(a.TEXTURE_2D,0,a.RGBA,r.width/4,r.height/4,0,a.RGBA,t.extTextureHalfFloat?t.extTextureHalfFloat.HALF_FLOAT_OES:a.UNSIGNED_BYTE,null),i.colorAttachment.set(n),t.extTextureHalfFloat&&a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE&&(t.extTextureHalfFloat=null,i.colorAttachment.setDirty(),e(t,r,n,i))}(e,t,a,i)}}(a,t,n),a.clear({color:e.default$6.transparent}),a.setColorMode(new Ge([o.ONE,o.ONE],e.default$6.transparent,[!0,!0,!0,!0]));for(var s=!0,l=0;l<i.length;l++){var u=i[l];if(!r.hasRenderableParent(u)){var c=r.getTile(u),f=c.getBucket(n);if(f){var h=t.context.program.get(),p=f.programConfigurations.get(n.id),d=t.useProgram("heatmap",p),v=t.transform.zoom;(s||d.program!==h)&&(p.setUniforms(t.context,d,n.paint,{zoom:v}),s=!1),o.uniform1f(d.uniforms.u_extrude_scale,Ct(c,1,v)),o.uniform1f(d.uniforms.u_intensity,n.paint.get("heatmap-intensity")),o.uniformMatrix4fv(d.uniforms.u_matrix,!1,u.posMatrix),d.draw(a,o.TRIANGLES,n.id,f.layoutVertexBuffer,f.indexBuffer,f.segments,p)}}}a.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,r){var n=t.context,i=n.gl,a=r.heatmapFbo;if(a){n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,a.colorAttachment.get()),n.activeTexture.set(i.TEXTURE1);var o=r.colorRampTexture;o||(o=r.colorRampTexture=new I(n,r.colorRamp,i.RGBA)),o.bind(i.LINEAR,i.CLAMP_TO_EDGE),n.setDepthMode(Ze.disabled);var s=t.useProgram("heatmapTexture"),l=r.paint.get("heatmap-opacity");i.uniform1f(s.uniforms.u_opacity,l),i.uniform1i(s.uniforms.u_image,0),i.uniform1i(s.uniforms.u_color_ramp,1);var u=e.mat4.create();e.mat4.ortho(u,0,t.width,t.height,0,0,1),i.uniformMatrix4fv(s.uniforms.u_matrix,!1,u),i.uniform2f(s.uniforms.u_world,i.drawingBufferWidth,i.drawingBufferHeight),t.viewportVAO.bind(t.context,s,t.viewportBuffer,[]),i.drawArrays(i.TRIANGLE_STRIP,0,4)}}(t,n))},line:function(e,t,r,n){if("translucent"===e.renderPass&&0!==r.paint.get("line-opacity").constantOr(1)){var i=e.context;i.setDepthMode(e.depthModeForSublayer(0,Ze.ReadOnly)),i.setColorMode(e.colorModeForRenderPass());for(var a,o=r.paint.get("line-dasharray")?"lineSDF":r.paint.get("line-pattern")?"linePattern":r.paint.get("line-gradient")?"lineGradient":"line",s=!0,l=0,u=n;l<u.length;l+=1){var c=u[l],f=t.getTile(c),h=f.getBucket(r);if(h){var p=h.programConfigurations.get(r.id),d=e.context.program.get(),v=e.useProgram(o,p),m=s||v.program!==d,g=a!==f.tileID.overscaledZ;m&&p.setUniforms(e.context,v,r.paint,{zoom:e.transform.zoom}),vr(v,e,f,h,r,c,p,m,g),a=f.tileID.overscaledZ,s=!1}}}},fill:function(t,r,n,i){var a=n.paint.get("fill-color"),o=n.paint.get("fill-opacity");if(0!==o.constantOr(1)){var s=t.context;s.setColorMode(t.colorModeForRenderPass());var l=n.paint.get("fill-pattern")||1!==a.constantOr(e.default$6.transparent).a||1!==o.constantOr(0)?"translucent":"opaque";t.renderPass===l&&(s.setDepthMode(t.depthModeForSublayer(1,"opaque"===t.renderPass?Ze.ReadWrite:Ze.ReadOnly)),_r(t,r,n,i,xr)),"translucent"===t.renderPass&&n.paint.get("fill-antialias")&&(s.lineWidth.set(2),s.setDepthMode(t.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,Ze.ReadOnly)),_r(t,r,n,i,br))}},"fill-extrusion":function(t,r,n,i){if(0!==n.paint.get("fill-extrusion-opacity"))if("offscreen"===t.renderPass){!function(t,r){var n=t.context,i=n.gl,a=r.viewportFrame;if(t.depthRboNeedsClear&&t.setupOffscreenDepthRenderbuffer(),!a){var o=new I(n,{width:t.width,height:t.height,data:null},i.RGBA);o.bind(i.LINEAR,i.CLAMP_TO_EDGE),(a=r.viewportFrame=n.createFramebuffer(t.width,t.height)).colorAttachment.set(o.texture)}n.bindFramebuffer.set(a.framebuffer),a.depthAttachment.set(t.depthRbo),t.depthRboNeedsClear&&(n.clear({depth:1}),t.depthRboNeedsClear=!1),n.clear({color:e.default$6.transparent}),n.setStencilMode(He.disabled),n.setDepthMode(new Ze(i.LEQUAL,Ze.ReadWrite,[0,1])),n.setColorMode(t.colorModeForRenderPass())}(t,n);for(var a=!0,o=0,s=i;o<s.length;o+=1){var l=s[o],u=r.getTile(l),c=u.getBucket(n);c&&(Mr(t,0,n,u,l,c,a),a=!1)}}else"translucent"===t.renderPass&&function(e,t){var r=t.viewportFrame;if(r){var n=e.context,i=n.gl,a=e.useProgram("extrusionTexture");n.setStencilMode(He.disabled),n.setDepthMode(Ze.disabled),n.setColorMode(e.colorModeForRenderPass()),n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,r.colorAttachment.get()),i.uniform1f(a.uniforms.u_opacity,t.paint.get("fill-extrusion-opacity")),i.uniform1i(a.uniforms.u_image,0);var o=Ar.create();Ar.ortho(o,0,e.width,e.height,0,0,1),i.uniformMatrix4fv(a.uniforms.u_matrix,!1,o),i.uniform2f(a.uniforms.u_world,i.drawingBufferWidth,i.drawingBufferHeight),e.viewportVAO.bind(n,a,e.viewportBuffer,[]),i.drawArrays(i.TRIANGLE_STRIP,0,4)}}(t,n)},hillshade:function(e,t,r,n){if("offscreen"===e.renderPass||"translucent"===e.renderPass){var i=e.context,a=t.getSource().maxzoom;i.setDepthMode(e.depthModeForSublayer(0,Ze.ReadOnly)),i.setStencilMode(He.disabled),i.setColorMode(e.colorModeForRenderPass());for(var o=0,s=n;o<s.length;o+=1){var l=s[o],u=t.getTile(l);u.needsHillshadePrepare&&"offscreen"===e.renderPass?Cr(e,u,a):"translucent"===e.renderPass&&Sr(e,u,r)}i.viewport.set([0,0,e.width,e.height])}},raster:function(e,t,r,n){if("translucent"===e.renderPass&&0!==r.paint.get("raster-opacity")){var i,a,o=e.context,s=o.gl,l=t.getSource(),u=e.useProgram("raster");o.setStencilMode(He.disabled),o.setColorMode(e.colorModeForRenderPass()),s.uniform1f(u.uniforms.u_brightness_low,r.paint.get("raster-brightness-min")),s.uniform1f(u.uniforms.u_brightness_high,r.paint.get("raster-brightness-max")),s.uniform1f(u.uniforms.u_saturation_factor,(i=r.paint.get("raster-saturation"))>0?1-1/(1.001-i):-i),s.uniform1f(u.uniforms.u_contrast_factor,(a=r.paint.get("raster-contrast"))>0?1/(1-a):1+a),s.uniform3fv(u.uniforms.u_spin_weights,function(e){e*=Math.PI/180;var t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}(r.paint.get("raster-hue-rotate"))),s.uniform1f(u.uniforms.u_buffer_scale,1),s.uniform1i(u.uniforms.u_image0,0),s.uniform1i(u.uniforms.u_image1,1);for(var c=n.length&&n[0].overscaledZ,f=0,h=n;f<h.length;f+=1){var p=h[f];o.setDepthMode(e.depthModeForSublayer(p.overscaledZ-c,1===r.paint.get("raster-opacity")?Ze.ReadWrite:Ze.ReadOnly,s.LESS));var d=t.getTile(p),v=e.transform.calculatePosMatrix(p.toUnwrapped(),!0);d.registerFadeDuration(r.paint.get("raster-fade-duration")),s.uniformMatrix4fv(u.uniforms.u_matrix,!1,v);var m=t.findLoadedParent(p,0,{}),g=zr(d,m,t,r,e.transform),y=void 0,_=void 0;if(o.activeTexture.set(s.TEXTURE0),d.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),o.activeTexture.set(s.TEXTURE1),m?(m.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),y=Math.pow(2,m.tileID.overscaledZ-d.tileID.overscaledZ),_=[d.tileID.canonical.x*y%1,d.tileID.canonical.y*y%1]):d.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST),s.uniform2fv(u.uniforms.u_tl_parent,_||[0,0]),s.uniform1f(u.uniforms.u_scale_parent,y||1),s.uniform1f(u.uniforms.u_fade_t,g.mix),s.uniform1f(u.uniforms.u_opacity,g.opacity*r.paint.get("raster-opacity")),l instanceof te){var x=l.boundsBuffer;l.boundsVAO.bind(o,u,x,[]),s.drawArrays(s.TRIANGLE_STRIP,0,x.length)}else if(d.maskedBoundsBuffer&&d.maskedIndexBuffer&&d.segments)u.draw(o,s.TRIANGLES,r.id,d.maskedBoundsBuffer,d.maskedIndexBuffer,d.segments);else{var b=e.rasterBoundsBuffer;e.rasterBoundsVAO.bind(o,u,b,[]),s.drawArrays(s.TRIANGLE_STRIP,0,b.length)}}}},background:function(e,t,r){var n=r.paint.get("background-color"),i=r.paint.get("background-opacity");if(0!==i){var a=e.context,o=a.gl,s=e.transform,l=s.tileSize,u=r.paint.get("background-pattern"),c=u||1!==n.a||1!==i?"translucent":"opaque";if(e.renderPass===c){var f;if(a.setStencilMode(He.disabled),a.setDepthMode(e.depthModeForSublayer(0,"opaque"===c?Ze.ReadWrite:Ze.ReadOnly)),a.setColorMode(e.colorModeForRenderPass()),u){if(mr(u,e))return;f=e.useProgram("backgroundPattern"),gr(u,e,f),e.tileExtentPatternVAO.bind(a,f,e.tileExtentBuffer,[])}else f=e.useProgram("background"),o.uniform4fv(f.uniforms.u_color,[n.r,n.g,n.b,n.a]),e.tileExtentVAO.bind(a,f,e.tileExtentBuffer,[]);o.uniform1f(f.uniforms.u_opacity,i);for(var h=0,p=s.coveringTiles({tileSize:l});h<p.length;h+=1){var d=p[h];u&&yr({tileID:d,tileSize:l},e,f),o.uniformMatrix4fv(f.uniforms.u_matrix,!1,e.transform.calculatePosMatrix(d.toUnwrapped())),o.drawArrays(o.TRIANGLE_STRIP,0,e.tileExtentBuffer.length)}}}},debug:function(e,t,r){for(var n=0;n<r.length;n++)Er(e,t,r[n])}},Pr=function(t,r){this.context=new $e(t),this.transform=r,this._tileTextures={},this.setup(),this.numSublayers=We.maxUnderzooming+We.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.depthRboNeedsClear=!0,this.emptyProgramConfiguration=new e.default$24,this.crossTileSymbolIndex=new Xt};function Dr(e,t){if(e.row>t.row){var r=e;e=t,t=r}return{x0:e.column,y0:e.row,x1:t.column,y1:t.row,dx:t.column-e.column,dy:t.row-e.row}}function Or(e,t,r,n,i){var a=Math.max(r,Math.floor(t.y0)),o=Math.min(n,Math.ceil(t.y1));if(e.x0===t.x0&&e.y0===t.y0?e.x0+t.dy/e.dy*e.dx<t.x1:e.x1-t.dy/e.dy*e.dx<t.x0){var s=e;e=t,t=s}for(var l=e.dx/e.dy,u=t.dx/t.dy,c=e.dx>0,f=t.dx<0,h=a;h<o;h++){var p=l*Math.max(0,Math.min(e.dy,h+c-e.y0))+e.x0,d=u*Math.max(0,Math.min(t.dy,h+f-t.y0))+t.x0;i(Math.floor(d),Math.ceil(p),h)}}function Rr(e,t,r,n,i,a){var o,s=Dr(e,t),l=Dr(t,r),u=Dr(r,e);s.dy>l.dy&&(o=s,s=l,l=o),s.dy>u.dy&&(o=s,s=u,u=o),l.dy>u.dy&&(o=l,l=u,u=o),s.dy&&Or(u,s,n,i,a),l.dy&&Or(u,l,n,i,a)}Pr.prototype.resize=function(e,t){var r=this.context.gl;if(this.width=e*a.devicePixelRatio,this.height=t*a.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var n=0,i=this.style._order;n<i.length;n+=1){var o=i[n];this.style._layers[o].resize()}this.depthRbo&&(r.deleteRenderbuffer(this.depthRbo),this.depthRbo=null)},Pr.prototype.setup=function(){var t=this.context,r=new e.PosArray;r.emplaceBack(0,0),r.emplaceBack(e.default$8,0),r.emplaceBack(0,e.default$8),r.emplaceBack(e.default$8,e.default$8),this.tileExtentBuffer=t.createVertexBuffer(r,er.members),this.tileExtentVAO=new ee,this.tileExtentPatternVAO=new ee;var n=new e.PosArray;n.emplaceBack(0,0),n.emplaceBack(e.default$8,0),n.emplaceBack(e.default$8,e.default$8),n.emplaceBack(0,e.default$8),n.emplaceBack(0,0),this.debugBuffer=t.createVertexBuffer(n,er.members),this.debugVAO=new ee;var i=new e.RasterBoundsArray;i.emplaceBack(0,0,0,0),i.emplaceBack(e.default$8,0,e.default$8,0),i.emplaceBack(0,e.default$8,0,e.default$8),i.emplaceBack(e.default$8,e.default$8,e.default$8,e.default$8),this.rasterBoundsBuffer=t.createVertexBuffer(i,Q.members),this.rasterBoundsVAO=new ee;var a=new e.PosArray;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(a,er.members),this.viewportVAO=new ee},Pr.prototype.clearStencil=function(){var t=this.context,r=t.gl;t.setColorMode(Ge.disabled),t.setDepthMode(Ze.disabled),t.setStencilMode(new He({func:r.ALWAYS,mask:0},0,255,r.ZERO,r.ZERO,r.ZERO));var n=e.mat4.create();e.mat4.ortho(n,0,this.width,this.height,0,0,1),e.mat4.scale(n,n,[r.drawingBufferWidth,r.drawingBufferHeight,0]);var i=this.useProgram("clippingMask");r.uniformMatrix4fv(i.uniforms.u_matrix,!1,n),this.viewportVAO.bind(t,i,this.viewportBuffer,[]),r.drawArrays(r.TRIANGLE_STRIP,0,4)},Pr.prototype._renderTileClippingMasks=function(e){var t=this.context,r=t.gl;t.setColorMode(Ge.disabled),t.setDepthMode(Ze.disabled);var n=1;this._tileClippingMaskIDs={};for(var i=0,a=e;i<a.length;i+=1){var o=a[i],s=this._tileClippingMaskIDs[o.key]=n++;t.setStencilMode(new He({func:r.ALWAYS,mask:0},s,255,r.KEEP,r.KEEP,r.REPLACE));var l=this.useProgram("clippingMask");r.uniformMatrix4fv(l.uniforms.u_matrix,!1,o.posMatrix),this.tileExtentVAO.bind(this.context,l,this.tileExtentBuffer,[]),r.drawArrays(r.TRIANGLE_STRIP,0,this.tileExtentBuffer.length)}},Pr.prototype.stencilModeForClipping=function(e){var t=this.context.gl;return new He({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)},Pr.prototype.colorModeForRenderPass=function(){var t=this.context.gl;if(this._showOverdrawInspector){return new Ge([t.CONSTANT_COLOR,t.ONE],new e.default$6(1/8,1/8,1/8,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Ge.unblended:Ge.alphaBlended},Pr.prototype.depthModeForSublayer=function(e,t,r){var n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon,i=n-1+this.depthRange;return new Ze(r||this.context.gl.LEQUAL,t,[i,n])},Pr.prototype.render=function(t,r){var n=this;for(var i in this.style=t,this.options=r,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(a.now()),t.sourceCaches){var o=n.style.sourceCaches[i];o.used&&o.prepare(n.context)}var s=this.style._order,l=e.filterObject(this.style.sourceCaches,function(e){return"raster"===e.getSource().type||"raster-dem"===e.getSource().type}),u=function(t){var r=l[t];!function(t,r){for(var n=t.sort(function(e,t){return e.tileID.isLessThan(t.tileID)?-1:t.tileID.isLessThan(e.tileID)?1:0}),i=0;i<n.length;i++){var a={},o=n[i],s=n.slice(i+1);sr(o.tileID.wrapped(),o.tileID,s,new e.OverscaledTileID(0,o.tileID.wrap+1,0,0,0),a),o.setMask(a,r)}}(r.getVisibleCoordinates().map(function(e){return r.getTile(e)}),n.context)};for(var c in l)u(c);this.renderPass="offscreen";var f,h=[];this.depthRboNeedsClear=!0;for(var p=0;p<s.length;p++){var d=n.style._layers[s[p]];d.hasOffscreenPass()&&!d.isHidden(n.transform.zoom)&&(d.source!==(f&&f.id)&&(h=[],(f=n.style.sourceCaches[d.source])&&(h=f.getVisibleCoordinates()).reverse()),h.length&&n.renderLayer(n,f,d,h))}this.context.bindFramebuffer.set(null),this.context.clear({color:r.showOverdrawInspector?e.default$6.black:e.default$6.transparent,depth:1}),this._showOverdrawInspector=r.showOverdrawInspector,this.depthRange=(t._order.length+2)*this.numSublayers*this.depthEpsilon,this.renderPass="opaque";var v,m=[];for(this.currentLayer=s.length-1,this.currentLayer;this.currentLayer>=0;this.currentLayer--){var g=n.style._layers[s[n.currentLayer]];g.source!==(v&&v.id)&&(m=[],(v=n.style.sourceCaches[g.source])&&(n.clearStencil(),m=v.getVisibleCoordinates(),v.getSource().isTileClipped&&n._renderTileClippingMasks(m))),n.renderLayer(n,v,g,m)}this.renderPass="translucent";var y,_=[];for(this.currentLayer=0,this.currentLayer;this.currentLayer<s.length;this.currentLayer++){var x=n.style._layers[s[n.currentLayer]];x.source!==(y&&y.id)&&(_=[],(y=n.style.sourceCaches[x.source])&&(n.clearStencil(),_=y.getVisibleCoordinates(),y.getSource().isTileClipped&&n._renderTileClippingMasks(_)),_.reverse()),n.renderLayer(n,y,x,_)}if(this.options.showTileBoundaries){var b=this.style.sourceCaches[Object.keys(this.style.sourceCaches)[0]];b&&Ir.debug(this,b,b.getVisibleCoordinates())}},Pr.prototype.setupOffscreenDepthRenderbuffer=function(){var e=this.context;this.depthRbo||(this.depthRbo=e.createRenderbuffer(e.gl.DEPTH_COMPONENT16,this.width,this.height))},Pr.prototype.renderLayer=function(e,t,r,n){r.isHidden(this.transform.zoom)||("background"===r.type||n.length)&&(this.id=r.id,Ir[r.type](e,t,r,n))},Pr.prototype.translatePosMatrix=function(t,r,n,i,a){if(!n[0]&&!n[1])return t;var o=a?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(o){var s=Math.sin(o),l=Math.cos(o);n=[n[0]*l-n[1]*s,n[0]*s+n[1]*l]}var u=[a?n[0]:Ct(r,n[0],this.transform.zoom),a?n[1]:Ct(r,n[1],this.transform.zoom),0],c=new Float32Array(16);return e.mat4.translate(c,t,u),c},Pr.prototype.saveTileTexture=function(e){var t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]},Pr.prototype.getTileTexture=function(e){var t=this._tileTextures[e];return t&&t.length>0?t.pop():null},Pr.prototype._createProgramCached=function(e,t){this.cache=this.cache||{};var r=""+e+(t.cacheKey||"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[r]||(this.cache[r]=new or(this.context,ar[e],t,this._showOverdrawInspector)),this.cache[r]},Pr.prototype.useProgram=function(e,t){var r=this._createProgramCached(e,t||this.emptyProgramConfiguration);return this.context.program.set(r.program),r};var Fr=e.default$20.vec4,Br=e.default$20.mat4,Nr=e.default$20.mat2,jr=function(e,t,r){this.tileSize=512,this._renderWorldCopies=void 0===r||r,this._minZoom=e||0,this._maxZoom=t||22,this.latRange=[-85.05113,85.05113],this.width=0,this.height=0,this._center=new G(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._posMatrixCache={},this._alignedPosMatrixCache={}},Vr={minZoom:{configurable:!0},maxZoom:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerPoint:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},unmodified:{configurable:!0},x:{configurable:!0},y:{configurable:!0},point:{configurable:!0}};jr.prototype.clone=function(){var e=new jr(this._minZoom,this._maxZoom,this._renderWorldCopies);return e.tileSize=this.tileSize,e.latRange=this.latRange,e.width=this.width,e.height=this.height,e._center=this._center,e.zoom=this.zoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._unmodified=this._unmodified,e._calcMatrices(),e},Vr.minZoom.get=function(){return this._minZoom},Vr.minZoom.set=function(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))},Vr.maxZoom.get=function(){return this._maxZoom},Vr.maxZoom.set=function(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))},Vr.renderWorldCopies.get=function(){return this._renderWorldCopies},Vr.renderWorldCopies.set=function(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e},Vr.worldSize.get=function(){return this.tileSize*this.scale},Vr.centerPoint.get=function(){return this.size._div(2)},Vr.size.get=function(){return new e.default$1(this.width,this.height)},Vr.bearing.get=function(){return-this.angle/Math.PI*180},Vr.bearing.set=function(t){var r=-e.wrap(t,-180,180)*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=Nr.create(),Nr.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Vr.pitch.get=function(){return this._pitch/Math.PI*180},Vr.pitch.set=function(t){var r=e.clamp(t,0,60)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())},Vr.fov.get=function(){return this._fov/Math.PI*180},Vr.fov.set=function(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())},Vr.zoom.get=function(){return this._zoom},Vr.zoom.set=function(e){var t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom,this._constrain(),this._calcMatrices())},Vr.center.get=function(){return this._center},Vr.center.set=function(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())},jr.prototype.coveringZoomLevel=function(e){return(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize))},jr.prototype.getVisibleUnwrappedCoordinates=function(t){var r=this.pointCoordinate(new e.default$1(0,0),0),n=this.pointCoordinate(new e.default$1(this.width,0),0),i=Math.floor(r.column),a=Math.floor(n.column),o=[new e.UnwrappedTileID(0,t)];if(this._renderWorldCopies)for(var s=i;s<=a;s++)0!==s&&o.push(new e.UnwrappedTileID(s,t));return o},jr.prototype.coveringTiles=function(t){var r=this.coveringZoomLevel(t),n=r;if(void 0!==t.minzoom&&r<t.minzoom)return[];void 0!==t.maxzoom&&r>t.maxzoom&&(r=t.maxzoom);var i=this.pointCoordinate(this.centerPoint,r),a=new e.default$1(i.column-.5,i.row-.5);return function(t,r,n,i){void 0===i&&(i=!0);var a=1<<t,o={};function s(r,s,l){var u,c,f,h;if(l>=0&&l<=a)for(u=r;u<s;u++)c=Math.floor(u/a),f=(u%a+a)%a,0!==c&&!0!==i||(h=new e.OverscaledTileID(n,c,t,f,l),o[h.key]=h)}return Rr(r[0],r[1],r[2],0,a,s),Rr(r[2],r[3],r[0],0,a,s),Object.keys(o).map(function(e){return o[e]})}(r,[this.pointCoordinate(new e.default$1(0,0),r),this.pointCoordinate(new e.default$1(this.width,0),r),this.pointCoordinate(new e.default$1(this.width,this.height),r),this.pointCoordinate(new e.default$1(0,this.height),r)],t.reparseOverscaled?n:r,this._renderWorldCopies).sort(function(e,t){return a.dist(e.canonical)-a.dist(t.canonical)})},jr.prototype.resize=function(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()},Vr.unmodified.get=function(){return this._unmodified},jr.prototype.zoomScale=function(e){return Math.pow(2,e)},jr.prototype.scaleZoom=function(e){return Math.log(e)/Math.LN2},jr.prototype.project=function(t){return new e.default$1(this.lngX(t.lng),this.latY(t.lat))},jr.prototype.unproject=function(e){return new G(this.xLng(e.x),this.yLat(e.y))},Vr.x.get=function(){return this.lngX(this.center.lng)},Vr.y.get=function(){return this.latY(this.center.lat)},Vr.point.get=function(){return new e.default$1(this.x,this.y)},jr.prototype.lngX=function(e){return(180+e)*this.worldSize/360},jr.prototype.latY=function(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))*this.worldSize/360},jr.prototype.xLng=function(e){return 360*e/this.worldSize-180},jr.prototype.yLat=function(e){var t=180-360*e/this.worldSize;return 360/Math.PI*Math.atan(Math.exp(t*Math.PI/180))-90},jr.prototype.setLocationAtPoint=function(e,t){var r=this.pointCoordinate(t)._sub(this.pointCoordinate(this.centerPoint));this.center=this.coordinateLocation(this.locationCoordinate(e)._sub(r)),this._renderWorldCopies&&(this.center=this.center.wrap())},jr.prototype.locationPoint=function(e){return this.coordinatePoint(this.locationCoordinate(e))},jr.prototype.pointLocation=function(e){return this.coordinateLocation(this.pointCoordinate(e))},jr.prototype.locationCoordinate=function(t){return new e.default$17(this.lngX(t.lng)/this.tileSize,this.latY(t.lat)/this.tileSize,this.zoom).zoomTo(this.tileZoom)},jr.prototype.coordinateLocation=function(e){var t=e.zoomTo(this.zoom);return new G(this.xLng(t.column*this.tileSize),this.yLat(t.row*this.tileSize))},jr.prototype.pointCoordinate=function(t,r){void 0===r&&(r=this.tileZoom);var n=[t.x,t.y,0,1],i=[t.x,t.y,1,1];Fr.transformMat4(n,n,this.pixelMatrixInverse),Fr.transformMat4(i,i,this.pixelMatrixInverse);var a=n[3],o=i[3],s=n[0]/a,l=i[0]/o,u=n[1]/a,c=i[1]/o,f=n[2]/a,h=i[2]/o,p=f===h?0:(0-f)/(h-f);return new e.default$17(e.number(s,l,p)/this.tileSize,e.number(u,c,p)/this.tileSize,this.zoom)._zoomTo(r)},jr.prototype.coordinatePoint=function(t){var r=t.zoomTo(this.zoom),n=[r.column*this.tileSize,r.row*this.tileSize,0,1];return Fr.transformMat4(n,n,this.pixelMatrix),new e.default$1(n[0]/n[3],n[1]/n[3])},jr.prototype.calculatePosMatrix=function(t,r){void 0===r&&(r=!1);var n=t.key,i=r?this._alignedPosMatrixCache:this._posMatrixCache;if(i[n])return i[n];var a=t.canonical,o=this.worldSize/this.zoomScale(a.z),s=a.x+Math.pow(2,a.z)*t.wrap,l=Br.identity(new Float64Array(16));return Br.translate(l,l,[s*o,a.y*o,0]),Br.scale(l,l,[o/e.default$8,o/e.default$8,1]),Br.multiply(l,r?this.alignedProjMatrix:this.projMatrix,l),i[n]=new Float32Array(l),i[n]},jr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var t,r,n,i,a=-90,o=90,s=-180,l=180,u=this.size,c=this._unmodified;if(this.latRange){var f=this.latRange;a=this.latY(f[1]),t=(o=this.latY(f[0]))-a<u.y?u.y/(o-a):0}if(this.lngRange){var h=this.lngRange;s=this.lngX(h[0]),r=(l=this.lngX(h[1]))-s<u.x?u.x/(l-s):0}var p=Math.max(r||0,t||0);if(p)return this.center=this.unproject(new e.default$1(r?(l+s)/2:this.x,t?(o+a)/2:this.y)),this.zoom+=this.scaleZoom(p),this._unmodified=c,void(this._constraining=!1);if(this.latRange){var d=this.y,v=u.y/2;d-v<a&&(i=a+v),d+v>o&&(i=o-v)}if(this.lngRange){var m=this.x,g=u.x/2;m-g<s&&(n=s+g),m+g>l&&(n=l-g)}void 0===n&&void 0===i||(this.center=this.unproject(new e.default$1(void 0!==n?n:this.x,void 0!==i?i:this.y))),this._unmodified=c,this._constraining=!1}},jr.prototype._calcMatrices=function(){if(this.height){this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var e=this._fov/2,t=Math.PI/2+this._pitch,r=Math.sin(e)*this.cameraToCenterDistance/Math.sin(Math.PI-t-e),n=this.x,i=this.y,a=1.01*(Math.cos(Math.PI/2-this._pitch)*r+this.cameraToCenterDistance),o=new Float64Array(16);Br.perspective(o,this._fov,this.width/this.height,1,a),Br.scale(o,o,[1,-1,1]),Br.translate(o,o,[0,0,-this.cameraToCenterDistance]),Br.rotateX(o,o,this._pitch),Br.rotateZ(o,o,this.angle),Br.translate(o,o,[-n,-i,0]);var s=this.worldSize/(2*Math.PI*6378137*Math.abs(Math.cos(this.center.lat*(Math.PI/180))));Br.scale(o,o,[1,1,s,1]),this.projMatrix=o;var l=this.width%2/2,u=this.height%2/2,c=Math.cos(this.angle),f=Math.sin(this.angle),h=n-Math.round(n)+c*l+f*u,p=i-Math.round(i)+c*u+f*l,d=new Float64Array(o);if(Br.translate(d,d,[h>.5?h-1:h,p>.5?p-1:p,0]),this.alignedProjMatrix=d,o=Br.create(),Br.scale(o,o,[this.width/2,-this.height/2,1]),Br.translate(o,o,[1,-1,0]),this.pixelMatrix=Br.multiply(new Float64Array(16),o,this.projMatrix),!(o=Br.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=o,this._posMatrixCache={},this._alignedPosMatrixCache={}}},jr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var t=this.pointCoordinate(new e.default$1(0,0)).zoomTo(this.zoom),r=[t.column*this.tileSize,t.row*this.tileSize,0,1];return Fr.transformMat4(r,r,this.pixelMatrix)[3]/this.cameraToCenterDistance},Object.defineProperties(jr.prototype,Vr);var qr=function(){var t,r,n,i,a;e.bindAll(["_onHashChange","_updateHash"],this),this._updateHash=(t=this._updateHashUnthrottled.bind(this),r=300,n=!1,i=0,a=function(){i=0,n&&(t(),i=setTimeout(a,r),n=!1)},function(){return n=!0,i||a(),i})};qr.prototype.addTo=function(t){return this._map=t,e.default.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},qr.prototype.remove=function(){return e.default.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},qr.prototype.getHashString=function(e){var t=this._map.getCenter(),r=Math.round(100*this._map.getZoom())/100,n=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,n),a=Math.round(t.lng*i)/i,o=Math.round(t.lat*i)/i,s=this._map.getBearing(),l=this._map.getPitch(),u="";return u+=e?"#/"+a+"/"+o+"/"+r:"#"+r+"/"+o+"/"+a,(s||l)&&(u+="/"+Math.round(10*s)/10),l&&(u+="/"+Math.round(l)),u},qr.prototype._onHashChange=function(){var t=e.default.location.hash.replace("#","").split("/");return t.length>=3&&(this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:+(t[3]||0),pitch:+(t[4]||0)}),!0)},qr.prototype._updateHashUnthrottled=function(){var t=this.getHashString();e.default.history.replaceState(e.default.history.state,"",t)};var Ur=function(t){function r(r,n,i,a){void 0===a&&(a={});var o=s.mousePos(n.getCanvasContainer(),i),l=n.unproject(o);t.call(this,r,e.extend({point:o,lngLat:l,originalEvent:i},a)),this._defaultPrevented=!1,this.target=n}t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r;var n={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,n),r}(e.Event),Zr=function(t){function r(r,n,i){var a=s.touchPos(n.getCanvasContainer(),i),o=a.map(function(e){return n.unproject(e)}),l=a.reduce(function(e,t,r,n){return e.add(t.div(n.length))},new e.default$1(0,0)),u=n.unproject(l);t.call(this,r,{points:a,point:l,lngLats:o,lngLat:u,originalEvent:i}),this._defaultPrevented=!1}t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r;var n={defaultPrevented:{configurable:!0}};return r.prototype.preventDefault=function(){this._defaultPrevented=!0},n.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(r.prototype,n),r}(e.Event),Hr=function(e){function t(t,r,n){e.call(this,t,{originalEvent:n}),this._defaultPrevented=!1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var r={defaultPrevented:{configurable:!0}};return t.prototype.preventDefault=function(){this._defaultPrevented=!0},r.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(t.prototype,r),t}(e.Event),Gr=function(t){this._map=t,this._el=t.getCanvasContainer(),this._delta=0,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Gr.prototype.isEnabled=function(){return!!this._enabled},Gr.prototype.isActive=function(){return!!this._active},Gr.prototype.enable=function(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=e&&"center"===e.around)},Gr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Gr.prototype.onWheel=function(t){if(this.isEnabled()){var r=t.deltaMode===e.default.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY,n=a.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==r&&r%4.000244140625==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(i*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this.isActive()||this._start(t)),t.preventDefault()}},Gr.prototype._onTimeout=function(e){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this._start(e)},Gr.prototype._start=function(t){if(this._delta){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this._map.fire(new e.Event("movestart",{originalEvent:t})),this._map.fire(new e.Event("zoomstart",{originalEvent:t})),this._finishTimeout&&clearTimeout(this._finishTimeout);var r=s.mousePos(this._el,t);this._around=G.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(r)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame))}},Gr.prototype._onScrollFrame=function(){var t=this;if(this._frameId=null,this.isActive()){var r=this._map.transform;if(0!==this._delta){var n="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?1/450:.01,i=2/(1+Math.exp(-Math.abs(this._delta*n)));this._delta<0&&0!==i&&(i=1/i);var o="number"==typeof this._targetZoom?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(o*i))),"wheel"===this._type&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var s=!1;if("wheel"===this._type){var l=Math.min((a.now()-this._lastWheelEventTime)/200,1),u=this._easing(l);r.zoom=e.number(this._startZoom,this._targetZoom,u),l<1?this._frameId||(this._frameId=this._map._requestRenderFrame(this._onScrollFrame)):s=!0}else r.zoom=this._targetZoom,s=!0;r.setLocationAtPoint(this._around,this._aroundPoint),this._map.fire(new e.Event("move",{originalEvent:this._lastWheelEvent})),this._map.fire(new e.Event("zoom",{originalEvent:this._lastWheelEvent})),s&&(this._active=!1,this._finishTimeout=setTimeout(function(){t._map.fire(new e.Event("zoomend",{originalEvent:t._lastWheelEvent})),t._map.fire(new e.Event("moveend",{originalEvent:t._lastWheelEvent})),delete t._targetZoom},200))}},Gr.prototype._smoothOutEasing=function(t){var r=e.ease;if(this._prevEase){var n=this._prevEase,i=(a.now()-n.start)/n.duration,o=n.easing(i+.01)-n.easing(i),s=.27/Math.sqrt(o*o+1e-4)*.01,l=Math.sqrt(.0729-s*s);r=e.bezier(s,l,.25,1)}return this._prevEase={start:a.now(),duration:t,easing:r},r};var $r=function(t){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),e.bindAll(["_onMouseMove","_onMouseUp","_onKeyDown"],this)};$r.prototype.isEnabled=function(){return!!this._enabled},$r.prototype.isActive=function(){return!!this._active},$r.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},$r.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},$r.prototype.onMouseDown=function(t){this.isEnabled()&&t.shiftKey&&0===t.button&&(e.default.document.addEventListener("mousemove",this._onMouseMove,!1),e.default.document.addEventListener("keydown",this._onKeyDown,!1),e.default.document.addEventListener("mouseup",this._onMouseUp,!1),s.disableDrag(),this._startPos=s.mousePos(this._el,t),this._active=!0)},$r.prototype._onMouseMove=function(e){var t=this._startPos,r=s.mousePos(this._el,e);this._box||(this._box=s.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));var n=Math.min(t.x,r.x),i=Math.max(t.x,r.x),a=Math.min(t.y,r.y),o=Math.max(t.y,r.y);s.setTransform(this._box,"translate("+n+"px,"+a+"px)"),this._box.style.width=i-n+"px",this._box.style.height=o-a+"px"},$r.prototype._onMouseUp=function(t){if(0===t.button){var r=this._startPos,n=s.mousePos(this._el,t),i=(new $).extend(this._map.unproject(r)).extend(this._map.unproject(n));this._finish(),s.suppressClick(),r.x===n.x&&r.y===n.y?this._fireEvent("boxzoomcancel",t):this._map.fitBounds(i,{linear:!0}).fire(new e.Event("boxzoomend",{originalEvent:t,boxZoomBounds:i}))}},$r.prototype._onKeyDown=function(e){27===e.keyCode&&(this._finish(),this._fireEvent("boxzoomcancel",e))},$r.prototype._finish=function(){this._active=!1,e.default.document.removeEventListener("mousemove",this._onMouseMove,!1),e.default.document.removeEventListener("keydown",this._onKeyDown,!1),e.default.document.removeEventListener("mouseup",this._onMouseUp,!1),this._container.classList.remove("mapboxgl-crosshair"),this._box&&(s.remove(this._box),this._box=null),s.enableDrag()},$r.prototype._fireEvent=function(t,r){return this._map.fire(new e.Event(t,{originalEvent:r}))};var Wr=e.bezier(0,0,.25,1),Xr=function(t,r){this._map=t,this._el=r.element||t.getCanvasContainer(),this._state="disabled",this._button=r.button||"right",this._bearingSnap=r.bearingSnap||0,this._pitchWithRotate=!1!==r.pitchWithRotate,e.bindAll(["_onMouseMove","_onMouseUp","_onBlur","_onDragFrame"],this)};Xr.prototype.isEnabled=function(){return"disabled"!==this._state},Xr.prototype.isActive=function(){return"active"===this._state},Xr.prototype.enable=function(){this.isEnabled()||(this._state="enabled")},Xr.prototype.disable=function(){if(this.isEnabled())switch(this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend"),this._pitchWithRotate&&this._fireEvent("pitchend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Xr.prototype.onMouseDown=function(t){if("enabled"===this._state){if("right"===this._button){if(this._eventButton=s.mouseButton(t),this._eventButton!==(t.ctrlKey?0:2))return}else{if(t.ctrlKey||0!==s.mouseButton(t))return;this._eventButton=0}s.disableDrag(),e.default.document.addEventListener("mousemove",this._onMouseMove,{capture:!0}),e.default.document.addEventListener("mouseup",this._onMouseUp),e.default.addEventListener("blur",this._onBlur),this._state="pending",this._inertia=[[a.now(),this._map.getBearing()]],this._previousPos=s.mousePos(this._el,t),this._center=this._map.transform.centerPoint,t.preventDefault()}},Xr.prototype._onMouseMove=function(e){this._lastMoveEvent=e,this._pos=s.mousePos(this._el,e),"pending"===this._state&&(this._state="active",this._fireEvent("rotatestart",e),this._fireEvent("movestart",e),this._pitchWithRotate&&this._fireEvent("pitchstart",e)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame))},Xr.prototype._onDragFrame=function(){this._frameId=null;var e=this._lastMoveEvent;if(e){var t=this._map.transform,r=this._previousPos,n=this._pos,i=.8*(r.x-n.x),o=-.5*(r.y-n.y),s=t.bearing-i,l=t.pitch-o,u=this._inertia,c=u[u.length-1];this._drainInertiaBuffer(),u.push([a.now(),this._map._normalizeBearing(s,c[1])]),t.bearing=s,this._pitchWithRotate&&(this._fireEvent("pitch",e),t.pitch=l),this._fireEvent("rotate",e),this._fireEvent("move",e),delete this._lastMoveEvent,this._previousPos=this._pos}},Xr.prototype._onMouseUp=function(e){if(s.mouseButton(e)===this._eventButton)switch(this._state){case"active":this._state="enabled",s.suppressClick(),this._unbind(),this._deactivate(),this._inertialRotate(e);break;case"pending":this._state="enabled",this._unbind()}},Xr.prototype._onBlur=function(e){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("rotateend",e),this._pitchWithRotate&&this._fireEvent("pitchend",e),this._fireEvent("moveend",e);break;case"pending":this._state="enabled",this._unbind()}},Xr.prototype._unbind=function(){e.default.document.removeEventListener("mousemove",this._onMouseMove,{capture:!0}),e.default.document.removeEventListener("mouseup",this._onMouseUp),e.default.removeEventListener("blur",this._onBlur),s.enableDrag()},Xr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._previousPos},Xr.prototype._inertialRotate=function(e){var t=this;this._fireEvent("rotateend",e),this._drainInertiaBuffer();var r=this._map,n=r.getBearing(),i=this._inertia,a=function(){Math.abs(n)<t._bearingSnap?r.resetNorth({noMoveStart:!0},{originalEvent:e}):t._fireEvent("moveend",e),t._pitchWithRotate&&t._fireEvent("pitchend",e)};if(i.length<2)a();else{var o=i[0],s=i[i.length-1],l=i[i.length-2],u=r._normalizeBearing(n,l[1]),c=s[1]-o[1],f=c<0?-1:1,h=(s[0]-o[0])/1e3;if(0!==c&&0!==h){var p=Math.abs(c*(.25/h));p>180&&(p=180);var d=p/180;u+=f*p*(d/2),Math.abs(r._normalizeBearing(u,0))<this._bearingSnap&&(u=r._normalizeBearing(0,u)),r.rotateTo(u,{duration:1e3*d,easing:Wr,noMoveStart:!0},{originalEvent:e})}else a()}},Xr.prototype._fireEvent=function(t,r){return this._map.fire(new e.Event(t,r?{originalEvent:r}:{}))},Xr.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,t=a.now();e.length>0&&t-e[0][0]>160;)e.shift()};var Yr=e.bezier(0,0,.3,1),Jr=function(t){this._map=t,this._el=t.getCanvasContainer(),this._state="disabled",e.bindAll(["_onMove","_onMouseUp","_onTouchEnd","_onBlur","_onDragFrame"],this)};Jr.prototype.isEnabled=function(){return"disabled"!==this._state},Jr.prototype.isActive=function(){return"active"===this._state},Jr.prototype.enable=function(){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-drag-pan"),this._state="enabled")},Jr.prototype.disable=function(){if(this.isEnabled())switch(this._el.classList.remove("mapboxgl-touch-drag-pan"),this._state){case"active":this._state="disabled",this._unbind(),this._deactivate(),this._fireEvent("dragend"),this._fireEvent("moveend");break;case"pending":this._state="disabled",this._unbind();break;default:this._state="disabled"}},Jr.prototype.onMouseDown=function(t){"enabled"===this._state&&(t.ctrlKey||0!==s.mouseButton(t)||(s.addEventListener(e.default.document,"mousemove",this._onMove,{capture:!0}),s.addEventListener(e.default.document,"mouseup",this._onMouseUp),this._start(t)))},Jr.prototype.onTouchStart=function(t){"enabled"===this._state&&(t.touches.length>1||(s.addEventListener(e.default.document,"touchmove",this._onMove,{capture:!0,passive:!1}),s.addEventListener(e.default.document,"touchend",this._onTouchEnd),this._start(t)))},Jr.prototype._start=function(t){e.default.addEventListener("blur",this._onBlur),this._state="pending",this._previousPos=s.mousePos(this._el,t),this._inertia=[[a.now(),this._previousPos]]},Jr.prototype._onMove=function(e){this._lastMoveEvent=e,e.preventDefault(),this._pos=s.mousePos(this._el,e),this._drainInertiaBuffer(),this._inertia.push([a.now(),this._pos]),"pending"===this._state&&(this._state="active",this._fireEvent("dragstart",e),this._fireEvent("movestart",e)),this._frameId||(this._frameId=this._map._requestRenderFrame(this._onDragFrame))},Jr.prototype._onDragFrame=function(){this._frameId=null;var e=this._lastMoveEvent;if(e){var t=this._map.transform;t.setLocationAtPoint(t.pointLocation(this._previousPos),this._pos),this._fireEvent("drag",e),this._fireEvent("move",e),this._previousPos=this._pos,delete this._lastMoveEvent}},Jr.prototype._onMouseUp=function(e){if(0===s.mouseButton(e))switch(this._state){case"active":this._state="enabled",s.suppressClick(),this._unbind(),this._deactivate(),this._inertialPan(e);break;case"pending":this._state="enabled",this._unbind()}},Jr.prototype._onTouchEnd=function(e){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._inertialPan(e);break;case"pending":this._state="enabled",this._unbind()}},Jr.prototype._onBlur=function(e){switch(this._state){case"active":this._state="enabled",this._unbind(),this._deactivate(),this._fireEvent("dragend",e),this._fireEvent("moveend",e);break;case"pending":this._state="enabled",this._unbind()}},Jr.prototype._unbind=function(){s.removeEventListener(e.default.document,"touchmove",this._onMove,{capture:!0,passive:!1}),s.removeEventListener(e.default.document,"touchend",this._onTouchEnd),s.removeEventListener(e.default.document,"mousemove",this._onMove,{capture:!0}),s.removeEventListener(e.default.document,"mouseup",this._onMouseUp),s.removeEventListener(e.default,"blur",this._onBlur)},Jr.prototype._deactivate=function(){this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._lastMoveEvent,delete this._previousPos,delete this._pos},Jr.prototype._inertialPan=function(e){this._fireEvent("dragend",e),this._drainInertiaBuffer();var t=this._inertia;if(t.length<2)this._fireEvent("moveend",e);else{var r=t[t.length-1],n=t[0],i=r[1].sub(n[1]),a=(r[0]-n[0])/1e3;if(0===a||r[1].equals(n[1]))this._fireEvent("moveend",e);else{var o=i.mult(.3/a),s=o.mag();s>1400&&(s=1400,o._unit()._mult(s));var l=s/750,u=o.mult(-l/2);this._map.panBy(u,{duration:1e3*l,easing:Yr,noMoveStart:!0},{originalEvent:e})}}},Jr.prototype._fireEvent=function(t,r){return this._map.fire(new e.Event(t,r?{originalEvent:r}:{}))},Jr.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,t=a.now();e.length>0&&t-e[0][0]>160;)e.shift()};var Kr=function(t){this._map=t,this._el=t.getCanvasContainer(),e.bindAll(["_onKeyDown"],this)};function Qr(e){return e*(2-e)}Kr.prototype.isEnabled=function(){return!!this._enabled},Kr.prototype.enable=function(){this.isEnabled()||(this._el.addEventListener("keydown",this._onKeyDown,!1),this._enabled=!0)},Kr.prototype.disable=function(){this.isEnabled()&&(this._el.removeEventListener("keydown",this._onKeyDown),this._enabled=!1)},Kr.prototype._onKeyDown=function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var t=0,r=0,n=0,i=0,a=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?r=-1:(e.preventDefault(),i=-1);break;case 39:e.shiftKey?r=1:(e.preventDefault(),i=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),a=-1);break;case 40:e.shiftKey?n=-1:(a=1,e.preventDefault());break;default:return}var o=this._map,s=o.getZoom(),l={duration:300,delayEndEvents:500,easing:Qr,zoom:t?Math.round(s)+t*(e.shiftKey?2:1):s,bearing:o.getBearing()+15*r,pitch:o.getPitch()+10*n,offset:[100*-i,100*-a],center:o.getCenter()};o.easeTo(l,{originalEvent:e})}};var en=function(t){this._map=t,e.bindAll(["_onDblClick","_onZoomEnd"],this)};en.prototype.isEnabled=function(){return!!this._enabled},en.prototype.isActive=function(){return!!this._active},en.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},en.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},en.prototype.onTouchStart=function(e){var t=this;this.isEnabled()&&(e.points.length>1||(this._tapped?(clearTimeout(this._tapped),this._tapped=null,this._zoom(e)):this._tapped=setTimeout(function(){t._tapped=null},300)))},en.prototype.onDblClick=function(e){this.isEnabled()&&(e.originalEvent.preventDefault(),this._zoom(e))},en.prototype._zoom=function(e){this._active=!0,this._map.on("zoomend",this._onZoomEnd),this._map.zoomTo(this._map.getZoom()+(e.originalEvent.shiftKey?-1:1),{around:e.lngLat},e)},en.prototype._onZoomEnd=function(){this._active=!1,this._map.off("zoomend",this._onZoomEnd)};var tn=e.bezier(0,0,.15,1),rn=function(t){this._map=t,this._el=t.getCanvasContainer(),e.bindAll(["_onMove","_onEnd","_onTouchFrame"],this)};rn.prototype.isEnabled=function(){return!!this._enabled},rn.prototype.enable=function(e){this.isEnabled()||(this._el.classList.add("mapboxgl-touch-zoom-rotate"),this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around)},rn.prototype.disable=function(){this.isEnabled()&&(this._el.classList.remove("mapboxgl-touch-zoom-rotate"),this._enabled=!1)},rn.prototype.disableRotation=function(){this._rotationDisabled=!0},rn.prototype.enableRotation=function(){this._rotationDisabled=!1},rn.prototype.onStart=function(t){if(this.isEnabled()&&2===t.touches.length){var r=s.mousePos(this._el,t.touches[0]),n=s.mousePos(this._el,t.touches[1]);this._startVec=r.sub(n),this._gestureIntent=void 0,this._inertia=[],s.addEventListener(e.default.document,"touchmove",this._onMove,{passive:!1}),s.addEventListener(e.default.document,"touchend",this._onEnd)}},rn.prototype._getTouchEventData=function(e){var t=s.mousePos(this._el,e.touches[0]),r=s.mousePos(this._el,e.touches[1]),n=t.sub(r);return{vec:n,center:t.add(r).div(2),scale:n.mag()/this._startVec.mag(),bearing:this._rotationDisabled?0:180*n.angleWith(this._startVec)/Math.PI}},rn.prototype._onMove=function(t){if(2===t.touches.length){var r=this._getTouchEventData(t),n=r.vec,i=r.scale,a=r.bearing;if(!this._gestureIntent){var o=Math.abs(1-i)>.15;Math.abs(a)>10?this._gestureIntent="rotate":o&&(this._gestureIntent="zoom"),this._gestureIntent&&(this._map.fire(new e.Event(this._gestureIntent+"start",{originalEvent:t})),this._map.fire(new e.Event("movestart",{originalEvent:t})),this._startVec=n)}this._lastTouchEvent=t,this._frameId||(this._frameId=this._map._requestRenderFrame(this._onTouchFrame)),t.preventDefault()}},rn.prototype._onTouchFrame=function(){this._frameId=null;var t=this._gestureIntent;if(t){var r=this._map.transform;this._startScale||(this._startScale=r.scale,this._startBearing=r.bearing);var n=this._getTouchEventData(this._lastTouchEvent),i=n.center,o=n.bearing,s=n.scale,l=r.pointLocation(i),u=r.locationPoint(l);"rotate"===t&&(r.bearing=this._startBearing+o),r.zoom=r.scaleZoom(this._startScale*s),r.setLocationAtPoint(l,u),this._map.fire(new e.Event(t,{originalEvent:this._lastTouchEvent})),this._map.fire(new e.Event("move",{originalEvent:this._lastTouchEvent})),this._drainInertiaBuffer(),this._inertia.push([a.now(),s,i])}},rn.prototype._onEnd=function(t){s.removeEventListener(e.default.document,"touchmove",this._onMove,{passive:!1}),s.removeEventListener(e.default.document,"touchend",this._onEnd);var r=this._gestureIntent,n=this._startScale;if(this._frameId&&(this._map._cancelRenderFrame(this._frameId),this._frameId=null),delete this._gestureIntent,delete this._startScale,delete this._startBearing,delete this._lastTouchEvent,r){this._map.fire(new e.Event(r+"end",{originalEvent:t})),this._drainInertiaBuffer();var i=this._inertia,a=this._map;if(i.length<2)a.snapToNorth({},{originalEvent:t});else{var o=i[i.length-1],l=i[0],u=a.transform.scaleZoom(n*o[1]),c=a.transform.scaleZoom(n*l[1]),f=u-c,h=(o[0]-l[0])/1e3,p=o[2];if(0!==h&&u!==c){var d=.15*f/h;Math.abs(d)>2.5&&(d=d>0?2.5:-2.5);var v=1e3*Math.abs(d/(12*.15)),m=u+d*v/2e3;m<0&&(m=0),a.easeTo({zoom:m,duration:v,easing:tn,around:this._aroundCenter?a.getCenter():a.unproject(p),noMoveStart:!0},{originalEvent:t})}else a.snapToNorth({},{originalEvent:t})}}},rn.prototype._drainInertiaBuffer=function(){for(var e=this._inertia,t=a.now();e.length>2&&t-e[0][0]>160;)e.shift()};var nn={scrollZoom:Gr,boxZoom:$r,dragRotate:Xr,dragPan:Jr,keyboard:Kr,doubleClickZoom:en,touchZoomRotate:rn};var an=function(t){function r(r,n){t.call(this),this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=n.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.getCenter=function(){return this.transform.center},r.prototype.setCenter=function(e,t){return this.jumpTo({center:e},t)},r.prototype.panBy=function(t,r,n){return t=e.default$1.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},r),n)},r.prototype.panTo=function(t,r,n){return this.easeTo(e.extend({center:t},r),n)},r.prototype.getZoom=function(){return this.transform.zoom},r.prototype.setZoom=function(e,t){return this.jumpTo({zoom:e},t),this},r.prototype.zoomTo=function(t,r,n){return this.easeTo(e.extend({zoom:t},r),n)},r.prototype.zoomIn=function(e,t){return this.zoomTo(this.getZoom()+1,e,t),this},r.prototype.zoomOut=function(e,t){return this.zoomTo(this.getZoom()-1,e,t),this},r.prototype.getBearing=function(){return this.transform.bearing},r.prototype.setBearing=function(e,t){return this.jumpTo({bearing:e},t),this},r.prototype.rotateTo=function(t,r,n){return this.easeTo(e.extend({bearing:t},r),n)},r.prototype.resetNorth=function(t,r){return this.rotateTo(0,e.extend({duration:1e3},t),r),this},r.prototype.snapToNorth=function(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this},r.prototype.getPitch=function(){return this.transform.pitch},r.prototype.setPitch=function(e,t){return this.jumpTo({pitch:e},t),this},r.prototype.fitBounds=function(t,r,n){if("number"==typeof(r=e.extend({padding:{top:0,bottom:0,right:0,left:0},offset:[0,0],maxZoom:this.transform.maxZoom},r)).padding){var i=r.padding;r.padding={top:i,bottom:i,right:i,left:i}}if(!e.default$10(Object.keys(r.padding).sort(function(e,t){return e<t?-1:e>t?1:0}),["bottom","left","right","top"]))return e.warnOnce("options.padding must be a positive number, or an Object with keys 'bottom', 'left', 'right', 'top'"),this;t=$.convert(t);var a=[(r.padding.left-r.padding.right)/2,(r.padding.top-r.padding.bottom)/2],o=Math.min(r.padding.right,r.padding.left),s=Math.min(r.padding.top,r.padding.bottom);r.offset=[r.offset[0]+a[0],r.offset[1]+a[1]];var l=e.default$1.convert(r.offset),u=this.transform,c=u.project(t.getNorthWest()),f=u.project(t.getSouthEast()),h=f.sub(c),p=(u.width-2*o-2*Math.abs(l.x))/h.x,d=(u.height-2*s-2*Math.abs(l.y))/h.y;return d<0||p<0?(e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset."),this):(r.center=u.unproject(c.add(f).div(2)),r.zoom=Math.min(u.scaleZoom(u.scale*Math.min(p,d)),r.maxZoom),r.bearing=0,r.linear?this.easeTo(r,n):this.flyTo(r,n))},r.prototype.jumpTo=function(t,r){this.stop();var n=this.transform,i=!1,a=!1,o=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(i=!0,n.zoom=+t.zoom),void 0!==t.center&&(n.center=G.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(a=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(o=!0,n.pitch=+t.pitch),this.fire(new e.Event("movestart",r)).fire(new e.Event("move",r)),i&&this.fire(new e.Event("zoomstart",r)).fire(new e.Event("zoom",r)).fire(new e.Event("zoomend",r)),a&&this.fire(new e.Event("rotatestart",r)).fire(new e.Event("rotate",r)).fire(new e.Event("rotateend",r)),o&&this.fire(new e.Event("pitchstart",r)).fire(new e.Event("pitch",r)).fire(new e.Event("pitchend",r)),this.fire(new e.Event("moveend",r))},r.prototype.easeTo=function(t,r){var n=this;this.stop(),!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate&&(t.duration=0);var i=this.transform,a=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l="zoom"in t?+t.zoom:a,u="bearing"in t?this._normalizeBearing(t.bearing,o):o,c="pitch"in t?+t.pitch:s,f=i.centerPoint.add(e.default$1.convert(t.offset)),h=i.pointLocation(f),p=G.convert(t.center||h);this._normalizeCenter(p);var d,v,m=i.project(h),g=i.project(p).sub(m),y=i.zoomScale(l-a);return t.around&&(d=G.convert(t.around),v=i.locationPoint(d)),this._zooming=l!==a,this._rotating=o!==u,this._pitching=c!==s,this._prepareEase(r,t.noMoveStart),clearTimeout(this._easeEndTimeoutID),this._ease(function(t){if(n._zooming&&(i.zoom=e.number(a,l,t)),n._rotating&&(i.bearing=e.number(o,u,t)),n._pitching&&(i.pitch=e.number(s,c,t)),d)i.setLocationAtPoint(d,v);else{var h=i.zoomScale(i.zoom-a),p=l>a?Math.min(2,y):Math.max(.5,y),_=Math.pow(p,1-t),x=i.unproject(m.add(g.mult(t*_)).mult(h));i.setLocationAtPoint(i.renderWorldCopies?x.wrap():x,f)}n._fireMoveEvents(r)},function(){t.delayEndEvents?n._easeEndTimeoutID=setTimeout(function(){return n._afterEase(r)},t.delayEndEvents):n._afterEase(r)},t),this},r.prototype._prepareEase=function(t,r){this._moving=!0,r||this.fire(new e.Event("movestart",t)),this._zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&this.fire(new e.Event("pitchstart",t))},r.prototype._fireMoveEvents=function(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))},r.prototype._afterEase=function(t){var r=this._zooming,n=this._rotating,i=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,r&&this.fire(new e.Event("zoomend",t)),n&&this.fire(new e.Event("rotateend",t)),i&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))},r.prototype.flyTo=function(t,r){var n=this;this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);var i=this.transform,a=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l="zoom"in t?e.clamp(+t.zoom,i.minZoom,i.maxZoom):a,u="bearing"in t?this._normalizeBearing(t.bearing,o):o,c="pitch"in t?+t.pitch:s,f=i.zoomScale(l-a),h=i.centerPoint.add(e.default$1.convert(t.offset)),p=i.pointLocation(h),d=G.convert(t.center||p);this._normalizeCenter(d);var v=i.project(p),m=i.project(d).sub(v),g=t.curve,y=Math.max(i.width,i.height),_=y/f,x=m.mag();if("minZoom"in t){var b=e.clamp(Math.min(t.minZoom,a,l),i.minZoom,i.maxZoom),w=y/i.zoomScale(b-a);g=Math.sqrt(w/x*2)}var k=g*g;function A(e){var t=(_*_-y*y+(e?-1:1)*k*k*x*x)/(2*(e?_:y)*k*x);return Math.log(Math.sqrt(t*t+1)-t)}function T(e){return(Math.exp(e)-Math.exp(-e))/2}function M(e){return(Math.exp(e)+Math.exp(-e))/2}var S=A(0),C=function(e){return M(S)/M(S+g*e)},z=function(e){return y*((M(S)*(T(t=S+g*e)/M(t))-T(S))/k)/x;var t},E=(A(1)-S)/g;if(Math.abs(x)<1e-6||!isFinite(E)){if(Math.abs(y-_)<1e-6)return this.easeTo(t,r);var L=_<y?-1:1;E=Math.abs(Math.log(_/y))/g,z=function(){return 0},C=function(e){return Math.exp(L*g*e)}}if("duration"in t)t.duration=+t.duration;else{var I="screenSpeed"in t?+t.screenSpeed/g:+t.speed;t.duration=1e3*E/I}return t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=o!==u,this._pitching=c!==s,this._prepareEase(r,!1),this._ease(function(t){var l=t*E,f=1/C(l);i.zoom=a+i.scaleZoom(f),n._rotating&&(i.bearing=e.number(o,u,t)),n._pitching&&(i.pitch=e.number(s,c,t));var p=i.unproject(v.add(m.mult(z(l))).mult(f));i.setLocationAtPoint(i.renderWorldCopies?p.wrap():p,h),n._fireMoveEvents(r)},function(){return n._afterEase(r)},t),this},r.prototype.isEasing=function(){return!!this._easeFrameId},r.prototype.stop=function(){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var e=this._onEaseEnd;delete this._onEaseEnd,e.call(this)}return this},r.prototype._ease=function(e,t,r){!1===r.animate||0===r.duration?(e(1),t()):(this._easeStart=a.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},r.prototype._renderFrameCallback=function(){var e=Math.min((a.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},r.prototype._normalizeBearing=function(t,r){t=e.wrap(t,-180,180);var n=Math.abs(t-r);return Math.abs(t-360-r)<n&&(t-=360),Math.abs(t+360-r)<n&&(t+=360),t},r.prototype._normalizeCenter=function(e){var t=this.transform;if(t.renderWorldCopies&&!t.lngRange){var r=e.lng-t.center.lng;e.lng+=r>180?-360:r<-180?360:0}},r}(e.Evented),on=function(t){void 0===t&&(t={}),this.options=t,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};on.prototype.getDefaultPosition=function(){return"bottom-right"},on.prototype.onAdd=function(e){var t=this.options&&this.options.compact;return this._map=e,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},on.prototype.onRemove=function(){s.remove(this._container),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0},on.prototype._updateEditLink=function(){var e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));var t=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:m.ACCESS_TOKEN}];if(e){var r=t.reduce(function(e,r,n){return r.value&&(e+=r.key+"="+r.value+(n<t.length-1?"&":"")),e},"?");e.href="https://www.mapbox.com/feedback/"+r+(this._map._hash?this._map._hash.getHashString(!0):"")}},on.prototype._updateData=function(e){e&&"metadata"===e.sourceDataType&&(this._updateAttributions(),this._updateEditLink())},on.prototype._updateAttributions=function(){if(this._map.style){var e=[];if(this._map.style.stylesheet){var t=this._map.style.stylesheet;this.styleOwner=t.owner,this.styleId=t.id}var r=this._map.style.sourceCaches;for(var n in r){var i=r[n].getSource();i.attribution&&e.indexOf(i.attribution)<0&&e.push(i.attribution)}e.sort(function(e,t){return e.length-t.length}),(e=e.filter(function(t,r){for(var n=r+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0})).length?(this._container.innerHTML=e.join(" | "),this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null}},on.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var sn=function(){e.bindAll(["_updateLogo"],this)};sn.prototype.onAdd=function(e){this._map=e,this._container=s.create("div","mapboxgl-ctrl");var t=s.create("a","mapboxgl-ctrl-logo");return t.target="_blank",t.href="https://www.mapbox.com/",t.setAttribute("aria-label","Mapbox logo"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._container},sn.prototype.onRemove=function(){s.remove(this._container),this._map.off("sourcedata",this._updateLogo)},sn.prototype.getDefaultPosition=function(){return"bottom-left"},sn.prototype._updateLogo=function(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},sn.prototype._logoRequired=function(){if(this._map.style){var e=this._map.style.sourceCaches;for(var t in e){if(e[t].getSource().mapbox_logo)return!0}return!1}};var ln=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};ln.prototype.add=function(e){var t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t},ln.prototype.remove=function(e){for(var t=this._currentlyRunning,r=0,n=t?this._queue.concat(t):this._queue;r<n.length;r+=1){var i=n[r];if(i.id===e)return void(i.cancelled=!0)}},ln.prototype.run=function(){var e=this._currentlyRunning=this._queue;this._queue=[];for(var t=0,r=e;t<r.length;t+=1){var n=r[t];if(!n.cancelled&&(n.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},ln.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var un=e.default.HTMLImageElement,cn=e.default.HTMLElement,fn={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:0,maxZoom:22,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,bearingSnap:7,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,transformRequest:null,fadeDuration:300},hn=function(r){function n(t){if(null!=(t=e.extend({},fn,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than minZoom");var n=new jr(t.minZoom,t.maxZoom,t.renderWorldCopies);r.call(this,n,t),this._interactive=t.interactive,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._crossFadingFactor=1,this._collectResourceTiming=t.collectResourceTiming,this._renderTaskQueue=new ln;var i=t.transformRequest;if(this._transformRequest=i?function(e,t){return i(e,t)||{url:e}}:function(e){return{url:e}},"string"==typeof t.container){var a=e.default.document.getElementById(t.container);if(!a)throw new Error("Container '"+t.container+"' not found.");this._container=a}else{if(!(t.container instanceof cn))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}t.maxBounds&&this.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored","_update","_render","_onData","_onDataLoading"],this),this._setupContainer(),this._setupPainter(),this.on("move",this._update.bind(this,!1)),this.on("zoom",this._update.bind(this,!0)),void 0!==e.default&&(e.default.addEventListener("online",this._onWindowOnline,!1),e.default.addEventListener("resize",this._onWindowResize,!1)),function(e,t){var r=e.getCanvasContainer(),n=null,i=!1;for(var a in nn)e[a]=new nn[a](e,t),t.interactive&&t[a]&&e[a].enable(t[a]);s.addEventListener(r,"mouseout",function(t){e.fire(new Ur("mouseout",e,t))}),s.addEventListener(r,"mousedown",function(r){i=!0;var n=new Ur("mousedown",e,r);e.fire(n),n.defaultPrevented||(t.interactive&&!e.doubleClickZoom.isActive()&&e.stop(),e.boxZoom.onMouseDown(r),e.boxZoom.isActive()||e.dragPan.isActive()||e.dragRotate.onMouseDown(r),e.boxZoom.isActive()||e.dragRotate.isActive()||e.dragPan.onMouseDown(r))}),s.addEventListener(r,"mouseup",function(t){var r=e.dragRotate.isActive();n&&!r&&e.fire(new Ur("contextmenu",e,n)),n=null,i=!1,e.fire(new Ur("mouseup",e,t))}),s.addEventListener(r,"mousemove",function(t){if(!e.dragPan.isActive()&&!e.dragRotate.isActive()){for(var n=t.toElement||t.target;n&&n!==r;)n=n.parentNode;n===r&&e.fire(new Ur("mousemove",e,t))}}),s.addEventListener(r,"mouseover",function(t){for(var n=t.toElement||t.target;n&&n!==r;)n=n.parentNode;n===r&&e.fire(new Ur("mouseover",e,t))}),s.addEventListener(r,"touchstart",function(r){var n=new Zr("touchstart",e,r);e.fire(n),n.defaultPrevented||(t.interactive&&e.stop(),e.boxZoom.isActive()||e.dragRotate.isActive()||e.dragPan.onTouchStart(r),e.touchZoomRotate.onStart(r),e.doubleClickZoom.onTouchStart(n))},{passive:!1}),s.addEventListener(r,"touchmove",function(t){e.fire(new Zr("touchmove",e,t))},{passive:!1}),s.addEventListener(r,"touchend",function(t){e.fire(new Zr("touchend",e,t))}),s.addEventListener(r,"touchcancel",function(t){e.fire(new Zr("touchcancel",e,t))}),s.addEventListener(r,"click",function(t){e.fire(new Ur("click",e,t))}),s.addEventListener(r,"dblclick",function(t){var r=new Ur("dblclick",e,t);e.fire(r),r.defaultPrevented||e.doubleClickZoom.onDblClick(r)}),s.addEventListener(r,"contextmenu",function(t){var r=e.dragRotate.isActive();i||r?i&&(n=t):e.fire(new Ur("contextmenu",e,t)),t.preventDefault()}),s.addEventListener(r,"wheel",function(t){var r=new Hr("wheel",e,t);e.fire(r),r.defaultPrevented||e.scrollZoom.onWheel(t)},{passive:!1})}(this,t),this._hash=t.hash&&(new qr).addTo(this),this._hash&&this._hash._onHashChange()||this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),this.resize(),t.style&&this.setStyle(t.style,{localIdeographFontFamily:t.localIdeographFontFamily}),t.attributionControl&&this.addControl(new on),this.addControl(new sn,t.logoPosition),this.on("style.load",function(){this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",this._onData),this.on("dataloading",this._onDataLoading)}r&&(n.__proto__=r),n.prototype=Object.create(r&&r.prototype),n.prototype.constructor=n;var i={showTileBoundaries:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0}};return n.prototype.addControl=function(e,t){void 0===t&&e.getDefaultPosition&&(t=e.getDefaultPosition()),void 0===t&&(t="top-right");var r=e.onAdd(this),n=this._controlPositions[t];return-1!==t.indexOf("bottom")?n.insertBefore(r,n.firstChild):n.appendChild(r),this},n.prototype.removeControl=function(e){return e.onRemove(this),this},n.prototype.resize=function(t){var r=this._containerDimensions(),n=r[0],i=r[1];return this._resizeCanvas(n,i),this.transform.resize(n,i),this.painter.resize(n,i),this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t)).fire(new e.Event("resize",t)).fire(new e.Event("moveend",t))},n.prototype.getBounds=function(){var t=new $(this.transform.pointLocation(new e.default$1(0,this.transform.height)),this.transform.pointLocation(new e.default$1(this.transform.width,0)));return(this.transform.angle||this.transform.pitch)&&(t.extend(this.transform.pointLocation(new e.default$1(this.transform.size.x,0))),t.extend(this.transform.pointLocation(new e.default$1(0,this.transform.size.y)))),t},n.prototype.getMaxBounds=function(){return this.transform.latRange&&2===this.transform.latRange.length&&this.transform.lngRange&&2===this.transform.lngRange.length?new $([this.transform.lngRange[0],this.transform.latRange[0]],[this.transform.lngRange[1],this.transform.latRange[1]]):null},n.prototype.setMaxBounds=function(e){if(e){var t=$.convert(e);this.transform.lngRange=[t.getWest(),t.getEast()],this.transform.latRange=[t.getSouth(),t.getNorth()],this.transform._constrain(),this._update()}else null==e&&(this.transform.lngRange=null,this.transform.latRange=null,this._update());return this},n.prototype.setMinZoom=function(e){if((e=null==e?0:e)>=0&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between 0 and the current maxZoom, inclusive")},n.prototype.getMinZoom=function(){return this.transform.minZoom},n.prototype.setMaxZoom=function(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")},n.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},n.prototype.setRenderWorldCopies=function(e){return this.transform.renderWorldCopies=e,this._update(),this},n.prototype.getMaxZoom=function(){return this.transform.maxZoom},n.prototype.project=function(e){return this.transform.locationPoint(G.convert(e))},n.prototype.unproject=function(t){return this.transform.pointLocation(e.default$1.convert(t))},n.prototype.isMoving=function(){return this._moving||this.dragPan.isActive()||this.dragRotate.isActive()||this.scrollZoom.isActive()},n.prototype.isZooming=function(){return this._zooming||this.scrollZoom.isActive()},n.prototype.isRotating=function(){return this._rotating||this.dragRotate.isActive()},n.prototype.on=function(e,t,n){var i,a=this;if(void 0===n)return r.prototype.on.call(this,e,t);var o=function(){if("mouseenter"===e||"mouseover"===e){var r=!1;return{layer:t,listener:n,delegates:{mousemove:function(i){var o=a.getLayer(t)?a.queryRenderedFeatures(i.point,{layers:[t]}):[];o.length?r||(r=!0,n.call(a,new Ur(e,a,i.originalEvent,{features:o}))):r=!1},mouseout:function(){r=!1}}}}if("mouseleave"===e||"mouseout"===e){var o=!1;return{layer:t,listener:n,delegates:{mousemove:function(r){(a.getLayer(t)?a.queryRenderedFeatures(r.point,{layers:[t]}):[]).length?o=!0:o&&(o=!1,n.call(a,new Ur(e,a,r.originalEvent)))},mouseout:function(t){o&&(o=!1,n.call(a,new Ur(e,a,t.originalEvent)))}}}}return{layer:t,listener:n,delegates:(i={},i[e]=function(e){var r=a.getLayer(t)?a.queryRenderedFeatures(e.point,{layers:[t]}):[];r.length&&(e.features=r,n.call(a,e),delete e.features)},i)}}();for(var s in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(o),o.delegates)a.on(s,o.delegates[s]);return this},n.prototype.off=function(e,t,n){if(void 0===n)return r.prototype.off.call(this,e,t);if(this._delegatedListeners&&this._delegatedListeners[e])for(var i=this._delegatedListeners[e],a=0;a<i.length;a++){var o=i[a];if(o.layer===t&&o.listener===n){for(var s in o.delegates)this.off(s,o.delegates[s]);return i.splice(a,1),this}}return this},n.prototype.queryRenderedFeatures=function(t,r){var n;return 2===arguments.length?(t=arguments[0],r=arguments[1]):1===arguments.length&&((n=arguments[0])instanceof e.default$1||Array.isArray(n))?(t=arguments[0],r={}):1===arguments.length?(t=void 0,r=arguments[0]):(t=void 0,r={}),this.style?this.style.queryRenderedFeatures(this._makeQueryGeometry(t),r,this.transform):[]},n.prototype._makeQueryGeometry=function(t){var r,n=this;if(void 0===t&&(t=[e.default$1.convert([0,0]),e.default$1.convert([this.transform.width,this.transform.height])]),t instanceof e.default$1||"number"==typeof t[0]){r=[e.default$1.convert(t)]}else{var i=[e.default$1.convert(t[0]),e.default$1.convert(t[1])];r=[i[0],new e.default$1(i[1].x,i[0].y),i[1],new e.default$1(i[0].x,i[1].y),i[0]]}return{viewport:r,worldCoordinate:r.map(function(e){return n.transform.pointCoordinate(e)})}},n.prototype.querySourceFeatures=function(e,t){return this.style.querySourceFeatures(e,t)},n.prototype.setStyle=function(t,r){if((!r||!1!==r.diff&&!r.localIdeographFontFamily)&&this.style&&t&&"object"==typeof t)try{return this.style.setState(t)&&this._update(!0),this}catch(t){e.warnOnce("Unable to perform style diff: "+(t.message||t.error||t)+".  Rebuilding the style from scratch.")}return this.style&&(this.style.setEventedParent(null),this.style._remove()),t?(this.style=new Qt(this,r||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof t?this.style.loadURL(t):this.style.loadJSON(t),this):(delete this.style,this)},n.prototype.getStyle=function(){if(this.style)return this.style.serialize()},n.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},n.prototype.addSource=function(e,t){return this.style.addSource(e,t),this._update(!0),this},n.prototype.isSourceLoaded=function(t){var r=this.style&&this.style.sourceCaches[t];if(void 0!==r)return r.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+t+"'")))},n.prototype.areTilesLoaded=function(){var e=this.style&&this.style.sourceCaches;for(var t in e){var r=e[t]._tiles;for(var n in r){var i=r[n];if("loaded"!==i.state&&"errored"!==i.state)return!1}}return!0},n.prototype.addSourceType=function(e,t,r){return this.style.addSourceType(e,t,r)},n.prototype.removeSource=function(e){return this.style.removeSource(e),this._update(!0),this},n.prototype.getSource=function(e){return this.style.getSource(e)},n.prototype.addImage=function(t,r,n){void 0===n&&(n={});var i=n.pixelRatio;void 0===i&&(i=1);var o=n.sdf;if(void 0===o&&(o=!1),r instanceof un){var s=a.getImageData(r),l=s.width,u=s.height,c=s.data;this.style.addImage(t,{data:new e.RGBAImage({width:l,height:u},c),pixelRatio:i,sdf:o})}else{if(void 0===r.width||void 0===r.height)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var f=r.width,h=r.height,p=r.data;this.style.addImage(t,{data:new e.RGBAImage({width:f,height:h},p.slice(0)),pixelRatio:i,sdf:o})}},n.prototype.hasImage=function(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},n.prototype.removeImage=function(e){this.style.removeImage(e)},n.prototype.loadImage=function(t,r){e.getImage(this._transformRequest(t,e.ResourceType.Image),r)},n.prototype.addLayer=function(e,t){return this.style.addLayer(e,t),this._update(!0),this},n.prototype.moveLayer=function(e,t){return this.style.moveLayer(e,t),this._update(!0),this},n.prototype.removeLayer=function(e){return this.style.removeLayer(e),this._update(!0),this},n.prototype.getLayer=function(e){return this.style.getLayer(e)},n.prototype.setFilter=function(e,t){return this.style.setFilter(e,t),this._update(!0),this},n.prototype.setLayerZoomRange=function(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0),this},n.prototype.getFilter=function(e){return this.style.getFilter(e)},n.prototype.setPaintProperty=function(e,t,r){return this.style.setPaintProperty(e,t,r),this._update(!0),this},n.prototype.getPaintProperty=function(e,t){return this.style.getPaintProperty(e,t)},n.prototype.setLayoutProperty=function(e,t,r){return this.style.setLayoutProperty(e,t,r),this._update(!0),this},n.prototype.getLayoutProperty=function(e,t){return this.style.getLayoutProperty(e,t)},n.prototype.setLight=function(e){return this.style.setLight(e),this._update(!0),this},n.prototype.getLight=function(){return this.style.getLight()},n.prototype.getContainer=function(){return this._container},n.prototype.getCanvasContainer=function(){return this._canvasContainer},n.prototype.getCanvas=function(){return this._canvas},n.prototype._containerDimensions=function(){var e=0,t=0;return this._container&&(e=this._container.offsetWidth||400,t=this._container.offsetHeight||300),[e,t]},n.prototype._setupContainer=function(){var e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSContainer=s.create("div","mapboxgl-missing-css",e)).innerHTML="Missing Mapbox GL JS CSS";var t=this._canvasContainer=s.create("div","mapboxgl-canvas-container",e);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=s.create("canvas","mapboxgl-canvas",t),this._canvas.style.position="absolute",this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var r=this._containerDimensions();this._resizeCanvas(r[0],r[1]);var n=this._controlContainer=s.create("div","mapboxgl-control-container",e),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(e){i[e]=s.create("div","mapboxgl-ctrl-"+e,n)})},n.prototype._resizeCanvas=function(t,r){var n=e.default.devicePixelRatio||1;this._canvas.width=n*t,this._canvas.height=n*r,this._canvas.style.width=t+"px",this._canvas.style.height=r+"px"},n.prototype._setupPainter=function(){var r=e.extend({failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer},t.webGLContextAttributes),n=this._canvas.getContext("webgl",r)||this._canvas.getContext("experimental-webgl",r);n?this.painter=new Pr(n,this.transform):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},n.prototype._contextLost=function(t){t.preventDefault(),this._frameId&&(a.cancelFrame(this._frameId),this._frameId=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))},n.prototype._contextRestored=function(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))},n.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!(!this.style||!this.style.loaded())},n.prototype._update=function(e){this.style&&(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this._rerender())},n.prototype._requestRenderFrame=function(e){return this._update(),this._renderTaskQueue.add(e)},n.prototype._cancelRenderFrame=function(e){this._renderTaskQueue.remove(e)},n.prototype._render=function(){this._renderTaskQueue.run();var t=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var r=this.transform.zoom,n=a.now();this.style.zoomHistory.update(r,n);var i=new e.default$16(r,{now:n,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),o=i.crossFadingFactor();1===o&&o===this._crossFadingFactor||(t=!0,this._crossFadingFactor=o),this.style.update(i)}return this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),fadeDuration:this._fadeDuration}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||t)&&(this._styleDirty=!0),(this._sourcesDirty||this._repaint||this._styleDirty||this._placementDirty)&&this._rerender(),this},n.prototype.remove=function(){this._hash&&this._hash.remove(),a.cancelFrame(this._frameId),this._renderTaskQueue.clear(),this._frameId=null,this.setStyle(null),void 0!==e.default&&(e.default.removeEventListener("resize",this._onWindowResize,!1),e.default.removeEventListener("online",this._onWindowOnline,!1));var t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),pn(this._canvasContainer),pn(this._controlContainer),pn(this._missingCSSContainer),this._container.classList.remove("mapboxgl-map"),this.fire(new e.Event("remove"))},n.prototype._rerender=function(){var e=this;this.style&&!this._frameId&&(this._frameId=a.frame(function(){e._frameId=null,e._render()}))},n.prototype._onWindowOnline=function(){this._update()},n.prototype._onWindowResize=function(){this._trackResize&&this.stop().resize()._update()},i.showTileBoundaries.get=function(){return!!this._showTileBoundaries},i.showTileBoundaries.set=function(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())},i.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},i.showCollisionBoxes.set=function(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())},i.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},i.showOverdrawInspector.set=function(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())},i.repaint.get=function(){return!!this._repaint},i.repaint.set=function(e){this._repaint=e,this._update()},i.vertices.get=function(){return!!this._vertices},i.vertices.set=function(e){this._vertices=e,this._update()},n.prototype._onData=function(t){this._update("style"===t.dataType),this.fire(new e.Event(t.dataType+"data",t))},n.prototype._onDataLoading=function(t){this.fire(new e.Event(t.dataType+"dataloading",t))},Object.defineProperties(n.prototype,i),n}(an);function pn(e){e.parentNode&&e.parentNode.removeChild(e)}var dn={showCompass:!0,showZoom:!0},vn=function(t){var r=this;this.options=e.extend({},dn,t),this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(e){return e.preventDefault()}),this.options.showZoom&&(this._zoomInButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-in","Zoom In",function(){return r._map.zoomIn()}),this._zoomOutButton=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-zoom-out","Zoom Out",function(){return r._map.zoomOut()})),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-icon mapboxgl-ctrl-compass","Reset North",function(){return r._map.resetNorth()}),this._compassArrow=s.create("span","mapboxgl-ctrl-compass-arrow",this._compass))};function mn(e,t,r){if(e=new G(e.lng,e.lat),t){var n=new G(e.lng-360,e.lat),i=new G(e.lng+360,e.lat),a=r.locationPoint(e).distSqr(t);r.locationPoint(n).distSqr(t)<a?e=n:r.locationPoint(i).distSqr(t)<a&&(e=i)}for(;Math.abs(e.lng-r.center.lng)>180;){var o=r.locationPoint(e);if(o.x>=0&&o.y>=0&&o.x<=r.width&&o.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e}vn.prototype._rotateCompassArrow=function(){var e="rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassArrow.style.transform=e},vn.prototype.onAdd=function(e){return this._map=e,this.options.showCompass&&(this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Xr(e,{button:"left",element:this._compass}),this._handler.enable()),this._container},vn.prototype.onRemove=function(){s.remove(this._container),this.options.showCompass&&(this._map.off("rotate",this._rotateCompassArrow),this._handler.disable(),delete this._handler),delete this._map},vn.prototype._createButton=function(e,t,r){var n=s.create("button",e,this._container);return n.type="button",n.setAttribute("aria-label",t),n.addEventListener("click",r),n};var gn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function yn(e,t,r){var n=e.classList;for(var i in gn)n.remove("mapboxgl-"+r+"-anchor-"+i);n.add("mapboxgl-"+r+"-anchor-"+t)}var _n=function(t){if((arguments[0]instanceof e.default.HTMLElement||2===arguments.length)&&(t=e.extend({element:t},arguments[1])),e.bindAll(["_update","_onMapClick"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",t&&t.element)this._element=t.element,this._offset=e.default$1.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=s.create("div");var r=s.createNS("http://www.w3.org/2000/svg","svg");r.setAttributeNS(null,"height","41px"),r.setAttributeNS(null,"width","27px"),r.setAttributeNS(null,"viewBox","0 0 27 41");var n=s.createNS("http://www.w3.org/2000/svg","g");n.setAttributeNS(null,"stroke","none"),n.setAttributeNS(null,"stroke-width","1"),n.setAttributeNS(null,"fill","none"),n.setAttributeNS(null,"fill-rule","evenodd");var i=s.createNS("http://www.w3.org/2000/svg","g");i.setAttributeNS(null,"fill-rule","nonzero");var a=s.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"transform","translate(3.0, 29.0)"),a.setAttributeNS(null,"fill","#000000");for(var o=0,l=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];o<l.length;o+=1){var u=l[o],c=s.createNS("http://www.w3.org/2000/svg","ellipse");c.setAttributeNS(null,"opacity","0.04"),c.setAttributeNS(null,"cx","10.5"),c.setAttributeNS(null,"cy","5.80029008"),c.setAttributeNS(null,"rx",u.rx),c.setAttributeNS(null,"ry",u.ry),a.appendChild(c)}var f=s.createNS("http://www.w3.org/2000/svg","g");f.setAttributeNS(null,"fill",this._color);var h=s.createNS("http://www.w3.org/2000/svg","path");h.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),f.appendChild(h);var p=s.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"opacity","0.25"),p.setAttributeNS(null,"fill","#000000");var d=s.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),p.appendChild(d);var v=s.createNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"transform","translate(6.0, 7.0)"),v.setAttributeNS(null,"fill","#FFFFFF");var m=s.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");var g=s.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");var y=s.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(y),i.appendChild(a),i.appendChild(f),i.appendChild(p),i.appendChild(v),i.appendChild(m),r.appendChild(i),this._element.appendChild(r),this._offset=e.default$1.convert(t&&t.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._popup=null};_n.prototype.addTo=function(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),this._update(),this._map.on("click",this._onMapClick),this},_n.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),delete this._map),s.remove(this._element),this._popup&&this._popup.remove(),this},_n.prototype.getLngLat=function(){return this._lngLat},_n.prototype.setLngLat=function(e){return this._lngLat=G.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},_n.prototype.getElement=function(){return this._element},_n.prototype.setPopup=function(e){if(this._popup&&(this._popup.remove(),this._popup=null),e){if(!("offset"in e.options)){var t=Math.sqrt(Math.pow(13.5,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,-1*(24.6+t)],"bottom-right":[-t,-1*(24.6+t)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=e,this._lngLat&&this._popup.setLngLat(this._lngLat)}return this},_n.prototype._onMapClick=function(e){var t=e.originalEvent.target,r=this._element;this._popup&&(t===r||r.contains(t))&&this.togglePopup()},_n.prototype.getPopup=function(){return this._popup},_n.prototype.togglePopup=function(){var e=this._popup;return e?(e.isOpen()?e.remove():e.addTo(this._map),this):this},_n.prototype._update=function(e){this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=mn(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset),e&&"moveend"!==e.type||(this._pos=this._pos.round()),s.setTransform(this._element,gn[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px)"),yn(this._element,this._anchor,"marker"))},_n.prototype.getOffset=function(){return this._offset},_n.prototype.setOffset=function(t){return this._offset=e.default$1.convert(t),this._update(),this};var xn,bn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0};var wn=function(t){function r(r){t.call(this),this.options=e.extend({},bn,r),e.bindAll(["_onSuccess","_onError","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.onAdd=function(t){var r;return this._map=t,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),r=this._setupUI,void 0!==xn?r(xn):void 0!==e.default.navigator.permissions?e.default.navigator.permissions.query({name:"geolocation"}).then(function(e){xn="denied"!==e.state,r(xn)}):(xn=!!e.default.navigator.geolocation,r(xn)),this._container},r.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(e.default.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker.remove(),s.remove(this._container),this._map=void 0},r.prototype._onSuccess=function(t){if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()},r.prototype._updateCamera=function(e){var t=new G(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy;this._map.fitBounds(t.toBounds(r),this.options.fitBoundsOptions,{geolocateSource:!0})},r.prototype._updateMarker=function(e){e?this._userLocationDotMarker.setLngLat([e.coords.longitude,e.coords.latitude]).addTo(this._map):this._userLocationDotMarker.remove()},r.prototype._onError=function(t){if(this.options.trackUserLocation)if(1===t.code)this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),void 0!==this._geolocationWatchID&&this._clearWatch();else switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()},r.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},r.prototype._setupUI=function(t){var r=this;!1!==t&&(this._container.addEventListener("contextmenu",function(e){return e.preventDefault()}),this._geolocateButton=s.create("button","mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",this._container),this._geolocateButton.type="button",this._geolocateButton.setAttribute("aria-label","Geolocate"),this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=s.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new _n(this._dotElement),this.options.trackUserLocation&&(this._watchState="OFF")),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(t){t.geolocateSource||"ACTIVE_LOCK"!==r._watchState||(r._watchState="BACKGROUND",r._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),r._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),r.fire(new e.Event("trackuserlocationend")))}))},r.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}"OFF"===this._watchState&&void 0!==this._geolocationWatchID?this._clearWatch():void 0===this._geolocationWatchID&&(this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._geolocationWatchID=e.default.navigator.geolocation.watchPosition(this._onSuccess,this._onError,this.options.positionOptions))}else e.default.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},r.prototype._clearWatch=function(){e.default.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},r}(e.Evented),kn={maxWidth:100,unit:"metric"},An=function(t){this.options=e.extend({},kn,t),e.bindAll(["_onMove","setUnit"],this)};function Tn(e,t,r){var n,i,a,o,s,l,u=r&&r.maxWidth||100,c=e._container.clientHeight/2,f=(n=e.unproject([0,c]),i=e.unproject([u,c]),a=Math.PI/180,o=n.lat*a,s=i.lat*a,l=Math.sin(o)*Math.sin(s)+Math.cos(o)*Math.cos(s)*Math.cos((i.lng-n.lng)*a),6371e3*Math.acos(Math.min(l,1)));if(r&&"imperial"===r.unit){var h=3.2808*f;if(h>5280)Mn(t,u,h/5280,"mi");else Mn(t,u,h,"ft")}else if(r&&"nautical"===r.unit){Mn(t,u,f/1852,"nm")}else Mn(t,u,f,"m")}function Mn(e,t,r,n){var i,a,o,s=(i=r,(a=Math.pow(10,(""+Math.floor(i)).length-1))*(o=(o=i/a)>=10?10:o>=5?5:o>=3?3:o>=2?2:1)),l=s/r;"m"===n&&s>=1e3&&(s/=1e3,n="km"),e.style.width=t*l+"px",e.innerHTML=s+n}An.prototype.getDefaultPosition=function(){return"bottom-left"},An.prototype._onMove=function(){Tn(this._map,this._container,this.options)},An.prototype.onAdd=function(e){return this._map=e,this._container=s.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},An.prototype.onRemove=function(){s.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},An.prototype.setUnit=function(e){this.options.unit=e,Tn(this._map,this._container,this.options)};var Sn=function(){this._fullscreen=!1,e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.default.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.default.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.default.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.default.document&&(this._fullscreenchange="MSFullscreenChange"),this._className="mapboxgl-ctrl"};Sn.prototype.onAdd=function(t){return this._map=t,this._mapContainer=this._map.getContainer(),this._container=s.create("div",this._className+" mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._container.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._container},Sn.prototype.onRemove=function(){s.remove(this._container),this._map=null,e.default.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Sn.prototype._checkFullscreenSupport=function(){return!!(e.default.document.fullscreenEnabled||e.default.document.mozFullScreenEnabled||e.default.document.msFullscreenEnabled||e.default.document.webkitFullscreenEnabled)},Sn.prototype._setupUI=function(){var t=this._fullscreenButton=s.create("button",this._className+"-icon "+this._className+"-fullscreen",this._container);t.setAttribute("aria-label","Toggle fullscreen"),t.type="button",this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.default.document.addEventListener(this._fullscreenchange,this._changeIcon)},Sn.prototype._isFullscreen=function(){return this._fullscreen},Sn.prototype._changeIcon=function(){(e.default.document.fullscreenElement||e.default.document.mozFullScreenElement||e.default.document.webkitFullscreenElement||e.default.document.msFullscreenElement)===this._mapContainer!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle(this._className+"-shrink"),this._fullscreenButton.classList.toggle(this._className+"-fullscreen"))},Sn.prototype._onClickFullscreen=function(){this._isFullscreen()?e.default.document.exitFullscreen?e.default.document.exitFullscreen():e.default.document.mozCancelFullScreen?e.default.document.mozCancelFullScreen():e.default.document.msExitFullscreen?e.default.document.msExitFullscreen():e.default.document.webkitCancelFullScreen&&e.default.document.webkitCancelFullScreen():this._mapContainer.requestFullscreen?this._mapContainer.requestFullscreen():this._mapContainer.mozRequestFullScreen?this._mapContainer.mozRequestFullScreen():this._mapContainer.msRequestFullscreen?this._mapContainer.msRequestFullscreen():this._mapContainer.webkitRequestFullscreen&&this._mapContainer.webkitRequestFullscreen()};var Cn={closeButton:!0,closeOnClick:!0},zn=function(t){function r(r){t.call(this),this.options=e.extend(Object.create(Cn),r),e.bindAll(["_update","_onClickClose"],this)}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.addTo=function(t){return this._map=t,this._map.on("move",this._update),this.options.closeOnClick&&this._map.on("click",this._onClickClose),this._update(),this.fire(new e.Event("open")),this},r.prototype.isOpen=function(){return!!this._map},r.prototype.remove=function(){return this._content&&s.remove(this._content),this._container&&(s.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("click",this._onClickClose),delete this._map),this.fire(new e.Event("close")),this},r.prototype.getLngLat=function(){return this._lngLat},r.prototype.setLngLat=function(e){return this._lngLat=G.convert(e),this._pos=null,this._update(),this},r.prototype.setText=function(t){return this.setDOMContent(e.default.document.createTextNode(t))},r.prototype.setHTML=function(t){var r,n=e.default.document.createDocumentFragment(),i=e.default.document.createElement("body");for(i.innerHTML=t;r=i.firstChild;)n.appendChild(r);return this.setDOMContent(n)},r.prototype.setDOMContent=function(e){return this._createContent(),this._content.appendChild(e),this._update(),this},r.prototype._createContent=function(){this._content&&s.remove(this._content),this._content=s.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=s.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClickClose))},r.prototype._update=function(){if(this._map&&this._lngLat&&this._content){this._container||(this._container=s.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=s.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this._map.transform.renderWorldCopies&&(this._lngLat=mn(this._lngLat,this._pos,this._map.transform));var t=this._pos=this._map.project(this._lngLat),r=this.options.anchor,n=function t(r){if(r){if("number"==typeof r){var n=Math.round(Math.sqrt(.5*Math.pow(r,2)));return{center:new e.default$1(0,0),top:new e.default$1(0,r),"top-left":new e.default$1(n,n),"top-right":new e.default$1(-n,n),bottom:new e.default$1(0,-r),"bottom-left":new e.default$1(n,-n),"bottom-right":new e.default$1(-n,-n),left:new e.default$1(r,0),right:new e.default$1(-r,0)}}if(r instanceof e.default$1||Array.isArray(r)){var i=e.default$1.convert(r);return{center:i,top:i,"top-left":i,"top-right":i,bottom:i,"bottom-left":i,"bottom-right":i,left:i,right:i}}return{center:e.default$1.convert(r.center||[0,0]),top:e.default$1.convert(r.top||[0,0]),"top-left":e.default$1.convert(r["top-left"]||[0,0]),"top-right":e.default$1.convert(r["top-right"]||[0,0]),bottom:e.default$1.convert(r.bottom||[0,0]),"bottom-left":e.default$1.convert(r["bottom-left"]||[0,0]),"bottom-right":e.default$1.convert(r["bottom-right"]||[0,0]),left:e.default$1.convert(r.left||[0,0]),right:e.default$1.convert(r.right||[0,0])}}return t(new e.default$1(0,0))}(this.options.offset);if(!r){var i,a=this._container.offsetWidth,o=this._container.offsetHeight;i=t.y+n.bottom.y<o?["top"]:t.y>this._map.transform.height-o?["bottom"]:[],t.x<a/2?i.push("left"):t.x>this._map.transform.width-a/2&&i.push("right"),r=0===i.length?"bottom":i.join("-")}var l=t.add(n[r]).round();s.setTransform(this._container,gn[r]+" translate("+l.x+"px,"+l.y+"px)"),yn(this._container,r,"popup")}},r.prototype._onClickClose=function(){this.remove()},r}(e.Evented);var En={version:"0.45.0",supported:t,workerCount:Math.max(Math.floor(a.hardwareConcurrency/2),1),setRTLTextPlugin:e.setRTLTextPlugin,Map:hn,NavigationControl:vn,GeolocateControl:wn,AttributionControl:on,ScaleControl:An,FullscreenControl:Sn,Popup:zn,Marker:_n,Style:Qt,LngLat:G,LngLatBounds:$,Point:e.default$1,Evented:e.Evented,config:m,get accessToken(){return m.ACCESS_TOKEN},set accessToken(e){m.ACCESS_TOKEN=e},workerUrl:""};return En});return n})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],15:[function(e,t,r){var n={left:0,top:0};t.exports=i;function i(e,t,r){t=t||e.currentTarget||e.srcElement;if(!Array.isArray(r)){r=[0,0]}var n=e.clientX||0;var i=e.clientY||0;var o=a(t);r[0]=n-o.left;r[1]=i-o.top;return r}function a(e){if(e===window||e===document||e===document.body){return n}else{return e.getBoundingClientRect()}}},{}],16:[function(e,t,r){var n=e("./lib/build-log");var i=e("./lib/epsilon");var a=e("./lib/intersecter");var o=e("./lib/segment-chainer");var s=e("./lib/segment-selector");var l=e("./lib/geojson");var u=false;var c=i();var f;f={buildLog:function(e){if(e===true)u=n();else if(e===false)u=false;return u===false?false:u.list},epsilon:function(e){return c.epsilon(e)},segments:function(e){var t=a(true,c,u);e.regions.forEach(t.addRegion);return{segments:t.calculate(e.inverted),inverted:e.inverted}},combine:function(e,t){var r=a(false,c,u);return{combined:r.calculate(e.segments,e.inverted,t.segments,t.inverted),inverted1:e.inverted,inverted2:t.inverted}},selectUnion:function(e){return{segments:s.union(e.combined,u),inverted:e.inverted1||e.inverted2}},selectIntersect:function(e){return{segments:s.intersect(e.combined,u),inverted:e.inverted1&&e.inverted2}},selectDifference:function(e){return{segments:s.difference(e.combined,u),inverted:e.inverted1&&!e.inverted2}},selectDifferenceRev:function(e){return{segments:s.differenceRev(e.combined,u),inverted:!e.inverted1&&e.inverted2}},selectXor:function(e){return{segments:s.xor(e.combined,u),inverted:e.inverted1!==e.inverted2}},polygon:function(e){return{regions:o(e.segments,c,u),inverted:e.inverted}},polygonFromGeoJSON:function(e){return l.toPolygon(f,e)},polygonToGeoJSON:function(e){return l.fromPolygon(f,c,e)},union:function(e,t){return h(e,t,f.selectUnion)},intersect:function(e,t){return h(e,t,f.selectIntersect)},difference:function(e,t){return h(e,t,f.selectDifference)},differenceRev:function(e,t){return h(e,t,f.selectDifferenceRev)},xor:function(e,t){return h(e,t,f.selectXor)}};function h(e,t,r){var n=f.segments(e);var i=f.segments(t);var a=f.combine(n,i);var o=r(a);return f.polygon(o)}if(typeof window==="object")window.PolyBool=f;t.exports=f},{"./lib/build-log":17,"./lib/epsilon":18,"./lib/geojson":19,"./lib/intersecter":20,"./lib/segment-chainer":22,"./lib/segment-selector":23}],17:[function(e,t,r){function n(){var e;var t=0;var r=false;function n(t,r){e.list.push({type:t,data:r?JSON.parse(JSON.stringify(r)):void 0});return e}e={list:[],segmentId:function(){return t++},checkIntersection:function(e,t){return n("check",{seg1:e,seg2:t})},segmentChop:function(e,t){n("div_seg",{seg:e,pt:t});return n("chop",{seg:e,pt:t})},statusRemove:function(e){return n("pop_seg",{seg:e})},segmentUpdate:function(e){return n("seg_update",{seg:e})},segmentNew:function(e,t){return n("new_seg",{seg:e,primary:t})},segmentRemove:function(e){return n("rem_seg",{seg:e})},tempStatus:function(e,t,r){return n("temp_status",{seg:e,above:t,below:r})},rewind:function(e){return n("rewind",{seg:e})},status:function(e,t,r){return n("status",{seg:e,above:t,below:r})},vert:function(t){if(t===r)return e;r=t;return n("vert",{x:t})},log:function(e){if(typeof e!=="string")e=JSON.stringify(e,false,"  ");return n("log",{txt:e})},reset:function(){return n("reset")},selected:function(e){return n("selected",{segs:e})},chainStart:function(e){return n("chain_start",{seg:e})},chainRemoveHead:function(e,t){return n("chain_rem_head",{index:e,pt:t})},chainRemoveTail:function(e,t){return n("chain_rem_tail",{index:e,pt:t})},chainNew:function(e,t){return n("chain_new",{pt1:e,pt2:t})},chainMatch:function(e){return n("chain_match",{index:e})},chainClose:function(e){return n("chain_close",{index:e})},chainAddHead:function(e,t){return n("chain_add_head",{index:e,pt:t})},chainAddTail:function(e,t){return n("chain_add_tail",{index:e,pt:t})},chainConnect:function(e,t){return n("chain_con",{index1:e,index2:t})},chainReverse:function(e){return n("chain_rev",{index:e})},chainJoin:function(e,t){return n("chain_join",{index1:e,index2:t})},done:function(){return n("done")}};return e}t.exports=n},{}],18:[function(e,t,r){function n(e){if(typeof e!=="number")e=1e-10;var t={epsilon:function(t){if(typeof t==="number")e=t;return e},pointAboveOrOnLine:function(t,r,n){var i=r[0];var a=r[1];var o=n[0];var s=n[1];var l=t[0];var u=t[1];return(o-i)*(u-a)-(s-a)*(l-i)>=-e},pointBetween:function(t,r,n){var i=t[1]-r[1];var a=n[0]-r[0];var o=t[0]-r[0];var s=n[1]-r[1];var l=o*a+i*s;if(l<e)return false;var u=a*a+s*s;if(l-u>-e)return false;return true},pointsSameX:function(t,r){return Math.abs(t[0]-r[0])<e},pointsSameY:function(t,r){return Math.abs(t[1]-r[1])<e},pointsSame:function(e,r){return t.pointsSameX(e,r)&&t.pointsSameY(e,r)},pointsCompare:function(e,r){if(t.pointsSameX(e,r))return t.pointsSameY(e,r)?0:e[1]<r[1]?-1:1;return e[0]<r[0]?-1:1},pointsCollinear:function(t,r,n){var i=t[0]-r[0];var a=t[1]-r[1];var o=r[0]-n[0];var s=r[1]-n[1];return Math.abs(i*s-o*a)<e},linesIntersect:function(t,r,n,i){var a=r[0]-t[0];var o=r[1]-t[1];var s=i[0]-n[0];var l=i[1]-n[1];var u=a*l-o*s;if(Math.abs(u)<e)return false;var c=t[0]-n[0];var f=t[1]-n[1];var h=(s*f-l*c)/u;var p=(a*f-o*c)/u;var d={alongA:0,alongB:0,pt:[t[0]+h*a,t[1]+h*o]};if(h<=-e)d.alongA=-2;else if(h<e)d.alongA=-1;else if(h-1<=-e)d.alongA=0;else if(h-1<e)d.alongA=1;else d.alongA=2;if(p<=-e)d.alongB=-2;else if(p<e)d.alongB=-1;else if(p-1<=-e)d.alongB=0;else if(p-1<e)d.alongB=1;else d.alongB=2;return d},pointInsideRegion:function(t,r){var n=t[0];var i=t[1];var a=r[r.length-1][0];var o=r[r.length-1][1];var s=false;for(var l=0;l<r.length;l++){var u=r[l][0];var c=r[l][1];if(c-i>e!=o-i>e&&(a-u)*(i-c)/(o-c)+u-n>e)s=!s;a=u;o=c}return s}};return t}t.exports=n},{}],19:[function(e,t,r){var n={toPolygon:function(e,t){function r(t){if(t.length<=0)return e.segments({inverted:false,regions:[]});function r(t){var r=t.slice(0,t.length-1);return e.segments({inverted:false,regions:[r]})}var n=r(t[0]);for(var i=1;i<t.length;i++)n=e.selectDifference(e.combine(n,r(t[i])));return n}if(t.type==="Polygon"){return e.polygon(r(t.coordinates))}else if(t.type==="MultiPolygon"){var n=e.segments({inverted:false,regions:[]});for(var i=0;i<t.coordinates.length;i++)n=e.selectUnion(e.combine(n,r(t.coordinates[i])));return e.polygon(n)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(e,t,r){r=e.polygon(e.segments(r));function n(e,r){return t.pointInsideRegion([(e[0][0]+e[1][0])*.5,(e[0][1]+e[1][1])*.5],r)}function i(e){return{region:e,children:[]}}var a=i(null);function o(e,t){for(var r=0;r<e.children.length;r++){var a=e.children[r];if(n(t,a.region)){o(a,t);return}}var s=i(t);for(var r=0;r<e.children.length;r++){var a=e.children[r];if(n(a.region,t)){s.children.push(a);e.children.splice(r,1);r--}}e.children.push(s)}for(var s=0;s<r.regions.length;s++){var l=r.regions[s];if(l.length<3)continue;o(a,l)}function u(e,t){var r=0;var n=e[e.length-1][0];var i=e[e.length-1][1];var a=[];for(var o=0;o<e.length;o++){var s=e[o][0];var l=e[o][1];a.push([s,l]);r+=l*n-s*i;n=s;i=l}var u=r<0;if(u!==t)a.reverse();a.push([a[0][0],a[0][1]]);return a}var c=[];function f(e){var t=[u(e.region,false)];c.push(t);for(var r=0;r<e.children.length;r++)t.push(h(e.children[r]))}function h(e){for(var t=0;t<e.children.length;t++)f(e.children[t]);return u(e.region,true)}for(var s=0;s<a.children.length;s++)f(a.children[s]);if(c.length<=0)return{type:"Polygon",coordinates:[]};if(c.length==1)return{type:"Polygon",coordinates:c[0]};return{type:"MultiPolygon",coordinates:c}}};t.exports=n},{}],20:[function(e,t,r){var n=e("./linked-list");function i(e,t,r){function i(e,t){return{id:r?r.segmentId():-1,start:e,end:t,myFill:{above:null,below:null},otherFill:null}}function a(e,t,n){return{id:r?r.segmentId():-1,start:e,end:t,myFill:{above:n.myFill.above,below:n.myFill.below},otherFill:null}}var o=n.create();function s(e,r,n,i,a,o){var s=t.pointsCompare(r,a);if(s!==0)return s;if(t.pointsSame(n,o))return 0;if(e!==i)return e?1:-1;return t.pointAboveOrOnLine(n,i?a:o,i?o:a)?1:-1}function l(e,t){o.insertBefore(e,function(r){var n=s(e.isStart,e.pt,t,r.isStart,r.pt,r.other.pt);return n<0})}function u(e,t){var r=n.node({isStart:true,pt:e.start,seg:e,primary:t,other:null,status:null});l(r,e.end);return r}function c(e,t,r){var i=n.node({isStart:false,pt:t.end,seg:t,primary:r,other:e,status:null});e.other=i;l(i,e.pt)}function f(e,t){var r=u(e,t);c(r,e,t);return r}function h(e,t){if(r)r.segmentChop(e.seg,t);e.other.remove();e.seg.end=t;e.other.pt=t;l(e.other,e.pt)}function p(e,t){var r=a(t,e.seg.end,e.seg);h(e,t);return f(r,e.primary)}function d(i,a){var s=n.create();function l(e,r){var n=e.seg.start;var i=e.seg.end;var a=r.seg.start;var o=r.seg.end;if(t.pointsCollinear(n,a,o)){if(t.pointsCollinear(i,a,o))return 1;return t.pointAboveOrOnLine(i,a,o)?1:-1}return t.pointAboveOrOnLine(n,a,o)?1:-1}function u(e){return s.findTransition(function(t){var r=l(e,t.ev);return r>0})}function c(e,n){var i=e.seg;var a=n.seg;var o=i.start;var s=i.end;var l=a.start;var u=a.end;if(r)r.checkIntersection(i,a);var c=t.linesIntersect(o,s,l,u);if(c===false){if(!t.pointsCollinear(o,s,l))return false;if(t.pointsSame(o,u)||t.pointsSame(s,l))return false;var f=t.pointsSame(o,l);var h=t.pointsSame(s,u);if(f&&h)return n;var d=!f&&t.pointBetween(o,l,u);var v=!h&&t.pointBetween(s,l,u);if(f){if(v){p(n,s)}else{p(e,u)}return n}else if(d){if(!h){if(v){p(n,s)}else{p(e,u)}}p(n,o)}}else{if(c.alongA===0){if(c.alongB===-1)p(e,l);else if(c.alongB===0)p(e,c.pt);else if(c.alongB===1)p(e,u)}if(c.alongB===0){if(c.alongA===-1)p(n,o);else if(c.alongA===0)p(n,c.pt);else if(c.alongA===1)p(n,s)}}return false}var f=[];while(!o.isEmpty()){var h=o.getHead();if(r)r.vert(h.pt[0]);if(h.isStart){if(r)r.segmentNew(h.seg,h.primary);var d=u(h);var v=d.before?d.before.ev:null;var m=d.after?d.after.ev:null;if(r){r.tempStatus(h.seg,v?v.seg:false,m?m.seg:false)}function g(){if(v){var e=c(h,v);if(e)return e}if(m)return c(h,m);return false}var y=g();if(y){if(e){var _;if(h.seg.myFill.below===null)_=true;else _=h.seg.myFill.above!==h.seg.myFill.below;if(_)y.seg.myFill.above=!y.seg.myFill.above}else{y.seg.otherFill=h.seg.myFill}if(r)r.segmentUpdate(y.seg);h.other.remove();h.remove()}if(o.getHead()!==h){if(r)r.rewind(h.seg);continue}if(e){var _;if(h.seg.myFill.below===null)_=true;else _=h.seg.myFill.above!==h.seg.myFill.below;if(!m){h.seg.myFill.below=i}else{h.seg.myFill.below=m.seg.myFill.above}if(_)h.seg.myFill.above=!h.seg.myFill.below;else h.seg.myFill.above=h.seg.myFill.below}else{if(h.seg.otherFill===null){var x;if(!m){x=h.primary?a:i}else{if(h.primary===m.primary)x=m.seg.otherFill.above;else x=m.seg.myFill.above}h.seg.otherFill={above:x,below:x}}}if(r){r.status(h.seg,v?v.seg:false,m?m.seg:false)}h.other.status=d.insert(n.node({ev:h}))}else{var b=h.status;if(b===null){throw new Error("PolyBool: Zero-length segment detected; your epsilon is "+"probably too small or too large")}if(s.exists(b.prev)&&s.exists(b.next))c(b.prev.ev,b.next.ev);if(r)r.statusRemove(b.ev.seg);b.remove();if(!h.primary){var w=h.seg.myFill;h.seg.myFill=h.seg.otherFill;h.seg.otherFill=w}f.push(h.seg)}o.getHead().remove()}if(r)r.done();return f}if(!e){return{calculate:function(e,t,r,n){e.forEach(function(e){f(a(e.start,e.end,e),true)});r.forEach(function(e){f(a(e.start,e.end,e),false)});return d(t,n)}}}return{addRegion:function(e){var r;var n=e[e.length-1];for(var a=0;a<e.length;a++){r=n;n=e[a];var o=t.pointsCompare(r,n);if(o===0)continue;f(i(o<0?r:n,o<0?n:r),true)}},calculate:function(e){return d(e,false)}}}t.exports=i},{"./linked-list":21}],21:[function(e,t,r){var n={create:function(){var e={root:{root:true,next:null},exists:function(t){if(t===null||t===e.root)return false;return true},isEmpty:function(){return e.root.next===null},getHead:function(){return e.root.next},insertBefore:function(t,r){var n=e.root;var i=e.root.next;while(i!==null){if(r(i)){t.prev=i.prev;t.next=i;i.prev.next=t;i.prev=t;return}n=i;i=i.next}n.next=t;t.prev=n;t.next=null},findTransition:function(t){var r=e.root;var n=e.root.next;while(n!==null){if(t(n))break;r=n;n=n.next}return{before:r===e.root?null:r,after:n,insert:function(e){e.prev=r;e.next=n;r.next=e;if(n!==null)n.prev=e;return e}}}};return e},node:function(e){e.prev=null;e.next=null;e.remove=function(){e.prev.next=e.next;if(e.next)e.next.prev=e.prev;e.prev=null;e.next=null};return e}};t.exports=n},{}],22:[function(e,t,r){function n(e,t,r){var n=[];var i=[];e.forEach(function(e){var a=e.start;var o=e.end;if(t.pointsSame(a,o)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is "+"probably too small or too large");return}if(r)r.chainStart(e);var s={index:0,matches_head:false,matches_pt1:false};var l={index:0,matches_head:false,matches_pt1:false};var u=s;function c(e,t,r){u.index=e;u.matches_head=t;u.matches_pt1=r;if(u===s){u=l;return false}u=null;return true}for(var f=0;f<n.length;f++){var h=n[f];var p=h[0];var d=h[1];var v=h[h.length-1];var m=h[h.length-2];if(t.pointsSame(p,a)){if(c(f,true,true))break}else if(t.pointsSame(p,o)){if(c(f,true,false))break}else if(t.pointsSame(v,a)){if(c(f,false,true))break}else if(t.pointsSame(v,o)){if(c(f,false,false))break}}if(u===s){n.push([a,o]);if(r)r.chainNew(a,o);return}if(u===l){if(r)r.chainMatch(s.index);var g=s.index;var y=s.matches_pt1?o:a;var _=s.matches_head;var h=n[g];var x=_?h[0]:h[h.length-1];var b=_?h[1]:h[h.length-2];var w=_?h[h.length-1]:h[0];var k=_?h[h.length-2]:h[1];if(t.pointsCollinear(b,x,y)){if(_){if(r)r.chainRemoveHead(s.index,y);h.shift()}else{if(r)r.chainRemoveTail(s.index,y);h.pop()}x=b}if(t.pointsSame(w,y)){n.splice(g,1);if(t.pointsCollinear(k,w,x)){if(_){if(r)r.chainRemoveTail(s.index,x);h.pop()}else{if(r)r.chainRemoveHead(s.index,x);h.shift()}}if(r)r.chainClose(s.index);i.push(h);return}if(_){if(r)r.chainAddHead(s.index,y);h.unshift(y)}else{if(r)r.chainAddTail(s.index,y);h.push(y)}return}function A(e){if(r)r.chainReverse(e);n[e].reverse()}function T(e,i){var a=n[e];var o=n[i];var s=a[a.length-1];var l=a[a.length-2];var u=o[0];var c=o[1];if(t.pointsCollinear(l,s,u)){if(r)r.chainRemoveTail(e,s);a.pop();s=l}if(t.pointsCollinear(s,u,c)){if(r)r.chainRemoveHead(i,u);o.shift()}if(r)r.chainJoin(e,i);n[e]=a.concat(o);n.splice(i,1)}var M=s.index;var S=l.index;if(r)r.chainConnect(M,S);var C=n[M].length<n[S].length;if(s.matches_head){if(l.matches_head){if(C){A(M);T(M,S)}else{A(S);T(S,M)}}else{T(S,M)}}else{if(l.matches_head){T(M,S)}else{if(C){A(M);T(S,M)}else{A(S);T(M,S)}}}});return i}t.exports=n},{}],23:[function(e,t,r){function n(e,t,r){var n=[];e.forEach(function(e){var i=(e.myFill.above?8:0)+(e.myFill.below?4:0)+(e.otherFill&&e.otherFill.above?2:0)+(e.otherFill&&e.otherFill.below?1:0);if(t[i]!==0){n.push({id:r?r.segmentId():-1,start:e.start,end:e.end,myFill:{above:t[i]===1,below:t[i]===2},otherFill:null})}});if(r)r.selected(n);return n}var i={union:function(e,t){return n(e,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],t)},intersect:function(e,t){return n(e,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],t)},difference:function(e,t){return n(e,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],t)},differenceRev:function(e,t){return n(e,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],t)},xor:function(e,t){return n(e,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],t)}};t.exports=i},{}],24:[function(e,t,r){var n=t.exports={};var i;var a;function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){i=setTimeout}else{i=o}}catch(e){i=o}try{if(typeof clearTimeout==="function"){a=clearTimeout}else{a=s}}catch(e){a=s}})();function l(e){if(i===setTimeout){return setTimeout(e,0)}if((i===o||!i)&&setTimeout){i=setTimeout;return setTimeout(e,0)}try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}function u(e){if(a===clearTimeout){return clearTimeout(e)}if((a===s||!a)&&clearTimeout){a=clearTimeout;return clearTimeout(e)}try{return a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}var c=[];var f=false;var h;var p=-1;function d(){if(!f||!h){return}f=false;if(h.length){c=h.concat(c)}else{p=-1}if(c.length){v()}}function v(){if(f){return}var e=l(d);f=true;var t=c.length;while(t){h=c;c=[];while(++p<t){if(h){h[p].run()}}p=-1;t=c.length}h=null;f=false;u(e)}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}c.push(new m(e,t));if(c.length===1&&!f){l(v)}};function m(e,t){this.fun=e;this.array=t}m.prototype.run=function(){this.fun.apply(null,this.array)};n.title="browser";n.browser=true;n.env={};n.argv=[];n.version="";n.versions={};function g(){}n.on=g;n.addListener=g;n.once=g;n.off=g;n.removeListener=g;n.removeAllListeners=g;n.emit=g;n.prependListener=g;n.prependOnceListener=g;n.listeners=function(e){return[]};n.binding=function(e){throw new Error("process.binding is not supported")};n.cwd=function(){return"/"};n.chdir=function(e){throw new Error("process.chdir is not supported")};n.umask=function(){return 0}},{}],25:[function(t,r,n){(function(t){var n=/^\s+/,i=/\s+$/,a=0,o=t.round,s=t.min,l=t.max,u=t.random;function c(e,t){e=e?e:"";t=t||{};if(e instanceof c){return e}if(!(this instanceof c)){return new c(e,t)}var r=f(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=o(100*this._a)/100,this._format=t.format||r.format;this._gradientType=t.gradientType;if(this._r<1){this._r=o(this._r)}if(this._g<1){this._g=o(this._g)}if(this._b<1){this._b=o(this._b)}this._ok=r.ok;this._tc_id=a++}c.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb();var r,n,i,a,o,s;r=e.r/255;n=e.g/255;i=e.b/255;if(r<=.03928){a=r/12.92}else{a=t.pow((r+.055)/1.055,2.4)}if(n<=.03928){o=n/12.92}else{o=t.pow((n+.055)/1.055,2.4)}if(i<=.03928){s=i/12.92}else{s=t.pow((i+.055)/1.055,2.4)}return.2126*a+.7152*o+.0722*s},setAlpha:function(e){this._a=R(e);this._roundA=o(100*this._a)/100;return this},toHsv:function(){var e=v(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=v(this._r,this._g,this._b);var t=o(e.h*360),r=o(e.s*100),n=o(e.v*100);return this._a==1?"hsv("+t+", "+r+"%, "+n+"%)":"hsva("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHsl:function(){var e=p(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=p(this._r,this._g,this._b);var t=o(e.h*360),r=o(e.s*100),n=o(e.l*100);return this._a==1?"hsl("+t+", "+r+"%, "+n+"%)":"hsla("+t+", "+r+"%, "+n+"%, "+this._roundA+")"},toHex:function(e){return g(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return y(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:o(this._r),g:o(this._g),b:o(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+o(this._r)+", "+o(this._g)+", "+o(this._b)+")":"rgba("+o(this._r)+", "+o(this._g)+", "+o(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:o(F(this._r,255)*100)+"%",g:o(F(this._g,255)*100)+"%",b:o(F(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+o(F(this._r,255)*100)+"%, "+o(F(this._g,255)*100)+"%, "+o(F(this._b,255)*100)+"%)":"rgba("+o(F(this._r,255)*100)+"%, "+o(F(this._g,255)*100)+"%, "+o(F(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){if(this._a===0){return"transparent"}if(this._a<1){return false}return D[g(this._r,this._g,this._b,true)]||false},toFilter:function(e){var t="#"+_(this._r,this._g,this._b,this._a);var r=t;var n=this._gradientType?"GradientType = 1, ":"";if(e){var i=c(e);r="#"+_(i._r,i._g,i._b,i._a)}return"progid:DXImageTransform.Microsoft.gradient("+n+"startColorstr="+t+",endColorstr="+r+")"},toString:function(e){var t=!!e;e=e||this._format;var r=false;var n=this._a<1&&this._a>=0;var i=!t&&n&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");if(i){if(e==="name"&&this._a===0){return this.toName()}return this.toRgbString()}if(e==="rgb"){r=this.toRgbString()}if(e==="prgb"){r=this.toPercentageRgbString()}if(e==="hex"||e==="hex6"){r=this.toHexString()}if(e==="hex3"){r=this.toHexString(true)}if(e==="hex4"){r=this.toHex8String(true)}if(e==="hex8"){r=this.toHex8String()}if(e==="name"){r=this.toName()}if(e==="hsl"){r=this.toHslString()}if(e==="hsv"){r=this.toHsvString()}return r||this.toHexString()},clone:function(){return c(this.toString())},_applyModification:function(e,t){var r=e.apply(null,[this].concat([].slice.call(t)));this._r=r._r;this._g=r._g;this._b=r._b;this.setAlpha(r._a);return this},lighten:function(){return this._applyModification(k,arguments)},brighten:function(){return this._applyModification(A,arguments)},darken:function(){return this._applyModification(T,arguments)},desaturate:function(){return this._applyModification(x,arguments)},saturate:function(){return this._applyModification(b,arguments)},greyscale:function(){return this._applyModification(w,arguments)},spin:function(){return this._applyModification(M,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(L,arguments)},complement:function(){return this._applyCombination(S,arguments)},monochromatic:function(){return this._applyCombination(I,arguments)},splitcomplement:function(){return this._applyCombination(E,arguments)},triad:function(){return this._applyCombination(C,arguments)},tetrad:function(){return this._applyCombination(z,arguments)}};c.fromRatio=function(e,t){if(typeof e=="object"){var r={};for(var n in e){if(e.hasOwnProperty(n)){if(n==="a"){r[n]=e[n]}else{r[n]=U(e[n])}}}e=r}return c(e,t)};function f(e){var t={r:0,g:0,b:0};var r=1;var n=null;var i=null;var a=null;var o=false;var u=false;if(typeof e=="string"){e=W(e)}if(typeof e=="object"){if($(e.r)&&$(e.g)&&$(e.b)){t=h(e.r,e.g,e.b);o=true;u=String(e.r).substr(-1)==="%"?"prgb":"rgb"}else if($(e.h)&&$(e.s)&&$(e.v)){n=U(e.s);i=U(e.v);t=m(e.h,n,i);o=true;u="hsv"}else if($(e.h)&&$(e.s)&&$(e.l)){n=U(e.s);a=U(e.l);t=d(e.h,n,a);o=true;u="hsl"}if(e.hasOwnProperty("a")){r=e.a}}r=R(r);return{ok:o,format:e.format||u,r:s(255,l(t.r,0)),g:s(255,l(t.g,0)),b:s(255,l(t.b,0)),a:r}}function h(e,t,r){return{r:F(e,255)*255,g:F(t,255)*255,b:F(r,255)*255}}function p(e,t,r){e=F(e,255);t=F(t,255);r=F(r,255);var n=l(e,t,r),i=s(e,t,r);var a,o,u=(n+i)/2;if(n==i){a=o=0}else{var c=n-i;o=u>.5?c/(2-n-i):c/(n+i);switch(n){case e:a=(t-r)/c+(t<r?6:0);break;case t:a=(r-e)/c+2;break;case r:a=(e-t)/c+4;break}a/=6}return{h:a,s:o,l:u}}function d(e,t,r){var n,i,a;e=F(e,360);t=F(t,100);r=F(r,100);function o(e,t,r){if(r<0)r+=1;if(r>1)r-=1;if(r<1/6)return e+(t-e)*6*r;if(r<1/2)return t;if(r<2/3)return e+(t-e)*(2/3-r)*6;return e}if(t===0){n=i=a=r}else{var s=r<.5?r*(1+t):r+t-r*t;var l=2*r-s;n=o(l,s,e+1/3);i=o(l,s,e);a=o(l,s,e-1/3)}return{r:n*255,g:i*255,b:a*255}}function v(e,t,r){e=F(e,255);t=F(t,255);r=F(r,255);var n=l(e,t,r),i=s(e,t,r);var a,o,u=n;var c=n-i;o=n===0?0:c/n;if(n==i){a=0}else{switch(n){case e:a=(t-r)/c+(t<r?6:0);break;case t:a=(r-e)/c+2;break;case r:a=(e-t)/c+4;break}a/=6}return{h:a,s:o,v:u}}function m(e,r,n){e=F(e,360)*6;r=F(r,100);n=F(n,100);var i=t.floor(e),a=e-i,o=n*(1-r),s=n*(1-a*r),l=n*(1-(1-a)*r),u=i%6,c=[n,s,o,o,l,n][u],f=[l,n,n,s,o,o][u],h=[o,o,l,n,n,s][u];return{r:c*255,g:f*255,b:h*255}}function g(e,t,r,n){var i=[q(o(e).toString(16)),q(o(t).toString(16)),q(o(r).toString(16))];if(n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)){return i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0)}return i.join("")}function y(e,t,r,n,i){var a=[q(o(e).toString(16)),q(o(t).toString(16)),q(o(r).toString(16)),q(Z(n))];if(i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)){return a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0)}return a.join("")}function _(e,t,r,n){var i=[q(Z(n)),q(o(e).toString(16)),q(o(t).toString(16)),q(o(r).toString(16))];return i.join("")}c.equals=function(e,t){if(!e||!t){return false}return c(e).toRgbString()==c(t).toRgbString()};c.random=function(){return c.fromRatio({r:u(),g:u(),b:u()})};function x(e,t){t=t===0?0:t||10;var r=c(e).toHsl();r.s-=t/100;r.s=B(r.s);return c(r)}function b(e,t){t=t===0?0:t||10;var r=c(e).toHsl();r.s+=t/100;r.s=B(r.s);return c(r)}function w(e){return c(e).desaturate(100)}function k(e,t){t=t===0?0:t||10;var r=c(e).toHsl();r.l+=t/100;r.l=B(r.l);return c(r)}function A(e,t){t=t===0?0:t||10;var r=c(e).toRgb();r.r=l(0,s(255,r.r-o(255*-(t/100))));r.g=l(0,s(255,r.g-o(255*-(t/100))));r.b=l(0,s(255,r.b-o(255*-(t/100))));return c(r)}function T(e,t){t=t===0?0:t||10;var r=c(e).toHsl();r.l-=t/100;r.l=B(r.l);return c(r)}function M(e,t){var r=c(e).toHsl();var n=(r.h+t)%360;r.h=n<0?360+n:n;return c(r)}function S(e){var t=c(e).toHsl();t.h=(t.h+180)%360;return c(t)}function C(e){var t=c(e).toHsl();var r=t.h;return[c(e),c({h:(r+120)%360,s:t.s,l:t.l}),c({h:(r+240)%360,s:t.s,l:t.l})]}function z(e){var t=c(e).toHsl();var r=t.h;return[c(e),c({h:(r+90)%360,s:t.s,l:t.l}),c({h:(r+180)%360,s:t.s,l:t.l}),c({h:(r+270)%360,s:t.s,l:t.l})]}function E(e){var t=c(e).toHsl();var r=t.h;return[c(e),c({h:(r+72)%360,s:t.s,l:t.l}),c({h:(r+216)%360,s:t.s,l:t.l})]}function L(e,t,r){t=t||6;r=r||30;var n=c(e).toHsl();var i=360/r;var a=[c(e)];for(n.h=(n.h-(i*t>>1)+720)%360;--t;){n.h=(n.h+i)%360;a.push(c(n))}return a}function I(e,t){t=t||6;var r=c(e).toHsv();var n=r.h,i=r.s,a=r.v;var o=[];var s=1/t;while(t--){o.push(c({h:n,s:i,v:a}));a=(a+s)%1}return o}c.mix=function(e,t,r){r=r===0?0:r||50;var n=c(e).toRgb();var i=c(t).toRgb();var a=r/100;var o={r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a};return c(o)};c.readability=function(e,r){var n=c(e);var i=c(r);return(t.max(n.getLuminance(),i.getLuminance())+.05)/(t.min(n.getLuminance(),i.getLuminance())+.05)};c.isReadable=function(e,t,r){var n=c.readability(e,t);var i,a;a=false;i=X(r);switch(i.level+i.size){case"AAsmall":case"AAAlarge":a=n>=4.5;break;case"AAlarge":a=n>=3;break;case"AAAsmall":a=n>=7;break}return a};c.mostReadable=function(e,t,r){var n=null;var i=0;var a;var o,s,l;r=r||{};o=r.includeFallbackColors;s=r.level;l=r.size;for(var u=0;u<t.length;u++){a=c.readability(e,t[u]);if(a>i){i=a;n=c(t[u])}}if(c.isReadable(e,n,{level:s,size:l})||!o){return n}else{r.includeFallbackColors=false;return c.mostReadable(e,["#fff","#000"],r)}};var P=c.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};var D=c.hexNames=O(P);function O(e){var t={};for(var r in e){if(e.hasOwnProperty(r)){t[e[r]]=r}}return t}function R(e){e=parseFloat(e);if(isNaN(e)||e<0||e>1){e=1}return e}function F(e,r){if(j(e)){e="100%"}var n=V(e);e=s(r,l(0,parseFloat(e)));if(n){e=parseInt(e*r,10)/100}if(t.abs(e-r)<1e-6){return 1}return e%r/parseFloat(r)}function B(e){return s(1,l(0,e))}function N(e){return parseInt(e,16)}function j(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function V(e){return typeof e==="string"&&e.indexOf("%")!=-1}function q(e){return e.length==1?"0"+e:""+e}function U(e){if(e<=1){e=e*100+"%"}return e}function Z(e){return t.round(parseFloat(e)*255).toString(16)}function H(e){return N(e)/255}var G=function(){var e="[-\\+]?\\d+%?";var t="[-\\+]?\\d*\\.\\d+%?";var r="(?:"+t+")|(?:"+e+")";var n="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";var i="[\\s|\\(]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")[,|\\s]+("+r+")\\s*\\)?";return{CSS_UNIT:new RegExp(r),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function $(e){return!!G.CSS_UNIT.exec(e)}function W(e){e=e.replace(n,"").replace(i,"").toLowerCase();var t=false;if(P[e]){e=P[e];t=true}else if(e=="transparent"){return{r:0,g:0,b:0,a:0,format:"name"}}var r;if(r=G.rgb.exec(e)){return{r:r[1],g:r[2],b:r[3]}}if(r=G.rgba.exec(e)){return{r:r[1],g:r[2],b:r[3],a:r[4]}}if(r=G.hsl.exec(e)){return{h:r[1],s:r[2],l:r[3]}}if(r=G.hsla.exec(e)){return{h:r[1],s:r[2],l:r[3],a:r[4]}}if(r=G.hsv.exec(e)){return{h:r[1],s:r[2],v:r[3]}}if(r=G.hsva.exec(e)){return{h:r[1],s:r[2],v:r[3],a:r[4]}}if(r=G.hex8.exec(e)){return{r:N(r[1]),g:N(r[2]),b:N(r[3]),a:H(r[4]),format:t?"name":"hex8"}}if(r=G.hex6.exec(e)){return{r:N(r[1]),g:N(r[2]),b:N(r[3]),format:t?"name":"hex"}}if(r=G.hex4.exec(e)){return{r:N(r[1]+""+r[1]),g:N(r[2]+""+r[2]),b:N(r[3]+""+r[3]),a:H(r[4]+""+r[4]),format:t?"name":"hex8"}}if(r=G.hex3.exec(e)){return{r:N(r[1]+""+r[1]),g:N(r[2]+""+r[2]),b:N(r[3]+""+r[3]),format:t?"name":"hex"}}return false}function X(e){var t,r;e=e||{level:"AA",size:"small"};t=(e.level||"AA").toUpperCase();r=(e.size||"small").toLowerCase();if(t!=="AA"&&t!=="AAA"){t="AA"}if(r!=="small"&&r!=="large"){r="small"}return{level:t,size:r}}if(typeof r!=="undefined"&&r.exports){r.exports=c}else if(typeof e==="function"&&e.amd){e(function(){return c})}else{window.tinycolor=c}})(Math)},{}],26:[function(e,t,r){"use strict";t.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:true},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:true}]},{}],27:[function(e,t,r){"use strict";var n=e("./arrow_paths");var i=e("../../plots/font_attributes");var a=e("../../plots/cartesian/constants");var o=e("../../plot_api/plot_template").templatedArray;t.exports=o("annotation",{visible:{valType:"boolean",dflt:true,editType:"calcIfAutorange+arraydraw"},text:{valType:"string",editType:"calcIfAutorange+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calcIfAutorange+arraydraw"},font:i({editType:"calcIfAutorange+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calcIfAutorange+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calcIfAutorange+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calcIfAutorange+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calcIfAutorange+arraydraw"},showarrow:{valType:"boolean",dflt:true,editType:"calcIfAutorange+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:n.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:n.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calcIfAutorange+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calcIfAutorange+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calcIfAutorange+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calcIfAutorange+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calcIfAutorange+arraydraw"},ax:{valType:"any",editType:"calcIfAutorange+arraydraw"},ay:{valType:"any",editType:"calcIfAutorange+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",a.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",a.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",a.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calcIfAutorange+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calcIfAutorange+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calcIfAutorange+arraydraw"},yref:{valType:"enumerated",values:["paper",a.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calcIfAutorange+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calcIfAutorange+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calcIfAutorange+arraydraw"},clicktoshow:{valType:"enumerated",values:[false,"onoff","onout"],dflt:false,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:i({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../plot_api/plot_template":195,"../../plots/cartesian/constants":210,"../../plots/font_attributes":231,"./arrow_paths":26}],28:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");var a=e("./draw").draw;t.exports=function e(t){var r=t._fullLayout,s=n.filterVisible(r.annotations);if(!s.length||!t._fullData.length)return;var l={};s.forEach(function(e){l[e.xref]=1;l[e.yref]=1});for(var u in l){var c=i.getFromId(t,u);if(c&&c.autorange){return n.syncOrAsync([a,o],t)}}};function o(e){var t=e._fullLayout;n.filterVisible(t.annotations).forEach(function(t){var r=i.getFromId(e,t.xref),n=i.getFromId(e,t.yref),a=3*t.arrowsize*t.arrowwidth||0,o=3*t.startarrowsize*t.arrowwidth||0;var s,l,u,c;if(r&&r.autorange){s=a+t.xshift;l=a-t.xshift;u=o+t.xshift;c=o-t.xshift;if(t.axref===t.xref){i.expand(r,[r.r2c(t.x)],{ppadplus:s,ppadminus:l});i.expand(r,[r.r2c(t.ax)],{ppadplus:Math.max(t._xpadplus,u),ppadminus:Math.max(t._xpadminus,c)})}else{u=t.ax?u+t.ax:u;c=t.ax?c-t.ax:c;i.expand(r,[r.r2c(t.x)],{ppadplus:Math.max(t._xpadplus,s,u),ppadminus:Math.max(t._xpadminus,l,c)})}}if(n&&n.autorange){s=a-t.yshift;l=a+t.yshift;u=o-t.yshift;c=o+t.yshift;if(t.ayref===t.yref){i.expand(n,[n.r2c(t.y)],{ppadplus:s,ppadminus:l});i.expand(n,[n.r2c(t.ay)],{ppadplus:Math.max(t._ypadplus,u),ppadminus:Math.max(t._ypadminus,c)})}else{u=t.ay?u+t.ay:u;c=t.ay?c-t.ay:c;i.expand(n,[n.r2c(t.y)],{ppadplus:Math.max(t._ypadplus,s,u),ppadminus:Math.max(t._ypadminus,l,c)})}}})}},{"../../lib":161,"../../plots/cartesian/axes":205,"./draw":33}],29:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../registry");var a=e("../../plot_api/plot_template").arrayEditor;t.exports={hasClickToShow:o,onClick:s};function o(e,t){var r=l(e,t);return r.on.length>0||r.explicitOff.length>0}function s(e,t){var r=l(e,t);var o=r.on;var s=r.off.concat(r.explicitOff);var u={};var c=e._fullLayout.annotations;var f,h;if(!(o.length||s.length))return;for(f=0;f<o.length;f++){h=a(e.layout,"annotations",c[o[f]]);h.modifyItem("visible",true);n.extendFlat(u,h.getUpdateObj())}for(f=0;f<s.length;f++){h=a(e.layout,"annotations",c[s[f]]);h.modifyItem("visible",false);n.extendFlat(u,h.getUpdateObj())}return i.call("update",e,{},u)}function l(e,t){var r=e._fullLayout.annotations,n=[],i=[],a=[],o=(t||[]).length;var s,l,c,f,h,p,d,v;for(s=0;s<r.length;s++){c=r[s];f=c.clicktoshow;if(f){for(l=0;l<o;l++){h=t[l];p=h.xaxis;d=h.yaxis;if(p._id===c.xref&&d._id===c.yref&&p.d2r(h.x)===u(c._xclick,p)&&d.d2r(h.y)===u(c._yclick,d)){if(c.visible){if(f==="onout")v=i;else v=a}else{v=n}v.push(s);break}}if(l===o){if(c.visible&&f==="onout")i.push(s)}}}return{on:n,off:i,explicitOff:a}}function u(e,t){return t.type==="log"?t.l2r(e):t.d2r(e)}},{"../../lib":161,"../../plot_api/plot_template":195,"../../registry":253}],30:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../color");t.exports=function e(t,r,a,o){o("opacity");var s=o("bgcolor");var l=o("bordercolor");var u=i.opacity(l);o("borderpad");var c=o("borderwidth");var f=o("showarrow");o("text",f?" ":a._dfltTitle.annotation);o("textangle");n.coerceFont(o,"font",a.font);o("width");o("align");var h=o("height");if(h)o("valign");if(f){var p=o("arrowside");var d;var v;if(p.indexOf("end")!==-1){d=o("arrowhead");v=o("arrowsize")}if(p.indexOf("start")!==-1){o("startarrowhead",d);o("startarrowsize",v)}o("arrowcolor",u?r.bordercolor:i.defaultLine);o("arrowwidth",(u&&c||1)*2);o("standoff");o("startstandoff")}var m=o("hovertext");var g=a.hoverlabel||{};if(m){var y=o("hoverlabel.bgcolor",g.bgcolor||(i.opacity(s)?i.rgb(s):i.defaultLine));var _=o("hoverlabel.bordercolor",g.bordercolor||i.contrast(y));n.coerceFont(o,"hoverlabel.font",{family:g.font.family,size:g.font.size,color:g.font.color||_})}o("captureevents",!!m)}},{"../../lib":161,"../color":42}],31:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib/to_log_range");t.exports=function e(t,r,a,o){r=r||{};var s=a==="log"&&r.type==="linear",l=a==="linear"&&r.type==="log";if(!(s||l))return;var u=t._fullLayout.annotations,c=r._id.charAt(0),f,h;function p(e){var t=f[e],a=null;if(s)a=i(t,r.range);else a=Math.pow(10,t);if(!n(a))a=null;o(h+e,a)}for(var d=0;d<u.length;d++){f=u[d];h="annotations["+d+"].";if(f[c+"ref"]===r._id)p(c);if(f["a"+c+"ref"]===r._id)p("a"+c)}}},{"../../lib/to_log_range":184,"fast-isnumeric":9}],32:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");var a=e("../../plots/array_container_defaults");var o=e("./common_defaults");var s=e("./attributes");t.exports=function e(t,r){a(t,r,{name:"annotations",handleItemDefaults:l})};function l(e,t,r){function a(r,i){return n.coerce(e,t,s,r,i)}var l=a("visible");var u=a("clicktoshow");if(!(l||u))return;o(e,t,r,a);var c=t.showarrow;var f=["x","y"],h=[-10,-30],p={_fullLayout:r};for(var d=0;d<2;d++){var v=f[d];var m=i.coerceRef(e,t,p,v,"","paper");i.coercePosition(t,p,a,m,v,.5);if(c){var g="a"+v,y=i.coerceRef(e,t,p,g,"pixel");if(y!=="pixel"&&y!==m){y=t[g]="pixel"}var _=y==="pixel"?h[d]:.4;i.coercePosition(t,p,a,y,g,_)}a(v+"anchor");a(v+"shift")}n.noneOrAll(e,t,["x","y"]);if(c){n.noneOrAll(e,t,["ax","ay"])}if(u){var x=a("xclick");var b=a("yclick");t._xclick=x===undefined?t.x:i.cleanPosition(x,p,t.xref);t._yclick=b===undefined?t.y:i.cleanPosition(b,p,t.yref)}}},{"../../lib":161,"../../plots/array_container_defaults":201,"../../plots/cartesian/axes":205,"./attributes":27,"./common_defaults":30}],33:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../plots/plots");var o=e("../../lib");var s=e("../../plots/cartesian/axes");var l=e("../color");var u=e("../drawing");var c=e("../fx");var f=e("../../lib/svg_text_utils");var h=e("../../lib/setcursor");var p=e("../dragelement");var d=e("../../plot_api/plot_template").arrayEditor;var v=e("./draw_arrow_head");t.exports={draw:m,drawOne:g,drawRaw:y};function m(e){var t=e._fullLayout;t._infolayer.selectAll(".annotation").remove();for(var r=0;r<t.annotations.length;r++){if(t.annotations[r].visible){g(e,r)}}return a.previousPromises(e)}function g(e,t){var r=e._fullLayout;var n=r.annotations[t]||{};var i=s.getFromId(e,n.xref);var a=s.getFromId(e,n.yref);y(e,n,t,false,i,a)}function y(e,t,r,a,s,m){var g=e._fullLayout;var y=e._fullLayout._size;var _=e._context.edits;var x,b;if(a){x="annotation-"+a;b=a+".annotations"}else{x="annotation";b="annotations"}var w=d(e.layout,b,t);var k=w.modifyBase;var A=w.modifyItem;var T=w.getUpdateObj;g._infolayer.selectAll("."+x+'[data-index="'+r+'"]').remove();var M="clip"+g._uid+"_ann"+r;if(!t._input||t.visible===false){n.selectAll("#"+M).remove();return}var S={x:{},y:{}},C=+t.textangle||0;var z=g._infolayer.append("g").classed(x,true).attr("data-index",String(r)).style("opacity",t.opacity);var E=z.append("g").classed("annotation-text-g",true);var L=_[t.showarrow?"annotationTail":"annotationPosition"];var I=t.captureevents||_.annotationText||L;var P=E.append("g").style("pointer-events",I?"all":null).call(h,"pointer").on("click",function(){e._dragging=false;var i={index:r,annotation:t._input,fullAnnotation:t,event:n.event};if(a){i.subplotId=a}e.emit("plotly_clickannotation",i)});if(t.hovertext){P.on("mouseover",function(){var r=t.hoverlabel;var n=r.font;var i=this.getBoundingClientRect();var a=e.getBoundingClientRect();c.loneHover({x0:i.left-a.left,x1:i.right-a.left,y:(i.top+i.bottom)/2-a.top,text:t.hovertext,color:r.bgcolor,borderColor:r.bordercolor,fontFamily:n.family,fontSize:n.size,fontColor:n.color},{container:g._hoverlayer.node(),outerContainer:g._paper.node(),gd:e})}).on("mouseout",function(){c.loneUnhover(g._hoverlayer.node())})}var D=t.borderwidth,O=t.borderpad,R=D+O;var F=P.append("rect").attr("class","bg").style("stroke-width",D+"px").call(l.stroke,t.bordercolor).call(l.fill,t.bgcolor);var B=t.width||t.height;var N=g._topclips.selectAll("#"+M).data(B?[0]:[]);N.enter().append("clipPath").classed("annclip",true).attr("id",M).append("rect");N.exit().remove();var j=t.font;var V=P.append("text").classed("annotation-text",true).text(t.text);function q(r){r.call(u.font,j).attr({"text-anchor":{left:"start",right:"end"}[t.align]||"middle"});f.convertToTspans(r,e,U);return r}function U(){var r=V.selectAll("a");if(r.size()===1&&r.text()===V.text()){var n=P.insert("a",":first-child").attr({"xlink:xlink:href":r.attr("xlink:href"),"xlink:xlink:show":r.attr("xlink:show")}).style({cursor:"pointer"});n.node().appendChild(F.node())}var c=P.select(".annotation-text-math-group");var d=!c.empty();var x=u.bBox((d?c:V).node());var b=x.width;var w=x.height;var I=t.width||b;var O=t.height||w;var j=Math.round(I+2*R);var q=Math.round(O+2*R);t._w=I;t._h=O;function U(e,t){if(t==="auto"){if(e<1/3)t="left";else if(e>2/3)t="right";else t="center"}return{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[t]}var Z=false;var H=["x","y"];for(var G=0;G<H.length;G++){var $=H[G],W=t[$+"ref"]||$,X=t["a"+$+"ref"],Y={x:s,y:m}[$],J=(C+($==="x"?0:-90))*Math.PI/180,K=j*Math.cos(J),Q=q*Math.sin(J),ee=Math.abs(K)+Math.abs(Q),te=t[$+"anchor"],re=t[$+"shift"]*($==="x"?1:-1),ne=S[$],ie,ae,oe,se,le;if(Y){var ue=Y.r2fraction(t[$]);if((e._dragging||!Y.autorange)&&(ue<0||ue>1)){if(X===W){ue=Y.r2fraction(t["a"+$]);if(ue<0||ue>1){Z=true}}else{Z=true}if(Z)continue}ie=Y._offset+Y.r2p(t[$]);se=.5}else{if($==="x"){oe=t[$];ie=y.l+y.w*oe}else{oe=1-t[$];ie=y.t+y.h*oe}se=t.showarrow?.5:oe}if(t.showarrow){ne.head=ie;var ce=t["a"+$];le=K*U(.5,t.xanchor)-Q*U(.5,t.yanchor);if(X===W){ne.tail=Y._offset+Y.r2p(ce);ae=le}else{ne.tail=ie+ce;ae=le+ce}ne.text=ne.tail+le;var fe=g[$==="x"?"width":"height"];if(W==="paper"){ne.head=o.constrain(ne.head,1,fe-1)}if(X==="pixel"){var he=-Math.max(ne.tail-3,ne.text),pe=Math.min(ne.tail+3,ne.text)-fe;if(he>0){ne.tail+=he;ne.text+=he}else if(pe>0){ne.tail-=pe;ne.text-=pe}}ne.tail+=re;ne.head+=re}else{le=ee*U(se,te);ae=le;ne.text=ie+le}ne.text+=re;le+=re;ae+=re;t["_"+$+"padplus"]=ee/2+ae;t["_"+$+"padminus"]=ee/2-ae;t["_"+$+"size"]=ee;t["_"+$+"shift"]=le}if(Z){P.remove();return}var de=0;var ve=0;if(t.align!=="left"){de=(I-b)*(t.align==="center"?.5:1)}if(t.valign!=="top"){ve=(O-w)*(t.valign==="middle"?.5:1)}if(d){c.select("svg").attr({x:R+de-1,y:R+ve}).call(u.setClipUrl,B?M:null)}else{var me=R+ve-x.top;var ge=R+de-x.left;V.call(f.positionText,ge,me).call(u.setClipUrl,B?M:null)}N.select("rect").call(u.setRect,R,R,I,O);F.call(u.setRect,D/2,D/2,j-D,q-D);P.call(u.setTranslate,Math.round(S.x.text-j/2),Math.round(S.y.text-q/2));E.attr({transform:"rotate("+C+","+S.x.text+","+S.y.text+")"});var ye=function(r,n){z.selectAll(".annotation-arrow-g").remove();var c=S.x.head,f=S.y.head,h=S.x.tail+r,d=S.y.tail+n,g=S.x.text+r,x=S.y.text+n,b=o.rotationXYMatrix(C,g,x),w=o.apply2DTransform(b),M=o.apply2DTransform2(b),L=+F.attr("width"),I=+F.attr("height"),D=g-.5*L,O=D+L,R=x-.5*I,B=R+I,N=[[D,R,D,B],[D,B,O,B],[O,B,O,R],[O,R,D,R]].map(M);if(N.reduce(function(e,t){return e^!!o.segmentsIntersect(c,f,c+1e6,f+1e6,t[0],t[1],t[2],t[3])},false)){return}N.forEach(function(e){var t=o.segmentsIntersect(h,d,c,f,e[0],e[1],e[2],e[3]);if(t){h=t.x;d=t.y}});var j=t.arrowwidth,V=t.arrowcolor,q=t.arrowside;var U=z.append("g").style({opacity:l.opacity(V)}).classed("annotation-arrow-g",true);var Z=U.append("path").attr("d","M"+h+","+d+"L"+c+","+f).style("stroke-width",j+"px").call(l.stroke,l.rgb(V));v(Z,q,t);if(_.annotationPosition&&Z.node().parentNode&&!a){var H=c;var G=f;if(t.standoff){var $=Math.sqrt(Math.pow(c-h,2)+Math.pow(f-d,2));H+=t.standoff*(h-c)/$;G+=t.standoff*(d-f)/$}var W=U.append("path").classed("annotation-arrow",true).classed("anndrag",true).classed("cursor-move",true).attr({d:"M3,3H-3V-3H3ZM0,0L"+(h-H)+","+(d-G),transform:"translate("+H+","+G+")"}).style("stroke-width",j+6+"px").call(l.stroke,"rgba(0,0,0,0)").call(l.fill,"rgba(0,0,0,0)");var X,Y;p.init({element:W.node(),gd:e,prepFn:function(){var e=u.getTranslate(P);X=e.x;Y=e.y;if(s&&s.autorange){k(s._name+".autorange",true)}if(m&&m.autorange){k(m._name+".autorange",true)}},moveFn:function(e,r){var n=w(X,Y),i=n[0]+e,a=n[1]+r;P.call(u.setTranslate,i,a);A("x",s?s.p2r(s.r2p(t.x)+e):t.x+e/y.w);A("y",m?m.p2r(m.r2p(t.y)+r):t.y-r/y.h);if(t.axref===t.xref){A("ax",s.p2r(s.r2p(t.ax)+e))}if(t.ayref===t.yref){A("ay",m.p2r(m.r2p(t.ay)+r))}U.attr("transform","translate("+e+","+r+")");E.attr({transform:"rotate("+C+","+i+","+a+")"})},doneFn:function(){i.call("relayout",e,T());var t=document.querySelector(".js-notes-box-panel");if(t)t.redraw(t.selectedObj)}})}};if(t.showarrow)ye(0,0);if(L){var _e;p.init({element:P.node(),gd:e,prepFn:function(){_e=E.attr("transform")},moveFn:function(e,r){var n="pointer";if(t.showarrow){if(t.axref===t.xref){A("ax",s.p2r(s.r2p(t.ax)+e))}else{A("ax",t.ax+e)}if(t.ayref===t.yref){A("ay",m.p2r(m.r2p(t.ay)+r))}else{A("ay",t.ay+r)}ye(e,r)}else if(!a){var i,o;if(s){i=s.p2r(s.r2p(t.x)+e)}else{var l=t._xsize/y.w,u=t.x+(t._xshift-t.xshift)/y.w-l/2;i=p.align(u+e/y.w,l,0,1,t.xanchor)}if(m){o=m.p2r(m.r2p(t.y)+r)}else{var c=t._ysize/y.h,f=t.y-(t._yshift+t.yshift)/y.h-c/2;o=p.align(f-r/y.h,c,0,1,t.yanchor)}A("x",i);A("y",o);if(!s||!m){n=p.getCursor(s?.5:i,m?.5:o,t.xanchor,t.yanchor)}}else return;E.attr({transform:"translate("+e+","+r+")"+_e});h(P,n)},doneFn:function(){h(P);i.call("relayout",e,T());var t=document.querySelector(".js-notes-box-panel");if(t)t.redraw(t.selectedObj)}})}}if(_.annotationText){V.call(f.makeEditable,{delegate:P,gd:e}).call(q).on("edit",function(r){t.text=r;this.call(q);A("text",r);if(s&&s.autorange){k(s._name+".autorange",true)}if(m&&m.autorange){k(m._name+".autorange",true)}i.call("relayout",e,T())})}else V.call(q)}},{"../../lib":161,"../../lib/setcursor":180,"../../lib/svg_text_utils":182,"../../plot_api/plot_template":195,"../../plots/cartesian/axes":205,"../../plots/plots":244,"../../registry":253,"../color":42,"../dragelement":64,"../drawing":67,"../fx":84,"./draw_arrow_head":34,d3:6}],34:[function(e,t,r){"use strict";var n=e("d3");var i=e("../color");var a=e("./arrow_paths");t.exports=function e(t,r,o){var s=t.node();var l=a[o.arrowhead||0];var u=a[o.startarrowhead||0];var c=(o.arrowwidth||1)*(o.arrowsize||1);var f=(o.arrowwidth||1)*(o.startarrowsize||1);var h=r.indexOf("start")>=0;var p=r.indexOf("end")>=0;var d=l.backoff*c+o.standoff;var v=u.backoff*f+o.startstandoff;var m,g,y,_;if(s.nodeName==="line"){m={x:+t.attr("x1"),y:+t.attr("y1")};g={x:+t.attr("x2"),y:+t.attr("y2")};var x=m.x-g.x;var b=m.y-g.y;y=Math.atan2(b,x);_=y+Math.PI;if(d&&v){if(d+v>Math.sqrt(x*x+b*b)){P();return}}if(d){if(d*d>x*x+b*b){P();return}var w=d*Math.cos(y),k=d*Math.sin(y);g.x+=w;g.y+=k;t.attr({x2:g.x,y2:g.y})}if(v){if(v*v>x*x+b*b){P();return}var A=v*Math.cos(y),T=v*Math.sin(y);m.x-=A;m.y-=T;t.attr({x1:m.x,y1:m.y})}}else if(s.nodeName==="path"){var M=s.getTotalLength(),S="";if(M<d+v){P();return}var C=s.getPointAtLength(0);var z=s.getPointAtLength(.1);y=Math.atan2(C.y-z.y,C.x-z.x);m=s.getPointAtLength(Math.min(v,M));S="0px,"+v+"px,";var E=s.getPointAtLength(M);var L=s.getPointAtLength(M-.1);_=Math.atan2(E.y-L.y,E.x-L.x);g=s.getPointAtLength(Math.max(0,M-d));var I=S?v+d:d;S+=M-I+"px,"+M+"px";t.style("stroke-dasharray",S)}function P(){t.style("stroke-dasharray","0px,100px")}function D(e,r,a,l){if(!e.path)return;if(e.noRotate)a=0;n.select(s.parentNode).append("path").attr({class:t.attr("class"),d:e.path,transform:"translate("+r.x+","+r.y+")"+(a?"rotate("+a*180/Math.PI+")":"")+"scale("+l+")"}).style({fill:i.rgb(o.arrowcolor),"stroke-width":0})}if(h)D(u,m,y,f);if(p)D(l,g,_,c)}},{"../color":42,"./arrow_paths":26,d3:6}],35:[function(e,t,r){"use strict";var n=e("./draw");var i=e("./click");t.exports={moduleType:"component",name:"annotations",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("annotations"),calcAutorange:e("./calc_autorange"),draw:n.draw,drawOne:n.drawOne,drawRaw:n.drawRaw,hasClickToShow:i.hasClickToShow,onClick:i.onClick,convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":215,"./attributes":27,"./calc_autorange":28,"./click":29,"./convert_coords":31,"./defaults":32,"./draw":33}],36:[function(e,t,r){"use strict";var n=e("../annotations/attributes");var i=e("../../plot_api/edit_types").overrideAll;var a=e("../../plot_api/plot_template").templatedArray;t.exports=i(a("annotation",{visible:n.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:n.xanchor,xshift:n.xshift,yanchor:n.yanchor,yshift:n.yshift,text:n.text,textangle:n.textangle,font:n.font,width:n.width,height:n.height,opacity:n.opacity,align:n.align,valign:n.valign,bgcolor:n.bgcolor,bordercolor:n.bordercolor,borderpad:n.borderpad,borderwidth:n.borderwidth,showarrow:n.showarrow,arrowcolor:n.arrowcolor,arrowhead:n.arrowhead,startarrowhead:n.startarrowhead,arrowside:n.arrowside,arrowsize:n.arrowsize,startarrowsize:n.startarrowsize,arrowwidth:n.arrowwidth,standoff:n.standoff,startstandoff:n.startstandoff,hovertext:n.hovertext,hoverlabel:n.hoverlabel,captureevents:n.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":188,"../../plot_api/plot_template":195,"../annotations/attributes":27}],37:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");t.exports=function e(t){var r=t.fullSceneLayout;var n=r.annotations;for(var i=0;i<n.length;i++){a(n[i],t)}t.fullLayout._infolayer.selectAll(".annotation-"+t.id).remove()};function a(e,t){var r=t.fullSceneLayout;var a=r.domain;var o=t.fullLayout._size;var s={pdata:null,type:"linear",autorange:false,range:[-Infinity,Infinity]};e._xa={};n.extendFlat(e._xa,s);i.setConvert(e._xa);e._xa._offset=o.l+a.x[0]*o.w;e._xa.l2p=function(){return.5*(1+e._pdata[0]/e._pdata[3])*o.w*(a.x[1]-a.x[0])};e._ya={};n.extendFlat(e._ya,s);i.setConvert(e._ya);e._ya._offset=o.t+(1-a.y[1])*o.h;e._ya.l2p=function(){return.5*(1-e._pdata[1]/e._pdata[3])*o.h*(a.y[1]-a.y[0])}}},{"../../lib":161,"../../plots/cartesian/axes":205}],38:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");var a=e("../../plots/array_container_defaults");var o=e("../annotations/common_defaults");var s=e("./attributes");t.exports=function e(t,r,n){a(t,r,{name:"annotations",handleItemDefaults:l,fullLayout:n.fullLayout})};function l(e,t,r,a){function l(r,i){return n.coerce(e,t,s,r,i)}function u(e){var n=e+"axis";var a={_fullLayout:{}};a._fullLayout[n]=r[n];return i.coercePosition(t,a,l,e,e,.5)}var c=l("visible");if(!c)return;o(e,t,a.fullLayout,l);u("x");u("y");u("z");n.noneOrAll(e,t,["x","y","z"]);t.xref="x";t.yref="y";t.zref="z";l("xanchor");l("yanchor");l("xshift");l("yshift");if(t.showarrow){t.axref="pixel";t.ayref="pixel";l("ax",-10);l("ay",-30);n.noneOrAll(e,t,["ax","ay"])}}},{"../../lib":161,"../../plots/array_container_defaults":201,"../../plots/cartesian/axes":205,"../annotations/common_defaults":30,"./attributes":36}],39:[function(e,t,r){"use strict";var n=e("../annotations/draw").drawRaw;var i=e("../../plots/gl3d/project");var a=["x","y","z"];t.exports=function e(t){var r=t.fullSceneLayout;var o=t.dataScale;var s=r.annotations;for(var l=0;l<s.length;l++){var u=s[l];var c=false;for(var f=0;f<3;f++){var h=a[f];var p=u[h];var d=r[h+"axis"];var v=d.r2fraction(p);if(v<0||v>1){c=true;break}}if(c){t.fullLayout._infolayer.select(".annotation-"+t.id+'[data-index="'+l+'"]').remove()}else{u._pdata=i(t.glplot.cameraParams,[r.xaxis.r2l(u.x)*o[0],r.yaxis.r2l(u.y)*o[1],r.zaxis.r2l(u.z)*o[2]]);n(t.graphDiv,u,l,t.id,u._xa,u._ya)}}}},{"../../plots/gl3d/project":234,"../annotations/draw":33}],40:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");t.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),includeBasePlot:a,convert:e("./convert"),draw:e("./draw")};function a(e,t){var r=n.subplotsRegistry.gl3d;if(!r)return;var a=r.attrRegex;var o=Object.keys(e);for(var s=0;s<o.length;s++){var l=o[s];if(a.test(l)&&(e[l].annotations||[]).length){i.pushUnique(t._basePlotModules,r);i.pushUnique(t._subplots.gl3d,l)}}}},{"../../lib":161,"../../registry":253,"./attributes":36,"./convert":37,"./defaults":38,"./draw":39}],41:[function(e,t,r){"use strict";r.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];r.defaultLine="#444";r.lightLine="#eee";r.background="#fff";r.borderLine="#BEC8D9";r.lightFraction=100*(14-4)/(15-4)},{}],42:[function(e,t,r){"use strict";var n=e("tinycolor2");var i=e("fast-isnumeric");var a=t.exports={};var o=e("./attributes");a.defaults=o.defaults;var s=a.defaultLine=o.defaultLine;a.lightLine=o.lightLine;var l=a.background=o.background;a.tinyRGB=function(e){var t=e.toRgb();return"rgb("+Math.round(t.r)+", "+Math.round(t.g)+", "+Math.round(t.b)+")"};a.rgb=function(e){return a.tinyRGB(n(e))};a.opacity=function(e){return e?n(e).getAlpha():0};a.addOpacity=function(e,t){var r=n(e).toRgb();return"rgba("+Math.round(r.r)+", "+Math.round(r.g)+", "+Math.round(r.b)+", "+t+")"};a.combine=function(e,t){var r=n(e).toRgb();if(r.a===1)return n(e).toRgbString();var i=n(t||l).toRgb(),a=i.a===1?i:{r:255*(1-i.a)+i.r*i.a,g:255*(1-i.a)+i.g*i.a,b:255*(1-i.a)+i.b*i.a},o={r:a.r*(1-r.a)+r.r*r.a,g:a.g*(1-r.a)+r.g*r.a,b:a.b*(1-r.a)+r.b*r.a};return n(o).toRgbString()};a.contrast=function(e,t,r){var i=n(e);if(i.getAlpha()!==1)i=n(a.combine(e,l));var o=i.isDark()?t?i.lighten(t):l:r?i.darken(r):s;return o.toString()};a.stroke=function(e,t){var r=n(t);e.style({stroke:a.tinyRGB(r),"stroke-opacity":r.getAlpha()})};a.fill=function(e,t){var r=n(t);e.style({fill:a.tinyRGB(r),"fill-opacity":r.getAlpha()})};a.clean=function(e){if(!e||typeof e!=="object")return;var t=Object.keys(e),r,n,i,o;for(r=0;r<t.length;r++){i=t[r];o=e[i];if(i.substr(i.length-5)==="color"){if(Array.isArray(o)){for(n=0;n<o.length;n++)o[n]=u(o[n])}else e[i]=u(o)}else if(i.substr(i.length-10)==="colorscale"&&Array.isArray(o)){for(n=0;n<o.length;n++){if(Array.isArray(o[n]))o[n][1]=u(o[n][1])}}else if(Array.isArray(o)){var s=o[0];if(!Array.isArray(s)&&s&&typeof s==="object"){for(n=0;n<o.length;n++)a.clean(o[n])}}else if(o&&typeof o==="object")a.clean(o)}};function u(e){if(i(e)||typeof e!=="string")return e;var t=e.trim();if(t.substr(0,3)!=="rgb")return e;var r=t.match(/^rgba?\s*\(([^()]*)\)$/);if(!r)return e;var n=r[1].trim().split(/\s*[\s,]\s*/),a=t.charAt(3)==="a"&&n.length===4;if(!a&&n.length!==3)return e;for(var o=0;o<n.length;o++){if(!n[o].length)return e;n[o]=Number(n[o]);if(!(n[o]>=0))return e;if(o===3){if(n[o]>1)n[o]=1}else if(n[o]>=1)return e}var s=Math.round(n[0]*255)+", "+Math.round(n[1]*255)+", "+Math.round(n[2]*255);if(a)return"rgba("+s+", "+n[3]+")";return"rgb("+s+")"}},{"./attributes":41,"fast-isnumeric":9,tinycolor2:25}],43:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/layout_attributes");var i=e("../../plots/font_attributes");var a=e("../../lib/extend").extendFlat;var o=e("../../plot_api/edit_types").overrideAll;t.exports=o({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:n.linecolor,outlinewidth:n.linewidth,bordercolor:n.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:a({},n.ticks,{dflt:""}),ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,showticklabels:n.showticklabels,tickfont:i({}),tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,separatethousands:n.separatethousands,exponentformat:n.exponentformat,showexponent:n.showexponent,title:{valType:"string"},titlefont:i({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},"colorbars","from-root")},{"../../lib/extend":154,"../../plot_api/edit_types":188,"../../plots/cartesian/layout_attributes":217,"../../plots/font_attributes":231}],44:[function(e,t,r){"use strict";var n=e("../colorscale");var i=e("./draw");t.exports=function e(t,r,a){if(typeof a==="function")return a(t,r);var o=r[0].trace;var s="cb"+o.uid;var l=a.container;var u=l?o[l]:o;t._fullLayout._infolayer.selectAll("."+s).remove();if(!u||!u.showscale)return;var c=u[a.min];var f=u[a.max];var h=r[0].t.cb=i(t,s);var p=n.makeColorScaleFunc(n.extractScale(u.colorscale,c,f),{noNumericCheck:true});h.fillcolor(p).filllevels({start:c,end:f,size:(f-c)/254}).options(u.colorbar)()}},{"../colorscale":57,"./draw":47}],45:[function(e,t,r){"use strict";t.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],46:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plot_api/plot_template");var a=e("../../plots/cartesian/tick_value_defaults");var o=e("../../plots/cartesian/tick_mark_defaults");var s=e("../../plots/cartesian/tick_label_defaults");var l=e("./attributes");t.exports=function e(t,r,u){var c=i.newContainer(r,"colorbar"),f=t.colorbar||{};function h(e,t){return n.coerce(f,c,l,e,t)}var p=h("thicknessmode");h("thickness",p==="fraction"?30/(u.width-u.margin.l-u.margin.r):30);var d=h("lenmode");h("len",d==="fraction"?1:u.height-u.margin.t-u.margin.b);h("x");h("xanchor");h("xpad");h("y");h("yanchor");h("ypad");n.noneOrAll(f,c,["x","y"]);h("outlinecolor");h("outlinewidth");h("bordercolor");h("borderwidth");h("bgcolor");a(f,c,h,"linear");var v={outerTicks:false,font:u.font};s(f,c,h,"linear",v);o(f,c,h,"linear",v);h("title",u._dfltTitle.colorbar);n.coerceFont(h,"titlefont",u.font);h("titleside")}},{"../../lib":161,"../../plot_api/plot_template":195,"../../plots/cartesian/tick_label_defaults":224,"../../plots/cartesian/tick_mark_defaults":225,"../../plots/cartesian/tick_value_defaults":226,"./attributes":43}],47:[function(e,t,r){"use strict";var n=e("d3");var i=e("tinycolor2");var a=e("../../plots/plots");var o=e("../../registry");var s=e("../../plots/cartesian/axes");var l=e("../dragelement");var u=e("../../lib");var c=e("../../lib/extend").extendFlat;var f=e("../../lib/setcursor");var h=e("../drawing");var p=e("../color");var d=e("../titles");var v=e("../../lib/svg_text_utils");var m=e("../../constants/alignment");var g=m.LINE_SPACING;var y=m.FROM_TL;var _=m.FROM_BR;var x=e("../../plots/cartesian/axis_defaults");var b=e("../../plots/cartesian/position_defaults");var w=e("../../plots/cartesian/layout_attributes");var k=e("./attributes");var A=e("./constants").cn;t.exports=function e(t,r){var m={};Object.keys(k).forEach(function(e){m[e]=null});m.fillcolor=null;m.line={color:null,width:null,dash:null};m.levels={start:null,end:null,size:null};m.filllevels=null;function T(){var e=t._fullLayout,k=e._size;if(typeof m.fillcolor!=="function"&&typeof m.line.color!=="function"){e._infolayer.selectAll("g."+r).remove();return}var S=n.extent((typeof m.fillcolor==="function"?m.fillcolor:m.line.color).domain());var C=[];var z=[];var E=typeof m.line.color==="function"?m.line.color:function(){return m.line.color};var L=typeof m.fillcolor==="function"?m.fillcolor:function(){return m.fillcolor};var I;var P;var D=m.levels.end+m.levels.size/100,O=m.levels.size,R=1.001*S[0]-.001*S[1],F=1.001*S[1]-.001*S[0];for(P=0;P<1e5;P++){I=m.levels.start+P*O;if(O>0?I>=D:I<=D)break;if(I>R&&I<F)C.push(I)}if(typeof m.fillcolor==="function"){if(m.filllevels){D=m.filllevels.end+m.filllevels.size/100;O=m.filllevels.size;for(P=0;P<1e5;P++){I=m.filllevels.start+P*O;if(O>0?I>=D:I<=D)break;if(I>S[0]&&I<S[1])z.push(I)}}else{z=C.map(function(e){return e-m.levels.size/2});z.push(z[z.length-1]+m.levels.size)}}else if(m.fillcolor&&typeof m.fillcolor==="string"){z=[0]}if(m.levels.size<0){C.reverse();z.reverse()}var B=k.h,N=k.w,j=Math.round(m.thickness*(m.thicknessmode==="fraction"?N:1)),V=j/k.w,q=Math.round(m.len*(m.lenmode==="fraction"?B:1)),U=q/k.h,Z=m.xpad/k.w,H=(m.borderwidth+m.outlinewidth)/2,G=m.ypad/k.h,$=Math.round(m.x*k.w+m.xpad),W=m.x-V*({middle:.5,right:1}[m.xanchor]||0),X=m.y+U*(({top:-.5,bottom:.5}[m.yanchor]||0)-.5),Y=Math.round(k.h*(1-X)),J=Y-q,K,Q={type:"linear",range:S,tickmode:m.tickmode,nticks:m.nticks,tick0:m.tick0,dtick:m.dtick,tickvals:m.tickvals,ticktext:m.ticktext,ticks:m.ticks,ticklen:m.ticklen,tickwidth:m.tickwidth,tickcolor:m.tickcolor,showticklabels:m.showticklabels,tickfont:m.tickfont,tickangle:m.tickangle,tickformat:m.tickformat,exponentformat:m.exponentformat,separatethousands:m.separatethousands,showexponent:m.showexponent,showtickprefix:m.showtickprefix,tickprefix:m.tickprefix,showticksuffix:m.showticksuffix,ticksuffix:m.ticksuffix,title:m.title,titlefont:m.titlefont,showline:true,anchor:"free",position:1},ee={type:"linear",_id:"y"+r},te={letter:"y",font:e.font,noHover:true,calendar:e.calendar};function re(e,t){return u.coerce(Q,ee,w,e,t)}x(Q,ee,re,te,e);b(Q,ee,re,te);ee.position=m.x+Z+V;T.axis=ee;if(["top","bottom"].indexOf(m.titleside)!==-1){ee.titleside=m.titleside;ee.titlex=m.x+Z;ee.titley=X+(m.titleside==="top"?U-G:G)}if(m.line.color&&m.tickmode==="auto"){ee.tickmode="linear";ee.tick0=m.levels.start;var ne=m.levels.size;var ie=u.constrain((Y-J)/50,4,15)+1,ae=(S[1]-S[0])/((m.nticks||ie)*ne);if(ae>1){var oe=Math.pow(10,Math.floor(Math.log(ae)/Math.LN10));ne*=oe*u.roundUp(ae/oe,[2,5,10]);if((Math.abs(m.levels.start)/m.levels.size+1e-6)%1<2e-6){ee.tick0=0}}ee.dtick=ne}ee.domain=[X+G,X+U-G];ee.setScale();var se=u.ensureSingle(e._infolayer,"g",r,function(e){e.classed(A.colorbar,true).each(function(){var e=n.select(this);e.append("rect").classed(A.cbbg,true);e.append("g").classed(A.cbfills,true);e.append("g").classed(A.cblines,true);e.append("g").classed(A.cbaxis,true).classed(A.crisp,true);e.append("g").classed(A.cbtitleunshift,true).append("g").classed(A.cbtitle,true);e.append("rect").classed(A.cboutline,true);e.select(".cbtitle").datum(0)})});se.attr("transform","translate("+Math.round(k.l)+","+Math.round(k.t)+")");var le=se.select(".cbtitleunshift").attr("transform","translate(-"+Math.round(k.l)+",-"+Math.round(k.t)+")");ee._axislayer=se.select(".cbaxis");var ue=0;if(["top","bottom"].indexOf(m.titleside)!==-1){var ce=k.l+(m.x+Z)*k.w,fe=ee.titlefont.size,he;if(m.titleside==="top"){he=(1-(X+U-G))*k.h+k.t+3+fe*.75}else{he=(1-(X+G))*k.h+k.t-3-fe*.25}de(ee._id+"title",{attributes:{x:ce,y:he,"text-anchor":"start"}})}function pe(){if(["top","bottom"].indexOf(m.titleside)!==-1){var r=se.select(".cbtitle"),a=r.select("text"),o=[-m.outlinewidth/2,m.outlinewidth/2],l=r.select(".h"+ee._id+"title-math-group").node(),c=15.6;if(a.node()){c=parseInt(a.node().style.fontSize,10)*g}if(l){ue=h.bBox(l).height;if(ue>c){o[1]-=(ue-c)/2}}else if(a.node()&&!a.classed(A.jsPlaceholder)){ue=h.bBox(a.node()).height}if(ue){ue+=5;if(m.titleside==="top"){ee.domain[1]-=ue/k.h;o[1]*=-1}else{ee.domain[0]+=ue/k.h;var f=v.lineCount(a);o[1]+=(1-f)*c}r.attr("transform","translate("+o+")");ee.setScale()}}se.selectAll(".cbfills,.cblines").attr("transform","translate(0,"+Math.round(k.h*(1-ee.domain[1]))+")");ee._axislayer.attr("transform","translate(0,"+Math.round(-k.t)+")");var p=se.select(".cbfills").selectAll("rect.cbfill").data(z);p.enter().append("rect").classed(A.cbfill,true).style("stroke","none");p.exit().remove();p.each(function(e,t){var r=[t===0?S[0]:(z[t]+z[t-1])/2,t===z.length-1?S[1]:(z[t]+z[t+1])/2].map(ee.c2p).map(Math.round);if(t!==z.length-1){r[1]+=r[1]>r[0]?1:-1}var a=L(e).replace("e-",""),o=i(a).toHexString();n.select(this).attr({x:$,width:Math.max(j,2),y:n.min(r),height:Math.max(n.max(r)-n.min(r),2),fill:o})});var d=se.select(".cblines").selectAll("path.cbline").data(m.line.color&&m.line.width?C:[]);d.enter().append("path").classed(A.cbline,true);d.exit().remove();d.each(function(e){n.select(this).attr("d","M"+$+","+(Math.round(ee.c2p(e))+m.line.width/2%1)+"h"+j).call(h.lineGroupStyle,m.line.width,E(e),m.line.dash)});ee._axislayer.selectAll("g."+ee._id+"tick,path").remove();ee._pos=$+j+(m.outlinewidth||0)/2-(m.ticks==="outside"?1:0);ee.side="right";return u.syncOrAsync([function(){return s.doTicksSingle(t,ee,true)},function(){if(["top","bottom"].indexOf(m.titleside)===-1){var r=ee.titlefont.size,i=ee._offset+ee._length/2,a=k.l+(ee.position||0)*k.w+(ee.side==="right"?10+r*(ee.showticklabels?1:.5):-10-r*(ee.showticklabels?.5:0));de("h"+ee._id+"title",{avoid:{selection:n.select(t).selectAll("g."+ee._id+"tick"),side:m.titleside,offsetLeft:k.l,offsetTop:0,maxShift:e.width},attributes:{x:a,y:i,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}}])}function de(r,n){var i=M();var a="colorbar.title";var o=i._module.colorbar.container;if(o)a=o+"."+a;var s={propContainer:ee,propName:a,traceIndex:i.index,placeholder:e._dfltTitle.colorbar,containerGroup:se.select(".cbtitle")};var l=r.charAt(0)==="h"?r.substr(1):"h"+r;se.selectAll("."+l+",."+l+"-math-group").remove();d.draw(t,r,c(s,n||{}))}function ve(){var e=j+m.outlinewidth/2+h.bBox(ee._axislayer.node()).width;K=le.select("text");if(K.node()&&!K.classed(A.jsPlaceholder)){var n=le.select(".h"+ee._id+"title-math-group").node(),i;if(n&&["top","bottom"].indexOf(m.titleside)!==-1){i=h.bBox(n).width}else{i=h.bBox(le.node()).right-$-k.l}e=Math.max(e,i)}var o=2*m.xpad+e+m.borderwidth+m.outlinewidth/2,s=Y-J;se.select(".cbbg").attr({x:$-m.xpad-(m.borderwidth+m.outlinewidth)/2,y:J-H,width:Math.max(o,2),height:Math.max(s+2*H,2)}).call(p.fill,m.bgcolor).call(p.stroke,m.bordercolor).style({"stroke-width":m.borderwidth});se.selectAll(".cboutline").attr({x:$,y:J+m.ypad+(m.titleside==="top"?ue:0),width:Math.max(j,2),height:Math.max(s-2*m.ypad-ue,2)}).call(p.stroke,m.outlinecolor).style({fill:"None","stroke-width":m.outlinewidth});var l=({center:.5,right:1}[m.xanchor]||0)*o;se.attr("transform","translate("+(k.l-l)+","+k.t+")");var u={};var c=y[m.yanchor];var f=_[m.yanchor];if(m.lenmode==="pixels"){u.y=m.y;u.t=s*c;u.b=s*f}else{u.t=u.b=0;u.yt=m.y+m.len*c;u.yb=m.y-m.len*f}var d=y[m.xanchor];var v=_[m.xanchor];if(m.thicknessmode==="pixels"){u.x=m.x;u.l=o*d;u.r=o*v}else{var g=o-j;u.l=g*d;u.r=g*v;u.xl=m.x-m.thickness*d;u.xr=m.x+m.thickness*v}a.autoMargin(t,r,u)}var me=u.syncOrAsync([a.previousPromises,pe,a.previousPromises,ve],t);if(me&&me.then)(t._promises||[]).push(me);if(t._context.edits.colorbarPosition){var ge,ye,_e;l.init({element:se.node(),gd:t,prepFn:function(){ge=se.attr("transform");f(se)},moveFn:function(e,t){se.attr("transform",ge+" "+"translate("+e+","+t+")");ye=l.align(W+e/k.w,V,0,1,m.xanchor);_e=l.align(X-t/k.h,U,0,1,m.yanchor);var r=l.getCursor(ye,_e,m.xanchor,m.yanchor);f(se,r)},doneFn:function(){f(se);if(ye!==undefined&&_e!==undefined){o.call("restyle",t,{"colorbar.x":ye,"colorbar.y":_e},M().index)}}})}return me}function M(){var e=r.substr(2),n,i;for(n=0;n<t._fullData.length;n++){i=t._fullData[n];if(i.uid===e)return i}}Object.keys(m).forEach(function(e){T[e]=function(t){if(!arguments.length)return m[e];m[e]=u.isPlainObject(m[e])?u.extendFlat(m[e],t):t;return T}});T.options=function(e){Object.keys(e).forEach(function(t){if(typeof T[t]==="function"){T[t](e[t])}});return T};T._opts=m;return T}},{"../../constants/alignment":140,"../../lib":161,"../../lib/extend":154,"../../lib/setcursor":180,"../../lib/svg_text_utils":182,"../../plots/cartesian/axes":205,"../../plots/cartesian/axis_defaults":207,"../../plots/cartesian/layout_attributes":217,"../../plots/cartesian/position_defaults":220,"../../plots/plots":244,"../../registry":253,"../color":42,"../dragelement":64,"../drawing":67,"../titles":133,"./attributes":43,"./constants":45,d3:6,tinycolor2:25}],48:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t){return n.isPlainObject(t.colorbar)}},{"../../lib":161}],49:[function(e,t,r){"use strict";var n=e("./scales.js");var i=Object.keys(n);function a(e){return"`"+e+"`"}t.exports=function e(t,r){t=t||"";r=r||{};var i=r.cLetter||"c";var o="onlyIfNumerical"in r?r.onlyIfNumerical:Boolean(t);var s="noScale"in r?r.noScale:t==="marker.line";var l="showScaleDflt"in r?r.showScaleDflt:i==="z";var u=typeof r.colorscaleDflt==="string"?n[r.colorscaleDflt]:null;var c=r.editTypeOverride||"";var f=t?t+".":"";var h,p;if("colorAttr"in r){h=r.colorAttr;p=r.colorAttr}else{h={z:"z",c:"color"}[i];p="in "+a(f+h)}var d=o?" Has an effect only if "+p+"is set to a numerical array.":"";var v=i+"auto";var m=i+"min";var g=i+"max";var y=a(f+m);var _=a(f+g);var x=y+" and "+_;var b={};b[m]=b[g]=undefined;var w={};w[v]=false;var k={};if(h==="color"){k.color={valType:"color",arrayOk:true,editType:c||"style"}}k[v]={valType:"boolean",dflt:true,editType:"calc",impliedEdits:b};k[m]={valType:"number",dflt:null,editType:c||"plot",impliedEdits:w};k[g]={valType:"number",dflt:null,editType:c||"plot",impliedEdits:w};k.colorscale={valType:"colorscale",editType:"calc",dflt:u,impliedEdits:{autocolorscale:false}};k.autocolorscale={valType:"boolean",dflt:r.autoColorDflt===false?false:true,editType:"calc",impliedEdits:{colorscale:undefined}};k.reversescale={valType:"boolean",dflt:false,editType:"calc"};if(!s){k.showscale={valType:"boolean",dflt:l,editType:"calc"}}return k}},{"./scales.js":61}],50:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./scales");var a=e("./flip_scale");t.exports=function e(t,r,o,s){var l=t;var u=t._input;var c=t._fullInput;var f=t.updateStyle;function h(e,r,n){if(n===undefined)n=r;if(f){f(t._input,o?o+"."+e:e,r)}else{u[e]=r}l[e]=n;if(c&&t!==t._fullInput){if(f){f(t._fullInput,o?o+"."+e:e,n)}else{c[e]=n}}}if(o){l=n.nestedProperty(l,o).get();u=n.nestedProperty(u,o).get();c=n.nestedProperty(c,o).get()||{}}var p=s+"auto";var d=s+"min";var v=s+"max";var m=l[p];var g=l[d];var y=l[v];var _=l.colorscale;if(m!==false||g===undefined){g=n.aggNums(Math.min,null,r)}if(m!==false||y===undefined){y=n.aggNums(Math.max,null,r)}if(g===y){g-=.5;y+=.5}h(d,g);h(v,y);h(p,m!==false||g===undefined&&y===undefined);if(l.autocolorscale){if(g*y<0)_=i.RdBu;else if(g>=0)_=i.Reds;else _=i.Blues;h("colorscale",_,l.reversescale?a(_):_);if(!u.autocolorscale){h("autocolorscale",false)}}}},{"../../lib":161,"./flip_scale":54,"./scales":61}],51:[function(e,t,r){"use strict";var n=e("./scales");t.exports=n.RdBu},{"./scales":61}],52:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");var a=e("../colorbar/has_colorbar");var o=e("../colorbar/defaults");var s=e("./is_valid_scale");var l=e("./flip_scale");t.exports=function e(t,r,u,c,f){var h=f.prefix,p=f.cLetter,d=h.slice(0,h.length-1),v=h?i.nestedProperty(t,d).get()||{}:t,m=h?i.nestedProperty(r,d).get()||{}:r,g=v[p+"min"],y=v[p+"max"],_=v.colorscale;var x=n(g)&&n(y)&&g<y;c(h+p+"auto",!x);c(h+p+"min");c(h+p+"max");var b;if(_!==undefined)b=!s(_);c(h+"autocolorscale",b);var w=c(h+"colorscale");var k=c(h+"reversescale");if(k)m.colorscale=l(w);if(h==="marker.line.")return;var A;if(h)A=a(v);var T=c(h+"showscale",A);if(T)o(v,m,u)}},{"../../lib":161,"../colorbar/defaults":46,"../colorbar/has_colorbar":48,"./flip_scale":54,"./is_valid_scale":58,"fast-isnumeric":9}],53:[function(e,t,r){"use strict";t.exports=function e(t,r,n){var i=t.length,a=new Array(i),o=new Array(i);for(var s=0;s<i;s++){var l=t[s];a[s]=r+l[0]*(n-r);o[s]=l[1]}return{domain:a,range:o}}},{}],54:[function(e,t,r){"use strict";t.exports=function e(t){var r=t.length,n=new Array(r),i;for(var a=r-1,o=0;a>=0;a--,o++){i=t[a];n[o]=[1-i[0],i[1]]}return n}},{}],55:[function(e,t,r){"use strict";var n=e("./scales");var i=e("./default_scale");var a=e("./is_valid_scale_array");t.exports=function e(t,r){if(!r)r=i;if(!t)return r;function o(){try{t=n[t]||JSON.parse(t)}catch(e){t=r}}if(typeof t==="string"){o();if(typeof t==="string")o()}if(!a(t))return r;return t}},{"./default_scale":51,"./is_valid_scale_array":59,"./scales":61}],56:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");var a=e("./is_valid_scale");t.exports=function e(t,r){var o=r?i.nestedProperty(t,r).get()||{}:t;var s=o.color;var l=false;if(i.isArrayOrTypedArray(s)){for(var u=0;u<s.length;u++){if(n(s[u])){l=true;break}}}return i.isPlainObject(o)&&(l||o.showscale===true||n(o.cmin)&&n(o.cmax)||a(o.colorscale)||i.isPlainObject(o.colorbar))}},{"../../lib":161,"./is_valid_scale":58,"fast-isnumeric":9}],57:[function(e,t,r){"use strict";r.scales=e("./scales");r.defaultScale=e("./default_scale");r.attributes=e("./attributes");r.handleDefaults=e("./defaults");r.calc=e("./calc");r.hasColorscale=e("./has_colorscale");r.isValidScale=e("./is_valid_scale");r.getScale=e("./get_scale");r.flipScale=e("./flip_scale");r.extractScale=e("./extract_scale");r.makeColorScaleFunc=e("./make_color_scale_func")},{"./attributes":49,"./calc":50,"./default_scale":51,"./defaults":52,"./extract_scale":53,"./flip_scale":54,"./get_scale":55,"./has_colorscale":56,"./is_valid_scale":58,"./make_color_scale_func":60,"./scales":61}],58:[function(e,t,r){"use strict";var n=e("./scales");var i=e("./is_valid_scale_array");t.exports=function e(t){if(n[t]!==undefined)return true;else return i(t)}},{"./is_valid_scale_array":59,"./scales":61}],59:[function(e,t,r){"use strict";var n=e("tinycolor2");t.exports=function e(t){var r=0;if(!Array.isArray(t)||t.length<2)return false;if(!t[0]||!t[t.length-1])return false;if(+t[0][0]!==0||+t[t.length-1][0]!==1)return false;for(var i=0;i<t.length;i++){var a=t[i];if(a.length!==2||+a[0]<r||!n(a[1]).isValid()){return false}r=+a[0]}return true}},{tinycolor2:25}],60:[function(e,t,r){"use strict";var n=e("d3");var i=e("tinycolor2");var a=e("fast-isnumeric");var o=e("../color");t.exports=function e(t,r){r=r||{};var l=t.domain,u=t.range,c=u.length,f=new Array(c);for(var h=0;h<c;h++){var p=i(u[h]).toRgb();f[h]=[p.r,p.g,p.b,p.a]}var d=n.scale.linear().domain(l).range(f).clamp(true);var v=r.noNumericCheck,m=r.returnArray,g;if(v&&m){g=d}else if(v){g=function(e){return s(d(e))}}else if(m){g=function(e){if(a(e))return d(e);else if(i(e).isValid())return e;else return o.defaultLine}}else{g=function(e){if(a(e))return s(d(e));else if(i(e).isValid())return e;else return o.defaultLine}}g.domain=d.domain;g.range=function(){return u};return g};function s(e){var t={r:e[0],g:e[1],b:e[2],a:e[3]};return i(t).toRgbString()}},{"../color":42,d3:6,"fast-isnumeric":9,tinycolor2:25}],61:[function(e,t,r){"use strict";t.exports={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]}},{}],62:[function(e,t,r){"use strict";t.exports=function e(t,r,n,i,a){var o=(t-n)/(i-n),s=o+r/(i-n),l=(o+s)/2;if(a==="left"||a==="bottom")return o;if(a==="center"||a==="middle")return l;if(a==="right"||a==="top")return s;if(o<2/3-l)return o;if(s>4/3-l)return s;return l}},{}],63:[function(e,t,r){"use strict";var n=e("../../lib");var i=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];t.exports=function e(t,r,a,o){if(a==="left")t=0;else if(a==="center")t=1;else if(a==="right")t=2;else t=n.constrain(Math.floor(t*3),0,2);if(o==="bottom")r=0;else if(o==="middle")r=1;else if(o==="top")r=2;else r=n.constrain(Math.floor(r*3),0,2);return i[r][t]}},{"../../lib":161}],64:[function(e,t,r){"use strict";var n=e("mouse-event-offset");var i=e("has-hover");var a=e("has-passive-events");var o=e("../../registry");var s=e("../../lib");var l=e("../../plots/cartesian/constants");var u=e("../../constants/interactions");var c=t.exports={};c.align=e("./align");c.getCursor=e("./cursor");var f=e("./unhover");c.unhover=f.wrapped;c.unhoverRaw=f.raw;c.init=function e(t){var r=t.gd;var n=1;var o=u.DBLCLICKDELAY;var f=t.element;var v,m,g,y,_,x,b,w;if(!r._mouseDownTime)r._mouseDownTime=0;f.style.pointerEvents="all";f.onmousedown=T;if(!a){f.ontouchstart=T}else{if(f._ontouchstart){f.removeEventListener("touchstart",f._ontouchstart)}f._ontouchstart=T;f.addEventListener("touchstart",T,{passive:false})}function k(e,t,r){if(Math.abs(e)<r)e=0;if(Math.abs(t)<r)t=0;return[e,t]}var A=t.clampFn||k;function T(e){e.preventDefault();r._dragged=false;r._dragging=true;var a=d(e);v=a[0];m=a[1];b=e.target;x=e;w=e.buttons===2||e.ctrlKey;g=(new Date).getTime();if(g-r._mouseDownTime<o){n+=1}else{n=1;r._mouseDownTime=g}if(t.prepFn)t.prepFn(e,v,m);if(i&&!w){_=h();_.style.cursor=window.getComputedStyle(f).cursor}else if(!i){_=document;y=window.getComputedStyle(document.documentElement).cursor;document.documentElement.style.cursor=window.getComputedStyle(f).cursor}document.addEventListener("mousemove",M);document.addEventListener("mouseup",S);document.addEventListener("touchmove",M);document.addEventListener("touchend",S);return}function M(e){e.preventDefault();var n=d(e);var i=t.minDrag||l.MINDRAG;var a=A(n[0]-v,n[1]-m,i);var o=a[0];var s=a[1];if(o||s){r._dragged=true;c.unhover(r)}if(r._dragged&&t.moveFn&&!w)t.moveFn(o,s);return}function S(e){document.removeEventListener("mousemove",M);document.removeEventListener("mouseup",S);document.removeEventListener("touchmove",M);document.removeEventListener("touchend",S);e.preventDefault();if(i){s.removeElement(_)}else if(y){_.documentElement.style.cursor=y;y=null}if(!r._dragging){r._dragged=false;return}r._dragging=false;if((new Date).getTime()-r._mouseDownTime>o){n=Math.max(n-1,1)}if(r._dragged){if(t.doneFn)t.doneFn()}else{if(t.clickFn)t.clickFn(n,x);if(!w){var a;try{a=new MouseEvent("click",e)}catch(t){var l=d(e);a=document.createEvent("MouseEvents");a.initMouseEvent("click",e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,l[0],l[1],e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget)}b.dispatchEvent(a)}}p(r);r._dragged=false;return}};function h(){var e=document.createElement("div");e.className="dragcover";var t=e.style;t.position="fixed";t.left=0;t.right=0;t.top=0;t.bottom=0;t.zIndex=999999999;t.background="none";document.body.appendChild(e);return e}c.coverSlip=h;function p(e){e._dragging=false;if(e._replotPending)o.call("plot",e)}function d(e){return n(e.changedTouches?e.changedTouches[0]:e,document.body)}},{"../../constants/interactions":141,"../../lib":161,"../../plots/cartesian/constants":210,"../../registry":253,"./align":62,"./cursor":63,"./unhover":65,"has-hover":11,"has-passive-events":12,"mouse-event-offset":15}],65:[function(e,t,r){"use strict";var n=e("../../lib/events");var i=e("../../lib/throttle");var a=e("../../lib/get_graph_div");var o=e("../fx/constants");var s=t.exports={};s.wrapped=function(e,t,r){e=a(e);if(e._fullLayout){i.clear(e._fullLayout._uid+o.HOVERID)}s.raw(e,t,r)};s.raw=function e(t,r){var i=t._fullLayout;var a=t._hoverdata;if(!r)r={};if(r.target&&n.triggerHandler(t,"plotly_beforehover",r)===false){return}i._hoverlayer.selectAll("g").remove();i._hoverlayer.selectAll("line").remove();i._hoverlayer.selectAll("circle").remove();t._hoverdata=undefined;if(r.target&&a){t.emit("plotly_unhover",{event:r,points:a})}}},{"../../lib/events":153,"../../lib/get_graph_div":159,"../../lib/throttle":183,"../fx/constants":79}],66:[function(e,t,r){"use strict";r.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"}},{}],67:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("tinycolor2");var o=e("../../registry");var s=e("../color");var l=e("../colorscale");var u=e("../../lib");var c=e("../../lib/svg_text_utils");var f=e("../../constants/xmlns_namespaces");var h=e("../../constants/alignment");var p=h.LINE_SPACING;var d=e("../../constants/interactions").DESELECTDIM;var v=e("../../traces/scatter/subtypes");var m=e("../../traces/scatter/make_bubble_size_func");var g=t.exports={};g.font=function(e,t,r,n){if(u.isPlainObject(t)){n=t.color;r=t.size;t=t.family}if(t)e.style("font-family",t);if(r+1)e.style("font-size",r+"px");if(n)e.call(s.fill,n)};g.setPosition=function(e,t,r){e.attr("x",t).attr("y",r)};g.setSize=function(e,t,r){e.attr("width",t).attr("height",r)};g.setRect=function(e,t,r,n,i){e.call(g.setPosition,t,r).call(g.setSize,n,i)};g.translatePoint=function(e,t,r,n){var a=r.c2p(e.x);var o=n.c2p(e.y);if(i(a)&&i(o)&&t.node()){if(t.node().nodeName==="text"){t.attr("x",a).attr("y",o)}else{t.attr("transform","translate("+a+","+o+")")}}else{return false}return true};g.translatePoints=function(e,t,r){e.each(function(e){var i=n.select(this);g.translatePoint(e,i,t,r)})};g.hideOutsideRangePoint=function(e,t,r,n,i,a){t.attr("display",r.isPtWithinRange(e,i)&&n.isPtWithinRange(e,a)?null:"none")};g.hideOutsideRangePoints=function(e,t){if(!t._hasClipOnAxisFalse)return;var r=t.xaxis;var i=t.yaxis;e.each(function(t){var a=t[0].trace;var o=a.xcalendar;var s=a.ycalendar;var l=a.type==="bar"?".bartext":".point,.textpoint";e.selectAll(l).each(function(e){g.hideOutsideRangePoint(e,n.select(this),r,i,o,s)})})};g.crispRound=function(e,t,r){if(!t||!i(t))return r||0;if(e._context.staticPlot)return t;if(t<1)return 1;return Math.round(t)};g.singleLineStyle=function(e,t,r,n,i){t.style("fill","none");var a=(((e||[])[0]||{}).trace||{}).line||{},o=r||a.width||0,l=i||a.dash||"";s.stroke(t,n||a.color);g.dashLine(t,l,o)};g.lineGroupStyle=function(e,t,r,i){e.style("fill","none").each(function(e){var a=(((e||[])[0]||{}).trace||{}).line||{},o=t||a.width||0,l=i||a.dash||"";n.select(this).call(s.stroke,r||a.color).call(g.dashLine,l,o)})};g.dashLine=function(e,t,r){r=+r||0;t=g.dashStyle(t,r);e.style({"stroke-dasharray":t,"stroke-width":r+"px"})};g.dashStyle=function(e,t){t=+t||1;var r=Math.max(t,3);if(e==="solid")e="";else if(e==="dot")e=r+"px,"+r+"px";else if(e==="dash")e=3*r+"px,"+3*r+"px";else if(e==="longdash")e=5*r+"px,"+5*r+"px";else if(e==="dashdot"){e=3*r+"px,"+r+"px,"+r+"px,"+r+"px"}else if(e==="longdashdot"){e=5*r+"px,"+2*r+"px,"+r+"px,"+2*r+"px"}return e};g.singleFillStyle=function(e){var t=n.select(e.node());var r=t.data();var i=(((r[0]||[])[0]||{}).trace||{}).fillcolor;if(i){e.call(s.fill,i)}};g.fillGroupStyle=function(e){e.style("stroke-width",0).each(function(t){var r=n.select(this);try{r.call(s.fill,t[0].trace.fillcolor)}catch(t){u.error(t,e);r.remove()}})};var y=e("./symbol_defs");g.symbolNames=[];g.symbolFuncs=[];g.symbolNeedLines={};g.symbolNoDot={};g.symbolNoFill={};g.symbolList=[];Object.keys(y).forEach(function(e){var t=y[e];g.symbolList=g.symbolList.concat([t.n,e,t.n+100,e+"-open"]);g.symbolNames[t.n]=e;g.symbolFuncs[t.n]=t.f;if(t.needLine){g.symbolNeedLines[t.n]=true}if(t.noDot){g.symbolNoDot[t.n]=true}else{g.symbolList=g.symbolList.concat([t.n+200,e+"-dot",t.n+300,e+"-open-dot"])}if(t.noFill){g.symbolNoFill[t.n]=true}});var _=g.symbolNames.length,x="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";g.symbolNumber=function(e){if(typeof e==="string"){var t=0;if(e.indexOf("-open")>0){t=100;e=e.replace("-open","")}if(e.indexOf("-dot")>0){t+=200;e=e.replace("-dot","")}e=g.symbolNames.indexOf(e);if(e>=0){e+=t}}if(e%100>=_||e>=400){return 0}return Math.floor(Math.max(e,0))};function b(e,t){var r=e%100;return g.symbolFuncs[r](t)+(e>=200?x:"")}var w={x1:1,x2:0,y1:0,y2:0};var k={x1:0,x2:0,y1:1,y2:0};g.gradient=function(e,t,r,i,o,l){var c=t._fullLayout._defs.select(".gradients").selectAll("#"+r).data([i+o+l],u.identity);c.exit().remove();c.enter().append(i==="radial"?"radialGradient":"linearGradient").each(function(){var e=n.select(this);if(i==="horizontal")e.attr(w);else if(i==="vertical")e.attr(k);e.attr("id",r);var t=a(o);var u=a(l);e.append("stop").attr({offset:"0%","stop-color":s.tinyRGB(u),"stop-opacity":u.getAlpha()});e.append("stop").attr({offset:"100%","stop-color":s.tinyRGB(t),"stop-opacity":t.getAlpha()})});e.style({fill:"url(#"+r+")","fill-opacity":null})};g.initGradients=function(e){var t=u.ensureSingle(e._fullLayout._defs,"g","gradients");t.selectAll("linearGradient,radialGradient").remove()};g.pointStyle=function(e,t,r){if(!e.size())return;var i=g.makePointStyleFns(t);e.each(function(e){g.singlePointStyle(e,n.select(this),t,i,r)})};g.singlePointStyle=function(e,t,r,n,i){var a=r.marker;var o=a.line;t.style("opacity",n.selectedOpacityFn?n.selectedOpacityFn(e):e.mo===undefined?a.opacity:e.mo);if(n.ms2mrc){var l;if(e.ms==="various"||a.size==="various"){l=3}else{l=n.ms2mrc(e.ms)}e.mrc=l;if(n.selectedSizeFn){l=e.mrc=n.selectedSizeFn(e)}var c=g.symbolNumber(e.mx||a.symbol)||0;e.om=c%200>=100;t.attr("d",b(c,l))}var f=false;var h,p,d;if(e.so){d=o.outlierwidth;p=o.outliercolor;h=a.outliercolor}else{var v=(o||{}).width;d=(e.mlw+1||v+1||(e.trace?(e.trace.marker.line||{}).width:0)+1)-1||0;if("mlc"in e)p=e.mlcc=n.lineScale(e.mlc);else if(u.isArrayOrTypedArray(o.color))p=s.defaultLine;else p=o.color;if(u.isArrayOrTypedArray(a.color)){h=s.defaultLine;f=true}if("mc"in e){h=e.mcc=n.markerScale(e.mc)}else{h=a.color||"rgba(0,0,0,0)"}if(n.selectedColorFn){h=n.selectedColorFn(e)}}if(e.om){t.call(s.stroke,h).style({"stroke-width":(d||1)+"px",fill:"none"})}else{t.style("stroke-width",d+"px");var m=a.gradient;var y=e.mgt;if(y)f=true;else y=m&&m.type;if(y&&y!=="none"){var _=e.mgc;if(_)f=true;else _=m.color;var x="g"+i._fullLayout._uid+"-"+r.uid;if(f)x+="-"+e.i;t.call(g.gradient,i,x,y,h,_)}else{t.call(s.fill,h)}if(d){t.call(s.stroke,p)}}};g.makePointStyleFns=function(e){var t={};var r=e.marker;t.markerScale=g.tryColorscale(r,"");t.lineScale=g.tryColorscale(r,"line");if(o.traceIs(e,"symbols")){t.ms2mrc=v.isBubble(e)?m(e):function(){return(r.size||6)/2}}if(e.selectedpoints){u.extendFlat(t,g.makeSelectedPointStyleFns(e))}return t};g.makeSelectedPointStyleFns=function(e){var t={};var r=e.selected||{};var n=e.unselected||{};var i=e.marker||{};var a=r.marker||{};var s=n.marker||{};var l=i.opacity;var c=a.opacity;var f=s.opacity;var h=c!==undefined;var p=f!==undefined;if(u.isArrayOrTypedArray(l)||h||p){t.selectedOpacityFn=function(e){var t=e.mo===undefined?i.opacity:e.mo;if(e.selected){return h?c:t}else{return p?f:d*t}}}var v=i.color;var m=a.color;var g=s.color;if(m||g){t.selectedColorFn=function(e){var t=e.mcc||v;if(e.selected){return m||t}else{return g||t}}}var y=i.size;var _=a.size;var x=s.size;var b=_!==undefined;var w=x!==undefined;if(o.traceIs(e,"symbols")&&(b||w)){t.selectedSizeFn=function(e){var t=e.mrc||y/2;if(e.selected){return b?_/2:t}else{return w?x/2:t}}}return t};g.makeSelectedTextStyleFns=function(e){var t={};var r=e.selected||{};var n=e.unselected||{};var i=e.textfont||{};var a=r.textfont||{};var o=n.textfont||{};var l=i.color;var u=a.color;var c=o.color;t.selectedTextColorFn=function(e){var t=e.tc||l;if(e.selected){return u||t}else{if(c)return c;else return u?t:s.addOpacity(t,d)}};return t};g.selectedPointStyle=function(e,t){if(!e.size()||!t.selectedpoints)return;var r=g.makeSelectedPointStyleFns(t);var i=t.marker||{};var a=[];if(r.selectedOpacityFn){a.push(function(e,t){e.style("opacity",r.selectedOpacityFn(t))})}if(r.selectedColorFn){a.push(function(e,t){s.fill(e,r.selectedColorFn(t))})}if(r.selectedSizeFn){a.push(function(e,t){var n=t.mx||i.symbol||0;var a=r.selectedSizeFn(t);e.attr("d",b(g.symbolNumber(n),a));t.mrc2=a})}if(a.length){e.each(function(e){var t=n.select(this);for(var r=0;r<a.length;r++){a[r](t,e)}})}};g.tryColorscale=function(e,t){var r=t?u.nestedProperty(e,t).get():e;if(r){var n=r.colorscale;var i=r.color;if(n&&u.isArrayOrTypedArray(i)){return l.makeColorScaleFunc(l.extractScale(n,r.cmin,r.cmax))}}return u.identity};var A={start:1,end:-1,middle:0,bottom:1,top:-1};function T(e,t,r,i){var a=n.select(e.node().parentNode);var o=t.indexOf("top")!==-1?"top":t.indexOf("bottom")!==-1?"bottom":"middle";var s=t.indexOf("left")!==-1?"end":t.indexOf("right")!==-1?"start":"middle";var l=i?i/.8+1:0;var u=(c.lineCount(e)-1)*p+1;var f=A[s]*l;var h=r*.75+A[o]*l+(A[o]-1)*u*r/2;e.attr("text-anchor",s);a.attr("transform","translate("+f+","+h+")")}function M(e,t){var r=e.ts||t.textfont.size;return i(r)&&r>0?r:0}g.textPointStyle=function(e,t,r){if(!e.size())return;var i;if(t.selectedpoints){var a=g.makeSelectedTextStyleFns(t);i=a.selectedTextColorFn}e.each(function(e){var a=n.select(this);var o=u.extractOption(e,t,"tx","text");if(!o&&o!==0){a.remove();return}var s=e.tp||t.textposition;var l=M(e,t);var f=i?i(e):e.tc||t.textfont.color;a.call(g.font,e.tf||t.textfont.family,l,f).text(o).call(c.convertToTspans,r).call(T,s,l,e.mrc)})};g.selectedTextStyle=function(e,t){if(!e.size()||!t.selectedpoints)return;var r=g.makeSelectedTextStyleFns(t);e.each(function(e){var i=n.select(this);var a=r.selectedTextColorFn(e);var o=e.tp||t.textposition;var l=M(e,t);s.fill(i,a);T(i,o,l,e.mrc2||e.mrc)})};var S=.5;g.smoothopen=function(e,t){if(e.length<3){return"M"+e.join("L")}var r="M"+e[0],n=[],i;for(i=1;i<e.length-1;i++){n.push(C(e[i-1],e[i],e[i+1],t))}r+="Q"+n[0][0]+" "+e[1];for(i=2;i<e.length-1;i++){r+="C"+n[i-2][1]+" "+n[i-1][0]+" "+e[i]}r+="Q"+n[e.length-3][1]+" "+e[e.length-1];return r};g.smoothclosed=function(e,t){if(e.length<3){return"M"+e.join("L")+"Z"}var r="M"+e[0],n=e.length-1,i=[C(e[n],e[0],e[1],t)],a;for(a=1;a<n;a++){i.push(C(e[a-1],e[a],e[a+1],t))}i.push(C(e[n-1],e[n],e[0],t));for(a=1;a<=n;a++){r+="C"+i[a-1][1]+" "+i[a][0]+" "+e[a]}r+="C"+i[n][1]+" "+i[0][0]+" "+e[0]+"Z";return r};function C(e,t,r,i){var a=e[0]-t[0],o=e[1]-t[1],s=r[0]-t[0],l=r[1]-t[1],u=Math.pow(a*a+o*o,S/2),c=Math.pow(s*s+l*l,S/2),f=(c*c*a-u*u*s)*i,h=(c*c*o-u*u*l)*i,p=3*c*(u+c),d=3*u*(u+c);return[[n.round(t[0]+(p&&f/p),2),n.round(t[1]+(p&&h/p),2)],[n.round(t[0]-(d&&f/d),2),n.round(t[1]-(d&&h/d),2)]]}var z={hv:function(e,t){return"H"+n.round(t[0],2)+"V"+n.round(t[1],2)},vh:function(e,t){return"V"+n.round(t[1],2)+"H"+n.round(t[0],2)},hvh:function(e,t){return"H"+n.round((e[0]+t[0])/2,2)+"V"+n.round(t[1],2)+"H"+n.round(t[0],2)},vhv:function(e,t){return"V"+n.round((e[1]+t[1])/2,2)+"H"+n.round(t[0],2)+"V"+n.round(t[1],2)}};var E=function(e,t){return"L"+n.round(t[0],2)+","+n.round(t[1],2)};g.steps=function(e){var t=z[e]||E;return function(e){var r="M"+n.round(e[0][0],2)+","+n.round(e[0][1],2);for(var i=1;i<e.length;i++){r+=t(e[i-1],e[i])}return r}};g.makeTester=function(){var e=u.ensureSingleById(n.select("body"),"svg","js-plotly-tester",function(e){e.attr(f.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})});var t=u.ensureSingle(e,"path","js-reference-point",function(e){e.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});g.tester=e;g.testref=t};g.savedBBoxes={};var L=0;var I=1e4;g.bBox=function(e,t,r){if(!r)r=P(e);var i;if(r){i=g.savedBBoxes[r];if(i)return u.extendFlat({},i)}else if(e.childNodes.length===1){var a=e.childNodes[0];r=P(a);if(r){var o=+a.getAttribute("x")||0;var s=+a.getAttribute("y")||0;var l=a.getAttribute("transform");if(!l){var f=g.bBox(a,false,r);if(o){f.left+=o;f.right+=o}if(s){f.top+=s;f.bottom+=s}return f}r+="~"+o+"~"+s+"~"+l;i=g.savedBBoxes[r];if(i)return u.extendFlat({},i)}}var h,p;if(t){h=e}else{p=g.tester.node();h=e.cloneNode(true);p.appendChild(h)}n.select(h).attr("transform",null).call(c.positionText,0,0);var d=h.getBoundingClientRect();var v=g.testref.node().getBoundingClientRect();if(!t)p.removeChild(h);var m={height:d.height,width:d.width,left:d.left-v.left,top:d.top-v.top,right:d.right-v.left,bottom:d.bottom-v.top};if(L>=I){g.savedBBoxes={};L=0}if(r)g.savedBBoxes[r]=m;L++;return u.extendFlat({},m)};function P(e){var t=e.getAttribute("data-unformatted");if(t===null)return;return t+e.getAttribute("data-math")+e.getAttribute("text-anchor")+e.getAttribute("style")}g.setClipUrl=function(e,t){if(!t){e.attr("clip-path",null);return}if(g.baseUrl===undefined){var r=n.select("base");if(r.size()&&r.attr("href")){g.baseUrl=window.location.href.split("#")[0]}else{g.baseUrl=""}}e.attr("clip-path","url("+g.baseUrl+"#"+t+")")};g.getTranslate=function(e){var t=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,r=e.attr?"attr":"getAttribute",n=e[r]("transform")||"";var i=n.replace(t,function(e,t,r){return[t,r].join(" ")}).split(" ");return{x:+i[0]||0,y:+i[1]||0}};g.setTranslate=function(e,t,r){var n=/(\btranslate\(.*?\);?)/,i=e.attr?"attr":"getAttribute",a=e.attr?"attr":"setAttribute",o=e[i]("transform")||"";t=t||0;r=r||0;o=o.replace(n,"").trim();o+=" translate("+t+", "+r+")";o=o.trim();e[a]("transform",o);return o};g.getScale=function(e){var t=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,r=e.attr?"attr":"getAttribute",n=e[r]("transform")||"";var i=n.replace(t,function(e,t,r){return[t,r].join(" ")}).split(" ");return{x:+i[0]||1,y:+i[1]||1}};g.setScale=function(e,t,r){var n=/(\bscale\(.*?\);?)/,i=e.attr?"attr":"getAttribute",a=e.attr?"attr":"setAttribute",o=e[i]("transform")||"";t=t||1;r=r||1;o=o.replace(n,"").trim();o+=" scale("+t+", "+r+")";o=o.trim();e[a]("transform",o);return o};var D=/\s*sc.*/;g.setPointGroupScale=function(e,t,r){t=t||1;r=r||1;if(!e)return;var n=t===1&&r===1?"":" scale("+t+","+r+")";e.each(function(){var e=(this.getAttribute("transform")||"").replace(D,"");e+=n;e=e.trim();this.setAttribute("transform",e)})};var O=/translate\([^)]*\)\s*$/;g.setTextPointsScale=function(e,t,r){if(!e)return;e.each(function(){var e;var i=n.select(this);var a=i.select("text");if(!a.node())return;var o=parseFloat(a.attr("x")||0);var s=parseFloat(a.attr("y")||0);var l=(i.attr("transform")||"").match(O);if(t===1&&r===1){e=[]}else{e=["translate("+o+","+s+")","scale("+t+","+r+")","translate("+-o+","+-s+")"]}if(l){e.push(l)}i.attr("transform",e.join(" "))})}},{"../../constants/alignment":140,"../../constants/interactions":141,"../../constants/xmlns_namespaces":144,"../../lib":161,"../../lib/svg_text_utils":182,"../../registry":253,"../../traces/scatter/make_bubble_size_func":281,"../../traces/scatter/subtypes":287,"../color":42,"../colorscale":57,"./symbol_defs":68,d3:6,"fast-isnumeric":9,tinycolor2:25}],68:[function(e,t,r){"use strict";var n=e("d3");t.exports={circle:{n:0,f:function(e){var t=n.round(e,2);return"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"}},square:{n:1,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"}},diamond:{n:2,f:function(e){var t=n.round(e*1.3,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"}},cross:{n:3,f:function(e){var t=n.round(e*.4,2),r=n.round(e*1.2,2);return"M"+r+","+t+"H"+t+"V"+r+"H-"+t+"V"+t+"H-"+r+"V-"+t+"H-"+t+"V-"+r+"H"+t+"V-"+t+"H"+r+"Z"}},x:{n:4,f:function(e){var t=n.round(e*.8/Math.sqrt(2),2),r="l"+t+","+t,i="l"+t+",-"+t,a="l-"+t+",-"+t,o="l-"+t+","+t;return"M0,"+t+r+i+a+i+a+o+a+o+r+o+r+"Z"}},"triangle-up":{n:5,f:function(e){var t=n.round(e*2/Math.sqrt(3),2),r=n.round(e/2,2),i=n.round(e,2);return"M-"+t+","+r+"H"+t+"L0,-"+i+"Z"}},"triangle-down":{n:6,f:function(e){var t=n.round(e*2/Math.sqrt(3),2),r=n.round(e/2,2),i=n.round(e,2);return"M-"+t+",-"+r+"H"+t+"L0,"+i+"Z"}},"triangle-left":{n:7,f:function(e){var t=n.round(e*2/Math.sqrt(3),2),r=n.round(e/2,2),i=n.round(e,2);return"M"+r+",-"+t+"V"+t+"L-"+i+",0Z"}},"triangle-right":{n:8,f:function(e){var t=n.round(e*2/Math.sqrt(3),2),r=n.round(e/2,2),i=n.round(e,2);return"M-"+r+",-"+t+"V"+t+"L"+i+",0Z"}},"triangle-ne":{n:9,f:function(e){var t=n.round(e*.6,2),r=n.round(e*1.2,2);return"M-"+r+",-"+t+"H"+t+"V"+r+"Z"}},"triangle-se":{n:10,f:function(e){var t=n.round(e*.6,2),r=n.round(e*1.2,2);return"M"+t+",-"+r+"V"+t+"H-"+r+"Z"}},"triangle-sw":{n:11,f:function(e){var t=n.round(e*.6,2),r=n.round(e*1.2,2);return"M"+r+","+t+"H-"+t+"V-"+r+"Z"}},"triangle-nw":{n:12,f:function(e){var t=n.round(e*.6,2),r=n.round(e*1.2,2);return"M-"+t+","+r+"V-"+t+"H"+r+"Z"}},pentagon:{n:13,f:function(e){var t=n.round(e*.951,2),r=n.round(e*.588,2),i=n.round(-e,2),a=n.round(e*-.309,2),o=n.round(e*.809,2);return"M"+t+","+a+"L"+r+","+o+"H-"+r+"L-"+t+","+a+"L0,"+i+"Z"}},hexagon:{n:14,f:function(e){var t=n.round(e,2),r=n.round(e/2,2),i=n.round(e*Math.sqrt(3)/2,2);return"M"+i+",-"+r+"V"+r+"L0,"+t+"L-"+i+","+r+"V-"+r+"L0,-"+t+"Z"}},hexagon2:{n:15,f:function(e){var t=n.round(e,2),r=n.round(e/2,2),i=n.round(e*Math.sqrt(3)/2,2);return"M-"+r+","+i+"H"+r+"L"+t+",0L"+r+",-"+i+"H-"+r+"L-"+t+",0Z"}},octagon:{n:16,f:function(e){var t=n.round(e*.924,2),r=n.round(e*.383,2);return"M-"+r+",-"+t+"H"+r+"L"+t+",-"+r+"V"+r+"L"+r+","+t+"H-"+r+"L-"+t+","+r+"V-"+r+"Z"}},star:{n:17,f:function(e){var t=e*1.4,r=n.round(t*.225,2),i=n.round(t*.951,2),a=n.round(t*.363,2),o=n.round(t*.588,2),s=n.round(-t,2),l=n.round(t*-.309,2),u=n.round(t*.118,2),c=n.round(t*.809,2),f=n.round(t*.382,2);return"M"+r+","+l+"H"+i+"L"+a+","+u+"L"+o+","+c+"L0,"+f+"L-"+o+","+c+"L-"+a+","+u+"L-"+i+","+l+"H-"+r+"L0,"+s+"Z"}},hexagram:{n:18,f:function(e){var t=n.round(e*.66,2),r=n.round(e*.38,2),i=n.round(e*.76,2);return"M-"+i+",0l-"+r+",-"+t+"h"+i+"l"+r+",-"+t+"l"+r+","+t+"h"+i+"l-"+r+","+t+"l"+r+","+t+"h-"+i+"l-"+r+","+t+"l-"+r+",-"+t+"h-"+i+"Z"}},"star-triangle-up":{n:19,f:function(e){var t=n.round(e*Math.sqrt(3)*.8,2),r=n.round(e*.8,2),i=n.round(e*1.6,2),a=n.round(e*4,2),o="A "+a+","+a+" 0 0 1 ";return"M-"+t+","+r+o+t+","+r+o+"0,-"+i+o+"-"+t+","+r+"Z"}},"star-triangle-down":{n:20,f:function(e){var t=n.round(e*Math.sqrt(3)*.8,2),r=n.round(e*.8,2),i=n.round(e*1.6,2),a=n.round(e*4,2),o="A "+a+","+a+" 0 0 1 ";return"M"+t+",-"+r+o+"-"+t+",-"+r+o+"0,"+i+o+t+",-"+r+"Z"}},"star-square":{n:21,f:function(e){var t=n.round(e*1.1,2),r=n.round(e*2,2),i="A "+r+","+r+" 0 0 1 ";return"M-"+t+",-"+t+i+"-"+t+","+t+i+t+","+t+i+t+",-"+t+i+"-"+t+",-"+t+"Z"}},"star-diamond":{n:22,f:function(e){var t=n.round(e*1.4,2),r=n.round(e*1.9,2),i="A "+r+","+r+" 0 0 1 ";return"M-"+t+",0"+i+"0,"+t+i+t+",0"+i+"0,-"+t+i+"-"+t+",0"+"Z"}},"diamond-tall":{n:23,f:function(e){var t=n.round(e*.7,2),r=n.round(e*1.4,2);return"M0,"+r+"L"+t+",0L0,-"+r+"L-"+t+",0Z"}},"diamond-wide":{n:24,f:function(e){var t=n.round(e*1.4,2),r=n.round(e*.7,2);return"M0,"+r+"L"+t+",0L0,-"+r+"L-"+t+",0Z"}},hourglass:{n:25,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"H-"+t+"L"+t+",-"+t+"H-"+t+"Z"},noDot:true},bowtie:{n:26,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"V-"+t+"L-"+t+","+t+"V-"+t+"Z"},noDot:true},"circle-cross":{n:27,f:function(e){var t=n.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:true,noDot:true},"circle-x":{n:28,f:function(e){var t=n.round(e,2),r=n.round(e/Math.sqrt(2),2);return"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r+"M"+t+",0A"+t+","+t+" 0 1,1 0,-"+t+"A"+t+","+t+" 0 0,1 "+t+",0Z"},needLine:true,noDot:true},"square-cross":{n:29,f:function(e){var t=n.round(e,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:true,noDot:true},"square-x":{n:30,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t+"M"+t+","+t+"H-"+t+"V-"+t+"H"+t+"Z"},needLine:true,noDot:true},"diamond-cross":{n:31,f:function(e){var t=n.round(e*1.3,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"+"M0,-"+t+"V"+t+"M-"+t+",0H"+t},needLine:true,noDot:true},"diamond-x":{n:32,f:function(e){var t=n.round(e*1.3,2),r=n.round(e*.65,2);return"M"+t+",0L0,"+t+"L-"+t+",0L0,-"+t+"Z"+"M-"+r+",-"+r+"L"+r+","+r+"M-"+r+","+r+"L"+r+",-"+r},needLine:true,noDot:true},"cross-thin":{n:33,f:function(e){var t=n.round(e*1.4,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t},needLine:true,noDot:true,noFill:true},"x-thin":{n:34,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t+"M"+t+",-"+t+"L-"+t+","+t},needLine:true,noDot:true,noFill:true},asterisk:{n:35,f:function(e){var t=n.round(e*1.2,2);var r=n.round(e*.85,2);return"M0,"+t+"V-"+t+"M"+t+",0H-"+t+"M"+r+","+r+"L-"+r+",-"+r+"M"+r+",-"+r+"L-"+r+","+r},needLine:true,noDot:true,noFill:true},hash:{n:36,f:function(e){var t=n.round(e/2,2),r=n.round(e,2);return"M"+t+","+r+"V-"+r+"m-"+r+",0V"+r+"M"+r+","+t+"H-"+r+"m0,-"+r+"H"+r},needLine:true,noFill:true},"y-up":{n:37,f:function(e){var t=n.round(e*1.2,2),r=n.round(e*1.6,2),i=n.round(e*.8,2);return"M-"+t+","+i+"L0,0M"+t+","+i+"L0,0M0,-"+r+"L0,0"},needLine:true,noDot:true,noFill:true},"y-down":{n:38,f:function(e){var t=n.round(e*1.2,2),r=n.round(e*1.6,2),i=n.round(e*.8,2);return"M-"+t+",-"+i+"L0,0M"+t+",-"+i+"L0,0M0,"+r+"L0,0"},needLine:true,noDot:true,noFill:true},"y-left":{n:39,f:function(e){var t=n.round(e*1.2,2),r=n.round(e*1.6,2),i=n.round(e*.8,2);return"M"+i+","+t+"L0,0M"+i+",-"+t+"L0,0M-"+r+",0L0,0"},needLine:true,noDot:true,noFill:true},"y-right":{n:40,f:function(e){var t=n.round(e*1.2,2),r=n.round(e*1.6,2),i=n.round(e*.8,2);return"M-"+i+","+t+"L0,0M-"+i+",-"+t+"L0,0M"+r+",0L0,0"},needLine:true,noDot:true,noFill:true},"line-ew":{n:41,f:function(e){var t=n.round(e*1.4,2);return"M"+t+",0H-"+t},needLine:true,noDot:true,noFill:true},"line-ns":{n:42,f:function(e){var t=n.round(e*1.4,2);return"M0,"+t+"V-"+t},needLine:true,noDot:true,noFill:true},"line-ne":{n:43,f:function(e){var t=n.round(e,2);return"M"+t+",-"+t+"L-"+t+","+t},needLine:true,noDot:true,noFill:true},"line-nw":{n:44,f:function(e){var t=n.round(e,2);return"M"+t+","+t+"L-"+t+",-"+t},needLine:true,noDot:true,noFill:true}}},{d3:6}],69:[function(e,t,r){"use strict";t.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],70:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../registry");var a=e("../../plots/cartesian/axes");var o=e("./compute_error");t.exports=function e(t){var r=t.calcdata;for(var n=0;n<r.length;n++){var o=r[n],l=o[0].trace;if(!i.traceIs(l,"errorBarsOK"))continue;var u=a.getFromId(t,l.xaxis),c=a.getFromId(t,l.yaxis);s(o,l,u,"x");s(o,l,c,"y")}};function s(e,t,r,i){var s=t["error_"+i]||{},l=s.visible&&["linear","log"].indexOf(r.type)!==-1,u=[];if(!l)return;var c=o(s);for(var f=0;f<e.length;f++){var h=e[f],p=h[i];if(!n(r.c2l(p)))continue;var d=c(p,f);if(n(d[0])&&n(d[1])){var v=h[i+"s"]=p-d[0],m=h[i+"h"]=p+d[1];u.push(v,m)}}a.expand(r,u,{padded:true})}},{"../../plots/cartesian/axes":205,"../../registry":253,"./compute_error":71,"fast-isnumeric":9}],71:[function(e,t,r){"use strict";t.exports=function e(t){var r=t.type,i=t.symmetric;if(r==="data"){var a=t.array||[];if(i){return function e(t,r){var n=+a[r];return[n,n]}}else{var o=t.arrayminus||[];return function e(t,r){var n=+a[r];var i=+o[r];if(!isNaN(n)||!isNaN(i)){return[i||0,n||0]}return[NaN,NaN]}}}else{var s=n(r,t.value),l=n(r,t.valueminus);if(i||t.valueminus===undefined){return function e(t){var r=s(t);return[r,r]}}else{return function e(t){return[l(t),s(t)]}}}};function n(e,t){if(e==="percent"){return function(e){return Math.abs(e*t/100)}}if(e==="constant"){return function(){return Math.abs(t)}}if(e==="sqrt"){return function(e){return Math.sqrt(Math.abs(e))}}}},{}],72:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../registry");var a=e("../../lib");var o=e("../../plot_api/plot_template");var s=e("./attributes");t.exports=function(e,t,r,l){var u="error_"+l.axis;var c=o.newContainer(t,u);var f=e[u]||{};function h(e,t){return a.coerce(f,c,s,e,t)}var p=f.array!==undefined||f.value!==undefined||f.type==="sqrt";var d=h("visible",p);if(d===false)return;var v=h("type","array"in f?"data":"percent"),m=true;if(v!=="sqrt"){m=h("symmetric",!((v==="data"?"arrayminus":"valueminus")in f))}if(v==="data"){h("array");h("traceref");if(!m){h("arrayminus");h("tracerefminus")}}else if(v==="percent"||v==="constant"){h("value");if(!m)h("valueminus")}var g="copy_"+l.inherit+"style";if(l.inherit){var y=t["error_"+l.inherit];if((y||{}).visible){h(g,!(f.color||n(f.thickness)||n(f.width)))}}if(!l.inherit||!c[g]){h("color",r);h("thickness");h("width",i.traceIs(t,"gl3d")?0:4)}}},{"../../lib":161,"../../plot_api/plot_template":195,"../../registry":253,"./attributes":69,"fast-isnumeric":9}],73:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plot_api/edit_types").overrideAll;var a=e("./attributes");var o={error_x:n.extendFlat({},a),error_y:n.extendFlat({},a)};delete o.error_x.copy_zstyle;delete o.error_y.copy_zstyle;delete o.error_y.copy_ystyle;var s={error_x:n.extendFlat({},a),error_y:n.extendFlat({},a),error_z:n.extendFlat({},a)};delete s.error_x.copy_ystyle;delete s.error_y.copy_ystyle;delete s.error_z.copy_ystyle;delete s.error_z.copy_zstyle;t.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:o,bar:o,histogram:o,scatter3d:i(s,"calc","nested"),scattergl:i(o,"calc","nested")}},supplyDefaults:e("./defaults"),calc:e("./calc"),makeComputeError:e("./compute_error"),plot:e("./plot"),style:e("./style"),hoverInfo:l};function l(e,t,r){if((t.error_y||{}).visible){r.yerr=e.yh-e.y;if(!t.error_y.symmetric)r.yerrneg=e.y-e.ys}if((t.error_x||{}).visible){r.xerr=e.xh-e.x;if(!t.error_x.symmetric)r.xerrneg=e.x-e.xs}}},{"../../lib":161,"../../plot_api/edit_types":188,"./attributes":69,"./calc":70,"./compute_error":71,"./defaults":72,"./plot":74,"./style":75}],74:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../drawing");var o=e("../../traces/scatter/subtypes");t.exports=function e(t,r,l){var u;var c=r.xaxis;var f=r.yaxis;var h=l&&l.duration>0;t.each(function(e){var t=e[0].trace,p=t.error_x||{},d=t.error_y||{};var v;if(t.ids){v=function(e){return e.id}}var m=o.hasMarkers(t)&&t.marker.maxdisplayed>0;if(!d.visible&&!p.visible)e=[];var g=n.select(this).selectAll("g.errorbar").data(e,v);g.exit().remove();if(!e.length)return;if(!p.visible)g.selectAll("path.xerror").remove();if(!d.visible)g.selectAll("path.yerror").remove();g.style("opacity",1);var y=g.enter().append("g").classed("errorbar",true);if(h){y.style("opacity",0).transition().duration(l.duration).style("opacity",1)}a.setClipUrl(g,r.layerClipId);g.each(function(e){var t=n.select(this);var r=s(e,c,f);if(m&&!e.vis)return;var a;var o=t.select("path.yerror");if(d.visible&&i(r.x)&&i(r.yh)&&i(r.ys)){var v=d.width;a="M"+(r.x-v)+","+r.yh+"h"+2*v+"m-"+v+",0V"+r.ys;if(!r.noYS)a+="m-"+v+",0h"+2*v;u=!o.size();if(u){o=t.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",true)}else if(h){o=o.transition().duration(l.duration).ease(l.easing)}o.attr("d",a)}else o.remove();var g=t.select("path.xerror");if(p.visible&&i(r.y)&&i(r.xh)&&i(r.xs)){var y=(p.copy_ystyle?d:p).width;a="M"+r.xh+","+(r.y-y)+"v"+2*y+"m0,-"+y+"H"+r.xs;if(!r.noXS)a+="m0,-"+y+"v"+2*y;u=!g.size();if(u){g=t.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",true)}else if(h){g=g.transition().duration(l.duration).ease(l.easing)}g.attr("d",a)}else g.remove()})})};function s(e,t,r){var n={x:t.c2p(e.x),y:r.c2p(e.y)};if(e.yh!==undefined){n.yh=r.c2p(e.yh);n.ys=r.c2p(e.ys);if(!i(n.ys)){n.noYS=true;n.ys=r.c2p(e.ys,true)}}if(e.xh!==undefined){n.xh=t.c2p(e.xh);n.xs=t.c2p(e.xs);if(!i(n.xs)){n.noXS=true;n.xs=t.c2p(e.xs,true)}}return n}},{"../../traces/scatter/subtypes":287,"../drawing":67,d3:6,"fast-isnumeric":9}],75:[function(e,t,r){"use strict";var n=e("d3");var i=e("../color");t.exports=function e(t){t.each(function(e){var t=e[0].trace,r=t.error_y||{},a=t.error_x||{};var o=n.select(this);o.selectAll("path.yerror").style("stroke-width",r.thickness+"px").call(i.stroke,r.color);if(a.copy_ystyle)a=r;o.selectAll("path.xerror").style("stroke-width",a.thickness+"px").call(i.stroke,a.color)})}},{"../color":42,d3:6}],76:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");t.exports={hoverlabel:{bgcolor:{valType:"color",arrayOk:true,editType:"none"},bordercolor:{valType:"color",arrayOk:true,editType:"none"},font:n({arrayOk:true,editType:"none"}),namelength:{valType:"integer",min:-1,arrayOk:true,editType:"none"},editType:"calc"}}},{"../../plots/font_attributes":231}],77:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../registry");t.exports=function e(t){var r=t.calcdata;var o=t._fullLayout;function s(e){return function(t){return n.coerceHoverinfo({hoverinfo:t},{_module:e._module},o)}}for(var l=0;l<r.length;l++){var u=r[l];var c=u[0].trace;if(i.traceIs(c,"pie"))continue;var f=i.traceIs(c,"2dMap")?a:n.fillArray;f(c.hoverinfo,u,"hi",s(c));if(!c.hoverlabel)continue;f(c.hoverlabel.bgcolor,u,"hbg");f(c.hoverlabel.bordercolor,u,"hbc");f(c.hoverlabel.font.size,u,"hts");f(c.hoverlabel.font.color,u,"htc");f(c.hoverlabel.font.family,u,"htf");f(c.hoverlabel.namelength,u,"hnl")}};function a(e,t,r,i){i=i||n.identity;if(Array.isArray(e)){t[0][r]=i(e)}}},{"../../lib":161,"../../registry":253}],78:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("./hover").hover;t.exports=function e(t,r,a){var o=n.getComponentMethod("annotations","onClick")(t,t._hoverdata);if(a!==undefined){i(t,r,a,true)}function s(){t.emit("plotly_click",{points:t._hoverdata,event:r})}if(t._hoverdata&&r&&r.target){if(o&&o.then){o.then(s)}else s();if(r.stopImmediatePropagation)r.stopImmediatePropagation()}}},{"../../registry":253,"./hover":82}],79:[function(e,t,r){"use strict";t.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],80:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./attributes");var a=e("./hoverlabel_defaults");t.exports=function e(t,r,o,s){function l(e,a){return n.coerce(t,r,i,e,a)}a(t,r,l,s.hoverlabel)}},{"../../lib":161,"./attributes":76,"./hoverlabel_defaults":83}],81:[function(e,t,r){"use strict";var n=e("../../lib");r.getSubplot=function e(t){return t.subplot||t.xaxis+t.yaxis||t.geo};r.isTraceInSubplots=function e(t,n){if(t.type==="splom"){var i=t.xaxes||[];var a=t.yaxes||[];for(var o=0;o<i.length;o++){for(var s=0;s<a.length;s++){if(n.indexOf(i[o]+a[s])!==-1){return true}}}return false}return n.indexOf(r.getSubplot(t))!==-1};r.flat=function e(t,r){var n=new Array(t.length);for(var i=0;i<t.length;i++){n[i]=r}return n};r.p2c=function e(t,r){var n=new Array(t.length);for(var i=0;i<t.length;i++){n[i]=t[i].p2c(r)}return n};r.getDistanceFunction=function e(t,n,i,a){if(t==="closest")return a||r.quadrature(n,i);return t==="x"?n:i};r.getClosest=function e(t,r,n){if(n.index!==false){if(n.index>=0&&n.index<t.length){n.distance=0}else n.index=false}else{for(var i=0;i<t.length;i++){var a=r(t[i]);if(a<=n.distance){n.index=i;n.distance=a}}}return n};r.inbox=function e(t,r,n){return t*r<0||t===0?n:Infinity};r.quadrature=function e(t,r){return function(e){var n=t(e),i=r(e);return Math.sqrt(n*n+i*i)}};r.makeEventData=function e(t,n,i){var a="index"in t?t.index:t.pointNumber;var o={data:n._input,fullData:n,curveNumber:n.index,pointNumber:a};if(n._indexToPoints){var s=n._indexToPoints[a];if(s.length===1){o.pointIndex=s[0]}else{o.pointIndices=s}}else{o.pointIndex=a}if(n._module.eventData){o=n._module.eventData(o,t,n,i,a)}else{if("xVal"in t)o.x=t.xVal;else if("x"in t)o.x=t.x;if("yVal"in t)o.y=t.yVal;else if("y"in t)o.y=t.y;if(t.xa)o.xaxis=t.xa;if(t.ya)o.yaxis=t.ya;if(t.zLabelVal!==undefined)o.z=t.zLabelVal}r.appendArrayPointValue(o,n,a);return o};r.appendArrayPointValue=function(e,t,r){var i=t._arrayAttrs;if(!i){return}for(var s=0;s<i.length;s++){var l=i[s];var u=a(l);if(e[u]===undefined){var c=n.nestedProperty(t,l).get();var f=o(c,r);if(f!==undefined)e[u]=f}}};r.appendArrayMultiPointValues=function(e,t,r){var i=t._arrayAttrs;if(!i){return}for(var s=0;s<i.length;s++){var l=i[s];var u=a(l);if(e[u]===undefined){var c=n.nestedProperty(t,l).get();var f=new Array(r.length);for(var h=0;h<r.length;h++){f[h]=o(c,r[h])}e[u]=f}}};var i={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color"};function a(e){return i[e]||e}function o(e,t){if(Array.isArray(t)){if(Array.isArray(e)&&Array.isArray(e[t[0]])){return e[t[0]][t[1]]}}else{return e[t]}}},{"../../lib":161}],82:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("tinycolor2");var o=e("../../lib");var s=e("../../lib/events");var l=e("../../lib/svg_text_utils");var u=e("../../lib/override_cursor");var c=e("../drawing");var f=e("../color");var h=e("../dragelement");var p=e("../../plots/cartesian/axes");var d=e("../../registry");var v=e("./helpers");var m=e("./constants");var g=m.YANGLE;var y=Math.PI*g/180;var _=1/Math.sin(y);var x=Math.cos(y);var b=Math.sin(y);var w=m.HOVERARROWSIZE;var k=m.HOVERTEXTPAD;r.hover=function e(t,r,n,i){t=o.getGraphDiv(t);o.throttle(t._fullLayout._uid+m.HOVERID,m.HOVERMINTIME,function(){A(t,r,n,i)})};r.loneHover=function e(t,r){var i={color:t.color||f.defaultLine,x0:t.x0||t.x||0,x1:t.x1||t.x||0,y0:t.y0||t.y||0,y1:t.y1||t.y||0,xLabel:t.xLabel,yLabel:t.yLabel,zLabel:t.zLabel,text:t.text,name:t.name,idealAlign:t.idealAlign,borderColor:t.borderColor,fontFamily:t.fontFamily,fontSize:t.fontSize,fontColor:t.fontColor,trace:{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0};var a=n.select(r.container),o=r.outerContainer?n.select(r.outerContainer):a;var s={hovermode:"closest",rotateLabels:false,bgColor:r.bgColor||f.background,container:a,outerContainer:o};var l=T([i],s,r.gd);S(l,s.rotateLabels);return l.node()};function A(e,t,r,a){if(!r)r="xy";var l=Array.isArray(r)?r:[r];var c=e._fullLayout;var m=c._plots||[];var g=m[r];var y=c._has("cartesian");if(g){var _=g.overlays.map(function(e){return e.id});l=l.concat(_)}var x=l.length;var b=new Array(x);var w=new Array(x);var k=false;for(var A=0;A<x;A++){var I=l[A];var P=m[I];if(P){k=true;b[A]=p.getFromId(e,P.xaxis._id);w[A]=p.getFromId(e,P.yaxis._id);continue}var D=c[I]._subplot;b[A]=D.xaxis;w[A]=D.yaxis}var O=t.hovermode||c.hovermode;if(O&&!k)O="closest";if(["x","y","closest"].indexOf(O)===-1||!e.calcdata||e.querySelector(".zoombox")||e._dragging){return h.unhoverRaw(e,t)}var R=c.hoverdistance===-1?Infinity:c.hoverdistance;var F=c.spikedistance===-1?Infinity:c.spikedistance;var B=[],N=[],j,V,q,U,Z,H,G,$,W,X,Y,J,K,Q={hLinePoint:null,vLinePoint:null};if(Array.isArray(t)){O="array";for(q=0;q<t.length;q++){Z=e.calcdata[t[q].curveNumber||0];if(Z[0].trace.hoverinfo!=="skip"){N.push(Z)}}}else{for(U=0;U<e.calcdata.length;U++){Z=e.calcdata[U];H=Z[0].trace;if(H.hoverinfo!=="skip"&&v.isTraceInSubplots(H,l)){N.push(Z)}}var ee=!t.target,te,re;if(ee){if("xpx"in t)te=t.xpx;else te=b[0]._length/2;if("ypx"in t)re=t.ypx;else re=w[0]._length/2}else{if(s.triggerHandler(e,"plotly_beforehover",t)===false){return}var ne=t.target.getBoundingClientRect();te=t.clientX-ne.left;re=t.clientY-ne.top;if(te<0||te>b[0]._length||re<0||re>w[0]._length){return h.unhoverRaw(e,t)}}t.pointerX=te+b[0]._offset;t.pointerY=re+w[0]._offset;if("xval"in t)j=v.flat(l,t.xval);else j=v.p2c(b,te);if("yval"in t)V=v.flat(l,t.yval);else V=v.p2c(w,re);if(!i(j[0])||!i(V[0])){o.warn("Fx.hover failed",t,e);return h.unhoverRaw(e,t)}}var ie=Infinity;for(U=0;U<N.length;U++){Z=N[U];if(!Z||!Z[0]||!Z[0].trace||Z[0].trace.visible!==true)continue;H=Z[0].trace;if(["carpet","contourcarpet"].indexOf(H._module.name)!==-1)continue;if(H.type==="splom"){$=0;G=l[$]}else{G=v.getSubplot(H);$=l.indexOf(G)}W=O;J={cd:Z,trace:H,xa:b[$],ya:w[$],maxHoverDistance:R,maxSpikeDistance:F,index:false,distance:Math.min(ie,R),spikeDistance:Infinity,xSpike:undefined,ySpike:undefined,color:f.defaultLine,name:H.name,x0:undefined,x1:undefined,y0:undefined,y1:undefined,xLabelVal:undefined,yLabelVal:undefined,zLabelVal:undefined,text:undefined};if(c[G]){J.subplot=c[G]._subplot}K=B.length;if(W==="array"){var ae=t[U];if("pointNumber"in ae){J.index=ae.pointNumber;W="closest"}else{W="";if("xval"in ae){X=ae.xval;W="x"}if("yval"in ae){Y=ae.yval;W=W?"closest":"y"}}}else{X=j[$];Y=V[$]}if(R!==0){if(H._module&&H._module.hoverPoints){var oe=H._module.hoverPoints(J,X,Y,W,c._hoverlayer);if(oe){var se;for(var le=0;le<oe.length;le++){se=oe[le];if(i(se.x0)&&i(se.y0)){B.push(C(se,O))}}}}else{o.log("Unrecognized trace type in hover:",H)}}if(O==="closest"&&B.length>K){B.splice(0,K);ie=B[0].distance}if(y&&F!==0){if(B.length===0){J.distance=F;J.index=false;var ue=H._module.hoverPoints(J,X,Y,"closest",c._hoverlayer);if(ue){ue=ue.filter(function(e){return e.spikeDistance<=F})}if(ue&&ue.length){var ce;var fe=ue.filter(function(e){return e.xa.showspikes});if(fe.length){var he=fe[0];if(i(he.x0)&&i(he.y0)){ce=me(he);if(!Q.vLinePoint||Q.vLinePoint.spikeDistance>ce.spikeDistance){Q.vLinePoint=ce}}}var pe=ue.filter(function(e){return e.ya.showspikes});if(pe.length){var de=pe[0];if(i(de.x0)&&i(de.y0)){ce=me(de);if(!Q.hLinePoint||Q.hLinePoint.spikeDistance>ce.spikeDistance){Q.hLinePoint=ce}}}}}}}function ve(e,t){var r=null;var n=Infinity;var i;for(var a=0;a<e.length;a++){i=e[a].spikeDistance;if(i<n&&i<=t){r=e[a];n=i}}return r}function me(e){if(!e)return null;return{xa:e.xa,ya:e.ya,x:e.xSpike!==undefined?e.xSpike:(e.x0+e.x1)/2,y:e.ySpike!==undefined?e.ySpike:(e.y0+e.y1)/2,distance:e.distance,spikeDistance:e.spikeDistance,curveNumber:e.trace.index,color:e.color,pointNumber:e.index}}var ge={fullLayout:c,container:c._hoverlayer,outerContainer:c._paperdiv,event:t};var ye=e._spikepoints,_e={vLinePoint:Q.vLinePoint,hLinePoint:Q.hLinePoint};e._spikepoints=_e;if(y&&F!==0){if(B.length!==0){var xe=B.filter(function(e){return e.ya.showspikes});var be=ve(xe,F);Q.hLinePoint=me(be);var we=B.filter(function(e){return e.xa.showspikes});var ke=ve(we,F);Q.vLinePoint=me(ke)}}if(B.length===0){var Ae=h.unhoverRaw(e,t);if(y&&(Q.hLinePoint!==null||Q.vLinePoint!==null)){if(L(ye)){z(Q,ge)}}return Ae}if(y){if(L(ye)){z(Q,ge)}}B.sort(function(e,t){return e.distance-t.distance});var Te=e._hoverdata,Me=[];for(q=0;q<B.length;q++){var Se=B[q];Me.push(v.makeEventData(Se,Se.trace,Se.cd))}e._hoverdata=Me;var Ce=O==="y"&&N.length>1;var ze=f.combine(c.plot_bgcolor||f.background,c.paper_bgcolor);var Ee={hovermode:O,rotateLabels:Ce,bgColor:ze,container:c._hoverlayer,outerContainer:c._paperdiv,commonLabelOpts:c.hoverlabel,hoverdistance:c.hoverdistance};var Le=T(B,Ee,e);M(B,Ce?"xa":"ya",c);S(Le,Ce);if(t.target&&t.target.tagName){var Ie=d.getComponentMethod("annotations","hasClickToShow")(e,Me);u(n.select(t.target),Ie?"pointer":"")}if(!t.target||a||!E(e,t,Te))return;if(Te){e.emit("plotly_unhover",{event:t,points:Te})}e.emit("plotly_hover",{event:t,points:e._hoverdata,xaxes:b,yaxes:w,xvals:j,yvals:V})}function T(e,t,r){var i=t.hovermode;var a=t.rotateLabels;var s=t.bgColor;var u=t.container;var h=t.outerContainer;var p=t.commonLabelOpts||{};var d=t.fontFamily||m.HOVERFONT;var v=t.fontSize||m.HOVERFONTSIZE;var y=e[0];var _=y.xa;var x=y.ya;var b=i==="y"?"yLabel":"xLabel";var A=y[b];var T=(String(A)||"").split(" ")[0];var M=h.node().getBoundingClientRect();var S=M.top;var C=M.width;var z=M.height;var E=A!==undefined&&y.distance<=t.hoverdistance&&(i==="x"||i==="y");if(E){var L,I;var P=true;for(L=0;L<e.length;L++){if(P&&e[L].zLabel===undefined)P=false;I=e[L].hoverinfo||e[L].trace.hoverinfo;var D=Array.isArray(I)?I:I.split("+");if(D.indexOf("all")===-1&&D.indexOf(i)===-1){E=false;break}}if(P)E=false}var O=u.selectAll("g.axistext").data(E?[0]:[]);O.enter().append("g").classed("axistext",true);O.exit().remove();O.each(function(){var t=n.select(this);var a=o.ensureSingle(t,"path","",function(e){e.style({"stroke-width":"1px"})});var s=o.ensureSingle(t,"text","",function(e){e.attr("data-notex",1)});var u=p.bgcolor||f.defaultLine;var h=p.bordercolor||f.contrast(u);a.style({fill:u,stroke:h});s.text(A).call(c.font,p.font.family||d,p.font.size||v,p.font.color||f.background).call(l.positionText,0,0).call(l.convertToTspans,r);t.attr("transform","");var m=s.node().getBoundingClientRect();if(i==="x"){s.attr("text-anchor","middle").call(l.positionText,0,_.side==="top"?S-m.bottom-w-k:S-m.top+w+k);var g=_.side==="top"?"-":"";a.attr("d","M0,0"+"L"+w+","+g+w+"H"+(k+m.width/2)+"v"+g+(k*2+m.height)+"H-"+(k+m.width/2)+"V"+g+w+"H-"+w+"Z");t.attr("transform","translate("+(_._offset+(y.x0+y.x1)/2)+","+(x._offset+(_.side==="top"?0:x._length))+")")}else{s.attr("text-anchor",x.side==="right"?"start":"end").call(l.positionText,(x.side==="right"?1:-1)*(k+w),S-m.top-m.height/2);var M=x.side==="right"?"":"-";a.attr("d","M0,0"+"L"+M+w+","+w+"V"+(k+m.height/2)+"h"+M+(k*2+m.width)+"V-"+(k+m.height/2)+"H"+M+w+"V-"+w+"Z");t.attr("transform","translate("+(_._offset+(x.side==="right"?_._length:0))+","+(x._offset+(y.y0+y.y1)/2)+")")}e=e.filter(function(e){return e.zLabelVal!==undefined||(e[b]||"").split(" ")[0]===T})});var R=u.selectAll("g.hovertext").data(e,function(e){return[e.trace.index,e.index,e.x0,e.y0,e.name,e.attr,e.xa,e.ya||""].join(",")});R.enter().append("g").classed("hovertext",true).each(function(){var e=n.select(this);e.append("rect").call(f.fill,f.addOpacity(s,.8));e.append("text").classed("name",true);e.append("path").style("stroke-width","1px");e.append("text").classed("nums",true).call(c.font,d,v)});R.exit().remove();R.each(function(e){var t=n.select(this).attr("transform",""),o="",u="";var h=f.opacity(e.color)?e.color:f.defaultLine;var p=f.combine(h,s);var m=e.borderColor||f.contrast(p);if(e.nameOverride!==undefined)e.name=e.nameOverride;if(e.name){o=l.plainText(e.name||"");var y=Math.round(e.nameLength);if(y>-1&&o.length>y){if(y>3)o=o.substr(0,y-3)+"...";else o=o.substr(0,y)}}if(e.zLabel!==undefined){if(e.xLabel!==undefined)u+="x: "+e.xLabel+"<br>";if(e.yLabel!==undefined)u+="y: "+e.yLabel+"<br>";u+=(u?"z: ":"")+e.zLabel}else if(E&&e[i+"Label"]===A){u=e[(i==="x"?"y":"x")+"Label"]||""}else if(e.xLabel===undefined){if(e.yLabel!==undefined)u=e.yLabel}else if(e.yLabel===undefined)u=e.xLabel;else u="("+e.xLabel+", "+e.yLabel+")";if((e.text||e.text===0)&&!Array.isArray(e.text)){u+=(u?"<br>":"")+e.text}if(e.extraText!==undefined)u+=(u?"<br>":"")+e.extraText;if(u===""){if(o==="")t.remove();u=o}var _=t.select("text.nums").call(c.font,e.fontFamily||d,e.fontSize||v,e.fontColor||m).text(u).attr("data-notex",1).call(l.positionText,0,0).call(l.convertToTspans,r);var x=t.select("text.name"),b=0;if(o&&o!==u){x.call(c.font,e.fontFamily||d,e.fontSize||v,p).text(o).attr("data-notex",1).call(l.positionText,0,0).call(l.convertToTspans,r);b=x.node().getBoundingClientRect().width+2*k}else{x.remove();t.select("rect").remove()}t.select("path").style({fill:p,stroke:m});var T=_.node().getBoundingClientRect(),M=e.xa._offset+(e.x0+e.x1)/2,L=e.ya._offset+(e.y0+e.y1)/2,I=Math.abs(e.x1-e.x0),P=Math.abs(e.y1-e.y0),D=T.width+w+k+b,O,R;e.ty0=S-T.top;e.bx=T.width+2*k;e.by=T.height+2*k;e.anchor="start";e.txwidth=T.width;e.tx2width=b;e.offset=0;if(a){e.pos=M;O=L+P/2+D<=z;R=L-P/2-D>=0;if((e.idealAlign==="top"||!O)&&R){L-=P/2;e.anchor="end"}else if(O){L+=P/2;e.anchor="start"}else e.anchor="middle"}else{e.pos=L;O=M+I/2+D<=C;R=M-I/2-D>=0;if((e.idealAlign==="left"||!O)&&R){M-=I/2;e.anchor="end"}else if(O){M+=I/2;e.anchor="start"}else e.anchor="middle"}_.attr("text-anchor",e.anchor);if(b)x.attr("text-anchor",e.anchor);t.attr("transform","translate("+M+","+L+")"+(a?"rotate("+g+")":""))});return R}function M(e,t,r){var n=0,i=e.map(function(e,n){var i=e[t];return[{i:n,dp:0,pos:e.pos,posref:e.posref,size:e.by*(i._id.charAt(0)==="x"?_:1)/2,pmin:0,pmax:i._id.charAt(0)==="x"?r.width:r.height}]}).sort(function(e,t){return e[0].posref-t[0].posref}),a,o,s,l,u,c,f;function h(e){var t=e[0],r=e[e.length-1];o=t.pmin-t.pos-t.dp+t.size;s=r.pos+r.dp+r.size-t.pmax;if(o>.01){for(u=e.length-1;u>=0;u--)e[u].dp+=o;a=false}if(s<.01)return;if(o<-.01){for(u=e.length-1;u>=0;u--)e[u].dp-=s;a=false}if(!a)return;var n=0;for(l=0;l<e.length;l++){c=e[l];if(c.pos+c.dp+c.size>t.pmax)n++}for(l=e.length-1;l>=0;l--){if(n<=0)break;c=e[l];if(c.pos>t.pmax-1){c.del=true;n--}}for(l=0;l<e.length;l++){if(n<=0)break;c=e[l];if(c.pos<t.pmin+1){c.del=true;n--;s=c.size*2;for(u=e.length-1;u>=0;u--)e[u].dp-=s}}for(l=e.length-1;l>=0;l--){if(n<=0)break;c=e[l];if(c.pos+c.dp+c.size>t.pmax){c.del=true;n--}}}while(!a&&n<=e.length){n++;a=true;l=0;while(l<i.length-1){var p=i[l],d=i[l+1],v=p[p.length-1],m=d[0];o=v.pos+v.dp+v.size-m.pos-m.dp+m.size;if(o>.01&&v.pmin===m.pmin&&v.pmax===m.pmax){for(u=d.length-1;u>=0;u--)d[u].dp+=o;p.push.apply(p,d);i.splice(l+1,1);f=0;for(u=p.length-1;u>=0;u--)f+=p[u].dp;s=f/p.length;for(u=p.length-1;u>=0;u--)p[u].dp-=s;a=false}else l++}i.forEach(h)}for(l=i.length-1;l>=0;l--){var g=i[l];for(u=g.length-1;u>=0;u--){var y=g[u],x=e[y.i];x.offset=y.dp;x.del=y.del}}}function S(e,t){e.each(function(e){var r=n.select(this);if(e.del){r.remove();return}var i=e.anchor==="end"?-1:1,a=r.select("text.nums"),o={start:1,end:-1,middle:0}[e.anchor],s=o*(w+k),u=s+o*(e.txwidth+k),f=0,h=e.offset;if(e.anchor==="middle"){s-=e.tx2width/2;u+=e.txwidth/2+k}if(t){h*=-b;f=e.offset*x}r.select("path").attr("d",e.anchor==="middle"?"M-"+(e.bx/2+e.tx2width/2)+","+(h-e.by/2)+"h"+e.bx+"v"+e.by+"h-"+e.bx+"Z":"M0,0L"+(i*w+f)+","+(w+h)+"v"+(e.by/2-w)+"h"+i*e.bx+"v-"+e.by+"H"+(i*w+f)+"V"+(h-w)+"Z");a.call(l.positionText,s+f,h+e.ty0-e.by/2+k);if(e.tx2width){r.select("text.name").call(l.positionText,u+o*k+f,h+e.ty0-e.by/2+k);r.select("rect").call(c.setRect,u+(o-1)*e.tx2width/2+f,h-e.by/2-1,e.tx2width,e.by+2)}})}function C(e,t){var r=e.index;var n=e.trace||{};var i=e.cd[0];var a=e.cd[r]||{};var s=Array.isArray(r)?function(e,t){return o.castOption(i,r,e)||o.extractOption({},n,"",t)}:function(e,t){return o.extractOption(a,n,e,t)};function l(t,r,n){var i=s(r,n);if(i)e[t]=i}l("hoverinfo","hi","hoverinfo");l("color","hbg","hoverlabel.bgcolor");l("borderColor","hbc","hoverlabel.bordercolor");l("fontFamily","htf","hoverlabel.font.family");l("fontSize","hts","hoverlabel.font.size");l("fontColor","htc","hoverlabel.font.color");l("nameLength","hnl","hoverlabel.namelength");e.posref=t==="y"?e.xa._offset+(e.x0+e.x1)/2:e.ya._offset+(e.y0+e.y1)/2;e.x0=o.constrain(e.x0,0,e.xa._length);e.x1=o.constrain(e.x1,0,e.xa._length);e.y0=o.constrain(e.y0,0,e.ya._length);e.y1=o.constrain(e.y1,0,e.ya._length);if(e.xLabelVal!==undefined){e.xLabel="xLabel"in e?e.xLabel:p.hoverLabelText(e.xa,e.xLabelVal);e.xVal=e.xa.c2d(e.xLabelVal)}if(e.yLabelVal!==undefined){e.yLabel="yLabel"in e?e.yLabel:p.hoverLabelText(e.ya,e.yLabelVal);e.yVal=e.ya.c2d(e.yLabelVal)}if(e.zLabelVal!==undefined&&e.zLabel===undefined){e.zLabel=String(e.zLabelVal)}if(!isNaN(e.xerr)&&!(e.xa.type==="log"&&e.xerr<=0)){var u=p.tickText(e.xa,e.xa.c2l(e.xerr),"hover").text;if(e.xerrneg!==undefined){e.xLabel+=" +"+u+" / -"+p.tickText(e.xa,e.xa.c2l(e.xerrneg),"hover").text}else e.xLabel+=" \xb1 "+u;if(t==="x")e.distance+=1}if(!isNaN(e.yerr)&&!(e.ya.type==="log"&&e.yerr<=0)){var c=p.tickText(e.ya,e.ya.c2l(e.yerr),"hover").text;if(e.yerrneg!==undefined){e.yLabel+=" +"+c+" / -"+p.tickText(e.ya,e.ya.c2l(e.yerrneg),"hover").text}else e.yLabel+=" \xb1 "+c;if(t==="y")e.distance+=1}var f=e.hoverinfo||e.trace.hoverinfo;if(f!=="all"){f=Array.isArray(f)?f:f.split("+");if(f.indexOf("x")===-1)e.xLabel=undefined;if(f.indexOf("y")===-1)e.yLabel=undefined;if(f.indexOf("z")===-1)e.zLabel=undefined;if(f.indexOf("text")===-1)e.text=undefined;if(f.indexOf("name")===-1)e.name=undefined}return e}function z(e,t){var r=t.container;var n=t.fullLayout;var i=t.event;var o,s;var l=!!e.hLinePoint;var u=!!e.vLinePoint;r.selectAll(".spikeline").remove();if(!(u||l))return;var h=f.combine(n.plot_bgcolor,n.paper_bgcolor);if(l){var p=e.hLinePoint,d,v;o=p&&p.xa;s=p&&p.ya;var m=s.spikesnap;if(m==="cursor"){d=i.pointerX;v=i.pointerY}else{d=o._offset+p.x;v=s._offset+p.y}var g=a.readability(p.color,h)<1.5?f.contrast(h):p.color;var y=s.spikemode,_=s.spikethickness,x=s.spikecolor||g,b=s._boundingBox,w=(b.left+b.right)/2<d?b.right:b.left,k,A;if(y.indexOf("toaxis")!==-1||y.indexOf("across")!==-1){if(y.indexOf("toaxis")!==-1){k=w;A=d}if(y.indexOf("across")!==-1){k=s._counterSpan[0];A=s._counterSpan[1]}r.insert("line",":first-child").attr({x1:k,x2:A,y1:v,y2:v,"stroke-width":_,stroke:x,"stroke-dasharray":c.dashStyle(s.spikedash,_)}).classed("spikeline",true).classed("crisp",true);r.insert("line",":first-child").attr({x1:k,x2:A,y1:v,y2:v,"stroke-width":_+2,stroke:h}).classed("spikeline",true).classed("crisp",true)}if(y.indexOf("marker")!==-1){r.insert("circle",":first-child").attr({cx:w+(s.side!=="right"?_:-_),cy:v,r:_,fill:x}).classed("spikeline",true)}}if(u){var T=e.vLinePoint,M,S;o=T&&T.xa;s=T&&T.ya;var C=o.spikesnap;if(C==="cursor"){M=i.pointerX;S=i.pointerY}else{M=o._offset+T.x;S=s._offset+T.y}var z=a.readability(T.color,h)<1.5?f.contrast(h):T.color;var E=o.spikemode,L=o.spikethickness,I=o.spikecolor||z,P=o._boundingBox,D=(P.top+P.bottom)/2<S?P.bottom:P.top,O,R;if(E.indexOf("toaxis")!==-1||E.indexOf("across")!==-1){if(E.indexOf("toaxis")!==-1){O=D;R=S}if(E.indexOf("across")!==-1){O=o._counterSpan[0];R=o._counterSpan[1]}r.insert("line",":first-child").attr({x1:M,x2:M,y1:O,y2:R,"stroke-width":L,stroke:I,"stroke-dasharray":c.dashStyle(o.spikedash,L)}).classed("spikeline",true).classed("crisp",true);r.insert("line",":first-child").attr({x1:M,x2:M,y1:O,y2:R,"stroke-width":L+2,stroke:h}).classed("spikeline",true).classed("crisp",true)}if(E.indexOf("marker")!==-1){r.insert("circle",":first-child").attr({cx:M,cy:D-(o.side!=="top"?L:-L),r:L,fill:I}).classed("spikeline",true)}}}function E(e,t,r){if(!r||r.length!==e._hoverdata.length)return true;for(var n=r.length-1;n>=0;n--){var i=r[n],a=e._hoverdata[n];if(i.curveNumber!==a.curveNumber||String(i.pointNumber)!==String(a.pointNumber)){return true}}return false}function L(e,t){if(!t)return true;if(t.vLinePoint!==e._spikepoints.vLinePoint||t.hLinePoint!==e._spikepoints.hLinePoint)return true;return false}},{"../../lib":161,"../../lib/events":153,"../../lib/override_cursor":172,"../../lib/svg_text_utils":182,"../../plots/cartesian/axes":205,"../../registry":253,"../color":42,"../dragelement":64,"../drawing":67,"./constants":79,"./helpers":81,d3:6,"fast-isnumeric":9,tinycolor2:25}],83:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r,i,a){a=a||{};i("hoverlabel.bgcolor",a.bgcolor);i("hoverlabel.bordercolor",a.bordercolor);i("hoverlabel.namelength",a.namelength);n.coerceFont(i,"hoverlabel.font",a.font)}},{"../../lib":161}],84:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../lib");var a=e("../dragelement");var o=e("./helpers");var s=e("./layout_attributes");t.exports={moduleType:"component",name:"fx",constants:e("./constants"),schema:{layout:s},attributes:e("./attributes"),layoutAttributes:s,supplyLayoutGlobalDefaults:e("./layout_global_defaults"),supplyDefaults:e("./defaults"),supplyLayoutDefaults:e("./layout_defaults"),calc:e("./calc"),getDistanceFunction:o.getDistanceFunction,getClosest:o.getClosest,inbox:o.inbox,quadrature:o.quadrature,appendArrayPointValue:o.appendArrayPointValue,castHoverOption:u,castHoverinfo:c,hover:e("./hover").hover,unhover:a.unhover,loneHover:e("./hover").loneHover,loneUnhover:l,click:e("./click")};function l(e){var t=i.isD3Selection(e)?e:n.select(e);t.selectAll("g.hovertext").remove();t.selectAll(".spikeline").remove()}function u(e,t,r){return i.castOption(e,t,"hoverlabel."+r)}function c(e,t,r){function n(r){return i.coerceHoverinfo({hoverinfo:r},{_module:e._module},t)}return i.castOption(e,r,"hoverinfo",n)}},{"../../lib":161,"../dragelement":64,"./attributes":76,"./calc":77,"./click":78,"./constants":79,"./defaults":80,"./helpers":81,"./hover":82,"./layout_attributes":85,"./layout_defaults":86,"./layout_global_defaults":87,d3:6}],85:[function(e,t,r){"use strict";var n=e("./constants");var i=e("../../plots/font_attributes")({editType:"none"});i.family.dflt=n.HOVERFONT;i.size.dflt=n.HOVERFONTSIZE;t.exports={dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","orbit","turntable"],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",false],editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:20,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:i,namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":231,"./constants":79}],86:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./layout_attributes");t.exports=function e(t,r,o){function s(e,a){return n.coerce(t,r,i,e,a)}var l=s("dragmode");if(l==="select")s("selectdirection");var u;if(r._has("cartesian")){r._isHoriz=a(o);u=r._isHoriz?"y":"x"}else u="closest";var c=s("hovermode",u);if(c){s("hoverdistance");s("spikedistance")}var f=r._has("mapbox");var h=r._has("geo");var p=r._basePlotModules.length;if(r.dragmode==="zoom"&&((f||h)&&p===1||f&&h&&p===2)){r.dragmode="pan"}};function a(e){var t=true;for(var r=0;r<e.length;r++){var n=e[r];if(n.orientation!=="h"){t=false;break}}return t}},{"../../lib":161,"./layout_attributes":85}],87:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./hoverlabel_defaults");var a=e("./layout_attributes");t.exports=function e(t,r){function o(e,i){return n.coerce(t,r,a,e,i)}i(t,r,o)}},{"../../lib":161,"./hoverlabel_defaults":83,"./layout_attributes":85}],88:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../lib/regex").counter;var a=e("../../plots/domain").attributes;var o=e("../../plots/cartesian/constants").idRegex;var s=e("../../plot_api/plot_template");var l={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:true,dimensions:2,items:{valType:"enumerated",values:[i("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:true,items:{valType:"enumerated",values:[o.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:true,items:{valType:"enumerated",values:[o.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:a({name:"grid",editType:"plot",noGridCell:true},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function u(e,t,r){var n=t[r+"axes"];var i=Object.keys((e._splomAxes||{})[r]||{});if(Array.isArray(n))return n;if(i.length)return i}function c(e,t){var r=e.grid||{};var i=u(t,r,"x");var a=u(t,r,"y");if(!e.grid&&!i&&!a)return;var o=Array.isArray(r.subplots)&&Array.isArray(r.subplots[0]);var c=Array.isArray(i);var h=Array.isArray(a);var p=c&&i!==r.xaxes&&h&&a!==r.yaxes;var d,v;if(o){d=r.subplots.length;v=r.subplots[0].length}else{if(h)d=a.length;if(c)v=i.length}var m=s.newContainer(t,"grid");function g(e,t){return n.coerce(r,m,l,e,t)}var y=g("rows",d);var _=g("columns",v);if(!(y*_>1)){delete t.grid;return}if(!o&&!c&&!h){var x=g("pattern")==="independent";if(x)o=true}m._hasSubplotGrid=o;var b=g("roworder");var w=b==="top to bottom";var k=o?.2:.1;var A=o?.3:.1;var T,M;if(p&&t._splomGridDflt){T=t._splomGridDflt.xside;M=t._splomGridDflt.yside}m._domains={x:f("x",g,k,T,_),y:f("y",g,A,M,y,w)}}function f(e,t,r,n,i,a){var o=t(e+"gap",r);var s=t("domain."+e);t(e+"side",n);var l=new Array(i);var u=s[0];var c=(s[1]-u)/(i-o);var f=c*(1-o);for(var h=0;h<i;h++){var p=u+c*h;l[a?i-1-h:h]=[p,p+f]}return l}function h(e,t){var r=t.grid;if(!r||!r._domains)return;var n=e.grid||{};var i=t._subplots;var a=r._hasSubplotGrid;var o=r.rows;var s=r.columns;var l=r.pattern==="independent";var c,f,h,d,v,m,g;var y=r._axisMap={};if(a){var _=n.subplots||[];m=r.subplots=new Array(o);var x=1;for(c=0;c<o;c++){var b=m[c]=new Array(s);var w=_[c]||[];for(f=0;f<s;f++){if(l){v=x===1?"xy":"x"+x+"y"+x;x++}else v=w[f];b[f]="";if(i.cartesian.indexOf(v)!==-1){g=v.indexOf("y");h=v.slice(0,g);d=v.slice(g);if(y[h]!==undefined&&y[h]!==f||y[d]!==undefined&&y[d]!==c){continue}b[f]=v;y[h]=f;y[d]=c}}}}else{var k=u(t,n,"x");var A=u(t,n,"y");r.xaxes=p(k,i.xaxis,s,y,"x");r.yaxes=p(A,i.yaxis,o,y,"y")}var T=r._anchors={};var M=r.roworder==="top to bottom";for(var S in y){var C=S.charAt(0);var z=r[C+"side"];var E,L,I;if(z.length<8){T[S]="free"}else if(C==="x"){if(z.charAt(0)==="t"===M){E=0;L=1;I=o}else{E=o-1;L=-1;I=-1}if(a){var P=y[S];for(c=E;c!==I;c+=L){v=m[c][P];if(!v)continue;g=v.indexOf("y");if(v.slice(0,g)===S){T[S]=v.slice(g);break}}}else{for(c=E;c!==I;c+=L){d=r.yaxes[c];if(i.cartesian.indexOf(S+d)!==-1){T[S]=d;break}}}}else{if(z.charAt(0)==="l"){E=0;L=1;I=s}else{E=s-1;L=-1;I=-1}if(a){var D=y[S];for(c=E;c!==I;c+=L){v=m[D][c];if(!v)continue;g=v.indexOf("y");if(v.slice(g)===S){T[S]=v.slice(0,g);break}}}else{for(c=E;c!==I;c+=L){h=r.xaxes[c];if(i.cartesian.indexOf(h+S)!==-1){T[S]=h;break}}}}}}function p(e,t,r,n,i){var a=new Array(r);var o;function s(e,r){if(t.indexOf(r)!==-1&&n[r]===undefined){a[e]=r;n[r]=e}else a[e]=""}if(Array.isArray(e)){for(o=0;o<r;o++){s(o,e[o])}}else{s(0,i);for(o=1;o<r;o++){s(o,i+(o+1))}}return a}t.exports={moduleType:"component",name:"grid",schema:{layout:{grid:l}},layoutAttributes:l,sizeDefaults:c,contentDefaults:h}},{"../../lib":161,"../../lib/regex":176,"../../plot_api/plot_template":195,"../../plots/cartesian/constants":210,"../../plots/domain":230}],89:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/constants");var i=e("../../plot_api/plot_template").templatedArray;t.exports=i("image",{visible:{valType:"boolean",dflt:true,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",n.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",n.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../plot_api/plot_template":195,"../../plots/cartesian/constants":210}],90:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib/to_log_range");t.exports=function e(t,r,a,o){r=r||{};var s=a==="log"&&r.type==="linear",l=a==="linear"&&r.type==="log";if(!(s||l))return;var u=t._fullLayout.images,c=r._id.charAt(0),f,h;for(var p=0;p<u.length;p++){f=u[p];h="images["+p+"].";if(f[c+"ref"]===r._id){var d=f[c],v=f["size"+c],m=null,g=null;if(s){m=i(d,r.range);var y=v/Math.pow(10,m)/2;g=2*Math.log(y+Math.sqrt(1+y*y))/Math.LN10}else{m=Math.pow(10,d);g=m*(Math.pow(10,v/2)-Math.pow(10,-v/2))}if(!n(m)){m=null;g=null}else if(!n(g))g=null;o(h+c,m);o(h+"size"+c,g)}}}},{"../../lib/to_log_range":184,"fast-isnumeric":9}],91:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");var a=e("../../plots/array_container_defaults");var o=e("./attributes");var s="images";t.exports=function e(t,r){var n={name:s,handleItemDefaults:l};a(t,r,n)};function l(e,t,r){function a(r,i){return n.coerce(e,t,o,r,i)}var s=a("source");var l=a("visible",!!s);if(!l)return t;a("layer");a("xanchor");a("yanchor");a("sizex");a("sizey");a("sizing");a("opacity");var u={_fullLayout:r},c=["x","y"];for(var f=0;f<2;f++){var h=c[f],p=i.coerceRef(e,t,u,h,"paper");i.coercePosition(t,u,a,p,h,0)}return t}},{"../../lib":161,"../../plots/array_container_defaults":201,"../../plots/cartesian/axes":205,"./attributes":89}],92:[function(e,t,r){"use strict";var n=e("d3");var i=e("../drawing");var a=e("../../plots/cartesian/axes");var o=e("../../constants/xmlns_namespaces");t.exports=function e(t){var r=t._fullLayout,s=[],l={},u=[],c,f;for(f=0;f<r.images.length;f++){var h=r.images[f];if(h.visible){if(h.layer==="below"&&h.xref!=="paper"&&h.yref!=="paper"){c=h.xref+h.yref;var p=r._plots[c];if(!p){u.push(h);continue}if(p.mainplot){c=p.mainplot.id}if(!l[c]){l[c]=[]}l[c].push(h)}else if(h.layer==="above"){s.push(h)}else{u.push(h)}}}var d={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};function v(e){var r=n.select(this);if(this.img&&this.img.src===e.source){return}r.attr("xmlns",o.svg);var i=new Promise(function(t){var n=new Image;this.img=n;n.setAttribute("crossOrigin","anonymous");n.onerror=i;n.onload=function(){var e=document.createElement("canvas");e.width=this.width;e.height=this.height;var n=e.getContext("2d");n.drawImage(this,0,0);var i=e.toDataURL("image/png");r.attr("xlink:href",i);t()};r.on("error",i);n.src=e.source;function i(){r.remove();t()}}.bind(this));t._promises.push(i)}function m(e){var o=n.select(this);var s=a.getFromId(t,e.xref),l=a.getFromId(t,e.yref);var u=r._size,c=s?Math.abs(s.l2p(e.sizex)-s.l2p(0)):e.sizex*u.w,f=l?Math.abs(l.l2p(e.sizey)-l.l2p(0)):e.sizey*u.h;var h=c*d.x[e.xanchor].offset,p=f*d.y[e.yanchor].offset;var v=d.x[e.xanchor].sizing+d.y[e.yanchor].sizing;var m=(s?s.r2p(e.x)+s._offset:e.x*u.w+u.l)+h,g=(l?l.r2p(e.y)+l._offset:u.h-e.y*u.h+u.t)+p;switch(e.sizing){case"fill":v+=" slice";break;case"stretch":v="none";break}o.attr({x:m,y:g,width:c,height:f,preserveAspectRatio:v,opacity:e.opacity});var y=s?s._id:"",_=l?l._id:"",x=y+_;o.call(i.setClipUrl,x?"clip"+r._uid+x:null)}var g=r._imageLowerLayer.selectAll("image").data(u),y=r._imageUpperLayer.selectAll("image").data(s);g.enter().append("image");y.enter().append("image");g.exit().remove();y.exit().remove();g.each(function(e){v.bind(this)(e);m.bind(this)(e)});y.each(function(e){v.bind(this)(e);m.bind(this)(e)});var _=Object.keys(r._plots);for(f=0;f<_.length;f++){c=_[f];var x=r._plots[c];if(!x.imagelayer)continue;var b=x.imagelayer.selectAll("image").data(l[c]||[]);b.enter().append("image");b.exit().remove();b.each(function(e){v.bind(this)(e);m.bind(this)(e)})}}},{"../../constants/xmlns_namespaces":144,"../../plots/cartesian/axes":205,"../drawing":67,d3:6}],93:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"images",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("images"),draw:e("./draw"),convertCoords:e("./convert_coords")}},{"../../plots/cartesian/include_components":215,"./attributes":89,"./convert_coords":90,"./defaults":91,"./draw":92}],94:[function(e,t,r){"use strict";r.isRightAnchor=function e(t){return t.xanchor==="right"||t.xanchor==="auto"&&t.x>=2/3};r.isCenterAnchor=function e(t){return t.xanchor==="center"||t.xanchor==="auto"&&t.x>1/3&&t.x<2/3};r.isBottomAnchor=function e(t){return t.yanchor==="bottom"||t.yanchor==="auto"&&t.y<=1/3};r.isMiddleAnchor=function e(t){return t.yanchor==="middle"||t.yanchor==="auto"&&t.y>1/3&&t.y<2/3}},{}],95:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var i=e("../color/attributes");t.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:i.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:n({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},x:{valType:"number",min:-2,max:3,dflt:1.02,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,dflt:1,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":231,"../color/attributes":41}],96:[function(e,t,r){"use strict";t.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4}},{}],97:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");var a=e("../../plot_api/plot_template");var o=e("./attributes");var s=e("../../plots/layout_attributes");var l=e("./helpers");t.exports=function e(t,r,u){var c=t.legend||{};var f=0;var h="normal";var p,d,v,m;for(var g=0;g<u.length;g++){var y=u[g];if(l.legendGetsTrace(y)){f++;if(n.traceIs(y,"pie"))f++}if(n.traceIs(y,"bar")&&r.barmode==="stack"||["tonextx","tonexty"].indexOf(y.fill)!==-1){h=l.isGrouped({traceorder:h})?"grouped+reversed":"reversed"}if(y.legendgroup!==undefined&&y.legendgroup!==""){h=l.isReversed({traceorder:h})?"reversed+grouped":"grouped"}}var _=i.coerce(t,r,s,"showlegend",f>1);if(_===false)return;var x=a.newContainer(r,"legend");function b(e,t){return i.coerce(c,x,o,e,t)}b("bgcolor",r.paper_bgcolor);b("bordercolor");b("borderwidth");i.coerceFont(b,"font",r.font);b("orientation");if(x.orientation==="h"){var w=t.xaxis;if(w&&w.rangeslider&&w.rangeslider.visible){p=0;v="left";d=1.1;m="bottom"}else{p=0;v="left";d=-.1;m="top"}}b("traceorder",h);if(l.isGrouped(r.legend))b("tracegroupgap");b("x",p);b("xanchor",v);b("y",d);b("yanchor",m);i.noneOrAll(c,x,["x","y"])}},{"../../lib":161,"../../plot_api/plot_template":195,"../../plots/layout_attributes":235,"../../registry":253,"./attributes":95,"./helpers":101}],98:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../lib");var a=e("../../plots/plots");var o=e("../../registry");var s=e("../../lib/events");var l=e("../dragelement");var u=e("../drawing");var c=e("../color");var f=e("../../lib/svg_text_utils");var h=e("./handle_click");var p=e("./constants");var d=e("../../constants/interactions");var v=e("../../constants/alignment");var m=v.LINE_SPACING;var g=v.FROM_TL;var y=v.FROM_BR;var _=e("./get_legend_data");var x=e("./style");var b=e("./helpers");var w=e("./anchor_utils");var k=d.DBLCLICKDELAY;t.exports=function e(t){var r=t._fullLayout;var s="legend"+r._uid;if(!r._infolayer||!t.calcdata)return;if(!t._legendMouseDownTime)t._legendMouseDownTime=0;var f=r.legend;var h=r.showlegend&&_(t.calcdata,f);var d=r.hiddenlabels||[];if(!r.showlegend||!h.length){r._infolayer.selectAll(".legend").remove();r._topdefs.select("#"+s).remove();a.autoMargin(t,"legend");return}var v=0;for(var m=0;m<h.length;m++){for(var g=0;g<h[m].length;g++){var y=h[m][g][0];var b=y.trace;var k=o.traceIs(b,"pie");var M=k?y.label:b.name;v=Math.max(v,M&&M.length||0)}}var C=false;var I=i.ensureSingle(r._infolayer,"g","legend",function(e){e.attr("pointer-events","all");C=true});var P=i.ensureSingleById(r._topdefs,"clipPath",s,function(e){e.append("rect")});var D=i.ensureSingle(I,"rect","bg",function(e){e.attr("shape-rendering","crispEdges")});D.call(c.stroke,f.bordercolor).call(c.fill,f.bgcolor).style("stroke-width",f.borderwidth+"px");var O=i.ensureSingle(I,"g","scrollbox");var R=i.ensureSingle(I,"rect","scrollbar",function(e){e.attr({rx:20,ry:3,width:0,height:0}).call(c.fill,"#808BA4")});var F=O.selectAll("g.groups").data(h);F.enter().append("g").attr("class","groups");F.exit().remove();var B=F.selectAll("g.traces").data(i.identity);B.enter().append("g").attr("class","traces");B.exit().remove();B.call(x,t).style("opacity",function(e){var t=e[0].trace;if(o.traceIs(t,"pie")){return d.indexOf(e[0].label)!==-1?.5:1}else{return t.visible==="legendonly"?.5:1}}).each(function(){n.select(this).call(T,t,v).call(S,t)});if(C){z(t,F,B);E(t)}var N=0,j=r.width,V=0,q=r.height;z(t,F,B);if(f._height>q){L(t)}else{E(t)}var U=r._size,Z=U.l+U.w*f.x,H=U.t+U.h*(1-f.y);if(w.isRightAnchor(f)){Z-=f._width}else if(w.isCenterAnchor(f)){Z-=f._width/2}if(w.isBottomAnchor(f)){H-=f._height}else if(w.isMiddleAnchor(f)){H-=f._height/2}var G=f._width,$=U.w;if(G>$){Z=U.l;G=$}else{if(Z+G>j)Z=j-G;if(Z<N)Z=N;G=Math.min(j-Z,f._width)}var W=f._height,X=U.h;if(W>X){H=U.t;W=X}else{if(H+W>q)H=q-W;if(H<V)H=V;W=Math.min(q-H,f._height)}u.setTranslate(I,Z,H);R.on(".drag",null);I.on("wheel",null);if(f._height<=W||t._context.staticPlot){D.attr({width:G-f.borderwidth,height:W-f.borderwidth,x:f.borderwidth/2,y:f.borderwidth/2});u.setTranslate(O,0,0);P.select("rect").attr({width:G-2*f.borderwidth,height:W-2*f.borderwidth,x:f.borderwidth,y:f.borderwidth});u.setClipUrl(O,s);u.setRect(R,0,0,0,0);delete f._scrollY}else{var Y=Math.max(p.scrollBarMinHeight,W*W/f._height);var J=W-Y-2*p.scrollBarMargin;var K=f._height-W;var Q=J/K;var ee=Math.min(f._scrollY||0,K);D.attr({width:G-2*f.borderwidth+p.scrollBarWidth+p.scrollBarMargin,height:W-f.borderwidth,x:f.borderwidth/2,y:f.borderwidth/2});P.select("rect").attr({width:G-2*f.borderwidth+p.scrollBarWidth+p.scrollBarMargin,height:W-2*f.borderwidth,x:f.borderwidth,y:f.borderwidth+ee});u.setClipUrl(O,s);ie(ee,Y,Q);I.on("wheel",function(){ee=i.constrain(f._scrollY+n.event.deltaY/J*K,0,K);ie(ee,Y,Q);if(ee!==0&&ee!==K){n.event.preventDefault()}});var te,re;var ne=n.behavior.drag().on("dragstart",function(){te=n.event.sourceEvent.clientY;re=ee}).on("drag",function(){var e=n.event.sourceEvent;if(e.buttons===2||e.ctrlKey)return;ee=i.constrain((e.clientY-te)/Q+re,0,K);ie(ee,Y,Q)});R.call(ne)}function ie(e,r,n){f._scrollY=t._fullLayout.legend._scrollY=e;u.setTranslate(O,0,-e);u.setRect(R,G,p.scrollBarMargin+e*n,p.scrollBarWidth,r);P.select("rect").attr({y:f.borderwidth+e})}if(t._context.edits.legendPosition){var ae,oe,se,le;I.classed("cursor-move",true);l.init({element:I.node(),gd:t,prepFn:function(){var e=u.getTranslate(I);se=e.x;le=e.y},moveFn:function(e,t){var r=se+e,n=le+t;u.setTranslate(I,r,n);ae=l.align(r,0,U.l,U.l+U.w,f.xanchor);oe=l.align(n,0,U.t+U.h,U.t,f.yanchor)},doneFn:function(){if(ae!==undefined&&oe!==undefined){o.call("relayout",t,{"legend.x":ae,"legend.y":oe})}},clickFn:function(e,n){var i=r._infolayer.selectAll("g.traces").filter(function(){var e=this.getBoundingClientRect();return n.clientX>=e.left&&n.clientX<=e.right&&n.clientY>=e.top&&n.clientY<=e.bottom});if(i.size()>0){A(t,I,i,e,n)}}})}};function A(e,t,r,n,i){var a=r.data()[0][0].trace;var o={event:i,node:r.node(),curveNumber:a.index,expandedIndex:a._expandedIndex,data:e.data,layout:e.layout,frames:e._transitionData._frames,config:e._context,fullData:e._fullData,fullLayout:e._fullLayout};if(a._group){o.group=a._group}if(a.type==="pie"){o.label=r.datum()[0].label}var l=s.triggerHandler(e,"plotly_legendclick",o);if(l===false)return;if(n===1){t._clickTimeout=setTimeout(function(){h(r,e,n)},k)}else if(n===2){if(t._clickTimeout)clearTimeout(t._clickTimeout);e._legendMouseDownTime=0;var u=s.triggerHandler(e,"plotly_legenddoubleclick",o);if(u!==false)h(r,e,n)}}function T(e,t,r){var n=e.data()[0][0];var a=t._fullLayout;var s=n.trace;var l=o.traceIs(s,"pie");var c=s.index;var h=l?n.label:s.name;var p=t._context.edits.legendText&&!l;var d=i.ensureSingle(e,"text","legendtext");d.attr("text-anchor","start").classed("user-select-none",true).call(u.font,a.legend.font).text(p?M(h,r):h);function v(r){f.convertToTspans(r,t,function(){C(e,t)})}if(p){d.call(f.makeEditable,{gd:t,text:h}).call(v).on("edit",function(e){this.text(M(e,r)).call(v);var a=n.trace._fullInput||{};var s={};if(o.hasTransform(a,"groupby")){var l=o.getTransformIndices(a,"groupby");var u=l[l.length-1];var f=i.keyedContainer(a,"transforms["+u+"].styles","target","value.name");f.set(n.trace._group,e);s=f.constructUpdate()}else{s.name=e}return o.call("restyle",t,s,c)})}else{v(d)}}function M(e,t){var r=Math.max(4,t);if(e&&e.trim().length>=r/2)return e;e=e||"";for(var n=r-e.length;n>0;n--)e+=" ";return e}function S(e,t){var r,a=1;var o=i.ensureSingle(e,"rect","legendtoggle",function(e){e.style("cursor","pointer").attr("pointer-events","all").call(c.fill,"rgba(0,0,0,0)")});o.on("mousedown",function(){r=(new Date).getTime();if(r-t._legendMouseDownTime<k){a+=1}else{a=1;t._legendMouseDownTime=r}});o.on("mouseup",function(){if(t._dragged||t._editing)return;var r=t._fullLayout.legend;if((new Date).getTime()-t._legendMouseDownTime>k){a=Math.max(a-1,1)}A(t,r,e,a,n.event)})}function C(e,t){var r=e.data()[0][0];if(!r.trace.showlegend){e.remove();return}var n=e.select("g[class*=math-group]");var i=n.node();var a=t._fullLayout.legend;var o=a.font.size*m;var s,l;if(i){var c=u.bBox(i);s=c.height;l=c.width;u.setTranslate(n,0,s/4)}else{var h=e.select(".legendtext");var p=f.lineCount(h);var d=h.node();s=o*p;l=d?u.bBox(d).width:0;var v=o*(.3+(1-p)/2);f.positionText(h,40,v)}s=Math.max(s,16)+3;r.height=s;r.width=l}function z(e,t,r){var i=e._fullLayout;var a=i.legend;var o=a.borderwidth;var s=b.isGrouped(a);var l=0;a._width=0;a._height=0;if(b.isVertical(a)){if(s){t.each(function(e,t){u.setTranslate(this,0,t*a.tracegroupgap)})}r.each(function(e){var t=e[0],r=t.height,n=t.width;u.setTranslate(this,o,5+o+a._height+r/2);a._height+=r;a._width=Math.max(a._width,n)});a._width+=45+o*2;a._height+=10+o*2;if(s){a._height+=(a._lgroupsLength-1)*a.tracegroupgap}l=40}else if(s){var c=[a._width],f=t.data();for(var h=0,p=f.length;h<p;h++){var d=f[h].map(function(e){return e[0].width});var v=40+Math.max.apply(null,d);a._width+=a.tracegroupgap+v;c.push(a._width)}t.each(function(e,t){u.setTranslate(this,c[t],0)});t.each(function(){var e=n.select(this),t=e.selectAll("g.traces"),r=0;t.each(function(e){var t=e[0],n=t.height;u.setTranslate(this,0,5+o+r+n/2);r+=n});a._height=Math.max(a._height,r)});a._height+=10+o*2;a._width+=o*2}else{var m=0,g=0,y=0,_=0,x=0,w=a.tracegroupgap||5,k;r.each(function(e){y=Math.max(40+e[0].width,y);x+=40+e[0].width+w});k=i.width-(i.margin.r+i.margin.l)>o+x-w;r.each(function(e){var t=e[0],r=k?40+e[0].width:y;if(o+_+w+r>i.width-(i.margin.r+i.margin.l)){_=0;m=m+g;a._height=a._height+g;g=0}u.setTranslate(this,o+_,5+o+t.height/2+m);a._width+=w+r;a._height=Math.max(a._height,t.height);_+=w+r;g=Math.max(t.height,g)});a._width+=o*2;a._height+=10+o*2}a._width=Math.ceil(a._width);a._height=Math.ceil(a._height);r.each(function(t){var r=t[0],i=n.select(this).select(".legendtoggle");u.setRect(i,0,-r.height/2,(e._context.edits.legendText?0:a._width)+l,r.height)})}function E(e){var t=e._fullLayout,r=t.legend;var n="left";if(w.isRightAnchor(r)){n="right"}else if(w.isCenterAnchor(r)){n="center"}var i="top";if(w.isBottomAnchor(r)){i="bottom"}else if(w.isMiddleAnchor(r)){i="middle"}a.autoMargin(e,"legend",{x:r.x,y:r.y,l:r._width*g[n],r:r._width*y[n],b:r._height*y[i],t:r._height*g[i]})}function L(e){var t=e._fullLayout,r=t.legend;var n="left";if(w.isRightAnchor(r)){n="right"}else if(w.isCenterAnchor(r)){n="center"}a.autoMargin(e,"legend",{x:r.x,y:.5,l:r._width*g[n],r:r._width*y[n],b:0,t:0})}},{"../../constants/alignment":140,"../../constants/interactions":141,"../../lib":161,"../../lib/events":153,"../../lib/svg_text_utils":182,"../../plots/plots":244,"../../registry":253,"../color":42,"../dragelement":64,"../drawing":67,"./anchor_utils":94,"./constants":96,"./get_legend_data":99,"./handle_click":100,"./helpers":101,"./style":103,d3:6}],99:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("./helpers");t.exports=function e(t,r){var a={},o=[],s=false,l={},u=0;var c,f;function h(e,t){if(e===""||!i.isGrouped(r)){var n="~~i"+u;o.push(n);a[n]=[[t]];u++}else if(o.indexOf(e)===-1){o.push(e);s=true;a[e]=[[t]]}else a[e].push([t])}for(c=0;c<t.length;c++){var p=t[c],d=p[0],v=d.trace,m=v.legendgroup;if(!i.legendGetsTrace(v)||!v.showlegend)continue;if(n.traceIs(v,"pie")){if(!l[m])l[m]={};for(f=0;f<p.length;f++){var g=p[f].label;if(!l[m][g]){h(m,{label:g,color:p[f].color,i:p[f].i,trace:v});l[m][g]=true}}}else h(m,d)}if(!o.length)return[];var y=o.length,_,x;if(s&&i.isGrouped(r)){x=new Array(y);for(c=0;c<y;c++){_=a[o[c]];x[c]=i.isReversed(r)?_.reverse():_}}else{x=[new Array(y)];for(c=0;c<y;c++){_=a[o[c]][0];x[0][i.isReversed(r)?y-c-1:c]=_}y=1}r._lgroupsLength=y;return x}},{"../../registry":253,"./helpers":101}],100:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../registry");var a=true;t.exports=function e(t,r,o){if(r._dragged||r._editing)return;var s=r._fullLayout.hiddenlabels?r._fullLayout.hiddenlabels.slice():[];var l=t.data()[0][0];var u=r._fullData;var c=l.trace;var f=c.legendgroup;var h,p,d,v,m,g;var y={};var _=[];var x=[];var b=[];function w(e,t,r){var n=_.indexOf(e);var i=y[t];if(!i){i=y[t]=[]}if(_.indexOf(e)===-1){_.push(e);n=_.length-1}i[n]=r;return n}function k(e,t){var r=e._fullInput;if(i.hasTransform(r,"groupby")){var a=x[r.index];if(!a){var o=i.getTransformIndices(r,"groupby");var s=o[o.length-1];a=n.keyedContainer(r,"transforms["+s+"].styles","target","value.visible");x[r.index]=a}var l=a.get(e._group);if(l===undefined){l=true}if(l!==false){a.set(e._group,t)}b[r.index]=w(r.index,"visible",r.visible===false?false:true)}else{var u=r.visible===false?false:t;w(r.index,"visible",u)}}if(o===1&&a&&r.data&&r._context.showTips){n.notifier(n._(r,"Double-click on legend to isolate one trace"),"long");a=false}else{a=false}if(i.traceIs(c,"pie")){var A=l.label,T=s.indexOf(A);if(o===1){if(T===-1)s.push(A);else s.splice(T,1)}else if(o===2){s=[];r.calcdata[0].forEach(function(e){if(A!==e.label){s.push(e.label)}});if(r._fullLayout.hiddenlabels&&r._fullLayout.hiddenlabels.length===s.length&&T===-1){s=[]}}i.call("relayout",r,"hiddenlabels",s)}else{var M=f&&f.length;var S=[];var C;if(M){for(h=0;h<u.length;h++){C=u[h];if(!C.visible)continue;if(C.legendgroup===f){S.push(h)}}}if(o===1){var z;switch(c.visible){case true:z="legendonly";break;case false:z=false;break;case"legendonly":z=true;break}if(M){for(h=0;h<u.length;h++){if(u[h].visible!==false&&u[h].legendgroup===f){k(u[h],z)}}}else{k(c,z)}}else if(o===2){var E,L,I;var P=true;for(h=0;h<u.length;h++){E=u[h]===c;if(E)continue;L=M&&u[h].legendgroup===f;if(!L&&u[h].visible===true&&!i.traceIs(u[h],"notLegendIsolatable")){P=false;break}}for(h=0;h<u.length;h++){if(u[h].visible===false)continue;if(i.traceIs(u[h],"notLegendIsolatable")){continue}switch(c.visible){case"legendonly":k(u[h],true);break;case true:I=P?true:"legendonly";E=u[h]===c;L=E||M&&u[h].legendgroup===f;k(u[h],L?true:I);break}}}for(h=0;h<x.length;h++){d=x[h];if(!d)continue;var D=d.constructUpdate();var O=Object.keys(D);for(p=0;p<O.length;p++){v=O[p];g=y[v]=y[v]||[];g[b[h]]=D[v]}}m=Object.keys(y);for(h=0;h<m.length;h++){v=m[h];for(p=0;p<_.length;p++){if(!y[v].hasOwnProperty(p)){y[v][p]=undefined}}}i.call("restyle",r,y,_)}}},{"../../lib":161,"../../registry":253}],101:[function(e,t,r){"use strict";r.legendGetsTrace=function e(t){return t.visible&&t.showlegend!==undefined};r.isGrouped=function e(t){return(t.traceorder||"").indexOf("grouped")!==-1};r.isVertical=function e(t){return t.orientation!=="h"};r.isReversed=function e(t){return(t.traceorder||"").indexOf("reversed")!==-1}},{}],102:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"legend",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw"),style:e("./style")}},{"./attributes":95,"./defaults":97,"./draw":98,"./style":103}],103:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../lib");var o=e("../drawing");var s=e("../color");var l=e("../../traces/scatter/subtypes");var u=e("../../traces/pie/style_one");t.exports=function e(t,r){t.each(function(e){var t=n.select(this);var r=a.ensureSingle(t,"g","layers");r.style("opacity",e[0].trace.opacity);var i=r.selectAll("g.legendfill").data([e]);i.enter().append("g").classed("legendfill",true);var o=r.selectAll("g.legendlines").data([e]);o.enter().append("g").classed("legendlines",true);var s=r.selectAll("g.legendsymbols").data([e]);s.enter().append("g").classed("legendsymbols",true);s.selectAll("g.legendpoints").data([e]).enter().append("g").classed("legendpoints",true)}).each(h).each(p).each(m).each(c).each(f).each(d).each(v);function c(e){var t=e[0].trace;var r=t.visible&&t.fill&&t.fill!=="none";var i=l.hasLines(t);var a=t.contours;if(a&&a.type==="constraint"){i=a.showlines;r=a._operation!=="="}var s=n.select(this).select(".legendfill").selectAll("path").data(r?[e]:[]);s.enter().append("path").classed("js-fill",true);s.exit().remove();s.attr("d","M5,0h30v6h-30z").call(o.fillGroupStyle);var u=n.select(this).select(".legendlines").selectAll("path").data(i?[e]:[]);u.enter().append("path").classed("js-line",true).attr("d","M5,0h30");u.exit().remove();u.call(o.lineGroupStyle)}function f(e){var t=e[0],i=t.trace,s=l.hasMarkers(i),u=l.hasText(i),c=l.hasLines(i);var f,h;function p(e,t,r){var n=a.nestedProperty(i,e).get(),o=Array.isArray(n)&&t?t(n):n;if(r){if(o<r[0])return r[0];else if(o>r[1])return r[1]}return o}function d(e){return e[0]}if(s||u||c){var v={};var m={};if(s){v.mc=p("marker.color",d);v.mo=p("marker.opacity",a.mean,[.2,1]);v.ms=p("marker.size",a.mean,[2,16]);v.mlc=p("marker.line.color",d);v.mlw=p("marker.line.width",a.mean,[0,5]);m.marker={sizeref:1,sizemin:1,sizemode:"diameter"}}if(c){m.line={width:p("line.width",d,[0,10])}}if(u){v.tx="Aa";v.tp=p("textposition",d);v.ts=10;v.tc=p("textfont.color",d);v.tf=p("textfont.family",d)}f=[a.minExtend(t,v)];h=a.minExtend(i,m);h.selectedpoints=null}var g=n.select(this).select("g.legendpoints");var y=g.selectAll("path.scatterpts").data(s?f:[]);y.enter().append("path").classed("scatterpts",true).attr("transform","translate(20,0)");y.exit().remove();y.call(o.pointStyle,h,r);if(s)f[0].mrc=3;var _=g.selectAll("g.pointtext").data(u?f:[]);_.enter().append("g").classed("pointtext",true).append("text").attr("transform","translate(20,0)");_.exit().remove();_.selectAll("text").call(o.textPointStyle,h,r)}function h(e){var t=e[0].trace,r=t.marker||{},a=r.line||{},o=n.select(this).select("g.legendpoints").selectAll("path.legendbar").data(i.traceIs(t,"bar")?[e]:[]);o.enter().append("path").classed("legendbar",true).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)");o.exit().remove();o.each(function(e){var t=n.select(this),i=e[0],o=(i.mlw+1||a.width+1)-1;t.style("stroke-width",o+"px").call(s.fill,i.mc||r.color);if(o){t.call(s.stroke,i.mlc||a.color)}})}function p(e){var t=e[0].trace,r=n.select(this).select("g.legendpoints").selectAll("path.legendbox").data(i.traceIs(t,"box-violin")&&t.visible?[e]:[]);r.enter().append("path").classed("legendbox",true).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)");r.exit().remove();r.each(function(){var e=t.line.width,r=n.select(this);r.style("stroke-width",e+"px").call(s.fill,t.fillcolor);if(e){s.stroke(r,t.line.color)}})}function d(e){var t=e[0].trace,r=n.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(t.type==="candlestick"&&t.visible?[e,e]:[]);r.enter().append("path").classed("legendcandle",true).attr("d",function(e,t){if(t)return"M-15,0H-8M-8,6V-6H8Z";return"M15,0H8M8,-6V6H-8Z"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1);r.exit().remove();r.each(function(e,r){var i=t[r?"increasing":"decreasing"];var a=i.line.width,o=n.select(this);o.style("stroke-width",a+"px").call(s.fill,i.fillcolor);if(a){s.stroke(o,i.line.color)}})}function v(e){var t=e[0].trace,r=n.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(t.type==="ohlc"&&t.visible?[e,e]:[]);r.enter().append("path").classed("legendohlc",true).attr("d",function(e,t){if(t)return"M-15,0H0M-8,-6V0";return"M15,0H0M8,6V0"}).attr("transform","translate(20,0)").style("stroke-miterlimit",1);r.exit().remove();r.each(function(e,r){var i=t[r?"increasing":"decreasing"];var a=i.line.width,l=n.select(this);l.style("fill","none").call(o.dashLine,i.line.dash,a);if(a){s.stroke(l,i.line.color)}})}function m(e){var t=e[0].trace,r=n.select(this).select("g.legendpoints").selectAll("path.legendpie").data(i.traceIs(t,"pie")&&t.visible?[e]:[]);r.enter().append("path").classed("legendpie",true).attr("d","M6,6H-6V-6H6Z").attr("transform","translate(20,0)");r.exit().remove();if(r.size())r.call(u,e[0],t)}}},{"../../lib":161,"../../registry":253,"../../traces/pie/style_one":263,"../../traces/scatter/subtypes":287,"../color":42,"../drawing":67,d3:6}],104:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../plots/plots");var a=e("../../plots/cartesian/axis_ids");var o=e("../../lib");var s=e("../../../build/ploticon");var l=o._;var u=t.exports={};u.toImage={name:"toImage",title:function(e){var t=e._context.toImageButtonOptions||{};var r=t.format||"png";return r==="png"?l(e,"Download plot as a png"):l(e,"Download plot")},icon:s.camera,click:function(e){var t=e._context.toImageButtonOptions;var r={format:t.format||"png"};o.notifier(l(e,"Taking snapshot - this may take a few seconds"),"long");if(r.format!=="svg"&&o.isIE()){o.notifier(l(e,"IE only supports svg.  Changing format to svg."),"long");r.format="svg"}["filename","width","height","scale"].forEach(function(e){if(t[e]){r[e]=t[e]}});n.call("downloadImage",e,r).then(function(t){o.notifier(l(e,"Snapshot succeeded")+" - "+t,"long")}).catch(function(){o.notifier(l(e,"Sorry, there was a problem downloading your snapshot!"),"long")})}};u.sendDataToCloud={name:"sendDataToCloud",title:function(e){return l(e,"Edit in Chart Studio")},icon:s.disk,click:function(e){i.sendDataToCloud(e)}};u.zoom2d={name:"zoom2d",title:function(e){return l(e,"Zoom")},attr:"dragmode",val:"zoom",icon:s.zoombox,click:c};u.pan2d={name:"pan2d",title:function(e){return l(e,"Pan")},attr:"dragmode",val:"pan",icon:s.pan,click:c};u.select2d={name:"select2d",title:function(e){return l(e,"Box Select")},attr:"dragmode",val:"select",icon:s.selectbox,click:c};u.lasso2d={name:"lasso2d",title:function(e){return l(e,"Lasso Select")},attr:"dragmode",val:"lasso",icon:s.lasso,click:c};u.zoomIn2d={name:"zoomIn2d",title:function(e){return l(e,"Zoom in")},attr:"zoom",val:"in",icon:s.zoom_plus,click:c};u.zoomOut2d={name:"zoomOut2d",title:function(e){return l(e,"Zoom out")},attr:"zoom",val:"out",icon:s.zoom_minus,click:c};u.autoScale2d={name:"autoScale2d",title:function(e){return l(e,"Autoscale")},attr:"zoom",val:"auto",icon:s.autoscale,click:c};u.resetScale2d={name:"resetScale2d",title:function(e){return l(e,"Reset axes")},attr:"zoom",val:"reset",icon:s.home,click:c};u.hoverClosestCartesian={name:"hoverClosestCartesian",title:function(e){return l(e,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:s.tooltip_basic,gravity:"ne",click:c};u.hoverCompareCartesian={name:"hoverCompareCartesian",title:function(e){return l(e,"Compare data on hover")},attr:"hovermode",val:function(e){return e._fullLayout._isHoriz?"y":"x"},icon:s.tooltip_compare,gravity:"ne",click:c};function c(e,t){var r=t.currentTarget;var i=r.getAttribute("data-attr");var o=r.getAttribute("data-val")||true;var s=e._fullLayout;var l={};var u=a.list(e,null,true);var c="on";var f,h;if(i==="zoom"){var p=o==="in"?.5:2,d=(1+p)/2,v=(1-p)/2;var m;for(h=0;h<u.length;h++){f=u[h];if(!f.fixedrange){m=f._name;if(o==="auto")l[m+".autorange"]=true;else if(o==="reset"){if(f._rangeInitial===undefined){l[m+".autorange"]=true}else{var g=f._rangeInitial.slice();l[m+".range[0]"]=g[0];l[m+".range[1]"]=g[1]}if(f._showSpikeInitial!==undefined){l[m+".showspikes"]=f._showSpikeInitial;if(c==="on"&&!f._showSpikeInitial){c="off"}}}else{var y=[f.r2l(f.range[0]),f.r2l(f.range[1])];var _=[d*y[0]+v*y[1],d*y[1]+v*y[0]];l[m+".range[0]"]=f.l2r(_[0]);l[m+".range[1]"]=f.l2r(_[1])}}}s._cartesianSpikesEnabled=c}else{if(i==="hovermode"&&(o==="x"||o==="y")){o=s._isHoriz?"y":"x";r.setAttribute("data-val",o)}else if(i==="hovermode"&&o==="closest"){for(h=0;h<u.length;h++){f=u[h];if(c==="on"&&!f.showspikes){c="off"}}s._cartesianSpikesEnabled=c}l[i]=o}n.call("relayout",e,l)}u.zoom3d={name:"zoom3d",title:function(e){return l(e,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:s.zoombox,click:f};u.pan3d={name:"pan3d",title:function(e){return l(e,"Pan")},attr:"scene.dragmode",val:"pan",icon:s.pan,click:f};u.orbitRotation={name:"orbitRotation",title:function(e){return l(e,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:s["3d_rotate"],click:f};u.tableRotation={name:"tableRotation",title:function(e){return l(e,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:s["z-axis"],click:f};function f(e,t){var r=t.currentTarget;var i=r.getAttribute("data-attr");var a=r.getAttribute("data-val")||true;var o=e._fullLayout._subplots.gl3d;var s={};var l=i.split(".");for(var u=0;u<o.length;u++){s[o[u]+"."+l[1]]=a}var c=a==="pan"?a:"zoom";s.dragmode=c;n.call("relayout",e,s)}u.resetCameraDefault3d={name:"resetCameraDefault3d",title:function(e){return l(e,"Reset camera to default")},attr:"resetDefault",icon:s.home,click:h};u.resetCameraLastSave3d={name:"resetCameraLastSave3d",title:function(e){return l(e,"Reset camera to last save")},attr:"resetLastSave",icon:s.movie,click:h};function h(e,t){var r=t.currentTarget;var i=r.getAttribute("data-attr");var a=e._fullLayout;var s=a._subplots.gl3d;var l={};for(var u=0;u<s.length;u++){var c=s[u],f=c+".camera",h=a[c]._scene;if(i==="resetDefault"){l[f]=null}else if(i==="resetLastSave"){l[f]=o.extendDeep({},h.cameraInitial)}}n.call("relayout",e,l)}u.hoverClosest3d={name:"hoverClosest3d",title:function(e){return l(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:s.tooltip_basic,gravity:"ne",click:p};function p(e,t){var r=t.currentTarget;var i=r._previousVal||false;var a=e.layout;var s=e._fullLayout;var l=s._subplots.gl3d;var u=["xaxis","yaxis","zaxis"];var c=["showspikes","spikesides","spikethickness","spikecolor"];var f={};var h={};var p={};if(i){p=o.extendDeep(a,i);r._previousVal=null}else{p={"allaxes.showspikes":false};for(var d=0;d<l.length;d++){var v=l[d],m=s[v],g=f[v]={};g.hovermode=m.hovermode;p[v+".hovermode"]=false;for(var y=0;y<3;y++){var _=u[y];h=g[_]={};for(var x=0;x<c.length;x++){var b=c[x];h[b]=m[_][b]}}}r._previousVal=o.extendDeep({},f)}n.call("relayout",e,p)}u.zoomInGeo={name:"zoomInGeo",title:function(e){return l(e,"Zoom in")},attr:"zoom",val:"in",icon:s.zoom_plus,click:d};u.zoomOutGeo={name:"zoomOutGeo",title:function(e){return l(e,"Zoom out")},attr:"zoom",val:"out",icon:s.zoom_minus,click:d};u.resetGeo={name:"resetGeo",title:function(e){return l(e,"Reset")},attr:"reset",val:null,icon:s.autoscale,click:d};u.hoverClosestGeo={name:"hoverClosestGeo",title:function(e){return l(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:s.tooltip_basic,gravity:"ne",click:v};function d(e,t){var r=t.currentTarget;var i=r.getAttribute("data-attr");var a=r.getAttribute("data-val")||true;var o=e._fullLayout;var s=o._subplots.geo;for(var l=0;l<s.length;l++){var u=s[l];var c=o[u];if(i==="zoom"){var f=c.projection.scale;var h=a==="in"?2*f:.5*f;n.call("relayout",e,u+".projection.scale",h)}else if(i==="reset"){g(e,"geo")}}}u.hoverClosestGl2d={name:"hoverClosestGl2d",title:function(e){return l(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:s.tooltip_basic,gravity:"ne",click:v};u.hoverClosestPie={name:"hoverClosestPie",title:function(e){return l(e,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:s.tooltip_basic,gravity:"ne",click:v};function v(e){var t=e._fullLayout;var r;if(t._has("cartesian")){r=t._isHoriz?"y":"x"}else r="closest";var i=e._fullLayout.hovermode?false:r;n.call("relayout",e,"hovermode",i)}u.toggleHover={name:"toggleHover",title:function(e){return l(e,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:true,icon:s.tooltip_basic,gravity:"ne",click:function(e,t){v(e);p(e,t)}};u.resetViews={name:"resetViews",title:function(e){return l(e,"Reset views")},icon:s.home,click:function(e,t){var r=t.currentTarget;r.setAttribute("data-attr","zoom");r.setAttribute("data-val","reset");c(e,t);r.setAttribute("data-attr","resetLastSave");h(e,t);g(e,"geo");g(e,"mapbox")}};u.toggleSpikelines={name:"toggleSpikelines",title:function(e){return l(e,"Toggle Spike Lines")},icon:s.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(e){var t=e._fullLayout;t._cartesianSpikesEnabled=t._cartesianSpikesEnabled==="on"?"off":"on";var r=m(e);n.call("relayout",e,r)}};function m(e){var t=e._fullLayout;var r=a.list(e,null,true);var n={};var i,o;for(var s=0;s<r.length;s++){i=r[s];o=i._name;n[o+".showspikes"]=t._cartesianSpikesEnabled==="on"?true:i._showSpikeInitial}return n}u.resetViewMapbox={name:"resetViewMapbox",title:function(e){return l(e,"Reset view")},attr:"reset",icon:s.home,click:function(e){g(e,"mapbox")}};function g(e,t){var r=e._fullLayout;var i=r._subplots[t];var a={};for(var o=0;o<i.length;o++){var s=i[o];var l=r[s]._subplot;var u=l.viewInitial;var c=Object.keys(u);for(var f=0;f<c.length;f++){var h=c[f];a[s+"."+h]=u[h]}}n.call("relayout",e,a)}},{"../../../build/ploticon":2,"../../lib":161,"../../plots/cartesian/axis_ids":208,"../../plots/plots":244,"../../registry":253}],105:[function(e,t,r){"use strict";r.manage=e("./manage")},{"./manage":106}],106:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axis_ids");var i=e("../../traces/scatter/subtypes");var a=e("../../registry");var o=e("./modebar");var s=e("./buttons");t.exports=function e(t){var r=t._fullLayout,n=t._context,i=r._modeBar;if(!n.displayModeBar){if(i){i.destroy();delete r._modeBar}return}if(!Array.isArray(n.modeBarButtonsToRemove)){throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "))}if(!Array.isArray(n.modeBarButtonsToAdd)){throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "))}var a=n.modeBarButtons;var s;if(Array.isArray(a)&&a.length){s=h(a)}else{s=l(t,n.modeBarButtonsToRemove,n.modeBarButtonsToAdd)}if(i)i.update(t,s);else r._modeBar=o(t,s)};function l(e,t,r){var n=e._fullLayout;var i=e._fullData;var a=n._has("cartesian");var o=n._has("gl3d");var l=n._has("geo");var h=n._has("pie");var p=n._has("gl2d");var d=n._has("ternary");var v=n._has("mapbox");var m=n._has("polar");var g=u(n);var y=[];function _(e){if(!e.length)return;var r=[];for(var n=0;n<e.length;n++){var i=e[n];if(t.indexOf(i)!==-1)continue;r.push(s[i])}y.push(r)}_(["toImage","sendDataToCloud"]);var x=[];var b=[];var w=[];var k=[];if((a||p||h||d)+l+o+v+m>1){b=["toggleHover"];w=["resetViews"]}else if(l){x=["zoomInGeo","zoomOutGeo"];b=["hoverClosestGeo"];w=["resetGeo"]}else if(o){b=["hoverClosest3d"];w=["resetCameraDefault3d","resetCameraLastSave3d"]}else if(v){b=["toggleHover"];w=["resetViewMapbox"]}else if(p){b=["hoverClosestGl2d"]}else if(h){b=["hoverClosestPie"]}else{b=["toggleHover"]}if(a){b=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]}if((a||p)&&!g){x=["zoomIn2d","zoomOut2d","autoScale2d"];if(w[0]!=="resetViews")w=["resetScale2d"]}if(o){k=["zoom3d","pan3d","orbitRotation","tableRotation"]}else if((a||p)&&!g||d){k=["zoom2d","pan2d"]}else if(v||l){k=["pan2d"]}else if(m){k=["zoom2d"]}if(c(i)){k.push("select2d","lasso2d")}_(k);_(x.concat(w));_(b);return f(y,r)}function u(e){var t=n.list({_fullLayout:e},null,true);for(var r=0;r<t.length;r++){if(!t[r].fixedrange){return false}}return true}function c(e){var t=false;for(var r=0;r<e.length;r++){if(t)break;var n=e[r];if(!n._module||!n._module.selectPoints)continue;if(a.traceIs(n,"scatter-like")){if(i.hasMarkers(n)||i.hasText(n)){t=true}}else if(a.traceIs(n,"box-violin")){if(n.boxpoints==="all"||n.points==="all"){t=true}}else t=true}return t}function f(e,t){if(t.length){if(Array.isArray(t[0])){for(var r=0;r<t.length;r++){e.push(t[r])}}else e.push(t)}return e}function h(e){for(var t=0;t<e.length;t++){var r=e[t];for(var n=0;n<r.length;n++){var i=r[n];if(typeof i==="string"){if(s[i]!==undefined){e[t][n]=s[i]}else{throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "))}}}}return e}},{"../../plots/cartesian/axis_ids":208,"../../registry":253,"../../traces/scatter/subtypes":287,"./buttons":104,"./modebar":107}],107:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../../lib");var o=e("../../../build/ploticon");function s(e){this.container=e.container;this.element=document.createElement("div");this.update(e.graphInfo,e.buttons);this.container.appendChild(this.element)}var l=s.prototype;l.update=function(e,t){this.graphInfo=e;var r=this.graphInfo._context;if(r.displayModeBar==="hover"){this.element.className="modebar modebar--hover"}else this.element.className="modebar";var n=!this.hasButtons(t);var i=this.hasLogo!==r.displaylogo;var a=this.locale!==r.locale;this.locale=r.locale;if(n||i||a){this.removeAllButtons();this.updateButtons(t);if(r.displaylogo){this.element.appendChild(this.getLogo());this.hasLogo=true}}this.updateActiveButton()};l.updateButtons=function(e){var t=this;this.buttons=e;this.buttonElements=[];this.buttonsNames=[];this.buttons.forEach(function(e){var r=t.createGroup();e.forEach(function(e){var n=e.name;if(!n){throw new Error("must provide button 'name' in button config")}if(t.buttonsNames.indexOf(n)!==-1){throw new Error("button name '"+n+"' is taken")}t.buttonsNames.push(n);var i=t.createButton(e);t.buttonElements.push(i);r.appendChild(i)});t.element.appendChild(r)})};l.createGroup=function(){var e=document.createElement("div");e.className="modebar-group";return e};l.createButton=function(e){var t=this,r=document.createElement("a");r.setAttribute("rel","tooltip");r.className="modebar-btn";var i=e.title;if(i===undefined)i=e.name;else if(typeof i==="function")i=i(this.graphInfo);if(i||i===0)r.setAttribute("data-title",i);if(e.attr!==undefined)r.setAttribute("data-attr",e.attr);var a=e.val;if(a!==undefined){if(typeof a==="function")a=a(this.graphInfo);r.setAttribute("data-val",a)}var s=e.click;if(typeof s!=="function"){throw new Error("must provide button 'click' function in button config")}else{r.addEventListener("click",function(r){e.click(t.graphInfo,r);t.updateActiveButton(r.currentTarget)})}r.setAttribute("data-toggle",e.toggle||false);if(e.toggle)n.select(r).classed("active",true);var l=e.icon;if(typeof l==="function"){r.appendChild(l())}else{r.appendChild(this.createIcon(l||o.question))}r.setAttribute("data-gravity",e.gravity||"n");return r};l.createIcon=function(e){var t=i(e.height)?Number(e.height):e.ascent-e.descent,r="http://www.w3.org/2000/svg",n=document.createElementNS(r,"svg"),a=document.createElementNS(r,"path");n.setAttribute("height","1em");n.setAttribute("width",e.width/t+"em");n.setAttribute("viewBox",[0,0,e.width,t].join(" "));a.setAttribute("d",e.path);if(e.transform){a.setAttribute("transform",e.transform)}else if(e.ascent!==undefined){a.setAttribute("transform","matrix(1 0 0 -1 0 "+e.ascent+")")}n.appendChild(a);return n};l.updateActiveButton=function(e){var t=this.graphInfo._fullLayout,r=e!==undefined?e.getAttribute("data-attr"):null;this.buttonElements.forEach(function(e){var i=e.getAttribute("data-val")||true,o=e.getAttribute("data-attr"),s=e.getAttribute("data-toggle")==="true",l=n.select(e);if(s){if(o===r){l.classed("active",!l.classed("active"))}}else{var u=o===null?o:a.nestedProperty(t,o).get();l.classed("active",u===i)}})};l.hasButtons=function(e){var t=this.buttons;if(!t)return false;if(e.length!==t.length)return false;for(var r=0;r<e.length;++r){if(e[r].length!==t[r].length)return false;for(var n=0;n<e[r].length;n++){if(e[r][n].name!==t[r][n].name)return false}}return true};l.getLogo=function(){var e=this.createGroup(),t=document.createElement("a");t.href="https://plot.ly/";t.target="_blank";t.setAttribute("data-title",a._(this.graphInfo,"Produced with Plotly"));t.className="modebar-btn plotlyjsicon modebar-btn--logo";t.appendChild(this.createIcon(o.plotlylogo));e.appendChild(t);return e};l.removeAllButtons=function(){while(this.element.firstChild){this.element.removeChild(this.element.firstChild)}this.hasLogo=false};l.destroy=function(){a.removeElement(this.container.querySelector(".modebar"))};function u(e,t){var r=e._fullLayout;var i=new s({graphInfo:e,container:r._paperdiv.node(),buttons:t});if(r._privateplot){n.select(i.element).append("span").classed("badge-private float--left",true).text("PRIVATE")}return i}t.exports=u},{"../../../build/ploticon":2,"../../lib":161,d3:6,"fast-isnumeric":9}],108:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var i=e("../color/attributes");var a=e("../../plot_api/plot_template").templatedArray;var o=a("button",{visible:{valType:"boolean",dflt:true,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});t.exports={visible:{valType:"boolean",editType:"plot"},buttons:o,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:n({editType:"plot"}),bgcolor:{valType:"color",dflt:i.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:i.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":195,"../../plots/font_attributes":231,"../color/attributes":41}],109:[function(e,t,r){"use strict";t.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],110:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../color");var a=e("../../plot_api/plot_template");var o=e("../../plots/array_container_defaults");var s=e("./attributes");var l=e("./constants");t.exports=function e(t,r,f,h,p){var d=t.rangeselector||{};var v=a.newContainer(r,"rangeselector");function m(e,t){return n.coerce(d,v,s,e,t)}var g=o(d,v,{name:"buttons",handleItemDefaults:u,calendar:p});var y=m("visible",g.length>0);if(y){var _=c(r,f,h);m("x",_[0]);m("y",_[1]);n.noneOrAll(t,r,["x","y"]);m("xanchor");m("yanchor");n.coerceFont(m,"font",f.font);var x=m("bgcolor");m("activecolor",i.contrast(x,l.lightAmount,l.darkAmount));m("bordercolor");m("borderwidth")}};function u(e,t,r,i){var a=i.calendar;function o(r,i){return n.coerce(e,t,s.buttons,r,i)}var l=o("visible");if(l){var u=o("step");if(u!=="all"){if(a&&a!=="gregorian"&&(u==="month"||u==="year")){t.stepmode="backward"}else{o("stepmode")}o("count")}o("label")}}function c(e,t,r){var n=r.filter(function(r){return t[r].anchor===e._id});var i=0;for(var a=0;a<n.length;a++){var o=t[n[a]].domain;if(o)i=Math.max(o[1],i)}return[e.domain[0],i+l.yPad]}},{"../../lib":161,"../../plot_api/plot_template":195,"../../plots/array_container_defaults":201,"../color":42,"./attributes":108,"./constants":109}],111:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../plots/plots");var o=e("../color");var s=e("../drawing");var l=e("../../lib");var u=e("../../lib/svg_text_utils");var c=e("../../plots/cartesian/axis_ids");var f=e("../legend/anchor_utils");var h=e("../../constants/alignment");var p=h.LINE_SPACING;var d=h.FROM_TL;var v=h.FROM_BR;var m=e("./constants");var g=e("./get_update_object");t.exports=function e(t){var r=t._fullLayout;var a=r._infolayer.selectAll(".rangeselector").data(y(t),_);a.enter().append("g").classed("rangeselector",true);a.exit().remove();a.style({cursor:"pointer","pointer-events":"all"});a.each(function(e){var r=n.select(this),a=e,o=a.rangeselector;var s=r.selectAll("g.button").data(l.filterVisible(o.buttons));s.enter().append("g").classed("button",true);s.exit().remove();s.each(function(e){var r=n.select(this);var s=g(a,e);e._isActive=x(a,e,s);r.call(b,o,e);r.call(k,o,e,t);r.on("click",function(){if(t._dragged)return;i.call("relayout",t,s)});r.on("mouseover",function(){e._isHovered=true;r.call(b,o,e)});r.on("mouseout",function(){e._isHovered=false;r.call(b,o,e)})});T(t,s,o,a._name,r)})};function y(e){var t=c.list(e,"x",true);var r=[];for(var n=0;n<t.length;n++){var i=t[n];if(i.rangeselector&&i.rangeselector.visible){r.push(i)}}return r}function _(e){return e._id}function x(e,t,r){if(t.step==="all"){return e.autorange===true}else{var n=Object.keys(r);return e.range[0]===r[n[0]]&&e.range[1]===r[n[1]]}}function b(e,t,r){var n=l.ensureSingle(e,"rect","selector-rect",function(e){e.attr("shape-rendering","crispEdges")});n.attr({rx:m.rx,ry:m.ry});n.call(o.stroke,t.bordercolor).call(o.fill,w(t,r)).style("stroke-width",t.borderwidth+"px")}function w(e,t){return t._isActive||t._isHovered?e.activecolor:e.bgcolor}function k(e,t,r,n){function i(e){u.convertToTspans(e,n)}var a=l.ensureSingle(e,"text","selector-text",function(e){e.classed("user-select-none",true).attr("text-anchor","middle")});a.call(s.font,t.font).text(A(r)).call(i)}function A(e){if(e.label)return e.label;if(e.step==="all")return"all";return e.count+e.step.charAt(0)}function T(e,t,r,i,o){var l=0;var c=0;var h=r.borderwidth;t.each(function(){var e=n.select(this);var t=e.select(".selector-text");var i=r.font.size*p;var a=Math.max(i*u.lineCount(t),16)+3;c=Math.max(c,a)});t.each(function(){var e=n.select(this);var t=e.select(".selector-rect");var i=e.select(".selector-text");var a=i.node()&&s.bBox(i.node()).width;var o=r.font.size*p;var f=u.lineCount(i);var d=Math.max(a+10,m.minButtonWidth);e.attr("transform","translate("+(h+l)+","+h+")");t.attr({x:0,y:0,width:d,height:c});u.positionText(i,d/2,c/2-(f-1)*o/2+3);l+=d+5});var g=e._fullLayout._size;var y=g.l+g.w*r.x;var _=g.t+g.h*(1-r.y);var x="left";if(f.isRightAnchor(r)){y-=l;x="right"}if(f.isCenterAnchor(r)){y-=l/2;x="center"}var b="top";if(f.isBottomAnchor(r)){_-=c;b="bottom"}if(f.isMiddleAnchor(r)){_-=c/2;b="middle"}l=Math.ceil(l);c=Math.ceil(c);y=Math.round(y);_=Math.round(_);a.autoMargin(e,i+"-range-selector",{x:r.x,y:r.y,l:l*d[x],r:l*v[x],b:c*v[b],t:c*d[b]});o.attr("transform","translate("+y+","+_+")")}},{"../../constants/alignment":140,"../../lib":161,"../../lib/svg_text_utils":182,"../../plots/cartesian/axis_ids":208,"../../plots/plots":244,"../../registry":253,"../color":42,"../drawing":67,"../legend/anchor_utils":94,"./constants":109,"./get_update_object":112,d3:6}],112:[function(e,t,r){"use strict";var n=e("d3");t.exports=function e(t,r){var n=t._name;var a={};if(r.step==="all"){a[n+".autorange"]=true}else{var o=i(t,r);a[n+".range[0]"]=o[0];a[n+".range[1]"]=o[1]}return a};function i(e,t){var r=e.range;var i=new Date(e.r2l(r[1]));var a=t.step,o=t.count;var s;switch(t.stepmode){case"backward":s=e.l2r(+n.time[a].utc.offset(i,-o));break;case"todate":var l=n.time[a].utc.offset(i,-o);s=e.l2r(+n.time[a].utc.ceil(l));break}var u=r[1];return[s,u]}},{d3:6}],113:[function(e,t,r){"use strict";t.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:e("./attributes")}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":108,"./defaults":110,"./draw":111}],114:[function(e,t,r){"use strict";var n=e("../color/attributes");t.exports={bgcolor:{valType:"color",dflt:n.background,editType:"plot"},bordercolor:{valType:"color",dflt:n.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:true,editType:"calc",impliedEdits:{"range[0]":undefined,"range[1]":undefined}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":false}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":false}}],editType:"calc",impliedEdits:{autorange:false}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:true,editType:"calc"},editType:"calc"}},{"../color/attributes":41}],115:[function(e,t,r){"use strict";var n=e("../../plots/cartesian/axis_ids").list;var i=e("../../plots/cartesian/autorange").getAutoRange;var a=e("./constants");t.exports=function e(t){var r=n(t,"x",true);for(var o=0;o<r.length;o++){var s=r[o],l=s[a.name];if(l&&l.visible&&l.autorange&&s._min.length&&s._max.length){l._input.autorange=true;l._input.range=l.range=i(s)}}}},{"../../plots/cartesian/autorange":204,"../../plots/cartesian/axis_ids":208,"./constants":116}],116:[function(e,t,r){"use strict";t.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],117:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plot_api/plot_template");var a=e("../../plots/cartesian/axis_ids");var o=e("./attributes");var s=e("./oppaxis_attributes");t.exports=function e(t,r,l){var u=t[l];var c=r[l];if(!(u.rangeslider||r._requestRangeslider[c._id]))return;if(!n.isPlainObject(u.rangeslider)){u.rangeslider={}}var f=u.rangeslider;var h=i.newContainer(c,"rangeslider");function p(e,t){return n.coerce(f,h,o,e,t)}var d,v;function m(e,t){return n.coerce(d,v,s,e,t)}var g=p("visible");if(!g)return;p("bgcolor",r.plot_bgcolor);p("bordercolor");p("borderwidth");p("thickness");c._rangesliderAutorange=p("autorange",!c.isValidRange(f.range));p("range");var y=r._subplots;if(y){var _=y.cartesian.filter(function(e){return e.substr(0,e.indexOf("y"))===a.name2id(l)}).map(function(e){return e.substr(e.indexOf("y"),e.length)});var x=n.simpleMap(_,a.id2name);for(var b=0;b<x.length;b++){var w=x[b];d=f[w]||{};v=i.newContainer(h,w,"yaxis");var k=r[w];var A;if(d.range&&k.isValidRange(d.range)){A="fixed"}var T=m("rangemode",A);if(T!=="match"){m("range",k.range.slice())}k._rangesliderAutorange=T==="auto"}}h._input=f}},{"../../lib":161,"../../plot_api/plot_template":195,"../../plots/cartesian/axis_ids":208,"./attributes":114,"./oppaxis_attributes":120}],118:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../plots/plots");var o=e("../../lib");var s=e("../drawing");var l=e("../color");var u=e("../titles");var c=e("../../plots/cartesian");var f=e("../../plots/cartesian/axes");var h=e("../dragelement");var p=e("../../lib/setcursor");var d=e("./constants");t.exports=function(e){var t=e._fullLayout,r=v(t);function i(e){return e._name}var o=t._infolayer.selectAll("g."+d.containerClassName).data(r,i);o.enter().append("g").classed(d.containerClassName,true).attr("pointer-events","all");o.exit().each(function(e){var r=e[d.name];t._topdefs.select("#"+r._clipId).remove()}).remove();if(r.length===0)return;o.each(function(r){var i=n.select(this),o=r[d.name],s=t[f.id2name(r.anchor)],l=o[f.id2name(r.anchor)];if(o.range){var c=o.range;var h=r.range;c[0]=r.l2r(Math.min(r.r2l(c[0]),r.r2l(h[0])));c[1]=r.l2r(Math.max(r.r2l(c[1]),r.r2l(h[1])));o._input.range=c.slice()}r.cleanRange("rangeslider.range");var p=t.margin;var v=t._size;var g=r.domain;var w=(r._boundingBox||{}).height||0;var M=Infinity;var S=f.getSubplots(e,r);for(var C=0;C<S.length;C++){var z=f.getFromId(e,S[C].substr(S[C].indexOf("y")));M=Math.min(M,z.domain[0])}o._id=d.name+r._id;o._clipId=o._id+"-"+t._uid;o._width=v.w*(g[1]-g[0]);o._height=(t.height-p.b-p.t)*o.thickness;o._offsetShift=Math.floor(o.borderwidth/2);var E=Math.round(p.l+v.w*g[0]);var L=Math.round(v.t+v.h*(1-M)+w+o._offsetShift+d.extraPad);i.attr("transform","translate("+E+","+L+")");var I=r.r2l(o.range[0]),P=r.r2l(o.range[1]),D=P-I;o.p2d=function(e){return e/o._width*D+I};o.d2p=function(e){return(e-I)/D*o._width};o._rl=[I,P];if(l.rangemode!=="match"){var O=s.r2l(l.range[0]),R=s.r2l(l.range[1]),F=R-O;o.d2pOppAxis=function(e){return(e-O)/F*o._height}}i.call(_,e,r,o).call(x,e,r,o).call(b,e,r,o).call(k,e,r,o,l).call(A,e,r,o).call(T,e,r,o);m(i,e,r,o);y(i,e,r,o,s,l);if(r.side==="bottom"){u.draw(e,r._id+"title",{propContainer:r,propName:r._name+".title",placeholder:t._dfltTitle.x,attributes:{x:r._offset+r._length/2,y:L+o._height+o._offsetShift+10+1.5*r.titlefont.size,"text-anchor":"middle"}})}a.autoMargin(e,o._id,{x:g[0],y:M,l:0,r:0,t:0,b:o._height+p.b+w,pad:d.extraPad+o._offsetShift*2})})};function v(e){var t=f.list({_fullLayout:e},"x",true),r=d.name,n=[];if(e._has("gl2d"))return n;for(var i=0;i<t.length;i++){var a=t[i];if(a[r]&&a[r].visible)n.push(a)}return n}function m(e,t,r,i){var a=e.select("rect."+d.slideBoxClassName).node(),s=e.select("rect."+d.grabAreaMinClassName).node(),l=e.select("rect."+d.grabAreaMaxClassName).node();e.on("mousedown",function(){var u=n.event,c=u.target,f=u.clientX,d=f-e.node().getBoundingClientRect().left,v=i.d2p(r._rl[0]),m=i.d2p(r._rl[1]);var y=h.coverSlip();y.addEventListener("mousemove",_);y.addEventListener("mouseup",x);function _(o){var u=+o.clientX-f;var h,_,x;switch(c){case a:x="ew-resize";h=v+u;_=m+u;break;case s:x="col-resize";h=v+u;_=m;break;case l:x="col-resize";h=v;_=m+u;break;default:x="ew-resize";h=d;_=d+u;break}if(_<h){var b=_;_=h;h=b}i._pixelMin=h;i._pixelMax=_;p(n.select(y),x);g(e,t,r,i)}function x(){y.removeEventListener("mousemove",_);y.removeEventListener("mouseup",x);o.removeElement(y)}})}function g(e,t,r,n){function a(e){return r.l2r(o.constrain(e,n._rl[0],n._rl[1]))}var s=a(n.p2d(n._pixelMin)),l=a(n.p2d(n._pixelMax));window.requestAnimationFrame(function(){i.call("relayout",t,r._name+".range",[s,l])})}function y(e,t,r,n,i,a){var s=d.handleWidth/2;function l(e){return o.constrain(e,0,n._width)}function u(e){return o.constrain(e,0,n._height)}function c(e){return o.constrain(e,-s,n._width+s)}var f=l(n.d2p(r._rl[0])),h=l(n.d2p(r._rl[1]));e.select("rect."+d.slideBoxClassName).attr("x",f).attr("width",h-f);e.select("rect."+d.maskMinClassName).attr("width",f);e.select("rect."+d.maskMaxClassName).attr("x",h).attr("width",n._width-h);if(a.rangemode!=="match"){var p=n._height-u(n.d2pOppAxis(i._rl[1])),v=n._height-u(n.d2pOppAxis(i._rl[0]));e.select("rect."+d.maskMinOppAxisClassName).attr("x",f).attr("height",p).attr("width",h-f);e.select("rect."+d.maskMaxOppAxisClassName).attr("x",f).attr("y",v).attr("height",n._height-v).attr("width",h-f);e.select("rect."+d.slideBoxClassName).attr("y",p).attr("height",v-p)}var m=.5;var g=Math.round(c(f-s))-m,y=Math.round(c(h-s))+m;e.select("g."+d.grabberMinClassName).attr("transform","translate("+g+","+m+")");e.select("g."+d.grabberMaxClassName).attr("transform","translate("+y+","+m+")")}function _(e,t,r,n){var i=o.ensureSingle(e,"rect",d.bgClassName,function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})});var a=n.borderwidth%2===0?n.borderwidth:n.borderwidth-1;var l=-n._offsetShift;var u=s.crispRound(t,n.borderwidth);i.attr({width:n._width+a,height:n._height+a,transform:"translate("+l+","+l+")",fill:n.bgcolor,stroke:n.bordercolor,"stroke-width":u})}function x(e,t,r,n){var i=t._fullLayout;var a=o.ensureSingleById(i._topdefs,"clipPath",n._clipId,function(e){e.append("rect").attr({x:0,y:0})});a.select("rect").attr({width:n._width,height:n._height})}function b(e,t,r,i){var l=f.getSubplots(t,r),u=t.calcdata;var h=e.selectAll("g."+d.rangePlotClassName).data(l,o.identity);h.enter().append("g").attr("class",function(e){return d.rangePlotClassName+" "+e}).call(s.setClipUrl,i._clipId);h.order();h.exit().remove();var p;h.each(function(e,o){var s=n.select(this),l=o===0;var h=f.getFromId(t,e,"y"),d=h._name,v=i[d];var m={data:[],layout:{xaxis:{type:r.type,domain:[0,1],range:i.range.slice(),calendar:r.calendar},width:i._width,height:i._height,margin:{t:0,b:0,l:0,r:0}},_context:t._context};m.layout[d]={type:h.type,domain:[0,1],range:v.rangemode!=="match"?v.range.slice():h.range.slice(),calendar:h.calendar};a.supplyDefaults(m);var g=m._fullLayout.xaxis;var y=m._fullLayout[d];var _={id:e,plotgroup:s,xaxis:g,yaxis:y,isRangePlot:true};if(l)p=_;else{_.mainplot="xy";_.mainplotinfo=p}c.rangePlot(t,_,w(u,e))})}function w(e,t){var r=[];for(var n=0;n<e.length;n++){var i=e[n],a=i[0].trace;if(a.xaxis+a.yaxis===t){r.push(i)}}return r}function k(e,t,r,n,i){var a=o.ensureSingle(e,"rect",d.maskMinClassName,function(e){e.attr({x:0,y:0,"shape-rendering":"crispEdges"})});a.attr("height",n._height).call(l.fill,d.maskColor);var s=o.ensureSingle(e,"rect",d.maskMaxClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});s.attr("height",n._height).call(l.fill,d.maskColor);if(i.rangemode!=="match"){var u=o.ensureSingle(e,"rect",d.maskMinOppAxisClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});u.attr("width",n._width).call(l.fill,d.maskOppAxisColor);var c=o.ensureSingle(e,"rect",d.maskMaxOppAxisClassName,function(e){e.attr({y:0,"shape-rendering":"crispEdges"})});c.attr("width",n._width).style("border-top",d.maskOppBorder).call(l.fill,d.maskOppAxisColor)}}function A(e,t,r,n){if(t._context.staticPlot)return;var i=o.ensureSingle(e,"rect",d.slideBoxClassName,function(e){e.attr({y:0,cursor:d.slideBoxCursor,"shape-rendering":"crispEdges"})});i.attr({height:n._height,fill:d.slideBoxFill})}function T(e,t,r,n){var i=o.ensureSingle(e,"g",d.grabberMinClassName);var a=o.ensureSingle(e,"g",d.grabberMaxClassName);var s={x:0,width:d.handleWidth,rx:d.handleRadius,fill:l.background,stroke:l.defaultLine,"stroke-width":d.handleStrokeWidth,"shape-rendering":"crispEdges"};var u={y:Math.round(n._height/4),height:Math.round(n._height/2)};var c=o.ensureSingle(i,"rect",d.handleMinClassName,function(e){e.attr(s)});c.attr(u);var f=o.ensureSingle(a,"rect",d.handleMaxClassName,function(e){e.attr(s)});f.attr(u);if(t._context.staticPlot)return;var h={width:d.grabAreaWidth,x:0,y:0,fill:d.grabAreaFill,cursor:d.grabAreaCursor};var p=o.ensureSingle(i,"rect",d.grabAreaMinClassName,function(e){e.attr(h)});p.attr("height",n._height);var v=o.ensureSingle(a,"rect",d.grabAreaMaxClassName,function(e){e.attr(h)});v.attr("height",n._height)}},{"../../lib":161,"../../lib/setcursor":180,"../../plots/cartesian":216,"../../plots/cartesian/axes":205,"../../plots/plots":244,"../../registry":253,"../color":42,"../dragelement":64,"../drawing":67,"../titles":133,"./constants":116,d3:6}],119:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./attributes");var a=e("./oppaxis_attributes");t.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:n.extendFlat({},i,{yaxis:a})}}},layoutAttributes:e("./attributes"),handleDefaults:e("./defaults"),calcAutorange:e("./calc_autorange"),draw:e("./draw")}},{"../../lib":161,"./attributes":114,"./calc_autorange":115,"./defaults":117,"./draw":118,"./oppaxis_attributes":120}],120:[function(e,t,r){"use strict";t.exports={_isSubplotObj:true,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],121:[function(e,t,r){"use strict";var n=e("../annotations/attributes");var i=e("../../traces/scatter/attributes").line;var a=e("../drawing/attributes").dash;var o=e("../../lib/extend").extendFlat;var s=e("../../plot_api/plot_template").templatedArray;t.exports=s("shape",{visible:{valType:"boolean",dflt:true,editType:"calcIfAutorange+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calcIfAutorange+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:o({},n.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calcIfAutorange+arraydraw"},xanchor:{valType:"any",editType:"calcIfAutorange+arraydraw"},x0:{valType:"any",editType:"calcIfAutorange+arraydraw"},x1:{valType:"any",editType:"calcIfAutorange+arraydraw"},yref:o({},n.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calcIfAutorange+arraydraw"},yanchor:{valType:"any",editType:"calcIfAutorange+arraydraw"},y0:{valType:"any",editType:"calcIfAutorange+arraydraw"},y1:{valType:"any",editType:"calcIfAutorange+arraydraw"},path:{valType:"string",editType:"calcIfAutorange+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:o({},i.color,{editType:"arraydraw"}),width:o({},i.width,{editType:"calcIfAutorange+arraydraw"}),dash:o({},a,{editType:"arraydraw"}),editType:"calcIfAutorange+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},editType:"arraydraw"})},{"../../lib/extend":154,"../../plot_api/plot_template":195,"../../traces/scatter/attributes":265,"../annotations/attributes":27,"../drawing/attributes":66}],122:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");var a=e("./constants");var o=e("./helpers");t.exports=function e(t){var r=t._fullLayout,o=n.filterVisible(r.shapes);if(!o.length||!t._fullData.length)return;for(var u=0;u<o.length;u++){var f=o[u];var h,p;if(f.xref!=="paper"){var d=f.xsizemode==="pixel"?f.xanchor:f.x0,v=f.xsizemode==="pixel"?f.xanchor:f.x1;h=i.getFromId(t,f.xref);p=c(h,d,v,f.path,a.paramIsX);if(p)i.expand(h,p,s(f))}if(f.yref!=="paper"){var m=f.ysizemode==="pixel"?f.yanchor:f.y0,g=f.ysizemode==="pixel"?f.yanchor:f.y1;h=i.getFromId(t,f.yref);p=c(h,m,g,f.path,a.paramIsY);if(p)i.expand(h,p,l(f))}}};function s(e){return u(e.line.width,e.xsizemode,e.x0,e.x1,e.path,false)}function l(e){return u(e.line.width,e.ysizemode,e.y0,e.y1,e.path,true)}function u(e,t,r,i,s,l){var u=e/2,c=l;if(t==="pixel"){var f=s?o.extractPathCoords(s,l?a.paramIsY:a.paramIsX):[r,i];var h=n.aggNums(Math.max,null,f),p=n.aggNums(Math.min,null,f),d=p<0?Math.abs(p)+u:u,v=h>0?h+u:u;return{ppad:u,ppadplus:c?d:v,ppadminus:c?v:d}}else{return{ppad:u}}}function c(e,t,r,n,i){var s=e.type==="category"?e.r2c:e.d2c;if(t!==undefined)return[s(t),s(r)];if(!n)return;var l=Infinity,u=-Infinity,c=n.match(a.segmentRE),f,h,p,d,v;if(e.type==="date")s=o.decodeDate(s);for(f=0;f<c.length;f++){h=c[f];p=i[h.charAt(0)].drawn;if(p===undefined)continue;d=c[f].substr(1).match(a.paramRE);if(!d||d.length<p)continue;v=s(d[p]);if(v<l)l=v;if(v>u)u=v}if(u>=l)return[l,u]}},{"../../lib":161,"../../plots/cartesian/axes":205,"./constants":123,"./helpers":126}],123:[function(e,t,r){"use strict";t.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:true,drawn:0},L:{0:true,drawn:0},H:{0:true,drawn:0},V:{},Q:{0:true,2:true,drawn:2},C:{0:true,2:true,4:true,drawn:4},T:{0:true,drawn:0},S:{0:true,2:true,drawn:2},Z:{}},paramIsY:{M:{1:true,drawn:1},L:{1:true,drawn:1},H:{},V:{0:true,drawn:0},Q:{1:true,3:true,drawn:3},C:{1:true,3:true,5:true,drawn:5},T:{1:true,drawn:1},S:{1:true,3:true,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],124:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/cartesian/axes");var a=e("../../plots/array_container_defaults");var o=e("./attributes");var s=e("./helpers");t.exports=function e(t,r){a(t,r,{name:"shapes",handleItemDefaults:l})};function l(e,t,r){function a(r,i){return n.coerce(e,t,o,r,i)}var l=a("visible");if(!l)return;a("layer");a("opacity");a("fillcolor");a("line.color");a("line.width");a("line.dash");var u=e.path?"path":"rect",c=a("type",u),f=a("xsizemode"),h=a("ysizemode");var p=["x","y"];for(var d=0;d<2;d++){var v=p[d],m=v+"anchor",g=v==="x"?f:h,y={_fullLayout:r},_,x,b;var w=i.coerceRef(e,t,y,v,"","paper");if(w!=="paper"){_=i.getFromId(y,w);b=s.rangeToShapePosition(_);x=s.shapePositionToRange(_)}else{x=b=n.identity}if(c!=="path"){var k=.25,A=.75;var T=v+"0",M=v+"1",S=e[T],C=e[M];e[T]=x(e[T],true);e[M]=x(e[M],true);if(g==="pixel"){a(T,0);a(M,10)}else{i.coercePosition(t,y,a,w,T,k);i.coercePosition(t,y,a,w,M,A)}t[T]=b(t[T]);t[M]=b(t[M]);e[T]=S;e[M]=C}if(g==="pixel"){var z=e[m];e[m]=x(e[m],true);i.coercePosition(t,y,a,w,m,.25);t[m]=b(t[m]);e[m]=z}}if(c==="path"){a("path")}else{n.noneOrAll(e,t,["x0","x1","y0","y1"])}}},{"../../lib":161,"../../plots/array_container_defaults":201,"../../plots/cartesian/axes":205,"./attributes":121,"./helpers":126}],125:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");var a=e("../../plots/cartesian/axes");var o=e("../color");var s=e("../drawing");var l=e("../../plot_api/plot_template").arrayEditor;var u=e("../dragelement");var c=e("../../lib/setcursor");var f=e("./constants");var h=e("./helpers");t.exports={draw:p,drawOne:d};function p(e){var t=e._fullLayout;t._shapeUpperLayer.selectAll("path").remove();t._shapeLowerLayer.selectAll("path").remove();for(var r in t._plots){var n=t._plots[r].shapelayer;if(n)n.selectAll("path").remove()}for(var i=0;i<t.shapes.length;i++){if(t.shapes[i].visible){d(e,i)}}}function d(e,t){e._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+t+'"]').remove();var r=e._fullLayout.shapes[t]||{};if(!r._input||r.visible===false)return;if(r.layer!=="below"){a(e._fullLayout._shapeUpperLayer)}else if(r.xref==="paper"||r.yref==="paper"){a(e._fullLayout._shapeLowerLayer)}else{var n=e._fullLayout._plots[r.xref+r.yref];if(n){var i=n.mainplotinfo||n;a(i.shapelayer)}else{a(e._fullLayout._shapeLowerLayer)}}function a(n){var i={"data-index":t,"fill-rule":"evenodd",d:g(e,r)},a=r.line.width?r.line.color:"rgba(0,0,0,0)";var l=n.append("path").attr(i).style("opacity",r.opacity).call(o.stroke,a).call(o.fill,r.fillcolor).call(s.dashLine,r.line.dash,r.line.width);v(l,e,r);if(e._context.edits.shapePosition)m(e,l,r,t,n)}}function v(e,t,r){var n=(r.xref+r.yref).replace(/paper/g,"");e.call(s.setClipUrl,n?"clip"+t._fullLayout._uid+n:null)}function m(e,t,r,o,p){var d=10;var m=10;var y=r.xsizemode==="pixel";var x=r.ysizemode==="pixel";var b=r.type==="line";var w=r.type==="path";var k=l(e.layout,"shapes",r);var A=k.modifyItem;var T,M,S,C,z,E;var L,I,P,D,O,R,F,B;var N;var j=a.getFromId(e,r.xref),V=a.getFromId(e,r.yref),q=h.getDataToPixel(e,j),U=h.getDataToPixel(e,V,true),Z=h.getPixelToData(e,j),H=h.getPixelToData(e,V,true);var G=X();var $={element:G.node(),gd:e,prepFn:K,doneFn:Q,clickFn:ee},W;u.init($);G.node().onmousemove=J;function X(){return b?Y():t}function Y(){var e=10,n=Math.max(r.line.width,e);var i=p.append("g").attr("data-index",o);i.append("path").attr("d",t.attr("d")).style({cursor:"move","stroke-width":n,"stroke-opacity":"0"});var a={"fill-opacity":"0"};var s=n/2>e?n/2:e;i.append("circle").attr({"data-line-point":"start-point",cx:y?q(r.xanchor)+r.x0:q(r.x0),cy:x?U(r.yanchor)-r.y0:U(r.y0),r:s}).style(a).classed("cursor-grab",true);i.append("circle").attr({"data-line-point":"end-point",cx:y?q(r.xanchor)+r.x1:q(r.x1),cy:x?U(r.yanchor)-r.y1:U(r.y1),r:s}).style(a).classed("cursor-grab",true);return i}function J(e){if(b){if(e.target.tagName==="path"){W="move"}else{W=e.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point"}}else{var r=$.element.getBoundingClientRect();var n=r.right-r.left,i=r.bottom-r.top,a=e.clientX-r.left,o=e.clientY-r.top,s=!w&&n>d&&i>m&&!e.shiftKey?u.getCursor(a/n,1-o/i):"move";c(t,s);W=s.split("-")[0]}}function K(n){if(y){z=q(r.xanchor)}if(x){E=U(r.yanchor)}if(r.type==="path"){N=r.path}else{T=y?r.x0:q(r.x0);M=x?r.y0:U(r.y0);S=y?r.x1:q(r.x1);C=x?r.y1:U(r.y1)}if(T<S){P=T;F="x0";D=S;B="x1"}else{P=S;F="x1";D=T;B="x0"}if(!x&&M<C||x&&M>C){L=M;O="y0";I=C;R="y1"}else{L=C;O="y1";I=M;R="y0"}J(n);ne(p,r);ae(t,r,e);$.moveFn=W==="move"?te:re}function Q(){c(t);ie(p);v(t,e,r);n.call("relayout",e,k.getUpdateObj())}function ee(){ie(p)}function te(n,i){if(r.type==="path"){var a=function(e){return e},o=a,s=a;if(y){A("xanchor",r.xanchor=Z(z+n))}else{o=function e(t){return Z(q(t)+n)};if(j&&j.type==="date")o=h.encodeDate(o)}if(x){A("yanchor",r.yanchor=H(E+i))}else{s=function e(t){return H(U(t)+i)};if(V&&V.type==="date")s=h.encodeDate(s)}A("path",r.path=_(N,o,s))}else{if(y){A("xanchor",r.xanchor=Z(z+n))}else{A("x0",r.x0=Z(T+n));A("x1",r.x1=Z(S+n))}if(x){A("yanchor",r.yanchor=H(E+i))}else{A("y0",r.y0=H(M+i));A("y1",r.y1=H(C+i))}}t.attr("d",g(e,r));ne(p,r)}function re(n,i){if(w){var a=function(e){return e},o=a,s=a;if(y){A("xanchor",r.xanchor=Z(z+n))}else{o=function e(t){return Z(q(t)+n)};if(j&&j.type==="date")o=h.encodeDate(o)}if(x){A("yanchor",r.yanchor=H(E+i))}else{s=function e(t){return H(U(t)+i)};if(V&&V.type==="date")s=h.encodeDate(s)}A("path",r.path=_(N,o,s))}else if(b){if(W==="resize-over-start-point"){var l=T+n;var u=x?M-i:M+i;A("x0",r.x0=y?l:Z(l));A("y0",r.y0=x?u:H(u))}else if(W==="resize-over-end-point"){var c=S+n;var f=x?C-i:C+i;A("x1",r.x1=y?c:Z(c));A("y1",r.y1=x?f:H(f))}}else{var v=~W.indexOf("n")?L+i:L,k=~W.indexOf("s")?I+i:I,G=~W.indexOf("w")?P+n:P,$=~W.indexOf("e")?D+n:D;if(~W.indexOf("n")&&x)v=L-i;if(~W.indexOf("s")&&x)k=I-i;if(!x&&k-v>m||x&&v-k>m){A(O,r[O]=x?v:H(v));A(R,r[R]=x?k:H(k))}if($-G>d){A(F,r[F]=y?G:Z(G));A(B,r[B]=y?$:Z($))}}t.attr("d",g(e,r));ne(p,r)}function ne(e,t){if(y||x){r()}function r(){var r=t.type!=="path";var n=e.selectAll(".visual-cue").data([0]);var a=1;n.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":a}).classed("visual-cue",true);var o=q(y?t.xanchor:i.midRange(r?[t.x0,t.x1]:h.extractPathCoords(t.path,f.paramIsX)));var s=U(x?t.yanchor:i.midRange(r?[t.y0,t.y1]:h.extractPathCoords(t.path,f.paramIsY)));o=h.roundPositionForSharpStrokeRendering(o,a);s=h.roundPositionForSharpStrokeRendering(s,a);if(y&&x){var l="M"+(o-1-a)+","+(s-1-a)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";n.attr("d",l)}else if(y){var u="M"+(o-1-a)+","+(s-9-a)+"v18 h2 v-18 Z";n.attr("d",u)}else{var c="M"+(o-9-a)+","+(s-1-a)+"h18 v2 h-18 Z";n.attr("d",c)}}}function ie(e){e.selectAll(".visual-cue").remove()}function ae(e,t,r){var n=t.xref,i=t.yref,o=a.getFromId(r,n),l=a.getFromId(r,i);var u="";if(n!=="paper"&&!o.autorange)u+=n;if(i!=="paper"&&!l.autorange)u+=i;e.call(s.setClipUrl,u?"clip"+r._fullLayout._uid+u:null)}}function g(e,t){var r=t.type,n=a.getFromId(e,t.xref),i=a.getFromId(e,t.yref),o=e._fullLayout._size,s,l,u,c,f,p,d,v;if(n){s=h.shapePositionToRange(n);l=function(e){return n._offset+n.r2p(s(e,true))}}else{l=function(e){return o.l+o.w*e}}if(i){u=h.shapePositionToRange(i);c=function(e){return i._offset+i.r2p(u(e,true))}}else{c=function(e){return o.t+o.h*(1-e)}}if(r==="path"){if(n&&n.type==="date")l=h.decodeDate(l);if(i&&i.type==="date")c=h.decodeDate(c);return y(t,l,c)}if(t.xsizemode==="pixel"){var m=l(t.xanchor);f=m+t.x0;p=m+t.x1}else{f=l(t.x0);p=l(t.x1)}if(t.ysizemode==="pixel"){var g=c(t.yanchor);d=g-t.y0;v=g-t.y1}else{d=c(t.y0);v=c(t.y1)}if(r==="line")return"M"+f+","+d+"L"+p+","+v;if(r==="rect")return"M"+f+","+d+"H"+p+"V"+v+"H"+f+"Z";var _=(f+p)/2,x=(d+v)/2,b=Math.abs(_-f),w=Math.abs(x-d),k="A"+b+","+w,A=_+b+","+x,T=_+","+(x-w);return"M"+A+k+" 0 1,1 "+T+k+" 0 0,1 "+A+"Z"}function y(e,t,r){var n=e.path,a=e.xsizemode,o=e.ysizemode,s=e.xanchor,l=e.yanchor;return n.replace(f.segmentRE,function(e){var n=0,u=e.charAt(0),c=f.paramIsX[u],h=f.paramIsY[u],p=f.numParams[u];var d=e.substr(1).replace(f.paramRE,function(e){if(c[n]){if(a==="pixel")e=t(s)+Number(e);else e=t(e)}else if(h[n]){if(o==="pixel")e=r(l)-Number(e);else e=r(e)}n++;if(n>p)e="X";return e});if(n>p){d=d.replace(/[\s,]*X.*/,"");i.log("Ignoring extra params in segment "+e)}return u+d})}function _(e,t,r){return e.replace(f.segmentRE,function(e){var n=0,i=e.charAt(0),a=f.paramIsX[i],o=f.paramIsY[i],s=f.numParams[i];var l=e.substr(1).replace(f.paramRE,function(e){if(n>=s)return e;if(a[n])e=t(e);else if(o[n])e=r(e);n++;return e});return i+l})}},{"../../lib":161,"../../lib/setcursor":180,"../../plot_api/plot_template":195,"../../plots/cartesian/axes":205,"../../registry":253,"../color":42,"../dragelement":64,"../drawing":67,"./constants":123,"./helpers":126}],126:[function(e,t,r){"use strict";var n=e("./constants");var i=e("../../lib");r.rangeToShapePosition=function(e){return e.type==="log"?e.r2d:function(e){return e}};r.shapePositionToRange=function(e){return e.type==="log"?e.d2r:function(e){return e}};r.decodeDate=function(e){return function(t){if(t.replace)t=t.replace("_"," ");return e(t)}};r.encodeDate=function(e){return function(t){return e(t).replace(" ","_")}};r.extractPathCoords=function(e,t){var r=[];var a=e.match(n.segmentRE);a.forEach(function(e){var a=t[e.charAt(0)].drawn;if(a===undefined)return;var o=e.substr(1).match(n.paramRE);if(!o||o.length<a)return;r.push(i.cleanNumber(o[a]))});return r};r.getDataToPixel=function(e,t,n){var i=e._fullLayout._size,a;if(t){var o=r.shapePositionToRange(t);a=function(e){return t._offset+t.r2p(o(e,true))};if(t.type==="date")a=r.decodeDate(a)}else if(n){a=function(e){return i.t+i.h*(1-e)}}else{a=function(e){return i.l+i.w*e}}return a};r.getPixelToData=function(e,t,n){var i=e._fullLayout._size,a;if(t){var o=r.rangeToShapePosition(t);a=function(e){return o(t.p2r(e-t._offset))}}else if(n){a=function(e){return 1-(e-i.t)/i.h}}else{a=function(e){return(e-i.l)/i.w}}return a};r.roundPositionForSharpStrokeRendering=function(e,t){var r=Math.round(t%2)===1;var n=Math.round(e);return r?n+.5:n}},{"../../lib":161,"./constants":123}],127:[function(e,t,r){"use strict";var n=e("./draw");t.exports={moduleType:"component",name:"shapes",layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),includeBasePlot:e("../../plots/cartesian/include_components")("shapes"),calcAutorange:e("./calc_autorange"),draw:n.draw,drawOne:n.drawOne}},{"../../plots/cartesian/include_components":215,"./attributes":121,"./calc_autorange":122,"./defaults":124,"./draw":125}],128:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var i=e("../../plots/pad_attributes");var a=e("../../lib/extend").extendDeepAll;var o=e("../../plot_api/edit_types").overrideAll;var s=e("../../plots/animation_attributes");var l=e("../../plot_api/plot_template").templatedArray;var u=e("./constants");var c=l("step",{visible:{valType:"boolean",dflt:true},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:true,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:true}});t.exports=o(l("slider",{visible:{valType:"boolean",dflt:true},active:{valType:"number",min:0,dflt:0},steps:c,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:a({},i,{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:s.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:true},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:n({})},font:n({}),activebgcolor:{valType:"color",dflt:u.gripBgActiveColor},bgcolor:{valType:"color",dflt:u.railBgColor},bordercolor:{valType:"color",dflt:u.railBorderColor},borderwidth:{valType:"number",min:0,dflt:u.railBorderWidth},ticklen:{valType:"number",min:0,dflt:u.tickLength},tickcolor:{valType:"color",dflt:u.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:u.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":154,"../../plot_api/edit_types":188,"../../plot_api/plot_template":195,"../../plots/animation_attributes":200,"../../plots/font_attributes":231,"../../plots/pad_attributes":243,"./constants":129}],129:[function(e,t,r){"use strict";t.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],130:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/array_container_defaults");var a=e("./attributes");var o=e("./constants");var s=o.name;var l=a.steps;t.exports=function e(t,r){i(t,r,{name:s,handleItemDefaults:u})};function u(e,t,r){function o(r,i){return n.coerce(e,t,a,r,i)}var s=i(e,t,{name:"steps",handleItemDefaults:c});var l=0;for(var u=0;u<s.length;u++){if(s[u].visible)l++}var f;if(l<2)f=t.visible=false;else f=o("visible");if(!f)return;t._stepCount=l;var h=t._visibleSteps=n.filterVisible(s);var p=o("active");if(!(s[p]||{}).visible)t.active=h[0]._index;o("x");o("y");n.noneOrAll(e,t,["x","y"]);o("xanchor");o("yanchor");o("len");o("lenmode");o("pad.t");o("pad.r");o("pad.b");o("pad.l");n.coerceFont(o,"font",r.font);var d=o("currentvalue.visible");if(d){o("currentvalue.xanchor");o("currentvalue.prefix");o("currentvalue.suffix");o("currentvalue.offset");n.coerceFont(o,"currentvalue.font",t.font)}o("transition.duration");o("transition.easing");o("bgcolor");o("activebgcolor");o("bordercolor");o("borderwidth");o("ticklen");o("tickwidth");o("tickcolor");o("minorticklen")}function c(e,t){function r(r,i){return n.coerce(e,t,l,r,i)}var i;if(e.method!=="skip"&&!Array.isArray(e.args)){i=t.visible=false}else i=r("visible");if(i){r("method");r("args");var a=r("label","step-"+t._index);r("value",a);r("execute")}}},{"../../lib":161,"../../plots/array_container_defaults":201,"./attributes":128,"./constants":129}],131:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../plots/plots");var a=e("../color");var o=e("../drawing");var s=e("../../lib");var l=e("../../lib/svg_text_utils");var u=e("../legend/anchor_utils");var c=e("../../plot_api/plot_template").arrayEditor;var f=e("./constants");var h=e("../../constants/alignment");var p=h.LINE_SPACING;var d=h.FROM_TL;var v=h.FROM_BR;t.exports=function e(t){var r=t._fullLayout,a=g(r,t);var o=r._infolayer.selectAll("g."+f.containerClassName).data(a.length>0?[0]:[]);o.enter().append("g").classed(f.containerClassName,true).style("cursor","ew-resize");function s(e){if(e._commandObserver){e._commandObserver.remove();delete e._commandObserver}i.autoMargin(t,m(e))}o.exit().each(function(){n.select(this).selectAll("g."+f.groupClassName).each(s)}).remove();if(a.length===0)return;var l=o.selectAll("g."+f.groupClassName).data(a,y);l.enter().append("g").classed(f.groupClassName,true);l.exit().each(s).remove();for(var u=0;u<a.length;u++){var c=a[u];_(t,c)}l.each(function(e){var r=n.select(this);z(e);i.manageCommandObserver(t,e,e._visibleSteps,function(e){var n=r.data()[0];if(n.active===e.index)return;if(n._dragging)return;M(t,r,n,e.index,false,true)});x(t,n.select(this),e)})};function m(e){return f.autoMarginIdRoot+e._index}function g(e,t){var r=e[f.name],n=[];for(var i=0;i<r.length;i++){var a=r[i];if(!a.visible)continue;a._gd=t;n.push(a)}return n}function y(e){return e._index}function _(e,t){var r=o.tester.selectAll("g."+f.labelGroupClass).data(t._visibleSteps);r.enter().append("g").classed(f.labelGroupClass,true);var a=0;var s=0;r.each(function(e){var r=n.select(this);var i=k(r,{step:e},t);var l=i.node();if(l){var u=o.bBox(l);s=Math.max(s,u.height);a=Math.max(a,u.width)}});r.remove();var c=t._dims={};c.inputAreaWidth=Math.max(f.railWidth,f.gripHeight);var h=e._fullLayout._size;c.lx=h.l+h.w*t.x;c.ly=h.t+h.h*(1-t.y);if(t.lenmode==="fraction"){c.outerLength=Math.round(h.w*t.len)}else{c.outerLength=t.len}c.inputAreaStart=0;c.inputAreaLength=Math.round(c.outerLength-t.pad.l-t.pad.r);var p=c.inputAreaLength-2*f.stepInset;var g=p/(t._stepCount-1);var y=a+f.labelPadding;c.labelStride=Math.max(1,Math.ceil(y/g));c.labelHeight=s;c.currentValueMaxWidth=0;c.currentValueHeight=0;c.currentValueTotalHeight=0;c.currentValueMaxLines=1;if(t.currentvalue.visible){var _=o.tester.append("g");r.each(function(e){var r=b(_,t,e.label);var n=r.node()&&o.bBox(r.node())||{width:0,height:0};var i=l.lineCount(r);c.currentValueMaxWidth=Math.max(c.currentValueMaxWidth,Math.ceil(n.width));c.currentValueHeight=Math.max(c.currentValueHeight,Math.ceil(n.height));c.currentValueMaxLines=Math.max(c.currentValueMaxLines,i)});c.currentValueTotalHeight=c.currentValueHeight+t.currentvalue.offset;_.remove()}c.height=c.currentValueTotalHeight+f.tickOffset+t.ticklen+f.labelOffset+c.labelHeight+t.pad.t+t.pad.b;var x="left";if(u.isRightAnchor(t)){c.lx-=c.outerLength;x="right"}if(u.isCenterAnchor(t)){c.lx-=c.outerLength/2;x="center"}var w="top";if(u.isBottomAnchor(t)){c.ly-=c.height;w="bottom"}if(u.isMiddleAnchor(t)){c.ly-=c.height/2;w="middle"}c.outerLength=Math.ceil(c.outerLength);c.height=Math.ceil(c.height);c.lx=Math.round(c.lx);c.ly=Math.round(c.ly);var A={y:t.y,b:c.height*v[w],t:c.height*d[w]};if(t.lenmode==="fraction"){A.l=0;A.xl=t.x-t.len*d[x];A.r=0;A.xr=t.x+t.len*v[x]}else{A.x=t.x;A.l=c.outerLength*d[x];A.r=c.outerLength*v[x]}i.autoMargin(e,m(t),A)}function x(e,t,r){if(!(r.steps[r.active]||{}).visible){r.active=r._visibleSteps[0]._index}t.call(b,r).call(D,r).call(A,r).call(C,r).call(P,e,r).call(w,e,r);var n=r._dims;o.setTranslate(t,n.lx+r.pad.l,n.ly+r.pad.t);t.call(E,r,false);t.call(b,r)}function b(e,t,r){if(!t.currentvalue.visible)return;var n=t._dims;var i,a;switch(t.currentvalue.xanchor){case"right":i=n.inputAreaLength-f.currentValueInset-n.currentValueMaxWidth;a="left";break;case"center":i=n.inputAreaLength*.5;a="middle";break;default:i=f.currentValueInset;a="left"}var u=s.ensureSingle(e,"text",f.labelClass,function(e){e.classed("user-select-none",true).attr({"text-anchor":a,"data-notex":1})});var c=t.currentvalue.prefix?t.currentvalue.prefix:"";if(typeof r==="string"){c+=r}else{var h=t.steps[t.active].label;c+=h}if(t.currentvalue.suffix){c+=t.currentvalue.suffix}u.call(o.font,t.currentvalue.font).text(c).call(l.convertToTspans,t._gd);var d=l.lineCount(u);var v=(n.currentValueMaxLines+1-d)*t.currentvalue.font.size*p;l.positionText(u,i,v);return u}function w(e,t,r){var n=s.ensureSingle(e,"rect",f.gripRectClass,function(n){n.call(S,t,e,r).style("pointer-events","all")});n.attr({width:f.gripWidth,height:f.gripHeight,rx:f.gripRadius,ry:f.gripRadius}).call(a.stroke,r.bordercolor).call(a.fill,r.bgcolor).style("stroke-width",r.borderwidth+"px")}function k(e,t,r){var n=s.ensureSingle(e,"text",f.labelClass,function(e){e.classed("user-select-none",true).attr({"text-anchor":"middle","data-notex":1})});n.call(o.font,r.font).text(t.step.label).call(l.convertToTspans,r._gd);return n}function A(e,t){var r=s.ensureSingle(e,"g",f.labelsClass);var i=t._dims;var a=r.selectAll("g."+f.labelGroupClass).data(i.labelSteps);a.enter().append("g").classed(f.labelGroupClass,true);a.exit().remove();a.each(function(e){var r=n.select(this);r.call(k,e,t);o.setTranslate(r,L(t,e.fraction),f.tickOffset+t.ticklen+t.font.size*p+f.labelOffset+i.currentValueTotalHeight)})}function T(e,t,r,n,i){var a=Math.round(n*(r._stepCount-1));var o=r._visibleSteps[a]._index;if(o!==r.active){M(e,t,r,o,true,i)}}function M(e,t,r,n,a,o){var s=r.active;r.active=n;c(e.layout,f.name,r).applyUpdate("active",n);var l=r.steps[r.active];t.call(E,r,o);t.call(b,r);e.emit("plotly_sliderchange",{slider:r,step:r.steps[r.active],interaction:a,previousActive:s});if(l&&l.method&&a){if(t._nextMethod){t._nextMethod.step=l;t._nextMethod.doCallback=a;t._nextMethod.doTransition=o}else{t._nextMethod={step:l,doCallback:a,doTransition:o};t._nextMethodRaf=window.requestAnimationFrame(function(){var r=t._nextMethod.step;if(!r.method)return;if(r.execute){i.executeAPICommand(e,r.method,r.args)}t._nextMethod=null;t._nextMethodRaf=null})}}}function S(e,t,r){var i=r.node();var o=n.select(t);function s(){return r.data()[0]}e.on("mousedown",function(){var e=s();t.emit("plotly_sliderstart",{slider:e});var l=r.select("."+f.gripRectClass);n.event.stopPropagation();n.event.preventDefault();l.call(a.fill,e.activebgcolor);var u=I(e,n.mouse(i)[0]);T(t,r,e,u,true);e._dragging=true;o.on("mousemove",function(){var e=s();var a=I(e,n.mouse(i)[0]);T(t,r,e,a,false)});o.on("mouseup",function(){var e=s();e._dragging=false;l.call(a.fill,e.bgcolor);o.on("mouseup",null);o.on("mousemove",null);t.emit("plotly_sliderend",{slider:e,step:e.steps[e.active]})})})}function C(e,t){var r=e.selectAll("rect."+f.tickRectClass).data(t._visibleSteps);var i=t._dims;r.enter().append("rect").classed(f.tickRectClass,true);r.exit().remove();r.attr({width:t.tickwidth+"px","shape-rendering":"crispEdges"});r.each(function(e,r){var s=r%i.labelStride===0;var l=n.select(this);l.attr({height:s?t.ticklen:t.minorticklen}).call(a.fill,s?t.tickcolor:t.tickcolor);o.setTranslate(l,L(t,r/(t._stepCount-1))-.5*t.tickwidth,(s?f.tickOffset:f.minorTickOffset)+i.currentValueTotalHeight)})}function z(e){var t=e._dims;t.labelSteps=[];var r=e._stepCount;for(var n=0;n<r;n+=t.labelStride){t.labelSteps.push({fraction:n/(r-1),step:e._visibleSteps[n]})}}function E(e,t,r){var n=e.select("rect."+f.gripRectClass);var i=0;for(var a=0;a<t._stepCount;a++){if(t._visibleSteps[a]._index===t.active){i=a;break}}var o=L(t,i/(t._stepCount-1));if(t._invokingCommand)return;var s=n;if(r&&t.transition.duration>0){s=s.transition().duration(t.transition.duration).ease(t.transition.easing)}s.attr("transform","translate("+(o-f.gripWidth*.5)+","+t._dims.currentValueTotalHeight+")")}function L(e,t){var r=e._dims;return r.inputAreaStart+f.stepInset+(r.inputAreaLength-2*f.stepInset)*Math.min(1,Math.max(0,t))}function I(e,t){var r=e._dims;return Math.min(1,Math.max(0,(t-f.stepInset-r.inputAreaStart)/(r.inputAreaLength-2*f.stepInset-2*r.inputAreaStart)))}function P(e,t,r){var n=r._dims;var i=s.ensureSingle(e,"rect",f.railTouchRectClass,function(n){n.call(S,t,e,r).style("pointer-events","all")});i.attr({width:n.inputAreaLength,height:Math.max(n.inputAreaWidth,f.tickOffset+r.ticklen+n.labelHeight)}).call(a.fill,r.bgcolor).attr("opacity",0);o.setTranslate(i,0,n.currentValueTotalHeight)}function D(e,t){var r=t._dims;var n=r.inputAreaLength-f.railInset*2;var i=s.ensureSingle(e,"rect",f.railRectClass);i.attr({width:n,height:f.railWidth,rx:f.railRadius,ry:f.railRadius,"shape-rendering":"crispEdges"}).call(a.stroke,t.bordercolor).call(a.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px");o.setTranslate(i,f.railInset,(r.inputAreaWidth-f.railWidth)*.5+r.currentValueTotalHeight)}},{"../../constants/alignment":140,"../../lib":161,"../../lib/svg_text_utils":182,"../../plot_api/plot_template":195,"../../plots/plots":244,"../color":42,"../drawing":67,"../legend/anchor_utils":94,"./constants":129,d3:6}],132:[function(e,t,r){"use strict";var n=e("./constants");t.exports={moduleType:"component",name:n.name,layoutAttributes:e("./attributes"),supplyLayoutDefaults:e("./defaults"),draw:e("./draw")}},{"./attributes":128,"./constants":129,"./defaults":130,"./draw":131}],133:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../../plots/plots");var o=e("../../registry");var s=e("../../lib");var l=e("../drawing");var u=e("../color");var c=e("../../lib/svg_text_utils");var f=e("../../constants/interactions");t.exports={draw:p};var h=/ [XY][0-9]* /;function p(e,t,r){var p=r.propContainer;var d=r.propName;var v=r.placeholder;var m=r.traceIndex;var g=r.avoid||{};var y=r.attributes;var _=r.transform;var x=r.containerGroup;var b=e._fullLayout;var w=p.titlefont||{};var k=w.family;var A=w.size;var T=w.color;var M=1;var S=false;var C=(p.title||"").trim();var z;if(d==="title")z="titleText";else if(d.indexOf("axis")!==-1)z="axisTitleText";else if(d.indexOf("colorbar"!==-1))z="colorbarTitleText";var E=e._context.edits[z];if(C==="")M=0;else if(C.replace(h," % ")===v.replace(h," % ")){M=.2;S=true;if(!E)C=""}var L=C||E;if(!x){x=s.ensureSingle(b._infolayer,"g","g-"+t)}var I=x.selectAll("text").data(L?[0]:[]);I.enter().append("text");I.text(C).attr("class",t);I.exit().remove();if(!L)return x;function P(e){s.syncOrAsync([D,O],e)}function D(t){var r;if(_){r="";if(_.rotate){r+="rotate("+[_.rotate,y.x,y.y]+")"}if(_.offset){r+="translate(0, "+_.offset+")"}}else{r=null}t.attr("transform",r);t.style({"font-family":k,"font-size":n.round(A,2)+"px",fill:u.rgb(T),opacity:M*u.opacity(T),"font-weight":a.fontWeight}).attr(y).call(c.convertToTspans,e);return a.previousPromises(e)}function O(e){var t=n.select(e.node().parentNode);if(g&&g.selection&&g.side&&C){t.attr("transform",null);var r=0;var a={left:"right",right:"left",top:"bottom",bottom:"top"}[g.side];var o=["left","top"].indexOf(g.side)!==-1?-1:1;var u=i(g.pad)?g.pad:2;var c=l.bBox(t.node());var f={left:0,top:0,right:b.width,bottom:b.height};var h=g.maxShift||(f[g.side]-c[g.side])*(g.side==="left"||g.side==="top"?-1:1);if(h<0)r=h;else{var p=g.offsetLeft||0;var d=g.offsetTop||0;c.left-=p;c.right-=p;c.top-=d;c.bottom-=d;g.selection.each(function(){var e=l.bBox(this);if(s.bBoxIntersect(c,e,u)){r=Math.max(r,o*(e[g.side]-c[a])+u)}});r=Math.min(h,r)}if(r>0||h<0){var v={left:[-r,0],right:[r,0],top:[0,-r],bottom:[0,r]}[g.side];t.attr("transform","translate("+v+")")}}}I.call(P);function R(){M=0;S=true;I.text(v).on("mouseover.opacity",function(){n.select(this).transition().duration(f.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){n.select(this).transition().duration(f.HIDE_PLACEHOLDER).style("opacity",0)})}if(E){if(!C)R();else I.on(".opacity",null);I.call(c.makeEditable,{gd:e}).on("edit",function(t){if(m!==undefined){o.call("restyle",e,d,t,m)}else{o.call("relayout",e,d,t)}}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(P)}).on("input",function(e){this.text(e||" ").call(c.positionText,y.x,y.y)})}I.classed("js-placeholder",S);return x}},{"../../constants/interactions":141,"../../lib":161,"../../lib/svg_text_utils":182,"../../plots/plots":244,"../../registry":253,"../color":42,"../drawing":67,d3:6,"fast-isnumeric":9}],134:[function(e,t,r){"use strict";var n=e("../../plots/font_attributes");var i=e("../color/attributes");var a=e("../../lib/extend").extendFlat;var o=e("../../plot_api/edit_types").overrideAll;var s=e("../../plots/pad_attributes");var l=e("../../plot_api/plot_template").templatedArray;var u=l("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:true,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:true}});t.exports=o(l("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:true},buttons:u,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:a({},s,{}),font:n({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:i.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":154,"../../plot_api/edit_types":188,"../../plot_api/plot_template":195,"../../plots/font_attributes":231,"../../plots/pad_attributes":243,"../color/attributes":41}],135:[function(e,t,r){"use strict";t.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25c4",right:"\u25ba",up:"\u25b2",down:"\u25bc"}}},{}],136:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../plots/array_container_defaults");var a=e("./attributes");var o=e("./constants");var s=o.name;var l=a.buttons;t.exports=function e(t,r){var n={name:s,handleItemDefaults:u};i(t,r,n)};function u(e,t,r){function o(r,i){return n.coerce(e,t,a,r,i)}var s=i(e,t,{name:"buttons",handleItemDefaults:c});var l=o("visible",s.length>0);if(!l)return;o("active");o("direction");o("type");o("showactive");o("x");o("y");n.noneOrAll(e,t,["x","y"]);o("xanchor");o("yanchor");o("pad.t");o("pad.r");o("pad.b");o("pad.l");n.coerceFont(o,"font",r.font);o("bgcolor",r.paper_bgcolor);o("bordercolor");o("borderwidth")}function c(e,t){function r(r,i){return n.coerce(e,t,l,r,i)}var i=r("visible",e.method==="skip"||Array.isArray(e.args));if(i){r("method");r("args");r("label");r("execute")}}},{"../../lib":161,"../../plots/array_container_defaults":201,"./attributes":134,"./constants":135}],137:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../plots/plots");var a=e("../color");var o=e("../drawing");var s=e("../../lib");var l=e("../../lib/svg_text_utils");var u=e("../legend/anchor_utils");var c=e("../../plot_api/plot_template").arrayEditor;var f=e("../../constants/alignment").LINE_SPACING;var h=e("./constants");var p=e("./scrollbox");t.exports=function e(t){var r=t._fullLayout,a=s.filterVisible(r[h.name]);function o(e){i.autoMargin(t,z(e))}var l=r._menulayer.selectAll("g."+h.containerClassName).data(a.length>0?[0]:[]);l.enter().append("g").classed(h.containerClassName,true).style("cursor","pointer");l.exit().each(function(){n.select(this).selectAll("g."+h.headerGroupClassName).each(o)}).remove();if(a.length===0)return;var u=l.selectAll("g."+h.headerGroupClassName).data(a,d);u.enter().append("g").classed(h.headerGroupClassName,true);var c=s.ensureSingle(l,"g",h.dropdownButtonGroupClassName,function(e){e.style("pointer-events","all")});for(var f=0;f<a.length;f++){var v=a[f];C(t,v)}var x="updatemenus"+r._uid,b=new p(t,c,x);if(u.enter().size()){c.node().parentNode.appendChild(c.node());c.call(L)}u.exit().each(function(e){c.call(L);o(e)}).remove();u.each(function(e){var r=n.select(this);var a=e.type==="dropdown"?c:null;i.manageCommandObserver(t,e,e.buttons,function(n){g(t,e,e.buttons[n.index],r,a,b,n.index,true)});if(e.type==="dropdown"){y(t,r,c,b,e);if(m(c,e)){_(t,r,c,b,e)}}else{_(t,r,null,null,e)}})};function d(e){return e._index}function v(e){return+e.attr(h.menuIndexAttrName)===-1}function m(e,t){return+e.attr(h.menuIndexAttrName)===t._index}function g(e,t,r,n,i,a,o,s){t.active=o;c(e.layout,h.name,t).applyUpdate("active",o);if(t.type==="buttons"){_(e,n,null,null,t)}else if(t.type==="dropdown"){i.attr(h.menuIndexAttrName,"-1");y(e,n,i,a,t);if(!s){_(e,n,i,a,t)}}}function y(e,t,r,n,i){var a=s.ensureSingle(t,"g",h.headerClassName,function(e){e.style("pointer-events","all")});var l=i._dims;var u=i.active;var c=i.buttons[u]||h.blankHeaderOpts;var f={y:i.pad.t,yPad:0,x:i.pad.l,xPad:0,index:0};var p={width:l.headerWidth,height:l.headerHeight};a.call(w,i,c,e).call(E,i,f,p);var d=s.ensureSingle(t,"text",h.headerArrowClassName,function(e){e.classed("user-select-none",true).attr("text-anchor","end").call(o.font,i.font).text(h.arrowSymbol[i.direction])});d.attr({x:l.headerWidth-h.arrowOffsetX+i.pad.l,y:l.headerHeight/2+h.textOffsetY+i.pad.t});a.on("click",function(){r.call(L,String(m(r,i)?-1:i._index));_(e,t,r,n,i)});a.on("mouseover",function(){a.call(M)});a.on("mouseout",function(){a.call(S,i)});o.setTranslate(t,l.lx,l.ly)}function _(e,t,r,a,o){if(!r){r=t;r.attr("pointer-events","all")}var l=!v(r)||o.type==="buttons"?o.buttons:[];var u=o.type==="dropdown"?h.dropdownButtonClassName:h.buttonClassName;var c=r.selectAll("g."+u).data(s.filterVisible(l));var f=c.enter().append("g").classed(u,true);var p=c.exit();if(o.type==="dropdown"){f.attr("opacity","0").transition().attr("opacity","1");p.transition().attr("opacity","0").remove()}else{p.remove()}var d=0;var m=0;var y=o._dims;var _=["up","down"].indexOf(o.direction)!==-1;if(o.type==="dropdown"){if(_){m=y.headerHeight+h.gapButtonHeader}else{d=y.headerWidth+h.gapButtonHeader}}if(o.type==="dropdown"&&o.direction==="up"){m=-h.gapButtonHeader+h.gapButton-y.openHeight}if(o.type==="dropdown"&&o.direction==="left"){d=-h.gapButtonHeader+h.gapButton-y.openWidth}var k={x:y.lx+d+o.pad.l,y:y.ly+m+o.pad.t,yPad:h.gapButton,xPad:h.gapButton,index:0};var A={l:k.x+o.borderwidth,t:k.y+o.borderwidth};c.each(function(s,l){var u=n.select(this);u.call(w,o,s,e).call(E,o,k);u.on("click",function(){if(n.event.defaultPrevented)return;g(e,o,s,t,r,a,l);if(s.execute){i.executeAPICommand(e,s.method,s.args)}e.emit("plotly_buttonclicked",{menu:o,button:s,active:o.active})});u.on("mouseover",function(){u.call(M)});u.on("mouseout",function(){u.call(S,o);c.call(T,o)})});c.call(T,o);if(_){A.w=Math.max(y.openWidth,y.headerWidth);A.h=k.y-A.t}else{A.w=k.x-A.l;A.h=Math.max(y.openHeight,y.headerHeight)}A.direction=o.direction;if(a){if(c.size()){x(e,t,r,a,o,A)}else{b(a)}}}function x(e,t,r,n,i,a){var o=i.direction;var s=o==="up"||o==="down";var l=i._dims;var u=i.active,c,f,p;if(s){f=0;for(p=0;p<u;p++){f+=l.heights[p]+h.gapButton}}else{c=0;for(p=0;p<u;p++){c+=l.widths[p]+h.gapButton}}n.enable(a,c,f);if(n.hbar){n.hbar.attr("opacity","0").transition().attr("opacity","1")}if(n.vbar){n.vbar.attr("opacity","0").transition().attr("opacity","1")}}function b(e){var t=!!e.hbar,r=!!e.vbar;if(t){e.hbar.transition().attr("opacity","0").each("end",function(){t=false;if(!r)e.disable()})}if(r){e.vbar.transition().attr("opacity","0").each("end",function(){r=false;if(!t)e.disable()})}}function w(e,t,r,n){e.call(k,t).call(A,t,r,n)}function k(e,t){var r=s.ensureSingle(e,"rect",h.itemRectClassName,function(e){e.attr({rx:h.rx,ry:h.ry,"shape-rendering":"crispEdges"})});r.call(a.stroke,t.bordercolor).call(a.fill,t.bgcolor).style("stroke-width",t.borderwidth+"px")}function A(e,t,r,n){var i=s.ensureSingle(e,"text",h.itemTextClassName,function(e){e.classed("user-select-none",true).attr({"text-anchor":"start","data-notex":1})});i.call(o.font,t.font).text(r.label).call(l.convertToTspans,n)}function T(e,t){var r=t.active;e.each(function(e,i){var o=n.select(this);if(i===r&&t.showactive){o.select("rect."+h.itemRectClassName).call(a.fill,h.activeColor)}})}function M(e){e.select("rect."+h.itemRectClassName).call(a.fill,h.hoverColor)}function S(e,t){e.select("rect."+h.itemRectClassName).call(a.fill,t.bgcolor)}function C(e,t){var r=t._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0};var a=o.tester.selectAll("g."+h.dropdownButtonClassName).data(s.filterVisible(t.buttons));a.enter().append("g").classed(h.dropdownButtonClassName,true);var c=["up","down"].indexOf(t.direction)!==-1;a.each(function(i,a){var s=n.select(this);s.call(w,t,i,e);var u=s.select("."+h.itemTextClassName);var p=u.node()&&o.bBox(u.node()).width;var d=Math.max(p+h.textPadX,h.minWidth);var v=t.font.size*f;var m=l.lineCount(u);var g=Math.max(v*m,h.minHeight)+h.textOffsetY;g=Math.ceil(g);d=Math.ceil(d);r.widths[a]=d;r.heights[a]=g;r.height1=Math.max(r.height1,g);r.width1=Math.max(r.width1,d);if(c){r.totalWidth=Math.max(r.totalWidth,d);r.openWidth=r.totalWidth;r.totalHeight+=g+h.gapButton;r.openHeight+=g+h.gapButton}else{r.totalWidth+=d+h.gapButton;r.openWidth+=d+h.gapButton;r.totalHeight=Math.max(r.totalHeight,g);r.openHeight=r.totalHeight}});if(c){r.totalHeight-=h.gapButton}else{r.totalWidth-=h.gapButton}r.headerWidth=r.width1+h.arrowPadX;r.headerHeight=r.height1;if(t.type==="dropdown"){if(c){r.width1+=h.arrowPadX;r.totalHeight=r.height1}else{r.totalWidth=r.width1}r.totalWidth+=h.arrowPadX}a.remove();var p=r.totalWidth+t.pad.l+t.pad.r;var d=r.totalHeight+t.pad.t+t.pad.b;var v=e._fullLayout._size;r.lx=v.l+v.w*t.x;r.ly=v.t+v.h*(1-t.y);var m="left";if(u.isRightAnchor(t)){r.lx-=p;m="right"}if(u.isCenterAnchor(t)){r.lx-=p/2;m="center"}var g="top";if(u.isBottomAnchor(t)){r.ly-=d;g="bottom"}if(u.isMiddleAnchor(t)){r.ly-=d/2;g="middle"}r.totalWidth=Math.ceil(r.totalWidth);r.totalHeight=Math.ceil(r.totalHeight);r.lx=Math.round(r.lx);r.ly=Math.round(r.ly);i.autoMargin(e,z(t),{x:t.x,y:t.y,l:p*({right:1,center:.5}[m]||0),r:p*({left:1,center:.5}[m]||0),b:d*({top:1,middle:.5}[g]||0),t:d*({bottom:1,middle:.5}[g]||0)})}function z(e){return h.autoMarginIdRoot+e._index}function E(e,t,r,n){n=n||{};var i=e.select("."+h.itemRectClassName);var a=e.select("."+h.itemTextClassName);var s=t.borderwidth;var u=r.index;var c=t._dims;o.setTranslate(e,s+r.x,s+r.y);var p=["up","down"].indexOf(t.direction)!==-1;var d=n.height||(p?c.heights[u]:c.height1);i.attr({x:0,y:0,width:n.width||(p?c.width1:c.widths[u]),height:d});var v=t.font.size*f;var m=l.lineCount(a);var g=(m-1)*v/2;l.positionText(a,h.textOffsetX,d/2-g+h.textOffsetY);if(p){r.y+=c.heights[u]+r.yPad}else{r.x+=c.widths[u]+r.xPad}r.index++}function L(e,t){e.attr(h.menuIndexAttrName,t||"-1").selectAll("g."+h.dropdownButtonClassName).remove()}},{"../../constants/alignment":140,"../../lib":161,"../../lib/svg_text_utils":182,"../../plot_api/plot_template":195,"../../plots/plots":244,"../color":42,"../drawing":67,"../legend/anchor_utils":94,"./constants":135,"./scrollbox":139,d3:6}],138:[function(e,t,r){arguments[4][132][0].apply(r,arguments)},{"./attributes":134,"./constants":135,"./defaults":136,"./draw":137,dup:132}],139:[function(e,t,r){"use strict";t.exports=s;var n=e("d3");var i=e("../color");var a=e("../drawing");var o=e("../../lib");function s(e,t,r){this.gd=e;this.container=t;this.id=r;this.position=null;this.translateX=null;this.translateY=null;this.hbar=null;this.vbar=null;this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]);this.bg.exit().on(".drag",null).on("wheel",null).remove();this.bg.enter().append("rect").classed("scrollbox-bg",true).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}s.barWidth=2;s.barLength=20;s.barRadius=2;s.barPad=1;s.barColor="#808BA4";s.prototype.enable=function e(t,r,o){var l=this.gd._fullLayout,u=l.width,c=l.height;this.position=t;var f=this.position.l,h=this.position.w,p=this.position.t,d=this.position.h,v=this.position.direction,m=v==="down",g=v==="left",y=v==="right",_=v==="up",x=h,b=d,w,k,A,T;if(!m&&!g&&!y&&!_){this.position.direction="down";m=true}var M=m||_;if(M){w=f;k=w+x;if(m){A=p;T=Math.min(A+b,c);b=T-A}else{T=p+b;A=Math.max(T-b,0);b=T-A}}else{A=p;T=A+b;if(g){k=f+x;w=Math.max(k-x,0);x=k-w}else{w=f;k=Math.min(w+x,u);x=k-w}}this._box={l:w,t:A,w:x,h:b};var S=h>x,C=s.barLength+2*s.barPad,z=s.barWidth+2*s.barPad,E=f,L=p+d;if(L+z>c)L=c-z;var I=this.container.selectAll("rect.scrollbar-horizontal").data(S?[0]:[]);I.exit().on(".drag",null).remove();I.enter().append("rect").classed("scrollbar-horizontal",true).call(i.fill,s.barColor);if(S){this.hbar=I.attr({rx:s.barRadius,ry:s.barRadius,x:E,y:L,width:C,height:z});this._hbarXMin=E+C/2;this._hbarTranslateMax=x-C}else{delete this.hbar;delete this._hbarXMin;delete this._hbarTranslateMax}var P=d>b,D=s.barWidth+2*s.barPad,O=s.barLength+2*s.barPad,R=f+h,F=p;if(R+D>u)R=u-D;var B=this.container.selectAll("rect.scrollbar-vertical").data(P?[0]:[]);B.exit().on(".drag",null).remove();B.enter().append("rect").classed("scrollbar-vertical",true).call(i.fill,s.barColor);if(P){this.vbar=B.attr({rx:s.barRadius,ry:s.barRadius,x:R,y:F,width:D,height:O});this._vbarYMin=F+O/2;this._vbarTranslateMax=b-O}else{delete this.vbar;delete this._vbarYMin;delete this._vbarTranslateMax}var N=this.id,j=w-.5,V=P?k+D+.5:k+.5,q=A-.5,U=S?T+z+.5:T+.5;var Z=l._topdefs.selectAll("#"+N).data(S||P?[0]:[]);Z.exit().remove();Z.enter().append("clipPath").attr("id",N).append("rect");if(S||P){this._clipRect=Z.select("rect").attr({x:Math.floor(j),y:Math.floor(q),width:Math.ceil(V)-Math.floor(j),height:Math.ceil(U)-Math.floor(q)});this.container.call(a.setClipUrl,N);this.bg.attr({x:f,y:p,width:h,height:d})}else{this.bg.attr({width:0,height:0});this.container.on("wheel",null).on(".drag",null).call(a.setClipUrl,null);delete this._clipRect}if(S||P){var H=n.behavior.drag().on("dragstart",function(){n.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(H);var G=n.behavior.drag().on("dragstart",function(){n.event.sourceEvent.preventDefault();n.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));if(S){this.hbar.on(".drag",null).call(G)}if(P){this.vbar.on(".drag",null).call(G)}}this.setTranslate(r,o)};s.prototype.disable=function e(){if(this.hbar||this.vbar){this.bg.attr({width:0,height:0});this.container.on("wheel",null).on(".drag",null).call(a.setClipUrl,null);delete this._clipRect}if(this.hbar){this.hbar.on(".drag",null);this.hbar.remove();delete this.hbar;delete this._hbarXMin;delete this._hbarTranslateMax}if(this.vbar){this.vbar.on(".drag",null);this.vbar.remove();delete this.vbar;delete this._vbarYMin;delete this._vbarTranslateMax}};s.prototype._onBoxDrag=function e(){var t=this.translateX,r=this.translateY;if(this.hbar){t-=n.event.dx}if(this.vbar){r-=n.event.dy}this.setTranslate(t,r)};s.prototype._onBoxWheel=function e(){var t=this.translateX,r=this.translateY;if(this.hbar){t+=n.event.deltaY}if(this.vbar){r+=n.event.deltaY}this.setTranslate(t,r)};s.prototype._onBarDrag=function e(){var t=this.translateX,r=this.translateY;if(this.hbar){var i=t+this._hbarXMin,a=i+this._hbarTranslateMax,s=o.constrain(n.event.x,i,a),l=(s-i)/(a-i);var u=this.position.w-this._box.w;t=l*u}if(this.vbar){var c=r+this._vbarYMin,f=c+this._vbarTranslateMax,h=o.constrain(n.event.y,c,f),p=(h-c)/(f-c);var d=this.position.h-this._box.h;r=p*d}this.setTranslate(t,r)};s.prototype.setTranslate=function e(t,r){var n=this.position.w-this._box.w,i=this.position.h-this._box.h;t=o.constrain(t||0,0,n);r=o.constrain(r||0,0,i);this.translateX=t;this.translateY=r;this.container.call(a.setTranslate,this._box.l-this.position.l-t,this._box.t-this.position.t-r);if(this._clipRect){this._clipRect.attr({x:Math.floor(this.position.l+t-.5),y:Math.floor(this.position.t+r-.5)})}if(this.hbar){var s=t/n;this.hbar.call(a.setTranslate,t+s*this._hbarTranslateMax,r)}if(this.vbar){var l=r/i;this.vbar.call(a.setTranslate,t,r+l*this._vbarTranslateMax)}}},{"../../lib":161,"../color":42,"../drawing":67,d3:6}],140:[function(e,t,r){"use strict";t.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],141:[function(e,t,r){"use strict";t.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DBLCLICKDELAY:300,DESELECTDIM:.2}},{}],142:[function(e,t,r){"use strict";t.exports={BADNUM:undefined,FP_SAFE:Number.MAX_VALUE/1e4,ONEAVGYEAR:315576e5,ONEAVGMONTH:26298e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:1-1e-6,MINUS_SIGN:"\u2212"}},{}],143:[function(e,t,r){"use strict";t.exports={entityToUnicode:{mu:"\u03bc","#956":"\u03bc",amp:"&","#28":"&",lt:"<","#60":"<",gt:">","#62":">",nbsp:"\xa0","#160":"\xa0",times:"\xd7","#215":"\xd7",plusmn:"\xb1","#177":"\xb1",deg:"\xb0","#176":"\xb0"}}},{}],144:[function(e,t,r){"use strict";r.xmlns="http://www.w3.org/2000/xmlns/";r.svg="http://www.w3.org/2000/svg";r.xlink="http://www.w3.org/1999/xlink";r.svgAttrs={xmlns:r.svg,"xmlns:xlink":r.xlink}},{}],145:[function(e,t,r){"use strict";r.version="1.39.1";e("es6-promise").polyfill();e("../build/plotcss");e("./fonts/mathjax_config");var n=e("./registry");var i=r.register=n.register;var a=e("./plot_api");var o=Object.keys(a);for(var s=0;s<o.length;s++){var l=o[s];r[l]=a[l];i({moduleType:"apiMethod",name:l,fn:a[l]})}i(e("./traces/scatter"));i([e("./components/fx"),e("./components/legend"),e("./components/annotations"),e("./components/annotations3d"),e("./components/shapes"),e("./components/images"),e("./components/updatemenus"),e("./components/sliders"),e("./components/rangeslider"),e("./components/rangeselector"),e("./components/grid"),e("./components/errorbars")]);i([e("./locale-en"),e("./locale-en-us")]);r.Icons=e("../build/ploticon");r.Plots=e("./plots/plots");r.Fx=e("./components/fx");r.Snapshot=e("./snapshot");r.PlotSchema=e("./plot_api/plot_schema");r.Queue=e("./lib/queue");r.d3=e("d3")},{"../build/plotcss":1,"../build/ploticon":2,"./components/annotations":35,"./components/annotations3d":40,"./components/errorbars":73,"./components/fx":84,"./components/grid":88,"./components/images":93,"./components/legend":102,"./components/rangeselector":113,"./components/rangeslider":119,"./components/shapes":127,"./components/sliders":132,"./components/updatemenus":138,"./fonts/mathjax_config":146,"./lib/queue":175,"./locale-en":186,"./locale-en-us":185,"./plot_api":190,"./plot_api/plot_schema":194,"./plots/plots":244,"./registry":253,"./snapshot":258,"./traces/scatter":276,d3:6,"es6-promise":7}],146:[function(e,t,r){"use strict";if(typeof MathJax!=="undefined"){r.MathJax=true;MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:true,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}});MathJax.Hub.Configured()}else{r.MathJax=false}},{}],147:[function(e,t,r){"use strict";var n=Math.PI;r.deg2rad=function(e){return e/180*n};r.rad2deg=function(e){return e/n*180};r.wrap360=function(e){var t=e%360;return t<0?t+360:t};r.wrap180=function(e){if(Math.abs(e)>180)e-=Math.round(e/360)*360;return e}},{}],148:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../constants/numerical").BADNUM;var a=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;t.exports=function e(t){if(typeof t==="string"){t=t.replace(a,"")}if(n(t))return Number(t);return i}},{"../constants/numerical":142,"fast-isnumeric":9}],149:[function(e,t,r){"use strict";t.exports=function e(t){var r=t._fullLayout;if(r._glcanvas&&r._glcanvas.size()){r._glcanvas.each(function(e){if(e.regl)e.regl.clear({color:true,depth:true})})}}},{}],150:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("tinycolor2");var a=e("../plots/attributes");var o=e("../components/colorscale/get_scale");var s=Object.keys(e("../components/colorscale/scales"));var l=e("./nested_property");var u=e("./regex").counter;var c=e("../constants/interactions").DESELECTDIM;var f=e("./angles").wrap180;var h=e("./is_array").isArrayOrTypedArray;r.valObjectMeta={data_array:{coerceFunction:function(e,t,r){if(h(e))t.set(e);else if(r!==undefined)t.set(r)}},enumerated:{coerceFunction:function(e,t,r,n){if(n.coerceNumber)e=+e;if(n.values.indexOf(e)===-1)t.set(r);else t.set(e)},validateFunction:function(e,t){if(t.coerceNumber)e=+e;var r=t.values;for(var n=0;n<r.length;n++){var i=String(r[n]);if(i.charAt(0)==="/"&&i.charAt(i.length-1)==="/"){var a=new RegExp(i.substr(1,i.length-2));if(a.test(e))return true}else if(e===r[n])return true}return false}},boolean:{coerceFunction:function(e,t,r){if(e===true||e===false)t.set(e);else t.set(r)}},number:{coerceFunction:function(e,t,r,i){if(!n(e)||i.min!==undefined&&e<i.min||i.max!==undefined&&e>i.max){t.set(r)}else t.set(+e)}},integer:{coerceFunction:function(e,t,r,i){if(e%1||!n(e)||i.min!==undefined&&e<i.min||i.max!==undefined&&e>i.max){t.set(r)}else t.set(+e)}},string:{coerceFunction:function(e,t,r,n){if(typeof e!=="string"){var i=typeof e==="number";if(n.strict===true||!i)t.set(r);else t.set(String(e))}else if(n.noBlank&&!e)t.set(r);else t.set(e)}},color:{coerceFunction:function(e,t,r){if(i(e).isValid())t.set(e);else t.set(r)}},colorlist:{coerceFunction:function(e,t,r){function n(e){return i(e).isValid()}if(!Array.isArray(e)||!e.length)t.set(r);else if(e.every(n))t.set(e);else t.set(r)}},colorscale:{coerceFunction:function(e,t,r){t.set(o(e,r))}},angle:{coerceFunction:function(e,t,r){if(e==="auto")t.set("auto");else if(!n(e))t.set(r);else t.set(f(+e))}},subplotid:{coerceFunction:function(e,t,r,n){var i=n.regex||u(r);if(typeof e==="string"&&i.test(e)){t.set(e);return}t.set(r)},validateFunction:function(e,t){var r=t.dflt;if(e===r)return true;if(typeof e!=="string")return false;if(u(r).test(e))return true;return false}},flaglist:{coerceFunction:function(e,t,r,n){if(typeof e!=="string"){t.set(r);return}if((n.extras||[]).indexOf(e)!==-1){t.set(e);return}var i=e.split("+"),a=0;while(a<i.length){var o=i[a];if(n.flags.indexOf(o)===-1||i.indexOf(o)<a){i.splice(a,1)}else a++}if(!i.length)t.set(r);else t.set(i.join("+"))}},any:{coerceFunction:function(e,t,r){if(e===undefined)t.set(r);else t.set(e)}},info_array:{coerceFunction:function(e,t,n,i){function a(e,t,n){var i;var a={set:function(e){i=e}};if(n===undefined)n=t.dflt;r.valObjectMeta[t.valType].coerceFunction(e,a,n,t);return i}var o=i.dimensions===2||i.dimensions==="1-2"&&Array.isArray(e)&&Array.isArray(e[0]);if(!Array.isArray(e)){t.set(n);return}var s=i.items;var l=[];var u=Array.isArray(s);var c=u&&o&&Array.isArray(s[0]);var f=o&&u&&!c;var h=u&&!f?s.length:e.length;var p,d,v,m,g,y;n=Array.isArray(n)?n:[];if(o){for(p=0;p<h;p++){l[p]=[];v=Array.isArray(e[p])?e[p]:[];if(f)g=s.length;else if(u)g=s[p].length;else g=v.length;for(d=0;d<g;d++){if(f)m=s[d];else if(u)m=s[p][d];else m=s;y=a(v[d],m,(n[p]||[])[d]);if(y!==undefined)l[p][d]=y}}}else{for(p=0;p<h;p++){y=a(e[p],u?s[p]:s,n[p]);if(y!==undefined)l[p]=y}}t.set(l)},validateFunction:function(e,t){if(!Array.isArray(e))return false;var r=t.items;var n=Array.isArray(r);var i=t.dimensions===2;if(!t.freeLength&&e.length!==r.length)return false;for(var a=0;a<e.length;a++){if(i){if(!Array.isArray(e[a])||!t.freeLength&&e[a].length!==r[a].length){return false}for(var o=0;o<e[a].length;o++){if(!p(e[a][o],n?r[a][o]:r)){return false}}}else if(!p(e[a],n?r[a]:r))return false}return true}}};r.coerce=function(e,t,n,i,a){var o=l(n,i).get();var s=l(e,i);var u=l(t,i);var c=s.get();var f=t._template;if(c===undefined&&f){c=l(f,i).get();f=0}if(a===undefined)a=o.dflt;if(o.arrayOk&&h(c)){u.set(c);return c}var d=r.valObjectMeta[o.valType].coerceFunction;d(c,u,a,o);var v=u.get();if(f&&v===a&&!p(c,o)){c=l(f,i).get();d(c,u,a,o);v=u.get()}return v};r.coerce2=function(e,t,n,i,a){var o=l(e,i),s=r.coerce(e,t,n,i,a),u=o.get();return u!==undefined&&u!==null?s:false};r.coerceFont=function(e,t,r){var n={};r=r||{};n.family=e(t+".family",r.family);n.size=e(t+".size",r.size);n.color=e(t+".color",r.color);return n};r.coerceHoverinfo=function(e,t,n){var i=t._module.attributes;var o=i.hoverinfo?i:a;var s=o.hoverinfo;var l;if(n._dataLength===1){var u=s.dflt==="all"?s.flags.slice():s.dflt.split("+");u.splice(u.indexOf("name"),1);l=u.join("+")}return r.coerce(e,t,o,"hoverinfo",l)};r.coerceSelectionMarkerOpacity=function(e,t){if(!e.marker)return;var r=e.marker.opacity;if(r===undefined)return;var n;var i;if(!h(r)&&!e.selected&&!e.unselected){n=r;i=c*r}t("selected.marker.opacity",n);t("unselected.marker.opacity",i)};function p(e,t){var n=r.valObjectMeta[t.valType];if(t.arrayOk&&h(e))return true;if(n.validateFunction){return n.validateFunction(e,t)}var i={},a=i,o={set:function(e){a=e}};n.coerceFunction(e,o,i,t);return a!==i}r.validate=p},{"../components/colorscale/get_scale":55,"../components/colorscale/scales":61,"../constants/interactions":141,"../plots/attributes":202,"./angles":147,"./is_array":162,"./nested_property":169,"./regex":176,"fast-isnumeric":9,tinycolor2:25}],151:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("./loggers");var o=e("./mod");var s=e("../constants/numerical");var l=s.BADNUM;var u=s.ONEDAY;var c=s.ONEHOUR;var f=s.ONEMIN;var h=s.ONESEC;var p=s.EPOCHJD;var d=e("../registry");var v=n.time.format.utc;var m=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m;var g=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d:?\d\d)?)?)?)?)?\s*$/m;var y=(new Date).getFullYear()-70;function _(e){return e&&d.componentsRegistry.calendars&&typeof e==="string"&&e!=="gregorian"}r.dateTick0=function(e,t){if(_(e)){return t?d.getComponentMethod("calendars","CANONICAL_SUNDAY")[e]:d.getComponentMethod("calendars","CANONICAL_TICK")[e]}else{return t?"2000-01-02":"2000-01-01"}};r.dfltRange=function(e){if(_(e)){return d.getComponentMethod("calendars","DFLTRANGE")[e]}else{return["2000-01-01","2001-01-01"]}};r.isJSDate=function(e){return typeof e==="object"&&e!==null&&typeof e.getTime==="function"};var x,b;r.dateTime2ms=function(e,t){if(r.isJSDate(e)){var n=e.getTimezoneOffset()*f;var i=(e.getUTCMinutes()-e.getMinutes())*f+(e.getUTCSeconds()-e.getSeconds())*h+(e.getUTCMilliseconds()-e.getMilliseconds());if(i){var a=3*f;n=n-a/2+o(i-n+a/2,a)}e=Number(e)-n;if(e>=x&&e<=b)return e;return l}if(typeof e!=="string"&&typeof e!=="number")return l;e=String(e);var s=_(t);var v=e.charAt(0);if(s&&(v==="G"||v==="g")){e=e.substr(1);t=""}var w=s&&t.substr(0,7)==="chinese";var k=e.match(w?g:m);if(!k)return l;var A=k[1],T=k[3]||"1",M=Number(k[5]||1),S=Number(k[7]||0),C=Number(k[9]||0),z=Number(k[11]||0);if(s){if(A.length===2)return l;A=Number(A);var E;try{var L=d.getComponentMethod("calendars","getCal")(t);if(w){var I=T.charAt(T.length-1)==="i";T=parseInt(T,10);E=L.newDate(A,L.toMonthIndex(A,T,I),M)}else{E=L.newDate(A,Number(T),M)}}catch(e){return l}if(!E)return l;return(E.toJD()-p)*u+S*c+C*f+z*h}if(A.length===2){A=(Number(A)+2e3-y)%100+y}else A=Number(A);T-=1;var P=new Date(Date.UTC(2e3,T,M,S,C));P.setUTCFullYear(A);if(P.getUTCMonth()!==T)return l;if(P.getUTCDate()!==M)return l;return P.getTime()+z*h};x=r.MIN_MS=r.dateTime2ms("-9999");b=r.MAX_MS=r.dateTime2ms("9999-12-31 23:59:59.9999");r.isDateTime=function(e,t){return r.dateTime2ms(e,t)!==l};function w(e,t){return String(e+Math.pow(10,t)).substr(1)}var k=90*u;var A=3*c;var T=5*f;r.ms2DateTime=function(e,t,r){if(typeof e!=="number"||!(e>=x&&e<=b))return l;if(!t)t=0;var n=Math.floor(o(e+.05,1)*10),i=Math.round(e-n/10),a,s,m,g,y,w;if(_(r)){var S=Math.floor(i/u)+p,C=Math.floor(o(e,u));try{a=d.getComponentMethod("calendars","getCal")(r).fromJD(S).formatDate("yyyy-mm-dd")}catch(e){a=v("G%Y-%m-%d")(new Date(i))}if(a.charAt(0)==="-"){while(a.length<11)a="-0"+a.substr(1)}else{while(a.length<10)a="0"+a}s=t<k?Math.floor(C/c):0;m=t<k?Math.floor(C%c/f):0;g=t<A?Math.floor(C%f/h):0;y=t<T?C%h*10+n:0}else{w=new Date(i);a=v("%Y-%m-%d")(w);s=t<k?w.getUTCHours():0;m=t<k?w.getUTCMinutes():0;g=t<A?w.getUTCSeconds():0;y=t<T?w.getUTCMilliseconds()*10+n:0}return M(a,s,m,g,y)};r.ms2DateTimeLocal=function(e){if(!(e>=x+u&&e<=b-u))return l;var t=Math.floor(o(e+.05,1)*10),r=new Date(Math.round(e-t/10)),i=n.time.format("%Y-%m-%d")(r),a=r.getHours(),s=r.getMinutes(),c=r.getSeconds(),f=r.getUTCMilliseconds()*10+t;return M(i,a,s,c,f)};function M(e,t,r,n,i){if(t||r||n||i){e+=" "+w(t,2)+":"+w(r,2);if(n||i){e+=":"+w(n,2);if(i){var a=4;while(i%10===0){a-=1;i/=10}e+="."+w(i,a)}}}return e}r.cleanDate=function(e,t,n){if(r.isJSDate(e)||typeof e==="number"){if(_(n)){a.error("JS Dates and milliseconds are incompatible with world calendars",e);return t}e=r.ms2DateTimeLocal(+e);if(!e&&t!==undefined)return t}else if(!r.isDateTime(e,n)){a.error("unrecognized date",e);return t}return e};var S=/%\d?f/g;function C(e,t,r,n){e=e.replace(S,function(e){var r=Math.min(+e.charAt(1)||6,6),n=(t/1e3%1+2).toFixed(r).substr(2).replace(/0+$/,"")||"0";return n});var i=new Date(Math.floor(t+.05));if(_(n)){try{e=d.getComponentMethod("calendars","worldCalFmt")(e,t,n)}catch(e){return"Invalid"}}return r(e)(i)}var z=[59,59.9,59.99,59.999,59.9999];function E(e,t){var r=o(e+.05,u);var n=w(Math.floor(r/c),2)+":"+w(o(Math.floor(r/f),60),2);if(t!=="M"){if(!i(t))t=0;var a=Math.min(o(e/h,60),z[t]);var s=(100+a).toFixed(t).substr(1);if(t>0){s=s.replace(/0+$/,"").replace(/[\.]$/,"")}n+=":"+s}return n}r.formatDate=function(e,t,r,n,i,a){i=_(i)&&i;if(!t){if(r==="y")t=a.year;else if(r==="m")t=a.month;else if(r==="d"){t=a.dayMonth+"\n"+a.year}else{return E(e,r)+"\n"+C(a.dayMonthYear,e,n,i)}}return C(t,e,n,i)};var L=3*u;r.incrementMonth=function(e,t,r){r=_(r)&&r;var n=o(e,u);e=Math.round(e-n);if(r){try{var i=Math.round(e/u)+p,s=d.getComponentMethod("calendars","getCal")(r),l=s.fromJD(i);if(t%12)s.add(l,t,"m");else s.add(l,t/12,"y");return(l.toJD()-p)*u+n}catch(t){a.error("invalid ms "+e+" in calendar "+r)}}var c=new Date(e+L);return c.setUTCMonth(c.getUTCMonth()+t)+n-L};r.findExactDates=function(e,t){var r=0,n=0,a=0,o=0,s,l;var c=_(t)&&d.getComponentMethod("calendars","getCal")(t);for(var f=0;f<e.length;f++){l=e[f];if(!i(l)){o++;continue}if(l%u)continue;if(c){try{s=c.fromJD(l/u+p);if(s.day()===1){if(s.month()===1)r++;else n++}else a++}catch(e){}}else{s=new Date(l);if(s.getUTCDate()===1){if(s.getUTCMonth()===0)r++;else n++}else a++}}n+=r;a+=n;var h=e.length-o;return{exactYears:r/h,exactMonths:n/h,exactDays:a/h}}},{"../constants/numerical":142,"../registry":253,"./loggers":166,"./mod":168,d3:6,"fast-isnumeric":9}],152:[function(e,t,r){"use strict";t.exports=function e(t,r){if(!Array.isArray(t))t=[];t.length=r;return t}},{}],153:[function(e,t,r){"use strict";var n=e("events").EventEmitter;var i={init:function(e){if(e._ev instanceof n)return e;var t=new n;var r=new n;e._ev=t;e._internalEv=r;e.on=t.on.bind(t);e.once=t.once.bind(t);e.removeListener=t.removeListener.bind(t);e.removeAllListeners=t.removeAllListeners.bind(t);e._internalOn=r.on.bind(r);e._internalOnce=r.once.bind(r);e._removeInternalListener=r.removeListener.bind(r);e._removeAllInternalListeners=r.removeAllListeners.bind(r);e.emit=function(n,i){if(typeof jQuery!=="undefined"){jQuery(e).trigger(n,i)}t.emit(n,i);r.emit(n,i)};return e},triggerHandler:function(e,t,r){var n;var i;if(typeof jQuery!=="undefined"){n=jQuery(e).triggerHandler(t,r)}var a=e._ev;if(!a)return n;var o=a._events[t];if(!o)return n;function s(e){if(e.listener){a.removeListener(t,e.listener);if(!e.fired){e.fired=true;return e.listener.apply(a,[r])}}else{return e.apply(a,[r])}}o=Array.isArray(o)?o:[o];var l;for(l=0;l<o.length-1;l++){s(o[l])}i=s(o[l]);return n!==undefined?n:i},purge:function(e){delete e._ev;delete e.on;delete e.once;delete e.removeListener;delete e.removeAllListeners;delete e.emit;delete e._ev;delete e._internalEv;delete e._internalOn;delete e._internalOnce;delete e._removeInternalListener;delete e._removeAllInternalListeners;return e}};t.exports=i},{events:8}],154:[function(e,t,r){"use strict";var n=e("./is_plain_object.js");var i=Array.isArray;function a(e,t){var r,n;for(r=0;r<e.length;r++){n=e[r];if(n!==null&&typeof n==="object"){return false}if(n!==void 0){t[r]=n}}return true}r.extendFlat=function(){return o(arguments,false,false,false)};r.extendDeep=function(){return o(arguments,true,false,false)};r.extendDeepAll=function(){return o(arguments,true,true,false)};r.extendDeepNoArrays=function(){return o(arguments,true,false,true)};function o(e,t,r,s){var l=e[0],u=e.length;var c,f,h,p,d,v,m;if(u===2&&i(l)&&i(e[1])&&l.length===0){m=a(e[1],l);if(m){return l}else{l.splice(0,l.length)}}for(var g=1;g<u;g++){c=e[g];for(f in c){h=l[f];p=c[f];if(s&&i(p)){l[f]=p}else if(t&&p&&(n(p)||(d=i(p)))){if(d){d=false;v=h&&i(h)?h:[]}else{v=h&&n(h)?h:{}}l[f]=o([v,p],t,r,s)}else if(typeof p!=="undefined"||r){l[f]=p}}}return l}},{"./is_plain_object.js":163}],155:[function(e,t,r){"use strict";t.exports=function e(t){var r={},n=[],i=0;for(var a=0;a<t.length;a++){var o=t[a];if(r[o]!==1){r[o]=1;n[i++]=o}}return n}},{}],156:[function(e,t,r){"use strict";t.exports=function e(t){var r=a(t)?i:n;var o=[];for(var s=0;s<t.length;s++){var l=t[s];if(r(l))o.push(l)}return o};function n(e){return e.visible===true}function i(e){return e[0].trace.visible===true}function a(e){return Array.isArray(e)&&Array.isArray(e[0])&&e[0][0]&&e[0][0].trace}},{}],157:[function(e,t,r){"use strict";var n=e("../constants/numerical").BADNUM;r.calcTraceToLineCoords=function(e){var t=e[0].trace;var r=t.connectgaps;var i=[];var a=[];for(var o=0;o<e.length;o++){var s=e[o];var l=s.lonlat;if(l[0]!==n){a.push(l)}else if(!r&&a.length>0){i.push(a);a=[]}}if(a.length>0){i.push(a)}return i};r.makeLine=function(e){if(e.length===1){return{type:"LineString",coordinates:e[0]}}else{return{type:"MultiLineString",coordinates:e}}};r.makePolygon=function(e){if(e.length===1){return{type:"Polygon",coordinates:e}}else{var t=new Array(e.length);for(var r=0;r<e.length;r++){t[r]=[e[r]]}return{type:"MultiPolygon",coordinates:t}}};r.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":142}],158:[function(e,t,r){"use strict";var n=e("./mod");r.segmentsIntersect=i;function i(e,t,r,n,i,a,o,s){var l=r-e,u=i-e,c=o-i,f=n-t,h=a-t,p=s-a,d=l*p-c*f;if(d===0)return null;var v=(u*p-c*h)/d,m=(u*f-l*h)/d;if(m<0||m>1||v<0||v>1)return null;return{x:e+l*v,y:t+f*v}}r.segmentDistance=function e(t,r,n,o,s,l,u,c){if(i(t,r,n,o,s,l,u,c))return 0;var f=n-t;var h=o-r;var p=u-s;var d=c-l;var v=f*f+h*h;var m=p*p+d*d;var g=Math.min(a(f,h,v,s-t,l-r),a(f,h,v,u-t,c-r),a(p,d,m,t-s,r-l),a(p,d,m,n-s,o-l));return Math.sqrt(g)};function a(e,t,r,n,i){var a=n*e+i*t;if(a<0){return n*n+i*i}else if(a>r){var o=n-e;var s=i-t;return o*o+s*s}else{var l=n*t-i*e;return l*l/r}}var o,s,l;r.getTextLocation=function e(t,r,i,a){if(t!==s||a!==l){o={};s=t;l=a}if(o[i]){return o[i]}var u=t.getPointAtLength(n(i-a/2,r));var c=t.getPointAtLength(n(i+a/2,r));var f=Math.atan((c.y-u.y)/(c.x-u.x));var h=t.getPointAtLength(n(i,r));var p=(h.x*4+u.x+c.x)/6;var d=(h.y*4+u.y+c.y)/6;var v={x:p,y:d,theta:f};o[i]=v;return v};r.clearLocationCache=function(){s=null};r.getVisibleSegment=function e(t,r,n){var i=r.left;var a=r.right;var o=r.top;var s=r.bottom;var l=0;var u=t.getTotalLength();var c=u;var f,h;function p(e){var r=t.getPointAtLength(e);if(e===0)f=r;else if(e===u)h=r;var n=r.x<i?i-r.x:r.x>a?r.x-a:0;var l=r.y<o?o-r.y:r.y>s?r.y-s:0;return Math.sqrt(n*n+l*l)}var d=p(l);while(d){l+=d+n;if(l>c)return;d=p(l)}d=p(c);while(d){c-=d+n;if(l>c)return;d=p(c)}return{min:l,max:c,len:c-l,total:u,isClosed:l===0&&c===u&&Math.abs(f.x-h.x)<.1&&Math.abs(f.y-h.y)<.1}};r.findPointOnPath=function e(t,r,n,i){i=i||{};var a=i.pathLength||t.getTotalLength();var o=i.tolerance||.001;var s=i.iterationLimit||30;var l=t.getPointAtLength(0)[n]>t.getPointAtLength(a)[n]?-1:1;var u=0;var c=0;var f=a;var h;var p;var d;while(u<s){h=(c+f)/2;p=t.getPointAtLength(h);d=p[n]-r;if(Math.abs(d)<o){return p}else{if(l*d>0){f=h}else{c=h}u++}}return p}},{"./mod":168}],159:[function(e,t,r){"use strict";t.exports=function(e){var t;if(typeof e==="string"){t=document.getElementById(e);if(t===null){throw new Error("No DOM element with id '"+e+"' exists on the page.")}return t}else if(e===null||e===undefined){throw new Error("DOM element provided is null or undefined")}return e}},{}],160:[function(e,t,r){"use strict";t.exports=function e(t){return t}},{}],161:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../constants/numerical");var o=a.FP_SAFE;var s=a.BADNUM;var l=t.exports={};l.nestedProperty=e("./nested_property");l.keyedContainer=e("./keyed_container");l.relativeAttr=e("./relative_attr");l.isPlainObject=e("./is_plain_object");l.mod=e("./mod");l.toLogRange=e("./to_log_range");l.relinkPrivateKeys=e("./relink_private");l.ensureArray=e("./ensure_array");var u=e("./is_array");l.isTypedArray=u.isTypedArray;l.isArrayOrTypedArray=u.isArrayOrTypedArray;l.isArray1D=u.isArray1D;var c=e("./coerce");l.valObjectMeta=c.valObjectMeta;l.coerce=c.coerce;l.coerce2=c.coerce2;l.coerceFont=c.coerceFont;l.coerceHoverinfo=c.coerceHoverinfo;l.coerceSelectionMarkerOpacity=c.coerceSelectionMarkerOpacity;l.validate=c.validate;var f=e("./dates");l.dateTime2ms=f.dateTime2ms;l.isDateTime=f.isDateTime;l.ms2DateTime=f.ms2DateTime;l.ms2DateTimeLocal=f.ms2DateTimeLocal;l.cleanDate=f.cleanDate;l.isJSDate=f.isJSDate;l.formatDate=f.formatDate;l.incrementMonth=f.incrementMonth;l.dateTick0=f.dateTick0;l.dfltRange=f.dfltRange;l.findExactDates=f.findExactDates;l.MIN_MS=f.MIN_MS;l.MAX_MS=f.MAX_MS;var h=e("./search");l.findBin=h.findBin;l.sorterAsc=h.sorterAsc;l.sorterDes=h.sorterDes;l.distinctVals=h.distinctVals;l.roundUp=h.roundUp;var p=e("./stats");l.aggNums=p.aggNums;l.len=p.len;l.mean=p.mean;l.midRange=p.midRange;l.variance=p.variance;l.stdev=p.stdev;l.interp=p.interp;var d=e("./matrix");l.init2dArray=d.init2dArray;l.transposeRagged=d.transposeRagged;l.dot=d.dot;l.translationMatrix=d.translationMatrix;l.rotationMatrix=d.rotationMatrix;l.rotationXYMatrix=d.rotationXYMatrix;l.apply2DTransform=d.apply2DTransform;l.apply2DTransform2=d.apply2DTransform2;var v=e("./angles");l.deg2rad=v.deg2rad;l.rad2deg=v.rad2deg;l.wrap360=v.wrap360;l.wrap180=v.wrap180;var m=e("./geometry2d");l.segmentsIntersect=m.segmentsIntersect;l.segmentDistance=m.segmentDistance;l.getTextLocation=m.getTextLocation;l.clearLocationCache=m.clearLocationCache;l.getVisibleSegment=m.getVisibleSegment;l.findPointOnPath=m.findPointOnPath;var g=e("./extend");l.extendFlat=g.extendFlat;l.extendDeep=g.extendDeep;l.extendDeepAll=g.extendDeepAll;l.extendDeepNoArrays=g.extendDeepNoArrays;var y=e("./loggers");l.log=y.log;l.warn=y.warn;l.error=y.error;var _=e("./regex");l.counterRegex=_.counter;var x=e("./throttle");l.throttle=x.throttle;l.throttleDone=x.done;l.clearThrottle=x.clear;l.getGraphDiv=e("./get_graph_div");l._=e("./localize");l.notifier=e("./notifier");l.filterUnique=e("./filter_unique");l.filterVisible=e("./filter_visible");l.pushUnique=e("./push_unique");l.cleanNumber=e("./clean_number");l.ensureNumber=function e(t){if(!i(t))return s;t=Number(t);if(t<-o||t>o)return s;return i(t)?Number(t):s};l.isIndex=function(e,t){if(t!==undefined&&e>=t)return false;return i(e)&&e>=0&&e%1===0};l.noop=e("./noop");l.identity=e("./identity");l.swapAttrs=function(e,t,r,n){if(!r)r="x";if(!n)n="y";for(var i=0;i<t.length;i++){var a=t[i],o=l.nestedProperty(e,a.replace("?",r)),s=l.nestedProperty(e,a.replace("?",n)),u=o.get();o.set(s.get());s.set(u)}};l.raiseToTop=function e(t){t.parentNode.appendChild(t)};l.cancelTransition=function(e){return e.transition().duration(0)};l.constrain=function(e,t,r){if(t>r)return Math.max(r,Math.min(t,e));return Math.max(t,Math.min(r,e))};l.bBoxIntersect=function(e,t,r){r=r||0;return e.left<=t.right+r&&t.left<=e.right+r&&e.top<=t.bottom+r&&t.top<=e.bottom+r};l.simpleMap=function(e,t,r,n){var i=e.length,a=new Array(i);for(var o=0;o<i;o++)a[o]=t(e[o],r,n);return a};l.randstr=function e(t,r,n,i){if(!n)n=16;if(r===undefined)r=24;if(r<=0)return"0";var a=Math.log(Math.pow(2,r))/Math.log(n);var o="";var s,u,c;for(s=2;a===Infinity;s*=2){a=Math.log(Math.pow(2,r/s))/Math.log(n)*s}var f=a-Math.floor(a);for(s=0;s<Math.floor(a);s++){c=Math.floor(Math.random()*n).toString(n);o=c+o}if(f){u=Math.pow(n,f);c=Math.floor(Math.random()*u).toString(n);o=c+o}var h=parseInt(o,n);if(t&&t[o]||h!==Infinity&&h>=Math.pow(2,r)){if(i>10){l.warn("randstr failed uniqueness");return o}return e(t,r,n,(i||0)+1)}else return o};l.OptionControl=function(e,t){if(!e)e={};if(!t)t="opt";var r={};r.optionList=[];r._newoption=function(n){n[t]=e;r[n.name]=n;r.optionList.push(n)};r["_"+t]=e;return r};l.smooth=function(e,t){t=Math.round(t)||0;if(t<2)return e;var r=e.length,n=2*r,i=2*t-1,a=new Array(i),o=new Array(r),s,l,u,c;for(s=0;s<i;s++){a[s]=(1-Math.cos(Math.PI*(s+1)/t))/(2*t)}for(s=0;s<r;s++){c=0;for(l=0;l<i;l++){u=s+l+1-t;if(u<-r)u-=n*Math.round(u/n);else if(u>=n)u-=n*Math.floor(u/n);if(u<0)u=-1-u;else if(u>=r)u=n-1-u;c+=e[u]*a[l]}o[s]=c}return o};l.syncOrAsync=function(e,t,r){var n,i;function a(){return l.syncOrAsync(e,t,r)}while(e.length){i=e.splice(0,1)[0];n=i(t);if(n&&n.then){return n.then(a).then(undefined,l.promiseError)}}return r&&r(t)};l.stripTrailingSlash=function(e){if(e.substr(-1)==="/")return e.substr(0,e.length-1);return e};l.noneOrAll=function(e,t,r){if(!e)return;var n=false,i=true,a,o;for(a=0;a<r.length;a++){o=e[r[a]];if(o!==undefined&&o!==null)n=true;else i=false}if(n&&!i){for(a=0;a<r.length;a++){e[r[a]]=t[r[a]]}}};l.mergeArray=function(e,t,r){if(l.isArrayOrTypedArray(e)){var n=Math.min(e.length,t.length);for(var i=0;i<n;i++)t[i][r]=e[i]}};l.fillArray=function(e,t,r,n){n=n||l.identity;if(l.isArrayOrTypedArray(e)){for(var i=0;i<t.length;i++){t[i][r]=n(e[i])}}};l.castOption=function(e,t,r,n){n=n||l.identity;var i=l.nestedProperty(e,r).get();if(l.isArrayOrTypedArray(i)){if(Array.isArray(t)&&l.isArrayOrTypedArray(i[t[0]])){return n(i[t[0]][t[1]])}else{return n(i[t])}}else{return i}};l.extractOption=function(e,t,r,n){if(r in e)return e[r];var i=l.nestedProperty(t,n).get();if(!Array.isArray(i))return i};function b(e){var t={};for(var r in e){var n=e[r];for(var i=0;i<n.length;i++){t[n[i]]=+r}}return t}l.tagSelected=function(e,t,r){var n=t.selectedpoints;var i=t._indexToPoints;var a;if(i){a=b(i)}function o(t){return t!==undefined&&t<e.length}for(var s=0;s<n.length;s++){var u=n[s];if(l.isIndex(u)){var c=a?a[u]:u;var f=r?r[c]:c;if(o(f)){e[f].selected=1}}}};l.selIndices2selPoints=function(e){var t=e.selectedpoints;var r=e._indexToPoints;if(r){var n=b(r);var i=[];for(var a=0;a<t.length;a++){var o=t[a];if(l.isIndex(o)){var s=n[o];if(l.isIndex(s)){i.push(s)}}}return i}else{return t}};l.getTargetArray=function(e,t){var r=t.target;if(typeof r==="string"&&r){var n=l.nestedProperty(e,r).get();return Array.isArray(n)?n:false}else if(Array.isArray(r)){return r}return false};l.minExtend=function(e,t){var r={};if(typeof t!=="object")t={};var n=3,i=Object.keys(e),a,o,s;for(a=0;a<i.length;a++){o=i[a];s=e[o];if(o.charAt(0)==="_"||typeof s==="function")continue;else if(o==="module")r[o]=s;else if(Array.isArray(s))r[o]=s.slice(0,n);else if(s&&typeof s==="object")r[o]=l.minExtend(e[o],t[o]);else r[o]=s}i=Object.keys(t);for(a=0;a<i.length;a++){o=i[a];s=t[o];if(typeof s!=="object"||!(o in r)||typeof r[o]!=="object"){r[o]=s}}return r};l.titleCase=function(e){return e.charAt(0).toUpperCase()+e.substr(1)};l.containsAny=function(e,t){for(var r=0;r<t.length;r++){if(e.indexOf(t[r])!==-1)return true}return false};l.isPlotDiv=function(e){var t=n.select(e);return t.node()instanceof HTMLElement&&t.size()&&t.classed("js-plotly-plot")};l.removeElement=function(e){var t=e&&e.parentNode;if(t)t.removeChild(e)};l.addStyleRule=function(e,t){if(!l.styleSheet){var r=document.createElement("style");r.appendChild(document.createTextNode(""));document.head.appendChild(r);l.styleSheet=r.sheet}var n=l.styleSheet;if(n.insertRule){n.insertRule(e+"{"+t+"}",0)}else if(n.addRule){n.addRule(e,t,0)}else l.warn("addStyleRule failed")};l.isIE=function(){return typeof window.navigator.msSaveBlob!=="undefined"};l.isD3Selection=function(e){return e&&typeof e.classed==="function"};l.ensureSingle=function(e,t,r,n){var i=e.select(t+(r?"."+r:""));if(i.size())return i;var a=e.append(t).classed(r,true);if(n)a.call(n);return a};l.ensureSingleById=function(e,t,r,n){var i=e.select(t+"#"+r);if(i.size())return i;var a=e.append(t).attr("id",r);if(n)a.call(n);return a};l.objectFromPath=function(e,t){var r=e.split("."),n,i=n={};for(var a=0;a<r.length;a++){var o=r[a];var s=null;var l=r[a].match(/(.*)\[([0-9]+)\]/);if(l){o=l[1];s=l[2];n=n[o]=[];if(a===r.length-1){n[s]=t}else{n[s]={}}n=n[s]}else{if(a===r.length-1){n[o]=t}else{n[o]={}}n=n[o]}}return i};var w=/^([^\[\.]+)\.(.+)?/;var k=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;l.expandObjectPaths=function(e){var t,r,n,i,a,o,s;if(typeof e==="object"&&!Array.isArray(e)){for(r in e){if(e.hasOwnProperty(r)){if(t=r.match(w)){i=e[r];n=t[1];delete e[r];e[n]=l.extendDeepNoArrays(e[n]||{},l.objectFromPath(r,l.expandObjectPaths(i))[n])}else if(t=r.match(k)){i=e[r];n=t[1];a=parseInt(t[2]);delete e[r];e[n]=e[n]||[];if(t[3]==="."){s=t[4];o=e[n][a]=e[n][a]||{};l.extendDeepNoArrays(o,l.objectFromPath(s,l.expandObjectPaths(i)))}else{e[n][a]=l.expandObjectPaths(i)}}else{e[r]=l.expandObjectPaths(e[r])}}}}return e};l.numSeparate=function(e,t,r){if(!r)r=false;if(typeof t!=="string"||t.length===0){throw new Error("Separator string required for formatting!")}if(typeof e==="number"){e=String(e)}var n=/(\d+)(\d{3})/,i=t.charAt(0),a=t.charAt(1);var o=e.split("."),s=o[0],l=o.length>1?i+o[1]:"";if(a&&(o.length>1||s.length>4||r)){while(n.test(s)){s=s.replace(n,"$1"+a+"$2")}}return s+l};var A=/%{([^\s%{}]*)}/g;var T=/^\w*$/;l.templateString=function(e,t){var r={};return e.replace(A,function(e,n){if(T.test(n)){return t[n]||""}r[n]=r[n]||l.nestedProperty(t,n).get;return r[n]()||""})};var M=48;var S=57;l.subplotSort=function(e,t){var r=Math.min(e.length,t.length)+1;var n=0;var i=0;for(var a=0;a<r;a++){var o=e.charCodeAt(a)||0;var s=t.charCodeAt(a)||0;var l=o>=M&&o<=S;var u=s>=M&&s<=S;if(l)n=10*n+o-M;if(u)i=10*i+s-M;if(!l||!u){if(n!==i)return n-i;if(o!==s)return o-s}}return i-n};var C=2e9;l.seedPseudoRandom=function(){C=2e9};l.pseudoRandom=function(){var e=C;C=(69069*C+1)%4294967296;if(Math.abs(C-e)<429496729)return l.pseudoRandom();return C/4294967296}},{"../constants/numerical":142,"./angles":147,"./clean_number":148,"./coerce":150,"./dates":151,"./ensure_array":152,"./extend":154,"./filter_unique":155,"./filter_visible":156,"./geometry2d":158,"./get_graph_div":159,"./identity":160,"./is_array":162,"./is_plain_object":163,"./keyed_container":164,"./localize":165,"./loggers":166,"./matrix":167,"./mod":168,"./nested_property":169,"./noop":170,"./notifier":171,"./push_unique":174,"./regex":176,"./relative_attr":177,"./relink_private":178,"./search":179,"./stats":181,"./throttle":183,"./to_log_range":184,d3:6,"fast-isnumeric":9}],162:[function(e,t,r){"use strict";var n=typeof ArrayBuffer==="undefined"||!ArrayBuffer.isView?{isView:function(){return false}}:ArrayBuffer;var i=typeof DataView==="undefined"?function(){}:DataView;function a(e){return n.isView(e)&&!(e instanceof i)}function o(e){return Array.isArray(e)||a(e)}function s(e){return!o(e[0])}t.exports={isTypedArray:a,isArrayOrTypedArray:o,isArray1D:s}},{}],163:[function(e,t,r){"use strict";t.exports=function e(t){if(window&&window.process&&window.process.versions){return Object.prototype.toString.call(t)==="[object Object]"}return Object.prototype.toString.call(t)==="[object Object]"&&Object.getPrototypeOf(t)===Object.prototype}},{}],164:[function(e,t,r){"use strict";var n=e("./nested_property");var i=/^\w*$/;var a=0;var o=1;var s=2;var l=3;var u=4;t.exports=function e(t,r,c,f){c=c||"name";f=f||"value";var h,p,d;var v={};if(r&&r.length){d=n(t,r);p=d.get()}else{p=t}r=r||"";var m={};if(p){for(h=0;h<p.length;h++){m[p[h][c]]=h}}var g=i.test(f);var y={set:function(e,t){var r=t===null?u:a;if(!p){if(!d||r===u)return;p=[];d.set(p)}var i=m[e];if(i===undefined){if(r===u)return;r=r|l;i=p.length;m[e]=i}else if(t!==(g?p[i][f]:n(p[i],f).get())){r=r|s}var o=p[i]=p[i]||{};o[c]=e;if(g){o[f]=t}else{n(o,f).set(t)}if(t!==null){r=r&~u}v[i]=v[i]|r;return y},get:function(e){if(!p)return;var t=m[e];if(t===undefined){return undefined}else if(g){return p[t][f]}else{return n(p[t],f).get()}},rename:function(e,t){var r=m[e];if(r===undefined)return y;v[r]=v[r]|o;m[t]=r;delete m[e];p[r][c]=t;return y},remove:function(e){var t=m[e];if(t===undefined)return y;var r=p[t];if(Object.keys(r).length>2){v[t]=v[t]|s;return y.set(e,null)}if(g){for(h=t;h<p.length;h++){v[h]=v[h]|l}for(h=t;h<p.length;h++){m[p[h][c]]--}p.splice(t,1);delete m[e]}else{n(r,f).set(null);v[t]=v[t]|s|u}return y},constructUpdate:function(){var e,t;var i={};var a=Object.keys(v);for(var l=0;l<a.length;l++){t=a[l];e=r+"["+t+"]";if(p[t]){if(v[t]&o){i[e+"."+c]=p[t][c]}if(v[t]&s){if(g){i[e+"."+f]=v[t]&u?null:p[t][f]}else{i[e+"."+f]=v[t]&u?null:n(p[t],f).get()}}}else{i[e]=null}}return i}};return y}},{"./nested_property":169}],165:[function(e,t,r){"use strict";var n=e("../registry");t.exports=function e(t,r){var i=t._context.locale;for(var a=0;a<2;a++){var o=t._context.locales;for(var s=0;s<2;s++){var l=(o[i]||{}).dictionary;if(l){var u=l[r];if(u)return u}o=n.localeRegistry}var c=i.split("-")[0];if(c===i)break;i=c}return r}},{"../registry":253}],166:[function(e,t,r){"use strict";var n=e("../plot_api/plot_config");var i=t.exports={};i.log=function(){if(n.logging>1){var e=["LOG:"];for(var t=0;t<arguments.length;t++){e.push(arguments[t])}a(console.trace||console.log,e)}};i.warn=function(){if(n.logging>0){var e=["WARN:"];for(var t=0;t<arguments.length;t++){e.push(arguments[t])}a(console.trace||console.log,e)}};i.error=function(){if(n.logging>0){var e=["ERROR:"];for(var t=0;t<arguments.length;t++){e.push(arguments[t])}a(console.error,e)}};function a(e,t){if(e.apply){e.apply(e,t)}else{for(var r=0;r<t.length;r++){e(t[r])}}}},{"../plot_api/plot_config":193}],167:[function(e,t,r){"use strict";r.init2dArray=function(e,t){var r=new Array(e);for(var n=0;n<e;n++)r[n]=new Array(t);return r};r.transposeRagged=function(e){var t=0,r=e.length,n,i;for(n=0;n<r;n++)t=Math.max(t,e[n].length);var a=new Array(t);for(n=0;n<t;n++){a[n]=new Array(r);for(i=0;i<r;i++)a[n][i]=e[i][n]}return a};r.dot=function(e,t){if(!(e.length&&t.length)||e.length!==t.length)return null;var n=e.length,i,a;if(e[0].length){i=new Array(n);for(a=0;a<n;a++)i[a]=r.dot(e[a],t)}else if(t[0].length){var o=r.transposeRagged(t);i=new Array(o.length);for(a=0;a<o.length;a++)i[a]=r.dot(e,o[a])}else{i=0;for(a=0;a<n;a++)i+=e[a]*t[a]}return i};r.translationMatrix=function(e,t){return[[1,0,e],[0,1,t],[0,0,1]]};r.rotationMatrix=function(e){var t=e*Math.PI/180;return[[Math.cos(t),-Math.sin(t),0],[Math.sin(t),Math.cos(t),0],[0,0,1]]};r.rotationXYMatrix=function(e,t,n){return r.dot(r.dot(r.translationMatrix(t,n),r.rotationMatrix(e)),r.translationMatrix(-t,-n))};r.apply2DTransform=function(e){return function(){var t=arguments;if(t.length===3){t=t[0]}var n=arguments.length===1?t[0]:[t[0],t[1]];return r.dot(e,[n[0],n[1],1]).slice(0,2)}};r.apply2DTransform2=function(e){var t=r.apply2DTransform(e);return function(e){return t(e.slice(0,2)).concat(t(e.slice(2,4)))}}},{}],168:[function(e,t,r){"use strict";t.exports=function e(t,r){var n=t%r;return n<0?n+r:n}},{}],169:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("./is_array").isArrayOrTypedArray;t.exports=function e(t,r){if(n(r))r=String(r);else if(typeof r!=="string"||r.substr(r.length-4)==="[-1]"){throw"bad property string"}var i=0,o=r.split("."),s,u,c;while(i<o.length){s=String(o[i]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/);if(s){if(s[1])o[i]=s[1];else if(i===0)o.splice(0,1);else throw"bad property string";u=s[2].substr(1,s[2].length-2).split("][");for(c=0;c<u.length;c++){i++;o.splice(i,0,Number(u[c]))}}i++}if(typeof t!=="object"){return h(t,r,o)}return{set:l(t,o,r),get:a(t,o),astr:r,parts:o,obj:t}};function a(e,t){return function(){var r=e,n,o,s,l,u;for(l=0;l<t.length-1;l++){n=t[l];if(n===-1){o=true;s=[];for(u=0;u<r.length;u++){s[u]=a(r[u],t.slice(l+1))();if(s[u]!==s[0])o=false}return o?s[0]:s}if(typeof n==="number"&&!i(r)){return undefined}r=r[n];if(typeof r!=="object"||r===null){return undefined}}if(typeof r!=="object"||r===null)return undefined;s=r[t[l]];if(s===null)return undefined;return s}}var o=/(^|\.)args\[/;function s(e,t){return e===undefined||e===null&&!t.match(o)}function l(e,t,r){return function(n){var a=e,o="",l=[[e,o]],h=s(n,r),p,d;for(d=0;d<t.length-1;d++){p=t[d];if(typeof p==="number"&&!i(a)){throw"array index but container is not an array"}if(p===-1){h=!c(a,t.slice(d+1),n,r);if(h)break;else return}if(!f(a,p,t[d+1],h)){break}a=a[p];if(typeof a!=="object"||a===null){throw"container is not an object"}o=u(o,p);l.push([a,o])}if(h){if(d===t.length-1){delete a[t[d]];if(Array.isArray(a)&&+t[d]===a.length-1){while(a.length&&a[a.length-1]===undefined){a.pop()}}}}else a[t[d]]=n}}function u(e,t){var r=t;if(n(t))r="["+t+"]";else if(e)r="."+t;return e+r}function c(e,t,r,n){var a=i(r),o=true,u=r,c=n.replace("-1",0),h=a?false:s(r,c),p=t[0],d;for(d=0;d<e.length;d++){c=n.replace("-1",d);if(a){u=r[d%r.length];h=s(u,c)}if(h)o=false;if(!f(e,d,p,h)){continue}l(e[d],t,n.replace("-1",d))(u)}return o}function f(e,t,r,n){if(e[t]===undefined){if(n)return false;if(typeof r==="number")e[t]=[];else e[t]={}}return true}function h(e,t,r){return{set:function(){throw"bad container"},get:function(){},astr:t,parts:r,obj:e}}},{"./is_array":162,"fast-isnumeric":9}],170:[function(e,t,r){"use strict";t.exports=function e(){}},{}],171:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=[];t.exports=function(e,t){if(a.indexOf(e)!==-1)return;a.push(e);var r=1e3;if(i(t))r=t;else if(t==="long")r=3e3;var o=n.select("body").selectAll(".plotly-notifier").data([0]);o.enter().append("div").classed("plotly-notifier",true);var s=o.selectAll(".notifier-note").data(a);function l(e){e.duration(700).style("opacity",0).each("end",function(e){var t=a.indexOf(e);if(t!==-1)a.splice(t,1);n.select(this).remove()})}s.enter().append("div").classed("notifier-note",true).style("opacity",0).each(function(e){var t=n.select(this);t.append("button").classed("notifier-close",true).html("&times;").on("click",function(){t.transition().call(l)});var i=t.append("p");var a=e.split(/<br\s*\/?>/g);for(var o=0;o<a.length;o++){if(o)i.append("br");i.append("span").text(a[o])}t.transition().duration(700).style("opacity",1).transition().delay(r).call(l)})}},{d3:6,"fast-isnumeric":9}],172:[function(e,t,r){"use strict";var n=e("./setcursor");var i="data-savedcursor";var a="!!";t.exports=function e(t,r){var o=t.attr(i);if(r){if(!o){var s=(t.attr("class")||"").split(" ");for(var l=0;l<s.length;l++){var u=s[l];if(u.indexOf("cursor-")===0){t.attr(i,u.substr(7)).classed(u,false)}}if(!t.attr(i)){t.attr(i,a)}}n(t,r)}else if(o){t.attr(i,null);if(o===a)n(t);else n(t,o)}}},{"./setcursor":180}],173:[function(e,t,r){"use strict";var n=e("./matrix").dot;var i=e("../constants/numerical").BADNUM;var a=t.exports={};a.tester=function e(t){if(Array.isArray(t[0][0]))return a.multitester(t);var r=t.slice(),n=r[0][0],o=n,s=r[0][1],l=s,u;r.push(r[0]);for(u=1;u<r.length;u++){n=Math.min(n,r[u][0]);o=Math.max(o,r[u][0]);s=Math.min(s,r[u][1]);l=Math.max(l,r[u][1])}var c=false,f;if(r.length===5){if(r[0][0]===r[1][0]){if(r[2][0]===r[3][0]&&r[0][1]===r[3][1]&&r[1][1]===r[2][1]){c=true;f=function(e){return e[0]===r[0][0]}}}else if(r[0][1]===r[1][1]){if(r[2][1]===r[3][1]&&r[0][0]===r[3][0]&&r[1][0]===r[2][0]){c=true;f=function(e){return e[1]===r[0][1]}}}}function h(e,t){var r=e[0],a=e[1];if(r===i||r<n||r>o||a===i||a<s||a>l){return false}if(t&&f(e))return false;return true}function p(e,t){var a=e[0],u=e[1];if(a===i||a<n||a>o||u===i||u<s||u>l){return false}var c=r.length,f=r[0][0],h=r[0][1],p=0,d,v,m,g,y;for(d=1;d<c;d++){v=f;m=h;f=r[d][0];h=r[d][1];g=Math.min(v,f);if(a<g||a>Math.max(v,f)||u>Math.max(m,h)){continue}else if(u<Math.min(m,h)){if(a!==g)p++}else{if(f===v)y=u;else y=m+(a-v)*(h-m)/(f-v);if(u===y){if(d===1&&t)return false;return true}if(u<=y&&a!==g)p++}}return p%2===1}var d=true;var v=r[0];for(u=1;u<r.length;u++){if(v[0]!==r[u][0]||v[1]!==r[u][1]){d=false;break}}return{xmin:n,xmax:o,ymin:s,ymax:l,pts:r,contains:c?h:p,isRect:c,degenerate:d}};a.multitester=function e(t){var r=[],n=t[0][0][0],i=n,o=t[0][0][1],s=o;for(var l=0;l<t.length;l++){var u=a.tester(t[l]);u.subtract=t[l].subtract;r.push(u);n=Math.min(n,u.xmin);i=Math.max(i,u.xmax);o=Math.min(o,u.ymin);s=Math.max(s,u.ymax)}function c(e,t){var n=false;for(var i=0;i<r.length;i++){if(r[i].contains(e,t)){n=r[i].subtract===false}}return n}return{xmin:n,xmax:i,ymin:o,ymax:s,pts:[],contains:c,isRect:false,degenerate:false}};var o=a.isSegmentBent=function e(t,r,i,a){var o=t[r],s=[t[i][0]-o[0],t[i][1]-o[1]],l=n(s,s),u=Math.sqrt(l),c=[-s[1]/u,s[0]/u],f,h,p;for(f=r+1;f<i;f++){h=[t[f][0]-o[0],t[f][1]-o[1]];p=n(h,s);if(p<0||p>l||Math.abs(n(h,c))>a)return true}return false};a.filter=function e(t,r){var n=[t[0]],i=0,a=0;function s(e){t.push(e);var s=n.length,l=i;n.splice(a+1);for(var u=l+1;u<t.length;u++){if(u===t.length-1||o(t,l,u+1,r)){n.push(t[u]);if(n.length<s-2){i=u;a=n.length-1}l=u}}}if(t.length>1){var l=t.pop();s(l)}return{addPt:s,raw:t,filtered:n}}},{"../constants/numerical":142,"./matrix":167}],174:[function(e,t,r){"use strict";t.exports=function e(t,r){if(r instanceof RegExp){var n=r.toString(),i;for(i=0;i<t.length;i++){if(t[i]instanceof RegExp&&t[i].toString()===n){return t}}t.push(r)}else if((r||r===0)&&t.indexOf(r)===-1)t.push(r);return t}},{}],175:[function(e,t,r){"use strict";var n=e("../lib");var i=e("../plot_api/plot_config");function a(e,t){var r=[];var i;for(var a=0;a<t.length;a++){i=t[a];if(i===e)r[a]=i;else if(typeof i==="object"){r[a]=Array.isArray(i)?n.extendDeep([],i):n.extendDeepAll({},i)}else r[a]=i}return r}var o={};o.add=function(e,t,r,n,a){var o,s;e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:false};s=e.undoQueue.index;if(e.autoplay){if(!e.undoQueue.inSequence)e.autoplay=false;return}if(!e.undoQueue.sequence||e.undoQueue.beginSequence){o={undo:{calls:[],args:[]},redo:{calls:[],args:[]}};e.undoQueue.queue.splice(s,e.undoQueue.queue.length-s,o);e.undoQueue.index+=1}else{o=e.undoQueue.queue[s-1]}e.undoQueue.beginSequence=false;if(o){o.undo.calls.unshift(t);o.undo.args.unshift(r);o.redo.calls.push(n);o.redo.args.push(a)}if(e.undoQueue.queue.length>i.queueLength){e.undoQueue.queue.shift();e.undoQueue.index--}};o.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:false};e.undoQueue.sequence=true;e.undoQueue.beginSequence=true};o.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:false};e.undoQueue.sequence=false;e.undoQueue.beginSequence=false};o.undo=function e(t){var r,n;if(t.framework&&t.framework.isPolar){t.framework.undo();return}if(t.undoQueue===undefined||isNaN(t.undoQueue.index)||t.undoQueue.index<=0){return}t.undoQueue.index--;r=t.undoQueue.queue[t.undoQueue.index];t.undoQueue.inSequence=true;for(n=0;n<r.undo.calls.length;n++){o.plotDo(t,r.undo.calls[n],r.undo.args[n])}t.undoQueue.inSequence=false;t.autoplay=false};o.redo=function e(t){var r,n;if(t.framework&&t.framework.isPolar){t.framework.redo();return}if(t.undoQueue===undefined||isNaN(t.undoQueue.index)||t.undoQueue.index>=t.undoQueue.queue.length){return}r=t.undoQueue.queue[t.undoQueue.index];t.undoQueue.inSequence=true;for(n=0;n<r.redo.calls.length;n++){o.plotDo(t,r.redo.calls[n],r.redo.args[n])}t.undoQueue.inSequence=false;t.autoplay=false;t.undoQueue.index++};o.plotDo=function(e,t,r){e.autoplay=true;r=a(e,r);t.apply(null,r)};t.exports=o},{"../lib":161,"../plot_api/plot_config":193}],176:[function(e,t,r){"use strict";r.counter=function(e,t,r){var n=(t||"")+(r?"":"$");if(e==="xy"){return new RegExp("^x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+n)}return new RegExp("^"+e+"([2-9]|[1-9][0-9]+)?"+n)}},{}],177:[function(e,t,r){"use strict";var n=/^(.*)(\.[^\.\[\]]+|\[\d\])$/;var i=/^[^\.\[\]]+$/;t.exports=function(e,t){while(t){var r=e.match(n);if(r)e=r[1];else if(e.match(i))e="";else throw new Error("bad relativeAttr call:"+[e,t]);if(t.charAt(0)==="^")t=t.slice(1);else break}if(e&&t.charAt(0)!=="["){return e+"."+t}return e+t}},{}],178:[function(e,t,r){"use strict";var n=e("./is_array").isArrayOrTypedArray;var i=e("./is_plain_object");t.exports=function e(t,r){for(var a in r){var o=r[a];var s=t[a];if(s===o){continue}if(a.charAt(0)==="_"||typeof o==="function"){if(a in t)continue;t[a]=o}else if(n(o)&&n(s)&&i(o[0])){if(a==="customdata"||a==="ids")continue;var l=Math.min(o.length,s.length);for(var u=0;u<l;u++){if(s[u]!==o[u]&&i(o[u])&&i(s[u])){e(s[u],o[u])}}}else if(i(o)&&i(s)){e(s,o);if(!Object.keys(s).length)delete t[a]}}}},{"./is_array":162,"./is_plain_object":163}],179:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("./loggers");var a=1e-9;r.findBin=function(e,t,r){if(n(t.start)){return r?Math.ceil((e-t.start)/t.size-a)-1:Math.floor((e-t.start)/t.size+a)}else{var c=0;var f=t.length;var h=0;var p=f>1?(t[f-1]-t[0])/(f-1):1;var d,v;if(p>=0){v=r?o:s}else{v=r?u:l}e+=p*a*(r?-1:1)*(p>=0?1:-1);while(c<f&&h++<100){d=Math.floor((c+f)/2);if(v(t[d],e))c=d+1;else f=d}if(h>90)i.log("Long binary search...");return c-1}};function o(e,t){return e<t}function s(e,t){return e<=t}function l(e,t){return e>t}function u(e,t){return e>=t}r.sorterAsc=function(e,t){return e-t};r.sorterDes=function(e,t){return t-e};r.distinctVals=function(e){var t=e.slice();t.sort(r.sorterAsc);var n=t.length-1,i=t[n]-t[0]||1,a=i/(n||1)/1e4,o=[t[0]];for(var s=0;s<n;s++){if(t[s+1]>t[s]+a){i=Math.min(i,t[s+1]-t[s]);o.push(t[s+1])}}return{vals:o,minDiff:i}};r.roundUp=function(e,t,r){var n=0,i=t.length-1,a,o=0,s=r?0:1,l=r?1:0,u=r?Math.ceil:Math.floor;while(n<i&&o++<100){a=u((n+i)/2);if(t[a]<=e)n=a+s;else i=a-l}return t[n]}},{"./loggers":166,"fast-isnumeric":9}],180:[function(e,t,r){"use strict";t.exports=function e(t,r){(t.attr("class")||"").split(" ").forEach(function(e){if(e.indexOf("cursor-")===0)t.classed(e,false)});if(r)t.classed("cursor-"+r,true)}},{}],181:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("./is_array").isArrayOrTypedArray;r.aggNums=function(e,t,a,o){var s,l;if(!o||o>a.length)o=a.length;if(!n(t))t=false;if(i(a[0])){l=new Array(o);for(s=0;s<o;s++)l[s]=r.aggNums(e,t,a[s]);a=l}for(s=0;s<o;s++){if(!n(t))t=a[s];else if(n(a[s]))t=e(+t,+a[s])}return t};r.len=function(e){return r.aggNums(function(e){return e+1},0,e)};r.mean=function(e,t){if(!t)t=r.len(e);return r.aggNums(function(e,t){return e+t},0,e)/t};r.midRange=function(e){if(e===undefined||e.length===0)return undefined;return(r.aggNums(Math.max,null,e)+r.aggNums(Math.min,null,e))/2};r.variance=function(e,t,i){if(!t)t=r.len(e);if(!n(i))i=r.mean(e,t);return r.aggNums(function(e,t){return e+Math.pow(t-i,2)},0,e)/t};r.stdev=function(e,t,n){return Math.sqrt(r.variance(e,t,n))};r.interp=function(e,t){if(!n(t))throw"n should be a finite number";t=t*e.length-.5;if(t<0)return e[0];if(t>e.length-1)return e[e.length-1];var r=t%1;return r*e[Math.ceil(t)]+(1-r)*e[Math.floor(t)]}},{"./is_array":162,"fast-isnumeric":9}],182:[function(e,t,r){"use strict";var n=e("d3");var i=e("../lib");var a=e("../constants/xmlns_namespaces");var o=e("../constants/string_mappings");var s=e("../constants/alignment").LINE_SPACING;function l(e,t){return e.node().getBoundingClientRect()[t]}var u=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;r.convertToTspans=function(e,t,i){var a=e.text();var o=!e.attr("data-notex")&&typeof MathJax!=="undefined"&&a.match(u);var s=n.select(e.node().parentNode);if(s.empty())return;var c=e.attr("class")?e.attr("class").split(" ")[0]:"text";c+="-math";s.selectAll("svg."+c).remove();s.selectAll("g."+c+"-group").remove();e.style("display",null).attr({"data-unformatted":a,"data-math":"N"});function f(){if(!s.empty()){c=e.attr("class")+"-math";s.select("svg."+c).remove()}e.text("").style("white-space","pre");var t=P(e.node(),a);if(t){e.style("pointer-events","all")}r.positionText(e);if(i)i.call(e)}if(o){(t&&t._promises||[]).push(new Promise(function(t){e.style("display","none");var r=parseInt(e.node().style.fontSize,10);var n={fontSize:r};p(o[2],n,function(n,o,u){s.selectAll("svg."+c).remove();s.selectAll("g."+c+"-group").remove();var h=n&&n.select("svg");if(!h||!h.node()){f();t();return}var p=s.append("g").classed(c+"-group",true).attr({"pointer-events":"none","data-unformatted":a,"data-math":"Y"});p.node().appendChild(h.node());if(o&&o.node()){h.node().insertBefore(o.node().cloneNode(true),h.node().firstChild)}h.attr({class:c,height:u.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var d=e.node().style.fill||"black";h.select("g").attr({fill:d,stroke:d});var v=l(h,"width"),m=l(h,"height"),g=+e.attr("x")-v*{start:0,middle:.5,end:1}[e.attr("text-anchor")||"start"],y=r||l(e,"height"),_=-y/4;if(c[0]==="y"){p.attr({transform:"rotate("+[-90,+e.attr("x"),+e.attr("y")]+") translate("+[-v/2,_-m/2]+")"});h.attr({x:+e.attr("x"),y:+e.attr("y")})}else if(c[0]==="l"){h.attr({x:e.attr("x"),y:_-m/2})}else if(c[0]==="a"){h.attr({x:0,y:_})}else{h.attr({x:g,y:+e.attr("y")+_-m/2})}if(i)i.call(e,p);t(p)})}))}else f();return e};var c=/(<|&lt;|&#60;)/g;var f=/(>|&gt;|&#62;)/g;function h(e){return e.replace(c,"\\lt ").replace(f,"\\gt ")}function p(e,t,r){var a="math-output-"+i.randstr({},64);var o=n.select("body").append("div").attr({id:a}).style({visibility:"hidden",position:"absolute"}).style({"font-size":t.fontSize+"px"}).text(h(e));MathJax.Hub.Queue(["Typeset",MathJax.Hub,o.node()],function(){var t=n.select("body").select("#MathJax_SVG_glyphs");if(o.select(".MathJax_SVG").empty()||!o.select("svg").node()){i.log("There was an error in the tex syntax.",e);r()}else{var a=o.select("svg").node().getBoundingClientRect();r(o.select(".MathJax_SVG"),t,a)}o.remove()})}var d={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"};var v={sub:"0.3em",sup:"-0.6em"};var m={sub:"-0.21em",sup:"0.42em"};var g="\u200b";var y=["http:","https:","mailto:","",undefined,":"];var _=new RegExp("</?("+Object.keys(d).join("|")+")( [^>]*)?/?>","g");var x=Object.keys(o.entityToUnicode).map(function(e){return{regExp:new RegExp("&"+e+";","g"),sub:o.entityToUnicode[e]}});var b=/(\r\n?|\n)/g;var w=/(<[^<>]*>)/;var k=/<(\/?)([^ >]*)(\s+(.*))?>/i;var A=/<br(\s+.*)?>/i;var T=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i;var M=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i;var S=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i;var C=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function z(e,t){if(!e)return null;var r=e.match(t);return r&&(r[3]||r[4])}var E=/(^|;)\s*color:/;r.plainText=function(e){return(e||"").replace(_," ")};function L(e,t){if(!e)return"";for(var r=0;r<t.length;r++){var n=t[r];e=e.replace(n.regExp,n.sub)}return e}function I(e){return L(e,x)}function P(e,t){t=I(t).replace(b," ");var r=false;var o=[];var l;var u=-1;function c(){u++;var t=document.createElementNS(a.svg,"tspan");n.select(t).attr({class:"line",dy:u*s+"em"});e.appendChild(t);l=t;var r=o;o=[{node:t}];if(r.length>1){for(var i=1;i<r.length;i++){f(r[i])}}}function f(e){var t=e.type;var r={};var i;if(t==="a"){i="a";var s=e.target;var u=e.href;var c=e.popup;if(u){r={"xlink:xlink:show":s==="_blank"||s.charAt(0)!=="_"?"new":"replace",target:s,"xlink:xlink:href":u};if(c){r.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+c+'");return false;'}}}else i="tspan";if(e.style)r.style=e.style;var f=document.createElementNS(a.svg,i);if(t==="sup"||t==="sub"){h(l,g);l.appendChild(f);var p=document.createElementNS(a.svg,"tspan");h(p,g);n.select(p).attr("dy",m[t]);r.dy=v[t];l.appendChild(f);l.appendChild(p)}else{l.appendChild(f)}n.select(f).attr(r);l=e.node=f;o.push(e)}function h(e,t){e.appendChild(document.createTextNode(t))}function p(e){if(o.length===1){i.log("Ignoring unexpected end tag </"+e+">.",t);return}var r=o.pop();if(e!==r.type){i.log("Start tag <"+r.type+"> doesnt match end tag <"+e+">. Pretending it did match.",t)}l=o[o.length-1].node}var _=A.test(t);if(_)c();else{l=e;o=[{node:e}]}var x=t.split(w);for(var L=0;L<x.length;L++){var P=x[L];var D=P.match(k);var O=D&&D[2].toLowerCase();var R=d[O];if(O==="br"){c()}else if(R===undefined){h(l,P)}else{if(D[1]){p(O)}else{var F=D[4];var B={type:O};var N=z(F,T);if(N){N=N.replace(E,"$1 fill:");if(R)N+=";"+R}else if(R)N=R;if(N)B.style=N;if(O==="a"){r=true;var j=z(F,M);if(j){var V=document.createElement("a");V.href=j;if(y.indexOf(V.protocol)!==-1){B.href=encodeURI(decodeURI(j));B.target=z(F,S)||"_blank";B.popup=z(F,C)}}}f(B)}}}return r}r.lineCount=function e(t){return t.selectAll("tspan.line").size()||1};r.positionText=function e(t,r,i){return t.each(function(){var e=n.select(this);function t(t,r){if(r===undefined){r=e.attr(t);if(r===null){e.attr(t,0);r=0}}else e.attr(t,r);return r}var a=t("x",r);var o=t("y",i);if(this.nodeName==="text"){e.selectAll("tspan.line").attr({x:a,y:o})}})};function D(e,t,r){var n=r.horizontalAlign,i=r.verticalAlign||"top",a=e.node().getBoundingClientRect(),o=t.node().getBoundingClientRect(),s,l,u;if(i==="bottom"){l=function(){return a.bottom-s.height}}else if(i==="middle"){l=function(){return a.top+(a.height-s.height)/2}}else{l=function(){return a.top}}if(n==="right"){u=function(){return a.right-s.width}}else if(n==="center"){u=function(){return a.left+(a.width-s.width)/2}}else{u=function(){return a.left}}return function(){s=this.node().getBoundingClientRect();this.style({top:l()-o.top+"px",left:u()-o.left+"px","z-index":1e3});return this}}r.makeEditable=function(e,t){var r=t.gd;var i=t.delegate;var a=n.dispatch("edit","input","cancel");var o=i||e;e.style({"pointer-events":i?"none":"all"});if(e.size()!==1)throw new Error("boo");function s(){u();e.style({opacity:0});var t=o.attr("class"),r;if(t)r="."+t.split(" ")[0]+"-math-group";else r="[class*=-math-group]";if(r){n.select(e.node().parentNode).select(r).style({opacity:0})}}function l(e){var t=e.node();var r=document.createRange();r.selectNodeContents(t);var n=window.getSelection();n.removeAllRanges();n.addRange(r);t.focus()}function u(){var i=n.select(r);var o=i.select(".svg-container");var s=o.append("div");var u=e.node().style;var c=parseFloat(u.fontSize||12);var f=t.text;if(f===undefined)f=e.attr("data-unformatted");s.classed("plugin-editable editable",true).style({position:"absolute","font-family":u.fontFamily||"Arial","font-size":c,color:t.fill||u.fill||"black",opacity:1,"background-color":t.background||"transparent",outline:"#ffffff33 1px solid",margin:[-c/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:true}).text(f).call(D(e,o,t)).on("blur",function(){r._editing=false;e.text(this.textContent).style({opacity:1});var t=n.select(this).attr("class"),i;if(t)i="."+t.split(" ")[0]+"-math-group";else i="[class*=-math-group]";if(i){n.select(e.node().parentNode).select(i).style({opacity:0})}var o=this.textContent;n.select(this).transition().duration(0).remove();n.select(document).on("mouseup",null);a.edit.call(e,o)}).on("focus",function(){var e=this;r._editing=true;n.select(document).on("mouseup",function(){if(n.event.target===e)return false;if(document.activeElement===s.node())s.node().blur()})}).on("keyup",function(){if(n.event.which===27){r._editing=false;e.style({opacity:1});n.select(this).style({opacity:0}).on("blur",function(){return false}).transition().remove();a.cancel.call(e,this.textContent)}else{a.input.call(e,this.textContent);n.select(this).call(D(e,o,t))}}).on("keydown",function(){if(n.event.which===13)this.blur()}).call(l)}if(t.immediate)s();else o.on("click",s);return n.rebind(e,a,"on")}},{"../constants/alignment":140,"../constants/string_mappings":143,"../constants/xmlns_namespaces":144,"../lib":161,d3:6}],183:[function(e,t,r){"use strict";var n={};r.throttle=function e(t,r,a){var o=n[t];var s=Date.now();if(!o){for(var l in n){if(n[l].ts<s-6e4){delete n[l]}}o=n[t]={ts:0,timer:null}}i(o);function u(){a();o.ts=Date.now();if(o.onDone){o.onDone();o.onDone=null}}if(s>o.ts+r){u();return}o.timer=setTimeout(function(){u();o.timer=null},r)};r.done=function(e){var t=n[e];if(!t||!t.timer)return Promise.resolve();return new Promise(function(e){var r=t.onDone;t.onDone=function n(){if(r)r();e();t.onDone=null}})};r.clear=function(e){if(e){i(n[e]);delete n[e]}else{for(var t in n)r.clear(t)}};function i(e){if(e&&e.timer!==null){clearTimeout(e.timer);e.timer=null}}},{}],184:[function(e,t,r){"use strict";var n=e("fast-isnumeric");t.exports=function e(t,r){if(t>0)return Math.log(t)/Math.LN10;var i=Math.log(Math.min(r[0],r[1]))/Math.LN10;if(!n(i))i=Math.log(Math.max(r[0],r[1]))/Math.LN10-6;return i}},{"fast-isnumeric":9}],185:[function(e,t,r){"use strict";t.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],186:[function(e,t,r){"use strict";t.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],187:[function(e,t,r){"use strict";var n=e("../registry");t.exports=function e(t){var r=n.layoutArrayContainers,i=n.layoutArrayRegexes,a=t.split("[")[0],o,s;for(var l=0;l<i.length;l++){s=t.match(i[l]);if(s&&s.index===0){o=s[0];break}}if(!o)o=r[r.indexOf(a)];if(!o)return false;var u=t.substr(o.length);if(!u)return{array:o,index:"",property:""};s=u.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/);if(!s)return false;return{array:o,index:Number(s[1]),property:s[3]||""}}},{"../registry":253}],188:[function(e,t,r){"use strict";var n=e("../lib");var i=n.extendFlat;var a=n.isPlainObject;var o={valType:"flaglist",extras:["none"],flags:["calc","calcIfAutorange","clearAxisTypes","plot","style","colorbars"]};var s={valType:"flaglist",extras:["none"],flags:["calc","calcIfAutorange","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw"]};var l=o.flags.slice().concat(["clearCalc","fullReplot"]);var u=s.flags.slice().concat("layoutReplot");t.exports={traces:o,layout:s,traceFlags:function(){return c(l)},layoutFlags:function(){return c(u)},update:function(e,t){var r=t.editType;if(r&&r!=="none"){var n=r.split("+");for(var i=0;i<n.length;i++){e[n[i]]=true}}},overrideAll:f};function c(e){var t={};for(var r=0;r<e.length;r++)t[e[r]]=false;return t}function f(e,t,r){var n=i({},e);for(var o in n){var s=n[o];if(a(s)){n[o]=h(s,t,r,o)}}if(r==="from-root")n.editType=t;return n}function h(e,t,r,n){if(e.valType){var a=i({},e);a.editType=t;if(Array.isArray(e.items)){a.items=new Array(e.items.length);for(var o=0;o<e.items.length;o++){a.items[o]=h(e.items[o],t,"from-root")}}return a}else{return f(e,t,n.charAt(0)==="_"?"nested":"from-root")}}},{"../lib":161}],189:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("gl-mat4/fromQuat");var a=e("../registry");var o=e("../lib");var s=e("../plots/plots");var l=e("../plots/cartesian/axis_ids");var u=l.cleanId;var c=l.getFromTrace;var f=e("../components/color");r.clearPromiseQueue=function(e){if(Array.isArray(e._promises)&&e._promises.length>0){o.log("Clearing previous rejected promises from queue.")}e._promises=[]};r.cleanLayout=function(e){var t,r;if(!e)e={};if(e.xaxis1){if(!e.xaxis)e.xaxis=e.xaxis1;delete e.xaxis1}if(e.yaxis1){if(!e.yaxis)e.yaxis=e.yaxis1;delete e.yaxis1}if(e.scene1){if(!e.scene)e.scene=e.scene1;delete e.scene1}var n=(s.subplotsRegistry.cartesian||{}).attrRegex;var a=(s.subplotsRegistry.gl3d||{}).attrRegex;var l=Object.keys(e);for(t=0;t<l.length;t++){var c=l[t];if(n&&n.test(c)){var p=e[c];if(p.anchor&&p.anchor!=="free"){p.anchor=u(p.anchor)}if(p.overlaying)p.overlaying=u(p.overlaying);if(!p.type){if(p.isdate)p.type="date";else if(p.islog)p.type="log";else if(p.isdate===false&&p.islog===false)p.type="linear"}if(p.autorange==="withzero"||p.autorange==="tozero"){p.autorange=true;p.rangemode="tozero"}delete p.islog;delete p.isdate;delete p.categories;if(m(p,"domain"))delete p.domain;if(p.autotick!==undefined){if(p.tickmode===undefined){p.tickmode=p.autotick?"auto":"linear"}delete p.autotick}}else if(a&&a.test(c)){var d=e[c];var v=d.cameraposition;if(Array.isArray(v)&&v[0].length===4){var g=v[0],y=v[1],_=v[2],x=i([],g),b=[];for(r=0;r<3;++r){b[r]=y[r]+_*x[2+4*r]}d.camera={eye:{x:b[0],y:b[1],z:b[2]},center:{x:y[0],y:y[1],z:y[2]},up:{x:x[1],y:x[5],z:x[9]}};delete d.cameraposition}}}var w=Array.isArray(e.annotations)?e.annotations.length:0;for(t=0;t<w;t++){var k=e.annotations[t];if(!o.isPlainObject(k))continue;if(k.ref){if(k.ref==="paper"){k.xref="paper";k.yref="paper"}else if(k.ref==="data"){k.xref="x";k.yref="y"}delete k.ref}h(k,"xref");h(k,"yref")}var A=Array.isArray(e.shapes)?e.shapes.length:0;for(t=0;t<A;t++){var T=e.shapes[t];if(!o.isPlainObject(T))continue;h(T,"xref");h(T,"yref")}var M=e.legend;if(M){if(M.x>3){M.x=1.02;M.xanchor="left"}else if(M.x<-2){M.x=-.02;M.xanchor="right"}if(M.y>3){M.y=1.02;M.yanchor="bottom"}else if(M.y<-2){M.y=-.02;M.yanchor="top"}}if(e.dragmode==="rotate")e.dragmode="orbit";f.clean(e);return e};function h(e,t){var r=e[t],n=t.charAt(0);if(r&&r!=="paper"){e[t]=u(r,n)}}r.cleanData=function(e){for(var t=0;t<e.length;t++){var n=e[t];var i;if(n.type==="histogramy"&&"xbins"in n&&!("ybins"in n)){n.ybins=n.xbins;delete n.xbins}if(n.error_y&&"opacity"in n.error_y){var l=f.defaults,c=n.error_y.color||(a.traceIs(n,"bar")?f.defaultLine:l[t%l.length]);n.error_y.color=f.addOpacity(f.rgb(c),f.opacity(c)*n.error_y.opacity);delete n.error_y.opacity}if("bardir"in n){if(n.bardir==="h"&&(a.traceIs(n,"bar")||n.type.substr(0,9)==="histogram")){n.orientation="h";r.swapXYData(n)}delete n.bardir}if(n.type==="histogramy")r.swapXYData(n);if(n.type==="histogramx"||n.type==="histogramy"){n.type="histogram"}if("scl"in n){n.colorscale=n.scl;delete n.scl}if("reversescl"in n){n.reversescale=n.reversescl;delete n.reversescl}if(n.xaxis)n.xaxis=u(n.xaxis,"x");if(n.yaxis)n.yaxis=u(n.yaxis,"y");if(a.traceIs(n,"gl3d")&&n.scene){n.scene=s.subplotsRegistry.gl3d.cleanId(n.scene)}if(!a.traceIs(n,"pie")&&!a.traceIs(n,"bar")){if(Array.isArray(n.textposition)){for(i=0;i<n.textposition.length;i++){n.textposition[i]=v(n.textposition[i])}}else if(n.textposition){n.textposition=v(n.textposition)}}var h=a.getModule(n);if(h&&h.colorbar){var g=h.colorbar.container;var y=g?n[g]:n;if(y&&y.colorscale){if(y.colorscale==="YIGnBu")y.colorscale="YlGnBu";if(y.colorscale==="YIOrRd")y.colorscale="YlOrRd"}}if(n.type==="surface"&&o.isPlainObject(n.contours)){var _=["x","y","z"];for(i=0;i<_.length;i++){var x=n.contours[_[i]];if(!o.isPlainObject(x))continue;if(x.highlightColor){x.highlightcolor=x.highlightColor;delete x.highlightColor}if(x.highlightWidth){x.highlightwidth=x.highlightWidth;delete x.highlightWidth}}}if(n.type==="candlestick"||n.type==="ohlc"){var b=(n.increasing||{}).showlegend!==false;var w=(n.decreasing||{}).showlegend!==false;var k=p(n.increasing);var A=p(n.decreasing);if(k!==false&&A!==false){var T=d(k,A,b,w);if(T)n.name=T}else if((k||A)&&!n.name){n.name=k||A}}if(Array.isArray(n.transforms)){var M=n.transforms;for(i=0;i<M.length;i++){var S=M[i];if(!o.isPlainObject(S))continue;switch(S.type){case"filter":if(S.filtersrc){S.target=S.filtersrc;delete S.filtersrc}if(S.calendar){if(!S.valuecalendar){S.valuecalendar=S.calendar}delete S.calendar}break;case"groupby":S.styles=S.styles||S.style;if(S.styles&&!Array.isArray(S.styles)){var C=S.styles;var z=Object.keys(C);S.styles=[];for(var E=0;E<z.length;E++){S.styles.push({target:z[E],value:C[z[E]]})}}break}}}if(m(n,"line"))delete n.line;if("marker"in n){if(m(n.marker,"line"))delete n.marker.line;if(m(n,"marker"))delete n.marker}f.clean(n)}};function p(e){if(!o.isPlainObject(e))return false;var t=e.name;delete e.name;delete e.showlegend;return(typeof t==="string"||typeof t==="number")&&String(t)}function d(e,t,r,n){if(r&&!n)return e;if(n&&!r)return t;if(!e.trim())return t;if(!t.trim())return e;var i=Math.min(e.length,t.length);var a;for(a=0;a<i;a++){if(e.charAt(a)!==t.charAt(a))break}var o=e.substr(0,a);return o.trim()}function v(e){var t="middle",r="center";if(e.indexOf("top")!==-1)t="top";else if(e.indexOf("bottom")!==-1)t="bottom";if(e.indexOf("left")!==-1)r="left";else if(e.indexOf("right")!==-1)r="right";return t+" "+r}function m(e,t){return t in e&&typeof e[t]==="object"&&Object.keys(e[t]).length===0}r.swapXYData=function(e){var t;o.swapAttrs(e,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]);if(Array.isArray(e.z)&&Array.isArray(e.z[0])){if(e.transpose)delete e.transpose;else e.transpose=true}if(e.error_x&&e.error_y){var r=e.error_y,n="copy_ystyle"in r?r.copy_ystyle:!(r.color||r.thickness||r.width);o.swapAttrs(e,["error_?.copy_ystyle"]);if(n){o.swapAttrs(e,["error_?.color","error_?.thickness","error_?.width"])}}if(typeof e.hoverinfo==="string"){var i=e.hoverinfo.split("+");for(t=0;t<i.length;t++){if(i[t]==="x")i[t]="y";else if(i[t]==="y")i[t]="x"}e.hoverinfo=i.join("+")}};r.coerceTraceIndices=function(e,t){if(n(t)){return[t]}else if(!Array.isArray(t)||!t.length){return e.data.map(function(e,t){return t})}return t};r.manageArrayContainers=function(e,t,r){var i=e.obj,a=e.parts,s=a.length,l=a[s-1];var u=n(l);if(u&&t===null){var c=a.slice(0,s-1).join("."),f=o.nestedProperty(i,c).get();f.splice(l,1)}else if(u&&e.get()===undefined){if(e.get()===undefined)r[e.astr]=null;e.set(t)}else{e.set(t)}};var g=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function y(e){var t=e.search(g);if(t>0)return e.substr(0,t)}r.hasParent=function(e,t){var r=y(t);while(r){if(r in e)return true;r=y(r)}return false};var _=["x","y","z"];r.clearAxisTypes=function(e,t,r){for(var n=0;n<t.length;n++){var i=e._fullData[n];for(var a=0;a<3;a++){var s=c(e,i,_[a]);if(s&&s.type!=="log"){var l=s._name;var u=s._id.substr(1);if(u.substr(0,5)==="scene"){if(r[u]!==undefined)continue;l=u+"."+l}var f=l+".type";if(r[l]===undefined&&r[f]===undefined){o.nestedProperty(e.layout,f).set(null)}}}}}},{"../components/color":42,"../lib":161,"../plots/cartesian/axis_ids":208,"../plots/plots":244,"../registry":253,"fast-isnumeric":9,"gl-mat4/fromQuat":10}],190:[function(e,t,r){"use strict";var n=e("./plot_api");r.plot=n.plot;r.newPlot=n.newPlot;r.restyle=n.restyle;r.relayout=n.relayout;r.redraw=n.redraw;r.update=n.update;r.react=n.react;r.extendTraces=n.extendTraces;r.prependTraces=n.prependTraces;r.addTraces=n.addTraces;r.deleteTraces=n.deleteTraces;r.moveTraces=n.moveTraces;r.purge=n.purge;r.addFrames=n.addFrames;r.deleteFrames=n.deleteFrames;r.animate=n.animate;r.setPlotConfig=n.setPlotConfig;r.toImage=e("./to_image");r.validate=e("./validate");r.downloadImage=e("../snapshot/download");var i=e("./template_api");r.makeTemplate=i.makeTemplate;r.validateTemplate=i.validateTemplate},{"../snapshot/download":255,"./plot_api":192,"./template_api":197,"./to_image":198,"./validate":199}],191:[function(e,t,r){"use strict";var n=e("../lib/nested_property");var i=e("../lib/is_plain_object");var a=e("../lib/noop");var o=e("../lib/loggers");var s=e("../lib/search").sorterAsc;var l=e("../registry");r.containerArrayMatch=e("./container_array_match");var u=r.isAddVal=function e(t){return t==="add"||i(t)};var c=r.isRemoveVal=function e(t){return t===null||t==="remove"};r.applyContainerArrayChanges=function e(t,r,i,f){var h=r.astr,p=l.getComponentMethod(h,"supplyLayoutDefaults"),d=l.getComponentMethod(h,"draw"),v=l.getComponentMethod(h,"drawOne"),m=f.replot||f.recalc||p===a||d===a,g=t.layout,y=t._fullLayout;if(i[""]){if(Object.keys(i).length>1){o.warn("Full array edits are incompatible with other edits",h)}var _=i[""][""];if(c(_))r.set(null);else if(Array.isArray(_))r.set(_);else{o.warn("Unrecognized full array edit value",h,_);return true}if(m)return false;p(g,y);d(t);return true}var x=Object.keys(i).map(Number).sort(s),b=r.get(),w=b||[],k=n(y,h).get();var A=[],T=-1,M=w.length,S,C,z,E,L,I,P;for(S=0;S<x.length;S++){z=x[S];E=i[z];L=Object.keys(E);I=E[""],P=u(I);if(z<0||z>w.length-(P?0:1)){o.warn("index out of range",h,z);continue}if(I!==undefined){if(L.length>1){o.warn("Insertion & removal are incompatible with edits to the same index.",h,z)}if(c(I)){A.push(z)}else if(P){if(I==="add")I={};w.splice(z,0,I);if(k)k.splice(z,0,{})}else{o.warn("Unrecognized full object edit value",h,z,I)}if(T===-1)T=z}else{for(C=0;C<L.length;C++){n(w[z],L[C]).set(E[L[C]])}}}for(S=A.length-1;S>=0;S--){w.splice(A[S],1);if(k)k.splice(A[S],1)}if(!w.length)r.set(null);else if(!b)r.set(w);if(m)return false;p(g,y);if(v!==a){var D;if(T===-1){D=x}else{M=Math.max(w.length,M);D=[];for(S=0;S<x.length;S++){z=x[S];if(z>=T)break;D.push(z)}for(S=T;S<M;S++){D.push(S)}}for(S=0;S<D.length;S++){v(t,D[S])}}else d(t);return true}},{"../lib/is_plain_object":163,"../lib/loggers":166,"../lib/nested_property":169,"../lib/noop":170,"../lib/search":179,"../registry":253,"./container_array_match":187}],192:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("has-hover");var o=e("../lib");var s=e("../lib/events");var l=e("../lib/queue");var u=e("../registry");var c=e("./plot_schema");var f=e("../plots/plots");var h=e("../plots/polar/legacy");var p=e("../plots/cartesian/axes");var d=e("../components/drawing");var v=e("../components/color");var m=e("../components/colorbar/connect");var g=e("../plots/cartesian/graph_interact").initInteractions;var y=e("../constants/xmlns_namespaces");var _=e("../lib/svg_text_utils");var x=e("./plot_config");var b=e("./manage_arrays");var w=e("./helpers");var k=e("./subroutines");var A=e("./edit_types");var T=e("../plots/cartesian/constants").AX_NAME_PATTERN;var M=0;var S=5;r.plot=function(e,t,i,a){var l;e=o.getGraphDiv(e);s.init(e);if(o.isPlainObject(t)){var c=t;t=c.data;i=c.layout;a=c.config;l=c.frames}var h=s.triggerHandler(e,"plotly_beforeplot",[t,i,a]);if(h===false)return Promise.reject();if(!t&&!i&&!o.isPlotDiv(e)){o.warn("Calling Plotly.plot as if redrawing "+"but this container doesn't yet have a plot.",e)}function v(){if(l){return r.addFrames(e,l)}}L(e,a);if(!i)i={};n.select(e).classed("js-plotly-plot",true);d.makeTester();delete d.baseUrl;if(!Array.isArray(e._promises))e._promises=[];var y=(e.data||[]).length===0&&Array.isArray(t);if(Array.isArray(t)){w.cleanData(t);if(y)e.data=t;else e.data.push.apply(e.data,t);e.empty=false}if(!e.layout||y)e.layout=w.cleanLayout(i);if(e._dragging&&!e._transitioning){e._replotPending=true;return Promise.reject()}else{e._replotPending=false}f.supplyDefaults(e);var _=e._fullLayout;var x=_._has("cartesian");if(!_._has("polar")&&t&&t[0]&&t[0].r){o.log("Legacy polar charts are deprecated!");return I(e,t,i)}_._replotting=true;if(y)ee(e);if(e.framework!==ee){e.framework=ee;ee(e)}d.initGradients(e);if(y)p.saveShowSpikeInitial(e);var b=!e.calcdata||e.calcdata.length!==(e._fullData||[]).length;if(b)f.doCalcdata(e);for(var A=0;A<e.calcdata.length;A++){e.calcdata[A][0].trace=e._fullData[A]}var T=JSON.stringify(_._size);function M(){var t=_._basePlotModules;for(var r=0;r<t.length;r++){if(t[r].drawFramework){t[r].drawFramework(e)}}if(!_._glcanvas&&_._has("gl")){_._glcanvas=_._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:true,pick:false},{key:"focusLayer",context:false,pick:false},{key:"pickLayer",context:false,pick:true}],function(e){return e.key});_._glcanvas.enter().append("canvas").attr("class",function(e){return"gl-canvas gl-canvas-"+e.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"visible","pointer-events":"none"})}if(_._glcanvas){_._glcanvas.attr("width",_.width).attr("height",_.height)}return f.previousPromises(e)}function S(){var t=e.calcdata;var r,n,i;f.clearAutoMarginIds(e);k.drawMarginPushers(e);p.allowAutoMargin(e);for(r=0;r<t.length;r++){n=t[r];i=n[0].trace;var a=i._module.colorbar;if(i.visible!==true||!a){f.autoMargin(e,"cb"+i.uid)}else m(e,n,a)}f.doAutoMargin(e);return f.previousPromises(e)}function z(){if(JSON.stringify(_._size)===T)return;return o.syncOrAsync([S,k.layoutStyles],e)}function E(){if(!b){P();return}var t=_._subplots.cartesian;var r=_._modules;var n=[];var i,a,s;for(s=0;s<r.length;s++){o.pushUnique(n,r[s].setPositions)}if(n.length){for(a=0;a<t.length;a++){i=_._plots[t[a]];for(s=0;s<n.length;s++){n[s](e,i)}}}u.getComponentMethod("errorbars","calc")(e);return o.syncOrAsync([u.getComponentMethod("shapes","calcAutorange"),u.getComponentMethod("annotations","calcAutorange"),P,u.getComponentMethod("rangeslider","calcAutorange")],e)}function P(){if(e._transitioning)return;k.doAutoRangeAndConstraints(e);if(y)p.saveRangeInitial(e)}function D(){return p.doTicks(e,y?"":"redraw")}var O=[f.previousPromises,v,M,S,z];if(x)O.push(E);O.push(k.layoutStyles);if(x)O.push(D);O.push(k.drawData,k.finalDraw,g,f.addLinks,f.rehover,f.doAutoMargin,f.previousPromises);var R=o.syncOrAsync(O,e);if(!R||!R.then)R=Promise.resolve();return R.then(function(){C(e);return e})};function C(e){var t=e._fullLayout;if(t._redrawFromAutoMarginCount){t._redrawFromAutoMarginCount--}else{e.emit("plotly_afterplot")}}r.setPlotConfig=function e(t){return o.extendFlat(x,t)};function z(e,t){try{e._fullLayout._paper.style("background",t)}catch(e){o.error(e)}}function E(e,t){var r=v.combine(t,"white");z(e,r)}function L(e,t){if(!e._context)e._context=o.extendDeep({},x);var r=e._context;var n,i,s;if(t){i=Object.keys(t);for(n=0;n<i.length;n++){s=i[n];if(s==="editable"||s==="edits")continue;if(s in r){if(s==="setBackground"&&t[s]==="opaque"){r[s]=E}else{r[s]=t[s]}}}if(t.plot3dPixelRatio&&!r.plotGlPixelRatio){r.plotGlPixelRatio=r.plot3dPixelRatio}var l=t.editable;if(l!==undefined){r.editable=l;i=Object.keys(r.edits);for(n=0;n<i.length;n++){r.edits[i[n]]=l}}if(t.edits){i=Object.keys(t.edits);for(n=0;n<i.length;n++){s=i[n];if(s in r.edits){r.edits[s]=t.edits[s]}}}}if(r.staticPlot){r.editable=false;r.edits={};r.autosizable=false;r.scrollZoom=false;r.doubleClick=false;r.showTips=false;r.showLink=false;r.displayModeBar=false}if(r.displayModeBar==="hover"&&!a){r.displayModeBar=true}if(r.setBackground==="transparent"||typeof r.setBackground!=="function"){r.setBackground=z}}function I(e,t,r){var i=n.select(e).selectAll(".plot-container").data([0]);i.enter().insert("div",":first-child").classed("plot-container plotly",true);var a=i.selectAll(".svg-container").data([0]);a.enter().append("div").classed("svg-container",true).style("position","relative");a.html("");if(t)e.data=t;if(r)e.layout=r;h.manager.fillLayout(e);a.style({width:e._fullLayout.width+"px",height:e._fullLayout.height+"px"});e.framework=h.manager.framework(e);e.framework({data:e.data,layout:e.layout},a.node());e.framework.setUndoPoint();var s=e.framework.svg();var l=1;var u=e._fullLayout.title;if(u===""||!u)l=0;var c=function(){this.call(_.convertToTspans,e)};var p=s.select(".title-group text").call(c);if(e._context.edits.titleText){var d=o._(e,"Click to enter Plot title");if(!u||u===d){l=.2;p.attr({"data-unformatted":d}).text(d).style({opacity:l}).on("mouseover.opacity",function(){n.select(this).transition().duration(100).style("opacity",1)}).on("mouseout.opacity",function(){n.select(this).transition().duration(1e3).style("opacity",0)})}var v=function(){this.call(_.makeEditable,{gd:e}).on("edit",function(t){e.framework({layout:{title:t}});this.text(t).call(c);this.call(v)}).on("cancel",function(){var e=this.attr("data-unformatted");this.text(e).call(c)})};p.call(v)}e._context.setBackground(e,e._fullLayout.paper_bgcolor);f.addLinks(e);return Promise.resolve()}r.redraw=function(e){e=o.getGraphDiv(e);if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e)}w.cleanData(e.data);w.cleanLayout(e.layout);e.calcdata=undefined;return r.plot(e).then(function(){e.emit("plotly_redraw");return e})};r.newPlot=function(e,t,n,i){e=o.getGraphDiv(e);f.cleanPlot([],{},e._fullData||[],e._fullLayout||{},e.calcdata||[]);f.purge(e);return r.plot(e,t,n,i)};function P(e,t){var r=t+1,n=[],i,a;for(i=0;i<e.length;i++){a=e[i];if(a<0){n.push(r+a)}else{n.push(a)}}return n}function D(e,t,r){var n,i;for(n=0;n<t.length;n++){i=t[n];if(i!==parseInt(i,10)){throw new Error("all values in "+r+" must be integers")}if(i>=e.data.length||i<-e.data.length){throw new Error(r+" must be valid indices for gd.data.")}if(t.indexOf(i,n+1)>-1||i>=0&&t.indexOf(-e.data.length+i)>-1||i<0&&t.indexOf(e.data.length+i)>-1){throw new Error("each index in "+r+" must be unique.")}}}function O(e,t,r){if(!Array.isArray(e.data)){throw new Error("gd.data must be an array.")}if(typeof t==="undefined"){throw new Error("currentIndices is a required argument.")}else if(!Array.isArray(t)){t=[t]}D(e,t,"currentIndices");if(typeof r!=="undefined"&&!Array.isArray(r)){r=[r]}if(typeof r!=="undefined"){D(e,r,"newIndices")}if(typeof r!=="undefined"&&t.length!==r.length){throw new Error("current and new indices must be of equal length.")}}function R(e,t,r){var n,i;if(!Array.isArray(e.data)){throw new Error("gd.data must be an array.")}if(typeof t==="undefined"){throw new Error("traces must be defined.")}if(!Array.isArray(t)){t=[t]}for(n=0;n<t.length;n++){i=t[n];if(typeof i!=="object"||(Array.isArray(i)||i===null)){throw new Error("all values in traces array must be non-array objects")}}if(typeof r!=="undefined"&&!Array.isArray(r)){r=[r]}if(typeof r!=="undefined"&&r.length!==t.length){throw new Error("if indices is specified, traces.length must equal indices.length")}}function F(e,t,r,n){var i=o.isPlainObject(n);if(!Array.isArray(e.data)){throw new Error("gd.data must be an array")}if(!o.isPlainObject(t)){throw new Error("update must be a key:value object")}if(typeof r==="undefined"){throw new Error("indices must be an integer or array of integers")}D(e,r,"indices");for(var a in t){if(!Array.isArray(t[a])||t[a].length!==r.length){throw new Error("attribute "+a+" must be an array of length equal to indices array length")}if(i&&(!(a in n)||!Array.isArray(n[a])||n[a].length!==t[a].length)){throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 "+"corrispondence with the keys and number of traces in the update object")}}}function B(e,t,r,n){var a=o.isPlainObject(n),s=[];var l,u,c,f,h;if(!Array.isArray(r))r=[r];r=P(r,e.data.length-1);for(var p in t){for(var d=0;d<r.length;d++){l=e.data[r[d]];c=o.nestedProperty(l,p);u=c.get();f=t[p][d];if(!o.isArrayOrTypedArray(f)){throw new Error("attribute: "+p+" index: "+d+" must be an array")}if(!o.isArrayOrTypedArray(u)){throw new Error("cannot extend missing or non-array attribute: "+p)}if(u.constructor!==f.constructor){throw new Error("cannot extend array with an array of a different type: "+p)}h=a?n[p][d]:n;if(!i(h))h=-1;s.push({prop:c,target:u,insert:f,maxp:Math.floor(h)})}}return s}function N(e,t,r,n,i){F(e,t,r,n);var a=B(e,t,r,n);var o={};var s={};for(var l=0;l<a.length;l++){var u=a[l].prop;var c=a[l].maxp;var f=i(a[l].target,a[l].insert,c);u.set(f[0]);if(!Array.isArray(o[u.astr]))o[u.astr]=[];o[u.astr].push(f[1]);if(!Array.isArray(s[u.astr]))s[u.astr]=[];s[u.astr].push(a[l].target.length)}return{update:o,maxPoints:s}}function j(e,t){var r=new e.constructor(e.length+t.length);r.set(e);r.set(t,e.length);return r}r.extendTraces=function e(t,n,i,a){t=o.getGraphDiv(t);function s(e,t,r){var n,i;if(o.isTypedArray(e)){if(r<0){var a=new e.constructor(0);var s=j(e,t);if(r<0){n=s;i=a}else{n=a;i=s}}else{n=new e.constructor(r);i=new e.constructor(e.length+t.length-r);if(r===t.length){n.set(t);i.set(e)}else if(r<t.length){var l=t.length-r;n.set(t.subarray(l));i.set(e);i.set(t.subarray(0,l),e.length)}else{var u=r-t.length;var c=e.length-u;n.set(e.subarray(c));n.set(t,u);i.set(e.subarray(0,c))}}}else{n=e.concat(t);i=r>=0&&r<n.length?n.splice(0,n.length-r):[]}return[n,i]}var u=N(t,n,i,a,s);var c=r.redraw(t);var f=[t,u.update,i,u.maxPoints];l.add(t,r.prependTraces,f,e,arguments);return c};r.prependTraces=function e(t,n,i,a){t=o.getGraphDiv(t);function s(e,t,r){var n,i;if(o.isTypedArray(e)){if(r<=0){var a=new e.constructor(0);var s=j(t,e);if(r<0){n=s;i=a}else{n=a;i=s}}else{n=new e.constructor(r);i=new e.constructor(e.length+t.length-r);if(r===t.length){n.set(t);i.set(e)}else if(r<t.length){var l=t.length-r;n.set(t.subarray(0,l));i.set(t.subarray(l));i.set(e,l)}else{var u=r-t.length;n.set(t);n.set(e.subarray(0,u),t.length);i.set(e.subarray(u))}}}else{n=t.concat(e);i=r>=0&&r<n.length?n.splice(r,n.length):[]}return[n,i]}var u=N(t,n,i,a,s);var c=r.redraw(t);var f=[t,u.update,i,u.maxPoints];l.add(t,r.extendTraces,f,e,arguments);return c};r.addTraces=function e(t,n,i){t=o.getGraphDiv(t);var a=[],s=r.deleteTraces,u=e,c=[t,a],f=[t,n],h,p;R(t,n,i);if(!Array.isArray(n)){n=[n]}n=n.map(function(e){return o.extendFlat({},e)});w.cleanData(n);for(h=0;h<n.length;h++){t.data.push(n[h])}for(h=0;h<n.length;h++){a.push(-n.length+h)}if(typeof i==="undefined"){p=r.redraw(t);l.add(t,s,c,u,f);return p}if(!Array.isArray(i)){i=[i]}try{O(t,a,i)}catch(e){t.data.splice(t.data.length-n.length,n.length);throw e}l.startSequence(t);l.add(t,s,c,u,f);p=r.moveTraces(t,a,i);l.stopSequence(t);return p};r.deleteTraces=function e(t,n){t=o.getGraphDiv(t);var i=[],a=r.addTraces,s=e,u=[t,i,n],c=[t,n],f,h;if(typeof n==="undefined"){throw new Error("indices must be an integer or array of integers.")}else if(!Array.isArray(n)){n=[n]}D(t,n,"indices");n=P(n,t.data.length-1);n.sort(o.sorterDes);for(f=0;f<n.length;f+=1){h=t.data.splice(n[f],1)[0];i.push(h)}var p=r.redraw(t);l.add(t,a,u,s,c);return p};r.moveTraces=function e(t,n,i){t=o.getGraphDiv(t);var a=[],s=[],u=e,c=e,f=[t,i,n],h=[t,n,i],p;O(t,n,i);n=Array.isArray(n)?n:[n];if(typeof i==="undefined"){i=[];for(p=0;p<n.length;p++){i.push(-n.length+p)}}i=Array.isArray(i)?i:[i];n=P(n,t.data.length-1);i=P(i,t.data.length-1);for(p=0;p<t.data.length;p++){if(n.indexOf(p)===-1){a.push(t.data[p])}}for(p=0;p<n.length;p++){s.push({newIndex:i[p],trace:t.data[n[p]]})}s.sort(function(e,t){return e.newIndex-t.newIndex});for(p=0;p<s.length;p+=1){a.splice(s[p].newIndex,0,s[p].trace)}t.data=a;var d=r.redraw(t);l.add(t,u,f,c,h);return d};r.restyle=function e(t,n,i,a){t=o.getGraphDiv(t);w.clearPromiseQueue(t);var s={};if(typeof n==="string")s[n]=i;else if(o.isPlainObject(n)){s=o.extendFlat({},n);if(a===undefined)a=i}else{o.warn("Restyle fail.",n,i,a);return Promise.reject()}if(Object.keys(s).length)t.changed=true;var u=w.coerceTraceIndices(t,a);var c=q(t,s,u);var h=c.flags;if(h.clearCalc)t.calcdata=undefined;if(h.clearAxisTypes)w.clearAxisTypes(t,u,{});var p=[];if(h.fullReplot){p.push(r.plot)}else{p.push(f.previousPromises);f.supplyDefaults(t);if(h.style)p.push(k.doTraceStyle);if(h.colorbars)p.push(k.doColorBars);p.push(C)}p.push(f.rehover);l.add(t,e,[t,c.undoit,c.traces],e,[t,c.redoit,c.traces]);var d=o.syncOrAsync(p,t);if(!d||!d.then)d=Promise.resolve();return d.then(function(){t.emit("plotly_restyle",c.eventData);return t})};function V(e){if(e===undefined)return null;return e}function q(e,t,r){var n=e._fullLayout,i=e._fullData,a=e.data,s;var l=A.traceFlags();var h={},d={},v;function m(){return r.map(function(){return undefined})}function g(e){var t=p.id2name(e);if(v.indexOf(t)===-1)v.push(t)}function y(e){return"LAYOUT"+e+".autorange"}function _(e){return"LAYOUT"+e+".range"}function x(n,i,s){if(Array.isArray(n)){n.forEach(function(e){x(e,i,s)});return}if(n in t||w.hasParent(t,n))return;var l;if(n.substr(0,6)==="LAYOUT"){l=o.nestedProperty(e.layout,n.replace("LAYOUT",""))}else{l=o.nestedProperty(a[r[s]],n)}if(!(n in d)){d[n]=m()}if(d[n][s]===undefined){d[n][s]=V(l.get())}if(i!==undefined){l.set(i)}}for(var b in t){if(w.hasParent(t,b)){throw new Error("cannot set "+b+"and a parent attribute simultaneously")}var k=t[b],T,M,S,C,z,E;h[b]=k;if(b.substr(0,6)==="LAYOUT"){S=o.nestedProperty(e.layout,b.replace("LAYOUT",""));d[b]=[V(S.get())];S.set(Array.isArray(k)?k[0]:k);l.calc=true;continue}d[b]=m();for(s=0;s<r.length;s++){T=a[r[s]];M=i[r[s]];S=o.nestedProperty(T,b);C=S.get();z=Array.isArray(k)?k[s%k.length]:k;if(z===undefined)continue;var L=S.parts[S.parts.length-1];var I=b.substr(0,b.length-L.length-1);var P=I?I+".":"";var D=I?o.nestedProperty(M,I).get():M;E=c.getTraceValObject(M,S.parts);if(E&&E.impliedEdits&&z!==null){for(var O in E.impliedEdits){x(o.relativeAttr(b,O),E.impliedEdits[O],s)}}else if((L==="thicknessmode"||L==="lenmode")&&C!==z&&(z==="fraction"||z==="pixels")&&D){var R=n._size;var F=D.orient;var B=F==="top"||F==="bottom";if(L==="thicknessmode"){var N=B?R.h:R.w;x(P+"thickness",D.thickness*(z==="fraction"?1/N:N),s)}else{var j=B?R.w:R.h;x(P+"len",D.len*(z==="fraction"?1/j:j),s)}}else if(b==="type"&&z==="pie"!==(C==="pie")){var q="x",U="y";if((z==="bar"||C==="bar")&&T.orientation==="h"){q="y";U="x"}o.swapAttrs(T,["?","?src"],"labels",q);o.swapAttrs(T,["d?","?0"],"label",q);o.swapAttrs(T,["?","?src"],"values",U);if(C==="pie"){o.nestedProperty(T,"marker.color").set(o.nestedProperty(T,"marker.colors").get());n._pielayer.selectAll("g.trace").remove()}else if(u.traceIs(T,"cartesian")){o.nestedProperty(T,"marker.colors").set(o.nestedProperty(T,"marker.color").get())}}d[b][s]=V(C);var Z=["swapxy","swapxyaxes","orientation","orientationaxes"];if(Z.indexOf(b)!==-1){if(b==="orientation"){S.set(z);var H=T.x&&!T.y?"h":"v";if((S.get()||H)===M.orientation){continue}}else if(b==="orientationaxes"){T.orientation={v:"h",h:"v"}[M.orientation]}w.swapXYData(T);l.calc=l.clearAxisTypes=true}else if(f.dataArrayContainers.indexOf(S.parts[0])!==-1){w.manageArrayContainers(S,z,d);l.calc=true}else{if(E){if(E.arrayOk&&(o.isArrayOrTypedArray(z)||o.isArrayOrTypedArray(C))){l.calc=true}else A.update(l,E)}else{l.calc=true}S.set(z)}}if(["swapxyaxes","orientationaxes"].indexOf(b)!==-1){p.swap(e,r)}if(b==="orientationaxes"){var G=o.nestedProperty(e.layout,"hovermode");if(G.get()==="x"){G.set("y")}else if(G.get()==="y"){G.set("x")}}if(["orientation","type"].indexOf(b)!==-1){v=[];for(s=0;s<r.length;s++){var $=a[r[s]];if(u.traceIs($,"cartesian")){g($.xaxis||"x");g($.yaxis||"y");if(b==="type"){x(["autobinx","autobiny"],true,s)}}}x(v.map(y),true,0);x(v.map(_),[0,1],0)}}var W=false;var X=p.list(e);for(s=0;s<X.length;s++){if(X[s].autorange){W=true;break}}if(l.calc||l.calcIfAutorange&&W){l.clearCalc=true}if(l.calc||l.plot||l.calcIfAutorange){l.fullReplot=true}return{flags:l,undoit:d,redoit:h,traces:r,eventData:o.extendDeepNoArrays([],[h,r])}}r.relayout=function e(t,r,n){t=o.getGraphDiv(t);w.clearPromiseQueue(t);if(t.framework&&t.framework.isPolar){return Promise.resolve(t)}var i={};if(typeof r==="string"){i[r]=n}else if(o.isPlainObject(r)){i=o.extendFlat({},r)}else{o.warn("Relayout fail.",r,n);return Promise.reject()}if(Object.keys(i).length)t.changed=true;var a=$(t,i);var s=a.flags;if(s.calc)t.calcdata=undefined;var u=[f.previousPromises];if(s.layoutReplot){u.push(k.layoutReplot)}else if(Object.keys(i).length){f.supplyDefaults(t);if(s.legend)u.push(k.doLegend);if(s.layoutstyle)u.push(k.layoutStyles);if(s.axrange){U(u,a.rangesAltered)}if(s.ticks)u.push(k.doTicksRelayout);if(s.modebar)u.push(k.doModeBar);if(s.camera)u.push(k.doCamera);u.push(C)}u.push(f.rehover);l.add(t,e,[t,a.undoit],e,[t,a.redoit]);var c=o.syncOrAsync(u,t);if(!c||!c.then)c=Promise.resolve(t);return c.then(function(){t.emit("plotly_relayout",a.eventData);return t})};function U(e,t){var r=t?function(e){return k.doTicksRelayout(e,t)}:k.doTicksRelayout;e.push(r,k.drawData,k.finalDraw)}var Z=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/;var H=/^[xyz]axis[0-9]*\.autorange$/;var G=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function $(e,t){var r=e.layout,n=e._fullLayout,i=Object.keys(t),a=p.list(e),s={},l,f,h;for(f=0;f<i.length;f++){if(i[f].indexOf("allaxes")===0){for(h=0;h<a.length;h++){var d=a[h]._id.substr(1),v=d.indexOf("scene")!==-1?d+".":"",m=i[f].replace("allaxes",v+a[h]._name);if(!t[m])t[m]=t[i[f]]}delete t[i[f]]}}var g=A.layoutFlags();var y={},_={};function x(e,n){if(Array.isArray(e)){e.forEach(function(e){x(e,n)});return}if(e in t||w.hasParent(t,e))return;var i=o.nestedProperty(r,e);if(!(e in _)){_[e]=V(i.get())}if(n!==undefined)i.set(n)}var k={};var M;function S(e){var t=p.name2id(e.split(".")[0]);k[t]=1;return t}for(var C in t){if(w.hasParent(t,C)){throw new Error("cannot set "+C+"and a parent attribute simultaneously")}var z=o.nestedProperty(r,C);var E=t[C];var L=z.parts.length;var I=L-1;while(I>0&&typeof z.parts[I]!=="string")I--;var P=z.parts[I];var D=z.parts[I-1]+"."+P;var O=z.parts.slice(0,I).join(".");var R=o.nestedProperty(e.layout,O).get();var F=o.nestedProperty(n,O).get();var B=z.get();if(E===undefined)continue;y[C]=E;_[C]=P==="reverse"?E:V(B);var N=c.getLayoutValObject(n,z.parts);if(N&&N.impliedEdits&&E!==null){for(var j in N.impliedEdits){x(o.relativeAttr(C,j),N.impliedEdits[j])}}if(["width","height"].indexOf(C)!==-1&&E===null){n[C]=e._initialAutoSize[C]}else if(D.match(Z)){S(D);o.nestedProperty(n,O+"._inputRange").set(null)}else if(D.match(H)){S(D);o.nestedProperty(n,O+"._inputRange").set(null);var q=o.nestedProperty(n,O).get();if(q._inputDomain){q._input.domain=q._inputDomain.slice()}}else if(D.match(G)){o.nestedProperty(n,O+"._inputDomain").set(null)}if(P==="type"){var U=R,$=F.type==="linear"&&E==="log",Y=F.type==="log"&&E==="linear";if($||Y){if(!U||!U.range){x(O+".autorange",true)}else if(!F.autorange){var J=U.range[0],K=U.range[1];if($){if(J<=0&&K<=0){x(O+".autorange",true)}if(J<=0)J=K/1e6;else if(K<=0)K=J/1e6;x(O+".range[0]",Math.log(J)/Math.LN10);x(O+".range[1]",Math.log(K)/Math.LN10)}else{x(O+".range[0]",Math.pow(10,J));x(O+".range[1]",Math.pow(10,K))}}else if($){U.range=U.range[1]>U.range[0]?[1,2]:[2,1]}if(Array.isArray(n._subplots.polar)&&n._subplots.polar.length&&n[z.parts[0]]&&z.parts[1]==="radialaxis"){delete n[z.parts[0]]._subplot.viewInitial["radialaxis.range"]}u.getComponentMethod("annotations","convertCoords")(e,F,E,x);u.getComponentMethod("images","convertCoords")(e,F,E,x)}else{x(O+".autorange",true);x(O+".range",null)}o.nestedProperty(n,O+"._inputRange").set(null)}else if(P.match(T)){var Q=o.nestedProperty(n,C).get(),ee=(E||{}).type;if(!ee||ee==="-")ee="linear";u.getComponentMethod("annotations","convertCoords")(e,Q,ee,x);u.getComponentMethod("images","convertCoords")(e,Q,ee,x)}var te=b.containerArrayMatch(C);if(te){l=te.array;f=te.index;var re=te.property;var ne=o.nestedProperty(r,l);var ie=(ne||[])[f]||{};var ae=ie;var oe=N||{editType:"calc"};var se=oe.editType.indexOf("calcIfAutorange")!==-1;if(f===""){if(se)g.calc=true;else A.update(g,oe);se=false}else if(re===""){ae=E;if(b.isAddVal(E)){_[C]=null}else if(b.isRemoveVal(E)){_[C]=ie;ae=ie}else o.warn("unrecognized full object value",t)}if(se&&(X(e,ae,"x")||X(e,ae,"y"))){g.calc=true}else{A.update(g,oe)}if(!s[l])s[l]={};var le=s[l][f];if(!le)le=s[l][f]={};le[re]=E;delete t[C]}else if(P==="reverse"){if(R.range)R.range.reverse();else{x(O+".autorange",true);R.range=[1,0]}if(F.autorange)g.calc=true;else g.plot=true}else{if(n._has("scatter-like")&&n._has("regl")&&(C==="dragmode"&&(E==="lasso"||E==="select")&&!(B==="lasso"||B==="select"))){g.plot=true}else if(N)A.update(g,N);else g.calc=true;z.set(E)}}for(l in s){var ue=b.applyContainerArrayChanges(e,o.nestedProperty(r,l),s[l],g);if(!ue)g.plot=true}var ce=n._axisConstraintGroups||[];for(M in k){for(f=0;f<ce.length;f++){var fe=ce[f];if(fe[M]){g.calc=true;for(var he in fe){if(!k[he]){p.getFromId(e,he)._constraintShrinkable=true}}}}}if(W(e)||t.height||t.width)g.plot=true;if(g.plot||g.calc){g.layoutReplot=true}return{flags:g,rangesAltered:k,undoit:_,redoit:y,eventData:o.extendDeep({},y)}}function W(e){var t=e._fullLayout;var r=t.width;var n=t.height;if(e.layout.autosize)f.plotAutoSize(e,e.layout,t);return t.width!==r||t.height!==n}function X(e,t,r){if(!o.isPlainObject(t))return false;var n=t[r+"ref"]||r,i=p.getFromId(e,n);if(!i&&n.charAt(0)===r){i=p.getFromId(e,r)}return(i||{}).autorange}r.update=function e(t,n,i,a){t=o.getGraphDiv(t);w.clearPromiseQueue(t);if(t.framework&&t.framework.isPolar){return Promise.resolve(t)}if(!o.isPlainObject(n))n={};if(!o.isPlainObject(i))i={};if(Object.keys(n).length)t.changed=true;if(Object.keys(i).length)t.changed=true;var s=w.coerceTraceIndices(t,a);var u=q(t,o.extendFlat({},n),s);var c=u.flags;var h=$(t,o.extendFlat({},i));var p=h.flags;if(c.clearCalc||p.calc)t.calcdata=undefined;if(c.clearAxisTypes)w.clearAxisTypes(t,s,i);var d=[];if(c.fullReplot&&p.layoutReplot){var v=t.data,m=t.layout;t.data=undefined;t.layout=undefined;d.push(function(){return r.plot(t,v,m)})}else if(c.fullReplot){d.push(r.plot)}else if(p.layoutReplot){d.push(k.layoutReplot)}else{d.push(f.previousPromises);f.supplyDefaults(t);if(c.style)d.push(k.doTraceStyle);if(c.colorbars)d.push(k.doColorBars);if(p.legend)d.push(k.doLegend);if(p.layoutstyle)d.push(k.layoutStyles);if(p.axrange){U(d,h.rangesAltered)}if(p.ticks)d.push(k.doTicksRelayout);if(p.modebar)d.push(k.doModeBar);if(p.camera)d.push(k.doCamera);d.push(C)}d.push(f.rehover);l.add(t,e,[t,u.undoit,h.undoit,u.traces],e,[t,u.redoit,h.redoit,u.traces]);var g=o.syncOrAsync(d,t);if(!g||!g.then)g=Promise.resolve(t);return g.then(function(){t.emit("plotly_update",{data:u.eventData,layout:h.eventData});return t})};r.react=function(e,t,n,i){var a,s;function l(){return r.addFrames(e,a)}e=o.getGraphDiv(e);var c=e._fullData;var h=e._fullLayout;if(!o.isPlotDiv(e)||!c||!h){s=r.newPlot(e,t,n,i)}else{if(o.isPlainObject(t)){var p=t;t=p.data;n=p.layout;i=p.config;a=p.frames}var d=false;if(i){var v=o.extendDeep({},e._context);e._context=undefined;L(e,i);d=Q(v,e._context)}e.data=t||[];w.cleanData(e.data);e.layout=n||{};w.cleanLayout(e.layout);f.supplyDefaults(e,{skipUpdateCalc:true});var m=e._fullData;var g=e._fullLayout;var y=g.datarevision===undefined;var _=Y(e,c,m,y);var x=J(e,h,g,y);if(W(e))x.layoutReplot=true;if(_.calc||x.calc)e.calcdata=undefined;else f.supplyDefaultsUpdateCalc(e.calcdata,m);var b=[];if(a){e._transitionData={};f.createTransitionData(e);b.push(l)}if(_.fullReplot||x.layoutReplot||d){e._fullLayout._skipDefaults=true;b.push(r.plot)}else{for(var A in x.arrays){var T=x.arrays[A];if(T.length){var M=u.getComponentMethod(A,"drawOne");if(M!==o.noop){for(var S=0;S<T.length;S++){M(e,T[S])}}else{var z=u.getComponentMethod(A,"draw");if(z===o.noop){throw new Error("cannot draw components: "+A)}z(e)}}}b.push(f.previousPromises);if(_.style)b.push(k.doTraceStyle);if(_.colorbars)b.push(k.doColorBars);if(x.legend)b.push(k.doLegend);if(x.layoutstyle)b.push(k.layoutStyles);if(x.axrange)U(b);if(x.ticks)b.push(k.doTicksRelayout);if(x.modebar)b.push(k.doModeBar);if(x.camera)b.push(k.doCamera);b.push(C)}b.push(f.rehover);s=o.syncOrAsync(b,e);if(!s||!s.then)s=Promise.resolve(e)}return s.then(function(){e.emit("plotly_react",{data:t,layout:n});return e})};function Y(e,t,r,n){if(t.length!==r.length){return{fullReplot:true,calc:true}}var i=A.traceFlags();i.arrays={};var a,o;function s(e){return c.getTraceValObject(o,e)}var l={getValObject:s,flags:i,immutable:n,gd:e};var u={};for(a=0;a<t.length;a++){o=r[a]._fullInput;if(u[o.uid])continue;u[o.uid]=1;l.autoranged=o.xaxis?p.getFromId(e,o.xaxis).autorange||p.getFromId(e,o.yaxis).autorange:false;K(t[a]._fullInput,o,[],l)}if(i.calc||i.plot||i.calcIfAutorange){i.fullReplot=true}return i}function J(e,t,r,n){var i=A.layoutFlags();i.arrays={};function a(e){return c.getLayoutValObject(r,e)}var o={getValObject:a,flags:i,immutable:n,gd:e};K(t,r,[],o);if(i.plot||i.calc){i.layoutReplot=true}return i}function K(e,t,r,n){var i,a;var s=n.getValObject;var l=n.flags;var u=n.immutable;var c=n.inArray;var f=n.arrayIndex;var h=n.gd;var p=n.autoranged;function d(){var e=i.editType;if(e.indexOf("calcIfAutorange")!==-1&&(p||p===undefined&&(X(h,t,"x")||X(h,t,"y")))){l.calc=true;return}if(c&&e.indexOf("arraydraw")!==-1){o.pushUnique(l.arrays[c],f);return}A.update(l,i)}function v(e){return e.valType==="data_array"||e.arrayOk}for(a in e){if(l.calc)return;var m=e[a];var g=t[a];if(a.charAt(0)==="_"||typeof m==="function"||m===g)continue;if(a==="tick0"||a==="dtick"){var y=t.tickmode;if(y==="auto"||y==="array"||!y)continue}if(a==="range"&&t.autorange)continue;if((a==="zmin"||a==="zmax")&&t.type==="contourcarpet")continue;var _=r.concat(a);i=s(_);if(!i)continue;if(i._compareAsJSON&&JSON.stringify(m)===JSON.stringify(g))continue;var x=i.valType;var b;var w=v(i);var k=Array.isArray(m);var T=Array.isArray(g);if(k&&T){var M="_input_"+a;var S=e[M];var C=t[M];if(Array.isArray(S)&&S===C)continue}if(g===undefined){if(w&&k)l.calc=true;else d()}else if(i._isLinkedToArray){var z=[];var E=false;if(!c)l.arrays[a]=z;var L=Math.min(m.length,g.length);var I=Math.max(m.length,g.length);if(L!==I){if(i.editType==="arraydraw"){E=true}else{d();continue}}for(b=0;b<L;b++){K(m[b],g[b],_.concat(b),o.extendFlat({inArray:a,arrayIndex:b},n))}if(E){for(b=L;b<I;b++){z.push(b)}}}else if(!x&&o.isPlainObject(m)){K(m,g,_,n)}else if(w){if(k&&T){if(u){l.calc=true}}else if(k!==T){l.calc=true}else d()}else if(k&&T){if(m.length!==g.length||String(m)!==String(g)){d()}}else{d()}}for(a in t){if(!(a in e||a.charAt(0)==="_"||typeof t[a]==="function")){i=s(r.concat(a));if(v(i)&&Array.isArray(t[a])){l.calc=true;return}else d()}}}function Q(e,t){var r;for(r in e){var n=e[r];var i=t[r];if(n!==i){if(o.isPlainObject(n)&&o.isPlainObject(i)){if(Q(n,i)){return true}}else if(Array.isArray(n)&&Array.isArray(i)){if(n.length!==i.length){return true}for(var a=0;a<n.length;a++){if(n[a]!==i[a]){if(o.isPlainObject(n[a])&&o.isPlainObject(i[a])){if(Q(n[a],i[a])){return true}}else{return true}}}}else{return true}}}}r.animate=function(e,t,r){e=o.getGraphDiv(e);if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed "+"to create a plot before animating it. For more details, see "+"https://plot.ly/javascript/animations/")}var n=e._transitionData;if(!n._frameQueue){n._frameQueue=[]}r=f.supplyAnimationDefaults(r);var i=r.transition;var a=r.frame;if(n._frameWaitingCnt===undefined){n._frameWaitingCnt=0}function s(e){if(Array.isArray(i)){if(e>=i.length){return i[0]}else{return i[e]}}else{return i}}function l(e){if(Array.isArray(a)){if(e>=a.length){return a[0]}else{return a[e]}}else{return a}}function u(e,t){var r=0;return function(){if(e&&++r===t){return e()}}}return new Promise(function(a,c){function h(){if(n._frameQueue.length===0){return}while(n._frameQueue.length){var t=n._frameQueue.pop();if(t.onInterrupt){t.onInterrupt()}}e.emit("plotly_animationinterrupted",[])}function p(t){if(t.length===0)return;for(var i=0;i<t.length;i++){var o;if(t[i].type==="byname"){o=f.computeFrame(e,t[i].name)}else{o=t[i].data}var h=l(i);var p=s(i);p.duration=Math.min(p.duration,h.duration);var d={frame:o,name:t[i].name,frameOpts:h,transitionOpts:p};if(i===t.length-1){d.onComplete=u(a,2);d.onInterrupt=c}n._frameQueue.push(d)}if(r.mode==="immediate"){n._lastFrameAt=-Infinity}if(!n._animationRaf){m()}}function d(){e.emit("plotly_animated");window.cancelAnimationFrame(n._animationRaf);n._animationRaf=null}function v(){if(n._currentFrame&&n._currentFrame.onComplete){n._currentFrame.onComplete()}var t=n._currentFrame=n._frameQueue.shift();if(t){var r=t.name?t.name.toString():null;e._fullLayout._currentFrame=r;n._lastFrameAt=Date.now();n._timeToNext=t.frameOpts.duration;f.transition(e,t.frame.data,t.frame.layout,w.coerceTraceIndices(e,t.frame.traces),t.frameOpts,t.transitionOpts).then(function(){if(t.onComplete){t.onComplete()}});e.emit("plotly_animatingframe",{name:r,frame:t.frame,animation:{frame:t.frameOpts,transition:t.transitionOpts}})}else{d()}}function m(){e.emit("plotly_animating");n._lastFrameAt=-Infinity;n._timeToNext=0;n._runningTransitions=0;n._currentFrame=null;var t=function(){n._animationRaf=window.requestAnimationFrame(t);if(Date.now()-n._lastFrameAt>n._timeToNext){v()}};t()}var g=0;function y(e){if(Array.isArray(i)){if(g>=i.length){e.transitionOpts=i[g]}else{e.transitionOpts=i[0]}}else{e.transitionOpts=i}g++;return e}var _,x;var b=[];var k=t===undefined||t===null;var A=Array.isArray(t);var T=!k&&!A&&o.isPlainObject(t);if(T){b.push({type:"object",data:y(o.extendFlat({},t))})}else if(k||["string","number"].indexOf(typeof t)!==-1){for(_=0;_<n._frames.length;_++){x=n._frames[_];if(!x)continue;if(k||String(x.group)===String(t)){b.push({type:"byname",name:String(x.name),data:y({name:x.name})})}}}else if(A){for(_=0;_<t.length;_++){var M=t[_];if(["number","string"].indexOf(typeof M)!==-1){M=String(M);b.push({type:"byname",name:M,data:y({name:M})})}else if(o.isPlainObject(M)){b.push({type:"object",data:y(o.extendFlat({},M))})}}}for(_=0;_<b.length;_++){x=b[_];if(x.type==="byname"&&!n._frameHash[x.data.name]){o.warn('animate failure: frame not found: "'+x.data.name+'"');c();return}}if(["next","immediate"].indexOf(r.mode)!==-1){h()}if(r.direction==="reverse"){b.reverse()}var S=e._fullLayout._currentFrame;if(S&&r.fromcurrent){var C=-1;for(_=0;_<b.length;_++){x=b[_];if(x.type==="byname"&&x.name===S){C=_;break}}if(C>0&&C<b.length-1){var z=[];for(_=0;_<b.length;_++){x=b[_];if(b[_].type!=="byname"||_>C){z.push(x)}}b=z}}if(b.length>0){p(b)}else{e.emit("plotly_animated");a()}})};r.addFrames=function(e,t,r){e=o.getGraphDiv(e);if(t===null||t===undefined){return Promise.resolve()}if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e+". It's likely that you've failed "+"to create a plot before adding frames. For more details, see "+"https://plot.ly/javascript/animations/")}var n,i,a,s;var u=e._transitionData._frames;var c=e._transitionData._frameHash;if(!Array.isArray(t)){throw new Error("addFrames failure: frameList must be an Array of frame definitions"+t)}var h=u.length+t.length*2;var p=[];var d={};for(n=t.length-1;n>=0;n--){if(!o.isPlainObject(t[n]))continue;var v=t[n].name;var m=(c[v]||d[v]||{}).name;var g=t[n].name;var y=c[m]||d[m];if(m&&g&&typeof g==="number"&&y&&M<S){M++;o.warn('addFrames: overwriting frame "'+(c[m]||d[m]).name+'" with a frame whose name of type "number" also equates to "'+m+'". This is valid but may potentially lead to unexpected '+"behavior since all plotly.js frame names are stored internally "+"as strings.");if(M===S){o.warn("addFrames: This API call has yielded too many of these warnings. "+"For the rest of this call, further warnings about numeric frame "+"names will be suppressed.")}}d[v]={name:v};p.push({frame:f.supplyFrameDefaults(t[n]),index:r&&r[n]!==undefined&&r[n]!==null?r[n]:h+n})}p.sort(function(e,t){if(e.index>t.index)return-1;if(e.index<t.index)return 1;return 0});var _=[];var x=[];var b=u.length;for(n=p.length-1;n>=0;n--){i=p[n].frame;if(typeof i.name==="number"){o.warn("Warning: addFrames accepts frames with numeric names, but the numbers are"+"implicitly cast to strings")}if(!i.name){while(c[i.name="frame "+e._transitionData._counter++]);}if(c[i.name]){for(a=0;a<u.length;a++){if((u[a]||{}).name===i.name)break}_.push({type:"replace",index:a,value:i});x.unshift({type:"replace",index:a,value:u[a]})}else{s=Math.max(0,Math.min(p[n].index,b));_.push({type:"insert",index:s,value:i});x.unshift({type:"delete",index:s});b++}}var w=f.modifyFrames,k=f.modifyFrames,A=[e,x],T=[e,_];if(l)l.add(e,w,A,k,T);return f.modifyFrames(e,_)};r.deleteFrames=function(e,t){e=o.getGraphDiv(e);if(!o.isPlotDiv(e)){throw new Error("This element is not a Plotly plot: "+e)}var r,n;var i=e._transitionData._frames;var a=[];var s=[];if(!t){t=[];for(r=0;r<i.length;r++){t.push(r)}}t=t.slice(0);t.sort();for(r=t.length-1;r>=0;r--){n=t[r];a.push({type:"delete",index:n});s.unshift({type:"insert",index:n,value:i[n]})}var u=f.modifyFrames,c=f.modifyFrames,h=[e,s],p=[e,a];if(l)l.add(e,u,h,c,p);return f.modifyFrames(e,a)};r.purge=function e(t){t=o.getGraphDiv(t);var r=t._fullLayout||{};var n=t._fullData||[];var i=t.calcdata||[];f.cleanPlot([],{},n,r,i);f.purge(t);s.purge(t);if(r._container)r._container.remove();delete t._context;return t};function ee(e){var t=n.select(e);var r=e._fullLayout;r._container=t.selectAll(".plot-container").data([0]);r._container.enter().insert("div",":first-child").classed("plot-container",true).classed("plotly",true);r._paperdiv=r._container.selectAll(".svg-container").data([0]);r._paperdiv.enter().append("div").classed("svg-container",true).style("position","relative");r._glcontainer=r._paperdiv.selectAll(".gl-container").data([{}]);r._glcontainer.enter().append("div").classed("gl-container",true);r._glcanvas=null;r._paperdiv.selectAll(".main-svg").remove();r._paper=r._paperdiv.insert("svg",":first-child").classed("main-svg",true);r._toppaper=r._paperdiv.append("svg").classed("main-svg",true);if(!r._uid){var i={};n.selectAll("defs").each(function(){if(this.id)i[this.id.split("-")[1]]=1});r._uid=o.randstr(i)}r._paperdiv.selectAll(".main-svg").attr(y.svgAttrs);r._defs=r._paper.append("defs").attr("id","defs-"+r._uid);r._clips=r._defs.append("g").classed("clips",true);r._topdefs=r._toppaper.append("defs").attr("id","topdefs-"+r._uid);r._topclips=r._topdefs.append("g").classed("clips",true);r._bgLayer=r._paper.append("g").classed("bglayer",true);r._draggers=r._paper.append("g").classed("draglayer",true);var a=r._paper.append("g").classed("layer-below",true);r._imageLowerLayer=a.append("g").classed("imagelayer",true);r._shapeLowerLayer=a.append("g").classed("shapelayer",true);r._cartesianlayer=r._paper.append("g").classed("cartesianlayer",true);r._polarlayer=r._paper.append("g").classed("polarlayer",true);r._ternarylayer=r._paper.append("g").classed("ternarylayer",true);r._geolayer=r._paper.append("g").classed("geolayer",true);r._pielayer=r._paper.append("g").classed("pielayer",true);r._glimages=r._paper.append("g").classed("glimages",true);var s=r._toppaper.append("g").classed("layer-above",true);r._imageUpperLayer=s.append("g").classed("imagelayer",true);r._shapeUpperLayer=s.append("g").classed("shapelayer",true);r._infolayer=r._toppaper.append("g").classed("infolayer",true);r._menulayer=r._toppaper.append("g").classed("menulayer",true);r._zoomlayer=r._toppaper.append("g").classed("zoomlayer",true);r._hoverlayer=r._toppaper.append("g").classed("hoverlayer",true);e.emit("plotly_framework")}},{"../components/color":42,"../components/colorbar/connect":44,"../components/drawing":67,"../constants/xmlns_namespaces":144,"../lib":161,"../lib/events":153,"../lib/queue":175,"../lib/svg_text_utils":182,"../plots/cartesian/axes":205,"../plots/cartesian/constants":210,"../plots/cartesian/graph_interact":214,"../plots/plots":244,"../plots/polar/legacy":247,"../registry":253,"./edit_types":188,"./helpers":189,"./manage_arrays":191,"./plot_config":193,"./plot_schema":194,"./subroutines":196,d3:6,"fast-isnumeric":9,"has-hover":11}],193:[function(e,t,r){"use strict";t.exports={staticPlot:false,plotlyServerURL:"https://plot.ly",editable:false,edits:{annotationPosition:false,annotationTail:false,annotationText:false,axisTitleText:false,colorbarPosition:false,colorbarTitleText:false,legendPosition:false,legendText:false,shapePosition:false,titleText:false},autosizable:false,queueLength:0,fillFrame:false,frameMargins:0,scrollZoom:false,doubleClick:"reset+autosize",showTips:true,showAxisDragHandles:true,showAxisRangeEntryBoxes:true,showLink:false,sendData:true,linkText:"Edit chart",showSources:false,displayModeBar:"hover",modeBarButtonsToRemove:[],modeBarButtonsToAdd:[],modeBarButtons:false,toImageButtonOptions:{},displaylogo:true,plotGlPixelRatio:2,setBackground:"transparent",topojsonURL:"https://cdn.plot.ly/",mapboxAccessToken:null,logging:1,globalTransforms:[],locale:"en-US",locales:{}}},{}],194:[function(e,t,r){"use strict";var n=e("../registry");var i=e("../lib");var a=e("../plots/attributes");var o=e("../plots/layout_attributes");var s=e("../plots/frame_attributes");var l=e("../plots/animation_attributes");var u=e("../plots/polar/legacy/area_attributes");var c=e("../plots/polar/legacy/axis_attributes");var f=e("./edit_types");var h=i.extendFlat;var p=i.extendDeepAll;var d=i.isPlainObject;var v="_isSubplotObj";var m="_isLinkedToArray";var g="_arrayAttrRegexps";var y="_deprecated";var _=[v,m,g,y];r.IS_SUBPLOT_OBJ=v;r.IS_LINKED_TO_ARRAY=m;r.DEPRECATED=y;r.UNDERSCORE_ATTRS=_;r.get=function(){var e={};n.allTypes.concat("area").forEach(function(t){e[t]=k(t)});var t={};Object.keys(n.transformsRegistry).forEach(function(e){t[e]=T(e)});return{defs:{valObjects:i.valObjectMeta,metaKeys:_.concat(["description","role","editType","impliedEdits"]),editType:{traces:f.traces,layout:f.layout},impliedEdits:{}},traces:e,layout:A(),transforms:t,frames:M(),animation:S(l)}};r.crawl=function(e,t,n,i){var a=n||0;i=i||"";Object.keys(e).forEach(function(n){var o=e[n];if(_.indexOf(n)!==-1)return;var s=(i?i+".":"")+n;t(o,n,e,a,s);if(r.isValObject(o))return;if(d(o)&&n!=="impliedEdits"){r.crawl(o,t,a+1,s)}})};r.isValObject=function(e){return e&&e.valType!==undefined};r.findArrayAttributes=function(e){var t=[];var n=[];var o=[];var s,l;function u(e,t,r,i){n=n.slice(0,i).concat([t]);o=o.slice(0,i).concat([e&&e._isLinkedToArray]);var a=e&&(e.valType==="data_array"||e.arrayOk===true)&&!(n[i-1]==="colorbar"&&(t==="ticktext"||t==="tickvals"));if(!a)return;c(s,0,"")}function c(e,r,a){var s=e[n[r]];var u=a+n[r];if(r===n.length-1){if(i.isArrayOrTypedArray(s)){t.push(l+u)}}else{if(o[r]){if(Array.isArray(s)){for(var f=0;f<s.length;f++){if(i.isPlainObject(s[f])){c(s[f],r+1,u+"["+f+"].")}}}}else if(i.isPlainObject(s)){c(s,r+1,u+".")}}}s=e;l="";r.crawl(a,u);if(e._module&&e._module.attributes){r.crawl(e._module.attributes,u)}var f=e.transforms;if(f){for(var h=0;h<f.length;h++){var p=f[h];var d=p._module;if(d){l="transforms["+h+"].";s=p;r.crawl(d.attributes,u)}}}return t};r.getTraceValObject=function(e,t){var r=t[0];var i=1;var o,s;if(r==="transforms"){if(t.length===1){return a.transforms}var l=e.transforms;if(!Array.isArray(l)||!l.length)return false;var c=t[1];if(!w(c)||c>=l.length){return false}o=(n.transformsRegistry[l[c].type]||{}).attributes;s=o&&o[t[2]];i=3}else if(e.type==="area"){s=u[r]}else{var f=e._module;if(!f)f=(n.modules[e.type||a.type.dflt]||{})._module;if(!f)return false;o=f.attributes;s=o&&o[r];if(!s){var h=f.basePlotModule;if(h&&h.attributes){s=h.attributes[r]}}if(!s)s=a[r]}return b(s,t,i)};r.getLayoutValObject=function(e,t){var r=x(e,t[0]);return b(r,t,1)};function x(e,t){var r,i,a,s;var l=e._basePlotModules;if(l){var u;for(r=0;r<l.length;r++){a=l[r];if(a.attrRegex&&a.attrRegex.test(t)){if(a.layoutAttrOverrides)return a.layoutAttrOverrides;if(!u&&a.layoutAttributes)u=a.layoutAttributes}var f=a.baseLayoutAttrOverrides;if(f&&t in f)return f[t]}if(u)return u}var h=e._modules;if(h){for(r=0;r<h.length;r++){s=h[r].layoutAttributes;if(s&&t in s){return s[t]}}}for(i in n.componentsRegistry){a=n.componentsRegistry[i];if(!a.schema&&t===a.name){return a.layoutAttributes}}if(t in o)return o[t];if(t==="radialaxis"||t==="angularaxis"){return c[t]}return c.layout[t]||false}function b(e,t,r){if(!e)return false;if(e._isLinkedToArray){if(w(t[r]))r++;else if(r<t.length)return false}for(;r<t.length;r++){var n=e[t[r]];if(d(n))e=n;else break;if(r===t.length-1)break;if(e._isLinkedToArray){r++;if(!w(t[r]))return false}else if(e.valType==="info_array"){r++;var i=t[r];if(!w(i))return false;var a=e.items;if(Array.isArray(a)){if(i>=a.length)return false;if(e.dimensions===2){r++;if(t.length===r)return e;var o=t[r];if(!w(o))return false;e=a[i][o]}else e=a[i]}else{e=a}}}return e}function w(e){return e===Math.round(e)&&e>=0}function k(e){var t,r;if(e==="area"){t={attributes:u};r={}}else{t=n.modules[e]._module,r=t.basePlotModule}var i={};i.type=null;p(i,a);p(i,t.attributes);if(r.attributes){p(i,r.attributes)}i.type=e;var o={meta:t.meta||{},attributes:S(i)};if(t.layoutAttributes){var s={};p(s,t.layoutAttributes);o.layoutAttributes=S(s)}return o}function A(){var e={};var t,r;p(e,o);for(t in n.subplotsRegistry){r=n.subplotsRegistry[t];if(!r.layoutAttributes)continue;if(Array.isArray(r.attr)){for(var i=0;i<r.attr.length;i++){I(e,r,r.attr[i])}}else{var a=r.attr==="subplot"?r.name:r.attr;I(e,r,a)}}e=L(e);for(t in n.componentsRegistry){r=n.componentsRegistry[t];var s=r.schema;if(s&&(s.subplots||s.layout)){var l=s.subplots;if(l&&l.xaxis&&!l.yaxis){for(var u in l.xaxis)delete e.yaxis[u]}}else if(r.layoutAttributes){P(e,r.layoutAttributes,r.name)}}return{layoutAttributes:S(e)}}function T(e){var t=n.transformsRegistry[e];var r=p({},t.attributes);Object.keys(n.componentsRegistry).forEach(function(t){var i=n.componentsRegistry[t];if(i.schema&&i.schema.transforms&&i.schema.transforms[e]){Object.keys(i.schema.transforms[e]).forEach(function(t){P(r,i.schema.transforms[e][t],t)})}});return{attributes:S(r)}}function M(){var e={frames:i.extendDeepAll({},s)};S(e);return e.frames}function S(e){C(e);z(e);E(e);return e}function C(e){function t(e){return{valType:"string",editType:"none"}}function n(e,n,i){if(r.isValObject(e)){if(e.valType==="data_array"){e.role="data";i[n+"src"]=t(n)}else if(e.arrayOk===true){i[n+"src"]=t(n)}}else if(d(e)){e.role="object"}}r.crawl(e,n)}function z(e){function t(e,t,r){if(!e)return;var n=e[m];if(!n)return;delete e[m];r[t]={items:{}};r[t].items[n]=e;r[t].role="object"}r.crawl(e,t)}function E(e){function t(e){for(var r in e){if(d(e[r])){t(e[r])}else if(Array.isArray(e[r])){for(var n=0;n<e[r].length;n++){t(e[r][n])}}else{if(e[r]instanceof RegExp){e[r]=e[r].toString()}}}}t(e)}function L(e){h(e,{radialaxis:c.radialaxis,angularaxis:c.angularaxis});h(e,c.layout);return e}function I(e,t,r){var n=i.nestedProperty(e,r),a=p({},t.layoutAttributes);a[v]=true;n.set(a)}function P(e,t,r){var n=i.nestedProperty(e,r);n.set(p(n.get()||{},t))}},{"../lib":161,"../plots/animation_attributes":200,"../plots/attributes":202,"../plots/frame_attributes":232,"../plots/layout_attributes":235,"../plots/polar/legacy/area_attributes":245,"../plots/polar/legacy/axis_attributes":246,"../registry":253,"./edit_types":188}],195:[function(e,t,r){"use strict";var n=e("../lib");var i=e("../plots/attributes");var a="templateitemname";var o={name:{valType:"string",editType:"none"}};o[a]={valType:"string",editType:"calc"};r.templatedArray=function(e,t){t._isLinkedToArray=e;t.name=o.name;t[a]=o[a];return t};r.traceTemplater=function(e){var t={};var r,a;for(r in e){a=e[r];if(Array.isArray(a)&&a.length){t[r]=0}}function o(o){r=n.coerce(o,{},i,"type");var s={type:r,_template:null};if(r in t){a=e[r];var l=t[r]%a.length;t[r]++;s._template=a[l]}else{}return s}return{newTrace:o}};r.newContainer=function(e,t,r){var i=e._template;var a=i&&(i[t]||r&&i[r]);if(!n.isPlainObject(a))a=null;var o=e[t]={_template:a};return o};r.arrayTemplater=function(e,t,r){var n=e._template;var i=n&&n[l(t)];var o=n&&n[t];if(!Array.isArray(o)||!o.length){o=[]}var u={};function c(e){var t={name:e.name,_input:e};var n=t[a]=e[a];if(!s(n)){t._template=i;return t}for(var l=0;l<o.length;l++){var c=o[l];if(c.name===n){u[n]=1;t._template=c;return t}}t[r]=e[r]||false;t._template=false;return t}function f(){var e=[];for(var t=0;t<o.length;t++){var r=o[t];var n=r.name;if(s(n)&&!u[n]){var i={_template:r,name:n,_input:{_templateitemname:n}};i[a]=r[a];e.push(i);u[n]=1}}return e}return{newItem:c,defaultItems:f}};function s(e){return e&&typeof e==="string"}function l(e){var t=e.length-1;if(e.charAt(t)!=="s"){n.warn("bad argument to arrayDefaultKey: "+e)}return e.substr(0,e.length-1)+"defaults"}r.arrayDefaultKey=l;r.arrayEditor=function(e,t,r){var i=(n.nestedProperty(e,t).get()||[]).length;var o=r._index;var s=o>=i&&(r._input||{})._templateitemname;if(s)o=i;var l=t+"["+o+"]";var u;function c(){u={};if(s){u[l]={};u[l][a]=s}}c();function f(e,t){u[e]=t}function h(e,t){if(s){n.nestedProperty(u[l],e).set(t)}else{u[l+"."+e]=t}}function p(){var e=u;c();return e}function d(t,r){if(t)h(t,r);var i=p();for(var a in i){n.nestedProperty(e,a).set(i[a])}}return{modifyBase:f,modifyItem:h,getUpdateObj:p,applyUpdate:d}}},{"../lib":161,"../plots/attributes":202}],196:[function(e,t,r){"use strict";var n=e("d3");var i=e("../registry");var a=e("../plots/plots");var o=e("../lib");var s=e("../lib/clear_gl_canvases");var l=e("../components/color");var u=e("../components/drawing");var c=e("../components/titles");var f=e("../components/modebar");var h=e("../plots/cartesian/axes");var p=e("../constants/alignment");var d=e("../plots/cartesian/constraints");var v=d.enforce;var m=d.clean;var g=e("../plots/cartesian/autorange").doAutoRange;r.layoutStyles=function(e){return o.syncOrAsync([a.doAutoMargin,_],e)};function y(e,t,r){for(var n=0;n<r.length;n++){var i=r[n][0],a=r[n][1];if(i[0]>=e[1]||i[1]<=e[0]){continue}if(a[0]<t[1]&&a[1]>t[0]){return true}}return false}function _(e){var t=e._fullLayout;var i=t._size;var a=i.p;var s=h.list(e,"",true);var c=t._has("cartesian");var d;function v(e,t,r){var n=e._lw/2;if(e._id.charAt(0)==="x"){if(!t)return i.t+i.h*(1-(e.position||0))+n%1;else if(r==="top")return t._offset-a-n;return t._offset+t._length+a+n}if(!t)return i.l+i.w*(e.position||0)+n%1;else if(r==="right")return t._offset+t._length+a+n;return t._offset-a-n}for(d=0;d<s.length;d++){var m=s[d];m.setScale();var g=m._anchorAxis;m._linepositions={};m._lw=u.crispRound(e,m.linewidth,1);m._mainLinePosition=v(m,g,m.side);m._mainMirrorPosition=m.mirror&&g?v(m,g,p.OPPOSITE_SIDE[m.side]):null;m._mainSubplot=x(m,t)}t._paperdiv.style({width:t.width+"px",height:t.height+"px"}).selectAll(".main-svg").call(u.setSize,t.width,t.height);e._context.setBackground(e,t.paper_bgcolor);var _=t._paper.selectAll("g.subplot");var w=[];var A=[];_.each(function(e){var r=t._plots[e];if(r.mainplot){if(r.bg){r.bg.remove()}r.bg=undefined;return}var n=r.xaxis.domain;var i=r.yaxis.domain;var a=r.plotgroup;if(y(n,i,A)){var s=a.node();var l=r.bg=o.ensureSingle(a,"rect","bg");s.insertBefore(l.node(),s.childNodes[0])}else{a.select("rect.bg").remove();w.push(e);A.push([n,i])}});var T=t._bgLayer.selectAll(".bg").data(w);T.enter().append("rect").classed("bg",true);T.exit().remove();T.each(function(e){t._plots[e].bg=n.select(this)});_.each(function(e){var r=t._plots[e];var n=r.xaxis;var i=r.yaxis;if(r.bg&&c){r.bg.call(u.setRect,n._offset-a,i._offset-a,n._length+2*a,i._length+2*a).call(l.fill,t.plot_bgcolor).style("stroke-width",0)}var f=r.clipId="clip"+t._uid+e+"plot";var h=o.ensureSingleById(t._clips,"clipPath",f,function(e){e.classed("plotclip",true).append("rect")});r.clipRect=h.select("rect").attr({width:n._length,height:i._length});u.setTranslate(r.plot,n._offset,i._offset);var p;var d;if(r._hasClipOnAxisFalse){p=null;d=f}else{p=f;d=null}u.setClipUrl(r.plot,p);r.layerClipId=d;if(!c)return;var m,g,y,_,x,w;var A,T,M,S,C,z;var E;function L(e){return"M"+m+","+e+"H"+g}function I(e){return"M"+n._offset+","+e+"h"+n._length}function P(e){return"M"+e+","+T+"V"+A}function D(e){return"M"+e+","+i._offset+"v"+i._length}function O(t,r,n){if(!t.showline||e!==t._mainSubplot)return"";if(!t._anchorAxis)return n(t._mainLinePosition);var i=r(t._mainLinePosition);if(t.mirror)i+=r(t._mainMirrorPosition);return i}var R="M0,0";if(b(n,e)){x=k(n,"left",i,s);m=n._offset-(x?a+x:0);w=k(n,"right",i,s);g=n._offset+n._length+(w?a+w:0);y=v(n,i,"bottom");_=v(n,i,"top");E=!n._anchorAxis||e!==n._mainSubplot;if(E&&n.ticks&&n.mirror==="allticks"){n._linepositions[e]=[y,_]}R=O(n,L,I);if(E&&n.showline&&(n.mirror==="all"||n.mirror==="allticks")){R+=L(y)+L(_)}r.xlines.style("stroke-width",n._lw+"px").call(l.stroke,n.showline?n.linecolor:"rgba(0,0,0,0)")}r.xlines.attr("d",R);var F="M0,0";if(b(i,e)){C=k(i,"bottom",n,s);A=i._offset+i._length+(C?a:0);z=k(i,"top",n,s);T=i._offset-(z?a:0);M=v(i,n,"left");S=v(i,n,"right");E=!i._anchorAxis||e!==n._mainSubplot;if(E&&i.ticks&&i.mirror==="allticks"){i._linepositions[e]=[M,S]}F=O(i,P,D);if(E&&i.showline&&(i.mirror==="all"||i.mirror==="allticks")){F+=P(M)+P(S)}r.ylines.style("stroke-width",i._lw+"px").call(l.stroke,i.showline?i.linecolor:"rgba(0,0,0,0)")}r.ylines.attr("d",F)});h.makeClipPaths(e);r.drawMainTitle(e);f.manage(e);return e._promises.length&&Promise.all(e._promises)}function x(e,t){var r=t._subplots;var n=r.cartesian.concat(r.gl2d||[]);var i={_fullLayout:t};var a=e._id.charAt(0)==="x";var o=e._mainAxis._anchorAxis;var s="";var l="";var u="";if(o){u=o._mainAxis._id;s=a?e._id+u:u+e._id}if(!s||!t._plots[s]){s="";for(var c=0;c<n.length;c++){var f=n[c];var p=f.indexOf("y");var d=a?f.substr(0,p):f.substr(p);var v=a?f.substr(p):f.substr(0,p);if(d===e._id){if(!l)l=f;var m=h.getFromId(i,v);if(u&&m.overlaying===u){s=f;break}}}}return s||l}function b(e,t){return(e.ticks||e.showline)&&(t===e._mainSubplot||e.mirror==="all"||e.mirror==="allticks")}function w(e,t,r){if(!r.showline||!r._lw)return false;if(r.mirror==="all"||r.mirror==="allticks")return true;var n=r._anchorAxis;if(!n)return false;var i=p.FROM_BL[t];if(r.side===t){return n.domain[i]===e.domain[i]}return r.mirror&&n.domain[1-i]===e.domain[1-i]}function k(e,t,r,n){if(w(e,t,r)){return r._lw}for(var i=0;i<n.length;i++){var a=n[i];if(a._mainAxis===r._mainAxis&&w(e,t,a)){return a._lw}}return 0}r.drawMainTitle=function(e){var t=e._fullLayout;c.draw(e,"gtitle",{propContainer:t,propName:"title",placeholder:t._dfltTitle.plot,attributes:{x:t.width/2,y:t._size.t/2,"text-anchor":"middle"}})};r.doTraceStyle=function(e){for(var t=0;t<e.calcdata.length;t++){var r=e.calcdata[t],n=((r[0]||{}).trace||{})._module||{},o=n.arraysToCalcdata;if(o)o(r,r[0].trace)}a.style(e);i.getComponentMethod("legend","draw")(e);return a.previousPromises(e)};r.doColorBars=function(e){for(var t=0;t<e.calcdata.length;t++){var r=e.calcdata[t][0];if((r.t||{}).cb){var n=r.trace,o=r.t.cb;if(i.traceIs(n,"contour")){o.line({width:n.contours.showlines!==false?n.line.width:0,dash:n.line.dash,color:n.contours.coloring==="line"?o._opts.line.color:n.line.color})}var s=n._module.colorbar;var l=s.container;var u=(l?n[l]:n).colorbar;o.options(u)()}}return a.previousPromises(e)};r.layoutReplot=function(e){var t=e.layout;e.layout=undefined;return i.call("plot",e,"",t)};r.doLegend=function(e){i.getComponentMethod("legend","draw")(e);return a.previousPromises(e)};r.doTicksRelayout=function(e,t){if(t){h.doTicks(e,Object.keys(t),true)}else{h.doTicks(e,"redraw")}if(e._fullLayout._hasOnlyLargeSploms){s(e);i.subplotsRegistry.splom.plot(e)}r.drawMainTitle(e);return a.previousPromises(e)};r.doModeBar=function(e){var t=e._fullLayout;f.manage(e);for(var r=0;r<t._basePlotModules.length;r++){var n=t._basePlotModules[r].updateFx;if(n)n(t)}return a.previousPromises(e)};r.doCamera=function(e){var t=e._fullLayout;var r=t._subplots.gl3d;for(var n=0;n<r.length;n++){var i=t[r[n]];var a=i._scene;a.setCamera(i.camera)}};r.drawData=function(e){var t=e._fullLayout;var r=e.calcdata;var n;for(n=0;n<r.length;n++){var o=r[n][0].trace;if(o.visible!==true||!o._module.colorbar){t._infolayer.select(".cb"+o.uid).remove()}}s(e);var l=t._basePlotModules;for(n=0;n<l.length;n++){l[n].plot(e)}a.style(e);i.getComponentMethod("shapes","draw")(e);i.getComponentMethod("annotations","draw")(e);t._replotting=false;return a.previousPromises(e)};r.doAutoRangeAndConstraints=function(e){var t=h.list(e,"",true);for(var r=0;r<t.length;r++){var n=t[r];m(e,n);g(n)}v(e)};r.finalDraw=function(e){i.getComponentMethod("shapes","draw")(e);i.getComponentMethod("images","draw")(e);i.getComponentMethod("annotations","draw")(e);i.getComponentMethod("rangeslider","draw")(e);i.getComponentMethod("rangeselector","draw")(e)};r.drawMarginPushers=function(e){i.getComponentMethod("legend","draw")(e);i.getComponentMethod("rangeselector","draw")(e);i.getComponentMethod("sliders","draw")(e);i.getComponentMethod("updatemenus","draw")(e)}},{"../components/color":42,"../components/drawing":67,"../components/modebar":105,"../components/titles":133,"../constants/alignment":140,"../lib":161,"../lib/clear_gl_canvases":149,"../plots/cartesian/autorange":204,"../plots/cartesian/axes":205,"../plots/cartesian/constraints":212,"../plots/plots":244,"../registry":253,d3:6}],197:[function(e,t,r){"use strict";var n=e("../lib");var i=n.isPlainObject;var a=e("./plot_schema");var o=e("../plots/plots");var s=e("../plots/attributes");var l=e("./plot_template");var u=e("./plot_config");r.makeTemplate=function(e){e=n.extendDeep({_context:u},e);o.supplyDefaults(e);var t=e.data||[];var r=e.layout||{};r._basePlotModules=e._fullLayout._basePlotModules;r._modules=e._fullLayout._modules;var a={data:{},layout:{}};t.forEach(function(e){var t={};h(e,t,d.bind(null,e));var r=n.coerce(e,{},s,"type");var i=a.data[r];if(!i)i=a.data[r]=[];i.push(t)});h(r,a.layout,p.bind(null,r));delete a.layout.template;var l=r.template;if(i(l)){var f=l.layout;var v,m,g,y,_,x;if(i(f)){c(f,a.layout)}var b=l.data;if(i(b)){for(m in a.data){g=b[m];if(Array.isArray(g)){_=a.data[m];x=_.length;y=g.length;for(v=0;v<x;v++){c(g[v%y],_[v])}for(v=x;v<y;v++){_.push(n.extendDeep({},g[v]))}}}for(m in b){if(!(m in a.data)){a.data[m]=n.extendDeep([],b[m])}}}}return a};function c(e,t){e=n.extendDeep({},e);var r=Object.keys(e).sort();var a,o;function s(t,r,n){if(i(r)&&i(t)){c(t,r)}else if(Array.isArray(r)&&Array.isArray(t)){var a=l.arrayTemplater({_template:e},n);for(o=0;o<r.length;o++){var s=r[o];var u=a.newItem(s)._template;if(u)c(u,s)}var f=a.defaultItems();for(o=0;o<f.length;o++)r.push(f[o]._template);for(o=0;o<r.length;o++)delete r[o].templateitemname}}for(a=0;a<r.length;a++){var u=r[a];var h=e[u];if(u in t){s(h,t[u],u)}else t[u]=h;if(f(u)===u){for(var p in t){var d=f(p);if(p!==d&&d===u&&!(p in e)){s(h,t[p],u)}}}}}function f(e){return e.replace(/[0-9]+$/,"")}function h(e,t,r,a,o){var s=o&&r(o);for(var u in e){var c=e[u];var p=v(e,u,a);var d=v(e,u,o);var m=r(d);if(!m){var g=f(u);if(g!==u){d=v(e,g,o);m=r(d)}}if(s&&s===m)continue;if(!m||m._noTemplating||m.valType==="data_array"||m.arrayOk&&Array.isArray(c)){continue}if(!m.valType&&i(c)){h(c,t,r,p,d)}else if(m._isLinkedToArray&&Array.isArray(c)){var y=false;var _=0;var x={};for(var b=0;b<c.length;b++){var w=c[b];if(i(w)){var k=w.name;if(k){if(!x[k]){h(w,t,r,v(c,_,p),v(c,_,d));_++;x[k]=1}}else if(!y){var A=l.arrayDefaultKey(u);var T=v(e,A,a);var M=v(c,_,p);h(w,t,r,M,v(c,_,d));var S=n.nestedProperty(t,M);var C=n.nestedProperty(t,T);C.set(S.get());S.set(null);y=true}}}}else{var z=n.nestedProperty(t,p);z.set(c)}}}function p(e,t){return a.getLayoutValObject(e,n.nestedProperty({},t).parts)}function d(e,t){return a.getTraceValObject(e,n.nestedProperty({},t).parts)}function v(e,t,r){var n;if(!r)n=t;else if(Array.isArray(e))n=r+"["+t+"]";else n=r+"."+t;return n}r.validateTemplate=function(e,t){var r=n.extendDeep({},{_context:u,data:e.data,layout:e.layout});var a=r.layout||{};if(!i(t))t=a.template||{};var s=t.layout;var l=t.data;var c=[];r.layout=a;r.layout.template=t;o.supplyDefaults(r);var h=r._fullLayout;var p=r._fullData;var d={};function y(e,t){for(var r in e){if(r.charAt(0)!=="_"&&i(e[r])){var n=f(r);var a=[];var o;for(o=0;o<t.length;o++){a.push(v(e,r,t[o]));if(n!==r)a.push(v(e,n,t[o]))}for(o=0;o<a.length;o++){d[a[o]]=1}y(e[r],a)}}}function _(e,t){for(var r in e){if(r.indexOf("defaults")===-1&&i(e[r])){var n=v(e,r,t);if(d[n]){_(e[r],n)}else{c.push({code:"unused",path:n})}}}}if(!i(s)){c.push({code:"layout"})}else{y(h,["layout"]);_(s,"layout")}if(!i(l)){c.push({code:"data"})}else{var x={};var b;for(var w=0;w<p.length;w++){var k=p[w];b=k.type;x[b]=(x[b]||0)+1;if(!k._fullInput._template){c.push({code:"missing",index:k._fullInput.index,traceType:b})}}for(b in l){var A=l[b].length;var T=x[b]||0;if(A>T){c.push({code:"unused",traceType:b,templateCount:A,dataCount:T})}else if(T>A){c.push({code:"reused",traceType:b,templateCount:A,dataCount:T})}}}function M(e,t){for(var r in e){if(r.charAt(0)==="_")continue;var n=e[r];var a=v(e,r,t);if(i(n)){if(Array.isArray(e)&&n._template===false&&n.templateitemname){c.push({code:"missing",path:a,templateitemname:n.templateitemname})}M(n,a)}else if(Array.isArray(n)&&m(n)){M(n,a)}}}M({data:p,layout:h},"");if(c.length)return c.map(g)};function m(e){for(var t=0;t<e.length;t++){if(i(e[t]))return true}}function g(e){var t;switch(e.code){case"data":t="The template has no key data.";break;case"layout":t="The template has no key layout.";break;case"missing":if(e.path){t="There are no templates for item "+e.path+" with name "+e.templateitemname}else{t="There are no templates for trace "+e.index+", of type "+e.traceType+"."}break;case"unused":if(e.path){t="The template item at "+e.path+" was not used in constructing the plot."}else if(e.dataCount){t="Some of the templates of type "+e.traceType+" were not used. The template has "+e.templateCount+" traces, the data only has "+e.dataCount+" of this type."}else{t="The template has "+e.templateCount+" traces of type "+e.traceType+" but there are none in the data."}break;case"reused":t="Some of the templates of type "+e.traceType+" were used more than once. The template has "+e.templateCount+" traces, the data has "+e.dataCount+" of this type.";break}e.msg=t;return e}},{"../lib":161,"../plots/attributes":202,"../plots/plots":244,"./plot_config":193,"./plot_schema":194,"./plot_template":195}],198:[function(e,t,r){"use strict";var n=e("./plot_api");var i=e("../lib");var a=e("../snapshot/helpers");var o=e("../snapshot/tosvg");var s=e("../snapshot/svgtoimg");var l={format:{valType:"enumerated",values:["png","jpeg","webp","svg"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:false},imageDataOnly:{valType:"boolean",dflt:false}};var u=/^data:image\/\w+;base64,/;function c(e,t){t=t||{};var r;var c;var f;if(i.isPlainObject(e)){r=e.data||[];c=e.layout||{};f=e.config||{}}else{e=i.getGraphDiv(e);r=i.extendDeep([],e.data);c=i.extendDeep({},e.layout);f=e._context}function h(e){return!(e in t)||i.validate(t[e],l[e])}if(!h("width")||!h("height")){throw new Error("Height and width should be pixel values.")}if(!h("format")){throw new Error("Image format is not jpeg, png, svg or webp.")}var p={};function d(e,r){return i.coerce(t,p,l,e,r)}var v=d("format");var m=d("width");var g=d("height");var y=d("scale");var _=d("setBackground");var x=d("imageDataOnly");var b=document.createElement("div");b.style.position="absolute";b.style.left="-5000px";document.body.appendChild(b);var w=i.extendFlat({},c);if(m)w.width=m;if(g)w.height=g;var k=i.extendFlat({},f,{staticPlot:true,setBackground:_});var A=a.getRedrawFunc(b);function T(){return new Promise(function(e){setTimeout(e,a.getDelay(b._fullLayout))})}function M(){return new Promise(function(e,t){var r=o(b,v,y);var a=b._fullLayout.width;var l=b._fullLayout.height;n.purge(b);document.body.removeChild(b);if(v==="svg"){if(x){return e(r)}else{return e("data:image/svg+xml,"+encodeURIComponent(r))}}var u=document.createElement("canvas");u.id=i.randstr();s({format:v,width:a,height:l,scale:y,canvas:u,svg:r,promise:true}).then(e).catch(t)})}function S(e){if(x){return e.replace(u,"")}else{return e}}return new Promise(function(e,t){n.plot(b,r,w,k).then(A).then(T).then(M).then(function(t){e(S(t))}).catch(function(e){t(e)})})}t.exports=c},{"../lib":161,"../snapshot/helpers":257,"../snapshot/svgtoimg":259,"../snapshot/tosvg":261,"./plot_api":192}],199:[function(e,t,r){"use strict";var n=e("../lib");var i=e("../plots/plots");var a=e("./plot_schema");var o=e("./plot_config");var s=n.isPlainObject;var l=Array.isArray;var u=n.isArrayOrTypedArray;t.exports=function e(t,r){var u=a.get();var h=[];var p={_context:n.extendFlat({},o)};var v,m;if(l(t)){p.data=n.extendDeep([],t);v=t}else{p.data=[];v=[];h.push(d("array","data"))}if(s(r)){p.layout=n.extendDeep({},r);m=r}else{p.layout={};m={};if(arguments.length>1){h.push(d("object","layout"))}}i.supplyDefaults(p);var g=p._fullData,y=v.length;for(var _=0;_<y;_++){var x=v[_],b=["data",_];if(!s(x)){h.push(d("object",b));continue}var w=g[_],k=w.type,A=u.traces[k].attributes;A.type={valType:"enumerated",values:[k]};if(w.visible===false&&x.visible!==false){h.push(d("invisible",b))}c(x,w,A,h,b);var T=x.transforms,M=w.transforms;if(T){if(!l(T)){h.push(d("array",b,["transforms"]))}b.push("transforms");for(var S=0;S<T.length;S++){var C=["transforms",S],z=T[S].type;if(!s(T[S])){h.push(d("object",b,C));continue}var E=u.transforms[z]?u.transforms[z].attributes:{};E.type={valType:"enumerated",values:Object.keys(u.transforms)};c(T[S],M[S],E,h,b,C)}}}var L=p._fullLayout,I=f(u,g);c(m,L,I,h,"layout");return h.length===0?void 0:h};function c(e,t,r,i,a,o){o=o||[];var f=Object.keys(e);for(var h=0;h<f.length;h++){var p=f[h];if(p==="transforms")continue;var g=o.slice();g.push(p);var y=e[p],_=t[p];var x=m(r,p);var b=(x||{}).valType==="info_array";var w=(x||{}).valType==="colorscale";var k=(x||{}).items;if(!v(r,p)){i.push(d("schema",a,g))}else if(s(y)&&s(_)){c(y,_,x,i,a,g)}else if(b&&l(y)){if(y.length>_.length){i.push(d("unused",a,g.concat(_.length)))}var A=_.length;var T=Array.isArray(k);if(T)A=Math.min(A,k.length);var M,S,C,z,E;if(x.dimensions===2){for(S=0;S<A;S++){if(l(y[S])){if(y[S].length>_[S].length){i.push(d("unused",a,g.concat(S,_[S].length)))}var L=_[S].length;for(M=0;M<(T?Math.min(L,k[S].length):L);M++){C=T?k[S][M]:k;z=y[S][M];E=_[S][M];if(!n.validate(z,C)){i.push(d("value",a,g.concat(S,M),z))}else if(E!==z&&E!==+z){i.push(d("dynamic",a,g.concat(S,M),z,E))}}}else{i.push(d("array",a,g.concat(S),y[S]))}}}else{for(S=0;S<A;S++){C=T?k[S]:k;z=y[S];E=_[S];if(!n.validate(z,C)){i.push(d("value",a,g.concat(S),z))}else if(E!==z&&E!==+z){i.push(d("dynamic",a,g.concat(S),z,E))}}}}else if(x.items&&!b&&l(y)){var I=k[Object.keys(k)[0]],P=[];var D,O;for(D=0;D<_.length;D++){var R=_[D]._index||D;O=g.slice();O.push(R);if(s(y[R])&&s(_[D])){P.push(R);var F=y[R];var B=_[D];if(s(F)&&F.visible!==false&&B.visible===false){i.push(d("invisible",a,O))}else c(F,B,I,i,a,O)}}for(D=0;D<y.length;D++){O=g.slice();O.push(D);if(!s(y[D])){i.push(d("object",a,O,y[D]))}else if(P.indexOf(D)===-1){i.push(d("unused",a,O))}}}else if(!s(y)&&s(_)){i.push(d("object",a,g,y))}else if(!u(y)&&u(_)&&!b&&!w){i.push(d("array",a,g,y))}else if(!(p in t)){i.push(d("unused",a,g,y))}else if(!n.validate(y,x)){i.push(d("value",a,g,y))}else if(x.valType==="enumerated"&&(x.coerceNumber&&y!==+_||y!==_)){i.push(d("dynamic",a,g,y,_))}}return i}function f(e,t){for(var r=0;r<t.length;r++){var i=t[r].type,a=e.traces[i].layoutAttributes;if(a){n.extendFlat(e.layout.layoutAttributes,a)}}return e.layout.layoutAttributes}var h={object:function(e,t){var r;if(e==="layout"&&t==="")r="The layout argument";else if(e[0]==="data"&&t===""){r="Trace "+e[1]+" in the data argument"}else r=p(e)+"key "+t;return r+" must be linked to an object container"},array:function(e,t){var r;if(e==="data")r="The data argument";else r=p(e)+"key "+t;return r+" must be linked to an array container"},schema:function(e,t){return p(e)+"key "+t+" is not part of the schema"},unused:function(e,t,r){var n=s(r)?"container":"key";return p(e)+n+" "+t+" did not get coerced"},dynamic:function(e,t,r,n){return[p(e)+"key",t,"(set to '"+r+"')","got reset to","'"+n+"'","during defaults."].join(" ")},invisible:function(e,t){return(t?p(e)+"item "+t:"Trace "+e[1])+" got defaulted to be not visible"},value:function(e,t,r){return[p(e)+"key "+t,"is set to an invalid value ("+r+")"].join(" ")}};function p(e){if(l(e))return"In data trace "+e[1]+", ";return"In "+e+", "}function d(e,t,r,i,a){r=r||"";var o,s;if(l(t)){o=t[0];s=t[1]}else{o=t;s=null}var u=_(r);var c=h[e](t,u,i,a);n.log(c);return{code:e,container:o,trace:s,path:r,astr:u,msg:c}}function v(e,t){var r=y(t),n=r.keyMinusId,i=r.id;if(n in e&&e[n]._isSubplotObj&&i){return true}return t in e}function m(e,t){if(t in e)return e[t];var r=y(t);return e[r.keyMinusId]}var g=n.counterRegex("([a-z]+)");function y(e){var t=e.match(g);return{keyMinusId:t&&t[1],id:t&&t[2]}}function _(e){if(!l(e))return String(e);var t="";for(var r=0;r<e.length;r++){var n=e[r];if(typeof n==="number"){t=t.substr(0,t.length-1)+"["+n+"]"}else{t+=n}if(r<e.length-1)t+="."}return t}},{"../lib":161,"../plots/plots":244,"./plot_config":193,"./plot_schema":194}],200:[function(e,t,r){"use strict";t.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:false},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:true}},transition:{duration:{valType:"number",min:0,dflt:500},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"]}}}},{}],201:[function(e,t,r){"use strict";var n=e("../lib");var i=e("../plot_api/plot_template");t.exports=function e(t,r,a){var o=a.name;var s=a.inclusionAttr||"visible";var l=r[o];var u=n.isArrayOrTypedArray(t[o])?t[o]:[];var c=r[o]=[];var f=i.arrayTemplater(r,o,s);var h,p;for(h=0;h<u.length;h++){var d=u[h];if(!n.isPlainObject(d)){p=f.newItem({});p[s]=false}else{p=f.newItem(d)}p._index=h;if(p[s]!==false){a.handleItemDefaults(d,p,r,a)}c.push(p)}var v=f.defaultItems();for(h=0;h<v.length;h++){p=v[h];p._index=c.length;a.handleItemDefaults({},p,r,a,{});c.push(p)}if(n.isArrayOrTypedArray(l)){var m=Math.min(l.length,c.length);for(h=0;h<m;h++){n.relinkPrivateKeys(c[h],l[h])}}return c}},{"../lib":161,"../plot_api/plot_template":195}],202:[function(e,t,r){"use strict";var n=e("../components/fx/attributes");t.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:true},visible:{valType:"enumerated",values:[true,false,"legendonly"],dflt:true,editType:"calc"},showlegend:{valType:"boolean",dflt:true,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot"},ids:{valType:"data_array",editType:"calc"},customdata:{valType:"data_array",editType:"calc"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:true,dflt:"all",editType:"none"},hoverlabel:n.hoverlabel,stream:{token:{valType:"string",noBlank:true,strict:true,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"}}},{"../components/fx/attributes":76}],203:[function(e,t,r){"use strict";t.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],204:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");var a=e("../../constants/numerical").FP_SAFE;t.exports={getAutoRange:o,makePadFn:s,doAutoRange:l,expand:c};function o(e){var t=[];var r=e._min[0].val;var n=e._max[0].val;var a=0;var o=false;var l=s(e);var u,c,f,h,p,d,v,m;for(u=1;u<e._min.length;u++){if(r!==n)break;r=Math.min(r,e._min[u].val)}for(u=1;u<e._max.length;u++){if(r!==n)break;n=Math.max(n,e._max[u].val)}if(e.range){var g=i.simpleMap(e.range,e.r2l);o=g[1]<g[0]}if(e.autorange==="reversed"){o=true;e.autorange=true}for(u=0;u<e._min.length;u++){f=e._min[u];for(c=0;c<e._max.length;c++){h=e._max[c];m=h.val-f.val;v=e._length-l(f)-l(h);if(m>0&&v>0&&m/v>a){p=f;d=h;a=m/v}}}if(r===n){var y=r-1;var _=r+1;if(e.rangemode==="tozero"){t=r<0?[y,0]:[0,_]}else if(e.rangemode==="nonnegative"){t=[Math.max(0,y),Math.max(0,_)]}else{t=[y,_]}}else if(a){if(e.type==="linear"||e.type==="-"){if(e.rangemode==="tozero"){if(p.val>=0){p={val:0,pad:0}}if(d.val<=0){d={val:0,pad:0}}}else if(e.rangemode==="nonnegative"){if(p.val-a*l(p)<0){p={val:0,pad:0}}if(d.val<0){d={val:1,pad:0}}}a=(d.val-p.val)/(e._length-l(p)-l(d))}t=[p.val-a*l(p),d.val+a*l(d)]}if(t[0]===t[1]){if(e.rangemode==="tozero"){if(t[0]<0){t=[t[0],0]}else if(t[0]>0){t=[0,t[0]]}else{t=[0,1]}}else{t=[t[0]-1,t[0]+1];if(e.rangemode==="nonnegative"){t[0]=Math.max(0,t[0])}}}if(o)t.reverse();return i.simpleMap(t,e.l2r||Number)}function s(e){var t=e._length/20;if(e.constrain==="domain"&&e._inputDomain){t*=(e._inputDomain[1]-e._inputDomain[0])/(e.domain[1]-e.domain[0])}return function e(r){return r.pad+(r.extrapad?t:0)}}function l(e){if(!e._length)e.setScale();var t=e._min&&e._max&&e._min.length&&e._max.length;var r;if(e.autorange&&t){e.range=o(e);e._r=e.range.slice();e._rl=i.simpleMap(e._r,e.r2l);r=e._input;r.range=e.range.slice();r.autorange=e.autorange}if(e._anchorAxis&&e._anchorAxis.rangeslider){var n=e._anchorAxis.rangeslider[e._name];if(n){if(n.rangemode==="auto"){if(t){n.range=o(e)}else{n.range=e._rangeInitial?e._rangeInitial.slice():e.range.slice()}}}r=e._anchorAxis._input;r.rangeslider[e._name]=i.extendFlat({},n)}}function u(e){return e.autorange||e._rangesliderAutorange}function c(e,t,r){if(!u(e)||!t)return;if(!e._min)e._min=[];if(!e._max)e._max=[];if(!r)r={};if(!e._m)e.setScale();var i=t.length;var o=r.padded||false;var s=r.tozero&&(e.type==="linear"||e.type==="-");var l=e.type==="log";var c,d,v,m,g,y,_,x,b,w,k,A;var T=false;function M(e){if(Array.isArray(e)){T=true;return function(t){return Math.max(Number(e[t]||0),0)}}else{var t=Math.max(Number(e||0),0);return function(){return t}}}var S=M((e._m>0?r.ppadplus:r.ppadminus)||r.ppad||0);var C=M((e._m>0?r.ppadminus:r.ppadplus)||r.ppad||0);var z=M(r.vpadplus||r.vpad);var E=M(r.vpadminus||r.vpad);if(!T){k=Infinity;A=-Infinity;if(l){for(c=0;c<i;c++){m=t[c];if(m<k&&m>0)k=m;if(m>A&&m<a)A=m}}else{for(c=0;c<i;c++){m=t[c];if(m<k&&m>-a)k=m;if(m>A&&m<a)A=m}}t=[k,A];i=2}function L(r){g=t[r];if(!n(g))return;x=S(r);b=C(r);k=g-E(r);A=g+z(r);if(l&&k<A/10)k=A/10;y=e.c2l(k);_=e.c2l(A);if(s){y=Math.min(0,y);_=Math.max(0,_)}for(v=0;v<2;v++){var i=v?_:y;if(f(i)){var a=v?e._max:e._min;var u=v?x:b;var c=v?p:h;w=true;for(d=0;d<a.length&&w;d++){m=a[d];if(c(m.val,i)&&m.pad>=u&&(m.extrapad||!o)){w=false;break}else if(c(i,m.val)&&m.pad<=u&&(o||!m.extrapad)){a.splice(d,1);d--}}if(w){var T=s&&i===0;a.push({val:i,pad:T?0:u,extrapad:T?false:o})}}}}var I=Math.min(6,i);for(c=0;c<I;c++)L(c);for(c=i-1;c>=I;c--)L(c)}function f(e){return n(e)&&Math.abs(e)<a}function h(e,t){return e<=t}function p(e,t){return e>=t}},{"../../constants/numerical":142,"../../lib":161,"fast-isnumeric":9}],205:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../../plots/plots");var o=e("../../registry");var s=e("../../lib");var l=e("../../lib/svg_text_utils");var u=e("../../components/titles");var c=e("../../components/color");var f=e("../../components/drawing");var h=e("../../constants/numerical");var p=h.ONEAVGYEAR;var d=h.ONEAVGMONTH;var v=h.ONEDAY;var m=h.ONEHOUR;var g=h.ONEMIN;var y=h.ONESEC;var _=h.MINUS_SIGN;var x=h.BADNUM;var b=e("../../constants/alignment").MID_SHIFT;var w=e("../../constants/alignment").LINE_SPACING;var k=t.exports={};k.setConvert=e("./set_convert");var A=e("./axis_autotype");var T=e("./axis_ids");k.id2name=T.id2name;k.name2id=T.name2id;k.cleanId=T.cleanId;k.list=T.list;k.listIds=T.listIds;k.getFromId=T.getFromId;k.getFromTrace=T.getFromTrace;var M=e("./autorange");k.expand=M.expand;k.getAutoRange=M.getAutoRange;k.coerceRef=function(e,t,r,n,i,a){var o=n.charAt(n.length-1);var l=r._fullLayout._subplots[o+"axis"];var u=n+"ref";var c={};if(!i)i=l[0]||a;if(!a)a=i;c[u]={valType:"enumerated",values:l.concat(a?[a]:[]),dflt:i};return s.coerce(e,t,c,u)};k.coercePosition=function(e,t,r,n,i,a){var o,l;if(n==="paper"||n==="pixel"){o=s.ensureNumber;l=r(i,a)}else{var u=k.getFromId(t,n);a=u.fraction2r(a);l=r(i,a);o=u.cleanPos}e[i]=o(l)};k.cleanPosition=function(e,t,r){var n=r==="paper"||r==="pixel"?s.ensureNumber:k.getFromId(t,r).cleanPos;return n(e)};var S=k.getDataConversions=function(e,t,r,n){var i;var a=r==="x"||r==="y"||r==="z"?r:n;if(Array.isArray(a)){i={type:A(n),_categories:[]};k.setConvert(i);if(i.type==="category"){for(var o=0;o<n.length;o++){i.d2c(n[o])}}}else{i=k.getFromTrace(e,t,a)}if(i)return{d2c:i.d2c,c2d:i.c2d};if(a==="ids")return{d2c:z,c2d:z};return{d2c:C,c2d:C}};function C(e){return+e}function z(e){return String(e)}k.getDataToCoordFunc=function(e,t,r,n){return S(e,t,r,n).d2c};k.counterLetter=function(e){var t=e.charAt(0);if(t==="x")return"y";if(t==="y")return"x"};k.minDtick=function(e,t,r,n){if(["log","category"].indexOf(e.type)!==-1||!n){e._minDtick=0}else if(e._minDtick===undefined){e._minDtick=t;e._forceTick0=r}else if(e._minDtick){if((e._minDtick/t+1e-6)%1<2e-6&&((r-e._forceTick0)/t%1+1.000001)%1<2e-6){e._minDtick=t;e._forceTick0=r}else if((t/e._minDtick+1e-6)%1>2e-6||((r-e._forceTick0)/e._minDtick%1+1.000001)%1>2e-6){e._minDtick=0}}};k.saveRangeInitial=function(e,t){var r=k.list(e,"",true),n=false;for(var i=0;i<r.length;i++){var a=r[i];var o=a._rangeInitial===undefined;var s=o||!(a.range[0]===a._rangeInitial[0]&&a.range[1]===a._rangeInitial[1]);if(o&&a.autorange===false||t&&s){a._rangeInitial=a.range.slice();n=true}}return n};k.saveShowSpikeInitial=function(e,t){var r=k.list(e,"",true),n=false,i="on";for(var a=0;a<r.length;a++){var o=r[a];var s=o._showSpikeInitial===undefined;var l=s||!(o.showspikes===o._showspikes);if(s||t&&l){o._showSpikeInitial=o.showspikes;n=true}if(i==="on"&&!o.showspikes){i="off"}}e._fullLayout._cartesianSpikesEnabled=i;return n};k.autoBin=function(e,t,r,n,a){var o=s.aggNums(Math.min,null,e),l=s.aggNums(Math.max,null,e);if(!a)a=t.calendar;if(t.type==="category"){return{start:o-.5,end:l+.5,size:1,_dataSpan:l-o}}var u;if(r)u=(l-o)/r;else{var c=s.distinctVals(e),f=Math.pow(10,Math.floor(Math.log(c.minDiff)/Math.LN10)),h=f*s.roundUp(c.minDiff/f,[.9,1.9,4.9,9.9],true);u=Math.max(h,2*s.stdev(e)/Math.pow(e.length,n?.25:.4));if(!i(u))u=1}var p;if(t.type==="log"){p={type:"linear",range:[o,l]}}else{p={type:t.type,range:s.simpleMap([o,l],t.c2r,0,a),calendar:a}}k.setConvert(p);k.autoTicks(p,u);var d=k.tickIncrement(k.tickFirst(p),p.dtick,"reverse",a);var v,m;if(typeof p.dtick==="number"){d=E(d,e,p,o,l);m=1+Math.floor((l-d)/p.dtick);v=d+m*p.dtick}else{if(p.dtick.charAt(0)==="M"){d=L(d,e,p.dtick,o,a)}v=d;m=0;while(v<=l){v=k.tickIncrement(v,p.dtick,false,a);m++}}return{start:t.c2r(d,0,a),end:t.c2r(v,0,a),size:p.dtick,_dataSpan:l-o}};function E(e,t,r,n,a){var o=0,s=0,l=0,u=0;function c(t){return(1+(t-e)*100/r.dtick)%100<2}for(var f=0;f<t.length;f++){if(t[f]%1===0)l++;else if(!i(t[f]))u++;if(c(t[f]))o++;if(c(t[f]+r.dtick/2))s++}var h=t.length-u;if(l===h&&r.type!=="date"){if(r.dtick<1){e=n-.5*r.dtick}else{e-=.5;if(e+r.dtick<n)e+=r.dtick}}else if(s<h*.1){if(o>h*.3||c(n)||c(a)){var p=r.dtick/2;e+=e+p<n?p:-p}}return e}function L(e,t,r,n,i){var a=s.findExactDates(t,i);var o=.8;if(a.exactDays>o){var l=Number(r.substr(1));if(a.exactYears>o&&l%12===0){e=k.tickIncrement(e,"M6","reverse")+v*1.5}else if(a.exactMonths>o){e=k.tickIncrement(e,"M1","reverse")+v*15.5}else{e-=v/2}var u=k.tickIncrement(e,r);if(u<=n)return u}return e}k.prepTicks=function(e){var t=s.simpleMap(e.range,e.r2l);if(e.tickmode==="auto"||!e.dtick){var r=e.nticks,n;if(!r){if(e.type==="category"){n=e.tickfont?(e.tickfont.size||12)*1.2:15;r=e._length/n}else{n=e._id.charAt(0)==="y"?40:80;r=s.constrain(e._length/n,4,9)+1}if(e._name==="radialaxis")r*=2}if(e.tickmode==="array")r*=100;k.autoTicks(e,Math.abs(t[1]-t[0])/r);if(e._minDtick>0&&e.dtick<e._minDtick*2){e.dtick=e._minDtick;e.tick0=e.l2r(e._forceTick0)}}if(!e.tick0){e.tick0=e.type==="date"?"2000-01-01":0}V(e)};k.calcTicks=function e(t){k.prepTicks(t);var r=s.simpleMap(t.range,t.r2l);if(t.tickmode==="array")return I(t);t._tmin=k.tickFirst(t);var n=r[0]*1.0001-r[1]*1e-4;var i=r[1]*1.0001-r[0]*1e-4;var a=r[1]<r[0];if(t._tmin<n!==a)return[];var o=[];if(t.type==="category"){i=a?Math.max(-.5,i):Math.min(t._categories.length-.5,i)}var l=null;var u=Math.max(1e3,t._length||0);for(var c=t._tmin;a?c>=i:c<=i;c=k.tickIncrement(c,t.dtick,a,t.calendar)){if(o.length>u||c===l)break;l=c;o.push(c)}if(t._id==="angular"&&Math.abs(r[1]-r[0])===360){o.pop()}t._tmax=o[o.length-1];t._prevDateHead="";t._inCalcTicks=true;var f=new Array(o.length);for(var h=0;h<o.length;h++)f[h]=k.tickText(t,o[h]);t._inCalcTicks=false;return f};function I(e){var t=e.tickvals,r=e.ticktext,n=new Array(t.length),i=s.simpleMap(e.range,e.r2l),a=i[0]*1.0001-i[1]*1e-4,o=i[1]*1.0001-i[0]*1e-4,l=Math.min(a,o),u=Math.max(a,o),c,f,h=0;if(!Array.isArray(r))r=[];var p=e.type==="category"?e.d2l_noadd:e.d2l;if(e.type==="log"&&String(e.dtick).charAt(0)!=="L"){e.dtick="L"+Math.pow(10,Math.floor(Math.min(e.range[0],e.range[1]))-1)}for(f=0;f<t.length;f++){c=p(t[f]);if(c>l&&c<u){if(r[f]===undefined)n[h]=k.tickText(e,c);else n[h]=q(e,c,String(r[f]));h++}}if(h<t.length)n.splice(h,t.length-h);return n}var P=[2,5,10],D=[1,2,3,6,12],O=[1,2,5,10,15,30],R=[1,2,3,7,14],F=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],B=[-.301,0,.301,.699,1],N=[15,30,45,90,180];function j(e,t,r){return t*s.roundUp(e/t,r)}k.autoTicks=function(e,t){var r;function n(e){return Math.pow(e,Math.floor(Math.log(t)/Math.LN10))}if(e.type==="date"){e.tick0=s.dateTick0(e.calendar);var a=2*t;if(a>p){t/=p;r=n(10);e.dtick="M"+12*j(t,r,P)}else if(a>d){t/=d;e.dtick="M"+j(t,1,D)}else if(a>v){e.dtick=j(t,v,R);e.tick0=s.dateTick0(e.calendar,true)}else if(a>m){e.dtick=j(t,m,D)}else if(a>g){e.dtick=j(t,g,O)}else if(a>y){e.dtick=j(t,y,O)}else{r=n(10);e.dtick=j(t,r,P)}}else if(e.type==="log"){e.tick0=0;var o=s.simpleMap(e.range,e.r2l);if(t>.7){e.dtick=Math.ceil(t)}else if(Math.abs(o[1]-o[0])<1){var l=1.5*Math.abs((o[1]-o[0])/t);t=Math.abs(Math.pow(10,o[1])-Math.pow(10,o[0]))/l;r=n(10);e.dtick="L"+j(t,r,P)}else{e.dtick=t>.3?"D2":"D1"}}else if(e.type==="category"){e.tick0=0;e.dtick=Math.ceil(Math.max(t,1))}else if(e._id==="angular"){e.tick0=0;r=1;e.dtick=j(t,r,N)}else{e.tick0=0;r=n(10);e.dtick=j(t,r,P)}if(e.dtick===0)e.dtick=1;if(!i(e.dtick)&&typeof e.dtick!=="string"){var u=e.dtick;e.dtick=1;throw"ax.dtick error: "+String(u)}};function V(e){var t=e.dtick;e._tickexponent=0;if(!i(t)&&typeof t!=="string"){t=1}if(e.type==="category"){e._tickround=null}if(e.type==="date"){var r=e.r2l(e.tick0),n=e.l2r(r).replace(/(^-|i)/g,""),a=n.length;if(String(t).charAt(0)==="M"){if(a>10||n.substr(5)!=="01-01")e._tickround="d";else e._tickround=+t.substr(1)%12===0?"y":"m"}else if(t>=v&&a<=10||t>=v*15)e._tickround="d";else if(t>=g&&a<=16||t>=m)e._tickround="M";else if(t>=y&&a<=19||t>=g)e._tickround="S";else{var o=e.l2r(r+t).replace(/^-/,"").length;e._tickround=Math.max(a,o)-20}}else if(i(t)||t.charAt(0)==="L"){var s=e.range.map(e.r2d||Number);if(!i(t))t=Number(t.substr(1));e._tickround=2-Math.floor(Math.log(t)/Math.LN10+.01);var l=Math.max(Math.abs(s[0]),Math.abs(s[1]));var u=Math.floor(Math.log(l)/Math.LN10+.01);if(Math.abs(u)>3){if(Y(e.exponentformat)&&!J(u)){e._tickexponent=3*Math.round((u-1)/3)}else e._tickexponent=u}}else e._tickround=null}k.tickIncrement=function(e,t,r,a){var o=r?-1:1;if(i(t))return e+o*t;var l=t.charAt(0),u=o*Number(t.substr(1));if(l==="M")return s.incrementMonth(e,u,a);else if(l==="L")return Math.log(Math.pow(10,e)+u)/Math.LN10;else if(l==="D"){var c=t==="D2"?B:F,f=e+o*.01,h=s.roundUp(s.mod(f,1),c,r);return Math.floor(f)+Math.log(n.round(Math.pow(10,h),1))/Math.LN10}else throw"unrecognized dtick "+String(t)};k.tickFirst=function(e){var t=e.r2l||Number,r=s.simpleMap(e.range,t),a=r[1]<r[0],o=a?Math.floor:Math.ceil,l=r[0]*1.0001-r[1]*1e-4,u=e.dtick,c=t(e.tick0);if(i(u)){var f=o((l-c)/u)*u+c;if(e.type==="category"){f=s.constrain(f,0,e._categories.length-1)}return f}var h=u.charAt(0),p=Number(u.substr(1));if(h==="M"){var d=0,v=c,m,g,y;while(d<10){m=k.tickIncrement(v,u,a,e.calendar);if((m-l)*(v-l)<=0){if(a)return Math.min(v,m);return Math.max(v,m)}g=(l-(v+m)/2)/(m-v);y=h+(Math.abs(Math.round(g))||1)*p;v=k.tickIncrement(v,y,g<0?!a:a,e.calendar);d++}s.error("tickFirst did not converge",e);return v}else if(h==="L"){return Math.log(o((Math.pow(10,l)-c)/p)*p+c)/Math.LN10}else if(h==="D"){var _=u==="D2"?B:F,x=s.roundUp(s.mod(l,1),_,a);return Math.floor(l)+Math.log(n.round(Math.pow(10,x),1))/Math.LN10}else throw"unrecognized dtick "+String(u)};k.tickText=function(e,t,r){var n=q(e,t),i,a=e.tickmode==="array",o=r||a,l,u=e.type==="category"?e.d2l_noadd:e.d2l;if(a&&Array.isArray(e.ticktext)){var c=s.simpleMap(e.range,e.r2l),f=Math.abs(c[1]-c[0])/1e4;for(l=0;l<e.ticktext.length;l++){if(Math.abs(t-u(e.tickvals[l]))<f)break}if(l<e.ticktext.length){n.text=String(e.ticktext[l]);return n}}function h(n){var i;if(n===undefined)return true;if(r)return n==="none";i={first:e._tmin,last:e._tmax}[n];return n!=="all"&&t!==i}if(r){i="never"}else{i=e.exponentformat!=="none"&&h(e.showexponent)?"hide":""}if(e.type==="date")U(e,n,r,o);else if(e.type==="log")Z(e,n,r,o,i);else if(e.type==="category")H(e,n);else if(e._id==="angular")$(e,n,r,o,i);else G(e,n,r,o,i);if(e.tickprefix&&!h(e.showtickprefix))n.text=e.tickprefix+n.text;if(e.ticksuffix&&!h(e.showticksuffix))n.text+=e.ticksuffix;return n};k.hoverLabelText=function(e,t,r){if(r!==x&&r!==t){return k.hoverLabelText(e,t)+" - "+k.hoverLabelText(e,r)}var n=e.type==="log"&&t<=0;var i=k.tickText(e,e.c2l(n?-t:t),"hover").text;if(n){return t===0?"0":_+i}return i};function q(e,t,r){var n=e.tickfont||{};return{x:t,dx:0,dy:0,text:r||"",fontSize:n.size,font:n.family,fontColor:n.color}}function U(e,t,r,n){var a=e._tickround,o=r&&e.hoverformat||k.getTickFormat(e);if(n){if(i(a))a=4;else a={y:"m",m:"d",d:"M",M:"S",S:4}[a]}var l=s.formatDate(t.x,o,a,e._dateFormat,e.calendar,e._extraFormat),u;var c=l.indexOf("\n");if(c!==-1){u=l.substr(c+1);l=l.substr(0,c)}if(n){if(l==="00:00:00"||l==="00:00"){l=u;u=""}else if(l.length===8){l=l.replace(/:00$/,"")}}if(u){if(r){if(a==="d")l+=", "+u;else l=u+(l?", "+l:"")}else if(!e._inCalcTicks||u!==e._prevDateHead){l+="<br>"+u;e._prevDateHead=u}}t.text=l}function Z(e,t,r,n,a){var o=e.dtick,l=t.x,u=e.tickformat;if(a==="never"){a=""}if(n&&(typeof o!=="string"||o.charAt(0)!=="L"))o="L3";if(u||typeof o==="string"&&o.charAt(0)==="L"){t.text=K(Math.pow(10,l),e,a,n)}else if(i(o)||o.charAt(0)==="D"&&s.mod(l+.01,1)<.1){var c=Math.round(l);if(["e","E","power"].indexOf(e.exponentformat)!==-1||Y(e.exponentformat)&&J(c)){if(c===0)t.text=1;else if(c===1)t.text="10";else if(c>1)t.text="10<sup>"+c+"</sup>";else t.text="10<sup>"+_+-c+"</sup>";t.fontSize*=1.25}else{t.text=K(Math.pow(10,l),e,"","fakehover");if(o==="D1"&&e._id.charAt(0)==="y"){t.dy-=t.fontSize/6}}}else if(o.charAt(0)==="D"){t.text=String(Math.round(Math.pow(10,s.mod(l,1))));t.fontSize*=.75}else throw"unrecognized dtick "+String(o);if(e.dtick==="D1"){var f=String(t.text).charAt(0);if(f==="0"||f==="1"){if(e._id.charAt(0)==="y"){t.dx-=t.fontSize/4}else{t.dy+=t.fontSize/2;t.dx+=(e.range[1]>e.range[0]?1:-1)*t.fontSize*(l<0?.5:.25)}}}}function H(e,t){var r=e._categories[Math.round(t.x)];if(r===undefined)r="";t.text=String(r)}function G(e,t,r,n,i){if(i==="never"){i=""}else if(e.showexponent==="all"&&Math.abs(t.x/e.dtick)<1e-6){i="hide"}t.text=K(t.x,e,i,n)}function $(e,t,r,n,i){if(e.thetaunit==="radians"&&!r){var a=t.x/180;if(a===0){t.text="0"}else{var o=W(a);if(o[1]>=100){t.text=K(s.deg2rad(t.x),e,i,n)}else{var l=t.x<0;if(o[1]===1){if(o[0]===1)t.text="\u03c0";else t.text=o[0]+"\u03c0"}else{t.text=["<sup>",o[0],"</sup>","\u2044","<sub>",o[1],"</sub>","\u03c0"].join("")}if(l)t.text=_+t.text}}}else{t.text=K(t.x,e,i,n)}}function W(e){function t(e,t){return Math.abs(e-t)<=1e-6}function r(e,n){return t(n,0)?e:r(n,e%n)}function n(e){var r=1;while(!t(Math.round(e*r)/r,e)){r*=10}return r}var i=n(e);var a=e*i;var o=Math.abs(r(a,i));return[Math.round(a/o),Math.round(i/o)]}var X=["f","p","n","\u03bc","m","","k","M","G","T"];function Y(e){return e==="SI"||e==="B"}function J(e){return e>14||e<-15}function K(e,t,r,n){var a=e<0,o=t._tickround,l=r||t.exponentformat||"B",u=t._tickexponent,c=k.getTickFormat(t),f=t.separatethousands;if(n){var h={exponentformat:l,dtick:t.showexponent==="none"?t.dtick:i(e)?Math.abs(e)||1:1,range:t.showexponent==="none"?t.range.map(t.r2d):[0,e||1]};V(h);o=(Number(h._tickround)||0)+4;u=h._tickexponent;if(t.hoverformat)c=t.hoverformat}if(c)return t._numFormat(c)(e).replace(/-/g,_);var p=Math.pow(10,-o)/2;if(l==="none")u=0;e=Math.abs(e);if(e<p){e="0";a=false}else{e+=p;if(u){e*=Math.pow(10,-u);o+=u}if(o===0)e=String(Math.floor(e));else if(o<0){e=String(Math.round(e));e=e.substr(0,e.length+o);for(var d=o;d<0;d++)e+="0"}else{e=String(e);var v=e.indexOf(".")+1;if(v)e=e.substr(0,v+o).replace(/\.?0+$/,"")}e=s.numSeparate(e,t._separators,f)}if(u&&l!=="hide"){if(Y(l)&&J(u))l="power";var m;if(u<0)m=_+-u;else if(l!=="power")m="+"+u;else m=String(u);if(l==="e"){e+="e"+m}else if(l==="E"){e+="E"+m}else if(l==="power"){e+="\xd710<sup>"+m+"</sup>"}else if(l==="B"&&u===9){e+="B"}else if(Y(l)){e+=X[u/3+5]}}if(a)return _+e;return e}k.getTickFormat=function(e){var t;function r(e){return typeof e!=="string"?e:Number(e.replace("M",""))*d}function n(e,t){var r=["L","D"];if(typeof e===typeof t){if(typeof e==="number"){return e-t}else{var n=r.indexOf(e.charAt(0));var i=r.indexOf(t.charAt(0));if(n===i){return Number(e.replace(/(L|D)/g,""))-Number(t.replace(/(L|D)/g,""))}else{return n-i}}}else{return typeof e==="number"?1:-1}}function i(e,t,r){var n=r||function(e){return e};var i=t[0];var a=t[1];return(!i&&typeof i!=="number"||n(i)<=n(e))&&(!a&&typeof a!=="number"||n(a)>=n(e))}function a(e,t){var r=t[0]===null;var i=t[1]===null;var a=n(e,t[0])>=0;var o=n(e,t[1])<=0;return(r||a)&&(i||o)}var o,s;if(e.tickformatstops&&e.tickformatstops.length>0){switch(e.type){case"date":case"linear":{for(t=0;t<e.tickformatstops.length;t++){s=e.tickformatstops[t];if(s.enabled&&i(e.dtick,s.dtickrange,r)){o=s;break}}break}case"log":{for(t=0;t<e.tickformatstops.length;t++){s=e.tickformatstops[t];if(s.enabled&&a(e.dtick,s.dtickrange)){o=s;break}}break}default:}}return o?o.value:e.tickformat};k.getSubplots=function(e,t){var r=e._fullLayout._subplots;var n=r.cartesian.concat(r.gl2d||[]);var i=t?k.findSubplotsWithAxis(n,t):n;i.sort(function(e,t){var r=e.substr(1).split("y");var n=t.substr(1).split("y");if(r[0]===n[0])return+r[1]-+n[1];return+r[0]-+n[0]});return i};k.findSubplotsWithAxis=function(e,t){var r=new RegExp(t._id.charAt(0)==="x"?"^"+t._id+"y":t._id+"$");var n=[];for(var i=0;i<e.length;i++){var a=e[i];if(r.test(a))n.push(a)}return n};k.makeClipPaths=function(e){var t=e._fullLayout;if(t._hasOnlyLargeSploms)return;var r={_offset:0,_length:t.width,_id:""};var i={_offset:0,_length:t.height,_id:""};var a=k.list(e,"x",true);var o=k.list(e,"y",true);var s=[];var l,u;for(l=0;l<a.length;l++){s.push({x:a[l],y:i});for(u=0;u<o.length;u++){if(l===0)s.push({x:r,y:o[u]});s.push({x:a[l],y:o[u]})}}var c=t._clips.selectAll(".axesclip").data(s,function(e){return e.x._id+e.y._id});c.enter().append("clipPath").classed("axesclip",true).attr("id",function(e){return"clip"+t._uid+e.x._id+e.y._id}).append("rect");c.exit().remove();c.each(function(e){n.select(this).select("rect").attr({x:e.x._offset||0,y:e.y._offset||0,width:e.x._length||1,height:e.y._length||1})})};k.doTicks=function(e,t,r){var n=e._fullLayout;if(t==="redraw"){n._paper.selectAll("g.subplot").each(function(e){var t=n._plots[e];var r=t.xaxis;var i=t.yaxis;t.xaxislayer.selectAll("."+r._id+"tick").remove();t.yaxislayer.selectAll("."+i._id+"tick").remove();if(t.gridlayer)t.gridlayer.selectAll("path").remove();if(t.zerolinelayer)t.zerolinelayer.selectAll("path").remove();n._infolayer.select(".g-"+r._id+"title").remove();n._infolayer.select(".g-"+i._id+"title").remove()})}var i=!t||t==="redraw"?k.listIds(e):t;s.syncOrAsync(i.map(function(t){return function(){if(!t)return;var n=k.doTicksSingle(e,t,r);var i=k.getFromId(e,t);i._r=i.range.slice();i._rl=s.simpleMap(i._r,i.r2l);return n}}))};k.doTicksSingle=function(e,t,r){var h=e._fullLayout;var p=false;var d;if(s.isPlainObject(t)){d=t;p=true}else{d=k.getFromId(e,t)}d.setScale();var v=d._id;var m=v.charAt(0);var g=k.counterLetter(v);var y=d._vals=k.calcTicks(d);var _=function(e){return[e.text,e.x,d.mirror,e.font,e.fontSize,e.fontColor].join("_")};var x=v+"tick";var A=v+"grid";var M=v+"zl";var S=(d.linewidth||1)/2;var C=d.ticks==="outside"?d.ticklen:0;var z=0;var E=f.crispRound(e,d.gridwidth,1);var L=f.crispRound(e,d.zerolinewidth,E);var I=f.crispRound(e,d.tickwidth,1);var P,D,O,R;var F;var B;if(d._counterangle&&d.ticks==="outside"){var N=d._counterangle*Math.PI/180;C=d.ticklen*Math.cos(N)+1;z=d.ticklen*Math.sin(N)}if(d.showticklabels&&(d.ticks==="outside"||d.showline)){C+=.2*d.tickfont.size}if(m==="x"){P=["bottom","top"];D=d._transfn||function(e){return"translate("+(d._offset+d.l2p(e.x))+",0)"};O=function(e,t){if(d._counterangle){var r=d._counterangle*Math.PI/180;return"M0,"+e+"l"+Math.sin(r)*t+","+Math.cos(r)*t}else return"M0,"+e+"v"+t}}else if(m==="y"){P=["left","right"];D=d._transfn||function(e){return"translate(0,"+(d._offset+d.l2p(e.x))+")"};O=function(e,t){if(d._counterangle){var r=d._counterangle*Math.PI/180;return"M"+e+",0l"+Math.cos(r)*t+","+-Math.sin(r)*t}else return"M"+e+",0h"+t}}else if(v==="angular"){P=["left","right"];D=d._transfn;O=function(e,t){return"M"+e+",0h"+t}}else{s.warn("Unrecognized doTicks axis:",v);return}var j=d.side||P[0];var V=[-1,1,j===P[1]?1:-1];if(d.ticks!=="inside"===(m==="x")){V=V.map(function(e){return-e})}if(!d.visible)return;if(d._tickFilter){y=y.filter(d._tickFilter)}function q(e){var t=d.l2p(e.x);return t>1&&t<d._length-1}var U=y.filter(q);if(d._id==="angular"){U=y}function Z(e,t){var r=e.selectAll("path."+x).data(d.ticks==="inside"?U:y,_);if(t&&d.ticks){r.enter().append("path").classed(x,1).classed("ticks",1).classed("crisp",1).call(c.stroke,d.tickcolor).style("stroke-width",I+"px").attr("d",t);r.attr("transform",D);r.exit().remove()}else r.remove()}function H(t,r){F=t.selectAll("g."+x).data(y,_);if(!i(r)){F.remove();G();return}if(!d.showticklabels){F.remove();G();P();return}var o,u,c,p,g;if(m==="x"){g=j==="bottom"?1:-1;o=function(e){return e.dx+z*g};p=r+(C+S)*g;u=function(e){return e.dy+p+e.fontSize*(j==="bottom"?1:-.2)};c=function(e){if(!i(e)||e===0||e===180){return"middle"}return e*g<0?"end":"start"}}else if(m==="y"){g=j==="right"?1:-1;u=function(e){return e.dy+e.fontSize*b-z*g};o=function(e){return e.dx+r+(C+S+(Math.abs(d.tickangle)===90?e.fontSize/2:0))*g};c=function(e){if(i(e)&&Math.abs(e)===90){return"middle"}return j==="right"?"start":"end"}}else if(v==="angular"){d._labelShift=z;d._labelStandoff=C;d._pad=S;o=d._labelx;u=d._labely;c=d._labelanchor}var k=0,A=0,T=[];F.enter().append("g").classed(x,1).append("text").attr("text-anchor","middle").each(function(t){var r=n.select(this),i=e._promises.length;r.call(l.positionText,o(t),u(t)).call(f.font,t.font,t.fontSize,t.fontColor).text(t.text).call(l.convertToTspans,e);i=e._promises[i];if(i){T.push(e._promises.pop().then(function(){E(r,d.tickangle)}))}else{E(r,d.tickangle)}});F.exit().remove();F.each(function(e){k=Math.max(k,e.fontSize)});if(v==="angular"){F.each(function(e){n.select(this).select("text").call(l.positionText,o(e),u(e))})}function M(e,t,r){var n=(e-1)*t;if(m==="x"){if(r<-60||60<r){return-.5*n}else if(j==="top"){return-n}}else{r*=j==="left"?1:-1;if(r<-30){return-n}else if(r<30){return-.5*n}}return 0}function E(e,t){e.each(function(e){var r=c(t,e);var a=n.select(this),s=a.select(".text-math-group"),h=D.call(a.node(),e)+(i(t)&&+t!==0?" rotate("+t+","+o(e)+","+(u(e)-e.fontSize/2)+")":"");var p=M(l.lineCount(a),w*e.fontSize,i(t)?+t:0);if(p){h+=" translate(0, "+p+")"}if(s.empty()){a.select("text").attr({transform:h,"text-anchor":r})}else{var d=f.bBox(s.node()).width*{end:-.5,start:.5}[r];s.attr("transform",h+(d?"translate("+d+",0)":""))}})}E(F,d._lastangle||d.tickangle);function L(){return T.length&&Promise.all(T)}function I(){E(F,d.tickangle);if(m==="x"&&!i(d.tickangle)&&(d.type!=="log"||String(d.dtick).charAt(0)!=="D")){var e=[];F.each(function(t){var r=n.select(this),i=r.select(".text-math-group"),a=d.l2p(t.x);if(i.empty())i=r.select("text");var o=f.bBox(i.node());e.push({top:0,bottom:10,height:10,left:a-o.width/2,right:a+o.width/2+2,width:o.width+2})});for(B=0;B<e.length-1;B++){if(s.bBoxIntersect(e[B],e[B+1])){A=30;break}}if(A){var t=Math.abs((y[y.length-1].x-y[0].x)*d._m)/(y.length-1);if(t<k*2.5){A=90}E(F,A)}d._lastangle=A}G();return v+" done"}function P(){if(d.showticklabels){var r=e.getBoundingClientRect();var n=t.node().getBoundingClientRect();d._boundingBox={width:n.width,height:n.height,left:n.left-r.left,right:n.right-r.left,top:n.top-r.top,bottom:n.bottom-r.top}}else{var i=h._size;var a;if(m==="x"){a=d.anchor==="free"?i.t+i.h*(1-d.position):i.t+i.h*(1-d._anchorAxis.domain[{bottom:0,top:1}[d.side]]);d._boundingBox={top:a,bottom:a,left:d._offset,right:d._offset+d._length,width:d._length,height:0}}else{a=d.anchor==="free"?i.l+i.w*d.position:i.l+i.w*d._anchorAxis.domain[{left:0,right:1}[d.side]];d._boundingBox={left:a,right:a,bottom:d._offset+d._length,top:d._offset,height:d._length,width:0}}}if(R){var o=d._counterSpan=[Infinity,-Infinity];for(B=0;B<R.length;B++){var s=h._plots[R[B]];var l=s[m==="x"?"yaxis":"xaxis"];u(o,[l._offset,l._offset+l._length])}if(d.anchor==="free"){u(o,m==="x"?[d._boundingBox.bottom,d._boundingBox.top]:[d._boundingBox.right,d._boundingBox.left])}}function u(e,t){e[0]=Math.min(e[0],t[0]);e[1]=Math.max(e[1],t[1])}}function O(){var t=d._name+".automargin";if(m!=="x"&&m!=="y"){return}if(!d.automargin){a.autoMargin(e,t);return}var r=d.side[0];var n={x:0,y:0,r:0,l:0,t:0,b:0};if(m==="x"){n.y=d.anchor==="free"?d.position:d._anchorAxis.domain[r==="t"?1:0];n[r]+=d._boundingBox.height}else{n.x=d.anchor==="free"?d.position:d._anchorAxis.domain[r==="r"?1:0];n[r]+=d._boundingBox.width}if(d.title!==h._dfltTitle[m]){n[r]+=d.titlefont.size}a.autoMargin(e,t,n)}var N=s.syncOrAsync([L,I,P,O]);if(N&&N.then)e._promises.push(N);return N}function G(){if(r)return;if(d.rangeslider&&d.rangeslider.visible&&d._boundingBox&&d.side==="bottom")return;var t={selection:F,side:d.side};var n=v.charAt(0);var i=e._fullLayout._size;var a=1.5;var o=d.titlefont.size;var s,l,c,p;if(F.size()){var m=f.getTranslate(F.node().parentNode);t.offsetLeft=m.x;t.offsetTop=m.y}var g=10+o*a+(d.linewidth?d.linewidth-1:0);if(n==="x"){l=d.anchor==="free"?{_offset:i.t+(1-(d.position||0))*i.h,_length:0}:T.getFromId(e,d.anchor);c=d._offset+d._length/2;if(d.side==="top"){p=-g-o*(d.showticklabels?1:0)}else{p=l._length+g+o*(d.showticklabels?1.5:.5)}p+=l._offset;if(!t.side)t.side="bottom"}else{l=d.anchor==="free"?{_offset:i.l+(d.position||0)*i.w,_length:0}:T.getFromId(e,d.anchor);p=d._offset+d._length/2;if(d.side==="right"){c=l._length+g+o*(d.showticklabels?1:.5)}else{c=-g-o*(d.showticklabels?.5:0)}c+=l._offset;s={rotate:"-90",offset:0};if(!t.side)t.side="left"}u.draw(e,v+"title",{propContainer:d,propName:d._name+".title",placeholder:h._dfltTitle[n],avoid:t,transform:s,attributes:{x:c,y:p,"text-anchor":"middle"}})}function $(e,t){if(e.visible!==true||e.xaxis+e.yaxis!==t)return false;if(o.traceIs(e,"bar")&&e.orientation==={x:"h",y:"v"}[m])return true;return e.fill&&e.fill.charAt(e.fill.length-1)===m}function W(t,r,i){if(h._hasOnlyLargeSploms)return;var a=t.gridlayer.selectAll("."+v);var o=t.zerolinelayer;var l=t["hidegrid"+m]?[]:U;var u=d._gridpath||(m==="x"?"M0,"+r._offset+"v":"M"+r._offset+",0h")+r._length;var f=a.selectAll("path."+A).data(d.showgrid===false?[]:l,_);f.enter().append("path").classed(A,1).classed("crisp",1).attr("d",u).each(function(e){if(d.zeroline&&(d.type==="linear"||d.type==="-")&&Math.abs(e.x)<d.dtick/100){n.select(this).remove()}});f.attr("transform",D).call(c.stroke,d.gridcolor||"#ddd").style("stroke-width",E+"px");if(typeof u==="function")f.attr("d",u);f.exit().remove();if(o){var p=false;for(var g=0;g<e._fullData.length;g++){if($(e._fullData[g],i)){p=true;break}}var y=s.simpleMap(d.range,d.r2l),x=y[0]*y[1]<=0&&d.zeroline&&(d.type==="linear"||d.type==="-")&&l.length&&(p||q({x:0})||!d.showline);var b=o.selectAll("path."+M).data(x?[{x:0,id:v}]:[]);b.enter().append("path").classed(M,1).classed("zl",1).classed("crisp",1).attr("d",u).each(function(){o.selectAll("path").sort(function(e,t){return T.idSort(e.id,t.id)})});b.attr("transform",D).call(c.stroke,d.zerolinecolor||c.defaultLine).style("stroke-width",L+"px");b.exit().remove()}}if(p){Z(d._axislayer,O(d._pos+S*V[2],V[2]*d.ticklen));if(d._counteraxis){var X={gridlayer:d._gridlayer,zerolinelayer:d._zerolinelayer};W(X,d._counteraxis)}return H(d._axislayer,d._pos)}else if(h._has("cartesian")){R=k.getSubplots(e,d);var Y={};R.map(function(e){var t=h._plots[e];var r=t[g+"axis"];var n=r._mainAxis._id;if(Y[n])return;Y[n]=1;W(t,r,e)});var J=d._mainSubplot;var K=h._plots[J];var Q=[];if(d.ticks){var ee=V[2];var te=O(d._mainLinePosition+S*ee,ee*d.ticklen);if(d._anchorAxis&&d.mirror&&d.mirror!==true){te+=O(d._mainMirrorPosition-S*ee,-ee*d.ticklen)}Z(K[m+"axislayer"],te);Q=Object.keys(d._linepositions||{})}Q.map(function(e){var t=h._plots[e];var r=t[m+"axislayer"];var n=d._linepositions[e]||[];function i(e){var t=V[e];return O(n[e]+S*t,t*d.ticklen)}Z(r,i(0)+i(1))});var re=K[m+"axislayer"];return H(re,d._mainLinePosition)}};k.allowAutoMargin=function(e){var t=k.list(e,"",true);for(var r=0;r<t.length;r++){var n=t[r];if(n.automargin){a.allowAutoMargin(e,n._name+".automargin")}if(n.rangeslider&&n.rangeslider.visible){a.allowAutoMargin(e,"rangeslider"+n._id)}}};k.swap=function(e,t){var r=Q(e,t);for(var n=0;n<r.length;n++){te(e,r[n].x,r[n].y)}};function Q(e,t){var r=[],n,i;for(n=0;n<t.length;n++){var a=[],o=e._fullData[t[n]].xaxis,s=e._fullData[t[n]].yaxis;if(!o||!s)continue;for(i=0;i<r.length;i++){if(r[i].x.indexOf(o)!==-1||r[i].y.indexOf(s)!==-1){a.push(i)}}if(!a.length){r.push({x:[o],y:[s]});continue}var l=r[a[0]],u;if(a.length>1){for(i=1;i<a.length;i++){u=r[a[i]];ee(l.x,u.x);ee(l.y,u.y)}}ee(l.x,[o]);ee(l.y,[s])}return r}function ee(e,t){for(var r=0;r<t.length;r++){if(e.indexOf(t[r])===-1)e.push(t[r])}}function te(e,t,r){var n,i,a=[],o=[],l=e.layout;for(n=0;n<t.length;n++)a.push(k.getFromId(e,t[n]));for(n=0;n<r.length;n++)o.push(k.getFromId(e,r[n]));var u=Object.keys(a[0]),c=["anchor","domain","overlaying","position","side","tickangle"],f=["linear","log"];for(n=0;n<u.length;n++){var h=u[n],p=a[0][h],d=o[0][h],v=true,m=false,g=false;if(h.charAt(0)==="_"||typeof p==="function"||c.indexOf(h)!==-1){continue}for(i=1;i<a.length&&v;i++){var y=a[i][h];if(h==="type"&&f.indexOf(p)!==-1&&f.indexOf(y)!==-1&&p!==y){m=true}else if(y!==p)v=false}for(i=1;i<o.length&&v;i++){var _=o[i][h];if(h==="type"&&f.indexOf(d)!==-1&&f.indexOf(_)!==-1&&d!==_){g=true}else if(o[i][h]!==d)v=false}if(v){if(m)l[a[0]._name].type="linear";if(g)l[o[0]._name].type="linear";re(l,h,a,o,e._fullLayout._dfltTitle)}}for(n=0;n<e._fullLayout.annotations.length;n++){var x=e._fullLayout.annotations[n];if(t.indexOf(x.xref)!==-1&&r.indexOf(x.yref)!==-1){s.swapAttrs(l.annotations[n],["?"])}}}function re(e,t,r,n,i){var a=s.nestedProperty,o=a(e[r[0]._name],t).get(),l=a(e[n[0]._name],t).get(),u;if(t==="title"){if(o===i.x){o=i.y}if(l===i.y){l=i.x}}for(u=0;u<r.length;u++){a(e,r[u]._name+"."+t).set(l)}for(u=0;u<n.length;u++){a(e,n[u]._name+"."+t).set(o)}}},{"../../components/color":42,"../../components/drawing":67,"../../components/titles":133,"../../constants/alignment":140,"../../constants/numerical":142,"../../lib":161,"../../lib/svg_text_utils":182,"../../plots/plots":244,"../../registry":253,"./autorange":204,"./axis_autotype":206,"./axis_ids":208,"./set_convert":223,d3:6,"fast-isnumeric":9}],206:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");var a=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){if(s(t,r))return"date";if(l(t))return"category";if(o(t))return"linear";else return"-"};function o(e){if(!e)return false;for(var t=0;t<e.length;t++){if(n(e[t]))return true}return false}function s(e,t){var r=0,a=0,o=Math.max(1,(e.length-1)/1e3),s;for(var l=0;l<e.length;l+=o){s=e[Math.round(l)];if(i.isDateTime(s,t))r+=1;if(n(s))a+=1}return r>a*2}function l(e){var t=Math.max(1,(e.length-1)/1e3),r=0,n=0,o;for(var s=0;s<e.length;s+=t){o=e[Math.round(s)];if(i.cleanNumber(o)!==a)r++;else if(typeof o==="string"&&o!==""&&o!=="None")n++}return n>r*2}},{"../../constants/numerical":142,"../../lib":161,"fast-isnumeric":9}],207:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");var a=e("./layout_attributes");var o=e("./tick_value_defaults");var s=e("./tick_mark_defaults");var l=e("./tick_label_defaults");var u=e("./category_order_defaults");var c=e("./line_grid_defaults");var f=e("./set_convert");t.exports=function e(t,r,h,p,d){var v=p.letter;var m=r._id;var g=p.font||{};var y=h("visible",!p.cheateronly);var _=r.type;if(_==="date"){var x=n.getComponentMethod("calendars","handleDefaults");x(t,r,"calendar",p.calendar)}f(r,d);var b=h("autorange",!r.isValidRange(t.range));r._rangesliderAutorange=false;if(b)h("rangemode");h("range");r.cleanRange();u(t,r,h,p);if(_!=="category"&&!p.noHover)h("hoverformat");if(!y)return r;var w=h("color");var k=w!==a.color.dflt?w:g.color;var A=((d._splomAxes||{})[v]||{})[m]||d._dfltTitle[v];h("title",A);i.coerceFont(h,"titlefont",{family:g.family,size:Math.round(g.size*1.2),color:k});o(t,r,h,_);l(t,r,h,_,p);s(t,r,h,p);c(t,r,h,{dfltColor:w,bgColor:p.bgColor,showGrid:p.showGrid,attributes:a});if(r.showline||r.ticks)h("mirror");if(p.automargin)h("automargin");return r}},{"../../lib":161,"../../registry":253,"./category_order_defaults":209,"./layout_attributes":217,"./line_grid_defaults":219,"./set_convert":223,"./tick_label_defaults":224,"./tick_mark_defaults":225,"./tick_value_defaults":226}],208:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("./constants");r.id2name=function e(t){if(typeof t!=="string"||!t.match(i.AX_ID_PATTERN))return;var r=t.substr(1);if(r==="1")r="";return t.charAt(0)+"axis"+r};r.name2id=function e(t){if(!t.match(i.AX_NAME_PATTERN))return;var r=t.substr(5);if(r==="1")r="";return t.charAt(0)+r};r.cleanId=function e(t,r){if(!t.match(i.AX_ID_PATTERN))return;if(r&&t.charAt(0)!==r)return;var n=t.substr(1).replace(/^0+/,"");if(n==="1")n="";return t.charAt(0)+n};r.list=function(e,t,n){var i=e._fullLayout;if(!i)return[];var a=r.listIds(e,t);var o=new Array(a.length);var s;for(s=0;s<a.length;s++){var l=a[s];o[s]=i[l.charAt(0)+"axis"+l.substr(1)]}if(!n){var u=i._subplots.gl3d||[];for(s=0;s<u.length;s++){var c=i[u[s]];if(t)o.push(c[t+"axis"]);else o.push(c.xaxis,c.yaxis,c.zaxis)}}return o};r.listIds=function(e,t){var r=e._fullLayout;if(!r)return[];var n=r._subplots;if(t)return n[t+"axis"];return n.xaxis.concat(n.yaxis)};r.getFromId=function(e,t,n){var i=e._fullLayout;if(n==="x")t=t.replace(/y[0-9]*/,"");else if(n==="y")t=t.replace(/x[0-9]*/,"");return i[r.id2name(t)]};r.getFromTrace=function(e,t,i){var a=e._fullLayout;var o=null;if(n.traceIs(t,"gl3d")){var s=t.scene;if(s.substr(0,5)==="scene"){o=a[s][i+"axis"]}}else{o=r.getFromId(e,t[i+"axis"]||i)}return o};r.idSort=function(e,t){var r=e.charAt(0);var n=t.charAt(0);if(r!==n)return r>n?1:-1;return+(e.substr(1)||1)-+(t.substr(1)||1)}},{"../../registry":253,"./constants":210}],209:[function(e,t,r){"use strict";function n(e,t){var r=t.dataAttr||e._id.charAt(0);var n={};var i;var a,o;if(t.axData){i=t.axData}else{i=[];for(a=0;a<t.data.length;a++){var s=t.data[a];if(s[r+"axis"]===e._id){i.push(s)}}}for(a=0;a<i.length;a++){var l=i[a][r];for(o=0;o<l.length;o++){var u=l[o];if(u!==null&&u!==undefined){n[u]=1}}}return Object.keys(n)}t.exports=function e(t,r,i,a){if(r.type!=="category")return;var o=t.categoryarray;var s=Array.isArray(o)&&o.length>0;var l;if(s)l="array";var u=i("categoryorder",l);var c;if(u==="array"){c=i("categoryarray")}if(!s&&u==="array"){u=r.categoryorder="trace"}if(u==="trace"){r._initialCategories=[]}else if(u==="array"){r._initialCategories=c.slice()}else{c=n(r,a).sort();if(u==="category ascending"){r._initialCategories=c}else if(u==="category descending"){r._initialCategories=c.reverse()}}}},{}],210:[function(e,t,r){"use strict";var n=e("../../lib/regex").counter;t.exports={idRegex:{x:n("x"),y:n("y")},attrRegex:n("[xy]axis"),xAxisMatch:n("xaxis"),yAxisMatch:n("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["heatmaplayer","contourcarpetlayer","contourlayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":176}],211:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./axis_ids").id2name;t.exports=function e(t,r,i,s,l){var u=l._axisConstraintGroups;var c=r._id;var f=c.charAt(0);if(r.fixedrange)return;i("constrain");n.coerce(t,r,{constraintoward:{valType:"enumerated",values:f==="x"?["left","center","right"]:["bottom","middle","top"],dflt:f==="x"?"center":"middle"}},"constraintoward");if(!t.scaleanchor)return;var h=a(u,c,s,l);var p=n.coerce(t,r,{scaleanchor:{valType:"enumerated",values:h.linkableAxes}},"scaleanchor");if(p){var d=i("scaleratio");if(!d)d=r.scaleratio=1;o(u,h.thisGroup,c,p,d)}else if(s.indexOf(t.scaleanchor)!==-1){n.warn("ignored "+r._name+'.scaleanchor: "'+t.scaleanchor+'" to avoid either an infinite loop '+"and possibly inconsistent scaleratios, or because the target"+"axis has fixed range.")}};function a(e,t,r,n){var a=n[i(t)].type;var o,s,l,u;var c=[];for(s=0;s<r.length;s++){l=r[s];if(l===t)continue;u=n[i(l)];if(u.type===a&&!u.fixedrange)c.push(l)}for(o=0;o<e.length;o++){if(e[o][t]){var f=e[o];var h=[];for(s=0;s<c.length;s++){l=c[s];if(!f[l])h.push(l)}return{linkableAxes:h,thisGroup:f}}}return{linkableAxes:c,thisGroup:null}}function o(e,t,r,n,i){var a,o,s,l,u;if(t===null){t={};t[r]=1;u=e.length;e.push(t)}else{u=e.indexOf(t)}var c=Object.keys(t);for(a=0;a<e.length;a++){s=e[a];if(a!==u&&s[n]){var f=s[n];for(o=0;o<c.length;o++){l=c[o];s[l]=f*i*t[l]}e.splice(u,1);return}}if(i!==1){for(o=0;o<c.length;o++){t[c[o]]*=i}}t[n]=1}},{"../../lib":161,"./axis_ids":208}],212:[function(e,t,r){"use strict";var n=e("./axis_ids").id2name;var i=e("./scale_zoom");var a=e("./autorange").makePadFn;var o=e("../../constants/numerical").ALMOST_EQUAL;var s=e("../../constants/alignment").FROM_BL;r.enforce=function e(t){var r=t._fullLayout;var s=r._axisConstraintGroups||[];var u,c,f,h,p,d,v;for(u=0;u<s.length;u++){var m=s[u];var g=Object.keys(m);var y=Infinity;var _=0;var x=Infinity;var b={};var w={};var k=false;for(c=0;c<g.length;c++){f=g[c];w[f]=h=r[n(f)];if(h._inputDomain)h.domain=h._inputDomain.slice();else h._inputDomain=h.domain.slice();if(!h._inputRange)h._inputRange=h.range.slice();h.setScale();b[f]=p=Math.abs(h._m)/m[f];y=Math.min(y,p);if(h.constrain==="domain"||!h._constraintShrinkable){x=Math.min(x,p)}delete h._constraintShrinkable;_=Math.max(_,p);if(h.constrain==="domain")k=true}if(y>o*_&&!k)continue;for(c=0;c<g.length;c++){f=g[c];p=b[f];h=w[f];d=h.constrain;if(p!==x||d==="domain"){v=p/x;if(d==="range"){i(h,v)}else{var A=h._inputDomain;var T=(h.domain[1]-h.domain[0])/(A[1]-A[0]);var M=(h.r2l(h.range[1])-h.r2l(h.range[0]))/(h.r2l(h._inputRange[1])-h.r2l(h._inputRange[0]));v/=T;if(v*M<1){h.domain=h._input.domain=A.slice();i(h,v);continue}if(M<1){h.range=h._input.range=h._inputRange.slice();v*=M}if(h.autorange&&h._min.length&&h._max.length){var S=h.r2l(h.range[0]);var C=h.r2l(h.range[1]);var z=(S+C)/2;var E=z;var L=z;var I=Math.abs(C-z);var P=z-I*v*1.0001;var D=z+I*v*1.0001;var O=a(h);l(h,v);h.setScale();var R=Math.abs(h._m);var F;var B;for(B=0;B<h._min.length;B++){F=h._min[B].val-O(h._min[B])/R;if(F>P&&F<E){E=F}}for(B=0;B<h._max.length;B++){F=h._max[B].val+O(h._max[B])/R;if(F<D&&F>L){L=F}}var N=(L-E)/(2*I);v/=N;E=h.l2r(E);L=h.l2r(L);h.range=h._input.range=S<C?[E,L]:[L,E]}l(h,v)}}}}};r.clean=function e(t,r){if(r._inputDomain){var n=false;var i=r._id;var a=t._fullLayout._axisConstraintGroups;for(var o=0;o<a.length;o++){if(a[o][i]){n=true;break}}if(!n||r.constrain!=="domain"){r._input.domain=r.domain=r._inputDomain;delete r._inputDomain}}};function l(e,t){var r=e._inputDomain;var n=s[e.constraintoward];var i=r[0]+(r[1]-r[0])*n;e.domain=e._input.domain=[i+(r[0]-i)/t,i+(r[1]-i)/t]}},{"../../constants/alignment":140,"../../constants/numerical":142,"./autorange":204,"./axis_ids":208,"./scale_zoom":221}],213:[function(e,t,r){"use strict";var n=e("d3");var i=e("tinycolor2");var a=e("has-passive-events");var o=e("../../registry");var s=e("../../lib");var l=e("../../lib/svg_text_utils");var u=e("../../lib/clear_gl_canvases");var c=e("../../components/color");var f=e("../../components/drawing");var h=e("../../components/fx");var p=e("../../lib/setcursor");var d=e("../../components/dragelement");var v=e("../../constants/alignment").FROM_TL;var m=e("../plots");var g=e("./axes").doTicksSingle;var y=e("./axis_ids").getFromId;var _=e("./select").prepSelect;var x=e("./select").clearSelect;var b=e("./scale_zoom");var w=e("./constants");var k=w.MINDRAG;var A=w.MINZOOM;var T=true;function M(e,t,r,a,c,p,T,M){var S=e._fullLayout._zoomlayer;var B=T+M==="nsew";var W=(T+M).length===1;var X,Y;var J,K;var Q,ee;var te,re;var ne,ie;var ae;var oe,se;var le;var ue;var ce,fe;var he,pe,de,ve;function me(){X=t.xaxis;Y=t.yaxis;ne=X._length;ie=Y._length;te=X._offset;re=Y._offset;J={};J[X._id]=X;K={};K[Y._id]=Y;if(T&&M){var r=t.overlays;for(var n=0;n<r.length;n++){var i=r[n].xaxis;J[i._id]=i;var a=r[n].yaxis;K[a._id]=a}}Q=$(J);ee=$(K);oe=z(Q,M);se=z(ee,T);le=!se&&!oe;ae=H(e,J,K);ue=ae.isSubplotConstrained;ce=M||ue;fe=T||ue;var o=e._fullLayout;he=o._has("scattergl");pe=o._hasOnlyLargeSploms;de=pe||o._has("splom");ve=o._has("svg")}me();var ge=D(se+oe,e._fullLayout.dragmode,B);var ye=C(t,T+M+"drag",ge,r,a,c,p);if(le&&!B){ye.onmousedown=null;ye.style.pointerEvents="none";return ye}var _e={element:ye,gd:e,plotinfo:t};_e.prepFn=function(t,r,n){var i=e._fullLayout.dragmode;me();if(!le){if(B){if(t.shiftKey){if(i==="pan")i="zoom";else if(!V(i))i="pan"}else if(t.ctrlKey){i="pan"}}else i="pan"}if(i==="lasso")_e.minDrag=1;else _e.minDrag=undefined;if(V(i)){_e.xaxes=Q;_e.yaxes=ee;_(t,r,n,_e,i)}else{_e.clickFn=be;xe();if(!le){if(i==="zoom"){_e.moveFn=De;_e.doneFn=Oe;_e.minDrag=1;Pe(t,r,n)}else if(i==="pan"){_e.moveFn=Ve;_e.doneFn=Ze}}}};function xe(){_e.plotinfo.selection=false;x(S)}function be(r,i){N(e);if(r===2&&!W)Ue();if(B){h.click(e,i,t.id)}else if(r===1&&W){var a=T?Y:X,s=T==="s"||M==="w"?0:1,u=a._name+".range["+s+"]",c=E(a,s),f="left",p="middle";if(a.fixedrange)return;if(T){p=T==="n"?"top":"bottom";if(a.side==="right")f="right"}else if(M==="e")f="right";if(e._context.showAxisRangeEntryBoxes){n.select(ye).call(l.makeEditable,{gd:e,immediate:true,background:e._fullLayout.paper_bgcolor,text:String(c),fill:a.tickfont?a.tickfont.color:"#444",horizontalAlign:f,verticalAlign:p}).on("edit",function(t){var r=a.d2r(t);if(r!==undefined){o.call("relayout",e,u,r)}})}}}d.init(_e);var we,ke,Ae,Te,Me,Se,Ce,ze,Ee;var Le;var Ie={};function Pe(t,r,n){var a=ye.getBoundingClientRect();we=r-a.left;ke=n-a.top;Ae={l:we,r:we,w:0,t:ke,b:ke,h:0};Te=e._hmpixcount?e._hmlumcount/e._hmpixcount:i(e._fullLayout.plot_bgcolor).getLuminance();Me="M0,0H"+ne+"V"+ie+"H0V0";Se=false;Ce="xy";Le=false;ze=O(S,Te,te,re,Me);Ee=R(S,te,re)}function De(t,r){if(e._transitioningWithDuration){return false}var n=Math.max(0,Math.min(ne,t+we)),i=Math.max(0,Math.min(ie,r+ke)),a=Math.abs(n-we),o=Math.abs(i-ke);Ae.l=Math.min(we,n);Ae.r=Math.max(we,n);Ae.t=Math.min(ke,i);Ae.b=Math.max(ke,i);function s(){Ce="";Ae.r=Ae.l;Ae.t=Ae.b;Ee.attr("d","M0,0Z")}if(ue){if(a>A||o>A){Ce="xy";if(a/ne>o/ie){o=a*ie/ne;if(ke>i)Ae.t=ke-o;else Ae.b=ke+o}else{a=o*ne/ie;if(we>n)Ae.l=we-a;else Ae.r=we+a}Ee.attr("d",Z(Ae))}else{s()}}else if(!se||o<Math.min(Math.max(a*.6,k),A)){if(a<k||!oe){s()}else{Ae.t=0;Ae.b=ie;Ce="x";Ee.attr("d",q(Ae,ke))}}else if(!oe||a<Math.min(o*.6,A)){Ae.l=0;Ae.r=ne;Ce="y";Ee.attr("d",U(Ae,we))}else{Ce="xy";Ee.attr("d",Z(Ae))}Ae.w=Ae.r-Ae.l;Ae.h=Ae.b-Ae.t;if(Ce)Le=true;e._dragged=Le;F(ze,Ee,Ae,Me,Se,Te);Se=true}function Oe(){if(Math.min(Ae.h,Ae.w)<k*2){return N(e)}if(Ce==="xy"||Ce==="x"){L(Q,Ae.l/ne,Ae.r/ne,Ie,ae.xaxes)}if(Ce==="xy"||Ce==="y"){L(ee,(ie-Ae.b)/ie,(ie-Ae.t)/ie,Ie,ae.yaxes)}N(e);Ze();j(e)}var Re=[0,0,ne,ie];var Fe=null;var Be=w.REDRAWDELAY;var Ne=t.mainplot?e._fullLayout._plots[t.mainplot]:t;function je(t){if(!e._context.scrollZoom&&!e._fullLayout._enablescrollzoom){return}xe();if(e._transitioningWithDuration){t.preventDefault();t.stopPropagation();return}var r=e.querySelector(".plotly");me();if(r.scrollHeight-r.clientHeight>10||r.scrollWidth-r.clientWidth>10){return}clearTimeout(Fe);var n=-t.deltaY;if(!isFinite(n))n=t.wheelDelta/10;if(!isFinite(n)){s.log("Did not find wheel motion attributes: ",t);return}var i=Math.exp(-Math.min(Math.max(n,-20),20)/200),a=Ne.draglayer.select(".nsewdrag").node().getBoundingClientRect(),o=(t.clientX-a.left)/a.width,l=(a.bottom-t.clientY)/a.height,u;function c(e,t,r){if(e.fixedrange)return;var n=s.simpleMap(e.range,e.r2l),i=n[0]+(n[1]-n[0])*t;function a(t){return e.l2r(i+(t-i)*r)}e.range=n.map(a)}if(ce){if(!M)o=.5;for(u=0;u<Q.length;u++){c(Q[u],o,i)}Re[2]*=i;Re[0]+=Re[2]*o*(1/i-1)}if(fe){if(!T)l=.5;for(u=0;u<ee.length;u++){c(ee[u],l,i)}Re[3]*=i;Re[1]+=Re[3]*(1-l)*(1/i-1)}$e(Re);qe(T,M);Fe=setTimeout(function(){Re=[0,0,ne,ie];Ze()},Be);t.preventDefault();return}if(T.length*M.length!==1){G(ye,je)}function Ve(t,r){if(e._transitioningWithDuration){return}if(oe==="ew"||se==="ns"){if(oe)I(Q,t);if(se)I(ee,r);$e([oe?-t:0,se?-r:0,ne,ie]);qe(se,oe);return}function n(e,t,r){var n=1-t,i,a;for(var o=0;o<e.length;o++){var s=e[o];if(s.fixedrange)continue;i=s;a=s._rl[n]+(s._rl[t]-s._rl[n])/P(r/s._length);var l=s.l2r(a);if(l!==false&&l!==undefined)s.range[t]=l}return i._length*(i._rl[t]-a)/(i._rl[t]-i._rl[n])}if(ue&&oe&&se){var i=oe==="w"===(se==="n")?1:-1;var a=(t/ne+i*r/ie)/2;t=a*ne;r=i*a*ie}if(oe==="w")t=n(Q,0,t);else if(oe==="e")t=n(Q,1,-t);else if(!oe)t=0;if(se==="n")r=n(ee,1,r);else if(se==="s")r=n(ee,0,-r);else if(!se)r=0;var o=oe==="w"?t:0;var s=se==="n"?r:0;if(ue){var l;if(!oe&&se.length===1){for(l=0;l<Q.length;l++){Q[l].range=Q[l]._r.slice();b(Q[l],1-r/ie)}t=r*ne/ie;o=t/2}if(!se&&oe.length===1){for(l=0;l<ee.length;l++){ee[l].range=ee[l]._r.slice();b(ee[l],1-t/ne)}r=t*ie/ne;s=r/2}}$e([o,s,ne-t,ie-r]);qe(se,oe)}function qe(t,r){var n=[],i;function a(e){for(i=0;i<e.length;i++){if(!e[i].fixedrange)n.push(e[i]._id)}}if(ce){a(Q);a(ae.xaxes)}if(fe){a(ee);a(ae.yaxes)}Ie={};for(i=0;i<n.length;i++){var s=n[i];g(e,s,true);var l=y(e,s);Ie[l._name+".range[0]"]=l.range[0];Ie[l._name+".range[1]"]=l.range[1]}function u(a,o,s){for(i=0;i<a.length;i++){var l=a[i];if(r&&n.indexOf(l.xref)!==-1||t&&n.indexOf(l.yref)!==-1){o(e,i);if(s)return}}}u(e._fullLayout.annotations||[],o.getComponentMethod("annotations","drawOne"));u(e._fullLayout.shapes||[],o.getComponentMethod("shapes","drawOne"));u(e._fullLayout.images||[],o.getComponentMethod("images","draw"),true)}function Ue(){if(e._transitioningWithDuration)return;var t=e._context.doubleClick,r=(oe?Q:[]).concat(se?ee:[]),n={};var i,a,s;if(t==="reset+autosize"){t="autosize";for(a=0;a<r.length;a++){i=r[a];if(i._rangeInitial&&(i.range[0]!==i._rangeInitial[0]||i.range[1]!==i._rangeInitial[1])||!i._rangeInitial&&!i.autorange){t="reset";break}}}if(t==="autosize"){for(a=0;a<r.length;a++){i=r[a];if(!i.fixedrange)n[i._name+".autorange"]=true}}else if(t==="reset"){if(oe||ue)r=r.concat(ae.xaxes);if(se&&!ue)r=r.concat(ae.yaxes);if(ue){if(!oe)r=r.concat(Q);else if(!se)r=r.concat(ee)}for(a=0;a<r.length;a++){i=r[a];if(!i._rangeInitial){n[i._name+".autorange"]=true}else{s=i._rangeInitial;n[i._name+".range[0]"]=s[0];n[i._name+".range[1]"]=s[1]}}}e.emit("plotly_doubleclick",null);o.call("relayout",e,n)}function Ze(){$e([0,0,ne,ie]);s.syncOrAsync([m.previousPromises,function(){o.call("relayout",e,Ie)}],e)}var He,Ge;function $e(t){var r=e._fullLayout;var n=r._plots;var i=r._subplots.cartesian;var a,l,c,h;if(de||he){u(e)}if(de){o.subplotsRegistry.splom.drag(e);if(pe)return}if(he){for(a=0;a<i.length;a++){l=n[i[a]];c=l.xaxis;h=l.yaxis;var p=l._scene;if(p){var d=s.simpleMap(c.range,c.r2l);var v=s.simpleMap(h.range,h.r2l);p.update({range:[d[0],v[0],d[1],v[1]]})}}}if(ve){var m=t[2]/X._length;var g=t[3]/Y._length;for(a=0;a<i.length;a++){l=n[i[a]];c=l.xaxis;h=l.yaxis;var y=ce&&!c.fixedrange&&J[c._id];var _=fe&&!h.fixedrange&&K[h._id];var x,b;var w,k;if(y){x=m;w=M?t[0]:Ye(c,x)}else{x=We(c,m,g);w=Xe(c,x)}if(_){b=g;k=T?t[1]:Ye(h,b)}else{b=We(h,m,g);k=Xe(h,b)}if(!x&&!b){continue}if(!x)x=1;if(!b)b=1;var A=c._offset-w/x;var S=h._offset-k/b;l.clipRect.call(f.setTranslate,w,k).call(f.setScale,x,b);l.plot.call(f.setTranslate,A,S).call(f.setScale,1/x,1/b);if(x!==He||b!==Ge){f.setPointGroupScale(l.zoomScalePts,x,b);f.setTextPointsScale(l.zoomScaleTxt,x,b)}f.hideOutsideRangePoints(l.clipOnAxisFalseTraces,l);He=x;Ge=b}}}function We(e,t,r){if(e.fixedrange)return 0;if(ce&&ae.xaHash[e._id]){return t}if(fe&&(ue?ae.xaHash:ae.yaHash)[e._id]){return r}return 0}function Xe(e,t){if(t){e.range=e._r.slice();b(e,t);return Ye(e,t)}return 0}function Ye(e,t){return e._length*(1-t)*v[e.constraintoward||"middle"]}return ye}function S(e,t,r,n){var i=s.ensureSingle(e.draglayer,t,r,function(t){t.classed("drag",true).style({fill:"transparent","stroke-width":0}).attr("data-subplot",e.id)});i.call(p,n);return i.node()}function C(e,t,r,i,a,o,s){var l=S(e,"rect",t,r);n.select(l).call(f.setRect,i,a,o,s);return l}function z(e,t){for(var r=0;r<e.length;r++){if(!e[r].fixedrange)return t}return""}function E(e,t){var r=e.range[t],i=Math.abs(r-e.range[1-t]),a;if(e.type==="date"){return r}else if(e.type==="log"){a=Math.ceil(Math.max(0,-Math.log(i)/Math.LN10))+3;return n.format("."+a+"g")(Math.pow(10,r))}else{a=Math.floor(Math.log(Math.abs(r))/Math.LN10)-Math.floor(Math.log(i)/Math.LN10)+4;return n.format("."+String(a)+"g")(r)}}function L(e,t,r,n,i){var a,o,s,l;for(a=0;a<e.length;a++){o=e[a];if(o.fixedrange)continue;s=o._rl[0];l=o._rl[1]-s;o.range=[o.l2r(s+l*t),o.l2r(s+l*r)];n[o._name+".range[0]"]=o.range[0];n[o._name+".range[1]"]=o.range[1]}if(i&&i.length){var u=(t+(1-r))/2;L(i,u,1-u,n)}}function I(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!n.fixedrange){n.range=[n.l2r(n._rl[0]-t/n._m),n.l2r(n._rl[1]-t/n._m)]}}}function P(e){return 1-(e>=0?Math.min(e,.9):1/(1/Math.max(e,-.3)+3.222))}function D(e,t,r){if(!e)return"pointer";if(e==="nsew"){if(r)return"";if(t==="pan")return"move";return"crosshair"}return e.toLowerCase()+"-resize"}function O(e,t,r,n,i){return e.append("path").attr("class","zoombox").style({fill:t>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform","translate("+r+", "+n+")").attr("d",i+"Z")}function R(e,t,r){return e.append("path").attr("class","zoombox-corners").style({fill:c.background,stroke:c.defaultLine,"stroke-width":1,opacity:0}).attr("transform","translate("+t+", "+r+")").attr("d","M0,0Z")}function F(e,t,r,n,i,a){e.attr("d",n+"M"+r.l+","+r.t+"v"+r.h+"h"+r.w+"v-"+r.h+"h-"+r.w+"Z");B(e,t,i,a)}function B(e,t,r,n){if(!r){e.transition().style("fill",n>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200);t.transition().style("opacity",1).duration(200)}}function N(e){n.select(e).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function j(e){if(T&&e.data&&e._context.showTips){s.notifier(s._(e,"Double-click to zoom back out"),"long");T=false}}function V(e){return e==="lasso"||e==="select"}function q(e,t){return"M"+(e.l-.5)+","+(t-A-.5)+"h-3v"+(2*A+1)+"h3ZM"+(e.r+.5)+","+(t-A-.5)+"h3v"+(2*A+1)+"h-3Z"}function U(e,t){return"M"+(t-A-.5)+","+(e.t-.5)+"v-3h"+(2*A+1)+"v3ZM"+(t-A-.5)+","+(e.b+.5)+"v3h"+(2*A+1)+"v-3Z"}function Z(e){var t=Math.floor(Math.min(e.b-e.t,e.r-e.l,A)/2);return"M"+(e.l-3.5)+","+(e.t-.5+t)+"h3v"+-t+"h"+t+"v-3h-"+(t+3)+"ZM"+(e.r+3.5)+","+(e.t-.5+t)+"h-3v"+-t+"h"+-t+"v-3h"+(t+3)+"ZM"+(e.r+3.5)+","+(e.b+.5-t)+"h-3v"+t+"h"+-t+"v3h"+(t+3)+"ZM"+(e.l-3.5)+","+(e.b+.5-t)+"h3v"+t+"h"+t+"v3h-"+(t+3)+"Z"}function H(e,t,r){var n=e._fullLayout._axisConstraintGroups;var i=false;var a={};var o={};var l,u,c,f;for(var h=0;h<n.length;h++){var p=n[h];for(l in t){if(p[l]){for(c in p){if(!(c.charAt(0)==="x"?t:r)[c]){a[c]=1}}for(u in r){if(p[u])i=true}}}for(u in r){if(p[u]){for(f in p){if(!(f.charAt(0)==="x"?t:r)[f]){o[f]=1}}}}}if(i){s.extendFlat(a,o);o={}}var d={};var v=[];for(c in a){var m=y(e,c);v.push(m);d[m._id]=m}var g={};var _=[];for(f in o){var x=y(e,f);_.push(x);g[x._id]=x}return{xaHash:d,yaHash:g,xaxes:v,yaxes:_,isSubplotConstrained:i}}function G(e,t){if(!a){if(e.onwheel!==undefined)e.onwheel=t;else if(e.onmousewheel!==undefined)e.onmousewheel=t}else{var r=e.onwheel!==undefined?"wheel":"mousewheel";if(e._onwheel){e.removeEventListener(r,e._onwheel)}e._onwheel=t;e.addEventListener(r,t,{passive:false})}}function $(e){var t=[];for(var r in e)t.push(e[r]);return t}t.exports={makeDragBox:M,makeDragger:S,makeRectDragger:C,makeZoombox:O,makeCorners:R,updateZoombox:F,xyCorners:Z,transitionZoombox:B,removeZoombox:N,showDoubleClickNotifier:j,attachWheelEventHandler:G}},{"../../components/color":42,"../../components/dragelement":64,"../../components/drawing":67,"../../components/fx":84,"../../constants/alignment":140,"../../lib":161,"../../lib/clear_gl_canvases":149,"../../lib/setcursor":180,"../../lib/svg_text_utils":182,"../../registry":253,"../plots":244,"./axes":205,"./axis_ids":208,"./constants":210,"./scale_zoom":221,"./select":222,d3:6,"has-passive-events":12,tinycolor2:25}],214:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../components/fx");var a=e("../../components/dragelement");var o=e("../../lib/setcursor");var s=e("./dragbox").makeDragBox;var l=e("./constants").DRAGGERSIZE;r.initInteractions=function e(t){var o=t._fullLayout;if(t._context.staticPlot){n.select(t).selectAll(".drag").remove();return}if(!o._has("cartesian")&&!o._has("gl2d")&&!o._has("splom"))return;var u=Object.keys(o._plots||{}).sort(function(e,t){if((o._plots[e].mainplot&&true)===(o._plots[t].mainplot&&true)){var r=e.split("y"),n=t.split("y");return r[0]===n[0]?Number(r[1]||1)-Number(n[1]||1):Number(r[0]||1)-Number(n[0]||1)}return o._plots[e].mainplot?1:-1});u.forEach(function(e){var r=o._plots[e];var n=r.xaxis;var u=r.yaxis;if(!r.mainplot){var c=s(t,r,n._offset,u._offset,n._length,u._length,"ns","ew");c.onmousemove=function(r){t._fullLayout._rehover=function(){if(t._fullLayout._hoversubplot===e){i.hover(t,r,e)}};i.hover(t,r,e);t._fullLayout._lasthover=c;t._fullLayout._hoversubplot=e};c.onmouseout=function(e){if(t._dragging)return;t._fullLayout._hoversubplot=null;a.unhover(t,e)};if(t._context.showAxisDragHandles){s(t,r,n._offset-l,u._offset-l,l,l,"n","w");s(t,r,n._offset+n._length,u._offset-l,l,l,"n","e");s(t,r,n._offset-l,u._offset+u._length,l,l,"s","w");s(t,r,n._offset+n._length,u._offset+u._length,l,l,"s","e")}}if(t._context.showAxisDragHandles){if(e===n._mainSubplot){var f=n._mainLinePosition;if(n.side==="top")f-=l;s(t,r,n._offset+n._length*.1,f,n._length*.8,l,"","ew");s(t,r,n._offset,f,n._length*.1,l,"","w");s(t,r,n._offset+n._length*.9,f,n._length*.1,l,"","e")}if(e===u._mainSubplot){var h=u._mainLinePosition;if(u.side!=="right")h-=l;s(t,r,h,u._offset+u._length*.1,l,u._length*.8,"ns","");s(t,r,h,u._offset+u._length*.9,l,u._length*.1,"s","");s(t,r,h,u._offset,l,u._length*.1,"n","")}}});var c=o._hoverlayer.node();c.onmousemove=function(e){e.target=t._fullLayout._lasthover;i.hover(t,e,o._hoversubplot)};c.onclick=function(e){e.target=t._fullLayout._lasthover;i.click(t,e)};c.onmousedown=function(e){t._fullLayout._lasthover.onmousedown(e)};r.updateFx(o)};r.updateFx=function(e){var t=e.dragmode==="pan"?"move":"crosshair";o(e._draggers,t)}},{"../../components/dragelement":64,"../../components/fx":84,"../../lib/setcursor":180,"./constants":210,"./dragbox":213,d3:6}],215:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");t.exports=function e(t){return function e(r,a){var o=r[t];if(!Array.isArray(o))return;var s=n.subplotsRegistry.cartesian;var l=s.idRegex;var u=a._subplots;var c=u.xaxis;var f=u.yaxis;var h=u.cartesian;var p=a._has("cartesian")||a._has("gl2d");for(var d=0;d<o.length;d++){var v=o[d];if(!i.isPlainObject(v))continue;var m=v.xref;var g=v.yref;var y=l.x.test(m);var _=l.y.test(g);if(y||_){if(!p)i.pushUnique(a._basePlotModules,s);var x=false;if(y&&c.indexOf(m)===-1){c.push(m);x=true}if(_&&f.indexOf(g)===-1){f.push(g);x=true}if(x&&y&&_){h.push(m+g)}}}}}},{"../../lib":161,"../../registry":253}],216:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../lib");var o=e("../plots");var s=e("../../components/drawing");var l=e("../get_data").getModuleCalcData;var u=e("./axis_ids");var c=e("./constants");var f=e("../../constants/xmlns_namespaces");var h=a.ensureSingle;function p(e,t,r){return a.ensureSingle(e,t,r,function(e){e.datum(r)})}r.name="cartesian";r.attr=["xaxis","yaxis"];r.idRoot=["x","y"];r.idRegex=c.idRegex;r.attrRegex=c.attrRegex;r.attributes=e("./attributes");r.layoutAttributes=e("./layout_attributes");r.supplyLayoutDefaults=e("./layout_defaults");r.transitionAxes=e("./transition_axes");r.finalizeSubplots=function(e,t){var r=t._subplots;var n=r.xaxis;var i=r.yaxis;var o=r.cartesian;var s=o.concat(r.gl2d||[]);var l={};var f={};var h,p,d;for(h=0;h<s.length;h++){var v=s[h].split("y");l[v[0]]=1;f["y"+v[1]]=1}for(h=0;h<n.length;h++){p=n[h];if(!l[p]){d=(e[u.id2name(p)]||{}).anchor;if(!c.idRegex.y.test(d))d="y";o.push(p+d);s.push(p+d);if(!f[d]){f[d]=1;a.pushUnique(i,d)}}}for(h=0;h<i.length;h++){d=i[h];if(!f[d]){p=(e[u.id2name(d)]||{}).anchor;if(!c.idRegex.x.test(p))p="x";o.push(p+d);s.push(p+d);if(!l[p]){l[p]=1;a.pushUnique(n,p)}}}if(!s.length){p="";d="";for(var m in e){if(c.attrRegex.test(m)){var g=m.charAt(0);if(g==="x"){if(!p||+m.substr(5)<+p.substr(5)){p=m}}else if(!d||+m.substr(5)<+d.substr(5)){d=m}}}p=p?u.name2id(p):"x";d=d?u.name2id(d):"y";n.push(p);i.push(d);o.push(p+d)}};r.plot=function(e,t,r,n){var i=e._fullLayout;var a=i._subplots.cartesian;var o=e.calcdata;var s;if(!Array.isArray(t)){t=[];for(s=0;s<o.length;s++)t.push(s)}for(s=0;s<a.length;s++){var l=a[s];var u=i._plots[l];var c=[];var f;for(var h=0;h<o.length;h++){var p=o[h];var v=p[0].trace;if(v.xaxis+v.yaxis===l){if(t.indexOf(v.index)!==-1||v.carpet){if(f&&f[0].trace.xaxis+f[0].trace.yaxis===l&&["tonextx","tonexty","tonext"].indexOf(v.fill)!==-1&&c.indexOf(f)===-1){c.push(f)}c.push(p)}f=p}}d(e,u,c,r,n)}};function d(e,t,r,a,o){var u=c.traceLayerClasses;var f=e._fullLayout;var h=f._modules;var p,d,v;var m=[];var g=[];for(var y=0;y<h.length;y++){p=h[y];var _=p.name;var x=i.modules[_].categories;if(x.svg){var b=p.layerName||_+"layer";var w=p.plot;d=l(r,w);v=d[0];r=d[1];if(v.length){m.push({i:u.indexOf(b),className:b,plotMethod:w,cdModule:v})}if(x.zoomScale){g.push("."+b)}}}m.sort(function(e,t){return e.i-t.i});var k=t.plot.selectAll("g.mlayer").data(m,function(e){return e.className});k.enter().append("g").attr("class",function(e){return e.className}).classed("mlayer",true);k.exit().remove();k.order();k.each(function(r){var i=n.select(this);var l=r.className;r.plotMethod(e,t,r.cdModule,i,a,o);if(l!=="scatterlayer"&&l!=="barlayer"){s.setClipUrl(i,t.layerClipId)}});if(f._has("scattergl")){p=i.getModule("scattergl");v=l(r,p)[0];p.plot(e,t,v)}if(!e._context.staticPlot){if(t._hasClipOnAxisFalse){t.clipOnAxisFalseTraces=t.plot.selectAll(".scatterlayer, .barlayer").selectAll(".trace")}if(g.length){var A=t.plot.selectAll(g.join(",")).selectAll(".trace");t.zoomScalePts=A.selectAll("path.point");t.zoomScaleTxt=A.selectAll(".textpoint")}}}r.clean=function(e,t,r,n){var i=n._plots||{};var a=t._plots||{};var o=n._subplots||{};var s;var l,c;if(n._hasOnlyLargeSploms&&!t._hasOnlyLargeSploms){for(c in i){s=i[c];if(s.plotgroup)s.plotgroup.remove()}}var f=n._has&&n._has("gl");var h=t._has&&t._has("gl");if(f&&!h){for(c in i){s=i[c];if(s._scene)s._scene.destroy()}}if(o.xaxis&&o.yaxis){var p=u.listIds({_fullLayout:n});for(l=0;l<p.length;l++){var d=p[l];if(!t[u.id2name(d)]){n._infolayer.selectAll(".g-"+d+"title").remove()}}}var v=n._has&&n._has("cartesian");var m=t._has&&t._has("cartesian");if(v&&!m){g(n._cartesianlayer.selectAll(".subplot"),n);n._defs.selectAll(".axesclip").remove();delete n._axisConstraintGroups}else if(o.cartesian){for(l=0;l<o.cartesian.length;l++){var _=o.cartesian[l];if(!a[_]){var x="."+_+",."+_+"-x,."+_+"-y";n._cartesianlayer.selectAll(x).remove();y(_,n)}}}};r.drawFramework=function(e){var t=e._fullLayout;var r=v(e);var i=t._cartesianlayer.selectAll(".subplot").data(r,a.identity);i.enter().append("g").attr("class",function(e){return"subplot "+e});i.order();i.exit().call(g,t);i.each(function(r){var i=t._plots[r];i.plotgroup=n.select(this);i.overlays=[];m(e,i);if(i.mainplot){var a=t._plots[i.mainplot];a.overlays.push(i)}i.draglayer=h(t._draggers,"g",r)})};r.rangePlot=function(e,t,r){m(e,t);d(e,t,r);o.style(e)};function v(e){var t=e._fullLayout;var r=[];var n=[];for(var i in t._plots){var a=t._plots[i];var o=a.xaxis._mainAxis;var s=a.yaxis._mainAxis;var l=o._id+s._id;if(l!==i&&t._plots[l]){a.mainplot=l;a.mainplotinfo=t._plots[l];n.push(i)}else{r.push(i);a.mainplot=undefined}}r=r.concat(n);return r}function m(e,t){var r=t.plotgroup;var n=t.id;var i=c.layerValue2layerClass[t.xaxis.layer];var a=c.layerValue2layerClass[t.yaxis.layer];var o=e._fullLayout._hasOnlyLargeSploms;if(!t.mainplot){if(o){t.plot=h(r,"g","plot");t.xlines=h(r,"path","xlines-above");t.ylines=h(r,"path","ylines-above");t.xaxislayer=h(r,"g","xaxislayer-above");t.yaxislayer=h(r,"g","yaxislayer-above")}else{var s=h(r,"g","layer-subplot");t.shapelayer=h(s,"g","shapelayer");t.imagelayer=h(s,"g","imagelayer");t.gridlayer=h(r,"g","gridlayer");t.zerolinelayer=h(r,"g","zerolinelayer");h(r,"path","xlines-below");h(r,"path","ylines-below");t.overlinesBelow=h(r,"g","overlines-below");h(r,"g","xaxislayer-below");h(r,"g","yaxislayer-below");t.overaxesBelow=h(r,"g","overaxes-below");t.plot=h(r,"g","plot");t.overplot=h(r,"g","overplot");t.xlines=h(r,"path","xlines-above");t.ylines=h(r,"path","ylines-above");t.overlinesAbove=h(r,"g","overlines-above");h(r,"g","xaxislayer-above");h(r,"g","yaxislayer-above");t.overaxesAbove=h(r,"g","overaxes-above");t.xlines=r.select(".xlines-"+i);t.ylines=r.select(".ylines-"+a);t.xaxislayer=r.select(".xaxislayer-"+i);t.yaxislayer=r.select(".yaxislayer-"+a)}}else{var l=t.mainplotinfo;var f=l.plotgroup;var d=n+"-x";var v=n+"-y";t.gridlayer=l.gridlayer;t.zerolinelayer=l.zerolinelayer;h(l.overlinesBelow,"path",d);h(l.overlinesBelow,"path",v);h(l.overaxesBelow,"g",d);h(l.overaxesBelow,"g",v);t.plot=h(l.overplot,"g",n);h(l.overlinesAbove,"path",d);h(l.overlinesAbove,"path",v);h(l.overaxesAbove,"g",d);h(l.overaxesAbove,"g",v);t.xlines=f.select(".overlines-"+i).select("."+d);t.ylines=f.select(".overlines-"+a).select("."+v);t.xaxislayer=f.select(".overaxes-"+i).select("."+d);t.yaxislayer=f.select(".overaxes-"+a).select("."+v)}if(!o){p(t.gridlayer,"g",t.xaxis._id);p(t.gridlayer,"g",t.yaxis._id);t.gridlayer.selectAll("g").sort(u.idSort)}t.xlines.style("fill","none").classed("crisp",true);t.ylines.style("fill","none").classed("crisp",true)}function g(e,t){if(!e)return;var r={};e.each(function(e){var i=n.select(this);i.remove();y(e,t);r[e]=true});for(var i in t._plots){var a=t._plots[i];var o=a.overlays||[];for(var s=0;s<o.length;s++){var l=o[s];if(r[l.id]){l.plot.selectAll(".trace").remove()}}}}function y(e,t){t._draggers.selectAll("g."+e).remove();t._defs.select("#clip"+t._uid+e+"plot").remove()}r.toSVG=function(e){var t=e._fullLayout._glimages;var r=n.select(e).selectAll(".svg-container");var i=r.filter(function(e,t){return t===r.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function a(){var e=this;var r=e.toDataURL("image/png");var n=t.append("svg:image");n.attr({xmlns:f.svg,"xlink:href":r,preserveAspectRatio:"none",x:0,y:0,width:e.width,height:e.height})}i.each(a)};r.updateFx=e("./graph_interact").updateFx},{"../../components/drawing":67,"../../constants/xmlns_namespaces":144,"../../lib":161,"../../registry":253,"../get_data":233,"../plots":244,"./attributes":203,"./axis_ids":208,"./constants":210,"./graph_interact":214,"./layout_attributes":217,"./layout_defaults":218,"./transition_axes":227,d3:6}],217:[function(e,t,r){"use strict";var n=e("../font_attributes");var i=e("../../components/color/attributes");var a=e("../../components/drawing/attributes").dash;var o=e("../../lib/extend").extendFlat;var s=e("../../plot_api/plot_template").templatedArray;var l=e("./constants");t.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:i.defaultLine,editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:n({editType:"ticks"}),type:{valType:"enumerated",values:["-","linear","log","date","category"],dflt:"-",editType:"calc",_noTemplating:true},autorange:{valType:"enumerated",values:[true,false,"reversed"],dflt:true,editType:"calc",impliedEdits:{"range[0]":undefined,"range[1]":undefined}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":false}},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":false}}],editType:"axrange",impliedEdits:{autorange:false}},fixedrange:{valType:"boolean",dflt:false,editType:"calc"},scaleanchor:{valType:"enumerated",values:[l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],dflt:"range",editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:undefined,dtick:undefined}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},mirror:{valType:"enumerated",values:[true,"ticks",false,"all","allticks"],dflt:false,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:i.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:true,editType:"ticks"},automargin:{valType:"boolean",dflt:false,editType:"ticks"},showspikes:{valType:"boolean",dflt:false,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:o({},a,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor"],dflt:"data",editType:"none"},tickfont:n({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},separatethousands:{valType:"boolean",dflt:false,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks"},tickformatstops:s("tickformatstop",{enabled:{valType:"boolean",dflt:true,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none"},showline:{valType:"boolean",dflt:false,editType:"layoutstyle"},linecolor:{valType:"color",dflt:i.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:i.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:i.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",l.idRegex.x.toString(),l.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"}}}},{"../../components/color/attributes":41,"../../components/drawing/attributes":66,"../../lib/extend":154,"../../plot_api/plot_template":195,"../font_attributes":231,"./constants":210}],218:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("../../lib");var a=e("../../components/color");var o=e("../../plot_api/plot_template");var s=e("../layout_attributes");var l=e("./layout_attributes");var u=e("./type_defaults");var c=e("./axis_defaults");var f=e("./constraint_defaults");var h=e("./position_defaults");var p=e("./axis_ids");t.exports=function e(t,r,d){var v={};var m={};var g={};var y={};var _;for(_=0;_<d.length;_++){var x=d[_];if(!n.traceIs(x,"cartesian")&&!n.traceIs(x,"gl2d")){continue}var b=p.id2name(x.xaxis);var w=p.id2name(x.yaxis);if(!n.traceIs(x,"carpet")||x.type==="carpet"&&!x._cheater){if(b)m[b]=1}if(x.type==="carpet"&&x._cheater){if(b)v[b]=1}if(n.traceIs(x,"2dMap")){g[b]=true;g[w]=true}if(n.traceIs(x,"oriented")){var k=x.orientation==="h"?w:b;y[k]=true}}var A=r._subplots;var T=A.xaxis;var M=A.yaxis;var S=i.simpleMap(T,p.id2name);var C=i.simpleMap(M,p.id2name);var z=S.concat(C);var E=a.background;if(T.length&&M.length){E=i.coerce(t,r,s,"plot_bgcolor")}var L=a.combine(E,r.paper_bgcolor);var I,P,D,O;function R(e,t){return i.coerce(D,O,l,e,t)}function F(e,t){return i.coerce2(D,O,l,e,t)}function B(e){return e==="x"?M:T}var N={x:B("x"),y:B("y")};function j(e,r){var n=e==="x"?S:C;var i=[];for(var a=0;a<n.length;a++){var o=n[a];if(o!==r&&!(t[o]||{}).overlaying){i.push(p.name2id(o))}}return i}for(_=0;_<z.length;_++){I=z[_];P=I.charAt(0);if(!i.isPlainObject(t[I])){t[I]={}}D=t[I];O=o.newContainer(r,I,P+"axis");u(D,O,R,d,I);var V=j(P,I);var q={letter:P,font:r.font,outerTicks:g[I],showGrid:!y[I],data:d,bgColor:L,calendar:r.calendar,automargin:true,cheateronly:P==="x"&&v[I]&&!m[I]};c(D,O,R,q,r);var U=F("spikecolor"),Z=F("spikethickness"),H=F("spikedash"),G=F("spikemode"),$=F("spikesnap"),W=R("showspikes",!!U||!!Z||!!H||!!G||!!$);if(!W){delete O.spikecolor;delete O.spikethickness;delete O.spikedash;delete O.spikemode;delete O.spikesnap}var X={letter:P,counterAxes:N[P],overlayableAxes:V,grid:r.grid};h(D,O,R,X);O._input=D}var Y=n.getComponentMethod("rangeslider","handleDefaults");var J=n.getComponentMethod("rangeselector","handleDefaults");for(_=0;_<S.length;_++){I=S[_];D=t[I];O=r[I];Y(t,r,I);if(O.type==="date"){J(D,O,r,C,O.calendar)}R("fixedrange")}for(_=0;_<C.length;_++){I=C[_];D=t[I];O=r[I];var K=r[p.id2name(O.anchor)];var Q=K&&K.rangeslider&&K.rangeslider.visible;R("fixedrange",Q)}r._axisConstraintGroups=[];var ee=N.x.concat(N.y);for(_=0;_<z.length;_++){I=z[_];P=I.charAt(0);D=t[I];O=r[I];f(D,O,R,ee,r)}}},{"../../components/color":42,"../../lib":161,"../../plot_api/plot_template":195,"../../registry":253,"../layout_attributes":235,"./axis_defaults":207,"./axis_ids":208,"./constraint_defaults":211,"./layout_attributes":217,"./position_defaults":220,"./type_defaults":228}],219:[function(e,t,r){"use strict";var n=e("tinycolor2").mix;var i=e("../../components/color/attributes").lightFraction;var a=e("../../lib");t.exports=function e(t,r,o,s){s=s||{};var l=s.dfltColor;function u(e,n){return a.coerce2(t,r,s.attributes,e,n)}var c=u("linecolor",l);var f=u("linewidth");var h=o("showline",s.showLine||!!c||!!f);if(!h){delete r.linecolor;delete r.linewidth}var p=n(l,s.bgColor,s.blend||i).toRgbString();var d=u("gridcolor",p);var v=u("gridwidth");var m=o("showgrid",s.showGrid||!!d||!!v);if(!m){delete r.gridcolor;delete r.gridwidth}if(!s.noZeroLine){var g=u("zerolinecolor",l);var y=u("zerolinewidth");var _=o("zeroline",s.showGrid||!!g||!!y);if(!_){delete r.zerolinecolor;delete r.zerolinewidth}}}},{"../../components/color/attributes":41,"../../lib":161,tinycolor2:25}],220:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");t.exports=function e(t,r,a,o){var s=o.counterAxes||[];var l=o.overlayableAxes||[];var u=o.letter;var c=o.grid;var f,h,p,d;if(c){h=c._domains[u][c._axisMap[r._id]];f=c._anchors[r._id];if(h){p=c[u+"side"].split(" ")[0];d=c.domain[u][p==="right"||p==="top"?1:0]}}h=h||[0,1];f=f||(n(t.position)?"free":s[0]||"free");p=p||(u==="x"?"bottom":"left");d=d||0;var v=i.coerce(t,r,{anchor:{valType:"enumerated",values:["free"].concat(s),dflt:f}},"anchor");if(v==="free")a("position",d);i.coerce(t,r,{side:{valType:"enumerated",values:u==="x"?["bottom","top"]:["left","right"],dflt:p}},"side");var m=false;if(l.length){m=i.coerce(t,r,{overlaying:{valType:"enumerated",values:[false].concat(l),dflt:false}},"overlaying")}if(!m){var g=a("domain",h);if(g[0]>g[1]-.01)r.domain=h;i.noneOrAll(t.domain,r.domain,h)}a("layer");return r}},{"../../lib":161,"fast-isnumeric":9}],221:[function(e,t,r){"use strict";var n=e("../../constants/alignment").FROM_BL;t.exports=function e(t,r,i){if(i===undefined){i=n[t.constraintoward||"center"]}var a=[t.r2l(t.range[0]),t.r2l(t.range[1])];var o=a[0]+(a[1]-a[0])*i;t.range=t._input.range=[t.l2r(o+(a[0]-o)*r),t.l2r(o+(a[1]-o)*r)]}},{"../../constants/alignment":140}],222:[function(e,t,r){"use strict";var n=e("polybooljs");var i=e("../../registry");var a=e("../../components/color");var o=e("../../components/fx");var s=e("../../lib/polygon");var l=e("../../lib/throttle");var u=e("../../components/fx/helpers").makeEventData;var c=e("./axis_ids").getFromId;var f=e("../sort_modules").sortModules;var h=e("./constants");var p=h.MINSELECT;var d=s.filter;var v=s.tester;var m=s.multitester;function g(e){return e._id}function y(e,t,r,n,i){var s=n.gd;var u=s._fullLayout;var f=u._zoomlayer;var y=n.element.getBoundingClientRect();var k=n.plotinfo;var A=k.xaxis._offset;var T=k.yaxis._offset;var M=t-y.left;var S=r-y.top;var C=M;var z=S;var E="M"+M+","+S;var L=n.xaxes[0]._length;var I=n.yaxes[0]._length;var P=n.xaxes.map(g);var D=n.yaxes.map(g);var O=n.xaxes.concat(n.yaxes);var R=e.altKey;var F,B,N,j;var V,q,U,Z,H;var G=u._lastSelectedSubplot&&u._lastSelectedSubplot===k.id;if(G&&(e.shiftKey||e.altKey)&&(k.selection&&k.selection.polygons)&&!n.polygons){n.polygons=k.selection.polygons;n.mergedPolygons=k.selection.mergedPolygons}else if(!e.shiftKey&&!e.altKey||(e.shiftKey||e.altKey)&&!k.selection){k.selection={};k.selection.polygons=n.polygons=[];k.selection.mergedPolygons=n.mergedPolygons=[]}if(!G){w(f);u._lastSelectedSubplot=k.id}if(i==="lasso"){F=d([[M,S]],h.BENDPX)}var $=f.selectAll("path.select-outline-"+k.id).data([1,2]);$.enter().append("path").attr("class",function(e){return"select-outline select-outline-"+e+" select-outline-"+k.id}).attr("transform","translate("+A+", "+T+")").attr("d",E+"Z");var W=f.append("path").attr("class","zoombox-corners").style({fill:a.background,stroke:a.defaultLine,"stroke-width":1}).attr("transform","translate("+A+", "+T+")").attr("d","M0,0Z");var X=[];var Y=u._uid+h.SELECTID;var J=[];for(V=0;V<s.calcdata.length;V++){q=s.calcdata[V];U=q[0].trace;if(U.visible!==true||!U._module||!U._module.selectPoints)continue;if(n.subplot){if(U.subplot===n.subplot||U.geo===n.subplot){X.push({_module:U._module,cd:q,xaxis:n.xaxes[0],yaxis:n.yaxes[0]})}}else if(U.type==="splom"&&U._xaxes[P[0]]&&U._yaxes[D[0]]){X.push({_module:U._module,cd:q,xaxis:n.xaxes[0],yaxis:n.yaxes[0]})}else{if(P.indexOf(U.xaxis)===-1)continue;if(D.indexOf(U.yaxis)===-1)continue;X.push({_module:U._module,cd:q,xaxis:c(s,U.xaxis),yaxis:c(s,U.yaxis)})}}function K(e){var t=e._id.charAt(0)==="y"?1:0;return function(r){return e.p2d(r[t])}}function Q(e,t){return e-t}var ee;if(k.fillRangeItems){ee=k.fillRangeItems}else{if(i==="select"){ee=function(e,t){var r=e.range={};for(V=0;V<O.length;V++){var n=O[V];var i=n._id.charAt(0);r[n._id]=[n.p2d(t[i+"min"]),n.p2d(t[i+"max"])].sort(Q)}}}else{ee=function(e,t,r){var n=e.lassoPoints={};for(V=0;V<O.length;V++){var i=O[V];n[i._id]=r.filtered.map(K(i))}}}}n.moveFn=function(e,t){C=Math.max(0,Math.min(L,e+M));z=Math.max(0,Math.min(I,t+S));var r=Math.abs(C-M),a=Math.abs(z-S);if(i==="select"){var o=u.selectdirection;if(u.selectdirection==="any"){if(a<Math.min(r*.6,p))o="h";else if(r<Math.min(a*.6,p))o="v";else o="d"}else{o=u.selectdirection}if(o==="h"){j=[[M,0],[M,I],[C,I],[C,0]];j.xmin=Math.min(M,C);j.xmax=Math.max(M,C);j.ymin=Math.min(0,I);j.ymax=Math.max(0,I);W.attr("d","M"+j.xmin+","+(S-p)+"h-4v"+2*p+"h4Z"+"M"+(j.xmax-1)+","+(S-p)+"h4v"+2*p+"h-4Z")}else if(o==="v"){j=[[0,S],[0,z],[L,z],[L,S]];j.xmin=Math.min(0,L);j.xmax=Math.max(0,L);j.ymin=Math.min(S,z);j.ymax=Math.max(S,z);W.attr("d","M"+(M-p)+","+j.ymin+"v-4h"+2*p+"v4Z"+"M"+(M-p)+","+(j.ymax-1)+"v4h"+2*p+"v-4Z")}else if(o==="d"){j=[[M,S],[M,z],[C,z],[C,S]];j.xmin=Math.min(M,C);j.xmax=Math.max(M,C);j.ymin=Math.min(S,z);j.ymax=Math.max(S,z);W.attr("d","M0,0Z")}}else if(i==="lasso"){F.addPt([C,z]);j=F.filtered}if(n.polygons&&n.polygons.length){N=x(n.mergedPolygons,j,R);j.subtract=R;B=m(n.polygons.concat([j]))}else{N=[j];B=v(j)}var c=[];for(V=0;V<N.length;V++){var f=N[V];c.push(f.join("L")+"L"+f[0])}$.attr("d","M"+c.join("M")+"Z");l.throttle(Y,h.SELECTDELAY,function(){J=[];var e,t=[],r;for(V=0;V<X.length;V++){Z=X[V];r=Z._module.selectPoints(Z,B);t.push(r);e=b(r,Z);if(J.length){for(var i=0;i<e.length;i++){J.push(e[i])}}else J=e}H={points:J};_(s,X,H);ee(H,j,F);n.gd.emit("plotly_selecting",H)})};n.clickFn=function(e,t){W.remove();l.done(Y).then(function(){l.clear(Y);if(e===2){$.remove();for(V=0;V<X.length;V++){Z=X[V];Z._module.selectPoints(Z,false)}_(s,X);s.emit("plotly_deselect",null)}else{s.emit("plotly_selected",undefined)}o.click(s,t)})};n.doneFn=function(){W.remove();l.done(Y).then(function(){l.clear(Y);n.gd.emit("plotly_selected",H);if(j&&n.polygons){j.subtract=R;n.polygons.push(j);n.mergedPolygons.length=0;[].push.apply(n.mergedPolygons,N)}})}}function _(e,t,r){var n,a,o,s;if(r){var l=r.points||[];for(n=0;n<t.length;n++){s=t[n].cd[0].trace;s.selectedpoints=[];s._input.selectedpoints=[]}for(n=0;n<l.length;n++){var u=l[n];var c=u.data;var h=u.fullData;if(u.pointIndices){[].push.apply(c.selectedpoints,u.pointIndices);[].push.apply(h.selectedpoints,u.pointIndices)}else{c.selectedpoints.push(u.pointIndex);h.selectedpoints.push(u.pointIndex)}}}else{for(n=0;n<t.length;n++){s=t[n].cd[0].trace;delete s.selectedpoints;delete s._input.selectedpoints}}var p={};for(n=0;n<t.length;n++){o=t[n];var d=o._module.name;if(p[d]){p[d].push(o)}else{p[d]=[o]}}var v=Object.keys(p).sort(f);for(n=0;n<v.length;n++){var m=p[v[n]];var g=m.length;var y=m[0];var _=y.cd[0].trace;var x=y._module;var b=x.styleOnSelect||x.style;if(i.traceIs(_,"regl")){var w=new Array(g);for(a=0;a<g;a++){w[a]=m[a].cd}b(e,w)}else{for(a=0;a<g;a++){b(e,m[a].cd)}}}}function x(e,t,r){var i;if(r){i=n.difference({regions:e,inverted:false},{regions:[t],inverted:false});return i.regions}i=n.union({regions:e,inverted:false},{regions:[t],inverted:false});return i.regions}function b(e,t){if(Array.isArray(e)){var r=t.cd;var n=t.cd[0].trace;for(var i=0;i<e.length;i++){e[i]=u(e[i],n,r)}}return e}function w(e){e.selectAll(".select-outline").remove()}t.exports={prepSelect:y,clearSelect:w}},{"../../components/color":42,"../../components/fx":84,"../../components/fx/helpers":81,"../../lib/polygon":173,"../../lib/throttle":183,"../../registry":253,"../sort_modules":251,"./axis_ids":208,"./constants":210,polybooljs:16}],223:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../../lib");var o=a.cleanNumber;var s=a.ms2DateTime;var l=a.dateTime2ms;var u=a.ensureNumber;var c=e("../../constants/numerical");var f=c.FP_SAFE;var h=c.BADNUM;var p=e("./constants");var d=e("./axis_ids");function v(e){return Math.pow(10,e)}t.exports=function e(t,r){r=r||{};var c=(t._id||"x").charAt(0);var m=10;function g(e,r){if(e>0)return Math.log(e)/Math.LN10;else if(e<=0&&r&&t.range&&t.range.length===2){var n=t.range[0],i=t.range[1];return.5*(n+i-3*m*Math.abs(n-i))}else return h}function y(e,r,n){var a=l(e,n||t.calendar);if(a===h){if(i(e))a=l(new Date(+e));else return h}return a}function _(e,r,n){return s(e,r,n||t.calendar)}function x(e){return t._categories[Math.round(e)]}function b(e){if(e!==null&&e!==undefined){if(t._categoriesMap===undefined){t._categoriesMap={}}if(t._categoriesMap[e]!==undefined){return t._categoriesMap[e]}else{t._categories.push(e);var r=t._categories.length-1;t._categoriesMap[e]=r;return r}}return h}function w(e){if(t._categoriesMap){var r=t._categoriesMap[e];if(r!==undefined)return r}if(i(e))return+e}function k(e){if(!i(e))return h;return n.round(t._b+t._m*e,2)}function A(e){return(e-t._b)/t._m}t.c2l=t.type==="log"?g:u;t.l2c=t.type==="log"?v:u;t.l2p=k;t.p2l=A;t.c2p=t.type==="log"?function(e,t){return k(g(e,t))}:k;t.p2c=t.type==="log"?function(e){return v(A(e))}:A;if(["linear","-"].indexOf(t.type)!==-1){t.d2r=t.r2d=t.d2c=t.r2c=t.d2l=t.r2l=o;t.c2d=t.c2r=t.l2d=t.l2r=u;t.d2p=t.r2p=function(e){return t.l2p(o(e))};t.p2d=t.p2r=A;t.cleanPos=u}else if(t.type==="log"){t.d2r=t.d2l=function(e,t){return g(o(e),t)};t.r2d=t.r2c=function(e){return v(o(e))};t.d2c=t.r2l=o;t.c2d=t.l2r=u;t.c2r=g;t.l2d=v;t.d2p=function(e,r){return t.l2p(t.d2r(e,r))};t.p2d=function(e){return v(A(e))};t.r2p=function(e){return t.l2p(o(e))};t.p2r=A;t.cleanPos=u}else if(t.type==="date"){t.d2r=t.r2d=a.identity;t.d2c=t.r2c=t.d2l=t.r2l=y;t.c2d=t.c2r=t.l2d=t.l2r=_;t.d2p=t.r2p=function(e,r,n){return t.l2p(y(e,0,n))};t.p2d=t.p2r=function(e,t,r){return _(A(e),t,r)};t.cleanPos=function(e){return a.cleanDate(e,h,t.calendar)}}else if(t.type==="category"){t.d2c=t.d2l=b;t.r2d=t.c2d=t.l2d=x;t.d2r=t.d2l_noadd=w;t.r2c=function(e){var r=w(e);return r!==undefined?r:t.fraction2r(.5)};t.l2r=t.c2r=u;t.r2l=w;t.d2p=function(e){return t.l2p(t.r2c(e))};t.p2d=function(e){return x(A(e))};t.r2p=t.d2p;t.p2r=A;t.cleanPos=function(e){if(typeof e==="string"&&e!=="")return e;return u(e)}}t.fraction2r=function(e){var r=t.r2l(t.range[0]),n=t.r2l(t.range[1]);return t.l2r(r+e*(n-r))};t.r2fraction=function(e){var r=t.r2l(t.range[0]),n=t.r2l(t.range[1]);return(t.r2l(e)-r)/(n-r)};t.cleanRange=function(e,r){if(!r)r={};if(!e)e="range";var n=a.nestedProperty(t,e).get();var o,s;if(t.type==="date")s=a.dfltRange(t.calendar);else if(c==="y")s=p.DFLTRANGEY;else s=r.dfltRange||p.DFLTRANGEX;s=s.slice();if(!n||n.length!==2){a.nestedProperty(t,e).set(s);return}if(t.type==="date"){n[0]=a.cleanDate(n[0],h,t.calendar);n[1]=a.cleanDate(n[1],h,t.calendar)}for(o=0;o<2;o++){if(t.type==="date"){if(!a.isDateTime(n[o],t.calendar)){t[e]=s;break}if(t.r2l(n[0])===t.r2l(n[1])){var l=a.constrain(t.r2l(n[0]),a.MIN_MS+1e3,a.MAX_MS-1e3);n[0]=t.l2r(l-1e3);n[1]=t.l2r(l+1e3);break}}else{if(!i(n[o])){if(i(n[1-o])){n[o]=n[1-o]*(o?10:.1)}else{t[e]=s;break}}if(n[o]<-f)n[o]=-f;else if(n[o]>f)n[o]=f;if(n[0]===n[1]){var u=Math.max(1,Math.abs(n[0]*1e-6));n[0]-=u;n[1]+=u}}}};t.setScale=function(e){var n=r._size;if(!t._categories)t._categories=[];if(!t._categoriesMap)t._categoriesMap={};if(t.overlaying){var i=d.getFromId({_fullLayout:r},t.overlaying);t.domain=i.domain}var a=e&&t._r?"_r":"range",o=t.calendar;t.cleanRange(a);var s=t.r2l(t[a][0],o),l=t.r2l(t[a][1],o);if(c==="y"){t._offset=n.t+(1-t.domain[1])*n.h;t._length=n.h*(t.domain[1]-t.domain[0]);t._m=t._length/(s-l);t._b=-t._m*l}else{t._offset=n.l+t.domain[0]*n.w;t._length=n.w*(t.domain[1]-t.domain[0]);t._m=t._length/(l-s);t._b=-t._m*s}if(!isFinite(t._m)||!isFinite(t._b)){r._replotting=false;throw new Error("Something went wrong with axis scaling")}};t.makeCalcdata=function(e,r){var n,i,o,s;var l=t.type;var u=l==="date"&&e[r+"calendar"];if(r in e){n=e[r];s=e._length||n.length;if(a.isTypedArray(n)&&(l==="linear"||l==="log")){if(s===n.length){return n}else if(n.subarray){return n.subarray(0,s)}}i=new Array(s);for(o=0;o<s;o++){i[o]=t.d2c(n[o],0,u)}}else{var c=r+"0"in e?t.d2c(e[r+"0"],0,u):0;var f=e["d"+r]?Number(e["d"+r]):1;n=e[{x:"y",y:"x"}[r]];s=e._length||n.length;i=new Array(s);for(o=0;o<s;o++){i[o]=c+o*f}}return i};t.isValidRange=function(e){return Array.isArray(e)&&e.length===2&&i(t.r2l(e[0]))&&i(t.r2l(e[1]))};t.isPtWithinRange=function(e,r){var n=t.c2l(e[c],null,r);var i=t.r2l(t.range[0]);var a=t.r2l(t.range[1]);if(i<a){return i<=n&&n<=a}else{return a<=n&&n<=i}};t.clearCalc=function(){t._min=[];t._max=[];t._categories=(t._initialCategories||[]).slice();t._categoriesMap={};for(var e=0;e<t._categories.length;e++){t._categoriesMap[t._categories[e]]=e}};var T=r._d3locale;if(t.type==="date"){t._dateFormat=T?T.timeFormat.utc:n.time.format.utc;t._extraFormat=r._extraFormat}t._separators=r.separators;t._numFormat=T?T.numberFormat:n.format;delete t._minDtick;delete t._forceTick0}},{"../../constants/numerical":142,"../../lib":161,"./axis_ids":208,"./constants":210,d3:6,"fast-isnumeric":9}],224:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./layout_attributes");var a=e("../array_container_defaults");t.exports=function e(t,r,l,u,c){var f=o(t);var h=l("tickprefix");if(h)l("showtickprefix",f);var p=l("ticksuffix",c.tickSuffixDflt);if(p)l("showticksuffix",f);var d=l("showticklabels");if(d){var v=c.font||{};var m=r.color!==i.color.dflt?r.color:v.color;n.coerceFont(l,"tickfont",{family:v.family,size:v.size,color:m});l("tickangle");if(u!=="category"){var g=l("tickformat");var y=t.tickformatstops;if(Array.isArray(y)&&y.length){a(t,r,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:s})}if(!g&&u!=="date"){l("showexponent",f);l("exponentformat");l("separatethousands")}}}};function o(e){var t=["showexponent","showtickprefix","showticksuffix"],r=t.filter(function(t){return e[t]!==undefined}),n=function(t){return e[t]===e[r[0]]};if(r.every(n)||r.length===1){return e[r[0]]}}function s(e,t){function r(r,a){return n.coerce(e,t,i.tickformatstops,r,a)}var a=r("enabled");if(a){r("dtickrange");r("value")}}},{"../../lib":161,"../array_container_defaults":201,"./layout_attributes":217}],225:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./layout_attributes");t.exports=function e(t,r,a,o){var s=n.coerce2(t,r,i,"ticklen"),l=n.coerce2(t,r,i,"tickwidth"),u=n.coerce2(t,r,i,"tickcolor",r.color),c=a("ticks",o.outerTicks||s||l||u?"outside":"");if(!c){delete r.ticklen;delete r.tickwidth;delete r.tickcolor}}},{"../../lib":161,"./layout_attributes":217}],226:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");var a=e("../../constants/numerical").ONEDAY;t.exports=function e(t,r,o,s){var l;if(t.tickmode==="array"&&(s==="log"||s==="date")){l=r.tickmode="auto"}else{var u=Array.isArray(t.tickvals)?"array":t.dtick?"linear":"auto";l=o("tickmode",u)}if(l==="auto")o("nticks");else if(l==="linear"){var c=s==="date"?a:1;var f=o("dtick",c);if(n(f)){r.dtick=f>0?Number(f):c}else if(typeof f!=="string"){r.dtick=c}else{var h=f.charAt(0),p=f.substr(1);p=n(p)?Number(p):0;if(p<=0||!(s==="date"&&h==="M"&&p===Math.round(p)||s==="log"&&h==="L"||s==="log"&&h==="D"&&(p===1||p===2))){r.dtick=c}}var d=s==="date"?i.dateTick0(r.calendar):0;var v=o("tick0",d);if(s==="date"){r.tick0=i.cleanDate(v,d)}else if(n(v)&&f!=="D1"&&f!=="D2"){r.tick0=Number(v)}else{r.tick0=d}}else{var m=o("tickvals");if(m===undefined)r.tickmode="auto";else o("ticktext")}}},{"../../constants/numerical":142,"../../lib":161,"fast-isnumeric":9}],227:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../components/drawing");var o=e("./axes");var s=e("./constants").attrRegex;t.exports=function e(t,r,l,u){var c=t._fullLayout;var f=[];function h(e){var t,r,n,i,a;var o={};for(t in e){r=t.split(".");n=r[0].match(s);if(n){var l=t.charAt(0);var u=r[0];i=c[u];a={};if(Array.isArray(e[t])){a.to=e[t].slice(0)}else{if(Array.isArray(e[t].range)){a.to=e[t].range.slice(0)}}if(!a.to)continue;a.axisName=u;a.length=i._length;f.push(l);o[l]=a}}return o}function p(e,t,r){var n;var i=e._plots;var a=[];var o,s;for(n in i){var l=i[n];if(a.indexOf(l)!==-1)continue;var u=l.xaxis._id;var c=l.yaxis._id;var f=l.xaxis.range;var h=l.yaxis.range;l.xaxis._r=l.xaxis.range.slice();l.yaxis._r=l.yaxis.range.slice();if(r[u]){o=r[u].to}else{o=f}if(r[c]){s=r[c].to}else{s=h}if(f[0]===o[0]&&f[1]===o[1]&&h[0]===s[0]&&h[1]===s[1])continue;if(t.indexOf(u)!==-1||t.indexOf(c)!==-1){a.push(l)}}return a}var d=h(r);var v=Object.keys(d);var m=p(c,v,d);function g(){function e(e,r,n){for(var i=0;i<e.length;i++){r(t,i);if(n)return}}e(c.annotations||[],i.getComponentMethod("annotations","drawOne"));e(c.shapes||[],i.getComponentMethod("shapes","drawOne"));e(c.images||[],i.getComponentMethod("images","draw"),true)}if(!m.length){g();return false}function y(e,r){var n=[],a;n=[e._id,r._id];for(a=0;a<n.length;a++){o.doTicksSingle(t,n[a],true)}function s(e,r,i){for(a=0;a<e.length;a++){var o=e[a];if(n.indexOf(o.xref)!==-1||n.indexOf(o.yref)!==-1){r(t,a)}if(i)return}}s(c.annotations||[],i.getComponentMethod("annotations","drawOne"));s(c.shapes||[],i.getComponentMethod("shapes","drawOne"));s(c.images||[],i.getComponentMethod("images","draw"),true)}function _(e){var t=e.xaxis;var r=e.yaxis;c._defs.select("#"+e.clipId+"> rect").call(a.setTranslate,0,0).call(a.setScale,1,1);e.plot.call(a.setTranslate,t._offset,r._offset).call(a.setScale,1,1);var n=e.plot.selectAll(".scatterlayer .trace");n.selectAll(".point").call(a.setPointGroupScale,1,1);n.selectAll(".textpoint").call(a.setTextPointsScale,1,1);n.call(a.hideOutsideRangePoints,e)}function x(e,r){var n,i,o;var s=d[e.xaxis._id];var l=d[e.yaxis._id];var u=[];if(s){n=t._fullLayout[s.axisName];i=n._r;o=s.to;u[0]=(i[0]*(1-r)+r*o[0]-i[0])/(i[1]-i[0])*e.xaxis._length;var c=i[1]-i[0];var f=o[1]-o[0];n.range[0]=i[0]*(1-r)+r*o[0];n.range[1]=i[1]*(1-r)+r*o[1];u[2]=e.xaxis._length*(1-r+r*f/c)}else{u[0]=0;u[2]=e.xaxis._length}if(l){n=t._fullLayout[l.axisName];i=n._r;o=l.to;u[1]=(i[1]*(1-r)+r*o[1]-i[1])/(i[0]-i[1])*e.yaxis._length;var h=i[1]-i[0];var p=o[1]-o[0];n.range[0]=i[0]*(1-r)+r*o[0];n.range[1]=i[1]*(1-r)+r*o[1];u[3]=e.yaxis._length*(1-r+r*p/h)}else{u[1]=0;u[3]=e.yaxis._length}y(e.xaxis,e.yaxis);var v=e.xaxis;var m=e.yaxis;var g=!!s;var _=!!l;var x=g?v._length/u[2]:1,b=_?m._length/u[3]:1;var w=g?u[0]:0,k=_?u[1]:0;var A=g?u[0]/u[2]*v._length:0,T=_?u[1]/u[3]*m._length:0;var M=v._offset-A,S=m._offset-T;e.clipRect.call(a.setTranslate,w,k).call(a.setScale,1/x,1/b);e.plot.call(a.setTranslate,M,S).call(a.setScale,x,b);a.setPointGroupScale(e.zoomScalePts,1/x,1/b);a.setTextPointsScale(e.zoomScaleTxt,1/x,1/b)}var b;if(u){b=u()}function w(){var e={};for(var r=0;r<v.length;r++){var n=t._fullLayout[d[v[r]].axisName];var a=d[v[r]].to;e[n._name+".range[0]"]=a[0];e[n._name+".range[1]"]=a[1];n.range=a.slice()}b&&b();return i.call("relayout",t,e).then(function(){for(var e=0;e<m.length;e++){_(m[e])}})}function k(){var e={};for(var r=0;r<v.length;r++){var n=t._fullLayout[v[r]+"axis"];e[n._name+".range[0]"]=n.range[0];e[n._name+".range[1]"]=n.range[1];n.range=n._r.slice()}return i.call("relayout",t,e).then(function(){for(var e=0;e<m.length;e++){_(m[e])}})}var A,T,M;var S=n.ease(l.easing);t._transitionData._interruptCallbacks.push(function(){window.cancelAnimationFrame(M);M=null;return k()});function C(){T=Date.now();var e=Math.min(1,(T-A)/l.duration);var t=S(e);for(var r=0;r<m.length;r++){x(m[r],t)}if(T-A>l.duration){w();M=window.cancelAnimationFrame(C)}else{M=window.requestAnimationFrame(C)}}A=Date.now();M=window.requestAnimationFrame(C);return Promise.resolve()}},{"../../components/drawing":67,"../../registry":253,"./axes":205,"./constants":210,d3:6}],228:[function(e,t,r){"use strict";var n=e("../../registry");var i=e("./axis_autotype");var a=e("./axis_ids").name2id;t.exports=function e(t,r,n,i,s){if(s){r._name=s;r._id=a(s)}var l=n("type");if(l==="-"){o(r,i);if(r.type==="-"){r.type="linear"}else{t.type=r.type}}};function o(e,t){if(e.type!=="-")return;var r=e._id;var a=r.charAt(0);if(r.indexOf("scene")!==-1)r=a;var o=s(t,r,a);if(!o)return;if(o.type==="histogram"&&a==={v:"y",h:"x"}[o.orientation||"v"]){e.type="linear";return}var c=a+"calendar";var f=o[c];var h;if(u(o,a)){var p=l(o);var d=[];for(h=0;h<t.length;h++){var v=t[h];if(!n.traceIs(v,"box-violin")||(v[a+"axis"]||a)!==r)continue;if(v[p]!==undefined)d.push(v[p][0]);else if(v.name!==undefined)d.push(v.name);else d.push("text");if(v[c]!==f)f=undefined}e.type=i(d,f)}else if(o.type==="splom"){var m=o.dimensions;for(h=0;h<m.length;h++){var g=m[h];if(g.visible){e.type=i(g.values,f);break}}}else{e.type=i(o[a]||[o[a+"0"]],f)}}function s(e,t,r){for(var n=0;n<e.length;n++){var i=e[n];if(i.type==="splom"&&i._length>0&&i["_"+r+"axes"][t]){return i}if((i[r+"axis"]||r)===t){if(u(i,r)){return i}else if((i[r]||[]).length||i[r+"0"]){return i}}}}function l(e){return{v:"x",h:"y"}[e.orientation||"v"]}function u(e,t){var r=l(e),i=n.traceIs(e,"box-violin"),a=n.traceIs(e._fullInput||{},"candlestick");return i&&!a&&t===r&&e[r]===undefined&&e[r+"0"]===undefined}},{"../../registry":253,"./axis_autotype":206,"./axis_ids":208}],229:[function(e,t,r){"use strict";var n=e("../registry");var i=e("../lib");r.manageCommandObserver=function(e,t,n,o){var s={};var l=true;if(t&&t._commandObserver){s=t._commandObserver}if(!s.cache){s.cache={}}s.lookupTable={};var u=r.hasSimpleAPICommandBindings(e,n,s.lookupTable);if(t&&t._commandObserver){if(!u){if(t._commandObserver.remove){t._commandObserver.remove();t._commandObserver=null;return s}}else{return s}}if(u){a(e,u,s.cache);s.check=function t(){if(!l)return;var r=a(e,u,s.cache);if(r.changed&&o){if(s.lookupTable[r.value]!==undefined){s.disable();Promise.resolve(o({value:r.value,type:u.type,prop:u.prop,traces:u.traces,index:s.lookupTable[r.value]})).then(s.enable,s.enable)}}return r.changed};var c=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"];for(var f=0;f<c.length;f++){e._internalOn(c[f],s.check)}s.remove=function(){for(var t=0;t<c.length;t++){e._removeInternalListener(c[t],s.check)}}}else{i.log("Unable to automatically bind plot updates to API command");s.lookupTable={};s.remove=function(){}}s.disable=function e(){l=false};s.enable=function e(){l=true};if(t){t._commandObserver=s}return s};r.hasSimpleAPICommandBindings=function(e,t,n){var i;var a=t.length;var o;for(i=0;i<a;i++){var s;var l=t[i];var u=l.method;var c=l.args;if(!Array.isArray(c))c=[];if(!u){return false}var f=r.computeAPICommandBindings(e,u,c);if(f.length!==1){return false}if(!o){o=f[0];if(Array.isArray(o.traces)){o.traces.sort()}}else{s=f[0];if(s.type!==o.type){return false}if(s.prop!==o.prop){return false}if(Array.isArray(o.traces)){if(Array.isArray(s.traces)){s.traces.sort();for(var h=0;h<o.traces.length;h++){if(o.traces[h]!==s.traces[h]){return false}}}else{return false}}else{if(s.prop!==o.prop){return false}}}s=f[0];var p=s.value;if(Array.isArray(p)){if(p.length===1){p=p[0]}else{return false}}if(n){n[p]=i}}return o};function a(e,t,r){var n,a,o;var s=false;if(t.type==="data"){n=e._fullData[t.traces!==null?t.traces[0]:0]}else if(t.type==="layout"){n=e._fullLayout}else{return false}a=i.nestedProperty(n,t.prop).get();o=r[t.type]=r[t.type]||{};if(o.hasOwnProperty(t.prop)){if(o[t.prop]!==a){s=true}}o[t.prop]=a;return{changed:s,value:a}}r.executeAPICommand=function(e,t,r){if(t==="skip")return Promise.resolve();var a=n.apiMethodRegistry[t];var o=[e];if(!Array.isArray(r))r=[];for(var s=0;s<r.length;s++){o.push(r[s])}return a.apply(null,o).catch(function(e){i.warn("API call to Plotly."+t+" rejected.",e);return Promise.reject(e)})};r.computeAPICommandBindings=function(e,t,r){var n;if(!Array.isArray(r))r=[];switch(t){case"restyle":n=l(e,r);break;case"relayout":n=s(e,r);break;case"update":n=l(e,[r[0],r[2]]).concat(s(e,[r[1]]));break;case"animate":n=o(e,r);break;default:n=[]}return n};function o(e,t){if(Array.isArray(t[0])&&t[0].length===1&&["string","number"].indexOf(typeof t[0][0])!==-1){return[{type:"layout",prop:"_currentFrame",value:t[0][0].toString()}]}else{return[]}}function s(e,t){var r=[];var n=t[0];var a={};if(typeof n==="string"){a[n]=t[1]}else if(i.isPlainObject(n)){a=n}else{return r}u(a,function(e,t,n){r.push({type:"layout",prop:e,value:n})},"",0);return r}function l(e,t){var r,n,a,o;var s=[];n=t[0];a=t[1];r=t[2];o={};if(typeof n==="string"){o[n]=a}else if(i.isPlainObject(n)){o=n;if(r===undefined){r=a}}else{return s}if(r===undefined){r=null}u(o,function(t,n,i){var a;if(Array.isArray(i)){var o=Math.min(i.length,e.data.length);if(r){o=Math.min(o,r.length)}a=[];for(var l=0;l<o;l++){a[l]=r?r[l]:l}}else{a=r?r.slice(0):null}if(a===null){if(Array.isArray(i)){i=i[0]}}else if(Array.isArray(a)){if(!Array.isArray(i)){var u=i;i=[];for(var c=0;c<a.length;c++){i[c]=u}}i.length=Math.min(a.length,i.length)}s.push({type:"data",prop:t,traces:a,value:i})},"",0);return s}function u(e,t,r,n){Object.keys(e).forEach(function(a){var o=e[a];if(a[0]==="_")return;var s=r+(n>0?".":"")+a;if(i.isPlainObject(o)){u(o,t,s,n+1)}else{t(s,a,o)}})}},{"../lib":161,"../registry":253}],230:[function(e,t,r){"use strict";var n=e("../lib/extend").extendFlat;r.attributes=function(e,t){e=e||{};t=t||{};var r={valType:"info_array",editType:e.editType,items:[{valType:"number",min:0,max:1,editType:e.editType},{valType:"number",min:0,max:1,editType:e.editType}],dflt:[0,1]};var i=e.name?e.name+" ":"";var a=e.trace?"trace ":"subplot ";var o=t.description?" "+t.description:"";var s={x:n({},r,{}),y:n({},r,{}),editType:e.editType};if(!e.noGridCell){s.row={valType:"integer",min:0,dflt:0,editType:e.editType};s.column={valType:"integer",min:0,dflt:0,editType:e.editType}}return s};r.defaults=function(e,t,r,n){var i=n&&n.x||[0,1];var a=n&&n.y||[0,1];var o=t.grid;if(o){var s=r("domain.column");if(s!==undefined){if(s<o.columns)i=o._domains.x[s];else delete e.domain.column}var l=r("domain.row");if(l!==undefined){if(l<o.rows)a=o._domains.y[l];else delete e.domain.row}}r("domain.x",i);r("domain.y",a)}},{"../lib/extend":154}],231:[function(e,t,r){"use strict";t.exports=function(e){var t=e.editType;var r=e.colorEditType;if(r===undefined)r=t;var n={family:{valType:"string",noBlank:true,strict:true,editType:t},size:{valType:"number",min:1,editType:t},color:{valType:"color",editType:r},editType:t};if(e.arrayOk){n.family.arrayOk=true;n.size.arrayOk=true;n.color.arrayOk=true}return n}},{}],232:[function(e,t,r){"use strict";t.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],233:[function(e,t,r){"use strict";var n=e("../registry");var i=e("./cartesian/constants").SUBPLOT_PATTERN;r.getSubplotCalcData=function(e,t,r){var i=n.subplotsRegistry[t];if(!i)return[];var a=i.attr;var o=[];for(var s=0;s<e.length;s++){var l=e[s];var u=l[0].trace;if(u[a]===r)o.push(l)}return o};r.getModuleCalcData=function(e,t){var r=[];var i=[];var a;if(typeof t==="string"){a=n.getModule(t).plot}else if(typeof t==="function"){a=t}else{a=t.plot}if(!a){return[r,e]}for(var o=0;o<e.length;o++){var s=e[o];var l=s[0].trace;if(l.visible!==true)continue;if(l._module.plot===a){r.push(s)}else{i.push(s)}}return[r,i]};r.getSubplotData=function e(t,r,a){if(!n.subplotsRegistry[r])return[];var o=n.subplotsRegistry[r].attr;var s=[];var l,u,c;if(r==="gl2d"){var f=a.match(i);u="x"+f[1];c="y"+f[2]}for(var h=0;h<t.length;h++){l=t[h];if(r==="gl2d"&&n.traceIs(l,"gl2d")){if(l[o[0]]===u&&l[o[1]]===c){s.push(l)}}else{if(l[o]===a)s.push(l)}}return s};r.getUidsFromCalcData=function(e){var t={};for(var r=0;r<e.length;r++){var n=e[r][0].trace;t[n.uid]=1}return t}},{"../registry":253,"./cartesian/constants":210}],234:[function(e,t,r){"use strict";function n(e,t){var r=[0,0,0,0];var n,i;for(n=0;n<4;++n){for(i=0;i<4;++i){r[i]+=e[4*n+i]*t[n]}}return r}function i(e,t){var r=n(e.projection,n(e.view,n(e.model,[t[0],t[1],t[2],1])));return r}t.exports=i},{}],235:[function(e,t,r){"use strict";var n=e("./font_attributes");var i=e("../components/color/attributes");var a=n({editType:"calc"});a.family.dflt='"Open Sans", verdana, arial, sans-serif';a.size.dflt=12;a.color.dflt=i.defaultLine;t.exports={font:a,title:{valType:"string",editType:"layoutstyle"},titlefont:n({editType:"layoutstyle"}),autosize:{valType:"boolean",dflt:false,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},paper_bgcolor:{valType:"color",dflt:i.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:i.background,editType:"layoutstyle"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:false,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:i.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},template:{valType:"any",editType:"calc"}}},{"../components/color/attributes":41,"./font_attributes":231}],236:[function(e,t,r){"use strict";var n="0.45.0";t.exports={requiredVersion:n,styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",controlContainerClassName:"mapboxgl-control-container",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@"+n+"."].join("\n"),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.plot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join("\n"),mapOnErrorMsg:"Mapbox error.",styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none"}}},{}],237:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r){var i=t.split(" "),a=i[0],o=i[1];var s=n.isArrayOrTypedArray(r)?n.mean(r):r,l=.5+s/100,u=1.5+s/100;var c=["",""],f=[0,0];switch(a){case"top":c[0]="top";f[1]=-u;break;case"bottom":c[0]="bottom";f[1]=u;break}switch(o){case"left":c[1]="right";f[0]=-l;break;case"right":c[1]="left";f[0]=l;break}var h;if(c[0]&&c[1])h=c.join("-");else if(c[0])h=c[0];else if(c[1])h=c[1];else h="center";return{anchor:h,offset:f}}},{"../../lib":161}],238:[function(e,t,r){"use strict";var n=e("mapbox-gl");var i=e("../../lib");var a=e("../../plots/get_data").getSubplotCalcData;var o=e("../../constants/xmlns_namespaces");var s=e("./mapbox");var l=e("./constants");var u="mapbox";for(var c in l.styleRules){i.addStyleRule(".mapboxgl-"+c,l.styleRules[c])}r.name=u;r.attr="subplot";r.idRoot=u;r.idRegex=r.attrRegex=i.counterRegex(u);r.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}};r.layoutAttributes=e("./layout_attributes");r.supplyLayoutDefaults=e("./layout_defaults");r.plot=function e(t){var r=t._fullLayout;var o=t.calcdata;var c=r._subplots[u];if(n.version!==l.requiredVersion){throw new Error(l.wrongVersionErrorMsg)}var h=f(t,c);n.accessToken=h;for(var p=0;p<c.length;p++){var d=c[p],v=a(o,u,d),m=r[d],g=m._subplot;if(!g){g=s({gd:t,container:r._glcontainer.node(),id:d,fullLayout:r,staticPlot:t._context.staticPlot});r[d]._subplot=g}if(!g.viewInitial){g.viewInitial={center:i.extendFlat({},m.center),zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}}g.plot(v,r,t._promises)}};r.clean=function(e,t,r,n){var i=n._subplots[u]||[];for(var a=0;a<i.length;a++){var o=i[a];if(!t[o]&&!!n[o]._subplot){n[o]._subplot.destroy()}}};r.toSVG=function(e){var t=e._fullLayout;var r=t._subplots[u];var n=t._size;for(var i=0;i<r.length;i++){var a=t[r[i]],s=a.domain,l=a._subplot;var c=l.toImage("png");var f=t._glimages.append("svg:image");f.attr({xmlns:o.svg,"xlink:href":c,x:n.l+n.w*s.x[0],y:n.t+n.h*(1-s.y[1]),width:n.w*(s.x[1]-s.x[0]),height:n.h*(s.y[1]-s.y[0]),preserveAspectRatio:"none"});l.destroy()}};function f(e,t){var r=e._fullLayout,n=e._context;if(n.mapboxAccessToken==="")return"";for(var i=0;i<t.length;i++){var a=r[t[i]];if(a.accesstoken){return a.accesstoken}}throw new Error(l.noAccessTokenErrorMsg)}r.updateFx=function(e){var t=e._subplots[u];for(var r=0;r<t.length;r++){var n=e[t[r]]._subplot;n.updateFx(e)}}},{"../../constants/xmlns_namespaces":144,"../../lib":161,"../../plots/get_data":233,"./constants":236,"./layout_attributes":240,"./layout_defaults":241,"./mapbox":242,"mapbox-gl":14}],239:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("./convert_text_opts");function a(e,t){this.mapbox=e;this.map=e.map;this.uid=e.uid+"-"+"layer"+t;this.idSource=this.uid+"-source";this.idLayer=this.uid+"-layer";this.sourceType=null;this.source=null;this.layerType=null;this.below=null;this.visible=false}var o=a.prototype;o.update=function e(t){if(!this.visible){this.updateSource(t);this.updateLayer(t)}else if(this.needsNewSource(t)){this.removeLayer();this.updateSource(t);this.updateLayer(t)}else if(this.needsNewLayer(t)){this.updateLayer(t)}else{this.updateStyle(t)}this.visible=s(t)};o.needsNewSource=function(e){return this.sourceType!==e.sourcetype||this.source!==e.source||this.layerType!==e.type};o.needsNewLayer=function(e){return this.layerType!==e.type||this.below!==e.below};o.updateSource=function(e){var t=this.map;if(t.getSource(this.idSource))t.removeSource(this.idSource);this.sourceType=e.sourcetype;this.source=e.source;if(!s(e))return;var r=u(e);t.addSource(this.idSource,r)};o.updateLayer=function(e){var t=this.map;var r=l(e);this.removeLayer();this.layerType=e.type;if(s(e)){t.addLayer({id:this.idLayer,source:this.idSource,"source-layer":e.sourcelayer||"",type:e.type,layout:r.layout,paint:r.paint},e.below)}};o.updateStyle=function(e){if(s(e)){var t=l(e);this.mapbox.setOptions(this.idLayer,"setLayoutProperty",t.layout);this.mapbox.setOptions(this.idLayer,"setPaintProperty",t.paint)}};o.removeLayer=function(){var e=this.map;if(e.getLayer(this.idLayer)){e.removeLayer(this.idLayer)}};o.dispose=function e(){var t=this.map;t.removeLayer(this.idLayer);t.removeSource(this.idSource)};function s(e){var t=e.source;return e.visible&&(n.isPlainObject(t)||typeof t==="string"&&t.length>0)}function l(e){var t={},r={};switch(e.type){case"circle":n.extendFlat(r,{"circle-radius":e.circle.radius,"circle-color":e.color,"circle-opacity":e.opacity});break;case"line":n.extendFlat(r,{"line-width":e.line.width,"line-color":e.color,"line-opacity":e.opacity});break;case"fill":n.extendFlat(r,{"fill-color":e.color,"fill-outline-color":e.fill.outlinecolor,"fill-opacity":e.opacity});break;case"symbol":var a=e.symbol,o=i(a.textposition,a.iconsize);n.extendFlat(t,{"icon-image":a.icon+"-15","icon-size":a.iconsize/10,"text-field":a.text,"text-size":a.textfont.size,"text-anchor":o.anchor,"text-offset":o.offset});n.extendFlat(r,{"icon-color":e.color,"text-color":a.textfont.color,"text-opacity":e.opacity});break}return{layout:t,paint:r}}function u(e){var t=e.sourcetype;var r=e.source;var n={type:t};var i;if(t==="geojson"){i="data"}else if(t==="vector"){i=typeof r==="string"?"url":"tiles"}n[i]=r;return n}t.exports=function e(t,r,n){var i=new a(t,r);i.update(n);return i}},{"../../lib":161,"./convert_text_opts":237}],240:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../components/color").defaultLine;var a=e("../domain").attributes;var o=e("../font_attributes");var s=e("../../traces/scatter/attributes").textposition;var l=e("../../plot_api/edit_types").overrideAll;var u=e("../../plot_api/plot_template").templatedArray;var c=o({});c.family.dflt="Open Sans Regular, Arial Unicode MS Regular";t.exports=l({_arrayAttrRegexps:[n.counterRegex("mapbox",".layers",true)],domain:a({name:"mapbox"}),accesstoken:{valType:"string",noBlank:true,strict:true},style:{valType:"any",values:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],dflt:"basic"},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:u("layer",{visible:{valType:"boolean",dflt:true},sourcetype:{valType:"enumerated",values:["geojson","vector"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},type:{valType:"enumerated",values:["circle","line","fill","symbol"],dflt:"circle"},below:{valType:"string",dflt:""},color:{valType:"color",dflt:i},opacity:{valType:"number",min:0,max:1,dflt:1},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2}},fill:{outlinecolor:{valType:"color",dflt:i}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},textfont:c,textposition:n.extendFlat({},s,{arrayOk:false})}})},"plot","from-root")},{"../../components/color":42,"../../lib":161,"../../plot_api/edit_types":188,"../../plot_api/plot_template":195,"../../traces/scatter/attributes":265,"../domain":230,"../font_attributes":231}],241:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../subplot_defaults");var a=e("../array_container_defaults");var o=e("./layout_attributes");t.exports=function e(t,r,n){i(t,r,n,{type:"mapbox",attributes:o,handleDefaults:s,partition:"y",accessToken:r._mapboxAccessToken})};function s(e,t,r,n){r("accesstoken",n.accessToken);r("style");r("center.lon");r("center.lat");r("zoom");r("bearing");r("pitch");a(e,t,{name:"layers",handleItemDefaults:l});t._input=e}function l(e,t){function r(r,i){return n.coerce(e,t,o.layers,r,i)}var i=r("visible");if(i){var a=r("sourcetype");r("source");if(a==="vector")r("sourcelayer");var s=r("type");r("below");r("color");r("opacity");if(s==="circle"){r("circle.radius")}if(s==="line"){r("line.width")}if(s==="fill"){r("fill.outlinecolor")}if(s==="symbol"){r("symbol.icon");r("symbol.iconsize");r("symbol.text");n.coerceFont(r,"symbol.textfont");r("symbol.textposition")}}}},{"../../lib":161,"../array_container_defaults":201,"../subplot_defaults":252,"./layout_attributes":240}],242:[function(e,t,r){"use strict";var n=e("mapbox-gl");var i=e("../../components/fx");var a=e("../../lib");var o=e("../../components/dragelement");var s=e("../cartesian/select").prepSelect;var l=e("./constants");var u=e("./layout_attributes");var c=e("./layers");function f(e){this.id=e.id;this.gd=e.gd;this.container=e.container;this.isStatic=e.staticPlot;var t=e.fullLayout;this.uid=t._uid+"-"+this.id;this.opts=t[this.id];this.div=null;this.xaxis=null;this.yaxis=null;this.createFramework(t);this.map=null;this.accessToken=null;this.styleObj=null;this.traceHash={};this.layerList=[]}var h=f.prototype;t.exports=function e(t){return new f(t)};h.plot=function(e,t,r){var n=this;var i=n.opts=t[this.id];if(n.map&&i.accesstoken!==n.accessToken){n.map.remove();n.map=null;n.styleObj=null;n.traceHash=[];n.layerList={}}var a;if(!n.map){a=new Promise(function(r,i){n.createMap(e,t,r,i)})}else{a=new Promise(function(r,i){n.updateMap(e,t,r,i)})}r.push(a)};h.createMap=function(e,t,r,a){var o=this;var s=o.gd;var u=o.opts;var c=o.styleObj=p(u.style);o.accessToken=u.accesstoken;var f=o.map=new n.Map({container:o.div,style:c.style,center:v(u.center),zoom:u.zoom,bearing:u.bearing,pitch:u.pitch,interactive:!o.isStatic,preserveDrawingBuffer:o.isStatic,doubleClickZoom:false,boxZoom:false});var h=l.controlContainerClassName;var d=o.div.getElementsByClassName(h)[0];o.div.removeChild(d);f._canvas.style.left="0px";f._canvas.style.top="0px";o.rejectOnError(a);f.once("load",function(){o.updateData(e);o.updateLayout(t);o.resolveOnRender(r)});if(o.isStatic)return;var m=false;f.on("moveend",function(e){if(!o.map)return;var t=o.getView();u._input.center=u.center=t.center;u._input.zoom=u.zoom=t.zoom;u._input.bearing=u.bearing=t.bearing;u._input.pitch=u.pitch=t.pitch;if(e.originalEvent||m){y(t)}m=false});f.on("wheel",function(){m=true});f.on("mousemove",function(e){var t=o.div.getBoundingClientRect();e.clientX=e.point.x+t.left;e.clientY=e.point.y+t.top;e.target.getBoundingClientRect=function(){return t};o.xaxis.p2c=function(){return e.lngLat.lng};o.yaxis.p2c=function(){return e.lngLat.lat};i.hover(s,e,o.id)});f.on("click",function(e){i.click(s,e.originalEvent)});function g(){i.loneUnhover(t._toppaper)}f.on("dragstart",g);f.on("zoomstart",g);f.on("dblclick",function(){s.emit("plotly_doubleclick",null);var e=o.viewInitial;f.setCenter(v(e.center));f.setZoom(e.zoom);f.setBearing(e.bearing);f.setPitch(e.pitch);var t=o.getView();u._input.center=u.center=t.center;u._input.zoom=u.zoom=t.zoom;u._input.bearing=u.bearing=t.bearing;u._input.pitch=u.pitch=t.pitch;y(t)});function y(e){var t=o.id;var r={};for(var n in e){r[t+"."+n]=e[n]}s.emit("plotly_relayout",r)}o.clearSelect=function(){s._fullLayout._zoomlayer.selectAll(".select-outline").remove()}};h.updateMap=function(e,t,r,n){var i=this;var a=i.map;i.rejectOnError(n);var o=p(i.opts.style);if(i.styleObj.id!==o.id){i.styleObj=o;a.setStyle(o.style);a.once("styledata",function(){i.traceHash={};i.updateData(e);i.updateLayout(t);i.resolveOnRender(r)})}else{i.updateData(e);i.updateLayout(t);i.resolveOnRender(r)}};h.updateData=function(e){var t=this.traceHash;var r,n,i,a;for(i=0;i<e.length;i++){var o=e[i];n=o[0].trace;r=t[n.uid];if(r){r.update(o)}else if(n._module){t[n.uid]=n._module.plot(this,o)}}var s=Object.keys(t);e:for(i=0;i<s.length;i++){var l=s[i];for(a=0;a<e.length;a++){n=e[a][0].trace;if(l===n.uid)continue e}r=t[l];r.dispose();delete t[l]}};h.updateLayout=function(e){var t=this.map,r=this.opts;t.setCenter(v(r.center));t.setZoom(r.zoom);t.setBearing(r.bearing);t.setPitch(r.pitch);this.updateLayers();this.updateFramework(e);this.updateFx(e);this.map.resize()};h.resolveOnRender=function(e){var t=this.map;t.on("render",function r(){if(t.loaded()){t.off("render",r);setTimeout(e,0)}})};h.rejectOnError=function(e){var t=this.map;function r(){e(new Error(l.mapOnErrorMsg))}t.once("error",r);t.once("style.error",r);t.once("source.error",r);t.once("tile.error",r);t.once("layer.error",r)};h.createFramework=function(e){var t=this;var r=t.div=document.createElement("div");r.id=t.uid;r.style.position="absolute";t.container.appendChild(r);t.xaxis={_id:"x",c2p:function(e){return t.project(e).x}};t.yaxis={_id:"y",c2p:function(e){return t.project(e).y}};t.updateFramework(e)};h.updateFx=function(e){var t=this;var r=t.map;var n=t.gd;if(t.isStatic)return;function i(e){var r=t.map.unproject(e);return[r.lng,r.lat]}var a=e.dragmode;var l;if(a==="select"){l=function(e,r){var n=e.range={};n[t.id]=[i([r.xmin,r.ymin]),i([r.xmax,r.ymax])]}}else{l=function(e,r,n){var a=e.lassoPoints={};a[t.id]=n.filtered.map(i)}}if(a==="select"||a==="lasso"){r.dragPan.disable();r.on("zoomstart",t.clearSelect);var u={element:t.div,gd:n,plotinfo:{xaxis:t.xaxis,yaxis:t.yaxis,fillRangeItems:l},xaxes:[t.xaxis],yaxes:[t.yaxis],subplot:t.id};u.prepFn=function(e,t,r){s(e,t,r,u,a)};o.init(u)}else{r.dragPan.enable();r.off("zoomstart",t.clearSelect);t.div.onmousedown=null}};h.updateFramework=function(e){var t=e[this.id].domain;var r=e._size;var n=this.div.style;n.width=r.w*(t.x[1]-t.x[0])+"px";n.height=r.h*(t.y[1]-t.y[0])+"px";n.left=r.l+t.x[0]*r.w+"px";n.top=r.t+(1-t.y[1])*r.h+"px";this.xaxis._offset=r.l+t.x[0]*r.w;this.xaxis._length=r.w*(t.x[1]-t.x[0]);this.yaxis._offset=r.t+(1-t.y[1])*r.h;this.yaxis._length=r.h*(t.y[1]-t.y[0])};h.updateLayers=function(){var e=this.opts;var t=e.layers;var r=this.layerList;var n;if(t.length!==r.length){for(n=0;n<r.length;n++){r[n].dispose()}r=this.layerList=[];for(n=0;n<t.length;n++){r.push(c(this,n,t[n]))}}else{for(n=0;n<t.length;n++){r[n].update(t[n])}}};h.destroy=function(){if(this.map){this.map.remove();this.map=null;this.container.removeChild(this.div)}};h.toImage=function(){this.map.stop();return this.map.getCanvas().toDataURL()};h.setOptions=function(e,t,r){for(var n in r){this.map[t](e,n,r[n])}};h.project=function(e){return this.map.project(new n.LngLat(e[0],e[1]))};h.getView=function(){var e=this.map;var t=e.getCenter();var r={lon:t.lng,lat:t.lat};return{center:r,zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch()}};function p(e){var t=u.style.values;var r=u.style.dflt;var n={};if(a.isPlainObject(e)){n.id=e.id;n.style=e}else if(typeof e==="string"){n.id=e;n.style=t.indexOf(e)!==-1?d(e):e}else{n.id=r;n.style=d(r)}n.transition={duration:0,delay:0};return n}function d(e){return l.styleUrlPrefix+e+"-"+l.styleUrlSuffix}function v(e){return[e.lon,e.lat]}},{"../../components/dragelement":64,"../../components/fx":84,"../../lib":161,"../cartesian/select":222,"./constants":236,"./layers":239,"./layout_attributes":240,"mapbox-gl":14}],243:[function(e,t,r){"use strict";t.exports={t:{valType:"number",dflt:0,editType:"arraydraw"},r:{valType:"number",dflt:0,editType:"arraydraw"},b:{valType:"number",dflt:0,editType:"arraydraw"},l:{valType:"number",dflt:0,editType:"arraydraw"},editType:"arraydraw"}},{}],244:[function(e,t,r){"use strict";var n=e("d3");var i=e("fast-isnumeric");var a=e("../registry");var o=e("../plot_api/plot_schema");var s=e("../plot_api/plot_template");var l=e("../lib");var u=e("../components/color");var c=e("../constants/numerical").BADNUM;var f=e("../plots/cartesian/axis_ids");var h=e("./sort_modules").sortBasePlotModules;var p=e("./animation_attributes");var d=e("./frame_attributes");var v=l.relinkPrivateKeys;var m=l._;var g=t.exports={};l.extendFlat(g,a);g.attributes=e("./attributes");g.attributes.type.values=g.allTypes;g.fontAttrs=e("./font_attributes");g.layoutAttributes=e("./layout_attributes");g.fontWeight="normal";var y=g.transformsRegistry;var _=e("./command");g.executeAPICommand=_.executeAPICommand;g.computeAPICommandBindings=_.computeAPICommandBindings;g.manageCommandObserver=_.manageCommandObserver;g.hasSimpleAPICommandBindings=_.hasSimpleAPICommandBindings;g.redrawText=function(e){e=l.getGraphDiv(e);if(e.data&&e.data[0]&&e.data[0].r)return;return new Promise(function(t){setTimeout(function(){a.getComponentMethod("annotations","draw")(e);a.getComponentMethod("legend","draw")(e);(e.calcdata||[]).forEach(function(e){if(e[0]&&e[0].t&&e[0].t.cb)e[0].t.cb()});t(g.previousPromises(e))},300)})};g.resize=function(e){e=l.getGraphDiv(e);return new Promise(function(t,r){function n(e){var t=window.getComputedStyle(e).display;return!t||t==="none"}if(!e||n(e)){r(new Error("Resize must be passed a displayed plot div element."))}if(e._redrawTimer)clearTimeout(e._redrawTimer);e._redrawTimer=setTimeout(function(){if(!e.layout||e.layout.width&&e.layout.height||n(e)){t(e);return}delete e.layout.width;delete e.layout.height;var r=e.changed;e.autoplay=true;a.call("relayout",e,{autosize:true}).then(function(){e.changed=r;t(e)})},100)})};g.previousPromises=function(e){if((e._promises||[]).length){return Promise.all(e._promises).then(function(){e._promises=[]})}};g.addLinks=function(e){if(!e._context.showLink&&!e._context.showSources)return;var t=e._fullLayout;var r=l.ensureSingle(t._paper,"text","js-plot-link-container",function(e){e.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:u.defaultLine,"pointer-events":"all"}).each(function(){var e=n.select(this);e.append("tspan").classed("js-link-to-tool",true);e.append("tspan").classed("js-link-spacer",true);e.append("tspan").classed("js-sourcelinks",true)})});var i=r.node();var a={y:t._paper.attr("height")-9};if(document.body.contains(i)&&i.getComputedTextLength()>=t.width-20){a["text-anchor"]="start";a.x=5}else{a["text-anchor"]="end";a.x=t._paper.attr("width")-7}r.attr(a);var o=r.select(".js-link-to-tool"),s=r.select(".js-link-spacer"),c=r.select(".js-sourcelinks");if(e._context.showSources)e._context.showSources(e);if(e._context.showLink)x(e,o);s.text(o.text()&&c.text()?" - ":"")};function x(e,t){t.text("");var r=t.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(e._context.linkText+" "+String.fromCharCode(187));if(e._context.sendData){r.on("click",function(){g.sendDataToCloud(e)})}else{var n=window.location.pathname.split("/");var i=window.location.search;r.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+n[2].split(".")[0]+"/"+n[1]+i})}}g.sendDataToCloud=function(e){e.emit("plotly_beforeexport");var t=(window.PLOTLYENV||{}).BASE_URL||e._context.plotlyServerURL;var r=n.select(e).append("div").attr("id","hiddenform").style("display","none");var i=r.append("form").attr({action:t+"/external",method:"post",target:"_blank"});var a=i.append("input").attr({type:"text",name:"data"});a.node().value=g.graphJson(e,false,"keepdata");i.node().submit();r.remove();e.emit("plotly_afterexport");return false};var b=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"];var w=["year","month","dayMonth","dayMonthYear"];g.supplyDefaults=function(e,t){var r=t&&t.skipUpdateCalc;var n=e._fullLayout||{};if(n._skipDefaults){delete n._skipDefaults;return}var i=e._fullLayout={};var o=e.layout||{};var s=e._fullData||[];var u=e._fullData=[];var c=e.data||[];var p=e.calcdata||[];var d=e._context||{};var y;if(!e._transitionData)g.createTransitionData(e);i._dfltTitle={plot:m(e,"Click to enter Plot title"),x:m(e,"Click to enter X axis title"),y:m(e,"Click to enter Y axis title"),colorbar:m(e,"Click to enter Colorscale title"),annotation:m(e,"new text")};i._traceWord=m(e,"trace");var _=M(e,b);i._mapboxAccessToken=d.mapboxAccessToken;if(n._initialAutoSizeIsDone){var x=n.width,A=n.height;g.supplyLayoutGlobalDefaults(o,i,_);if(!o.width)i.width=x;if(!o.height)i.height=A;g.sanitizeMargins(i)}else{g.supplyLayoutGlobalDefaults(o,i,_);var C=!o.width||!o.height,z=i.autosize,E=d.autosizable,L=C&&(z||E);if(L)g.plotAutoSize(e,o,i);else if(C)g.sanitizeMargins(i);if(!z&&C){o.width=i.width;o.height=i.height}}i._d3locale=S(_,i.separators);i._extraFormat=M(e,w);i._initialAutoSizeIsDone=true;i._dataLength=c.length;i._modules=[];i._basePlotModules=[];var I=i._subplots=T();var P=i._splomAxes={x:{},y:{}};var D=i._splomSubplots={};i._splomGridDflt={};i._requestRangeslider={};i._traceUids=k(s,c);i._globalTransforms=(e._context||{}).globalTransforms;g.supplyDataDefaults(c,u,o,i);var O=Object.keys(P.x);var R=Object.keys(P.y);if(O.length>1&&R.length>1){a.getComponentMethod("grid","sizeDefaults")(o,i);for(y=0;y<O.length;y++){l.pushUnique(I.xaxis,O[y])}for(y=0;y<R.length;y++){l.pushUnique(I.yaxis,R[y])}for(var F in D){l.pushUnique(I.cartesian,F)}}i._has=g._hasPlotType.bind(i);var B=i._modules;for(y=0;y<B.length;y++){var N=B[y];if(N.cleanData)N.cleanData(u)}if(s.length===u.length){for(y=0;y<u.length;y++){v(u[y],s[y])}}g.supplyLayoutModuleDefaults(o,i,u,e._transitionData);i._hasOnlyLargeSploms=i._basePlotModules.length===1&&i._basePlotModules[0].name==="splom"&&O.length>15&&R.length>15&&i.shapes.length===0&&i.images.length===0;i._hasCartesian=i._has("cartesian");i._hasGeo=i._has("geo");i._hasGL3D=i._has("gl3d");i._hasGL2D=i._has("gl2d");i._hasTernary=i._has("ternary");i._hasPie=i._has("pie");g.linkSubplots(u,i,s,n);g.cleanPlot(u,i,s,n,p);v(i,n);g.doAutoMargin(e);var j=f.list(e);for(y=0;y<j.length;y++){var V=j[y];V.setScale()}if(!r&&p.length===u.length){g.supplyDefaultsUpdateCalc(p,u)}i._basePlotModules.sort(h)};g.supplyDefaultsUpdateCalc=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];var i=e[r][0];if(i&&i.trace){var a=i.trace;if(a._hasCalcTransform){var o=a._arrayAttrs;var s,u,c;for(s=0;s<o.length;s++){u=o[s];c=l.nestedProperty(a,u).get().slice();l.nestedProperty(n,u).set(c)}}i.trace=n}}};function k(e,t){var r=t.length;var n=[];var i,a;for(i=0;i<e.length;i++){var o=e[i]._fullInput;if(o!==a)n.push(o);a=o}var s=n.length;var u=new Array(r);var c={};function f(e,t){u[t]=e;c[e]=1}function h(e,t){if(e&&typeof e==="string"&&!c[e]){f(e,t);return true}}for(i=0;i<r;i++){if(h(t[i].uid,i))continue;if(i<s&&h(n[i].uid,i))continue;f(l.randstr(c),i)}return u}var A;function T(){var e={};var t,r;if(!A){A=[];var n=a.subplotsRegistry;for(var i in n){var o=n[i];var s=o.attr;if(s){A.push(i);if(Array.isArray(s)){for(r=0;r<s.length;r++){l.pushUnique(A,s[r])}}}}}for(t=0;t<A.length;t++){e[A[t]]=[]}return e}function M(e,t){var r=e._context.locale;if(!r)r==="en-US";var n=false;var i={};function o(e){var r=true;for(var a=0;a<t.length;a++){var o=t[a];if(!i[o]){if(e[o]){i[o]=e[o]}else r=false}}if(r)n=true}for(var s=0;s<2;s++){var l=e._context.locales;for(var u=0;u<2;u++){var c=(l[r]||{}).format;if(c){o(c);if(n)break}l=a.localeRegistry}var f=r.split("-")[0];if(n||f===r)break;r=f}if(!n)o(a.localeRegistry.en.format);return i}function S(e,t){e.decimal=t.charAt(0);e.thousands=t.charAt(1);return n.locale(e)}g.createTransitionData=function(e){if(!e._transitionData){e._transitionData={}}if(!e._transitionData._frames){e._transitionData._frames=[]}if(!e._transitionData._frameHash){e._transitionData._frameHash={}}if(!e._transitionData._counter){e._transitionData._counter=0}if(!e._transitionData._interruptCallbacks){e._transitionData._interruptCallbacks=[]}};g._hasPlotType=function(e){var t;var r=this._basePlotModules||[];for(t=0;t<r.length;t++){if(r[t].name===e)return true}var n=this._modules||[];for(t=0;t<n.length;t++){var i=n[t].name;if(i===e)return true;var o=a.modules[i];if(o&&o.categories[e])return true}return false};g.cleanPlot=function(e,t,r,n,i){var a,o;var s=n._basePlotModules||[];for(a=0;a<s.length;a++){var l=s[a];if(l.clean){l.clean(e,t,r,n,i)}}var u=n._has&&n._has("gl");var c=t._has&&t._has("gl");if(u&&!c){if(n._glcontainer!==undefined){n._glcontainer.selectAll(".gl-canvas").remove();n._glcontainer.selectAll(".no-webgl").remove();n._glcanvas=null}}var f=!!n._infolayer;e:for(a=0;a<r.length;a++){var h=r[a],p=h.uid;for(o=0;o<e.length;o++){var d=e[o];if(p===d.uid)continue e}if(f){n._infolayer.select(".cb"+p).remove()}}if(n._zoomlayer){n._zoomlayer.selectAll(".select-outline").remove()}};g.linkSubplots=function(e,t,r,n){var i=n._plots||{};var a=t._plots={};var o=t._subplots;var s={_fullData:e,_fullLayout:t};var l=o.cartesian.concat(o.gl2d||[]);var u,c,h,p;for(u=0;u<l.length;u++){h=l[u];var d=i[h];var v=f.getFromId(s,h,"x");var m=f.getFromId(s,h,"y");var g;if(d){g=a[h]=d;if(g.xaxis.layer!==v.layer){g.xlines.attr("d",null);g.xaxislayer.selectAll("*").remove()}if(g.yaxis.layer!==m.layer){g.ylines.attr("d",null);g.yaxislayer.selectAll("*").remove()}}else{g=a[h]={};g.id=h}g.xaxis=v;g.yaxis=m;g._hasClipOnAxisFalse=false;for(c=0;c<e.length;c++){var y=e[c];if(y.xaxis===g.xaxis._id&&y.yaxis===g.yaxis._id&&y.cliponaxis===false){g._hasClipOnAxisFalse=true;break}}}var _=f.list(s,null,true);for(u=0;u<_.length;u++){p=_[u];var x=null;if(p.overlaying){x=f.getFromId(s,p.overlaying);if(x&&x.overlaying){p.overlaying=false;x=null}}p._mainAxis=x||p;if(x)p.domain=x.domain.slice();p._anchorAxis=p.anchor==="free"?null:f.getFromId(s,p.anchor)}};g.clearExpandedTraceDefaultColors=function(e){var t,r,n;function i(e,n,i,a){r[a]=n;r.length=a+1;if(e.valType==="color"&&e.dflt===undefined){t.push(r.join("."))}}r=[];t=e._module._colorAttrs;if(!t){e._module._colorAttrs=t=[];o.crawl(e._module.attributes,i)}for(n=0;n<t.length;n++){var a=l.nestedProperty(e,"_input."+t[n]);if(!a.get()){l.nestedProperty(e,t[n]).set(null)}}};g.supplyDataDefaults=function(e,t,r,n){var i=n._modules;var o=n._basePlotModules;var u=0;var c=0;var f,h,p;n._transformModules=[];function d(e){t.push(e);var r=e._module;if(!r)return;if(e.visible===true)l.pushUnique(i,r);l.pushUnique(o,e._module.basePlotModule);u++;if(e._input.visible!==false)c++}var m={};var y=[];var _=(r.template||{}).data||{};var x=s.traceTemplater(_);for(f=0;f<e.length;f++){p=e[f];h=x.newTrace(p);h.uid=n._traceUids[f];g.supplyTraceDefaults(p,h,c,n,f);h.uid=n._traceUids[f];h.index=f;h._input=p;h._expandedIndex=u;if(h.transforms&&h.transforms.length){var b=z(h,t,r,n);for(var w=0;w<b.length;w++){var k=b[w];var A={_template:h._template,type:h.type,uid:h.uid+w};g.supplyTraceDefaults(k,A,u,n,f);v(A,k);A.index=f;A._input=p;A._fullInput=h;A._expandedIndex=u;A._expandedInput=k;d(A)}}else{h._fullInput=h;h._expandedInput=h;d(h)}if(a.traceIs(h,"carpetAxis")){m[h.carpet]=h}if(a.traceIs(h,"carpetDependent")){y.push(f)}}for(f=0;f<y.length;f++){h=t[y[f]];if(!h.visible)continue;var T=m[h.carpet];h._carpet=T;if(!T||!T.visible){h.visible=false;continue}h.xaxis=T.xaxis;h.yaxis=T.yaxis}};g.supplyAnimationDefaults=function(e){e=e||{};var t;var r={};function n(t,n){return l.coerce(e||{},r,p,t,n)}n("mode");n("direction");n("fromcurrent");if(Array.isArray(e.frame)){r.frame=[];for(t=0;t<e.frame.length;t++){r.frame[t]=g.supplyAnimationFrameDefaults(e.frame[t]||{})}}else{r.frame=g.supplyAnimationFrameDefaults(e.frame||{})}if(Array.isArray(e.transition)){r.transition=[];for(t=0;t<e.transition.length;t++){r.transition[t]=g.supplyAnimationTransitionDefaults(e.transition[t]||{})}}else{r.transition=g.supplyAnimationTransitionDefaults(e.transition||{})}return r};g.supplyAnimationFrameDefaults=function(e){var t={};function r(r,n){return l.coerce(e||{},t,p.frame,r,n)}r("duration");r("redraw");return t};g.supplyAnimationTransitionDefaults=function(e){var t={};function r(r,n){return l.coerce(e||{},t,p.transition,r,n)}r("duration");r("easing");return t};g.supplyFrameDefaults=function(e){var t={};function r(r,n){return l.coerce(e,t,d,r,n)}r("group");r("name");r("traces");r("baseframe");r("data");r("layout");return t};g.supplyTraceDefaults=function(e,t,r,n,i){var o=n.colorway||u.defaults;var s=o[r%o.length];var c;function f(r,n){return l.coerce(e,t,g.attributes,r,n)}var h=f("visible");f("type");f("name",n._traceWord+" "+i);var p=g.getModule(t);t._module=p;if(p){var d=p.basePlotModule;var v=d.attr;var m=d.attributes;if(v&&m){var y=n._subplots;var _="";if(d.name!=="gl2d"||h){if(Array.isArray(v)){for(c=0;c<v.length;c++){var x=v[c];var b=l.coerce(e,t,m,x);if(y[x])l.pushUnique(y[x],b);_+=b}}else{_=l.coerce(e,t,m,v)}if(y[d.name]){l.pushUnique(y[d.name],_)}}}}if(h){f("customdata");f("ids");if(a.traceIs(t,"showLegend")){f("showlegend");f("legendgroup")}a.getComponentMethod("fx","supplyDefaults")(e,t,s,n);if(p){p.supplyDefaults(e,t,s,n);l.coerceHoverinfo(e,t,n)}if(!a.traceIs(t,"noOpacity"))f("opacity");if(a.traceIs(t,"notLegendIsolatable")){t.visible=!!t.visible}if(p&&p.selectPoints){f("selectedpoints")}g.supplyTransformDefaults(e,t,n)}return t};function C(e){var t=e.transforms;if(Array.isArray(t)&&t.length){for(var r=0;r<t.length;r++){var n=y[t[r].type];if(n&&n.makesData)return true}}return false}g.supplyTransformDefaults=function(e,t,r){if(!(t._length||C(e)))return;var n=r._globalTransforms||[];var i=r._transformModules||[];if(!Array.isArray(e.transforms)&&n.length===0)return;var a=e.transforms||[],o=n.concat(a),s=t.transforms=[];for(var u=0;u<o.length;u++){var c=o[u],f=c.type,h=y[f],p;var d=!(c._module&&c._module===h),v=h&&typeof h.transform==="function";if(!h)l.warn("Unrecognized transform type "+f+".");if(h&&h.supplyDefaults&&(d||v)){p=h.supplyDefaults(c,t,r,e);p.type=f;p._module=h;l.pushUnique(i,h)}else{p=l.extendFlat({},c)}s.push(p)}};function z(e,t,r,n){var i=e.transforms,a=[e];for(var o=0;o<i.length;o++){var s=i[o],l=y[s.type];if(l&&l.transform){a=l.transform(a,{transform:s,fullTrace:e,fullData:t,layout:r,fullLayout:n,transformIndex:o})}}return a}g.supplyLayoutGlobalDefaults=function(e,t,r){function n(r,n){return l.coerce(e,t,g.layoutAttributes,r,n)}var i=e.template;if(l.isPlainObject(i)){t.template=i;t._template=i.layout;t._dataTemplate=i.data}var o=l.coerceFont(n,"font");n("title",t._dfltTitle.plot);l.coerceFont(n,"titlefont",{family:o.family,size:Math.round(o.size*1.4),color:o.color});n("autosize",!(e.width&&e.height));n("width");n("height");n("margin.l");n("margin.r");n("margin.t");n("margin.b");n("margin.pad");n("margin.autoexpand");if(e.width&&e.height)g.sanitizeMargins(t);a.getComponentMethod("grid","sizeDefaults")(e,t);n("paper_bgcolor");n("separators",r.decimal+r.thousands);n("hidesources");n("colorway");n("datarevision");a.getComponentMethod("calendars","handleDefaults")(e,t,"calendar");a.getComponentMethod("fx","supplyLayoutGlobalDefaults")(e,t,n)};g.plotAutoSize=function e(t,r,n){var a=t._context||{},o=a.frameMargins,s,u;var c=l.isPlotDiv(t);if(c)t.emit("plotly_autosize");if(a.fillFrame){s=window.innerWidth;u=window.innerHeight;document.body.style.overflow="hidden"}else if(i(o)&&o>0){var f=E(t._boundingBoxMargins),h=f.left+f.right,p=f.bottom+f.top,d=1-2*o;var v=n._container&&n._container.node?n._container.node().getBoundingClientRect():{width:n.width,height:n.height};s=Math.round(d*(v.width-h));u=Math.round(d*(v.height-p))}else{var m=c?window.getComputedStyle(t):{};s=parseFloat(m.width)||n.width;u=parseFloat(m.height)||n.height}var y=g.layoutAttributes.width.min,_=g.layoutAttributes.height.min;if(s<y)s=y;if(u<_)u=_;var x=!r.width&&Math.abs(n.width-s)>1,b=!r.height&&Math.abs(n.height-u)>1;if(b||x){if(x)n.width=s;if(b)n.height=u}if(!t._initialAutoSize){t._initialAutoSize={width:s,height:u}}g.sanitizeMargins(n)};function E(e){var t={left:0,right:0,bottom:0,top:0},r;if(e){for(r in e){if(e.hasOwnProperty(r)){t.left+=e[r].left||0;t.right+=e[r].right||0;t.bottom+=e[r].bottom||0;t.top+=e[r].top||0}}}return t}g.supplyLayoutModuleDefaults=function(e,t,r,n){var i=a.componentsRegistry;var o=t._basePlotModules;var s,u,c;var f=a.subplotsRegistry.cartesian;for(s in i){c=i[s];if(c.includeBasePlot){c.includeBasePlot(e,t)}}if(!o.length){o.push(f)}if(t._has("cartesian")){a.getComponentMethod("grid","contentDefaults")(e,t);f.finalizeSubplots(e,t)}for(var h in t._subplots){t._subplots[h].sort(l.subplotSort)}for(u=0;u<o.length;u++){c=o[u];if(c.supplyLayoutDefaults){c.supplyLayoutDefaults(e,t,r)}}var p=t._modules;for(u=0;u<p.length;u++){c=p[u];if(c.supplyLayoutDefaults){c.supplyLayoutDefaults(e,t,r)}}var d=t._transformModules;for(u=0;u<d.length;u++){c=d[u];if(c.supplyLayoutDefaults){c.supplyLayoutDefaults(e,t,r,n)}}for(s in i){c=i[s];if(c.supplyLayoutDefaults){c.supplyLayoutDefaults(e,t,r)}}};g.purge=function(e){var t=e._fullLayout||{};if(t._glcontainer!==undefined){t._glcontainer.selectAll(".gl-canvas").remove();t._glcontainer.remove();t._glcanvas=null}if(t._geocontainer!==undefined)t._geocontainer.remove();if(t._modeBar)t._modeBar.destroy();if(e._transitionData){if(e._transitionData._interruptCallbacks){e._transitionData._interruptCallbacks.length=0}if(e._transitionData._animationRaf){window.cancelAnimationFrame(e._transitionData._animationRaf)}}l.clearThrottle();delete e.data;delete e.layout;delete e._fullData;delete e._fullLayout;delete e.calcdata;delete e.framework;delete e.empty;delete e.fid;delete e.undoqueue;delete e.undonum;delete e.autoplay;delete e.changed;delete e._promises;delete e._redrawTimer;delete e.firstscatter;delete e._hmlumcount;delete e._hmpixcount;delete e._transitionData;delete e._transitioning;delete e._initialAutoSize;delete e._transitioningWithDuration;delete e._dragging;delete e._dragged;delete e._hoverdata;delete e._snapshotInProgress;delete e._editing;delete e._replotPending;delete e._mouseDownTime;delete e._legendMouseDownTime;if(e.removeAllListeners)e.removeAllListeners()};g.style=function(e){var t=e._fullLayout._modules;var r=[];var n;for(n=0;n<t.length;n++){var i=t[n];if(i.style){l.pushUnique(r,i.style)}}for(n=0;n<r.length;n++){r[n](e)}};g.sanitizeMargins=function(e){if(!e||!e.margin)return;var t=e.width,r=e.height,n=e.margin,i=t-(n.l+n.r),a=r-(n.t+n.b),o;if(i<0){o=(t-1)/(n.l+n.r);n.l=Math.floor(o*n.l);n.r=Math.floor(o*n.r)}if(a<0){o=(r-1)/(n.t+n.b);n.t=Math.floor(o*n.t);n.b=Math.floor(o*n.b)}};g.clearAutoMarginIds=function(e){e._fullLayout._pushmarginIds={}};g.allowAutoMargin=function(e,t){e._fullLayout._pushmarginIds[t]=1};function L(e){if(!e._pushmargin)e._pushmargin={};if(!e._pushmarginIds)e._pushmarginIds={}}g.autoMargin=function(e,t,r){var n=e._fullLayout;L(n);var i=n._pushmargin;var a=n._pushmarginIds;if(n.margin.autoexpand!==false){if(!r){delete i[t];delete a[t]}else{var o=r.pad;if(o===undefined){var s=n.margin;o=Math.min(12,s.l,s.r,s.t,s.b)}if(r.l+r.r>n.width*.5)r.l=r.r=0;if(r.b+r.t>n.height*.5)r.b=r.t=0;var l=r.xl!==undefined?r.xl:r.x;var u=r.xr!==undefined?r.xr:r.x;var c=r.yt!==undefined?r.yt:r.y;var f=r.yb!==undefined?r.yb:r.y;i[t]={l:{val:l,size:r.l+o},r:{val:u,size:r.r+o},b:{val:f,size:r.b+o},t:{val:c,size:r.t+o}};a[t]=1}if(!n._replotting)g.doAutoMargin(e)}};g.doAutoMargin=function(e){var t=e._fullLayout;if(!t._size)t._size={};L(t);var r=t._size,n=JSON.stringify(r);var o=Math.max(t.margin.l||0,0);var s=Math.max(t.margin.r||0,0);var l=Math.max(t.margin.t||0,0);var u=Math.max(t.margin.b||0,0);var c=t._pushmargin;var f=t._pushmarginIds;if(t.margin.autoexpand!==false){for(var h in c){if(!f[h])delete c[h]}c.base={l:{val:0,size:o},r:{val:1,size:s},t:{val:1,size:l},b:{val:0,size:u}};for(var p in c){var d=c[p].l||{},v=c[p].b||{},m=d.val,g=d.size,y=v.val,_=v.size;for(var x in c){if(i(g)&&c[x].r){var b=c[x].r.val,w=c[x].r.size;if(b>m){var k=(g*b+(w-t.width)*m)/(b-m),A=(w*(1-m)+(g-t.width)*(1-b))/(b-m);if(k>=0&&A>=0&&k+A>o+s){o=k;s=A}}}if(i(_)&&c[x].t){var T=c[x].t.val,M=c[x].t.size;if(T>y){var S=(_*T+(M-t.height)*y)/(T-y),C=(M*(1-y)+(_-t.height)*(1-T))/(T-y);if(S>=0&&C>=0&&S+C>u+l){u=S;l=C}}}}}}r.l=Math.round(o);r.r=Math.round(s);r.t=Math.round(l);r.b=Math.round(u);r.p=Math.round(t.margin.pad);r.w=Math.round(t.width)-r.l-r.r;r.h=Math.round(t.height)-r.t-r.b;if(!t._replotting&&n!=="{}"&&n!==JSON.stringify(t._size)){if("_redrawFromAutoMarginCount"in t){t._redrawFromAutoMarginCount++}else{t._redrawFromAutoMarginCount=1}return a.call("plot",e)}};g.graphJson=function(e,t,r,n,i){if(i&&t&&!e._fullData||i&&!t&&!e._fullLayout){g.supplyDefaults(e)}var a=i?e._fullData:e.data,o=i?e._fullLayout:e.layout,s=(e._transitionData||{})._frames;function u(e){if(typeof e==="function"){return null}if(l.isPlainObject(e)){var t={},n,i;for(n in e){if(typeof e[n]==="function"||["_","["].indexOf(n.charAt(0))!==-1){continue}if(r==="keepdata"){if(n.substr(n.length-3)==="src"){continue}}else if(r==="keepstream"){i=e[n+"src"];if(typeof i==="string"&&i.indexOf(":")>0){if(!l.isPlainObject(e.stream)){continue}}}else if(r!=="keepall"){i=e[n+"src"];if(typeof i==="string"&&i.indexOf(":")>0){continue}}t[n]=u(e[n])}return t}if(Array.isArray(e)){return e.map(u)}if(l.isJSDate(e))return l.ms2DateTimeLocal(+e);return e}var c={data:(a||[]).map(function(e){var r=u(e);if(t){delete r.fit}return r})};if(!t){c.layout=u(o)}if(e.framework&&e.framework.isPolar)c=e.framework.getConfig();if(s)c.frames=u(s);return n==="object"?c:JSON.stringify(c)};g.modifyFrames=function(e,t){var r,n,i;var a=e._transitionData._frames;var o=e._transitionData._frameHash;for(r=0;r<t.length;r++){n=t[r];switch(n.type){case"replace":i=n.value;var s=(a[n.index]||{}).name;var l=i.name;a[n.index]=o[l]=i;if(l!==s){delete o[s];o[l]=i}break;case"insert":i=n.value;o[i.name]=i;a.splice(n.index,0,i);break;case"delete":i=a[n.index];delete o[i.name];a.splice(n.index,1);break}}return Promise.resolve()};g.computeFrame=function(e,t){var r=e._transitionData._frameHash;var n,i,a,o;if(!t){throw new Error("computeFrame must be given a string frame name")}var s=r[t.toString()];if(!s){return false}var l=[s];var u=[s.name];while(s.baseframe&&(s=r[s.baseframe.toString()])){if(u.indexOf(s.name)!==-1)break;l.push(s);u.push(s.name)}var c={};while(s=l.pop()){if(s.layout){c.layout=g.extendLayout(c.layout,s.layout)}if(s.data){if(!c.data){c.data=[]}i=s.traces;if(!i){i=[];for(n=0;n<s.data.length;n++){i[n]=n}}if(!c.traces){c.traces=[]}for(n=0;n<s.data.length;n++){a=i[n];if(a===undefined||a===null){continue}o=c.traces.indexOf(a);if(o===-1){o=c.data.length;c.traces[o]=a}c.data[o]=g.extendTrace(c.data[o],s.data[n])}}}return c};g.recomputeFrameHash=function(e){var t=e._transitionData._frameHash={};var r=e._transitionData._frames;for(var n=0;n<r.length;n++){var i=r[n];if(i&&i.name){t[i.name]=i}}};g.extendObjectWithContainers=function(e,t,r){var n,i,a,o,s,u,c,f;var h=l.extendDeepNoArrays({},t||{});var p=l.expandObjectPaths(h);var d={};if(r&&r.length){for(a=0;a<r.length;a++){n=l.nestedProperty(p,r[a]);i=n.get();if(i===undefined){l.nestedProperty(d,r[a]).set(null)}else{n.set(null);l.nestedProperty(d,r[a]).set(i)}}}e=l.extendDeepNoArrays(e||{},p);if(r&&r.length){for(a=0;a<r.length;a++){s=l.nestedProperty(d,r[a]);c=s.get();if(!c)continue;u=l.nestedProperty(e,r[a]);f=u.get();if(!Array.isArray(f)){f=[];u.set(f)}for(o=0;o<c.length;o++){var v=c[o];if(v===null)f[o]=null;else{f[o]=g.extendObjectWithContainers(f[o],v)}}u.set(f)}}return e};g.dataArrayContainers=["transforms","dimensions"];g.layoutArrayContainers=a.layoutArrayContainers;g.extendTrace=function(e,t){return g.extendObjectWithContainers(e,t,g.dataArrayContainers)};g.extendLayout=function(e,t){return g.extendObjectWithContainers(e,t,g.layoutArrayContainers)};g.transition=function(e,t,r,n,i,o){var s,u;var c=Array.isArray(t)?t.length:0;var f=n.slice(0,c);var h=[];function p(){var n;for(n=0;n<f.length;n++){var i=f[n];var o=e._fullData[i];var s=o._module;if(!s)continue;if(s.animatable){h.push(i)}e.data[f[n]]=g.extendTrace(e.data[f[n]],t[n])}var u=l.expandObjectPaths(l.extendDeepNoArrays({},r));var c=/^[xy]axis[0-9]*$/;for(var p in u){if(!c.test(p))continue;delete u[p].range}g.extendLayout(e.layout,u);delete e.calcdata;g.supplyDefaults(e);g.doCalcdata(e);a.getComponentMethod("errorbars","calc")(e);return Promise.resolve()}function d(e){var t=Promise.resolve();if(!e)return t;while(e.length){t=t.then(e.shift())}return t}function v(e){if(!e)return;while(e.length){e.shift()}}var m=false;function y(){e.emit("plotly_transitioning",[]);return new Promise(function(t){e._transitioning=true;if(o.duration>0){e._transitioningWithDuration=true}e._transitionData._interruptCallbacks.push(function(){m=true});if(i.redraw){e._transitionData._interruptCallbacks.push(function(){return a.call("redraw",e)})}e._transitionData._interruptCallbacks.push(function(){e.emit("plotly_transitioninterrupted",[])});var n=0;var s=0;function u(){n++;return function(){s++;if(!m&&s===n){_(t)}}}var c;var f;var p=e._fullLayout._basePlotModules;var d=false;if(r){for(f=0;f<p.length;f++){if(p[f].transitionAxes){var v=l.expandObjectPaths(r);d=p[f].transitionAxes(e,v,o,u)||d}}}if(d){c=l.extendFlat({},o);c.duration=0}else{c=o}for(f=0;f<p.length;f++){p[f].plot(e,h,c,u)}setTimeout(u())})}function _(t){if(!e._transitionData)return;v(e._transitionData._interruptCallbacks);return Promise.resolve().then(function(){if(i.redraw){return a.call("redraw",e)}}).then(function(){e._transitioning=false;e._transitioningWithDuration=false;e.emit("plotly_transitioned",[])}).then(t)}function x(){if(!e._transitionData)return;e._transitioning=false;return d(e._transitionData._interruptCallbacks)}for(s=0;s<f.length;s++){u=f[s];var b=e._fullData[u];var w=b._module;if(!w)continue}var k=[g.previousPromises,x,p,g.rehover,y];var A=l.syncOrAsync(k,e);if(!A||!A.then){A=Promise.resolve()}return A.then(function(){return e})};g.doCalcdata=function(e,t){var r=f.list(e),n=e._fullData,i=e._fullLayout;var s,l,u,h;var p=new Array(n.length);var d=(e.calcdata||[]).slice(0);e.calcdata=p;e.firstscatter=true;i._numBoxes=0;i._numViolins=0;i._violinScaleGroupStats={};e._hmpixcount=0;e._hmlumcount=0;i._piecolormap={};i._piecolorway=null;i._piedefaultcolorcount=0;for(u=0;u<n.length;u++){if(Array.isArray(t)&&t.indexOf(u)===-1){p[u]=d[u];continue}}for(u=0;u<n.length;u++){s=n[u];s._arrayAttrs=o.findArrayAttributes(s)}var v=i._subplots.polar||[];for(u=0;u<v.length;u++){r.push(i[v[u]].radialaxis,i[v[u]].angularaxis)}I(r);var m=false;for(u=0;u<n.length;u++){s=n[u];if(s.visible===true&&s.transforms){l=s._module;if(l&&l.calc){var g=l.calc(e,s);if(g[0]&&g[0].t&&g[0].t._scene){delete g[0].t._scene.dirty}}for(h=0;h<s.transforms.length;h++){var _=s.transforms[h];l=y[_.type];if(l&&l.calcTransform){s._hasCalcTransform=true;m=true;l.calcTransform(e,s,_)}}}}if(m)I(r);function x(t,r){s=n[t];l=s._module;if(!!l.isContainer!==r)return;var i=[];if(s.visible===true){var a=s.transforms||[];for(h=a.length-1;h>=0;h--){if(a[h].enabled){s._indexToPoints=a[h]._indexToPoints;break}}if(l&&l.calc){i=l.calc(e,s)}}if(!Array.isArray(i)||!i[0]){i=[{x:c,y:c}]}if(!i[0].t)i[0].t={};i[0].trace=s;p[t]=i}for(u=0;u<n.length;u++)x(u,true);for(u=0;u<n.length;u++)x(u,false);a.getComponentMethod("fx","calc")(e)};function I(e){for(var t=0;t<e.length;t++){e[t].clearCalc()}}g.rehover=function(e){if(e._fullLayout._rehover){e._fullLayout._rehover()}};g.generalUpdatePerTraceModule=function(e,t,r,n){var i=t.traceHash;var a={};var o;for(o=0;o<r.length;o++){var s=r[o],u=s[0].trace;if(u.visible){a[u.type]=a[u.type]||[];a[u.type].push(s)}}for(var c in i){if(!a[c]){var f=i[c][0],h=f[0].trace;h.visible=false;a[c]=[f]}}for(var p in a){var d=a[p];var v=d[0][0].trace._module;v.plot(e,t,l.filterVisible(d),n)}t.traceHash=a}},{"../components/color":42,"../constants/numerical":142,"../lib":161,"../plot_api/plot_schema":194,"../plot_api/plot_template":195,"../plots/cartesian/axis_ids":208,"../registry":253,"./animation_attributes":200,"./attributes":202,"./command":229,"./font_attributes":231,"./frame_attributes":232,"./layout_attributes":235,"./sort_modules":251,d3:6,"fast-isnumeric":9}],245:[function(e,t,r){"use strict";var n=e("../../../traces/scatter/attributes");var i=n.marker;t.exports={r:n.r,t:n.t,marker:{color:i.color,size:i.size,symbol:i.symbol,opacity:i.opacity,editType:"calc"}}},{"../../../traces/scatter/attributes":265}],246:[function(e,t,r){"use strict";var n=e("../../cartesian/layout_attributes");var i=e("../../../lib/extend").extendFlat;var a=e("../../../plot_api/edit_types").overrideAll;var o=i({},n.domain,{});function s(e,t){var r={showline:{valType:"boolean"},showticklabels:{valType:"boolean"},tickorientation:{valType:"enumerated",values:["horizontal","vertical"]},ticklen:{valType:"number",min:0},tickcolor:{valType:"color"},ticksuffix:{valType:"string"},endpadding:{valType:"number"},visible:{valType:"boolean"}};return i({},t,r)}t.exports=a({radialaxis:s("radial",{range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},domain:o,orientation:{valType:"number"}}),angularaxis:s("angular",{range:{valType:"info_array",items:[{valType:"number",dflt:0},{valType:"number",dflt:360}]},domain:o}),layout:{direction:{valType:"enumerated",values:["clockwise","counterclockwise"]},orientation:{valType:"angle"}}},"plot","nested")},{"../../../lib/extend":154,"../../../plot_api/edit_types":188,"../../cartesian/layout_attributes":217}],247:[function(e,t,r){"use strict";var n=t.exports=e("./micropolar");n.manager=e("./micropolar_manager")},{"./micropolar":248,"./micropolar_manager":249}],248:[function(e,t,r){var n=e("d3");var i=e("../../../lib");var a=i.extendDeepAll;var o=e("../../../constants/alignment").MID_SHIFT;var s=t.exports={version:"0.2.2"};s.Axis=function e(){var t={data:[],layout:{}},r={},i={};var l,u,c=n.dispatch("hover"),f,h;var p={};function d(e){u=e||u;var r=t.data;var c=t.layout;if(typeof u=="string"||u.nodeName)u=n.select(u);u.datum(r).each(function(e,t){var r=e.slice();i={data:s.util.cloneJson(r),layout:s.util.cloneJson(c)};var u=0;r.forEach(function(e,t){if(!e.color){e.color=c.defaultColorRange[u];u=(u+1)%c.defaultColorRange.length}if(!e.strokeColor){e.strokeColor=e.geometry==="LinePlot"?e.color:n.rgb(e.color).darker().toString()}i.data[t].color=e.color;i.data[t].strokeColor=e.strokeColor;i.data[t].strokeDash=e.strokeDash;i.data[t].strokeSize=e.strokeSize});var p=r.filter(function(e,t){var r=e.visible;return typeof r==="undefined"||r===true});var d=false;var v=p.map(function(e,t){d=d||typeof e.groupId!=="undefined";return e});if(d){var m=n.nest().key(function(e,t){return typeof e.groupId!="undefined"?e.groupId:"unstacked"}).entries(v);var g=[];var y=m.map(function(e,t){if(e.key==="unstacked")return e.values;else{var r=e.values[0].r.map(function(e,t){return 0});e.values.forEach(function(e,t,n){e.yStack=[r];g.push(r);r=s.util.sumArrays(e.r,r)});return e.values}});p=n.merge(y)}p.forEach(function(e,t){e.t=Array.isArray(e.t[0])?e.t:[e.t];e.r=Array.isArray(e.r[0])?e.r:[e.r]});var _=Math.min(c.width-c.margin.left-c.margin.right,c.height-c.margin.top-c.margin.bottom)/2;_=Math.max(10,_);var x=[c.margin.left+_,c.margin.top+_];var b;if(d){var w=n.max(s.util.sumArrays(s.util.arrayLast(p).r[0],s.util.arrayLast(g)));b=[0,w]}else b=n.extent(s.util.flattenArray(p.map(function(e,t){return e.r})));if(c.radialAxis.domain!=s.DATAEXTENT)b[0]=0;f=n.scale.linear().domain(c.radialAxis.domain!=s.DATAEXTENT&&c.radialAxis.domain?c.radialAxis.domain:b).range([0,_]);i.layout.radialAxis.domain=f.domain();var k=s.util.flattenArray(p.map(function(e,t){return e.t}));var A=typeof k[0]==="string";var T;if(A){k=s.util.deduplicate(k);T=k.slice();k=n.range(k.length);p=p.map(function(e,t){var r=e;e.t=[k];if(d)r.yStack=e.yStack;return r})}var M=p.filter(function(e,t){return e.geometry==="LinePlot"||e.geometry==="DotPlot"}).length===p.length;var S=c.needsEndSpacing===null?A||!M:c.needsEndSpacing;var C=c.angularAxis.domain&&c.angularAxis.domain!=s.DATAEXTENT&&!A&&c.angularAxis.domain[0]>=0;var z=C?c.angularAxis.domain:n.extent(k);var E=Math.abs(k[1]-k[0]);if(M&&!A)E=0;var L=z.slice();if(S&&A)L[1]+=E;var I=c.angularAxis.ticksCount||4;if(I>8)I=I/(I/8)+I%8;if(c.angularAxis.ticksStep){I=(L[1]-L[0])/I}var P=c.angularAxis.ticksStep||(L[1]-L[0])/(I*(c.minorTicks+1));if(T)P=Math.max(Math.round(P),1);if(!L[2])L[2]=P;var D=n.range.apply(this,L);D=D.map(function(e,t){return parseFloat(e.toPrecision(12))});h=n.scale.linear().domain(L.slice(0,2)).range(c.direction==="clockwise"?[0,360]:[360,0]);i.layout.angularAxis.domain=h.domain();i.layout.angularAxis.endPadding=S?E:0;l=n.select(this).select("svg.chart-root");if(typeof l==="undefined"||l.empty()){var O="<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>";var R=(new DOMParser).parseFromString(O,"application/xml");var F=this.appendChild(this.ownerDocument.importNode(R.documentElement,true));l=n.select(F)}l.select(".guides-group").style({"pointer-events":"none"});l.select(".angular.axis-group").style({"pointer-events":"none"});l.select(".radial.axis-group").style({"pointer-events":"none"});var B=l.select(".chart-group");var N={fill:"none",stroke:c.tickColor};var j={"font-size":c.font.size,"font-family":c.font.family,fill:c.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map(function(e,t){return" "+e+" 0 "+c.font.outlineColor}).join(",")};var V;if(c.showLegend){V=l.select(".legend-group").attr({transform:"translate("+[_,c.margin.top]+")"}).style({display:"block"});var q=p.map(function(e,t){var r=s.util.cloneJson(e);r.symbol=e.geometry==="DotPlot"?e.dotType||"circle":e.geometry!="LinePlot"?"square":"line";r.visibleInLegend=typeof e.visibleInLegend==="undefined"||e.visibleInLegend;r.color=e.geometry==="LinePlot"?e.strokeColor:e.color;return r});s.Legend().config({data:p.map(function(e,t){return e.name||"Element"+t}),legendConfig:a({},s.Legend.defaultConfig().legendConfig,{container:V,elements:q,reverseOrder:c.legend.reverseOrder})})();var U=V.node().getBBox();_=Math.min(c.width-U.width-c.margin.left-c.margin.right,c.height-c.margin.top-c.margin.bottom)/2;_=Math.max(10,_);x=[c.margin.left+_,c.margin.top+_];f.range([0,_]);i.layout.radialAxis.domain=f.domain();V.attr("transform","translate("+[x[0]+_,x[1]-_]+")")}else{V=l.select(".legend-group").style({display:"none"})}l.attr({width:c.width,height:c.height}).style({opacity:c.opacity});B.attr("transform","translate("+x+")").style({cursor:"crosshair"});var Z=[(c.width-(c.margin.left+c.margin.right+_*2+(U?U.width:0)))/2,(c.height-(c.margin.top+c.margin.bottom+_*2))/2];Z[0]=Math.max(0,Z[0]);Z[1]=Math.max(0,Z[1]);l.select(".outer-group").attr("transform","translate("+Z+")");if(c.title){var H=l.select("g.title-group text").style(j).text(c.title);var G=H.node().getBBox();H.attr({x:x[0]-G.width/2,y:x[1]-_-20})}var $=l.select(".radial.axis-group");if(c.radialAxis.gridLinesVisible){var W=$.selectAll("circle.grid-circle").data(f.ticks(5));W.enter().append("circle").attr({class:"grid-circle"}).style(N);W.attr("r",f);W.exit().remove()}$.select("circle.outside-circle").attr({r:_}).style(N);var X=l.select("circle.background-circle").attr({r:_}).style({fill:c.backgroundColor,stroke:c.stroke});function Y(e,t){return h(e)%360+c.orientation}if(c.radialAxis.visible){var J=n.svg.axis().scale(f).ticks(5).tickSize(5);$.call(J).attr({transform:"rotate("+c.radialAxis.orientation+")"});$.selectAll(".domain").style(N);$.selectAll("g>text").text(function(e,t){return this.textContent+c.radialAxis.ticksSuffix}).style(j).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(e,t){if(c.radialAxis.tickOrientation==="horizontal"){return"rotate("+-c.radialAxis.orientation+") translate("+[0,j["font-size"]]+")"}else return"translate("+[0,j["font-size"]]+")"}});$.selectAll("g>line").style({stroke:"black"})}var K=l.select(".angular.axis-group").selectAll("g.angular-tick").data(D);var Q=K.enter().append("g").classed("angular-tick",true);K.attr({transform:function(e,t){return"rotate("+Y(e,t)+")"}}).style({display:c.angularAxis.visible?"block":"none"});K.exit().remove();Q.append("line").classed("grid-line",true).classed("major",function(e,t){return t%(c.minorTicks+1)==0}).classed("minor",function(e,t){return!(t%(c.minorTicks+1)==0)}).style(N);Q.selectAll(".minor").style({stroke:c.minorTickColor});K.select("line.grid-line").attr({x1:c.tickLength?_-c.tickLength:0,x2:_}).style({display:c.angularAxis.gridLinesVisible?"block":"none"});Q.append("text").classed("axis-text",true).style(j);var ee=K.select("text.axis-text").attr({x:_+c.labelOffset,dy:o+"em",transform:function(e,t){var r=Y(e,t);var n=_+c.labelOffset;var i=c.angularAxis.tickOrientation;if(i=="horizontal")return"rotate("+-r+" "+n+" 0)";else if(i=="radial")return r<270&&r>90?"rotate(180 "+n+" 0)":null;else return"rotate("+(r<=180&&r>0?-90:90)+" "+n+" 0)"}}).style({"text-anchor":"middle",display:c.angularAxis.labelsVisible?"block":"none"}).text(function(e,t){if(t%(c.minorTicks+1)!=0)return"";if(T){return T[e]+c.angularAxis.ticksSuffix}else return e+c.angularAxis.ticksSuffix}).style(j);if(c.angularAxis.rewriteTicks)ee.text(function(e,t){if(t%(c.minorTicks+1)!=0)return"";return c.angularAxis.rewriteTicks(this.textContent,t)});var te=n.max(B.selectAll(".angular-tick text")[0].map(function(e,t){return e.getCTM().e+e.getBBox().width}));V.attr({transform:"translate("+[_+te,c.margin.top]+")"});var re=l.select("g.geometry-group").selectAll("g").size()>0;var ne=l.select("g.geometry-group").selectAll("g.geometry").data(p);ne.enter().append("g").attr({class:function(e,t){return"geometry geometry"+t}});ne.exit().remove();if(p[0]||re){var ie=[];p.forEach(function(e,t){var r={};r.radialScale=f;r.angularScale=h;r.container=ne.filter(function(e,r){return r==t});r.geometry=e.geometry;r.orientation=c.orientation;r.direction=c.direction;r.index=t;ie.push({data:e,geometryConfig:r})});var ae=n.nest().key(function(e,t){return typeof e.data.groupId!="undefined"||"unstacked"}).entries(ie);var oe=[];ae.forEach(function(e,t){if(e.key==="unstacked")oe=oe.concat(e.values.map(function(e,t){return[e]}));else oe.push(e.values)});oe.forEach(function(e,t){var r;if(Array.isArray(e))r=e[0].geometryConfig.geometry;else r=e.geometryConfig.geometry;var n=e.map(function(e,t){return a(s[r].defaultConfig(),e)});s[r]().config(n)()})}var se=l.select(".guides-group");var le=l.select(".tooltips-group");var ue=s.tooltipPanel().config({container:le,fontSize:8})();var ce=s.tooltipPanel().config({container:le,fontSize:8})();var fe=s.tooltipPanel().config({container:le,hasTick:true})();var he,pe;if(!A){var de=se.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});B.on("mousemove.angular-guide",function(e,t){var r=s.util.getMousePos(X).angle;de.attr({x2:-_,transform:"rotate("+r+")"}).style({opacity:.5});var n=(r+180+360-c.orientation)%360;he=h.invert(n);var i=s.util.convertToCartesian(_+12,r+180);ue.text(s.util.round(he)).move([i[0]+x[0],i[1]+x[1]])}).on("mouseout.angular-guide",function(e,t){se.select("line").style({opacity:0})})}var ve=se.select("circle").style({stroke:"grey",fill:"none"});B.on("mousemove.radial-guide",function(e,t){var r=s.util.getMousePos(X).radius;ve.attr({r:r}).style({opacity:.5});pe=f.invert(s.util.getMousePos(X).radius);var n=s.util.convertToCartesian(r,c.radialAxis.orientation);ce.text(s.util.round(pe)).move([n[0]+x[0],n[1]+x[1]])}).on("mouseout.radial-guide",function(e,t){ve.style({opacity:0});fe.hide();ue.hide();ce.hide()});l.selectAll(".geometry-group .mark").on("mouseover.tooltip",function(e,t){var r=n.select(this);var i=this.style.fill;var a="black";var o=this.style.opacity||1;r.attr({"data-opacity":o});if(i&&i!=="none"){r.attr({"data-fill":i});a=n.hsl(i).darker().toString();r.style({fill:a,opacity:1});var u={t:s.util.round(e[0]),r:s.util.round(e[1])};if(A)u.t=T[e[0]];var c="t: "+u.t+", r: "+u.r;var f=this.getBoundingClientRect();var h=l.node().getBoundingClientRect();var p=[f.left+f.width/2-Z[0]-h.left,f.top+f.height/2-Z[1]-h.top];fe.config({color:a}).text(c);fe.move(p)}else{i=this.style.stroke||"black";r.attr({"data-stroke":i});a=n.hsl(i).darker().toString();r.style({stroke:a,opacity:1})}}).on("mousemove.tooltip",function(e,t){if(n.event.which!=0)return false;if(n.select(this).attr("data-fill"))fe.show()}).on("mouseout.tooltip",function(e,t){fe.hide();var r=n.select(this);var i=r.attr("data-fill");if(i)r.style({fill:i,opacity:r.attr("data-opacity")});else r.style({stroke:r.attr("data-stroke"),opacity:r.attr("data-opacity")})})});return p}p.render=function(e){d(e);return this};p.config=function(e){if(!arguments.length)return t;var r=s.util.cloneJson(e);r.data.forEach(function(e,r){if(!t.data[r])t.data[r]={};a(t.data[r],s.Axis.defaultConfig().data[0]);a(t.data[r],e)});a(t.layout,s.Axis.defaultConfig().layout);a(t.layout,r.layout);return this};p.getLiveConfig=function(){return i};p.getinputConfig=function(){return r};p.radialScale=function(e){return f};p.angularScale=function(e){return h};p.svg=function(){return l};n.rebind(p,c,"on");return p};s.Axis.defaultConfig=function(e,t){var r={data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:true,opacity:1}],layout:{defaultColorRange:n.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:true,gridLinesVisible:true,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:true,gridLinesVisible:true,labelsVisible:true,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:true,legend:{reverseOrder:false},opacity:1}};return r};s.util={};s.DATAEXTENT="dataExtent";s.AREA="AreaChart";s.LINE="LinePlot";s.DOT="DotPlot";s.BAR="BarChart";s.util._override=function(e,t){for(var r in e)if(r in t)t[r]=e[r]};s.util._extend=function(e,t){for(var r in e)t[r]=e[r]};s.util._rndSnd=function(){return Math.random()*2-1+(Math.random()*2-1)+(Math.random()*2-1)};s.util.dataFromEquation2=function(e,t){var r=t||6;var i=n.range(0,360+r,r).map(function(t,r){var n=t*Math.PI/180;var i=e(n);return[t,i]});return i};s.util.dataFromEquation=function(e,t,r){var i=t||6;var a=[],o=[];n.range(0,360+i,i).forEach(function(t,r){var n=t*Math.PI/180;var i=e(n);a.push(t);o.push(i)});var s={t:a,r:o};if(r)s.name=r;return s};s.util.ensureArray=function(e,t){if(typeof e==="undefined")return null;var r=[].concat(e);return n.range(t).map(function(e,t){return r[t]||r[0]})};s.util.fillArrays=function(e,t,r){t.forEach(function(t,n){e[t]=s.util.ensureArray(e[t],r)});return e};s.util.cloneJson=function(e){return JSON.parse(JSON.stringify(e))};s.util.validateKeys=function(e,t){if(typeof t==="string")t=t.split(".");var r=t.shift();return e[r]&&(!t.length||objHasKeys(e[r],t))};s.util.sumArrays=function(e,t){return n.zip(e,t).map(function(e,t){return n.sum(e)})};s.util.arrayLast=function(e){return e[e.length-1]};s.util.arrayEqual=function(e,t){var r=Math.max(e.length,t.length,1);while(r-- >=0&&e[r]===t[r]);return r===-2};s.util.flattenArray=function(e){var t=[];while(!s.util.arrayEqual(t,e)){t=e;e=[].concat.apply([],e)}return e};s.util.deduplicate=function(e){return e.filter(function(e,t,r){return r.indexOf(e)==t})};s.util.convertToCartesian=function(e,t){var r=t*Math.PI/180;var n=e*Math.cos(r);var i=e*Math.sin(r);return[n,i]};s.util.round=function(e,t){var r=t||2;var n=Math.pow(10,r);return Math.round(e*n)/n};s.util.getMousePos=function(e){var t=n.mouse(e.node());var r=t[0];var i=t[1];var a={};a.x=r;a.y=i;a.pos=t;a.angle=(Math.atan2(i,r)+Math.PI)*180/Math.PI;a.radius=Math.sqrt(r*r+i*i);return a};s.util.duplicatesCount=function(e){var t={},r;var n={};for(var i=0,a=e.length;i<a;i++){r=e[i];if(r in t){t[r]++;n[r]=t[r]}else{t[r]=1}}return n};s.util.duplicates=function(e){return Object.keys(s.util.duplicatesCount(e))};s.util.translator=function(e,t,r,n){if(n){var i=r.slice();r=t;t=i}var a=t.reduce(function(e,t){if(typeof e!="undefined")return e[t]},e);if(typeof a==="undefined")return;t.reduce(function(e,r,n){if(typeof e=="undefined")return;if(n===t.length-1)delete e[r];return e[r]},e);r.reduce(function(e,t,n){if(typeof e[t]==="undefined")e[t]={};if(n===r.length-1)e[t]=a;return e[t]},e)};s.PolyChart=function e(){var t=[s.PolyChart.defaultConfig()];var r=n.dispatch("hover");var i={solid:"none",dash:[5,2],dot:[2,5]};var o;function l(){var e=t[0].geometryConfig;var r=e.container;if(typeof r=="string")r=n.select(r);r.datum(t).each(function(t,r){var a=!!t[0].data.yStack;var o=t.map(function(e,t){if(a)return n.zip(e.data.t[0],e.data.r[0],e.data.yStack[0]);else return n.zip(e.data.t[0],e.data.r[0])});var s=e.angularScale;var l=e.radialScale.domain()[0];var u={};u.bar=function(r,i,a){var o=t[a].data;var l=e.radialScale(r[1])-e.radialScale(0);var u=e.radialScale(r[2]||0);var c=o.barWidth;n.select(this).attr({class:"mark bar",d:"M"+[[l+u,-c/2],[l+u,c/2],[u,c/2],[u,-c/2]].join("L")+"Z",transform:function(t,r){return"rotate("+(e.orientation+s(t[0]))+")"}})};u.dot=function(e,r,i){var a=e[2]?[e[0],e[1]+e[2]]:e;var o=n.svg.symbol().size(t[i].data.dotSize).type(t[i].data.dotType)(e,r);n.select(this).attr({class:"mark dot",d:o,transform:function(e,t){var r=y(g(a));return"translate("+[r.x,r.y]+")"}})};var c=n.svg.line.radial().interpolate(t[0].data.lineInterpolation).radius(function(t){return e.radialScale(t[1])}).angle(function(t){return e.angularScale(t[0])*Math.PI/180});u.line=function(r,i,a){var s=r[2]?o[a].map(function(e,t){return[e[0],e[1]+e[2]]}):o[a];n.select(this).each(u["dot"]).style({opacity:function(e,r){return+t[a].data.dotVisible},fill:d.stroke(r,i,a)}).attr({class:"mark dot"});if(i>0)return;var l=n.select(this.parentNode).selectAll("path.line").data([0]);l.enter().insert("path");l.attr({class:"line",d:c(s),transform:function(t,r){return"rotate("+(e.orientation+90)+")"},"pointer-events":"none"}).style({fill:function(e,t){return d.fill(r,i,a)},"fill-opacity":0,stroke:function(e,t){return d.stroke(r,i,a)},"stroke-width":function(e,t){return d["stroke-width"](r,i,a)},"stroke-dasharray":function(e,t){return d["stroke-dasharray"](r,i,a)},opacity:function(e,t){return d.opacity(r,i,a)},display:function(e,t){return d.display(r,i,a)}})};var f=e.angularScale.range();var h=Math.abs(f[1]-f[0])/o[0].length*Math.PI/180;var p=n.svg.arc().startAngle(function(e){return-h/2}).endAngle(function(e){return h/2}).innerRadius(function(t){return e.radialScale(l+(t[2]||0))}).outerRadius(function(t){return e.radialScale(l+(t[2]||0))+e.radialScale(t[1])});u.arc=function(t,r,i){n.select(this).attr({class:"mark arc",d:p,transform:function(t,r){return"rotate("+(e.orientation+s(t[0])+90)+")"}})};var d={fill:function(e,r,n){return t[n].data.color},stroke:function(e,r,n){return t[n].data.strokeColor},"stroke-width":function(e,r,n){return t[n].data.strokeSize+"px"},"stroke-dasharray":function(e,r,n){return i[t[n].data.strokeDash]},opacity:function(e,r,n){return t[n].data.opacity},display:function(e,r,n){return typeof t[n].data.visible==="undefined"||t[n].data.visible?"block":"none"}};var v=n.select(this).selectAll("g.layer").data(o);v.enter().append("g").attr({class:"layer"});var m=v.selectAll("path.mark").data(function(e,t){return e});m.enter().append("path").attr({class:"mark"});m.style(d).each(u[e.geometryType]);m.exit().remove();v.exit().remove();function g(t,r){var n=e.radialScale(t[1]);var i=(e.angularScale(t[0])+e.orientation)*Math.PI/180;return{r:n,t:i}}function y(e){var t=e.r*Math.cos(e.t);var r=e.r*Math.sin(e.t);return{x:t,y:r}}})}l.config=function(e){if(!arguments.length)return t;e.forEach(function(e,r){if(!t[r])t[r]={};a(t[r],s.PolyChart.defaultConfig());a(t[r],e)});return this};l.getColorScale=function(){return o};n.rebind(l,r,"on");return l};s.PolyChart.defaultConfig=function(){var e={data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:false,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:true,visibleInLegend:true},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:n.scale.category20()}};return e};s.BarChart=function e(){return s.PolyChart()};s.BarChart.defaultConfig=function(){var e={geometryConfig:{geometryType:"bar"}};return e};s.AreaChart=function e(){return s.PolyChart()};s.AreaChart.defaultConfig=function(){var e={geometryConfig:{geometryType:"arc"}};return e};s.DotPlot=function e(){return s.PolyChart()};s.DotPlot.defaultConfig=function(){var e={geometryConfig:{geometryType:"dot",dotType:"circle"}};return e};s.LinePlot=function e(){return s.PolyChart()};s.LinePlot.defaultConfig=function(){var e={geometryConfig:{geometryType:"line"}};return e};s.Legend=function e(){var t=s.Legend.defaultConfig();var r=n.dispatch("hover");function i(){var e=t.legendConfig;var r=t.data.map(function(t,r){return[].concat(t).map(function(t,n){var i=a({},e.elements[r]);i.name=t;i.color=[].concat(e.elements[r].color)[n];return i})});var o=n.merge(r);o=o.filter(function(t,r){return e.elements[r]&&(e.elements[r].visibleInLegend||typeof e.elements[r].visibleInLegend==="undefined")});if(e.reverseOrder)o=o.reverse();var s=e.container;if(typeof s=="string"||s.nodeName)s=n.select(s);var l=o.map(function(e,t){return e.color});var u=e.fontSize;var c=e.isContinuous==null?typeof o[0]==="number":e.isContinuous;var f=c?e.height:u*o.length;var h=s.classed("legend-group",true);var p=h.selectAll("svg").data([0]);var d=p.enter().append("svg").attr({width:300,height:f+u,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});d.append("g").classed("legend-axis",true);d.append("g").classed("legend-marks",true);var v=n.range(o.length);var m=n.scale[c?"linear":"ordinal"]().domain(v).range(l);var g=n.scale[c?"linear":"ordinal"]().domain(v)[c?"range":"rangePoints"]([0,f]);var y=function(e,t){var r=t*3;if(e==="line"){return"M"+[[-t/2,-t/12],[t/2,-t/12],[t/2,t/12],[-t/2,t/12]]+"Z"}else if(n.svg.symbolTypes.indexOf(e)!=-1)return n.svg.symbol().type(e).size(r)();else return n.svg.symbol().type("square").size(r)()};if(c){var _=p.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(l);_.enter().append("stop");_.attr({offset:function(e,t){return t/(l.length-1)*100+"%"}}).style({"stop-color":function(e,t){return e}});p.append("rect").classed("legend-mark",true).attr({height:e.height,width:e.colorBandWidth,fill:"url(#grad1)"})}else{var x=p.select(".legend-marks").selectAll("path.legend-mark").data(o);x.enter().append("path").classed("legend-mark",true);x.attr({transform:function(e,t){return"translate("+[u/2,g(t)+u/2]+")"},d:function(e,t){var r=e.symbol;return y(r,u)},fill:function(e,t){return m(t)}});x.exit().remove()}var b=n.svg.axis().scale(g).orient("right");var w=p.select("g.legend-axis").attr({transform:"translate("+[c?e.colorBandWidth:u,u/2]+")"}).call(b);w.selectAll(".domain").style({fill:"none",stroke:"none"});w.selectAll("line").style({fill:"none",stroke:c?e.textColor:"none"});w.selectAll("text").style({fill:e.textColor,"font-size":e.fontSize}).text(function(e,t){return o[t].name});return i}i.config=function(e){if(!arguments.length)return t;a(t,e);return this};n.rebind(i,r,"on");return i};s.Legend.defaultConfig=function(e,t){var r={data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:false}};return r};s.tooltipPanel=function(){var e,t,r;var i={container:null,hasTick:false,fontSize:12,color:"white",padding:5};var o="tooltip-"+s.tooltipPanel.uid++;var l=10;var u=function(){e=i.container.selectAll("g."+o).data([0]);var n=e.enter().append("g").classed(o,true).style({"pointer-events":"none",display:"none"});r=n.append("path").style({fill:"white","fill-opacity":.9}).attr({d:"M0 0"});t=n.append("text").attr({dx:i.padding+l,dy:+i.fontSize*.3});return u};u.text=function(a){var o=n.hsl(i.color).l;var s=o>=.5?"#aaa":"white";var c=o>=.5?"black":"white";var f=a||"";t.style({fill:c,"font-size":i.fontSize+"px"}).text(f);var h=i.padding;var p=t.node().getBBox();var d={fill:i.color,stroke:s,"stroke-width":"2px"};var v=p.width+h*2+l;var m=p.height+h*2;r.attr({d:"M"+[[l,-m/2],[l,-m/4],[i.hasTick?0:l,0],[l,m/4],[l,m/2],[v,m/2],[v,-m/2]].join("L")+"Z"}).style(d);e.attr({transform:"translate("+[l,-m/2+h*2]+")"});e.style({display:"block"});return u};u.move=function(t){if(!e)return;e.attr({transform:"translate("+[t[0],t[1]]+")"}).style({display:"block"});return u};u.hide=function(){if(!e)return;e.style({display:"none"});return u};u.show=function(){if(!e)return;e.style({display:"block"});return u};u.config=function(e){a(i,e);return u};return u};s.tooltipPanel.uid=1;s.adapter={};s.adapter.plotly=function e(){var t={};t.convert=function(e,t){var r={};if(e.data){r.data=e.data.map(function(e,r){var n=a({},e);var i=[[n,["marker","color"],["color"]],[n,["marker","opacity"],["opacity"]],[n,["marker","line","color"],["strokeColor"]],[n,["marker","line","dash"],["strokeDash"]],[n,["marker","line","width"],["strokeSize"]],[n,["marker","symbol"],["dotType"]],[n,["marker","size"],["dotSize"]],[n,["marker","barWidth"],["barWidth"]],[n,["line","interpolation"],["lineInterpolation"]],[n,["showlegend"],["visibleInLegend"]]];i.forEach(function(e,r){s.util.translator.apply(null,e.concat(t))});if(!t)delete n.marker;if(t)delete n.groupId;if(!t){if(n.type==="scatter"){if(n.mode==="lines")n.geometry="LinePlot";else if(n.mode==="markers")n.geometry="DotPlot";else if(n.mode==="lines+markers"){n.geometry="LinePlot";n.dotVisible=true}}else if(n.type==="area")n.geometry="AreaChart";else if(n.type==="bar")n.geometry="BarChart";delete n.mode;delete n.type}else{if(n.geometry==="LinePlot"){n.type="scatter";if(n.dotVisible===true){delete n.dotVisible;n.mode="lines+markers"}else n.mode="lines"}else if(n.geometry==="DotPlot"){n.type="scatter";n.mode="markers"}else if(n.geometry==="AreaChart")n.type="area";else if(n.geometry==="BarChart")n.type="bar";delete n.geometry}return n});if(!t&&e.layout&&e.layout.barmode==="stack"){var i=s.util.duplicates(r.data.map(function(e,t){return e.geometry}));r.data.forEach(function(e,t){var n=i.indexOf(e.geometry);if(n!=-1)r.data[t].groupId=n})}}if(e.layout){var o=a({},e.layout);var l=[[o,["plot_bgcolor"],["backgroundColor"]],[o,["showlegend"],["showLegend"]],[o,["radialaxis"],["radialAxis"]],[o,["angularaxis"],["angularAxis"]],[o.angularaxis,["showline"],["gridLinesVisible"]],[o.angularaxis,["showticklabels"],["labelsVisible"]],[o.angularaxis,["nticks"],["ticksCount"]],[o.angularaxis,["tickorientation"],["tickOrientation"]],[o.angularaxis,["ticksuffix"],["ticksSuffix"]],[o.angularaxis,["range"],["domain"]],[o.angularaxis,["endpadding"],["endPadding"]],[o.radialaxis,["showline"],["gridLinesVisible"]],[o.radialaxis,["tickorientation"],["tickOrientation"]],[o.radialaxis,["ticksuffix"],["ticksSuffix"]],[o.radialaxis,["range"],["domain"]],[o.angularAxis,["showline"],["gridLinesVisible"]],[o.angularAxis,["showticklabels"],["labelsVisible"]],[o.angularAxis,["nticks"],["ticksCount"]],[o.angularAxis,["tickorientation"],["tickOrientation"]],[o.angularAxis,["ticksuffix"],["ticksSuffix"]],[o.angularAxis,["range"],["domain"]],[o.angularAxis,["endpadding"],["endPadding"]],[o.radialAxis,["showline"],["gridLinesVisible"]],[o.radialAxis,["tickorientation"],["tickOrientation"]],[o.radialAxis,["ticksuffix"],["ticksSuffix"]],[o.radialAxis,["range"],["domain"]],[o.font,["outlinecolor"],["outlineColor"]],[o.legend,["traceorder"],["reverseOrder"]],[o,["labeloffset"],["labelOffset"]],[o,["defaultcolorrange"],["defaultColorRange"]]];l.forEach(function(e,r){s.util.translator.apply(null,e.concat(t))});if(!t){if(o.angularAxis&&typeof o.angularAxis.ticklen!=="undefined")o.tickLength=o.angularAxis.ticklen;if(o.angularAxis&&typeof o.angularAxis.tickcolor!=="undefined")o.tickColor=o.angularAxis.tickcolor}else{if(typeof o.tickLength!=="undefined"){o.angularaxis.ticklen=o.tickLength;delete o.tickLength}if(o.tickColor){o.angularaxis.tickcolor=o.tickColor;delete o.tickColor}}if(o.legend&&typeof o.legend.reverseOrder!="boolean"){o.legend.reverseOrder=o.legend.reverseOrder!="normal"}if(o.legend&&typeof o.legend.traceorder=="boolean"){o.legend.traceorder=o.legend.traceorder?"reversed":"normal";delete o.legend.reverseOrder}if(o.margin&&typeof o.margin.t!="undefined"){var u=["t","r","b","l","pad"];var c=["top","right","bottom","left","pad"];var f={};n.entries(o.margin).forEach(function(e,t){f[c[u.indexOf(e.key)]]=e.value});o.margin=f}if(t){delete o.needsEndSpacing;delete o.minorTickColor;delete o.minorTicks;delete o.angularaxis.ticksCount;delete o.angularaxis.ticksCount;delete o.angularaxis.ticksStep;delete o.angularaxis.rewriteTicks;delete o.angularaxis.nticks;delete o.radialaxis.ticksCount;delete o.radialaxis.ticksCount;delete o.radialaxis.ticksStep;delete o.radialaxis.rewriteTicks;delete o.radialaxis.nticks}r.layout=o}return r};return t}},{"../../../constants/alignment":140,"../../../lib":161,d3:6}],249:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../../lib");var a=e("../../../components/color");var o=e("./micropolar");var s=e("./undo_manager");var l=i.extendDeepAll;var u=t.exports={};u.framework=function(e){var t,r,i,a,c;var f=new s;function h(r,s){if(s)c=s;n.select(n.select(c).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove();t=!t?r:l(t,r);if(!i)i=o.Axis();a=o.adapter.plotly().convert(t);i.config(a).render(c);e.data=t.data;e.layout=t.layout;u.fillLayout(e);return t}h.isPolar=true;h.svg=function(){return i.svg()};h.getConfig=function(){return t};h.getLiveConfig=function(){return o.adapter.plotly().convert(i.getLiveConfig(),true)};h.getLiveScales=function(){return{t:i.angularScale(),r:i.radialScale()}};h.setUndoPoint=function(){var e=this;var n=o.util.cloneJson(t);(function(t,r){f.add({undo:function(){if(r)e(r)},redo:function(){e(t)}})})(n,r);r=o.util.cloneJson(n)};h.undo=function(){f.undo()};h.redo=function(){f.redo()};return h};u.fillLayout=function(e){var t=n.select(e).selectAll(".plot-container"),r=t.selectAll(".svg-container"),i=e.framework&&e.framework.svg&&e.framework.svg(),o={width:800,height:600,paper_bgcolor:a.background,_container:t,_paperdiv:r,_paper:i};e._fullLayout=l(o,e.layout)}},{"../../../components/color":42,"../../../lib":161,"./micropolar":248,"./undo_manager":250,d3:6}],250:[function(e,t,r){"use strict";t.exports=function e(){var t=[],r=-1,n=false,i;function a(e,t){if(!e)return this;n=true;e[t]();n=false;return this}return{add:function(e){if(n)return this;t.splice(r+1,t.length-r);t.push(e);r=t.length-1;return this},setCallback:function(e){i=e},undo:function(){var e=t[r];if(!e)return this;a(e,"undo");r-=1;if(i)i(e.undo);return this},redo:function(){var e=t[r+1];if(!e)return this;a(e,"redo");r+=1;if(i)i(e.redo);return this},clear:function(){t=[];r=-1},hasUndo:function(){return r!==-1},hasRedo:function(){return r<t.length-1},getCommands:function(){return t},getPreviousCommand:function(){return t[r-1]},getIndex:function(){return r}}}},{}],251:[function(e,t,r){"use strict";function n(e,t){if(e==="splom")return-1;if(t==="splom")return 1;return 0}function i(e,t){return n(e.name,t.name)}t.exports={sortBasePlotModules:i,sortModules:n}},{}],252:[function(e,t,r){"use strict";var n=e("../lib");var i=e("../plot_api/plot_template");var a=e("./domain").defaults;t.exports=function e(t,r,o,s){var l=s.type;var u=s.attributes;var c=s.handleDefaults;var f=s.partition||"x";var h=r._subplots[l];var p=h.length;var d=p&&h[0].replace(/\d+$/,"");var v,m;function g(e,t){return n.coerce(v,m,u,e,t)}for(var y=0;y<p;y++){var _=h[y];if(t[_])v=t[_];else v=t[_]={};m=i.newContainer(r,_,d);var x={};x[f]=[y/p,(y+1)/p];a(m,r,g,x);s.id=_;c(v,m,g,s)}}},{"../lib":161,"../plot_api/plot_template":195,"./domain":230}],253:[function(e,t,r){"use strict";var n=e("./lib/loggers");var i=e("./lib/noop");var a=e("./lib/push_unique");var o=e("./lib/is_plain_object");var s=e("./lib/extend");var l=e("./plots/attributes");var u=e("./plots/layout_attributes");var c=s.extendFlat;var f=s.extendDeepAll;r.modules={};r.allCategories={};r.allTypes=[];r.subplotsRegistry={};r.transformsRegistry={};r.componentsRegistry={};r.layoutArrayContainers=[];r.layoutArrayRegexes=[];r.traceLayoutAttributes={};r.localeRegistry={};r.apiMethodRegistry={};r.register=function e(t){if(!t){throw new Error("No argument passed to Plotly.register.")}else if(t&&!Array.isArray(t)){t=[t]}for(var n=0;n<t.length;n++){var i=t[n];if(!i){throw new Error("Invalid module was attempted to be registered!")}switch(i.moduleType){case"trace":h(i);break;case"transform":v(i);break;case"component":d(i);break;case"locale":m(i);break;case"apiMethod":var a=i.name;r.apiMethodRegistry[a]=i.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}};r.getModule=function(e){var t=r.modules[b(e)];if(!t)return false;return t._module};r.traceIs=function(e,t){e=b(e);if(e==="various")return false;var i=r.modules[e];if(!i){if(e&&e!=="area"){n.log("Unrecognized trace type "+e+".")}i=r.modules[l.type.dflt]}return!!i.categories[t]};r.getTransformIndices=function(e,t){var r=[];var n=e.transforms||[];for(var i=0;i<n.length;i++){if(n[i].type===t){r.push(i)}}return r};r.hasTransform=function(e,t){var r=e.transforms||[];for(var n=0;n<r.length;n++){if(r[n].type===t){return true}}return false};r.getComponentMethod=function(e,t){var n=r.componentsRegistry[e];if(!n)return i;return n[t]||i};r.call=function(){var e=arguments[0];var t=[].slice.call(arguments,1);return r.apiMethodRegistry[e].apply(null,t)};function h(e){var t=e.name;var i=e.categories;var a=e.meta;if(r.modules[t]){n.log("Type "+t+" already registered");return}if(!r.subplotsRegistry[e.basePlotModule.name]){p(e.basePlotModule)}var o={};for(var s=0;s<i.length;s++){o[i[s]]=true;r.allCategories[i[s]]=true}r.modules[t]={_module:e,categories:o};if(a&&Object.keys(a).length){r.modules[t].meta=a}r.allTypes.push(t);for(var l in r.componentsRegistry){y(l,t)}if(e.layoutAttributes){c(r.traceLayoutAttributes,e.layoutAttributes)}}function p(e){var t=e.name;if(r.subplotsRegistry[t]){n.log("Plot type "+t+" already registered.");return}g(e);r.subplotsRegistry[t]=e;for(var i in r.componentsRegistry){x(i,e.name)}}function d(e){if(typeof e.name!=="string"){throw new Error("Component module *name* must be a string.")}var t=e.name;r.componentsRegistry[t]=e;if(e.layoutAttributes){if(e.layoutAttributes._isLinkedToArray){a(r.layoutArrayContainers,t)}g(e)}for(var n in r.modules){y(t,n)}for(var i in r.subplotsRegistry){x(t,i)}for(var o in r.transformsRegistry){_(t,o)}if(e.schema&&e.schema.layout){f(u,e.schema.layout)}}function v(e){if(typeof e.name!=="string"){throw new Error("Transform module *name* must be a string.")}var t="Transform module "+e.name;var i=typeof e.transform==="function";var a=typeof e.calcTransform==="function";if(!i&&!a){throw new Error(t+" is missing a *transform* or *calcTransform* method.")}if(i&&a){n.log([t+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" "))}if(!o(e.attributes)){n.log(t+" registered without an *attributes* object.")}if(typeof e.supplyDefaults!=="function"){n.log(t+" registered without a *supplyDefaults* method.")}r.transformsRegistry[e.name]=e;for(var s in r.componentsRegistry){_(s,e.name)}}function m(e){var t=e.name;var n=t.split("-")[0];var i=e.dictionary;var a=e.format;var o=i&&Object.keys(i).length;var s=a&&Object.keys(a).length;var l=r.localeRegistry;var u=l[t];if(!u)l[t]=u={};if(n!==t){var c=l[n];if(!c)l[n]=c={};if(o&&c.dictionary===u.dictionary){c.dictionary=i}if(s&&c.format===u.format){c.format=a}}if(o)u.dictionary=i;if(s)u.format=a}function g(e){if(e.layoutAttributes){var t=e.layoutAttributes._arrayAttrRegexps;if(t){for(var n=0;n<t.length;n++){a(r.layoutArrayRegexes,t[n])}}}}function y(e,t){var n=r.componentsRegistry[e].schema;if(!n||!n.traces)return;var i=n.traces[t];if(i){f(r.modules[t]._module.attributes,i)}}function _(e,t){var n=r.componentsRegistry[e].schema;if(!n||!n.transforms)return;var i=n.transforms[t];if(i){f(r.transformsRegistry[t].attributes,i)}}function x(e,t){var n=r.componentsRegistry[e].schema;if(!n||!n.subplots)return;var i=r.subplotsRegistry[t];var a=i.layoutAttributes;var o=i.attr==="subplot"?i.name:i.attr;if(Array.isArray(o))o=o[0];var s=n.subplots[o];if(a&&s){f(a,s)}}function b(e){if(typeof e==="object")e=e.type;return e}},{"./lib/extend":154,"./lib/is_plain_object":163,"./lib/loggers":166,"./lib/noop":170,"./lib/push_unique":174,"./plots/attributes":202,"./plots/layout_attributes":235}],254:[function(e,t,r){"use strict";var n=e("../lib");var i=n.extendFlat;var a=n.extendDeep;function o(e){var t;switch(e){case"themes__thumb":t={autosize:true,width:150,height:150,title:"",showlegend:false,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":t={title:"",hidesources:true,showlegend:false,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:t={}}return t}function s(e){var t=["xaxis","yaxis","zaxis"];return t.indexOf(e.slice(0,5))>-1}t.exports=function e(t,r){if(t.framework&&t.framework.isPolar){t=t.framework.getConfig()}var n;var l=t.data;var u=t.layout;var c=a([],l);var f=a({},u,o(r.tileClass));var h=t._context||{};if(r.width)f.width=r.width;if(r.height)f.height=r.height;if(r.tileClass==="thumbnail"||r.tileClass==="themes__thumb"){f.annotations=[];var p=Object.keys(f);for(n=0;n<p.length;n++){if(s(p[n])){f[p[n]].title=""}}for(n=0;n<c.length;n++){var d=c[n];d.showscale=false;if(d.marker)d.marker.showscale=false;if(d.type==="pie")d.textposition="none"}}if(Array.isArray(r.annotations)){for(n=0;n<r.annotations.length;n++){f.annotations.push(r.annotations[n])}}var v=Object.keys(f).filter(function(e){return e.match(/^scene\d*$/)});if(v.length){var m={};if(r.tileClass==="thumbnail"){m={title:"",showaxeslabels:false,showticklabels:false,linetickenable:false}}for(n=0;n<v.length;n++){var g=f[v[n]];if(!g.xaxis){g.xaxis={}}if(!g.yaxis){g.yaxis={}}if(!g.zaxis){g.zaxis={}}i(g.xaxis,m);i(g.yaxis,m);i(g.zaxis,m);g._scene=null}}var y=document.createElement("div");if(r.tileClass)y.className=r.tileClass;var _={gd:y,td:y,layout:f,data:c,config:{staticPlot:r.staticPlot===undefined?true:r.staticPlot,plotGlPixelRatio:r.plotGlPixelRatio===undefined?2:r.plotGlPixelRatio,displaylogo:r.displaylogo||false,showLink:r.showLink||false,showTips:r.showTips||false,mapboxAccessToken:h.mapboxAccessToken}};if(r.setBackground!=="transparent"){_.config.setBackground=r.setBackground||"opaque"}_.gd.defaultLayout=o(r.tileClass);return _}},{"../lib":161}],255:[function(e,t,r){"use strict";var n=e("../plot_api/to_image");var i=e("../lib");var a=e("./filesaver");function o(e,t){t=t||{};t.format=t.format||"png";return new Promise(function(r,o){if(e._snapshotInProgress){o(new Error("Snapshotting already in progress."))}if(i.isIE()&&t.format!=="svg"){o(new Error("Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."))}e._snapshotInProgress=true;var s=n(e,t);var l=t.filename||e.fn||"newplot";l+="."+t.format;s.then(function(t){e._snapshotInProgress=false;return a(t,l)}).then(function(e){r(e)}).catch(function(t){e._snapshotInProgress=false;o(t)})})}t.exports=o},{"../lib":161,"../plot_api/to_image":198,"./filesaver":256}],256:[function(e,t,r){"use strict";var n=function(e,t){var r=document.createElement("a");var n="download"in r;var i=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent);var a=new Promise(function(a,o){if(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){o(new Error("IE < 10 unsupported"))}if(i){document.location.href="data:application/octet-stream"+e.slice(e.search(/[,;]/));a(t)}if(!t){t="download"}if(n){r.href=e;r.download=t;document.body.appendChild(r);r.click();document.body.removeChild(r);a(t)}if(typeof navigator!=="undefined"&&navigator.msSaveBlob){var s=e.split(/^data:image\/svg\+xml,/)[1];var l=decodeURIComponent(s);navigator.msSaveBlob(new Blob([l]),t);a(t)}o(new Error("download error"))});return a};t.exports=n},{}],257:[function(e,t,r){"use strict";r.getDelay=function(e){if(!e._has)return 0;return e._has("gl3d")||e._has("gl2d")||e._has("mapbox")?500:0};r.getRedrawFunc=function(e){var t=e._fullLayout||{};var r=t._has&&t._has("polar");var n=!r&&e.data&&e.data[0]&&e.data[0].r;if(n)return;return function(){(e.calcdata||[]).forEach(function(e){if(e[0]&&e[0].t&&e[0].t.cb)e[0].t.cb()})}}},{}],258:[function(e,t,r){"use strict";var n=e("./helpers");var i={getDelay:n.getDelay,getRedrawFunc:n.getRedrawFunc,clone:e("./cloneplot"),toSVG:e("./tosvg"),svgToImg:e("./svgtoimg"),toImage:e("./toimage"),downloadImage:e("./download")};t.exports=i},{"./cloneplot":254,"./download":255,"./helpers":257,"./svgtoimg":259,"./toimage":260,"./tosvg":261}],259:[function(e,t,r){"use strict";var n=e("../lib");var i=e("events").EventEmitter;function a(e){var t=e.emitter||new i;var r=new Promise(function(i,a){var o=window.Image;var s=e.svg;var l=e.format||"png";if(n.isIE()&&l!=="svg"){var u=new Error("Sorry IE does not support downloading from canvas. Try {format:'svg'} instead.");a(u);if(!e.promise){return t.emit("error",u)}else{return r}}var c=e.canvas;var f=e.scale||1;var h=e.width||300;var p=e.height||150;var d=f*h;var v=f*p;var m=c.getContext("2d");var g=new o;var y="data:image/svg+xml,"+encodeURIComponent(s);c.width=d;c.height=v;g.onload=function(){var r;if(l!=="svg"){m.drawImage(g,0,0,d,v)}switch(l){case"jpeg":r=c.toDataURL("image/jpeg");break;case"png":r=c.toDataURL("image/png");break;case"webp":r=c.toDataURL("image/webp");break;case"svg":r=y;break;default:var n="Image format is not jpeg, png, svg or webp.";a(new Error(n));if(!e.promise){return t.emit("error",n)}}i(r);if(!e.promise){t.emit("success",r)}};g.onerror=function(r){a(r);if(!e.promise){return t.emit("error",r)}};g.src=y});if(e.promise){return r}return t}t.exports=a},{"../lib":161,events:8}],260:[function(e,t,r){"use strict";var n=e("events").EventEmitter;var i=e("../registry");var a=e("../lib");var o=e("./helpers");var s=e("./cloneplot");var l=e("./tosvg");var u=e("./svgtoimg");function c(e,t){var r=new n;var c=s(e,{format:"png"});var f=c.gd;f.style.position="absolute";f.style.left="-5000px";document.body.appendChild(f);function h(){var e=o.getDelay(f._fullLayout);setTimeout(function(){var e=l(f);var n=document.createElement("canvas");n.id=a.randstr();r=u({format:t.format,width:f._fullLayout.width,height:f._fullLayout.height,canvas:n,emitter:r,svg:e});r.clean=function(){if(f)document.body.removeChild(f)}},e)}var p=o.getRedrawFunc(f);i.call("plot",f,c.data,c.layout,c.config).then(p).then(h).catch(function(e){r.emit("error",e)});return r}t.exports=c},{"../lib":161,"../registry":253,"./cloneplot":254,"./helpers":257,"./svgtoimg":259,"./tosvg":261,events:8}],261:[function(e,t,r){"use strict";var n=e("d3");var i=e("../lib");var a=e("../components/drawing");var o=e("../components/color");var s=e("../constants/xmlns_namespaces");var l=/"/g;var u="TOBESTRIPPED";var c=new RegExp('("'+u+")|("+u+'")',"g");function f(e){var t=n.select("body").append("div").style({display:"none"}).html("");var r=e.replace(/(&[^;]*;)/gi,function(e){if(e==="&lt;"){return"&#60;"}if(e==="&rt;"){return"&#62;"}if(e.indexOf("<")!==-1||e.indexOf(">")!==-1){return""}return t.html(e).text()});t.remove();return r}function h(e){return e.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}t.exports=function e(t,r,p){var d=t._fullLayout;var v=d._paper;var m=d._toppaper;var g=d.width;var y=d.height;var _;v.insert("rect",":first-child").call(a.setRect,0,0,g,y).call(o.fill,d.paper_bgcolor);var x=d._basePlotModules||[];for(_=0;_<x.length;_++){var b=x[_];if(b.toSVG)b.toSVG(t)}if(m){var w=m.node().childNodes;var k=Array.prototype.slice.call(w);for(_=0;_<k.length;_++){var A=k[_];if(A.childNodes.length)v.node().appendChild(A)}}if(d._draggers){d._draggers.remove()}v.node().style.background="";v.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var e=n.select(this);if(this.style.visibility==="hidden"||this.style.display==="none"){e.remove();return}else{e.style({visibility:null,display:null})}var t=this.style.fontFamily;if(t&&t.indexOf('"')!==-1){e.style("font-family",t.replace(l,u))}});v.selectAll(".point,.scatterpts").each(function(){var e=n.select(this);var t=this.style.fill;if(t&&t.indexOf("url(")!==-1){e.style("fill",t.replace(l,u))}});if(r==="pdf"||r==="eps"){v.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0)}v.node().setAttributeNS(s.xmlns,"xmlns",s.svg);v.node().setAttributeNS(s.xmlns,"xmlns:xlink",s.xlink);if(r==="svg"&&p){v.attr("width",p*g);v.attr("height",p*y);v.attr("viewBox","0 0 "+g+" "+y)}var T=(new window.XMLSerializer).serializeToString(v.node());T=f(T);T=h(T);T=T.replace(c,"'");if(i.isIE()){T=T.replace(/"/gi,"'");T=T.replace(/(\('#)([^']*)('\))/gi,'("#$2")');T=T.replace(/(\\')/gi,'"')}return T}},{"../components/color":42,"../components/drawing":67,"../constants/xmlns_namespaces":144,"../lib":161,d3:6}],262:[function(e,t,r){"use strict";var n=e("../../lib");r.formatPiePercent=function e(t,r){var i=(t*100).toPrecision(3);if(i.lastIndexOf(".")!==-1){i=i.replace(/[.]?0+$/,"")}return n.numSeparate(i,r)+"%"};r.formatPieValue=function e(t,r){var i=t.toPrecision(10);if(i.lastIndexOf(".")!==-1){i=i.replace(/[.]?0+$/,"")}return n.numSeparate(i,r)};r.getFirstFilled=function e(t,r){if(!Array.isArray(t))return;for(var n=0;n<r.length;n++){var i=t[r[n]];if(i||i===0)return i}};r.castOption=function e(t,n){if(Array.isArray(t))return r.getFirstFilled(t,n);else if(t)return t}},{"../../lib":161}],263:[function(e,t,r){"use strict";var n=e("../../components/color");var i=e("./helpers").castOption;t.exports=function e(t,r,a){var o=a.marker.line;var s=i(o.color,r.pts)||n.defaultLine;var l=i(o.width,r.pts)||0;t.style({"stroke-width":l}).call(n.fill,r.color).call(n.stroke,s)}},{"../../components/color":42,"./helpers":262}],264:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r){for(var i=0;i<t.length;i++)t[i].i=i;n.mergeArray(r.text,t,"tx");n.mergeArray(r.hovertext,t,"htx");n.mergeArray(r.customdata,t,"data");n.mergeArray(r.textposition,t,"tp");if(r.textfont){n.mergeArray(r.textfont.size,t,"ts");n.mergeArray(r.textfont.color,t,"tc");n.mergeArray(r.textfont.family,t,"tf")}var a=r.marker;if(a){n.mergeArray(a.size,t,"ms");n.mergeArray(a.opacity,t,"mo");n.mergeArray(a.symbol,t,"mx");n.mergeArray(a.color,t,"mc");var o=a.line;if(a.line){n.mergeArray(o.color,t,"mlc");n.mergeArray(o.width,t,"mlw")}var s=a.gradient;if(s&&s.type!=="none"){n.mergeArray(s.type,t,"mgt");n.mergeArray(s.color,t,"mgc")}}}},{"../../lib":161}],265:[function(e,t,r){"use strict";var n=e("../../components/colorscale/attributes");var i=e("../../components/colorbar/attributes");var a=e("../../plots/font_attributes");var o=e("../../components/drawing/attributes").dash;var s=e("../../components/drawing");var l=e("./constants");var u=e("../../lib/extend").extendFlat;t.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"string",dflt:"",arrayOk:true,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:true,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:u({},o,{editType:"style"}),simplify:{valType:"boolean",dflt:true,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:false,editType:"calc"},cliponaxis:{valType:"boolean",dflt:true,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],dflt:"none",editType:"calc"},fillcolor:{valType:"color",editType:"style"},marker:u({symbol:{valType:"enumerated",values:s.symbolList,dflt:"circle",arrayOk:true,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:true,editType:"style"},size:{valType:"number",min:0,dflt:6,arrayOk:true,editType:"calcIfAutorange"},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},colorbar:i,line:u({width:{valType:"number",min:0,arrayOk:true,editType:"style"},editType:"calc"},n("marker.line")),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:true,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:true,editType:"calc"},editType:"calc"},editType:"calc"},n("marker")),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:true,editType:"calc"},textfont:a({editType:"calc",colorEditType:"style",arrayOk:true}),r:{valType:"data_array",editType:"calc"},t:{valType:"data_array",editType:"calc"}}},{"../../components/colorbar/attributes":43,"../../components/colorscale/attributes":49,"../../components/drawing":67,"../../components/drawing/attributes":66,"../../lib/extend":154,"../../plots/font_attributes":231,"./constants":270}],266:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib").isArrayOrTypedArray;var a=e("../../plots/cartesian/axes");var o=e("../../constants/numerical").BADNUM;var s=e("./subtypes");var l=e("./colorscale_calc");var u=e("./arrays_to_calcdata");var c=e("./calc_selection");function f(e,t){var r=a.getFromId(e,t.xaxis||"x");var i=a.getFromId(e,t.yaxis||"y");var s=r.makeCalcdata(t,"x");var f=i.makeCalcdata(t,"y");var d=t._length;var v=new Array(d);var m=p(t,d);h(e,t,r,i,s,f,m);for(var g=0;g<d;g++){v[g]=n(s[g])&&n(f[g])?{x:s[g],y:f[g]}:{x:o,y:o};if(t.ids){v[g].id=String(t.ids[g])}}u(v,t);l(t);c(v,t);e.firstscatter=false;return v}function h(e,t,r,n,i,o,l){var u=t._length;r._minDtick=0;n._minDtick=0;var c={padded:true};var f={padded:true};if(l){c.ppad=f.ppad=l}if((t.fill==="tozerox"||t.fill==="tonextx"&&e.firstscatter)&&(i[0]!==i[u-1]||o[0]!==o[u-1])){c.tozero=true}else if(!(t.error_y||{}).visible&&(["tonexty","tozeroy"].indexOf(t.fill)!==-1||!s.hasMarkers(t)&&!s.hasText(t))){c.padded=false;c.ppad=0}if((t.fill==="tozeroy"||t.fill==="tonexty"&&e.firstscatter)&&(i[0]!==i[u-1]||o[0]!==o[u-1])){f.tozero=true}else if(["tonextx","tozerox"].indexOf(t.fill)!==-1){f.padded=false}a.expand(r,i,c);a.expand(n,o,f)}function p(e,t){if(!s.hasMarkers(e))return;var r=e.marker;var n=1.6*(e.marker.sizeref||1);var o;if(e.marker.sizemode==="area"){o=function(e){return Math.max(Math.sqrt((e||0)/n),3)}}else{o=function(e){return Math.max((e||0)/n,3)}}if(i(r.size)){var l={type:"linear"};a.setConvert(l);var u=l.makeCalcdata(e.marker,"size");var c=new Array(t);for(var f=0;f<t;f++){c[f]=o(u[f])}return c}else{return o(r.size)}}t.exports={calc:f,calcMarkerSize:p,calcAxisExpansion:h}},{"../../constants/numerical":142,"../../lib":161,"../../plots/cartesian/axes":205,"./arrays_to_calcdata":264,"./calc_selection":267,"./colorscale_calc":269,"./subtypes":287,"fast-isnumeric":9}],267:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r){if(n.isArrayOrTypedArray(r.selectedpoints)){n.tagSelected(t,r)}}},{"../../lib":161}],268:[function(e,t,r){"use strict";t.exports=function e(t){for(var r=0;r<t.length;r++){var n=t[r];if(n.type!=="scatter")continue;var i=n.fill;if(i==="none"||i==="toself")continue;n.opacity=undefined;if(i==="tonexty"||i==="tonextx"){for(var a=r-1;a>=0;a--){var o=t[a];if(o.type==="scatter"&&o.xaxis===n.xaxis&&o.yaxis===n.yaxis){o.opacity=undefined;break}}}}}},{}],269:[function(e,t,r){"use strict";var n=e("../../components/colorscale/has_colorscale");var i=e("../../components/colorscale/calc");var a=e("./subtypes");t.exports=function e(t){if(a.hasLines(t)&&n(t,"line")){i(t,t.line.color,"line","c")}if(a.hasMarkers(t)){if(n(t,"marker")){i(t,t.marker.color,"marker","c")}if(n(t,"marker.line")){i(t,t.marker.line.color,"marker.line","c")}}}},{"../../components/colorscale/calc":50,"../../components/colorscale/has_colorscale":56,"./subtypes":287}],270:[function(e,t,r){"use strict";t.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20}},{}],271:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../registry");var a=e("./attributes");var o=e("./constants");var s=e("./subtypes");var l=e("./xy_defaults");var u=e("./marker_defaults");var c=e("./line_defaults");var f=e("./line_shape_defaults");var h=e("./text_defaults");var p=e("./fillcolor_defaults");t.exports=function e(t,r,d,v){function m(e,i){return n.coerce(t,r,a,e,i)}var g=l(t,r,v,m),y=g<o.PTS_LINESONLY?"lines+markers":"lines";if(!g){r.visible=false;return}m("text");m("hovertext");m("mode",y);if(s.hasLines(r)){c(t,r,d,v,m);f(t,r,m);m("connectgaps");m("line.simplify")}if(s.hasMarkers(r)){u(t,r,d,v,m,{gradient:true})}if(s.hasText(r)){h(t,r,v,m)}var _=[];if(s.hasMarkers(r)||s.hasText(r)){m("cliponaxis");m("marker.maxdisplayed");_.push("points")}m("fill");if(r.fill!=="none"){p(t,r,d,m);if(!s.hasLines(r))f(t,r,m)}if(r.fill==="tonext"||r.fill==="toself"){_.push("fills")}m("hoveron",_.join("+")||"points");var x=i.getComponentMethod("errorbars","supplyDefaults");x(t,r,d,{axis:"y"});x(t,r,d,{axis:"x",inherit:"y"});n.coerceSelectionMarkerOpacity(r,m)}},{"../../lib":161,"../../registry":253,"./attributes":265,"./constants":270,"./fillcolor_defaults":273,"./line_defaults":277,"./line_shape_defaults":279,"./marker_defaults":283,"./subtypes":287,"./text_defaults":288,"./xy_defaults":289}],272:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function e(t,r,a){var o=Array.isArray(a)?function(e){a.push(e)}:function(e){a.text=e};var s=n.extractOption(t,r,"htx","hovertext");if(i(s))return o(s);var l=n.extractOption(t,r,"tx","text");if(i(l))return o(l)};function i(e){return e||e===0}},{"../../lib":161}],273:[function(e,t,r){"use strict";var n=e("../../components/color");var i=e("../../lib").isArrayOrTypedArray;t.exports=function e(t,r,a,o){var s=false;if(r.marker){var l=r.marker.color,u=(r.marker.line||{}).color;if(l&&!i(l)){s=l}else if(u&&!i(u)){s=u}}o("fillcolor",n.addOpacity((r.line||{}).color||s||a,.5))}},{"../../components/color":42,"../../lib":161}],274:[function(e,t,r){"use strict";var n=e("../../components/color");var i=e("./subtypes");t.exports=function e(t,r){var a,o;if(t.mode==="lines"){a=t.line.color;return a&&n.opacity(a)?a:t.fillcolor}else if(t.mode==="none"){return t.fill?t.fillcolor:""}else{var s=r.mcc||(t.marker||{}).color,l=r.mlcc||((t.marker||{}).line||{}).color;o=s&&n.opacity(s)?s:l&&n.opacity(l)&&(r.mlw||((t.marker||{}).line||{}).width)?l:"";if(o){if(n.opacity(o)<.3){return n.addOpacity(o,.3)}else return o}else{a=(t.line||{}).color;return a&&n.opacity(a)&&i.hasLines(t)&&t.line.width?a:t.fillcolor}}}},{"../../components/color":42,"./subtypes":287}],275:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../../components/fx");var a=e("../../registry");var o=e("./get_trace_color");var s=e("../../components/color");var l=e("./fill_hover_text");t.exports=function e(t,r,u,c){var f=t.cd;var h=f[0].trace;var p=t.xa;var d=t.ya;var v=p.c2p(r);var m=d.c2p(u);var g=[v,m];var y=h.hoveron||"";var _=h.mode.indexOf("markers")!==-1?3:.5;if(y.indexOf("points")!==-1){var x=function(e){var t=Math.max(3,e.mrc||0);var r=1-1/t;var n=Math.abs(p.c2p(e.x)-v);var i=n<t?r*n/t:n-t+r;return i};var b=function(e){var t=Math.max(3,e.mrc||0);var r=1-1/t;var n=Math.abs(d.c2p(e.y)-m);return n<t?r*n/t:n-t+r};var w=function(e){var t=Math.max(_,e.mrc||0);var r=p.c2p(e.x)-v;var n=d.c2p(e.y)-m;return Math.max(Math.sqrt(r*r+n*n)-t,1-_/t)};var k=i.getDistanceFunction(c,x,b,w);i.getClosest(f,k,t);if(t.index!==false){var A=f[t.index];var T=p.c2p(A.x,true);var M=d.c2p(A.y,true);var S=A.mrc||1;n.extendFlat(t,{color:o(h,A),x0:T-S,x1:T+S,xLabelVal:A.x,y0:M-S,y1:M+S,yLabelVal:A.y,spikeDistance:w(A)});l(A,h,t);a.getComponentMethod("errorbars","hoverInfo")(A,h,t);return[t]}}if(y.indexOf("fills")!==-1&&h._polygons){var C=h._polygons;var z=[];var E=false;var L=Infinity;var I=-Infinity;var P=Infinity;var D=-Infinity;var O,R,F,B,N,j,V,q,U;for(O=0;O<C.length;O++){F=C[O];if(F.contains(g)){E=!E;z.push(F);P=Math.min(P,F.ymin);D=Math.max(D,F.ymax)}}if(E){P=Math.max(P,0);D=Math.min(D,d._length);var Z=(P+D)/2;for(O=0;O<z.length;O++){B=z[O].pts;for(R=1;R<B.length;R++){q=B[R-1][1];U=B[R][1];if(q>Z!==U>=Z){j=B[R-1][0];V=B[R][0];if(U-q){N=j+(V-j)*(Z-q)/(U-q);L=Math.min(L,N);I=Math.max(I,N)}}}}L=Math.max(L,0);I=Math.min(I,p._length);var H=s.defaultLine;if(s.opacity(h.fillcolor))H=h.fillcolor;else if(s.opacity((h.line||{}).color)){H=h.line.color}n.extendFlat(t,{distance:t.maxHoverDistance,x0:L,x1:I,y0:Z,y1:Z,color:H});delete t.index;if(h.text&&!Array.isArray(h.text)){t.text=String(h.text)}else t.text=h.name;return[t]}}}},{"../../components/color":42,"../../components/fx":84,"../../lib":161,"../../registry":253,"./fill_hover_text":272,"./get_trace_color":274}],276:[function(e,t,r){"use strict";var n={};var i=e("./subtypes");n.hasLines=i.hasLines;n.hasMarkers=i.hasMarkers;n.hasText=i.hasText;n.isBubble=i.isBubble;n.attributes=e("./attributes");n.supplyDefaults=e("./defaults");n.cleanData=e("./clean_data");n.calc=e("./calc").calc;n.arraysToCalcdata=e("./arrays_to_calcdata");n.plot=e("./plot");n.colorbar=e("./marker_colorbar");n.style=e("./style").style;n.styleOnSelect=e("./style").styleOnSelect;n.hoverPoints=e("./hover");n.selectPoints=e("./select");n.animatable=true;n.moduleType="trace";n.name="scatter";n.basePlotModule=e("../../plots/cartesian");n.categories=["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"];n.meta={};t.exports=n},{"../../plots/cartesian":216,"./arrays_to_calcdata":264,"./attributes":265,"./calc":266,"./clean_data":268,"./defaults":271,"./hover":275,"./marker_colorbar":282,"./plot":284,"./select":285,"./style":286,"./subtypes":287}],277:[function(e,t,r){"use strict";var n=e("../../lib").isArrayOrTypedArray;var i=e("../../components/colorscale/has_colorscale");var a=e("../../components/colorscale/defaults");t.exports=function e(t,r,o,s,l,u){var c=(t.marker||{}).color;l("line.color",o);if(i(t,"line")){a(t,r,s,l,{prefix:"line.",cLetter:"c"})}else{var f=(n(c)?false:c)||o;l("line.color",f)}l("line.width");if(!(u||{}).noDash)l("line.dash")}},{"../../components/colorscale/defaults":52,"../../components/colorscale/has_colorscale":56,"../../lib":161}],278:[function(e,t,r){"use strict";var n=e("../../constants/numerical").BADNUM;var i=e("../../lib");var a=i.segmentsIntersect;var o=i.constrain;var s=e("./constants");t.exports=function e(t,r){var l=r.xaxis;var u=r.yaxis;var c=r.simplify;var f=r.connectGaps;var h=r.baseTolerance;var p=r.shape;var d=p==="linear";var v=[];var m=s.minTolerance;var g=new Array(t.length);var y=0;var _;var x,b,w,k;var A;var T;var M;var S;var C,z,E,L;var I,P,D;if(!c){h=m=-1}function O(e){var r=t[e];if(!r)return false;var i=l.c2p(r.x);var a=u.c2p(r.y);if(i===n||a===n)return r.intoCenter||false;return[i,a]}function R(e,t,r,n){var i=r-e;var a=n-t;var o=.5-e;var s=.5-t;var l=i*i+a*a;var u=i*o+a*s;if(u>0&&u<l){var c=o*a-s*i;if(c*c<l)return true}}var F,B;function N(e,t){var r=e[0]/l._length;var n=e[1]/u._length;var i=Math.max(0,-r,r-1,-n,n-1);if(i&&F!==undefined&&R(r,n,F,B)){i=0}if(i&&t&&R(r,n,t[0]/l._length,t[1]/u._length)){i=0}return(1+s.toleranceGrowth*i)*h}function j(e,t){var r=e[0]-t[0];var n=e[1]-t[1];return Math.sqrt(r*r+n*n)}var V=s.maxScreensAway;var q=-l._length*V;var U=l._length*(1+V);var Z=-u._length*V;var H=u._length*(1+V);var G=[[q,Z,U,Z],[U,Z,U,H],[U,H,q,H],[q,H,q,Z]];var $,W,X,Y,J,K;function Q(e,t){var r=[];var n=0;for(var i=0;i<4;i++){var o=G[i];var s=a(e[0],e[1],t[0],t[1],o[0],o[1],o[2],o[3]);if(s&&(!n||Math.abs(s.x-r[0][0])>1||Math.abs(s.y-r[0][1])>1)){s=[s.x,s.y];if(n&&j(s,e)<j(r[0],e))r.unshift(s);else r.push(s);n++}}return r}function ee(e){if(e[0]<q||e[0]>U||e[1]<Z||e[1]>H){return[o(e[0],q,U),o(e[1],Z,H)]}}function te(e,t){if(e[0]===t[0]&&(e[0]===q||e[0]===U))return true;if(e[1]===t[1]&&(e[1]===Z||e[1]===H))return true}function re(e,t){var r=[];var n=ee(e);var i=ee(t);if(n&&i&&te(n,i))return r;if(n)r.push(n);if(i)r.push(i);return r}function ne(e,t,r){return function(n,a){var o=ee(n);var s=ee(a);var l=[];if(o&&s&&te(o,s))return l;if(o)l.push(o);if(s)l.push(s);var u=2*i.constrain((n[e]+a[e])/2,t,r)-((o||n)[e]+(s||a)[e]);if(u){var c;if(o&&s){c=u>0===o[e]>s[e]?o:s}else c=o||s;c[e]+=u}return l}}var ie;if(p==="linear"||p==="spline"){ie=Q}else if(p==="hv"||p==="vh"){ie=re}else if(p==="hvh")ie=ne(0,q,U);else if(p==="vhv")ie=ne(1,Z,H);function ae(e,t){var r=t[0]-e[0];var n=(t[1]-e[1])/r;var i=(e[1]*t[0]-t[1]*e[0])/r;if(i>0)return[n>0?q:U,H];else return[n>0?U:q,Z]}function oe(e){var t=e[0];var r=e[1];var n=t===g[y-1][0];var i=r===g[y-1][1];if(n&&i)return;if(y>1){var a=t===g[y-2][0];var o=r===g[y-2][1];if(n&&(t===q||t===U)&&a){if(o)y--;else g[y-1]=e}else if(i&&(r===Z||r===H)&&o){if(a)y--;else g[y-1]=e}else g[y++]=e}else g[y++]=e}function se(e){if(g[y-1][0]!==e[0]&&g[y-1][1]!==e[1]){oe([X,Y])}oe(e);J=null;X=Y=0}function le(e){F=e[0]/l._length;B=e[1]/u._length;$=e[0]<q?q:e[0]>U?U:0;W=e[1]<Z?Z:e[1]>H?H:0;if($||W){if(!y){g[y++]=[$||e[0],W||e[1]]}else if(J){var t=ie(J,e);if(t.length>1){se(t[0]);g[y++]=t[1]}}else{K=ie(g[y-1],e)[0];g[y++]=K}var r=g[y-1];if($&&W&&(r[0]!==$||r[1]!==W)){if(J){if(X!==$&&Y!==W){if(X&&Y){oe(ae(J,e))}else{oe([X||$,Y||W])}}else if(X&&Y){oe([X,Y])}}oe([$,W])}else if(X-$&&Y-W){oe([$||X,W||Y])}J=e;X=$;Y=W}else{if(J){se(ie(J,e)[0])}g[y++]=e}}for(_=0;_<t.length;_++){x=O(_);if(!x)continue;y=0;J=null;le(x);for(_++;_<t.length;_++){w=O(_);if(!w){if(f)continue;else break}if(!d){le(w);continue}var ue=O(_+1);C=j(w,x);if(C<N(w,ue)*m)continue;M=[(w[0]-x[0])/C,(w[1]-x[1])/C];k=x;z=C;E=I=P=0;T=false;b=w;for(_++;_<t.length;_++){A=ue;ue=O(_+1);if(!A){if(f)continue;else break}S=[A[0]-x[0],A[1]-x[1]];D=S[0]*M[1]-S[1]*M[0];I=Math.min(I,D);P=Math.max(P,D);if(P-I>N(A,ue))break;b=A;L=S[0]*M[0]+S[1]*M[1];if(L>z){z=L;w=A;T=false}else if(L<E){E=L;k=A;T=true}}if(T){le(w);if(b!==k)le(k)}else{if(k!==x)le(k);if(b!==w)le(w)}le(b);if(_>=t.length||!A)break;le(A);x=A}if(J)oe([X||J[0],Y||J[1]]);v.push(g.slice(0,y))}return v}},{"../../constants/numerical":142,"../../lib":161,"./constants":270}],279:[function(e,t,r){"use strict";t.exports=function e(t,r,n){var i=n("line.shape");if(i==="spline")n("line.smoothing")}},{}],280:[function(e,t,r){"use strict";t.exports=function e(t,r,n){var i,a;var o=null;for(a=0;a<n.length;++a){i=n[a][0].trace;if(i.visible===true){i._nexttrace=null;if(["tonextx","tonexty","tonext"].indexOf(i.fill)!==-1){i._prevtrace=o;if(o){o._nexttrace=i}}o=i}else{i._prevtrace=i._nexttrace=null}}}},{}],281:[function(e,t,r){"use strict";var n=e("fast-isnumeric");t.exports=function e(t){var r=t.marker,i=r.sizeref||1,a=r.sizemin||0;var o=r.sizemode==="area"?function(e){return Math.sqrt(e/i)}:function(e){return e/i};return function(e){var t=o(e/2);return n(t)&&t>0?Math.max(t,a):0}}},{"fast-isnumeric":9}],282:[function(e,t,r){"use strict";t.exports={container:"marker",min:"cmin",max:"cmax"}},{}],283:[function(e,t,r){"use strict";var n=e("../../components/color");var i=e("../../components/colorscale/has_colorscale");var a=e("../../components/colorscale/defaults");var o=e("./subtypes");t.exports=function e(t,r,s,l,u,c){var f=o.isBubble(t),h=(t.line||{}).color,p;c=c||{};if(h)s=h;u("marker.symbol");u("marker.opacity",f?.7:1);u("marker.size");u("marker.color",s);if(i(t,"marker")){a(t,r,l,u,{prefix:"marker.",cLetter:"c"})}if(!c.noSelect){u("selected.marker.color");u("unselected.marker.color");u("selected.marker.size");u("unselected.marker.size")}if(!c.noLine){if(h&&!Array.isArray(h)&&r.marker.color!==h){p=h}else if(f)p=n.background;else p=n.defaultLine;u("marker.line.color",p);if(i(t,"marker.line")){a(t,r,l,u,{prefix:"marker.line.",cLetter:"c"})}u("marker.line.width",f?1:0)}if(f){u("marker.sizeref");u("marker.sizemin");u("marker.sizemode")}if(c.gradient){var d=u("marker.gradient.type");if(d!=="none"){u("marker.gradient.color")}}}},{"../../components/color":42,"../../components/colorscale/defaults":52,"../../components/colorscale/has_colorscale":56,"./subtypes":287}],284:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../registry");var a=e("../../lib");var o=e("../../components/drawing");var s=e("./subtypes");var l=e("./line_points");var u=e("./link_traces");var c=e("../../lib/polygon").tester;t.exports=function e(t,r,i,a,o,s){var l,c,p,d;var v=!o;var m=!!o&&o.duration>0;p=a.selectAll("g.trace").data(i,function(e){return e[0].trace.uid});p.enter().append("g").attr("class",function(e){return"trace scatter trace"+e[0].trace.uid}).style("stroke-miterlimit",2);u(t,r,i);f(t,a,r);for(l=0,c={};l<i.length;l++){c[i[l][0].trace.uid]=l}a.selectAll("g.trace").sort(function(e,t){var r=c[e[0].trace.uid];var n=c[t[0].trace.uid];return r>n?1:-1});if(m){if(s){d=s()}var g=n.transition().duration(o.duration).ease(o.easing).each("end",function(){d&&d()}).each("interrupt",function(){d&&d()});g.each(function(){a.selectAll("g.trace").each(function(e,n){h(t,n,r,e,i,this,o)})})}else{a.selectAll("g.trace").each(function(e,n){h(t,n,r,e,i,this,o)})}if(v){p.exit().remove()}a.selectAll("path:not([d])").remove()};function f(e,t,r){var i;t.selectAll("g.trace").each(function(e){var t=n.select(this);i=e[0].trace;if(i._nexttrace){i._nextFill=t.select(".js-fill.js-tonext");if(!i._nextFill.size()){var a=":first-child";if(t.select(".js-fill.js-tozero").size()){a+=" + *"}i._nextFill=t.insert("path",a).attr("class","js-fill js-tonext")}}else{t.selectAll(".js-fill.js-tonext").remove();i._nextFill=null}if(i.fill&&(i.fill.substr(0,6)==="tozero"||i.fill==="toself"||i.fill.substr(0,2)==="to"&&!i._prevtrace)){i._ownFill=t.select(".js-fill.js-tozero");if(!i._ownFill.size()){i._ownFill=t.insert("path",":first-child").attr("class","js-fill js-tozero")}}else{t.selectAll(".js-fill.js-tozero").remove();i._ownFill=null}t.selectAll(".js-fill").call(o.setClipUrl,r.layerClipId)})}function h(e,t,r,u,f,h,d){var v,m;p(e,t,r,u,f);var g=!!d&&d.duration>0;function y(e){return g?e.transition():e}var _=r.xaxis,x=r.yaxis;var b=u[0].trace,w=b.line,k=n.select(h);i.getComponentMethod("errorbars","plot")(k,r,d);if(b.visible!==true)return;y(k).style("opacity",b.opacity);var A,T;var M=b.fill.charAt(b.fill.length-1);if(M!=="x"&&M!=="y")M="";if(!r.isRangePlot)u[0].node3=k;var S="";var C=[];var z=b._prevtrace;if(z){S=z._prevRevpath||"";T=z._nextFill;C=z._polygons}var E,L,I="",P="",D,O,R,F,B,N,j;var V=[],q=a.noop;A=b._ownFill;if(s.hasLines(b)||b.fill!=="none"){if(T){T.datum(u)}if(["hv","vh","hvh","vhv"].indexOf(w.shape)!==-1){D=o.steps(w.shape);O=o.steps(w.shape.split("").reverse().join(""))}else if(w.shape==="spline"){D=O=function(e){var t=e[e.length-1];if(e.length>1&&e[0][0]===t[0]&&e[0][1]===t[1]){return o.smoothclosed(e.slice(1),w.smoothing)}else{return o.smoothopen(e,w.smoothing)}}}else{D=O=function(e){return"M"+e.join("L")}}R=function(e){return O(e.reverse())};V=l(u,{xaxis:_,yaxis:x,connectGaps:b.connectgaps,baseTolerance:Math.max(w.width||1,3)/4,shape:w.shape,simplify:w.simplify});j=b._polygons=new Array(V.length);for(m=0;m<V.length;m++){b._polygons[m]=c(V[m])}if(V.length){F=V[0][0];B=V[V.length-1];N=B[B.length-1]}q=function(e){return function(t){E=D(t);L=R(t);if(!I){I=E;P=L}else if(M){I+="L"+E.substr(1);P=L+("L"+P.substr(1))}else{I+="Z"+E;P=L+"Z"+P}if(s.hasLines(b)&&t.length>1){var r=n.select(this);r.datum(u);if(e){y(r.style("opacity",0).attr("d",E).call(o.lineGroupStyle)).style("opacity",1)}else{var i=y(r);i.attr("d",E);o.singleLineStyle(u,i)}}}}}var U=k.selectAll(".js-line").data(V);y(U.exit()).style("opacity",0).remove();U.each(q(false));U.enter().append("path").classed("js-line",true).style("vector-effect","non-scaling-stroke").call(o.lineGroupStyle).each(q(true));o.setClipUrl(U,r.layerClipId);function Z(e){y(e).attr("d","M0,0Z")}if(V.length){if(A){if(F&&N){if(M){if(M==="y"){F[1]=N[1]=x.c2p(0,true)}else if(M==="x"){F[0]=N[0]=_.c2p(0,true)}y(A).attr("d","M"+N+"L"+F+"L"+I.substr(1)).call(o.singleFillStyle)}else{y(A).attr("d",I+"Z").call(o.singleFillStyle)}}}else if(T){if(b.fill.substr(0,6)==="tonext"&&I&&S){if(b.fill==="tonext"){y(T).attr("d",I+"Z"+S+"Z").call(o.singleFillStyle)}else{y(T).attr("d",I+"L"+S.substr(1)+"Z").call(o.singleFillStyle)}b._polygons=b._polygons.concat(C)}else{Z(T);b._polygons=null}}b._prevRevpath=P;b._prevPolygons=j}else{if(A)Z(A);else if(T)Z(T);b._polygons=b._prevRevpath=b._prevPolygons=null}function H(e){return e.filter(function(e){return e.vis})}function G(e){return e.id}function $(e){if(e.ids){return G}}function W(){return false}function X(t){var i,l,u;var c=t[0].trace;var f=n.select(this);var h=s.hasMarkers(c);var p=s.hasText(c);var d=$(c);var v=W;var m=W;if(h){v=c.marker.maxdisplayed||c._needsCull?H:a.identity}if(p){m=c.marker.maxdisplayed||c._needsCull?H:a.identity}l=f.selectAll("path.point");i=l.data(v,d);var b=i.enter().append("path").classed("point",true);if(g){b.call(o.pointStyle,c,e).call(o.translatePoints,_,x).style("opacity",0).transition().style("opacity",1)}i.order();var w;if(h){w=o.makePointStyleFns(c)}i.each(function(t){var i=n.select(this);var a=y(i);u=o.translatePoint(t,a,_,x);if(u){o.singlePointStyle(t,a,c,w,e);if(r.layerClipId){o.hideOutsideRangePoint(t,a,_,x,c.xcalendar,c.ycalendar)}if(c.customdata){i.classed("plotly-customdata",t.data!==null&&t.data!==undefined)}}else{a.remove()}});if(g){i.exit().transition().style("opacity",0).remove()}else{i.exit().remove()}l=f.selectAll("g");i=l.data(m,d);i.enter().append("g").classed("textpoint",true).append("text");i.order();i.each(function(e){var t=n.select(this);var i=y(t.select("text"));u=o.translatePoint(e,i,_,x);if(u){if(r.layerClipId){o.hideOutsideRangePoint(e,t,_,x,c.xcalendar,c.ycalendar)}}else{t.remove()}});i.selectAll("text").call(o.textPointStyle,c,e).each(function(e){var t=_.c2p(e.x);var r=x.c2p(e.y);n.select(this).selectAll("tspan.line").each(function(){y(n.select(this)).attr({x:t,y:r})})});i.exit().remove()}var Y=k.selectAll(".points");v=Y.data([u]);Y.each(X);v.enter().append("g").classed("points",true).each(X);v.exit().remove();v.each(function(e){var t=e[0].trace.cliponaxis===false;o.setClipUrl(n.select(this),t?null:r.layerClipId)})}function p(e,t,r,i,o){var l=r.xaxis,u=r.yaxis,c=n.extent(a.simpleMap(l.range,l.r2c)),f=n.extent(a.simpleMap(u.range,u.r2c));var h=i[0].trace;if(!s.hasMarkers(h))return;var p=h.marker.maxdisplayed;if(p===0)return;var d=i.filter(function(e){return e.x>=c[0]&&e.x<=c[1]&&e.y>=f[0]&&e.y<=f[1]}),v=Math.ceil(d.length/p),m=0;o.forEach(function(e,r){var n=e[0].trace;if(s.hasMarkers(n)&&n.marker.maxdisplayed>0&&r<t){m++}});var g=Math.round(m*v/3+Math.floor(m/3)*v/7.1);i.forEach(function(e){delete e.vis});d.forEach(function(e,t){if(Math.round((t+g)%v)===0)e.vis=true})}},{"../../components/drawing":67,"../../lib":161,"../../lib/polygon":173,"../../registry":253,"./line_points":278,"./link_traces":280,"./subtypes":287,d3:6}],285:[function(e,t,r){"use strict";var n=e("./subtypes");t.exports=function e(t,r){var i=t.cd,a=t.xaxis,o=t.yaxis,s=[],l=i[0].trace,u,c,f,h;var p=!n.hasMarkers(l)&&!n.hasText(l);if(p)return[];if(r===false){for(u=0;u<i.length;u++){i[u].selected=0}}else{for(u=0;u<i.length;u++){c=i[u];f=a.c2p(c.x);h=o.c2p(c.y);if(r.contains([f,h])){s.push({pointNumber:u,x:a.c2d(c.x),y:o.c2d(c.y)});c.selected=1}else{c.selected=0}}}return s}},{"./subtypes":287}],286:[function(e,t,r){"use strict";var n=e("d3");var i=e("../../components/drawing");var a=e("../../registry");function o(e,t){var r=t?t[0].node3:n.select(e).selectAll("g.trace.scatter");r.style("opacity",function(e){return e[0].trace.opacity});r.selectAll("g.points").each(function(t){var r=n.select(this);var i=t.trace||t[0].trace;s(r,i,e)});r.selectAll("g.trace path.js-line").call(i.lineGroupStyle);r.selectAll("g.trace path.js-fill").call(i.fillGroupStyle);a.getComponentMethod("errorbars","style")(r)}function s(e,t,r){i.pointStyle(e.selectAll("path.point"),t,r);i.textPointStyle(e.selectAll("text"),t,r)}function l(e,t){var r=t[0].node3;var n=t[0].trace;if(n.selectedpoints){i.selectedPointStyle(r.selectAll("path.point"),n);i.selectedTextStyle(r.selectAll("text"),n)}else{s(r,n,e)}}t.exports={style:o,stylePoints:s,styleOnSelect:l}},{"../../components/drawing":67,"../../registry":253,d3:6}],287:[function(e,t,r){"use strict";var n=e("../../lib");t.exports={hasLines:function(e){return e.visible&&e.mode&&e.mode.indexOf("lines")!==-1},hasMarkers:function(e){return e.visible&&(e.mode&&e.mode.indexOf("markers")!==-1||e.type==="splom")},hasText:function(e){return e.visible&&e.mode&&e.mode.indexOf("text")!==-1},isBubble:function(e){return n.isPlainObject(e.marker)&&n.isArrayOrTypedArray(e.marker.size)}}},{"../../lib":161}],288:[function(e,t,r){"use strict";var n=e("../../lib");t.exports=function(e,t,r,i,a){a=a||{};i("textposition");n.coerceFont(i,"textfont",r.font);if(!a.noSelect){i("selected.textfont.color");i("unselected.textfont.color")}}},{"../../lib":161}],289:[function(e,t,r){"use strict";var n=e("../../registry");t.exports=function e(t,r,i,a){var o,s=a("x"),l=a("y");var u=n.getComponentMethod("calendars","handleTraceDefaults");u(t,r,["x","y"],i);if(s){if(l){o=Math.min(s.length,l.length)}else{o=s.length;a("y0");a("dy")}}else{if(!l)return 0;o=r.y.length;a("x0");a("dx")}r._length=o;return o}},{"../../registry":253}],290:[function(e,t,r){"use strict";var n=e("../scatter/attributes");var i=e("../../plots/attributes");var a=e("../../components/colorscale/attributes");var o=e("../../components/drawing/attributes").dash;var s=e("../../lib/extend").extendFlat;var l=e("../../plot_api/edit_types").overrideAll;var u=n.marker,c=n.line,f=u.line;t.exports=l({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names"],dflt:"ISO-3"},mode:s({},n.mode,{dflt:"markers"}),text:s({},n.text,{}),hovertext:s({},n.hovertext,{}),textfont:n.textfont,textposition:n.textposition,line:{color:c.color,width:c.width,dash:o},connectgaps:n.connectgaps,marker:s({symbol:u.symbol,opacity:u.opacity,size:u.size,sizeref:u.sizeref,sizemin:u.sizemin,sizemode:u.sizemode,colorbar:u.colorbar,line:s({width:f.width},a("marker.line")),gradient:u.gradient},a("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:n.fillcolor,selected:n.selected,unselected:n.unselected,hoverinfo:s({},i.hoverinfo,{flags:["lon","lat","location","text","name"]})},"calc","nested")},{"../../components/colorscale/attributes":49,"../../components/drawing/attributes":66,"../../lib/extend":154,"../../plot_api/edit_types":188,"../../plots/attributes":202,"../scatter/attributes":265}],291:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../constants/numerical").BADNUM;var a=e("../scatter/colorscale_calc");var o=e("../scatter/arrays_to_calcdata");var s=e("../scatter/calc_selection");var l=e("../../lib")._;t.exports=function e(t,r){var u=Array.isArray(r.locations);var c=u?r.locations.length:r._length;var f=new Array(c);for(var h=0;h<c;h++){var p=f[h]={};if(u){var d=r.locations[h];p.loc=typeof d==="string"?d:null}else{var v=r.lon[h];var m=r.lat[h];if(n(v)&&n(m))p.lonlat=[+v,+m];else p.lonlat=[i,i]}}o(f,r);a(r);s(f,r);if(c){f[0].t={labels:{lat:l(t,"lat:")+" ",lon:l(t,"lon:")+" "}}}return f}},{"../../constants/numerical":142,"../../lib":161,"../scatter/arrays_to_calcdata":264,"../scatter/calc_selection":267,"../scatter/colorscale_calc":269,"fast-isnumeric":9}],292:[function(e,t,r){"use strict";var n=e("../scattergeo/attributes");var i=e("../scatter/attributes");var a=e("../../plots/mapbox/layout_attributes");var o=e("../../plots/attributes");var s=e("../../components/colorbar/attributes");var l=e("../../lib/extend").extendFlat;var u=e("../../plot_api/edit_types").overrideAll;var c=n.line;var f=n.marker;t.exports=u({lon:n.lon,lat:n.lat,mode:l({},i.mode,{dflt:"markers"}),text:l({},i.text,{}),hovertext:l({},i.hovertext,{}),line:{color:c.color,width:c.width},connectgaps:i.connectgaps,marker:{symbol:{valType:"string",dflt:"circle",arrayOk:true},opacity:f.opacity,size:f.size,sizeref:f.sizeref,sizemin:f.sizemin,sizemode:f.sizemode,color:f.color,colorscale:f.colorscale,cauto:f.cauto,cmax:f.cmax,cmin:f.cmin,autocolorscale:f.autocolorscale,reversescale:f.reversescale,showscale:f.showscale,colorbar:s},fill:n.fill,fillcolor:i.fillcolor,textfont:a.layers.symbol.textfont,textposition:a.layers.symbol.textposition,selected:{marker:i.selected.marker},unselected:{marker:i.unselected.marker},hoverinfo:l({},o.hoverinfo,{flags:["lon","lat","text","name"]})},"calc","nested")},{"../../components/colorbar/attributes":43,"../../lib/extend":154,"../../plot_api/edit_types":188,"../../plots/attributes":202,"../../plots/mapbox/layout_attributes":240,"../scatter/attributes":265,"../scattergeo/attributes":290}],293:[function(e,t,r){"use strict";var n=e("fast-isnumeric");var i=e("../../lib");var a=e("../../constants/numerical").BADNUM;var o=e("../../lib/geojson_utils");var s=e("../../components/colorscale");var l=e("../../components/drawing");var u=e("../scatter/make_bubble_size_func");var c=e("../scatter/subtypes");var f=e("../../plots/mapbox/convert_text_opts");t.exports=function e(t){var r=t[0].trace;var n=r.visible===true;var a=r.fill!=="none";var s=c.hasLines(r);var l=c.hasMarkers(r);var u=c.hasText(r);var v=l&&r.marker.symbol==="circle";var m=l&&r.marker.symbol!=="circle";var g=h();var y=h();var _=h();var x=h();var b={fill:g,line:y,circle:_,symbol:x};if(!n)return b;var w;if(a||s){w=o.calcTraceToLineCoords(t)}if(a){g.geojson=o.makePolygon(w);g.layout.visibility="visible";i.extendFlat(g.paint,{"fill-color":r.fillcolor})}if(s){y.geojson=o.makeLine(w);y.layout.visibility="visible";i.extendFlat(y.paint,{"line-width":r.line.width,"line-color":r.line.color,"line-opacity":r.opacity})}if(v){var k=p(t);_.geojson=k.geojson;_.layout.visibility="visible";i.extendFlat(_.paint,{"circle-color":k.mcc,"circle-radius":k.mrc,"circle-opacity":k.mo})}if(m||u){x.geojson=d(t);i.extendFlat(x.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"});if(m){i.extendFlat(x.layout,{"icon-size":r.marker.size/10});i.extendFlat(x.paint,{"icon-opacity":r.opacity*r.marker.opacity,"icon-color":r.marker.color})}if(u){var A=(r.marker||{}).size,T=f(r.textposition,A);i.extendFlat(x.layout,{"text-size":r.textfont.size,"text-anchor":T.anchor,"text-offset":T.offset});i.extendFlat(x.paint,{"text-color":r.textfont.color,"text-opacity":r.opacity})}}return b};function h(){return{geojson:o.makeBlank(),layout:{visibility:"none"},paint:{}}}function p(e){var t=e[0].trace;var r=t.marker;var a=t.selectedpoints;var o=i.isArrayOrTypedArray(r.color);var c=i.isArrayOrTypedArray(r.size);var f=i.isArrayOrTypedArray(r.opacity);var h;function p(e){return t.opacity*e}function d(e){return e/2}var v;if(o){if(s.hasColorscale(t,"marker")){v=s.makeColorScaleFunc(s.extractScale(r.colorscale,r.cmin,r.cmax))}else{v=i.identity}}var m;if(c){m=u(t)}var y;if(f){y=function(e){var t=n(e)?+i.constrain(e,0,1):0;return p(t)}}var _=[];for(h=0;h<e.length;h++){var x=e[h];var b=x.lonlat;if(g(b))continue;var w={};if(v)w.mcc=x.mcc=v(x.mc);if(m)w.mrc=x.mrc=m(x.ms);if(y)w.mo=y(x.mo);if(a)w.selected=x.selected||0;_.push({type:"Feature",geometry:{type:"Point",coordinates:b},properties:w})}var k;if(a){k=l.makeSelectedPointStyleFns(t);for(h=0;h<_.length;h++){var A=_[h].properties;if(k.selectedOpacityFn){A.mo=p(k.selectedOpacityFn(A))}if(k.selectedColorFn){A.mcc=k.selectedColorFn(A)}if(k.selectedSizeFn){A.mrc=k.selectedSizeFn(A)}}}return{geojson:{type:"FeatureCollection",features:_},mcc:o||k&&k.selectedColorFn?{type:"identity",property:"mcc"}:r.color,mrc:c||k&&k.selectedSizeFn?{type:"identity",property:"mrc"}:d(r.size),mo:f||k&&k.selectedOpacityFn?{type:"identity",property:"mo"}:p(r.opacity)}}function d(e){var t=e[0].trace;var r=t.marker||{},n=r.symbol,i=t.text;var a=n!=="circle"?v(n):m;var o=c.hasText(t)?v(i):m;var s=[];for(var l=0;l<e.length;l++){var u=e[l];if(g(u.lonlat))continue;s.push({type:"Feature",geometry:{type:"Point",coordinates:u.lonlat},properties:{symbol:a(u.mx),text:o(u.tx)}})}return{type:"FeatureCollection",features:s}}function v(e){if(i.isArrayOrTypedArray(e)){return function(e){return e}}else if(e){return function(){return e}}else{return m}}function m(){return""}function g(e){return e[0]===a}},{"../../components/colorscale":57,"../../components/drawing":67,"../../constants/numerical":142,"../../lib":161,"../../lib/geojson_utils":157,"../../plots/mapbox/convert_text_opts":237,"../scatter/make_bubble_size_func":281,"../scatter/subtypes":287,"fast-isnumeric":9}],294:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../scatter/subtypes");var a=e("../scatter/marker_defaults");var o=e("../scatter/line_defaults");var s=e("../scatter/text_defaults");var l=e("../scatter/fillcolor_defaults");var u=e("./attributes");t.exports=function e(t,r,f,h){function p(e,i){return n.coerce(t,r,u,e,i)}var d=c(t,r,p);if(!d){r.visible=false;return}p("text");p("hovertext");p("mode");if(i.hasLines(r)){o(t,r,f,h,p,{noDash:true});p("connectgaps")}if(i.hasMarkers(r)){a(t,r,f,h,p,{noLine:true});var v=r.marker;if(v.symbol!=="circle"){if(n.isArrayOrTypedArray(v.size))v.size=v.size[0];if(n.isArrayOrTypedArray(v.color))v.color=v.color[0]}}if(i.hasText(r)){s(t,r,h,p,{noSelect:true})}p("fill");if(r.fill!=="none"){l(t,r,f,p)}n.coerceSelectionMarkerOpacity(r,p)};function c(e,t,r){var n=r("lon")||[];var i=r("lat")||[];var a=Math.min(n.length,i.length);t._length=a;return a}},{"../../lib":161,"../scatter/fillcolor_defaults":273,"../scatter/line_defaults":277,"../scatter/marker_defaults":283,"../scatter/subtypes":287,"../scatter/text_defaults":288,"./attributes":292}],295:[function(e,t,r){"use strict";t.exports=function e(t,r){t.lon=r.lon;t.lat=r.lat;return t}},{}],296:[function(e,t,r){"use strict";var n=e("../../components/fx");var i=e("../../lib");var a=e("../scatter/get_trace_color");var o=e("../scatter/fill_hover_text");var s=e("../../constants/numerical").BADNUM;t.exports=function e(t,r,o){var u=t.cd;var c=u[0].trace;var f=t.xa;var h=t.ya;var p=t.subplot;var d=r>=0?Math.floor((r+180)/360):Math.ceil((r-180)/360);var v=d*360;var m=r-v;function g(e){var t=e.lonlat;if(t[0]===s)return Infinity;var r=i.wrap180(t[0]);var n=t[1];var a=p.project([r,n]);var l=a.x-f.c2p([m,n]);var u=a.y-h.c2p([r,o]);var c=Math.max(3,e.mrc||0);return Math.max(Math.sqrt(l*l+u*u)-c,1-3/c)}n.getClosest(u,g,t);if(t.index===false)return;var y=u[t.index];var _=y.lonlat;var x=[i.wrap180(_[0])+v,_[1]];var b=f.c2p(x);var w=h.c2p(x);var k=y.mrc||1;t.x0=b-k;t.x1=b+k;t.y0=w-k;t.y1=w+k;t.color=a(c,y);t.extraText=l(c,y,u[0].t.labels);return[t]};function l(e,t,r){var n=t.hi||e.hoverinfo;var i=n.split("+");var a=i.indexOf("all")!==-1;var s=i.indexOf("lon")!==-1;var l=i.indexOf("lat")!==-1;var u=t.lonlat;var c=[];function f(e){return e+"\xb0"}if(a||s&&l){c.push("("+f(u[0])+", "+f(u[1])+")")}else if(s){c.push(r.lon+f(u[0]))}else if(l){c.push(r.lat+f(u[1]))}if(a||i.indexOf("text")!==-1){o(t,e,c)}return c.join("<br>")}},{"../../components/fx":84,"../../constants/numerical":142,"../../lib":161,"../scatter/fill_hover_text":272,"../scatter/get_trace_color":274}],297:[function(e,t,r){"use strict";var n={};n.attributes=e("./attributes");n.supplyDefaults=e("./defaults");n.colorbar=e("../scatter/marker_colorbar");n.calc=e("../scattergeo/calc");n.plot=e("./plot");n.hoverPoints=e("./hover");n.eventData=e("./event_data");n.selectPoints=e("./select");n.style=function(e,t){if(t){var r=t[0].trace;r._glTrace.update(t)}};n.moduleType="trace";n.name="scattermapbox";n.basePlotModule=e("../../plots/mapbox");n.categories=["mapbox","gl","symbols","showLegend","scatterlike"];n.meta={};t.exports=n},{"../../plots/mapbox":238,"../scatter/marker_colorbar":282,"../scattergeo/calc":291,"./attributes":292,"./defaults":294,"./event_data":295,"./hover":296,"./plot":298,"./select":299}],298:[function(e,t,r){"use strict";var n=e("./convert");function i(e,t){this.subplot=e;this.uid=t;this.sourceIds={fill:t+"-source-fill",line:t+"-source-line",circle:t+"-source-circle",symbol:t+"-source-symbol"};this.layerIds={fill:t+"-layer-fill",line:t+"-layer-line",circle:t+"-layer-circle",symbol:t+"-layer-symbol"};this.order=["fill","line","circle","symbol"]}var a=i.prototype;a.addSource=function(e,t){this.subplot.map.addSource(this.sourceIds[e],{type:"geojson",data:t.geojson})};a.setSourceData=function(e,t){this.subplot.map.getSource(this.sourceIds[e]).setData(t.geojson)};a.addLayer=function(e,t){this.subplot.map.addLayer({type:e,id:this.layerIds[e],source:this.sourceIds[e],layout:t.layout,paint:t.paint})};a.update=function e(t){var r=this.subplot;var i=n(t);for(var a=0;a<this.order.length;a++){var o=this.order[a];var s=i[o];r.setOptions(this.layerIds[o],"setLayoutProperty",s.layout);if(s.layout.visibility==="visible"){this.setSourceData(o,s);r.setOptions(this.layerIds[o],"setPaintProperty",s.paint)}}t[0].trace._glTrace=this};a.dispose=function e(){var t=this.subplot.map;for(var r=0;r<this.order.length;r++){var n=this.order[r];t.removeLayer(this.layerIds[n]);t.removeSource(this.sourceIds[n])}};t.exports=function e(t,r){var a=r[0].trace;var o=new i(t,a.uid);var s=n(r);for(var l=0;l<o.order.length;l++){var u=o.order[l];var c=s[u];o.addSource(u,c);o.addLayer(u,c)}r[0].trace._glTrace=o;return o}},{"./convert":293}],299:[function(e,t,r){"use strict";var n=e("../../lib");var i=e("../scatter/subtypes");var a=e("../../constants/numerical").BADNUM;t.exports=function e(t,r){var o=t.cd;var s=t.xaxis;var l=t.yaxis;var u=[];var c=o[0].trace;var f;if(!i.hasMarkers(c))return[];if(r===false){for(f=0;f<o.length;f++){o[f].selected=0}}else{for(f=0;f<o.length;f++){var h=o[f];var p=h.lonlat;if(p[0]!==a){var d=[n.wrap180(p[0]),p[1]];var v=[s.c2p(d),l.c2p(d)];if(r.contains(v)){u.push({pointNumber:f,lon:p[0],lat:p[1]});h.selected=1}else{h.selected=0}}}}return u}},{"../../constants/numerical":142,"../../lib":161,"../scatter/subtypes":287}]},{},[4])(4)});