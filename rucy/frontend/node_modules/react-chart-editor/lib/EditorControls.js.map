{"version":3,"sources":["../src/EditorControls.js"],"names":["EditorControls","props","context","plotly","plotSchema","PlotSchema","get","gd","graphDiv","advancedTraceTypeSelector","config","_context","srcConverters","data","dataSources","dataSourceOptions","dataSourceValueRenderer","dataSourceOptionRenderer","dictionaries","localize","locale","key","frames","_transitionData","_frames","fullData","_fullData","fullLayout","_fullLayout","layout","onUpdate","handleUpdate","bind","traceTypesConfig","showFieldTooltips","type","payload","UPDATE_TRACES","beforeUpdateTraces","i","traceIndexes","length","attr","update","traceIndex","prop","value","set","afterUpdateTraces","slice","UPDATE_LAYOUT","beforeUpdateLayout","afterUpdateLayout","Object","assign","ADD_TRACE","beforeAddTrace","push","makeDefaultTrace","afterAddTrace","DELETE_TRACE","beforeDeleteTrace","splice","afterDeleteTrace","DELETE_ANNOTATION","annotationIndex","beforeDeleteAnnotation","annotations","afterDeleteAnnotation","DELETE_SHAPE","shapeIndex","beforeDeleteShape","shapes","afterDeleteShape","DELETE_IMAGE","imageIndex","beforeDeleteImage","images","afterDeleteImage","DELETE_RANGESELECTOR","rangeselectorIndex","axisId","rangeselector","buttons","DELETE_TRANSFORM","transformIndex","transforms","Error","className","children","propTypes","bool","func","node","string","shape","toSrc","isRequired","fromSrc","array","object","defaultProps","mode","categories","_","traces","complex","childContextTypes","any"],"mappings":"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","file":"EditorControls.js","sourcesContent":["import DefaultEditor from './DefaultEditor';\nimport PropTypes from 'prop-types';\nimport React, {Component} from 'react';\nimport {bem, localizeString} from './lib';\nimport {\n  shamefullyClearAxisTypes,\n  shamefullyAdjustAxisRef,\n  shamefullyAdjustGeo,\n  shamefullyAddTableColumns,\n} from './shame';\nimport {EDITOR_ACTIONS} from './lib/constants';\nimport isNumeric from 'fast-isnumeric';\nimport nestedProperty from 'plotly.js/src/lib/nested_property';\nimport {categoryLayout, traceTypes} from 'lib/traceTypes';\nimport {ModalProvider} from 'components/containers';\n\nclass EditorControls extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    // we only need to compute this once.\n    if (this.props.plotly) {\n      this.plotSchema = this.props.plotly.PlotSchema.get();\n    }\n  }\n\n  getChildContext() {\n    const gd = this.props.graphDiv || {};\n    return {\n      advancedTraceTypeSelector: this.props.advancedTraceTypeSelector,\n      config: gd._context,\n      srcConverters: this.props.srcConverters,\n      data: gd.data,\n      dataSources: this.props.dataSources,\n      dataSourceOptions: this.props.dataSourceOptions,\n      dataSourceValueRenderer: this.props.dataSourceValueRenderer,\n      dataSourceOptionRenderer: this.props.dataSourceOptionRenderer,\n      dictionaries: this.props.dictionaries || {},\n      localize: key =>\n        localizeString(this.props.dictionaries || {}, this.props.locale, key),\n      frames: gd._transitionData ? gd._transitionData._frames : [],\n      fullData: gd._fullData,\n      fullLayout: gd._fullLayout,\n      graphDiv: gd,\n      layout: gd.layout,\n      locale: this.props.locale,\n      onUpdate: this.handleUpdate.bind(this),\n      plotSchema: this.plotSchema,\n      plotly: this.props.plotly,\n      traceTypesConfig: this.props.traceTypesConfig,\n      showFieldTooltips: this.props.showFieldTooltips,\n    };\n  }\n\n  handleUpdate({type, payload}) {\n    const {graphDiv} = this.props;\n\n    switch (type) {\n      case EDITOR_ACTIONS.UPDATE_TRACES:\n        if (this.props.beforeUpdateTraces) {\n          this.props.beforeUpdateTraces(payload);\n        }\n\n        shamefullyClearAxisTypes(graphDiv, payload);\n        shamefullyAdjustAxisRef(graphDiv, payload);\n        shamefullyAddTableColumns(graphDiv, payload);\n\n        for (let i = 0; i < payload.traceIndexes.length; i++) {\n          for (const attr in payload.update) {\n            const traceIndex = payload.traceIndexes[i];\n            const prop = nestedProperty(graphDiv.data[traceIndex], attr);\n            const value = payload.update[attr];\n\n            if (value !== void 0) {\n              prop.set(value);\n            }\n          }\n        }\n\n        if (this.props.afterUpdateTraces) {\n          this.props.afterUpdateTraces(payload);\n        }\n        if (this.props.onUpdate) {\n          this.props.onUpdate(\n            graphDiv.data.slice(),\n            graphDiv.layout,\n            graphDiv._transitionData._frames\n          );\n        }\n        break;\n\n      case EDITOR_ACTIONS.UPDATE_LAYOUT:\n        shamefullyAdjustGeo(graphDiv, payload);\n\n        if (this.props.beforeUpdateLayout) {\n          this.props.beforeUpdateLayout(payload);\n        }\n        for (const attr in payload.update) {\n          const prop = nestedProperty(graphDiv.layout, attr);\n          const value = payload.update[attr];\n          if (value !== void 0) {\n            prop.set(value);\n          }\n        }\n        if (this.props.afterUpdateLayout) {\n          this.props.afterUpdateLayout(payload);\n        }\n        if (this.props.onUpdate) {\n          this.props.onUpdate(\n            graphDiv.data,\n            Object.assign({}, graphDiv.layout),\n            graphDiv._transitionData._frames\n          );\n        }\n        break;\n\n      case EDITOR_ACTIONS.ADD_TRACE:\n        if (this.props.beforeAddTrace) {\n          this.props.beforeAddTrace(payload);\n        }\n\n        // can't use default prop because plotly.js mutates it:\n        // https://github.com/plotly/react-chart-editor/issues/509\n        graphDiv.data.push(this.props.makeDefaultTrace());\n\n        if (this.props.afterAddTrace) {\n          this.props.afterAddTrace(payload);\n        }\n        if (this.props.onUpdate) {\n          this.props.onUpdate(\n            graphDiv.data.slice(),\n            graphDiv.layout,\n            graphDiv._transitionData._frames\n          );\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_TRACE:\n        if (payload.traceIndexes && payload.traceIndexes.length) {\n          if (this.props.beforeDeleteTrace) {\n            this.props.beforeDeleteTrace(payload);\n          }\n          graphDiv.data.splice(payload.traceIndexes[0], 1);\n          if (this.props.afterDeleteTrace) {\n            this.props.afterDeleteTrace(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data.slice(),\n              graphDiv.layout,\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_ANNOTATION:\n        if (isNumeric(payload.annotationIndex)) {\n          if (this.props.beforeDeleteAnnotation) {\n            this.props.beforeDeleteAnnotation(payload);\n          }\n          graphDiv.layout.annotations.splice(payload.annotationIndex, 1);\n          if (this.props.afterDeleteAnnotation) {\n            this.props.afterDeleteAnnotation(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_SHAPE:\n        if (isNumeric(payload.shapeIndex)) {\n          if (this.props.beforeDeleteShape) {\n            this.props.beforeDeleteShape(payload);\n          }\n          graphDiv.layout.shapes.splice(payload.shapeIndex, 1);\n          if (this.props.afterDeleteShape) {\n            this.props.afterDeleteShape(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_IMAGE:\n        if (isNumeric(payload.imageIndex)) {\n          if (this.props.beforeDeleteImage) {\n            this.props.beforeDeleteImage(payload);\n          }\n          graphDiv.layout.images.splice(payload.imageIndex, 1);\n          if (this.props.afterDeleteImage) {\n            this.props.afterDeleteImage(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_RANGESELECTOR:\n        if (isNumeric(payload.rangeselectorIndex)) {\n          graphDiv.layout[payload.axisId].rangeselector.buttons.splice(\n            payload.rangeselectorIndex,\n            1\n          );\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_TRANSFORM:\n        if (\n          isNumeric(payload.transformIndex) &&\n          payload.traceIndex < graphDiv.data.length\n        ) {\n          if (graphDiv.data[payload.traceIndex].transforms.length === 1) {\n            delete graphDiv.data[payload.traceIndex].transforms;\n          } else {\n            graphDiv.data[payload.traceIndex].transforms.splice(\n              payload.transformIndex,\n              1\n            );\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data.slice(),\n              graphDiv.layout,\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      default:\n        throw new Error('must specify an action type to handleEditorUpdate');\n    }\n  }\n\n  render() {\n    return (\n      <div\n        className={\n          bem('editor_controls') +\n          ' plotly-editor--theme-provider' +\n          `${this.props.className ? ` ${this.props.className}` : ''}`\n        }\n      >\n        <ModalProvider>\n          {this.props.graphDiv &&\n            this.props.graphDiv._fullLayout &&\n            (this.props.children ? this.props.children : <DefaultEditor />)}\n        </ModalProvider>\n      </div>\n    );\n  }\n}\n\nEditorControls.propTypes = {\n  advancedTraceTypeSelector: PropTypes.bool,\n  afterAddTrace: PropTypes.func,\n  afterDeleteAnnotation: PropTypes.func,\n  afterDeleteShape: PropTypes.func,\n  afterDeleteImage: PropTypes.func,\n  afterDeleteTrace: PropTypes.func,\n  afterUpdateLayout: PropTypes.func,\n  afterUpdateTraces: PropTypes.func,\n  beforeAddTrace: PropTypes.func,\n  beforeDeleteAnnotation: PropTypes.func,\n  beforeDeleteShape: PropTypes.func,\n  beforeDeleteImage: PropTypes.func,\n  beforeDeleteTrace: PropTypes.func,\n  beforeUpdateLayout: PropTypes.func,\n  beforeUpdateTraces: PropTypes.func,\n  children: PropTypes.node,\n  className: PropTypes.string,\n  srcConverters: PropTypes.shape({\n    toSrc: PropTypes.func.isRequired,\n    fromSrc: PropTypes.func.isRequired,\n  }),\n  dataSourceOptionRenderer: PropTypes.func,\n  dataSourceOptions: PropTypes.array,\n  dataSources: PropTypes.object,\n  dataSourceValueRenderer: PropTypes.func,\n  dictionaries: PropTypes.object,\n  graphDiv: PropTypes.object,\n  locale: PropTypes.string,\n  onUpdate: PropTypes.func,\n  plotly: PropTypes.object,\n  showFieldTooltips: PropTypes.bool,\n  traceTypesConfig: PropTypes.object,\n  makeDefaultTrace: PropTypes.func,\n};\n\nEditorControls.defaultProps = {\n  showFieldTooltips: false,\n  locale: 'en',\n  makeDefaultTrace: () => ({type: 'scatter', mode: 'markers'}),\n  traceTypesConfig: {\n    categories: _ => categoryLayout(_),\n    traces: _ => traceTypes(_),\n    complex: true,\n  },\n};\n\nEditorControls.childContextTypes = {\n  advancedTraceTypeSelector: PropTypes.bool,\n  config: PropTypes.object,\n  srcConverters: PropTypes.shape({\n    toSrc: PropTypes.func.isRequired,\n    fromSrc: PropTypes.func.isRequired,\n  }),\n  data: PropTypes.array,\n  dataSourceOptionRenderer: PropTypes.func,\n  dataSourceOptions: PropTypes.array,\n  dataSources: PropTypes.object,\n  dataSourceValueRenderer: PropTypes.func,\n  dictionaries: PropTypes.object,\n  frames: PropTypes.array,\n  fullData: PropTypes.array,\n  fullLayout: PropTypes.object,\n  graphDiv: PropTypes.any,\n  layout: PropTypes.object,\n  locale: PropTypes.string,\n  localize: PropTypes.func,\n  onUpdate: PropTypes.func,\n  plotly: PropTypes.object,\n  plotSchema: PropTypes.object,\n  traceTypesConfig: PropTypes.object,\n  showFieldTooltips: PropTypes.bool,\n};\n\nexport default EditorControls;\n"]}